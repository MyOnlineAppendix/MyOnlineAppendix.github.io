<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cassandra.auth.RoleOptionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void validateValueTypes(){
  setupRoleManager(getRoleManager(IRoleManager.Option.values()));
  RoleOptions opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.LOGIN,"test");
  assertInvalidOptions(opts,"Invalid value for property 'LOGIN'. It must be a boolean");
  opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.PASSWORD,99);
  assertInvalidOptions(opts,"Invalid value for property 'PASSWORD'. It must be a string");
  opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.SUPERUSER,new HashSet<>());
  assertInvalidOptions(opts,"Invalid value for property 'SUPERUSER'. It must be a boolean");
  opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.OPTIONS,false);
  assertInvalidOptions(opts,"Invalid value for property 'OPTIONS'. It must be a map");
  opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.LOGIN,true);
  opts.setOption(IRoleManager.Option.SUPERUSER,false);
  opts.setOption(IRoleManager.Option.PASSWORD,"test");
  opts.setOption(IRoleManager.Option.OPTIONS,Collections.singletonMap("key","value"));
  opts.validate();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rejectUnsupportedOptions(){
  IRoleManager roleManager=getRoleManager(IRoleManager.Option.LOGIN);
  setupRoleManager(roleManager);
  RoleOptions opts=new RoleOptions();
  opts.setOption(IRoleManager.Option.PASSWORD,"test");
  assertInvalidOptions(opts,String.format("%s doesn't support PASSWORD",roleManager.getClass().getName()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchlogManagerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDelete(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  CFMetaData cfm=cfs.metadata;
  new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes("1234")).clustering("c").add("val","val" + 1234).build().applyUnsafe();
  DecoratedKey dk=cfs.decorateKey(ByteBufferUtil.bytes("1234"));
  ImmutableBTreePartition results=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,dk).build());
  Iterator<Row> iter=results.iterator();
  assert iter.hasNext();
  Mutation mutation=new Mutation(PartitionUpdate.fullPartitionDelete(cfm,dk,FBUtilities.timestampMicros(),FBUtilities.nowInSeconds()));
  mutation.applyUnsafe();
  Util.assertEmpty(Util.cmd(cfs,dk).build());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplay() throws Exception {
  testReplay(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyReplay() throws Exception {
  testReplay(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cache.CacheProviderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializingCache() throws InterruptedException {
  ICache<MeasureableString,IRowCacheEntry> cache=SerializingCache.create(CAPACITY,Weighers.<RefCountedMemory>singleton(),new SerializingCacheProvider.RowCacheSerializer());
  CachedBTreePartition partition=createPartition();
  simpleCase(partition,cache);
  concurrentCase(partition,cache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.concurrent.DebuggableThreadPoolExecutorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialization(){
  LinkedBlockingQueue<Runnable> q=new LinkedBlockingQueue<Runnable>(1);
  DebuggableThreadPoolExecutor executor=new DebuggableThreadPoolExecutor(1,Integer.MAX_VALUE,TimeUnit.MILLISECONDS,q,new NamedThreadFactory("TEST"));
  WrappedRunnable runnable=new WrappedRunnable(){
    public void runMayThrow() throws InterruptedException {
      Thread.sleep(50);
    }
  }
;
  long start=System.nanoTime();
  for (int i=0; i < 10; i++) {
    executor.execute(runnable);
  }
  assert q.size() > 0 : q.size();
  while (executor.getCompletedTaskCount() < 10)   continue;
  long delta=TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - start);
  assert delta >= 9 * 50 : delta;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.concurrent.LongSharedExecutorPoolTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPromptnessOfExecution() throws InterruptedException, ExecutionException {
  testPromptnessOfExecution(TimeUnit.MINUTES.toNanos(2L),0.5f);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.concurrent.WaitQueueTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCondition() throws InterruptedException {
  testCondition(new WaitQueue());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerial() throws InterruptedException {
  testSerial(new WaitQueue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.CFMetaDataTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConversionsInverses() throws Exception {
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    ColumnFamilyStore cfs : Keyspace.open(keyspaceName).getColumnFamilyStores()) {
      CFMetaData cfm=cfs.metadata;
      if (!cfm.isThriftCompatible())       continue;
      checkInverses(cfm);
      CFMetaData withCompression=cfm.copy();
      withCompression.compression(CompressionParams.snappy(32768));
      checkInverses(withCompression);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.ColumnDefinitionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializeDeserialize() throws Exception {
  CFMetaData cfm=CFMetaData.Builder.create("ks","cf",true,false,false).addPartitionKey("pkey",AsciiType.instance).addClusteringColumn("name",AsciiType.instance).addRegularColumn("val",AsciiType.instance).build();
  ColumnDefinition cd0=ColumnDefinition.staticDef(cfm,ByteBufferUtil.bytes("TestColumnDefinitionName0"),BytesType.instance);
  ColumnDefinition cd1=ColumnDefinition.staticDef(cfm,ByteBufferUtil.bytes("TestColumnDefinition1"),LongType.instance);
  testSerializeDeserialize(cfm,cd0);
  testSerializeDeserialize(cfm,cd1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.DatabaseDescriptorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRpcAddress() throws Exception {
  Config testConfig=DatabaseDescriptor.loadConfig();
  testConfig.rpc_address=suitableInterface.getInterfaceAddresses().get(0).getAddress().getHostAddress();
  testConfig.rpc_interface=null;
  DatabaseDescriptor.applyAddressConfig(testConfig);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListenAddress() throws Exception {
  Config testConfig=DatabaseDescriptor.loadConfig();
  testConfig.listen_address=suitableInterface.getInterfaceAddresses().get(0).getAddress().getHostAddress();
  testConfig.listen_interface=null;
  DatabaseDescriptor.applyAddressConfig(testConfig);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.BatchTests </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonCounterInLoggedBatch(){
  sendBatch(BatchStatement.Type.LOGGED,false,true);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testCounterInLoggedBatch(){
  sendBatch(BatchStatement.Type.LOGGED,true,false);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testOversizedBatch(){
  int SIZE_FOR_FAILURE=2500;
  BatchStatement b=new BatchStatement(BatchStatement.Type.UNLOGGED);
  for (int i=0; i < SIZE_FOR_FAILURE; i++) {
    b.add(noncounter.bind(i,"foobar"));
  }
  session.execute(b);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testMixedInLoggedBatch(){
  sendBatch(BatchStatement.Type.LOGGED,true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCounterInUnLoggedBatch(){
  sendBatch(BatchStatement.Type.UNLOGGED,true,false);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testNonCounterInCounterBatch(){
  sendBatch(BatchStatement.Type.COUNTER,false,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyBatch(){
  session.execute("BEGIN BATCH APPLY BATCH");
  session.execute("BEGIN UNLOGGED BATCH APPLY BATCH");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCounterInCounterBatch(){
  sendBatch(BatchStatement.Type.COUNTER,true,false);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testMixedInUnLoggedBatch(){
  sendBatch(BatchStatement.Type.UNLOGGED,true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonCounterInUnLoggedBatch(){
  sendBatch(BatchStatement.Type.UNLOGGED,false,true);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidQueryException.class) public void testMixedInCounterBatch(){
  sendBatch(BatchStatement.Type.COUNTER,true,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.CQL3TypeLiteralTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCollectionNullAndEmpty(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    Value value=new Value("[]",ListType.getInstance(UTF8Type.instance,false).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("{}",SetType.getInstance(UTF8Type.instance,false).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("{}",MapType.getInstance(UTF8Type.instance,UTF8Type.instance,false).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("[]",ListType.getInstance(UTF8Type.instance,true).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("{}",SetType.getInstance(UTF8Type.instance,true).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("{}",MapType.getInstance(UTF8Type.instance,UTF8Type.instance,true).asCQL3Type(),ByteBufferUtil.EMPTY_BYTE_BUFFER);
    compareCqlLiteral(version,value);
    value=new Value("null",ListType.getInstance(UTF8Type.instance,false).asCQL3Type(),null);
    compareCqlLiteral(version,value);
    value=new Value("null",SetType.getInstance(UTF8Type.instance,false).asCQL3Type(),null);
    compareCqlLiteral(version,value);
    value=new Value("null",MapType.getInstance(UTF8Type.instance,UTF8Type.instance,false).asCQL3Type(),null);
    compareCqlLiteral(version,value);
    value=new Value("[]",ListType.getInstance(UTF8Type.instance,true).asCQL3Type(),null);
    compareCqlLiteral(version,value);
    value=new Value("{}",SetType.getInstance(UTF8Type.instance,true).asCQL3Type(),null);
    compareCqlLiteral(version,value);
    value=new Value("{}",MapType.getInstance(UTF8Type.instance,UTF8Type.instance,true).asCQL3Type(),null);
    compareCqlLiteral(version,value);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleWithNatives(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    for (int n=0; n < 100; n++) {
      Value value=generateTupleValue(version,randomTupleType(0),true);
      compareCqlLiteral(version,value);
    }
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserDefinedWithNatives(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    for (int n=0; n < 100; n++) {
      Value value=generateUserDefinedValue(version,randomUserType(0),true);
      compareCqlLiteral(version,value);
    }
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCollectionWithNatives(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    for (int n=0; n < 100; n++) {
      Value value=generateCollectionValue(version,randomCollectionType(0),true);
      compareCqlLiteral(version,value);
    }
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNative(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    for (    Map.Entry<CQL3Type.Native,List<Value>> entry : nativeTypeValues.entrySet()) {
      for (      Value value : entry.getValue()) {
        compareCqlLiteral(version,value);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNested(){
  for (int version=Server.MIN_SUPPORTED_VERSION; version <= Server.CURRENT_VERSION; version++) {
    for (int n=0; n < 100; n++) {
      Value value=randomNested(version);
      compareCqlLiteral(version,value);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.CorruptionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void runCorruptionTest(){
  final CountDownLatch failure=new CountDownLatch(1);
  ExecutorService executor=Executors.newFixedThreadPool(THREADPOOL_SIZE);
  for (int i=0; i < THREADPOOL_SIZE; i++) {
    executor.execute(new Runnable(){
      @Override public void run(){
        for (int i=0; i < 100000; i++) {
          put(KEY.getBytes(),VALUE.getBytes());
          byte[] res=get(KEY.getBytes());
          if (res == null)           continue;
          if (!Arrays.equals(VALUE.getBytes(),res)) {
            failure.countDown();
          }
        }
      }
      private void dumpKeys(      byte[] putdata,      byte[] getdata) throws IOException {
        String basename="bad-data-tid" + Thread.currentThread().getId();
        File put=new File(basename + "-put");
        File get=new File(basename + "-get");
        try (FileWriter pw=new FileWriter(put)){
          pw.write(new String(putdata));
        }
         try (FileWriter pw=new FileWriter(get)){
          pw.write(new String(getdata));
        }
       }
    }
);
  }
  try {
    assert !failure.await(2,TimeUnit.MINUTES);
  }
 catch (  InterruptedException e) {
  }
  executor.shutdownNow();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.IndexQueryPagingTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void pagingOnRegularColumnWithPartitionRestriction() throws Throwable {
  createTable("CREATE TABLE %s (" + " k1 int," + " c1 int,"+ " v1 int,"+ "PRIMARY KEY (k1, c1))");
  createIndex("CREATE INDEX ON %s(v1)");
  int partitions=3;
  int rowCount=3;
  for (int i=0; i < partitions; i++)   for (int j=0; j < rowCount; j++)   execute("INSERT INTO %s (k1, c1, v1) VALUES (?, ?, ?)",i,j,0);
  executePagingQuery("SELECT * FROM %s WHERE k1=0 AND v1=0",rowCount);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void pagingOnRegularColumnWithClusteringRestrictions() throws Throwable {
  createTable("CREATE TABLE %s (" + " k1 int," + " c1 int,"+ " v1 int,"+ "PRIMARY KEY (k1, c1))");
  createIndex("CREATE INDEX ON %s(v1)");
  int partitions=3;
  int rowCount=3;
  for (int i=0; i < partitions; i++)   for (int j=0; j < rowCount; j++)   execute("INSERT INTO %s (k1, c1, v1) VALUES (?, ?, ?)",i,j,0);
  executePagingQuery("SELECT * FROM %s WHERE k1=0 AND c1>=0 AND c1<=3 AND v1=0",rowCount);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void pagingOnRegularColumn() throws Throwable {
  createTable("CREATE TABLE %s (" + " k1 int," + " v1 int,"+ "PRIMARY KEY (k1))");
  createIndex("CREATE INDEX ON %s(v1)");
  int rowCount=3;
  for (int i=0; i < rowCount; i++)   execute("INSERT INTO %s (k1, v1) VALUES (?, ?)",i,0);
  executePagingQuery("SELECT * FROM %s WHERE v1=0",rowCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.KeyCacheCqlTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSliceQueries() throws Throwable {
  createTable("CREATE TABLE %s (pk text, ck1 int, ck2 int, val text, vpk text, vck1 int, vck2 int, PRIMARY KEY (pk, ck1, ck2))");
  for (int pkInt=0; pkInt < 20; pkInt++) {
    String pk=Integer.toString(pkInt);
    for (int ck1=0; ck1 < 10; ck1++) {
      for (int ck2=0; ck2 < 10; ck2++) {
        execute("INSERT INTO %s (pk, ck1, ck2, val, vpk, vck1, vck2) VALUES (?, ?, ?, ?, ?, ?, ?)",pk,ck1,ck2,makeStringValue(pk,ck1,ck2),pk,ck1,ck2);
      }
    }
  }
  StorageService.instance.forceKeyspaceFlush(KEYSPACE);
  for (int pkInt=0; pkInt < 20; pkInt++) {
    String pk=Integer.toString(pkInt);
    assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=?",pk),pk,0,10,0,10);
    for (int ck1=0; ck1 < 10; ck1++) {
      assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=?",pk,ck1),pk,ck1,ck1 + 1,0,10);
      assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1<?",pk,ck1),pk,0,ck1,0,10);
      assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1>?",pk,ck1),pk,ck1 + 1,10,0,10);
      assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1<=?",pk,ck1),pk,0,ck1 + 1,0,10);
      assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1>=?",pk,ck1),pk,ck1,10,0,10);
      for (int ck2=0; ck2 < 10; ck2++) {
        assertRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=? AND ck2=?",pk,ck1,ck2),new Object[]{makeStringValue(pk,ck1,ck2),pk,ck1,ck2});
        assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=? AND ck2<?",pk,ck1,ck2),pk,ck1,ck1 + 1,0,ck2);
        assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=? AND ck2>?",pk,ck1,ck2),pk,ck1,ck1 + 1,ck2 + 1,10);
        assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=? AND ck2<=?",pk,ck1,ck2),pk,ck1,ck1 + 1,0,ck2 + 1);
        assertClusterRows(execute("SELECT val, vpk, vck1, vck2 FROM %s WHERE pk=? AND ck1=? AND ck2>=?",pk,ck1,ck2),pk,ck1,ck1 + 1,ck2,10);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.LargeCompactValueTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertAndQuery() throws Throwable {
  ByteBuffer largeBytes=ByteBuffer.wrap(new byte[100000]);
  execute("INSERT INTO %s (key, column, value) VALUES (?, ?, ?)","test","a",largeBytes);
  ByteBuffer smallBytes=ByteBuffer.wrap(new byte[10]);
  execute("INSERT INTO %s (key, column, value) VALUES (?, ?, ?)","test","c",smallBytes);
  flush();
  assertRows(execute("SELECT column FROM %s WHERE key = ? AND column IN (?, ?, ?)","test","c","a","b"),row("a"),row("c"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ManyRowsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-8410,
 * migrated from cql_tests.py:TestCQL.large_clustering_in_test()
 */
@Test public void testLargeClustering() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c) )");
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,0,0);
  List<Integer> inValues=new ArrayList(10000);
  for (int i=0; i < 10000; i++)   inValues.add(i);
  assertRows(execute("SELECT * FROM %s WHERE k=? AND c IN ?",0,inValues),row(0,0,0));
  Random rnd=new Random();
  Set<Integer> clusteringValues=new HashSet<>();
  for (int i=0; i < 1000; i++)   clusteringValues.add(rnd.nextInt(10000));
  clusteringValues.add(0);
  for (  int i : clusteringValues)   execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,i,i);
  assertRowCount(execute("SELECT * FROM %s WHERE k=? AND c IN ?",0,inValues),clusteringValues.size());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.large_count_test()
 */
@Test public void testLargeCount() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY (k))");
  for (int k=1; k < 10000; k++)   execute("INSERT INTO %s (k) VALUES (?)",k);
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(9999L));
  execute("INSERT INTO %s (k) VALUES (?)",10000);
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(10000L));
  execute("INSERT INTO %s (k) VALUES (?)",10001);
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(10001L));
  for (int k=10002; k < 15001; k++)   execute("INSERT INTO %s (k) VALUES (?)",k);
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(15000L));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.PreparedStatementsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidatePreparedStatementsOnDrop(){
  String createTableStatement="CREATE TABLE IF NOT EXISTS " + KEYSPACE + ".qp_cleanup (id int PRIMARY KEY, cid int, val text);";
  String dropTableStatement="DROP TABLE IF EXISTS " + KEYSPACE + ".qp_cleanup;";
  session.execute(createTableStatement);
  PreparedStatement prepared=session.prepare("INSERT INTO " + KEYSPACE + ".qp_cleanup (id, cid, val) VALUES (?, ?, ?)");
  PreparedStatement preparedBatch=session.prepare("BEGIN BATCH " + "INSERT INTO " + KEYSPACE + ".qp_cleanup (id, cid, val) VALUES (?, ?, ?);"+ "APPLY BATCH;");
  session.execute(dropTableStatement);
  session.execute(createTableStatement);
  session.execute(prepared.bind(1,1,"value"));
  session.execute(preparedBatch.bind(2,2,"value2"));
  session.execute(dropKsStatement);
  session.execute(createKsStatement);
  session.execute(createTableStatement);
  session.execute(prepared.bind(1,1,"value"));
  session.execute(preparedBatch.bind(2,2,"value2"));
  session.execute(dropKsStatement);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.QueryWithIndexedSSTableTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void queryIndexedSSTableTest() throws Throwable {
  int ROWS=1000;
  int VALUE_LENGTH=100;
  createTable("CREATE TABLE %s (k int, t int, s text static, v text, PRIMARY KEY (k, t))");
  String text=makeRandomTest(VALUE_LENGTH);
  for (int i=0; i < ROWS; i++)   execute("INSERT INTO %s(k, t, v) VALUES (?, ?, ?)",0,i,text + i);
  flush();
  compact();
  DecoratedKey dk=Util.dk(ByteBufferUtil.bytes(0));
  boolean hasIndexed=false;
  for (  SSTableReader sstable : getCurrentColumnFamilyStore().getLiveSSTables()) {
    RowIndexEntry indexEntry=sstable.getPosition(dk,SSTableReader.Operator.EQ);
    hasIndexed|=indexEntry != null && indexEntry.isIndexed();
  }
  assert hasIndexed;
  assertRowCount(execute("SELECT s FROM %s WHERE k = ?",0),ROWS);
  assertRowCount(execute("SELECT s FROM %s WHERE k = ? ORDER BY t DESC",0),ROWS);
  assertRowCount(execute("SELECT DISTINCT s FROM %s WHERE k = ?",0),1);
  assertRowCount(execute("SELECT DISTINCT s FROM %s WHERE k = ? ORDER BY t DESC",0),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.SimpleQueryTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void limitWithMultigetTest() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int);");
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",0,0);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",1,1);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",2,2);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",3,3);
  assertRows(execute("SELECT v FROM %s WHERE k IN ? LIMIT ?",list(0,1,2,3),2),row(0),row(1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2ndaryIndexes() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v text, PRIMARY KEY (k, t));");
  execute("CREATE INDEX ON %s(v)");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",1,"foo");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",2,"bar");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key2",1,"foo");
  flush();
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key2",2,"foo");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key2",3,"bar");
  assertRows(execute("SELECT * FROM %s WHERE v = ?","foo"),row("key1",1,"foo"),row("key2",1,"foo"),row("key2",2,"foo"));
  assertRows(execute("SELECT * FROM %s WHERE v = ?","bar"),row("key1",2,"bar"),row("key2",3,"bar"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactStorageUpdateWithNull() throws Throwable {
  createTable("CREATE TABLE %s (partitionKey int," + "clustering_1 int," + "value int,"+ " PRIMARY KEY (partitionKey, clustering_1)) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 0, 0)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 1, 1)");
  flush();
  execute("UPDATE %s SET value = ? WHERE partitionKey = ? AND clustering_1 = ?",null,0,0);
  assertRows(execute("SELECT * FROM %s WHERE partitionKey = ? AND (clustering_1) IN ((?), (?))",0,0,1),row(0,1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowFilteringOnStaticColumn() throws Throwable {
  createTable("CREATE TABLE %s (id int, name text, age int static, PRIMARY KEY (id, name))");
  for (int i=0; i < 5; i++) {
    execute("INSERT INTO %s (id, name, age) VALUES (?, ?, ?)",i,"NameDoesNotMatter",i);
  }
  assertInvalid("SELECT id, age FROM %s WHERE age < 1");
  assertRows(execute("SELECT id, age FROM %s WHERE age < 1 ALLOW FILTERING"),row(0,0));
  assertRows(execute("SELECT id, age FROM %s WHERE age > 0 AND age < 3 ALLOW FILTERING"),row(1,1),row(2,2));
  assertRows(execute("SELECT id, age FROM %s WHERE age > 3 ALLOW FILTERING"),row(4,4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeTombstones() throws Throwable {
  int N=100;
  createTable("CREATE TABLE %s (k text, t1 int, t2 int, v text, PRIMARY KEY (k, t1, t2));");
  for (int t1=0; t1 < 3; t1++)   for (int t2=0; t2 < N; t2++)   execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key",t1,t2,"someSemiLargeTextForValue_" + t1 + "_"+ t2);
  flush();
  execute("DELETE FROM %s WHERE k=? AND t1=?","key",1);
  flush();
  Object[][] expected=new Object[2 * N][];
  for (int t2=0; t2 < N; t2++) {
    expected[t2]=row("key",0,t2,"someSemiLargeTextForValue_0_" + t2);
    expected[N + t2]=row("key",2,t2,"someSemiLargeTextForValue_2_" + t2);
  }
  assertRows(execute("SELECT * FROM %s"),expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithoutClustering() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, v1 int, v2 text);");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","first",1,"value1");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","second",2,"value2");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","third",3,"value3");
  flush();
  assertRows(execute("SELECT * FROM %s WHERE k = ?","first"),row("first",1,"value1"));
  assertRows(execute("SELECT v2 FROM %s WHERE k = ?","second"),row("value2"));
  assertRows(execute("SELECT * FROM %s"),row("third",3,"value3"),row("second",2,"value2"),row("first",1,"value1"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void staticDistinctTest() throws Throwable {
  createTable("CREATE TABLE %s ( k int, p int, s int static, PRIMARY KEY (k, p))");
  execute("INSERT INTO %s (k, p) VALUES (?, ?)",1,1);
  execute("INSERT INTO %s (k, p) VALUES (?, ?)",1,2);
  assertRows(execute("SELECT k, s FROM %s"),row(1,null),row(1,null));
  assertRows(execute("SELECT DISTINCT k, s FROM %s"),row(1,null));
  assertRows(execute("SELECT DISTINCT s FROM %s WHERE k=?",1),row((Object)null));
  assertEmpty(execute("SELECT DISTINCT s FROM %s WHERE k=?",2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStaticCompactTables() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, v1 int, v2 text) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","first",1,"value1");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","second",2,"value2");
  execute("INSERT INTO %s (k, v1, v2) values (?, ?, ?)","third",3,"value3");
  assertRows(execute("SELECT * FROM %s WHERE k = ?","first"),row("first",1,"value1"));
  assertRows(execute("SELECT v2 FROM %s WHERE k = ?","second"),row("value2"));
  assertRows(execute("SELECT * FROM %s"),row("third",3,"value3"),row("second",2,"value2"),row("first",1,"value1"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithReverseClusteringOrder() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v1 text, v2 text, PRIMARY KEY (k, t)) WITH CLUSTERING ORDER BY (t DESC);");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",1,"v11","v21");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",2,"v12","v22");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",3,"v13","v23");
  flush();
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",4,"v14","v24");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",5,"v15","v25");
  assertRows(execute("SELECT * FROM %s"),row("key",5,"v15","v25"),row("key",4,"v14","v24"),row("key",3,"v13","v23"),row("key",2,"v12","v22"),row("key",1,"v11","v21"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ORDER BY t ASC","key"),row("key",1,"v11","v21"),row("key",2,"v12","v22"),row("key",3,"v13","v23"),row("key",4,"v14","v24"),row("key",5,"v15","v25"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ?","key",3),row("key",5,"v15","v25"),row("key",4,"v14","v24"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ?","key",2,4),row("key",3,"v13","v23"),row("key",2,"v12","v22"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ORDER BY t DESC","key"),row("key",5,"v15","v25"),row("key",4,"v14","v24"),row("key",3,"v13","v23"),row("key",2,"v12","v22"),row("key",1,"v11","v21"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ? ORDER BY t DESC","key",3),row("key",5,"v15","v25"),row("key",4,"v14","v24"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ? ORDER BY t DESC","key",2,4),row("key",3,"v13","v23"),row("key",2,"v12","v22"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStaticColumns() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, s text static, v text, PRIMARY KEY (k, t));");
  execute("INSERT INTO %s (k, t, v, s) values (?, ?, ?, ?)","key1",1,"foo1","st1");
  execute("INSERT INTO %s (k, t, v, s) values (?, ?, ?, ?)","key1",2,"foo2","st2");
  flush();
  execute("INSERT INTO %s (k, t, v, s) values (?, ?, ?, ?)","key1",3,"foo3","st3");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",4,"foo4");
  assertRows(execute("SELECT * FROM %s"),row("key1",1,"st3","foo1"),row("key1",2,"st3","foo2"),row("key1",3,"st3","foo3"),row("key1",4,"st3","foo4"));
  assertRows(execute("SELECT s FROM %s WHERE k = ?","key1"),row("st3"),row("st3"),row("st3"),row("st3"));
  assertRows(execute("SELECT DISTINCT s FROM %s WHERE k = ?","key1"),row("st3"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void collectionDeletionTest() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<int>);");
  execute("INSERT INTO %s (k, s) VALUES (?, ?)",1,set(1));
  flush();
  execute("INSERT INTO %s (k, s) VALUES (?, ?)",1,set(2));
  assertRows(execute("SELECT s FROM %s WHERE k = ?",1),row(set(2)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithTwoClustering() throws Throwable {
  createTable("CREATE TABLE %s (k text, t1 text, t2 int, v text, PRIMARY KEY (k, t1, t2));");
  execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key","v1",1,"v1");
  execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key","v1",2,"v2");
  execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key","v2",1,"v3");
  execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key","v2",2,"v4");
  execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key","v2",3,"v5");
  flush();
  assertRows(execute("SELECT * FROM %s"),row("key","v1",1,"v1"),row("key","v1",2,"v2"),row("key","v2",1,"v3"),row("key","v2",2,"v4"),row("key","v2",3,"v5"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t1 >= ?","key","v2"),row("key","v2",1,"v3"),row("key","v2",2,"v4"),row("key","v2",3,"v5"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t1 >= ? ORDER BY t1 DESC","key","v2"),row("key","v2",3,"v5"),row("key","v2",2,"v4"),row("key","v2",1,"v3"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDynamicCompactTables() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v text, PRIMARY KEY (k, t));");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key",1,"v11");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key",2,"v12");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key",3,"v13");
  flush();
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key",4,"v14");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key",5,"v15");
  assertRows(execute("SELECT * FROM %s"),row("key",1,"v11"),row("key",2,"v12"),row("key",3,"v13"),row("key",4,"v14"),row("key",5,"v15"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ?","key",3),row("key",4,"v14"),row("key",5,"v15"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ?","key",2,4),row("key",2,"v12"),row("key",3,"v13"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ORDER BY t DESC","key"),row("key",5,"v15"),row("key",4,"v14"),row("key",3,"v13"),row("key",2,"v12"),row("key",1,"v11"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ? ORDER BY t DESC","key",3),row("key",5,"v15"),row("key",4,"v14"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ? ORDER BY t DESC","key",2,4),row("key",3,"v13"),row("key",2,"v12"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2ndaryIndexBug() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v int, PRIMARY KEY(k, c1, c2))");
  execute("CREATE INDEX v_idx ON %s(v)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (?, ?, ?, ?)",0,0,0,0);
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (?, ?, ?, ?)",0,1,0,0);
  assertRows(execute("SELECT * FROM %s WHERE v=?",0),row(0,0,0,0),row(0,1,0,0));
  flush();
  execute("DELETE FROM %s WHERE k=? AND c1=?",0,1);
  flush();
  assertRows(execute("SELECT * FROM %s WHERE v=?",0),row(0,0,0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithLargePartition() throws Throwable {
  createTable("CREATE TABLE %s (k text, t1 int, t2 int, v text, PRIMARY KEY (k, t1, t2));");
  for (int t1=0; t1 < 20; t1++)   for (int t2=0; t2 < 10; t2++)   execute("INSERT INTO %s (k, t1, t2, v) values (?, ?, ?, ?)","key",t1,t2,"someSemiLargeTextForValue_" + t1 + "_"+ t2);
  flush();
  Object[][] expected=new Object[10][];
  for (int t2=0; t2 < 10; t2++)   expected[t2]=row("key",15,t2);
  assertRows(execute("SELECT k, t1, t2 FROM %s WHERE k=? AND t1=?","key",15),expected);
  Object[][] expectedReverse=new Object[10][];
  for (int t2=9; t2 >= 0; t2--)   expectedReverse[9 - t2]=row("key",15,t2);
  assertRows(execute("SELECT k, t1, t2 FROM %s WHERE k=? AND t1=? ORDER BY t1 DESC, t2 DESC","key",15),expectedReverse);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for Cassandra issue 10958 
 */
@Test public void restrictionOnRegularColumnWithStaticColumnPresentTest() throws Throwable {
  createTable("CREATE TABLE %s (id int, id2 int, age int static, extra int, PRIMARY KEY(id, id2))");
  execute("INSERT INTO %s (id, id2, age, extra) VALUES (?, ?, ?, ?)",1,1,1,1);
  execute("INSERT INTO %s (id, id2, age, extra) VALUES (?, ?, ?, ?)",2,2,2,2);
  execute("UPDATE %s SET age=? WHERE id=?",3,3);
  assertRows(execute("SELECT * FROM %s"),row(1,1,1,1),row(2,2,2,2),row(3,null,3,null));
  assertRows(execute("SELECT * FROM %s WHERE extra > 1 ALLOW FILTERING"),row(2,2,2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowDeletion() throws Throwable {
  int N=4;
  createTable("CREATE TABLE %s (k text, t int, v1 text, v2 int, PRIMARY KEY (k, t));");
  for (int t=0; t < N; t++)   execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",t,"v" + t,t + 10);
  flush();
  for (int i=0; i < N / 2; i++)   execute("DELETE FROM %s WHERE k=? AND t=?","key",i * 2);
  Object[][] expected=new Object[N / 2][];
  for (int i=0; i < N / 2; i++) {
    int t=i * 2 + 1;
    expected[i]=row("key",t,"v" + t,t + 10);
  }
  assertRows(execute("SELECT * FROM %s"),expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v text, PRIMARY KEY (k, t));");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",1,"foo1");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",2,"foo2");
  flush();
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key1",3,"foo3");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key2",4,"foo4");
  execute("INSERT INTO %s (k, t, v) values (?, ?, ?)","key2",5,"foo5");
  assertRows(execute("SELECT DISTINCT k FROM %s"),row("key1"),row("key2"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithOneClustering() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v1 text, v2 text, PRIMARY KEY (k, t));");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",1,"v11","v21");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",2,"v12","v22");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",3,"v13","v23");
  flush();
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",4,"v14","v24");
  execute("INSERT INTO %s (k, t, v1, v2) values (?, ?, ?, ?)","key",5,"v15","v25");
  assertRows(execute("SELECT * FROM %s"),row("key",1,"v11","v21"),row("key",2,"v12","v22"),row("key",3,"v13","v23"),row("key",4,"v14","v24"),row("key",5,"v15","v25"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ?","key",3),row("key",4,"v14","v24"),row("key",5,"v15","v25"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ?","key",2,4),row("key",2,"v12","v22"),row("key",3,"v13","v23"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ORDER BY t DESC","key"),row("key",5,"v15","v25"),row("key",4,"v14","v24"),row("key",3,"v13","v23"),row("key",2,"v12","v22"),row("key",1,"v11","v21"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t > ? ORDER BY t DESC","key",3),row("key",5,"v15","v25"),row("key",4,"v14","v24"));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND t >= ? AND t < ? ORDER BY t DESC","key",2,4),row("key",3,"v13","v23"),row("key",2,"v12","v22"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewFilteringTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeyINRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IN (1, 2) AND c IS NOT NULL PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,2,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,-1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,2,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,-1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,1,0),row(1,1,2,0),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeyEQRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b = 1 AND c IS NOT NULL PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,0,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,2,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeyFilteringRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,-1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND c = 1 PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,1,-1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",2,1,1,1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,2),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,-1);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,-1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,-1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,1,1,2),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(1,0,1,0),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0));
    String tableName=KEYSPACE + "." + currentTable();
    execute("BEGIN BATCH " + "INSERT INTO " + tableName + " (a, b, c, d) VALUES (?, ?, ?, ?); "+ "INSERT INTO "+ tableName+ " (a, b, c, d) VALUES (?, ?, ?, ?); "+ "APPLY BATCH",4,4,0,0,4,4,1,1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,0,1,0),row(0,1,1,0),row(4,4,1,1));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllTypes() throws Throwable {
  String myType=createType("CREATE TYPE %s (a int, b uuid, c set<text>)");
  String columnNames="asciival, " + "bigintval, " + "blobval, "+ "booleanval, "+ "dateval, "+ "decimalval, "+ "doubleval, "+ "floatval, "+ "inetval, "+ "intval, "+ "textval, "+ "timeval, "+ "timestampval, "+ "timeuuidval, "+ "uuidval,"+ "varcharval, "+ "varintval, "+ "frozenlistval, "+ "frozensetval, "+ "frozenmapval, "+ "tupleval, "+ "udtval";
  createTable("CREATE TABLE %s (" + "asciival ascii, " + "bigintval bigint, "+ "blobval blob, "+ "booleanval boolean, "+ "dateval date, "+ "decimalval decimal, "+ "doubleval double, "+ "floatval float, "+ "inetval inet, "+ "intval int, "+ "textval text, "+ "timeval time, "+ "timestampval timestamp, "+ "timeuuidval timeuuid, "+ "uuidval uuid,"+ "varcharval varchar, "+ "varintval varint, "+ "frozenlistval frozen<list<int>>, "+ "frozensetval frozen<set<uuid>>, "+ "frozenmapval frozen<map<ascii, int>>,"+ "tupleval frozen<tuple<int, ascii, uuid>>,"+ "udtval frozen<" + myType + ">, "+ "PRIMARY KEY ("+ columnNames+ "))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + "asciival = 'abc' AND " + "bigintval = 123 AND "+ "blobval = 0xfeed AND "+ "booleanval = true AND "+ "dateval = '1987-03-23' AND "+ "decimalval = 123.123 AND "+ "doubleval = 123.123 AND "+ "floatval = 123.123 AND "+ "inetval = '127.0.0.1' AND "+ "intval = 123 AND "+ "textval = 'abc' AND "+ "timeval = '07:35:07.000111222' AND "+ "timestampval = 123123123 AND "+ "timeuuidval = 6BDDC89A-5644-11E4-97FC-56847AFE9799 AND "+ "uuidval = 6BDDC89A-5644-11E4-97FC-56847AFE9799 AND "+ "varcharval = 'abc' AND "+ "varintval = 123123123 AND "+ "frozenlistval = [1, 2, 3] AND "+ "frozensetval = {6BDDC89A-5644-11E4-97FC-56847AFE9799} AND "+ "frozenmapval = {'a': 1, 'b': 2} AND "+ "tupleval = (1, 'foobar', 6BDDC89A-5644-11E4-97FC-56847AFE9799) AND "+ "udtval = {a: 1, b: 6BDDC89A-5644-11E4-97FC-56847AFE9799, c: {'foo', 'bar'}} "+ "PRIMARY KEY (" + columnNames + ")");
  execute("INSERT INTO %s (" + columnNames + ") VALUES ("+ "'abc',"+ "123,"+ "0xfeed,"+ "true,"+ "'1987-03-23',"+ "123.123,"+ "123.123,"+ "123.123,"+ "'127.0.0.1',"+ "123,"+ "'abc',"+ "'07:35:07.000111222',"+ "123123123,"+ "6BDDC89A-5644-11E4-97FC-56847AFE9799,"+ "6BDDC89A-5644-11E4-97FC-56847AFE9799,"+ "'abc',"+ "123123123,"+ "[1, 2, 3],"+ "{6BDDC89A-5644-11E4-97FC-56847AFE9799},"+ "{'a': 1, 'b': 2},"+ "(1, 'foobar', 6BDDC89A-5644-11E4-97FC-56847AFE9799),"+ "{a: 1, b: 6BDDC89A-5644-11E4-97FC-56847AFE9799, c: {'foo', 'bar'}})");
  assert !execute("SELECT * FROM mv_test").isEmpty();
  executeNet(protocolVersion,"ALTER TABLE %s RENAME inetval TO foo");
  assert !execute("SELECT * FROM mv_test").isEmpty();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompoundPartitionKeyRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY ((a, b), c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND c IS NOT NULL PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,0,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,0,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ?",1,1);
    assertEmpty(execute("SELECT * FROM mv_test" + i));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeyMultiColumnRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,-1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND (b, c) >= (1, 0) PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,-1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,1,-1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,-1);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,-1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterWithFunction() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,0,2);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,3);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s " + "WHERE a = blobAsInt(intAsBlob(1)) AND b IS NOT NULL " + "PRIMARY KEY (a, b)");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  assertRows(execute("SELECT a, b, c FROM mv_test"),row(1,0,2),row(1,1,3));
  executeNet(protocolVersion,"ALTER TABLE %s RENAME a TO foo");
  assertRows(execute("SELECT foo, b, c FROM mv_test"),row(1,0,2),row(1,1,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterWithTypecast() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,0,2);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,3);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s " + "WHERE a = (int) 1 AND b IS NOT NULL " + "PRIMARY KEY (a, b)");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  assertRows(execute("SELECT a, b, c FROM mv_test"),row(1,0,2),row(1,1,3));
  executeNet(protocolVersion,"ALTER TABLE %s RENAME a TO foo");
  assertRows(execute("SELECT foo, b, c FROM mv_test"),row(1,0,2),row(1,1,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeySliceRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b >= 1 AND c IS NOT NULL PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,-1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,2,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,-1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(0,1,0,0),row(0,1,1,0));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartitionKeyRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b IS NOT NULL AND c IS NOT NULL PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,1,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,0,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,0),row(1,1,1,0),row(1,1,2,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,0,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,1,0);
    execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,0,1),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,0,0),row(1,0,1,0),row(1,1,1,0),row(1,1,2,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertEmpty(execute("SELECT * FROM mv_test" + i));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCaseSensitivity() throws Throwable {
  createTable("CREATE TABLE %s (\"theKey\" int, \"theClustering\" int, \"the\"\"Value\" int, PRIMARY KEY (\"theKey\", \"theClustering\"))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"the\"\"Value\") VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"the\"\"Value\") VALUES (?, ?, ?)",0,1,0);
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"the\"\"Value\") VALUES (?, ?, ?)",1,0,0);
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"the\"\"Value\") VALUES (?, ?, ?)",1,1,0);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s " + "WHERE \"theKey\" = 1 AND \"theClustering\" = 1 AND \"the\"\"Value\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  createView("mv_test2","CREATE MATERIALIZED VIEW %s AS SELECT \"theKey\", \"theClustering\", \"the\"\"Value\" FROM %%s " + "WHERE \"theKey\" = 1 AND \"theClustering\" = 1 AND \"the\"\"Value\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test2"))   Thread.sleep(10);
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRowsIgnoringOrder(execute("SELECT \"theKey\", \"theClustering\", \"the\"\"Value\" FROM " + mvname),row(1,1,0));
  }
  executeNet(protocolVersion,"ALTER TABLE %s RENAME \"theClustering\" TO \"Col\"");
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRowsIgnoringOrder(execute("SELECT \"theKey\", \"Col\", \"the\"\"Value\" FROM " + mvname),row(1,1,0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompoundPartitionKeyRestrictionsNotIncludeAll() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY ((a, b), c))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT a, b, c FROM %%s WHERE a = 1 AND b = 1 AND c IS NOT NULL PRIMARY KEY ((a, b), c)");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,1,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,0,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,2,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1),row(1,1,2));
  execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,0,0);
  execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,0,0);
  execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,0,1,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1),row(1,1,2));
  execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,1,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1),row(1,1,2));
  execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,0,0);
  execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,0,0);
  execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",0,1,0);
  execute("DELETE FROM %s WHERE a = ? AND b = ?",0,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,0),row(1,1,1),row(1,1,2));
  execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,0);
  assertRows(execute("SELECT * FROM mv_test"),row(1,1,1),row(1,1,2));
  execute("DELETE FROM %s WHERE a = ? AND b = ?",1,1);
  assertEmpty(execute("SELECT * FROM mv_test"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartitionKeyAndClusteringKeyFilteringRestrictions() throws Throwable {
  List<String> mvPrimaryKeys=Arrays.asList("((a, b), c)","((b, a), c)","(a, b, c)","(c, b, a)","((c, a), b)");
  for (int i=0; i < mvPrimaryKeys.size(); i++) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
    execute("USE " + keyspace());
    executeNet(protocolVersion,"USE " + keyspace());
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,-1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,0);
    logger.info("Testing MV primary key: {}",mvPrimaryKeys.get(i));
    createView("mv_test" + i,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b IS NOT NULL AND c = 1 PRIMARY KEY " + mvPrimaryKeys.get(i));
    while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test" + i))     Thread.sleep(10);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,0,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",1,1,-1,0);
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",0,1,1,0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,0),row(1,2,1,0));
    execute("UPDATE %s SET d = ? WHERE a = ? AND b = ? AND c = ?",2,1,1,1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,2),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,-1);
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",2,0,1);
    execute("DELETE FROM %s WHERE a = ?",0);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,1,1,2),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ? AND b = ? AND c = ?",1,1,1);
    assertRowsIgnoringOrder(execute("SELECT a, b, c, d FROM mv_test" + i),row(1,0,1,0),row(1,2,1,0));
    execute("DELETE FROM %s WHERE a = ?",1);
    assertEmpty(execute("SELECT a, b, c, d FROM mv_test" + i));
    dropView("mv_test" + i);
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewLongTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConflictResolution() throws Throwable {
  final int writers=96;
  final int insertsPerWriter=50;
  final Map<Integer,Exception> failedWrites=new ConcurrentHashMap<>();
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE c IS NOT NULL AND a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (c, a, b)");
  CyclicBarrier semaphore=new CyclicBarrier(writers);
  Thread[] threads=new Thread[writers];
  for (int i=0; i < writers; i++) {
    final int writer=i;
    Thread t=new Thread(new WrappedRunnable(){
      public void runMayThrow(){
        try {
          int writerOffset=writer * insertsPerWriter;
          semaphore.await();
          for (int i=0; i < insertsPerWriter; i++) {
            try {
              executeNet(protocolVersion,"INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP 1",1,1,i + writerOffset);
            }
 catch (            NoHostAvailableException|WriteTimeoutException e) {
              failedWrites.put(i + writerOffset,e);
            }
          }
        }
 catch (        Throwable e) {
          throw new RuntimeException(e);
        }
      }
    }
);
    t.start();
    threads[i]=t;
  }
  for (int i=0; i < writers; i++)   threads[i].join();
  for (int i=0; i < writers * insertsPerWriter; i++) {
    if (executeNet(protocolVersion,"SELECT COUNT(*) FROM system.batchlog").one().getLong(0) == 0)     break;
    try {
      BatchlogManager.instance.startBatchlogReplay().get();
    }
 catch (    Throwable ignore) {
    }
  }
  int value=executeNet(protocolVersion,"SELECT c FROM %s WHERE a = 1 AND b = 1").one().getInt("c");
  List<Row> rows=executeNet(protocolVersion,"SELECT c FROM " + keyspace() + ".mv").all();
  boolean containsC=false;
  StringBuilder others=new StringBuilder();
  StringBuilder overlappingFailedWrites=new StringBuilder();
  for (  Row row : rows) {
    int c=row.getInt("c");
    if (c == value)     containsC=true;
 else {
      if (others.length() != 0)       others.append(' ');
      others.append(c);
      if (failedWrites.containsKey(c)) {
        if (overlappingFailedWrites.length() != 0)         overlappingFailedWrites.append(' ');
        overlappingFailedWrites.append(c).append(':').append(failedWrites.get(c).getMessage());
      }
    }
  }
  if (rows.size() > 1) {
    throw new AssertionError(String.format("Expected 1 row, but found %d; %s c = %d, and (%s) of which (%s) failed to insert",rows.size(),containsC ? "found row with" : "no rows contained",value,others,overlappingFailedWrites));
  }
 else   if (rows.isEmpty()) {
    throw new AssertionError(String.format("Could not find row with c = %d",value));
  }
 else   if (rows.size() == 1 && !containsC) {
    throw new AssertionError(String.format("Single row had c = %d, expected %d",rows.get(0).getInt("c"),value));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewSchemaTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTwoTablesOneView() throws Throwable {
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createTable("CREATE TABLE " + keyspace() + ".dummy_table ("+ "j int, "+ "intval int, "+ "PRIMARY KEY (j))");
  createTable("CREATE TABLE " + keyspace() + ".real_base ("+ "k int, "+ "intval int, "+ "PRIMARY KEY (k))");
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM " + keyspace() + ".real_base WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  createView("mv2","CREATE MATERIALIZED VIEW %s AS SELECT * FROM " + keyspace() + ".dummy_table WHERE j IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, j)");
  updateView("INSERT INTO " + keyspace() + ".real_base (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,0));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",0),row(0,0));
  updateView("INSERT INTO " + keyspace() + ".real_base (k, intval) VALUES (?, ?)",0,1);
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
  updateView("INSERT INTO " + keyspace() + ".dummy_table (j, intval) VALUES(?, ?)",0,1);
  assertRows(execute("SELECT j, intval FROM " + keyspace() + ".dummy_table WHERE j = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (b, a)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReuseName() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "intval int, "+ "PRIMARY KEY (k))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,0));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",0),row(0,0));
  executeNet(protocolVersion,"DROP MATERIALIZED VIEW mv");
  views.remove("mv");
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,1);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterReversedTypeBaseTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))"+ "WITH CLUSTERING ORDER BY (b DESC)");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b ASC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterReversedTypeViewTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterClusteringViewTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterViewTableValue() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "PRIMARY KEY (a))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  assertInvalid("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCaseSensitivity() throws Throwable {
  createTable("CREATE TABLE %s (\"theKey\" int, \"theClustering\" int, \"theValue\" int, PRIMARY KEY (\"theKey\", \"theClustering\"))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"theValue\") VALUES (?, ?, ?)",0,0,0);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s " + "WHERE \"theKey\" IS NOT NULL AND \"theClustering\" IS NOT NULL AND \"theValue\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  createView("mv_test2","CREATE MATERIALIZED VIEW %s AS SELECT \"theKey\", \"theClustering\", \"theValue\" FROM %%s " + "WHERE \"theKey\" IS NOT NULL AND \"theClustering\" IS NOT NULL AND \"theValue\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test2"))   Thread.sleep(10);
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRows(execute("SELECT \"theKey\", \"theClustering\", \"theValue\" FROM " + mvname),row(0,0,0));
  }
  executeNet(protocolVersion,"ALTER TABLE %s RENAME \"theClustering\" TO \"Col\"");
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRows(execute("SELECT \"theKey\", \"Col\", \"theValue\" FROM " + mvname),row(0,0,0));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonExistingOnes() throws Throwable {
  assertInvalidMessage("Cannot drop non existing materialized view","DROP MATERIALIZED VIEW " + KEYSPACE + ".view_does_not_exist");
  assertInvalidMessage("Cannot drop non existing materialized view","DROP MATERIALIZED VIEW keyspace_does_not_exist.view_does_not_exist");
  execute("DROP MATERIALIZED VIEW IF EXISTS " + KEYSPACE + ".view_does_not_exist");
  execute("DROP MATERIALIZED VIEW IF EXISTS keyspace_does_not_exist.view_does_not_exist");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void complexTimestampUpdateTestWithoutFlush() throws Throwable {
  complexTimestampUpdateTest(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuilderWidePartition() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "c int, "+ "intval int, "+ "PRIMARY KEY (k, c))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  for (int i=0; i < 1024; i++)   execute("INSERT INTO %s (k, c, intval) VALUES (?, ?, ?)",0,i,0);
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, c, k)");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv"))   Thread.sleep(1000);
  assertRows(execute("SELECT count(*) from %s WHERE k = ?",0),row(1024L));
  assertRows(execute("SELECT count(*) from mv WHERE intval = ?",0),row(1024L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCollections() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "intval int, "+ "listval list<int>, "+ "PRIMARY KEY (k))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval, listval) VALUES (?, ?, fromJson(?))",0,0,"[1, 2, 3]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, listval from mv WHERE intval = ?",0),row(0,list(1,2,3)));
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",1,1);
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",1,"[1, 2, 3]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",1),row(1,list(1,2,3)));
  assertRows(execute("SELECT k, listval from mv WHERE intval = ?",1),row(1,list(1,2,3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryKeyOnlyTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT a, b FROM %%s WHERE b IS NOT NULL PRIMARY KEY (b, a)");
  updateView("INSERT INTO %s (a, b) VALUES (?, ?)",1,1);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, b FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartitionKeyOnlyTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "PRIMARY KEY ((a, b)))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT a, b FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (b, a)");
  updateView("INSERT INTO %s (a, b) VALUES (?, ?)",1,1);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, b FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdate() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "intval int, "+ "PRIMARY KEY (k))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,0));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",0),row(0,0));
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,1);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegularColumnTimestampUpdates() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "c int, "+ "val int)");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv_rctstest","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c)");
  updateView("UPDATE %s SET c = ?, val = ? WHERE k = ?",0,0,0);
  updateView("UPDATE %s SET val = ? WHERE k = ?",1,0);
  updateView("UPDATE %s SET c = ? WHERE k = ?",1,0);
  assertRows(execute("SELECT c, k, val FROM mv_rctstest"),row(1,0,1));
  updateView("TRUNCATE %s");
  updateView("UPDATE %s USING TIMESTAMP 1 SET c = ?, val = ? WHERE k = ?",0,0,0);
  updateView("UPDATE %s USING TIMESTAMP 3 SET c = ? WHERE k = ?",1,0);
  updateView("UPDATE %s USING TIMESTAMP 2 SET val = ? WHERE k = ?",1,0);
  updateView("UPDATE %s USING TIMESTAMP 4 SET c = ? WHERE k = ?",2,0);
  updateView("UPDATE %s USING TIMESTAMP 3 SET val = ? WHERE k = ?",2,0);
  assertRows(execute("SELECT c, k, val FROM mv_rctstest"),row(2,0,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringOrder() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b, c))"+ "WITH CLUSTERING ORDER BY (b ASC, c DESC)");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, b, c) WITH CLUSTERING ORDER BY (b DESC)");
  createView("mv2","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, c, b) WITH CLUSTERING ORDER BY (c ASC)");
  createView("mv3","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, b, c)");
  createView("mv4","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, c, b) WITH CLUSTERING ORDER BY (c DESC)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,1);
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,2,2,2);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT b FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(2),row(1));
  mvRows=executeNet(protocolVersion,"SELECT c FROM mv2");
  assertRowsNet(protocolVersion,mvRows,row(1),row(2));
  mvRows=executeNet(protocolVersion,"SELECT b FROM mv3");
  assertRowsNet(protocolVersion,mvRows,row(1),row(2));
  mvRows=executeNet(protocolVersion,"SELECT c FROM mv4");
  assertRowsNet(protocolVersion,mvRows,row(2),row(1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void complexTimestampUpdateTestWithFlush() throws Throwable {
  complexTimestampUpdateTest(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleDeletes() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL PRIMARY KEY (b, a)");
  updateView("INSERT INTO %s (a, b) VALUES (?, ?)",1,1);
  updateView("INSERT INTO %s (a, b) VALUES (?, ?)",1,2);
  updateView("INSERT INTO %s (a, b) VALUES (?, ?)",1,3);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, b FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(1,1),row(1,2),row(1,3));
  updateView(String.format("BEGIN UNLOGGED BATCH " + "DELETE FROM %s WHERE a = 1 AND b > 1 AND b < 3;" + "DELETE FROM %s WHERE a = 1;"+ "APPLY BATCH",currentTable(),currentTable()));
  mvRows=executeNet(protocolVersion,"SELECT a, b FROM mv1");
  assertRowsNet(protocolVersion,mvRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.functions.CastFctsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCastsWithReverseOrder() throws Throwable {
  createTable("CREATE TABLE %s (a int," + " b smallint," + " c double,"+ " primary key (a, b)) WITH CLUSTERING ORDER BY (b DESC);");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,(short)2,6.3);
  assertRows(execute("SELECT CAST(a AS tinyint), " + "CAST(b AS tinyint), " + "CAST(c AS tinyint) FROM %s"),row((byte)1,(byte)2,(byte)6));
  assertRows(execute("SELECT CAST(CAST(a AS tinyint) AS smallint), " + "CAST(CAST(b AS tinyint) AS smallint), " + "CAST(CAST(c AS tinyint) AS smallint) FROM %s"),row((short)1,(short)2,(short)6));
  assertRows(execute("SELECT CAST(CAST(CAST(a AS tinyint) AS double) AS text), " + "CAST(CAST(CAST(b AS tinyint) AS double) AS text), " + "CAST(CAST(CAST(c AS tinyint) AS double) AS text) FROM %s"),row("1.0","2.0","6.0"));
  String f=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return (double)val;'");
  assertRows(execute("SELECT " + f + "(CAST(b AS int)) FROM %s"),row((double)2));
  assertRows(execute("SELECT CAST(" + f + "(CAST(b AS int)) AS text) FROM %s"),row("2.0"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidQueries() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b text, c double)");
  assertInvalidSyntaxMessage("no viable alternative at input '(' (... b, c) VALUES ([CAST](...)","INSERT INTO %s (a, b, c) VALUES (CAST(? AS int), ?, ?)",1.6,"test",6.3);
  assertInvalidSyntaxMessage("no viable alternative at input '(' (..." + KEYSPACE + "."+ currentTable()+ " SET c = [cast](...)","UPDATE %s SET c = cast(? as double) WHERE a = ?",1,1);
  assertInvalidSyntaxMessage("no viable alternative at input '(' (...= ? WHERE a = [CAST] (...)","UPDATE %s SET c = ? WHERE a = CAST (? AS INT)",1,2.0);
  assertInvalidSyntaxMessage("no viable alternative at input '(' (..." + KEYSPACE + "."+ currentTable()+ " WHERE a = [CAST] (...)","DELETE FROM %s WHERE a = CAST (? AS INT)",1,2.0);
  assertInvalidSyntaxMessage("no viable alternative at input '(' (..." + KEYSPACE + "."+ currentTable()+ " WHERE a = [CAST] (...)","SELECT * FROM %s WHERE a = CAST (? AS INT)",1,2.0);
  assertInvalidMessage("a cannot be cast to boolean","SELECT CAST(a AS boolean) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOtherTypeCastsInSelectionClause() throws Throwable {
  createTable("CREATE TABLE %s (a ascii primary key," + " b inet," + " c boolean)");
  execute("INSERT INTO %s (a, b, c) VALUES (?, '127.0.0.1', ?)","test",true);
  assertRows(execute("SELECT CAST(a AS text), " + "CAST(b AS text), " + "CAST(c AS text) FROM %s"),row("test","127.0.0.1","true"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeCastsInSelectionClause() throws Throwable {
  createTable("CREATE TABLE %s (a timeuuid primary key, b timestamp, c date, d time)");
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  DateTime date=DateTimeFormat.forPattern("yyyy-MM-dd").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21");
  long timeInMillis=dateTime.getMillis();
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, '2015-05-21 11:03:02+00', '2015-05-21', '11:03:02')",UUIDGen.getTimeUUID(timeInMillis));
  assertRows(execute("SELECT CAST(a AS timestamp), " + "CAST(b AS timestamp), " + "CAST(c AS timestamp) FROM %s"),row(new Date(dateTime.getMillis()),new Date(dateTime.getMillis()),new Date(date.getMillis())));
  int timeInMillisToDay=SimpleDateSerializer.timeInMillisToDay(date.getMillis());
  assertRows(execute("SELECT CAST(a AS date), " + "CAST(b AS date), " + "CAST(c AS date) FROM %s"),row(timeInMillisToDay,timeInMillisToDay,timeInMillisToDay));
  assertRows(execute("SELECT CAST(b AS text), " + "CAST(c AS text), " + "CAST(d AS text) FROM %s"),row("2015-05-21T11:03:02.000Z","2015-05-21","11:03:02.000000000"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCounterCastsInSelectionClause() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b counter)");
  execute("UPDATE %s SET b = b + 2 WHERE a = 1");
  assertRows(execute("SELECT CAST(b AS tinyint), " + "CAST(b AS smallint), " + "CAST(b AS int), "+ "CAST(b AS bigint), "+ "CAST(b AS float), "+ "CAST(b AS double), "+ "CAST(b AS decimal), "+ "CAST(b AS ascii), "+ "CAST(b AS text) FROM %s"),row((byte)2,(short)2,2,2L,2.0F,2.0,BigDecimal.valueOf(2.0),"2","2"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNumericCastsInSelectionClause() throws Throwable {
  createTable("CREATE TABLE %s (a tinyint primary key," + " b smallint," + " c int,"+ " d bigint,"+ " e float,"+ " f double,"+ " g decimal,"+ " h varint,"+ " i int)");
  execute("INSERT INTO %s (a, b, c, d, e, f, g, h) VALUES (?, ?, ?, ?, ?, ?, ?, ?)",(byte)1,(short)2,3,4L,5.2F,6.3,BigDecimal.valueOf(6.3),BigInteger.valueOf(4));
  assertColumnNames(execute("SELECT CAST(b AS int), CAST(c AS int), CAST(d AS double) FROM %s"),"cast(b as int)","c","cast(d as double)");
  assertRows(execute("SELECT CAST(a AS tinyint), " + "CAST(b AS tinyint), " + "CAST(c AS tinyint), "+ "CAST(d AS tinyint), "+ "CAST(e AS tinyint), "+ "CAST(f AS tinyint), "+ "CAST(g AS tinyint), "+ "CAST(h AS tinyint), "+ "CAST(i AS tinyint) FROM %s"),row((byte)1,(byte)2,(byte)3,(byte)4L,(byte)5,(byte)6,(byte)6,(byte)4,null));
  assertRows(execute("SELECT CAST(a AS smallint), " + "CAST(b AS smallint), " + "CAST(c AS smallint), "+ "CAST(d AS smallint), "+ "CAST(e AS smallint), "+ "CAST(f AS smallint), "+ "CAST(g AS smallint), "+ "CAST(h AS smallint), "+ "CAST(i AS smallint) FROM %s"),row((short)1,(short)2,(short)3,(short)4L,(short)5,(short)6,(short)6,(short)4,null));
  assertRows(execute("SELECT CAST(a AS int), " + "CAST(b AS int), " + "CAST(c AS int), "+ "CAST(d AS int), "+ "CAST(e AS int), "+ "CAST(f AS int), "+ "CAST(g AS int), "+ "CAST(h AS int), "+ "CAST(i AS int) FROM %s"),row(1,2,3,4,5,6,6,4,null));
  assertRows(execute("SELECT CAST(a AS bigint), " + "CAST(b AS bigint), " + "CAST(c AS bigint), "+ "CAST(d AS bigint), "+ "CAST(e AS bigint), "+ "CAST(f AS bigint), "+ "CAST(g AS bigint), "+ "CAST(h AS bigint), "+ "CAST(i AS bigint) FROM %s"),row(1L,2L,3L,4L,5L,6L,6L,4L,null));
  assertRows(execute("SELECT CAST(a AS float), " + "CAST(b AS float), " + "CAST(c AS float), "+ "CAST(d AS float), "+ "CAST(e AS float), "+ "CAST(f AS float), "+ "CAST(g AS float), "+ "CAST(h AS float), "+ "CAST(i AS float) FROM %s"),row(1.0F,2.0F,3.0F,4.0F,5.2F,6.3F,6.3F,4.0F,null));
  assertRows(execute("SELECT CAST(a AS double), " + "CAST(b AS double), " + "CAST(c AS double), "+ "CAST(d AS double), "+ "CAST(e AS double), "+ "CAST(f AS double), "+ "CAST(g AS double), "+ "CAST(h AS double), "+ "CAST(i AS double) FROM %s"),row(1.0,2.0,3.0,4.0,(double)5.2F,6.3,6.3,4.0,null));
  assertRows(execute("SELECT CAST(a AS decimal), " + "CAST(b AS decimal), " + "CAST(c AS decimal), "+ "CAST(d AS decimal), "+ "CAST(e AS decimal), "+ "CAST(f AS decimal), "+ "CAST(g AS decimal), "+ "CAST(h AS decimal), "+ "CAST(i AS decimal) FROM %s"),row(BigDecimal.valueOf(1.0),BigDecimal.valueOf(2.0),BigDecimal.valueOf(3.0),BigDecimal.valueOf(4.0),BigDecimal.valueOf(5.2F),BigDecimal.valueOf(6.3),BigDecimal.valueOf(6.3),BigDecimal.valueOf(4.0),null));
  assertRows(execute("SELECT CAST(a AS ascii), " + "CAST(b AS ascii), " + "CAST(c AS ascii), "+ "CAST(d AS ascii), "+ "CAST(e AS ascii), "+ "CAST(f AS ascii), "+ "CAST(g AS ascii), "+ "CAST(h AS ascii), "+ "CAST(i AS ascii) FROM %s"),row("1","2","3","4","5.2","6.3","6.3","4",null));
  assertRows(execute("SELECT CAST(a AS text), " + "CAST(b AS text), " + "CAST(c AS text), "+ "CAST(d AS text), "+ "CAST(e AS text), "+ "CAST(f AS text), "+ "CAST(g AS text), "+ "CAST(h AS text), "+ "CAST(i AS text) FROM %s"),row("1","2","3","4","5.2","6.3","6.3","4",null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.selection.SelectionColumnMappingTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectionColumnMapping() throws Throwable {
  typeName=createType("CREATE TYPE %s (f1 int, f2 text)");
  tableName=createTable("CREATE TABLE %s (" + " k int PRIMARY KEY," + " v1 int,"+ " v2 ascii,"+ " v3 frozen<" + typeName + ">)");
  userType=Schema.instance.getKSMetaData(KEYSPACE).types.get(ByteBufferUtil.bytes(typeName)).get();
  functionName=createFunction(KEYSPACE,"int, ascii","CREATE FUNCTION %s (i int, a ascii) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(i);'");
  execute("INSERT INTO %s (k, v1 ,v2, v3) VALUES (1, 1, 'foo', {f1:1, f2:'bar'})");
  testSimpleTypes();
  testWildcard();
  testSimpleTypesWithAliases();
  testUserTypes();
  testUserTypesWithAliases();
  testWritetimeAndTTL();
  testWritetimeAndTTLWithAliases();
  testFunction();
  testNoArgFunction();
  testUserDefinedFunction();
  testOverloadedFunction();
  testFunctionWithAlias();
  testNoArgumentFunction();
  testNestedFunctions();
  testNestedFunctionsWithArguments();
  testCount();
  testDuplicateFunctionsWithoutAliases();
  testDuplicateFunctionsWithAliases();
  testSelectDistinct();
  testMultipleAliasesOnSameColumn();
  testMixedColumnTypes();
  testMultipleUnaliasedSelectionOfSameColumn();
  testUserDefinedAggregate();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleArgumentFunction() throws Throwable {
  tableName=createTable("CREATE TABLE %s (a int, b text, PRIMARY KEY ((a, b)))");
  ColumnSpecification tokenSpec=columnSpecification("system.token(a, b)",BytesType.instance);
  SelectionColumnMapping expected=SelectionColumnMapping.newMapping().addMapping(tokenSpec,columnDefinitions("a","b"));
  SelectStatement statement=getSelect("SELECT token(a,b) FROM %s");
  verifyColumnMapping(expected,statement);
  statement.executeInternal(QueryState.forInternalCalls(),QueryOptions.DEFAULT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.CollectionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.map_test()
 */
@Test public void testMap() throws Throwable {
  createTable("CREATE TABLE %s (fn text, ln text, m map<text, int>, PRIMARY KEY (fn, ln))");
  execute("UPDATE %s SET m['foo'] = 3 WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET m['bar'] = 4 WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET m['woot'] = 5 WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET m['bar'] = 6 WHERE fn='Tom' AND ln='Bombadil'");
  execute("DELETE m['foo'] FROM %s WHERE fn='Tom' AND ln='Bombadil'");
  assertRows(execute("SELECT m FROM %s"),row(map("bar",6,"woot",5)));
  execute("UPDATE %s SET m = { 'a' : 4 , 'c' : 3, 'b' : 2 } WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT m FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(map("a",4,"b",2,"c",3)));
  execute("UPDATE %s SET m =  { 'm' : 4 , 'n' : 1, 'o' : 2 } WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT m FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(map("m",4,"n",1,"o",2)));
  execute("UPDATE %s SET m = {} WHERE fn='Bilbo' AND ln='Baggins'");
  assertEmpty(execute("SELECT m FROM %s WHERE fn='Bilbo' AND ln='Baggins'"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSets() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<text>)");
  execute("INSERT INTO %s(k, s) VALUES (0, ?)",set("v1","v2","v3","v4"));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v1","v2","v3","v4")));
  execute("DELETE s[?] FROM %s WHERE k = 0","v1");
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v2","v3","v4")));
  execute("UPDATE %s SET s = ? WHERE k = 0",set("v6","v5"));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v5","v6")));
  execute("UPDATE %s SET s = s + ? WHERE k = 0",set("v7"));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v5","v6","v7")));
  execute("UPDATE %s SET s = s - ? WHERE k = 0",set("v6","v5"));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v7")));
  execute("DELETE s[?] FROM %s WHERE k = 0",set("v7"));
  execute("DELETE s[?] FROM %s WHERE k = 0",set("v7"));
  execute("DELETE s FROM %s WHERE k = 0");
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row((Object)null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.collection_compact_test()
 */
@Test public void testCompactCollections() throws Throwable {
  String tableName=KEYSPACE + "." + createTableName();
  assertInvalid(String.format("CREATE TABLE %s (user ascii PRIMARY KEY, mails list < text >) WITH COMPACT STORAGE;",tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropAndReaddDroppedCollection() throws Throwable {
  createTable("create table %s (k int primary key, v frozen<set<text>>, x int)");
  execute("insert into %s (k, v) VALUES (0, {'fffffffff'})");
  flush();
  execute("alter table %s drop v");
  execute("alter table %s add v set<int>");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.collection_and_regular_test()
 */
@Test public void testCollectionAndRegularColumns() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<int>, c int)");
  execute("INSERT INTO %s (k, l, c) VALUES(3, [0, 1, 2], 4)");
  execute("UPDATE %s SET l[0] = 1, c = 42 WHERE k = 3");
  assertRows(execute("SELECT l, c FROM %s WHERE k = 3"),row(list(1,1,2),42));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.set_test()
 */
@Test public void testSet() throws Throwable {
  createTable("CREATE TABLE %s ( fn text, ln text, tags set<text>, PRIMARY KEY (fn, ln) )");
  execute("UPDATE %s SET tags = tags + { 'foo' } WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + { 'bar' } WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + { 'foo' } WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + { 'foobar' } WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags - { 'bar' } WHERE fn='Tom' AND ln='Bombadil'");
  assertRows(execute("SELECT tags FROM %s"),row(set("foo","foobar")));
  execute("UPDATE %s SET tags = { 'a', 'c', 'b' } WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(set("a","b","c")));
  execute("UPDATE %s SET tags = { 'm', 'n' } WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(set("m","n")));
  execute("DELETE tags['m'] FROM %s WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(set("n")));
  execute("DELETE tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'");
  assertEmpty(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m map<text,text>)");
  Object m=map("k","v");
  execute("INSERT INTO %s (k, m) VALUES (10, ?)",m);
  assertRows(execute("SELECT m FROM %s WHERE k = 10"),row(m));
  execute("INSERT INTO %s (k, m) VALUES (10, ?)",unset());
  assertRows(execute("SELECT m FROM %s WHERE k = 10"),row(m));
  execute("UPDATE %s SET m['k'] = ? WHERE k = 10",unset());
  assertRows(execute("SELECT m FROM %s WHERE k = 10"),row(m));
  assertInvalidMessage("Invalid unset map key","UPDATE %s SET m[?] = 'foo' WHERE k = 10",unset());
  assertInvalidMessage("Invalid unset map key","DELETE m[?] FROM %s WHERE k = 10",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLists() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<text>)");
  execute("INSERT INTO %s(k, l) VALUES (0, ?)",list("v1","v2","v3"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1","v2","v3")));
  execute("DELETE l[?] FROM %s WHERE k = 0",1);
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1","v3")));
  execute("UPDATE %s SET l[?] = ? WHERE k = 0",1,"v4");
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1","v4")));
  execute("UPDATE %s SET l = ? WHERE k = 0",list("v6","v5"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v6","v5")));
  execute("UPDATE %s SET l = l + ? WHERE k = 0",list("v7","v8"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v6","v5","v7","v8")));
  execute("UPDATE %s SET l = ? + l WHERE k = 0",list("v9"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v9","v6","v5","v7","v8")));
  execute("UPDATE %s SET l = l - ? WHERE k = 0",list("v5","v8"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v9","v6","v7")));
  execute("DELETE l FROM %s WHERE k = 0");
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row((Object)null));
  assertInvalidMessage("Attempted to delete an element from a list which is null","DELETE l[0] FROM %s WHERE k=0 ");
  assertInvalidMessage("Attempted to set an element on a list which is null","UPDATE %s SET l[0] = ? WHERE k=0",list("v10"));
  execute("UPDATE %s SET l = l - ? WHERE k=0",list("v11"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row((Object)null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.list_test()
 */
@Test public void testList() throws Throwable {
  createTable("CREATE TABLE %s (fn text, ln text, tags list<text>, PRIMARY KEY (fn, ln))");
  execute("UPDATE %s SET tags = tags + [ 'foo' ] WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + [ 'bar' ] WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + [ 'foo' ] WHERE fn='Tom' AND ln='Bombadil'");
  execute("UPDATE %s SET tags = tags + [ 'foobar' ] WHERE fn='Tom' AND ln='Bombadil'");
  assertRows(execute("SELECT tags FROM %s"),row(list("foo","bar","foo","foobar")));
  execute("UPDATE %s SET tags = [ 'a', 'c', 'b', 'c' ] WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(list("a","c","b","c")));
  execute("UPDATE %s SET tags = [ 'm', 'n' ] + tags WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(list("m","n","a","c","b","c")));
  execute("UPDATE %s SET tags[2] = 'foo', tags[4] = 'bar' WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(list("m","n","foo","c","bar","c")));
  execute("DELETE tags[2] FROM %s WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(list("m","n","c","bar","c")));
  execute("UPDATE %s SET tags = tags - [ 'bar' ] WHERE fn='Bilbo' AND ln='Baggins'");
  assertRows(execute("SELECT tags FROM %s WHERE fn='Bilbo' AND ln='Baggins'"),row(list("m","n","c","c")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidCollectionsMix() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<text>, s set<text>, m map<text, text>)");
  assertInvalid("UPDATE %s SET l = l + { 'a', 'b' } WHERE k = 0");
  assertInvalid("UPDATE %s SET l = l - { 'a', 'b' } WHERE k = 0");
  assertInvalid("UPDATE %s SET l = l + ? WHERE k = 0",map("a","b","c","d"));
  assertInvalid("UPDATE %s SET l = l - ? WHERE k = 0",map("a","b","c","d"));
  assertInvalid("UPDATE %s SET s = s + [ 'a', 'b' ] WHERE k = 0");
  assertInvalid("UPDATE %s SET s = s - [ 'a', 'b' ] WHERE k = 0");
  assertInvalid("UPDATE %s SET s = s + ? WHERE k = 0",map("a","b","c","d"));
  assertInvalid("UPDATE %s SET s = s - ? WHERE k = 0",map("a","b","c","d"));
  assertInvalid("UPDATE %s SET m = m + ? WHERE k = 0",list("a","b"));
  assertInvalid("UPDATE %s SET m = m - [ 'a', 'b' ] WHERE k = 0");
  assertInvalid("UPDATE %s SET m = m + ? WHERE k = 0",set("a","b"));
  assertInvalid("UPDATE %s SET m = m - ? WHERE k = 0",map("a","b","c","d"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test you can add columns in a table with collections (#4982 bug),
 * migrated from cql_tests.py:TestCQL.alter_with_collections_test()
 */
@Test public void testAlterCollections() throws Throwable {
  createTable("CREATE TABLE %s (key int PRIMARY KEY, aset set<text>)");
  execute("ALTER TABLE %s ADD c text");
  execute("ALTER TABLE %s ADD alist list<text>");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapBulkRemoval() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m map<text, text>)");
  execute("INSERT INTO %s(k, m) VALUES (?, ?)",0,map("k1","v1","k2","v2","k3","v3"));
  assertRows(execute("SELECT * FROM %s"),row(0,map("k1","v1","k2","v2","k3","v3")));
  execute("UPDATE %s SET m = m - ? WHERE k = ?",set("k2"),0);
  assertRows(execute("SELECT * FROM %s"),row(0,map("k1","v1","k3","v3")));
  execute("UPDATE %s SET m = m + ?, m = m - ? WHERE k = ?",map("k4","v4"),set("k3"),0);
  assertRows(execute("SELECT * FROM %s"),row(0,map("k1","v1","k4","v4")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for 6276,
 * migrated from cql_tests.py:TestCQL.drop_and_readd_collection_test()
 */
@Test public void testDropAndReaddCollection() throws Throwable {
  createTable("create table %s (k int primary key, v set<text>, x int)");
  execute("insert into %s (k, v) VALUES (0, {'fffffffff'})");
  flush();
  execute("alter table %s drop v");
  assertInvalid("alter table %s add v set<int>");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multi_list_set_test()
 */
@Test public void testMultipleLists() throws Throwable {
  createTable(" CREATE TABLE %s (k int PRIMARY KEY, l1 list<int>, l2 list<int>)");
  execute("INSERT INTO %s (k, l1, l2) VALUES (0, [1, 2, 3], [4, 5, 6])");
  execute("UPDATE %s SET l2[1] = 42, l1[1] = 24  WHERE k = 0");
  assertRows(execute("SELECT l1, l2 FROM %s WHERE k = 0"),row(list(1,24,3),list(4,42,6)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for bug #5795,
 * migrated from cql_tests.py:TestCQL.nonpure_function_collection_test()
 */
@Test public void testNonPureFunctionCollection() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v list<timeuuid>)");
  execute("INSERT INTO %s (k, v) VALUES (0, [now()])");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multi_collection_test()
 */
@Test public void testMultiCollections() throws Throwable {
  UUID id=UUID.fromString("b017f48f-ae67-11e1-9096-005056c00008");
  createTable("CREATE TABLE %s (k uuid PRIMARY KEY, L list<int>, M map<text, int>, S set<int> )");
  execute("UPDATE %s SET L = [1, 3, 5] WHERE k = ?",id);
  execute("UPDATE %s SET L = L + [7, 11, 13] WHERE k = ?;",id);
  execute("UPDATE %s SET S = {1, 3, 5} WHERE k = ?",id);
  execute("UPDATE %s SET S = S + {7, 11, 13} WHERE k = ?",id);
  execute("UPDATE %s SET M = {'foo': 1, 'bar' : 3} WHERE k = ?",id);
  execute("UPDATE %s SET M = M + {'foobar' : 4} WHERE k = ?",id);
  assertRows(execute("SELECT L, M, S FROM %s WHERE k = ?",id),row(list(1,3,5,7,11,13),map("bar",3,"foo",1,"foobar",4),set(1,3,5,7,11,13)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_5376()
 */
@Test public void testInClauseWithCollections() throws Throwable {
  createTable("CREATE TABLE %s (key text, c bigint, v text, x set < text >, PRIMARY KEY(key, c) )");
  assertInvalid("select * from %s where key = 'foo' and c in (1,3,4)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<text>)");
  Object l=list("foo","foo");
  execute("INSERT INTO %s (k, l) VALUES (10, ?)",l);
  assertRows(execute("SELECT l FROM %s WHERE k = 10"),row(l));
  execute("INSERT INTO %s (k, l) VALUES (10, ?)",unset());
  assertRows(execute("SELECT l FROM %s WHERE k = 10"),row(l));
  execute("UPDATE %s SET l[1] = ? WHERE k = 10",unset());
  assertRows(execute("SELECT l FROM %s WHERE k = 10"),row(l));
  assertInvalidMessage("Invalid unset value for list index","UPDATE %s SET l[?] = 'foo' WHERE k = 10",unset());
  execute("DELETE l[?] FROM %s WHERE k = 10",unset());
  assertRows(execute("SELECT l FROM %s WHERE k = 10"),row(l));
  execute("UPDATE %s SET l = l - ? WHERE k = 10",unset());
  assertRows(execute("SELECT l FROM %s WHERE k = 10"),row(l));
  assertInvalidMessage("Invalid unset value for column k","SELECT * FROM %s WHERE k IN ?",unset());
  assertInvalidMessage("Invalid unset value for column k","SELECT * FROM %s WHERE k IN (?)",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapsWithElementsBiggerThan64K() throws Throwable {
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)2);
  String largeText2=new String(bytes);
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m map<text, text>)");
  execute("INSERT INTO %s(k, m) VALUES (0, ?)",map("k1",largeText,largeText,"v2"));
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k1",largeText,largeText,"v2")));
  execute("UPDATE %s SET m[?] = ? WHERE k = 0","k3",largeText);
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k1",largeText,largeText,"v2","k3",largeText)));
  execute("UPDATE %s SET m[?] = ? WHERE k = 0",largeText2,"v4");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k1",largeText,largeText,"v2","k3",largeText,largeText2,"v4")));
  execute("DELETE m[?] FROM %s WHERE k = 0","k1");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map(largeText,"v2","k3",largeText,largeText2,"v4")));
  execute("DELETE m[?] FROM %s WHERE k = 0",largeText2);
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map(largeText,"v2","k3",largeText)));
  execute("UPDATE %s SET m = ? WHERE k = 0",map("k5",largeText,largeText,"v6"));
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k5",largeText,largeText,"v6")));
  execute("UPDATE %s SET m = m + ? WHERE k = 0",map("k7",largeText));
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k5",largeText,largeText,"v6","k7",largeText)));
  execute("UPDATE %s SET m = m + ? WHERE k = 0",map(largeText2,"v8"));
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k5",largeText,largeText,"v6","k7",largeText,largeText2,"v8")));
  execute("DELETE m FROM %s WHERE k = 0");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, m) VALUES (0, {'" + largeText + "' : 'v1', 'k2' : '"+ largeText+ "'})");
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map(largeText,"v1","k2",largeText)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.collection_function_test()
 */
@Test public void testFunctionsOnCollections() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l set<int>)");
  assertInvalid("SELECT ttl(l) FROM %s WHERE k = 0");
  assertInvalid("SELECT writetime(l) FROM %s WHERE k = 0");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for 5805 bug,
 * migrated from cql_tests.py:TestCQL.collection_flush_test()
 */
@Test public void testCollectionFlush() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<int>)");
  execute("INSERT INTO %s (k, s) VALUES (1, {1})");
  flush();
  execute("INSERT INTO %s (k, s) VALUES (1, {2})");
  flush();
  assertRows(execute("SELECT * FROM %s"),row(1,set(2)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaps() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m map<text, int>)");
  execute("INSERT INTO %s(k, m) VALUES (0, ?)",map("v1",1,"v2",2));
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v1",1,"v2",2)));
  execute("UPDATE %s SET m[?] = ?, m[?] = ? WHERE k = 0","v3",3,"v4",4);
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v1",1,"v2",2,"v3",3,"v4",4)));
  execute("DELETE m[?] FROM %s WHERE k = 0","v1");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v2",2,"v3",3,"v4",4)));
  execute("UPDATE %s SET m = ? WHERE k = 0",map("v6",6,"v5",5));
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v5",5,"v6",6)));
  execute("UPDATE %s SET m = m + ? WHERE k = 0",map("v7",7));
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v5",5,"v6",6,"v7",7)));
  execute("DELETE m[?] FROM %s WHERE k = 0","v7");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v5",5,"v6",6)));
  execute("DELETE m[?] FROM %s WHERE k = 0","v6");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("v5",5)));
  execute("DELETE m[?] FROM %s WHERE k = 0","v5");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row((Object)null));
  execute("DELETE m[?] FROM %s WHERE k = 0","v5");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row((Object)null));
  execute("UPDATE %s SET m = {} WHERE k = 0");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row((Object)null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemovalThroughUpdate() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<int>)");
  execute("INSERT INTO %s(k, l) VALUES(?, ?)",0,list(1,2,3));
  assertRows(execute("SELECT * FROM %s"),row(0,list(1,2,3)));
  execute("UPDATE %s SET l[0] = null WHERE k=0");
  assertRows(execute("SELECT * FROM %s"),row(0,list(2,3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateStaticList() throws Throwable {
  createTable("CREATE TABLE %s (k1 text, k2 text, s_list list<int> static, PRIMARY KEY (k1, k2))");
  execute("insert into %s (k1, k2) VALUES ('a','b')");
  execute("update %s set s_list = s_list + [0] where k1='a'");
  assertRows(execute("select s_list from %s where k1='a'"),row(list(0)));
  execute("update %s set s_list[0] = 100 where k1='a'");
  assertRows(execute("select s_list from %s where k1='a'"),row(list(100)));
  execute("update %s set s_list = s_list + [0] where k1='a'");
  assertRows(execute("select s_list from %s where k1='a'"),row(list(100,0)));
  execute("delete s_list[0] from %s where k1='a'");
  assertRows(execute("select s_list from %s where k1='a'"),row(list(0)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetsWithElementsBiggerThan64K() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<text>)");
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)2);
  String largeText2=new String(bytes);
  execute("INSERT INTO %s(k, s) VALUES (0, ?)",set(largeText,"v2"));
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set(largeText,"v2")));
  execute("DELETE s[?] FROM %s WHERE k = 0",largeText);
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v2")));
  execute("UPDATE %s SET s = ? WHERE k = 0",set("v1",largeText));
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v1",largeText)));
  execute("UPDATE %s SET s = s + ? WHERE k = 0",set("v2",largeText2));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v1",largeText,"v2",largeText2)));
  execute("UPDATE %s SET s = s - ? WHERE k = 0",set(largeText,"v2"));
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set("v1",largeText2)));
  execute("DELETE s FROM %s WHERE k = 0");
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, s) VALUES (0, {'" + largeText + "', 'v2'})");
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set(largeText,"v2")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<text>)");
  Object s=set("bar","baz","foo");
  execute("INSERT INTO %s (k, s) VALUES (10, ?)",s);
  assertRows(execute("SELECT s FROM %s WHERE k = 10"),row(s));
  execute("INSERT INTO %s (k, s) VALUES (10, ?)",unset());
  assertRows(execute("SELECT s FROM %s WHERE k = 10"),row(s));
  execute("UPDATE %s SET s = s + ? WHERE k = 10",unset());
  assertRows(execute("SELECT s FROM %s WHERE k = 10"),row(s));
  execute("UPDATE %s SET s = s - ? WHERE k = 10",unset());
  assertRows(execute("SELECT s FROM %s WHERE k = 10"),row(s));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListWithElementsBiggerThan64K() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<text>)");
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)2);
  String largeText2=new String(bytes);
  execute("INSERT INTO %s(k, l) VALUES (0, ?)",list(largeText,"v2"));
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(largeText,"v2")));
  execute("DELETE l[?] FROM %s WHERE k = 0",0);
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v2")));
  execute("UPDATE %s SET l[?] = ? WHERE k = 0",0,largeText);
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(largeText)));
  execute("UPDATE %s SET l = ? WHERE k = 0",list("v1",largeText));
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1",largeText)));
  execute("UPDATE %s SET l = l + ? WHERE k = 0",list("v2",largeText2));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1",largeText,"v2",largeText2)));
  execute("UPDATE %s SET l = l - ? WHERE k = 0",list(largeText,"v2"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1",largeText2)));
  execute("DELETE l FROM %s WHERE k = 0");
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, l) VALUES (0, ['" + largeText + "', 'v2'])");
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(largeText,"v2")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.CountersTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCounterUpdatesWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, c counter)");
  execute("UPDATE %s SET c = c + 1 WHERE k = 10");
  assertRows(execute("SELECT c FROM %s WHERE k = 10"),row(1L));
  execute("UPDATE %s SET c = c + ? WHERE k = 10",1L);
  assertRows(execute("SELECT c FROM %s WHERE k = 10"),row(2L));
  execute("UPDATE %s SET c = c + ? WHERE k = 10",unset());
  assertRows(execute("SELECT c FROM %s WHERE k = 10"),row(2L));
  execute("UPDATE %s SET c = c - ? WHERE k = 10",1L);
  assertRows(execute("SELECT c FROM %s WHERE k = 10"),row(1L));
  execute("UPDATE %s SET c = c - ? WHERE k = 10",unset());
  assertRows(execute("SELECT c FROM %s WHERE k = 10"),row(1L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.collection_counter_test()
 */
@Test public void testCountersOnCollections() throws Throwable {
  String tableName=KEYSPACE + "." + createTableName();
  assertInvalidThrow(InvalidRequestException.class,String.format("CREATE TABLE %s (k int PRIMARY KEY, l list<counter>)",tableName));
  tableName=KEYSPACE + "." + createTableName();
  assertInvalidThrow(InvalidRequestException.class,String.format("CREATE TABLE %s (k int PRIMARY KEY, s set<counter>)",tableName));
  tableName=KEYSPACE + "." + createTableName();
  assertInvalidThrow(InvalidRequestException.class,String.format("CREATE TABLE %s (k int PRIMARY KEY, m map<text, counter>)",tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check for a table with counters,
 * migrated from cql_tests.py:TestCQL.counters_test()
 */
@Test public void testCounters() throws Throwable {
  createTable("CREATE TABLE %s (userid int, url text, total counter, PRIMARY KEY (userid, url)) WITH COMPACT STORAGE");
  execute("UPDATE %s SET total = total + 1 WHERE userid = 1 AND url = 'http://foo.com'");
  assertRows(execute("SELECT total FROM %s WHERE userid = 1 AND url = 'http://foo.com'"),row(1L));
  execute("UPDATE %s SET total = total - 4 WHERE userid = 1 AND url = 'http://foo.com'");
  assertRows(execute("SELECT total FROM %s WHERE userid = 1 AND url = 'http://foo.com'"),row(-3L));
  execute("UPDATE %s SET total = total+1 WHERE userid = 1 AND url = 'http://foo.com'");
  assertRows(execute("SELECT total FROM %s WHERE userid = 1 AND url = 'http://foo.com'"),row(-2L));
  execute("UPDATE %s SET total = total -2 WHERE userid = 1 AND url = 'http://foo.com'");
  assertRows(execute("SELECT total FROM %s WHERE userid = 1 AND url = 'http://foo.com'"),row(-4L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for the validation bug of #4706,
 * migrated from cql_tests.py:TestCQL.validate_counter_regular_test()
 */
@Test public void testRegularCounters() throws Throwable {
  assertInvalidThrowMessage("Cannot mix counter and non counter columns in the same table",InvalidRequestException.class,String.format("CREATE TABLE %s.%s (id bigint PRIMARY KEY, count counter, things set<text>)",KEYSPACE,createTableName()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.DateTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check dates are correctly recognized and validated,
 * migrated from cql_tests.py:TestCQL.date_test()
 */
@Test public void testDate() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, t timestamp)");
  execute("INSERT INTO %s (k, t) VALUES (0, '2011-02-03')");
  assertInvalid("INSERT INTO %s (k, t) VALUES (0, '2011-42-42')");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.FrozenCollectionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenListInList() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, l list<frozen<list<int>>>)");
  execute("INSERT INTO %s (k, l) VALUES (1, [[1, 2, 3]])");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(1,2,3))));
  execute("UPDATE %s SET l[?]=? WHERE k=1",0,list(4,5,6));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(4,5,6))));
  execute("UPDATE %s SET l = ? + l WHERE k=1",list(list(1,2,3)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(1,2,3),list(4,5,6))));
  execute("UPDATE %s SET l = l + ? WHERE k=1",list(list(7,8,9)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(1,2,3),list(4,5,6),list(7,8,9))));
  execute("UPDATE %s SET l = l - ? WHERE k=1",list(list(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(1,2,3),list(7,8,9))));
  execute("DELETE l[0] FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(list(7,8,9))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringKeyUsage() throws Throwable {
  for (  String option : Arrays.asList(""," WITH COMPACT STORAGE")) {
    createTable("CREATE TABLE %s (a int, b frozen<set<int>>, c int, PRIMARY KEY (a, b))" + option);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,set(),1);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,set(1,2,3),1);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,set(4,5,6),0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,set(7,8,9),0);
    execute("UPDATE %s SET c=? WHERE a=? AND b=?",0,0,set());
    execute("UPDATE %s SET c=? WHERE a=? AND b=?",0,0,set(1,2,3));
    assertRows(execute("SELECT * FROM %s"),row(0,set(),0),row(0,set(1,2,3),0),row(0,set(4,5,6),0),row(0,set(7,8,9),0));
    assertRows(execute("SELECT b FROM %s"),row(set()),row(set(1,2,3)),row(set(4,5,6)),row(set(7,8,9)));
    assertRows(execute("SELECT * FROM %s LIMIT 2"),row(0,set(),0),row(0,set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,set(4,5,6)),row(0,set(4,5,6),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,set()),row(0,set(),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b IN ?",0,list(set(4,5,6),set())),row(0,set(),0),row(0,set(4,5,6),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b > ?",0,set(4,5,6)),row(0,set(7,8,9),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b >= ?",0,set(4,5,6)),row(0,set(4,5,6),0),row(0,set(7,8,9),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b < ?",0,set(4,5,6)),row(0,set(),0),row(0,set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b <= ?",0,set(4,5,6)),row(0,set(),0),row(0,set(1,2,3),0),row(0,set(4,5,6),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b > ? AND b <= ?",0,set(1,2,3),set(4,5,6)),row(0,set(4,5,6),0));
    execute("DELETE FROM %s WHERE a=? AND b=?",0,set());
    execute("DELETE FROM %s WHERE a=? AND b=?",0,set(4,5,6));
    assertRows(execute("SELECT * FROM %s"),row(0,set(1,2,3),0),row(0,set(7,8,9),0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenSetInSet() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, s set<frozen<set<int>>>)");
  execute("INSERT INTO %s (k, s) VALUES (1, {{1, 2, 3}})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(set(1,2,3))));
  execute("UPDATE %s SET s = s + ? WHERE k=1",set(set(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(set(1,2,3),set(4,5,6))));
  execute("UPDATE %s SET s = s - ? WHERE k=1",set(set(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(set(1,2,3))));
  execute("DELETE s[?] FROM %s WHERE k = 1",set(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecondaryIndex() throws Throwable {
  createTable("CREATE TABLE %s (a frozen<map<int, text>> PRIMARY KEY, b frozen<map<int, text>>)");
  assertInvalidIndexCreationWithMessage("CREATE INDEX ON %s (full(a))","Cannot create secondary index on partition key column");
  assertInvalidIndexCreationWithMessage("CREATE INDEX ON %s (keys(a))","Cannot create secondary index on partition key column");
  assertInvalidIndexCreationWithMessage("CREATE INDEX ON %s (keys(b))","Cannot create keys() index on frozen column b. " + "Frozen collections only support full() indexes");
  createTable("CREATE TABLE %s (a int, b frozen<list<int>>, c frozen<set<int>>, d frozen<map<int, text>>, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX ON %s (full(b))");
  createIndex("CREATE INDEX ON %s (full(c))");
  createIndex("CREATE INDEX ON %s (full(d))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,list(1,2,3),set(1,2,3),map(1,"a"));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,list(4,5,6),set(1,2,3),map(1,"a"));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,list(1,2,3),set(4,5,6),map(2,"b"));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,list(4,5,6),set(4,5,6),map(2,"b"));
  assertInvalidMessage("Cannot use CONTAINS KEY on non-map column","SELECT * FROM %s WHERE b CONTAINS KEY ?",1);
  assertInvalidMessage("Cannot use CONTAINS KEY on non-map column","SELECT * FROM %s WHERE b CONTAINS KEY ? ALLOW FILTERING",1);
  assertInvalidMessage("Cannot use CONTAINS KEY on non-map column","SELECT * FROM %s WHERE c CONTAINS KEY ?",1);
  assertInvalidMessage("Cannot restrict clustering columns by a CONTAINS relation without a secondary index","SELECT * FROM %s WHERE b CONTAINS ?",1);
  assertInvalidMessage("Cannot restrict clustering columns by a CONTAINS relation without a secondary index","SELECT * FROM %s WHERE b CONTAINS ? ALLOW FILTERING",1);
  assertInvalidMessage("No supported secondary index found for the non primary key columns restrictions","SELECT * FROM %s WHERE d CONTAINS KEY ?",1);
  assertInvalidMessage("Cannot restrict clustering columns by a CONTAINS relation without a secondary index","SELECT * FROM %s WHERE b CONTAINS ? AND d CONTAINS KEY ? ALLOW FILTERING",1,1);
  assertRows(execute("SELECT * FROM %s WHERE b=?",list(1,2,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(1,list(1,2,3),set(4,5,6),map(2,"b")));
  assertEmpty(execute("SELECT * FROM %s WHERE b=?",list(-1)));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE b=? AND c=?",list(1,2,3),set(4,5,6));
  assertRows(execute("SELECT * FROM %s WHERE b=? AND c=? ALLOW FILTERING",list(1,2,3),set(4,5,6)),row(1,list(1,2,3),set(4,5,6),map(2,"b")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE b=? AND c CONTAINS ?",list(1,2,3),5);
  assertRows(execute("SELECT * FROM %s WHERE b=? AND c CONTAINS ? ALLOW FILTERING",list(1,2,3),5),row(1,list(1,2,3),set(4,5,6),map(2,"b")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE b=? AND d=?",list(1,2,3),map(1,"a"));
  assertRows(execute("SELECT * FROM %s WHERE b=? AND d=? ALLOW FILTERING",list(1,2,3),map(1,"a")),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE b=? AND d CONTAINS ?",list(1,2,3),"a");
  assertRows(execute("SELECT * FROM %s WHERE b=? AND d CONTAINS ? ALLOW FILTERING",list(1,2,3),"a"),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE b=? AND d CONTAINS KEY ?",list(1,2,3),1);
  assertRows(execute("SELECT * FROM %s WHERE b=? AND d CONTAINS KEY ? ALLOW FILTERING",list(1,2,3),1),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE c=?",set(1,2,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE c=?",set(2,1,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertEmpty(execute("SELECT * FROM %s WHERE c=?",set(-1)));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE c=? AND b=?",set(1,2,3),list(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE c=? AND b=? ALLOW FILTERING",set(1,2,3),list(1,2,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE c=? AND b CONTAINS ?",set(1,2,3),1);
  assertRows(execute("SELECT * FROM %s WHERE c=? AND b CONTAINS ? ALLOW FILTERING",set(1,2,3),1),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE c=? AND d = ?",set(1,2,3),map(1,"a"));
  assertRows(execute("SELECT * FROM %s WHERE c=? AND d = ? ALLOW FILTERING",set(1,2,3),map(1,"a")),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE c=? AND d CONTAINS ?",set(1,2,3),"a");
  assertRows(execute("SELECT * FROM %s WHERE c=? AND d CONTAINS ? ALLOW FILTERING",set(1,2,3),"a"),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE c=? AND d CONTAINS KEY ?",set(1,2,3),1);
  assertRows(execute("SELECT * FROM %s WHERE c=? AND d CONTAINS KEY ? ALLOW FILTERING",set(1,2,3),1),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE d=?",map(1,"a")),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE d=?",map(2,"b")),row(1,list(1,2,3),set(4,5,6),map(2,"b")),row(1,list(4,5,6),set(4,5,6),map(2,"b")));
  assertEmpty(execute("SELECT * FROM %s WHERE d=?",map(3,"c")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE d=? AND c=?",map(1,"a"),set(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b=? ALLOW FILTERING",map(1,"a"),list(1,2,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE d=? AND b CONTAINS ?",map(1,"a"),3);
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b CONTAINS ? ALLOW FILTERING",map(1,"a"),3),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertInvalidMessage("ALLOW FILTERING","SELECT * FROM %s WHERE d=? AND b=? AND c=?",map(1,"a"),list(1,2,3),set(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b=? AND c=? ALLOW FILTERING",map(1,"a"),list(1,2,3),set(1,2,3)),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b CONTAINS ? AND c CONTAINS ? ALLOW FILTERING",map(1,"a"),2,2),row(0,list(1,2,3),set(1,2,3),map(1,"a")));
  assertRows(execute("SELECT * FROM %s WHERE d CONTAINS KEY ? ALLOW FILTERING",1),row(0,list(1,2,3),set(1,2,3),map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
  execute("DELETE d FROM %s WHERE a=? AND b=?",0,list(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE d=?",map(1,"a")),row(0,list(4,5,6),set(1,2,3),map(1,"a")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStaticColumnUsage() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c frozen<map<set<int>, list<int>>> static, d int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,map(),0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,map(),0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,map(set(),list(1,2,3)),0);
  execute("INSERT INTO %s (a, b, d) VALUES (?, ?, ?)",1,1,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",2,0,map(set(1,2,3),list(1,2,3)),0);
  assertRows(execute("SELECT * FROM %s"),row(0,0,map(),0),row(0,1,map(),0),row(1,0,map(set(),list(1,2,3)),0),row(1,1,map(set(),list(1,2,3)),0),row(2,0,map(set(1,2,3),list(1,2,3)),0));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,1),row(0,1,map(),0));
  execute("DELETE c FROM %s WHERE a=?",0);
  assertRows(execute("SELECT * FROM %s"),row(0,0,null,0),row(0,1,null,0),row(1,0,map(set(),list(1,2,3)),0),row(1,1,map(set(),list(1,2,3)),0),row(2,0,map(set(1,2,3),list(1,2,3)),0));
  execute("DELETE FROM %s WHERE a=?",0);
  assertRows(execute("SELECT * FROM %s"),row(1,0,map(set(),list(1,2,3)),0),row(1,1,map(set(),list(1,2,3)),0),row(2,0,map(set(1,2,3),list(1,2,3)),0));
  execute("UPDATE %s SET c=? WHERE a=?",map(set(1,2,3),list(1,2,3)),1);
  assertRows(execute("SELECT * FROM %s"),row(1,0,map(set(1,2,3),list(1,2,3)),0),row(1,1,map(set(1,2,3),list(1,2,3)),0),row(2,0,map(set(1,2,3),list(1,2,3)),0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserDefinedTypes() throws Throwable {
  String myType=createType("CREATE TYPE %s (a set<int>, b tuple<list<int>>)");
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v frozen<" + myType + ">)");
  execute("INSERT INTO %s (k, v) VALUES (?, {a: ?, b: ?})",0,set(1,2,3),tuple(list(1,2,3)));
  assertRows(execute("SELECT v.a, v.b FROM %s WHERE k=?",0),row(set(1,2,3),tuple(list(1,2,3))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidOperations() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l frozen<list<int>>)");
  assertInvalid("UPDATE %s SET l[?]=? WHERE k=?",0,0,0);
  assertInvalid("UPDATE %s SET l = ? + l WHERE k=?",list(0),0);
  assertInvalid("UPDATE %s SET l = l + ? WHERE k=?",list(4),0);
  assertInvalid("UPDATE %s SET l = l - ? WHERE k=?",list(3),0);
  assertInvalid("DELETE l[?] FROM %s WHERE k=?",0,0);
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s frozen<set<int>>)");
  assertInvalid("UPDATE %s SET s = s + ? WHERE k=?",set(0),0);
  assertInvalid("UPDATE %s SET s = s - ? WHERE k=?",set(3),0);
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m frozen<map<int, int>>)");
  assertInvalid("UPDATE %s SET m[?]=? WHERE k=?",0,0,0);
  assertInvalid("UPDATE %s SET m = m + ? WHERE k=?",map(4,4),0);
  assertInvalid("DELETE m[?] FROM %s WHERE k=?",0,0);
  assertInvalidCreateWithMessage("CREATE TABLE %s (k int PRIMARY KEY, t set<set<int>>)","Non-frozen collections are not allowed inside collections");
  assertInvalidCreateWithMessage("CREATE TABLE %s (k int PRIMARY KEY, t frozen<set<counter>>)","Counters are not allowed inside collections");
  assertInvalidCreateWithMessage("CREATE TABLE %s (k int PRIMARY KEY, t frozen<text>)","frozen<> is only allowed on collections, tuples, and user-defined types");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedPartitionKeyUsage() throws Throwable {
  createTable("CREATE TABLE %s (k frozen<map<set<int>, list<int>>> PRIMARY KEY, v int)");
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",map(),1);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",map(set(),list(1,2,3)),0);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",map(set(1,2,3),list(1,2,3)),1);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",map(set(4,5,6),list(1,2,3)),0);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",map(set(7,8,9),list(1,2,3)),0);
  execute("UPDATE %s SET v=? WHERE k=?",0,map());
  execute("UPDATE %s SET v=? WHERE k=?",0,map(set(1,2,3),list(1,2,3)));
  assertRows(execute("SELECT * FROM %s"),row(map(),0),row(map(set(),list(1,2,3)),0),row(map(set(1,2,3),list(1,2,3)),0),row(map(set(4,5,6),list(1,2,3)),0),row(map(set(7,8,9),list(1,2,3)),0));
  assertRows(execute("SELECT k FROM %s"),row(map()),row(map(set(),list(1,2,3))),row(map(set(1,2,3),list(1,2,3))),row(map(set(4,5,6),list(1,2,3))),row(map(set(7,8,9),list(1,2,3))));
  assertRows(execute("SELECT * FROM %s LIMIT 3"),row(map(),0),row(map(set(),list(1,2,3)),0),row(map(set(1,2,3),list(1,2,3)),0));
  assertRows(execute("SELECT * FROM %s WHERE k=?",map(set(4,5,6),list(1,2,3))),row(map(set(4,5,6),list(1,2,3)),0));
  assertRows(execute("SELECT * FROM %s WHERE k=?",map()),row(map(),0));
  assertRows(execute("SELECT * FROM %s WHERE k=?",map(set(),list(1,2,3))),row(map(set(),list(1,2,3)),0));
  assertRows(execute("SELECT * FROM %s WHERE k IN ?",list(map(set(4,5,6),list(1,2,3)),map(),map(set(),list(1,2,3)))),row(map(),0),row(map(set(),list(1,2,3)),0),row(map(set(4,5,6),list(1,2,3)),0));
  assertRows(execute("SELECT * FROM %s WHERE token(k) >= token(?)",map(set(4,5,6),list(1,2,3))),row(map(set(4,5,6),list(1,2,3)),0),row(map(set(7,8,9),list(1,2,3)),0));
  execute("DELETE FROM %s WHERE k=?",map());
  execute("DELETE FROM %s WHERE k=?",map(set(),list(1,2,3)));
  execute("DELETE FROM %s WHERE k=?",map(set(4,5,6),list(1,2,3)));
  assertRows(execute("SELECT * FROM %s"),row(map(set(1,2,3),list(1,2,3)),0),row(map(set(7,8,9),list(1,2,3)),0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalColumnUsage() throws Throwable {
  for (  String option : Arrays.asList(""," WITH COMPACT STORAGE")) {
    createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<map<set<int>, list<int>>>, c frozen<set<int>>)" + option);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,map(),set());
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,map(set(),list(99999,999999,99999)),set());
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",2,map(set(1,2,3),list(1,2,3)),set(1,2,3));
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",3,map(set(4,5,6),list(1,2,3)),set(1,2,3));
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",4,map(set(7,8,9),list(1,2,3)),set(1,2,3));
    execute("UPDATE %s SET b=? WHERE a=?",map(set(),list(1,2,3)),1);
    assertRows(execute("SELECT * FROM %s"),row(0,map(),set()),row(1,map(set(),list(1,2,3)),set()),row(2,map(set(1,2,3),list(1,2,3)),set(1,2,3)),row(3,map(set(4,5,6),list(1,2,3)),set(1,2,3)),row(4,map(set(7,8,9),list(1,2,3)),set(1,2,3)));
    assertRows(execute("SELECT b FROM %s"),row(map()),row(map(set(),list(1,2,3))),row(map(set(1,2,3),list(1,2,3))),row(map(set(4,5,6),list(1,2,3))),row(map(set(7,8,9),list(1,2,3))));
    assertRows(execute("SELECT c FROM %s"),row(set()),row(set()),row(set(1,2,3)),row(set(1,2,3)),row(set(1,2,3)));
    assertRows(execute("SELECT * FROM %s WHERE a=?",3),row(3,map(set(4,5,6),list(1,2,3)),set(1,2,3)));
    execute("UPDATE %s SET b=? WHERE a=?",null,1);
    assertRows(execute("SELECT * FROM %s WHERE a=?",1),row(1,null,set()));
    execute("UPDATE %s SET b=? WHERE a=?",map(),1);
    assertRows(execute("SELECT * FROM %s WHERE a=?",1),row(1,map(),set()));
    execute("UPDATE %s SET c=? WHERE a=?",null,2);
    assertRows(execute("SELECT * FROM %s WHERE a=?",2),row(2,map(set(1,2,3),list(1,2,3)),null));
    execute("UPDATE %s SET c=? WHERE a=?",set(),2);
    assertRows(execute("SELECT * FROM %s WHERE a=?",2),row(2,map(set(1,2,3),list(1,2,3)),set()));
    execute("DELETE b FROM %s WHERE a=?",3);
    assertRows(execute("SELECT * FROM %s WHERE a=?",3),row(3,null,set(1,2,3)));
    execute("DELETE c FROM %s WHERE a=?",4);
    assertRows(execute("SELECT * FROM %s WHERE a=?",4),row(4,map(set(7,8,9),list(1,2,3)),null));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartitionKeyUsage() throws Throwable {
  createTable("CREATE TABLE %s (k frozen<set<int>> PRIMARY KEY, v int)");
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",set(),1);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",set(1,2,3),1);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",set(4,5,6),0);
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",set(7,8,9),0);
  execute("UPDATE %s SET v=? WHERE k=?",0,set());
  execute("UPDATE %s SET v=? WHERE k=?",0,set(1,2,3));
  assertRows(execute("SELECT * FROM %s"),row(set(),0),row(set(1,2,3),0),row(set(4,5,6),0),row(set(7,8,9),0));
  assertRows(execute("SELECT k FROM %s"),row(set()),row(set(1,2,3)),row(set(4,5,6)),row(set(7,8,9)));
  assertRows(execute("SELECT * FROM %s LIMIT 2"),row(set(),0),row(set(1,2,3),0));
  assertRows(execute("SELECT * FROM %s WHERE k=?",set(4,5,6)),row(set(4,5,6),0));
  assertRows(execute("SELECT * FROM %s WHERE k=?",set()),row(set(),0));
  assertRows(execute("SELECT * FROM %s WHERE k IN ?",list(set(4,5,6),set())),row(set(),0),row(set(4,5,6),0));
  assertRows(execute("SELECT * FROM %s WHERE token(k) >= token(?)",set(4,5,6)),row(set(4,5,6),0),row(set(7,8,9),0));
  assertInvalid("INSERT INTO %s (k, v) VALUES (null, 0)");
  execute("DELETE FROM %s WHERE k=?",set());
  execute("DELETE FROM %s WHERE k=?",set(4,5,6));
  assertRows(execute("SELECT * FROM %s"),row(set(1,2,3),0),row(set(7,8,9),0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedClusteringKeyUsage() throws Throwable {
  for (  String option : Arrays.asList(""," WITH COMPACT STORAGE")) {
    createTable("CREATE TABLE %s (a int, b frozen<map<set<int>, list<int>>>, c frozen<set<int>>, d int, PRIMARY KEY (a, b, c))" + option);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(),set(),0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(set(),list(1,2,3)),set(),0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0);
    assertRows(execute("SELECT * FROM %s"),row(0,map(),set(),0),row(0,map(set(),list(1,2,3)),set(),0),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0),row(0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT b FROM %s"),row(map()),row(map(set(),list(1,2,3))),row(map(set(1,2,3),list(1,2,3))),row(map(set(4,5,6),list(1,2,3))),row(map(set(7,8,9),list(1,2,3))));
    assertRows(execute("SELECT c FROM %s"),row(set()),row(set()),row(set(1,2,3)),row(set(1,2,3)),row(set(1,2,3)));
    assertRows(execute("SELECT * FROM %s LIMIT 3"),row(0,map(),set(),0),row(0,map(set(),list(1,2,3)),set(),0),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=0 ORDER BY b DESC LIMIT 4"),row(0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0),row(0,map(set(),list(1,2,3)),set(),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,map()),row(0,map(),set(),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,map(set(),list(1,2,3))),row(0,map(set(),list(1,2,3)),set(),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=?",0,map(set(1,2,3),list(1,2,3))),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b=? AND c=?",0,map(set(),list(1,2,3)),set()),row(0,map(set(),list(1,2,3)),set(),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND (b, c) IN ?",0,list(tuple(map(set(4,5,6),list(1,2,3)),set(1,2,3)),tuple(map(),set()))),row(0,map(),set(),0),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b > ?",0,map(set(4,5,6),list(1,2,3))),row(0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b >= ?",0,map(set(4,5,6),list(1,2,3))),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0),row(0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b < ?",0,map(set(4,5,6),list(1,2,3))),row(0,map(),set(),0),row(0,map(set(),list(1,2,3)),set(),0),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b <= ?",0,map(set(4,5,6),list(1,2,3))),row(0,map(),set(),0),row(0,map(set(),list(1,2,3)),set(),0),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND b > ? AND b <= ?",0,map(set(1,2,3),list(1,2,3)),map(set(4,5,6),list(1,2,3))),row(0,map(set(4,5,6),list(1,2,3)),set(1,2,3),0));
    execute("DELETE FROM %s WHERE a=? AND b=? AND c=?",0,map(),set());
    assertEmpty(execute("SELECT * FROM %s WHERE a=? AND b=? AND c=?",0,map(),set()));
    execute("DELETE FROM %s WHERE a=? AND b=? AND c=?",0,map(set(),list(1,2,3)),set());
    assertEmpty(execute("SELECT * FROM %s WHERE a=? AND b=? AND c=?",0,map(set(),list(1,2,3)),set()));
    execute("DELETE FROM %s WHERE a=? AND b=? AND c=?",0,map(set(4,5,6),list(1,2,3)),set(1,2,3));
    assertEmpty(execute("SELECT * FROM %s WHERE a=? AND b=? AND c=?",0,map(set(4,5,6),list(1,2,3)),set(1,2,3)));
    assertRows(execute("SELECT * FROM %s"),row(0,map(set(1,2,3),list(1,2,3)),set(1,2,3),0),row(0,map(set(7,8,9),list(1,2,3)),set(1,2,3),0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenListInSet() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, s set<frozen<list<int>>>)");
  execute("INSERT INTO %s (k, s) VALUES (1, {[1, 2, 3]})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(list(1,2,3))));
  execute("UPDATE %s SET s = s + ? WHERE k=1",set(list(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(list(1,2,3),list(4,5,6))));
  execute("UPDATE %s SET s = s - ? WHERE k=1",set(list(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(list(1,2,3))));
  execute("DELETE s[[1, 2, 3]] FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListWithElementsBiggerThan64K() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l frozen<list<text>>)");
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  execute("INSERT INTO %s(k, l) VALUES (0, ?)",list(largeText,"v2"));
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(largeText,"v2")));
  execute("UPDATE %s SET l = ? WHERE k = 0",list("v1",largeText));
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1",largeText)));
  execute("DELETE l FROM %s WHERE k = 0");
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, l) VALUES (0, ['" + largeText + "', 'v2'])");
  flush();
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(largeText,"v2")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetsWithElementsBiggerThan64K() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s frozen<set<text>>)");
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  execute("INSERT INTO %s(k, s) VALUES (0, ?)",set(largeText,"v1","v2"));
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set(largeText,"v1","v2")));
  execute("UPDATE %s SET s = ? WHERE k = 0",set(largeText,"v3"));
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set(largeText,"v3")));
  execute("DELETE s FROM %s WHERE k = 0");
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, s) VALUES (0, {'" + largeText + "', 'v1', 'v2'})");
  flush();
  assertRows(execute("SELECT s FROM %s WHERE k = 0"),row(set(largeText,"v1","v2")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenMapInList() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, l list<frozen<map<int, int>>>)");
  execute("INSERT INTO %s (k, l) VALUES (1, [{1 : 1, 2 : 2}])");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(1,1,2,2))));
  execute("UPDATE %s SET l[?]=? WHERE k=1",0,map(3,3,4,4));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(3,3,4,4))));
  execute("UPDATE %s SET l = ? + l WHERE k=1",list(map(1,1,2,2)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(1,1,2,2),map(3,3,4,4))));
  execute("UPDATE %s SET l = l + ? WHERE k=1",list(map(5,5,6,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(1,1,2,2),map(3,3,4,4),map(5,5,6,6))));
  execute("UPDATE %s SET l = l - ? WHERE k=1",list(map(3,3,4,4)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(1,1,2,2),map(5,5,6,6))));
  execute("DELETE l[0] FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(map(5,5,6,6))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenMapInMap() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, m map<frozen<map<int, int>>, int>)");
  execute("INSERT INTO %s (k, m) VALUES (1, {{1 : 1, 2 : 2} : 1})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(map(1,1,2,2),1)));
  execute("UPDATE %s SET m[?]=2 WHERE k=1",map(1,1,2,2));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(map(1,1,2,2),2)));
  execute("UPDATE %s SET m = m + ? WHERE k=1",map(map(3,3,4,4),3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(map(1,1,2,2),2,map(3,3,4,4),3)));
  execute("DELETE m[?] FROM %s WHERE k = 1",map(1,1,2,2));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(map(3,3,4,4),3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenMapInSet() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, s set<frozen<map<int, int>>>)");
  execute("INSERT INTO %s (k, s) VALUES (1, {{1 : 1, 2 : 2}})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(map(1,1,2,2))));
  execute("UPDATE %s SET s = s + ? WHERE k=1",set(map(3,3,4,4)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(map(1,1,2,2),map(3,3,4,4))));
  execute("UPDATE %s SET s = s - ? WHERE k=1",set(map(3,3,4,4)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,set(map(1,1,2,2))));
  execute("DELETE s[?] FROM %s WHERE k = 1",map(1,1,2,2));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAltering() throws Throwable {
  createTable("CREATE TABLE %s (a int, b frozen<list<int>>, c frozen<list<int>>, PRIMARY KEY (a, b))");
  alterTable("ALTER TABLE %s ALTER c TYPE frozen<list<blob>>");
  assertInvalidAlterWithMessage("ALTER TABLE %s ALTER b TYPE frozen<list<blob>>","types are not order-compatible");
  assertInvalidAlterWithMessage("ALTER TABLE %s ALTER b TYPE list<int>","types are not order-compatible");
  assertInvalidAlterWithMessage("ALTER TABLE %s ALTER c TYPE list<blob>","types are incompatible");
  alterTable("ALTER TABLE %s DROP c");
  alterTable("ALTER TABLE %s ADD c frozen<set<int>>");
  assertInvalidAlterWithMessage("ALTER TABLE %s ALTER c TYPE frozen<set<blob>>","types are incompatible");
  alterTable("ALTER TABLE %s DROP c");
  alterTable("ALTER TABLE %s ADD c frozen<map<int, int>>");
  assertInvalidAlterWithMessage("ALTER TABLE %s ALTER c TYPE frozen<map<blob, int>>","types are incompatible");
  alterTable("ALTER TABLE %s ALTER c TYPE frozen<map<int, blob>>");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenSetInList() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, l list<frozen<set<int>>>)");
  execute("INSERT INTO %s (k, l) VALUES (1, [{1, 2, 3}])");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(1,2,3))));
  execute("UPDATE %s SET l[?]=? WHERE k=1",0,set(4,5,6));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(4,5,6))));
  execute("UPDATE %s SET l = ? + l WHERE k=1",list(set(1,2,3)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(1,2,3),set(4,5,6))));
  execute("UPDATE %s SET l = l + ? WHERE k=1",list(set(7,8,9)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(1,2,3),set(4,5,6),set(7,8,9))));
  execute("UPDATE %s SET l = l - ? WHERE k=1",list(set(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(1,2,3),set(7,8,9))));
  execute("DELETE l[0] FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,list(set(7,8,9))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenSetInMap() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, m map<frozen<set<int>>, int>)");
  execute("INSERT INTO %s (k, m) VALUES (1, {{1, 2, 3} : 1})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(set(1,2,3),1)));
  execute("UPDATE %s SET m[?]=2 WHERE k=1",set(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(set(1,2,3),2)));
  execute("UPDATE %s SET m = m + ? WHERE k=1",map(set(4,5,6),3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(set(1,2,3),2,set(4,5,6),3)));
  execute("DELETE m[?] FROM %s WHERE k = 1",set(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(set(4,5,6),3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapsWithElementsBiggerThan64K() throws Throwable {
  byte[] bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)1);
  String largeText=new String(bytes);
  bytes=new byte[FBUtilities.MAX_UNSIGNED_SHORT + 10];
  Arrays.fill(bytes,(byte)2);
  String largeText2=new String(bytes);
  createTable("CREATE TABLE %s (k int PRIMARY KEY, m frozen<map<text, text>>)");
  execute("INSERT INTO %s(k, m) VALUES (0, ?)",map(largeText,"v1","k2",largeText));
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map(largeText,"v1","k2",largeText)));
  execute("UPDATE %s SET m = ? WHERE k = 0",map("k5",largeText,largeText2,"v6"));
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map("k5",largeText,largeText2,"v6")));
  execute("DELETE m FROM %s WHERE k = 0");
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row((Object)null));
  execute("INSERT INTO %s(k, m) VALUES (0, {'" + largeText + "' : 'v1', 'k2' : '"+ largeText+ "'})");
  flush();
  assertRows(execute("SELECT m FROM %s WHERE k = 0"),row(map(largeText,"v1","k2",largeText)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-8302 
 */
@Test public void testClusteringColumnFiltering() throws Throwable {
  createTable("CREATE TABLE %s (a int, b frozen<map<int, int>>, c int, d int, PRIMARY KEY (a, b, c))");
  createIndex("CREATE INDEX c_index ON %s (c)");
  createIndex("CREATE INDEX d_index ON %s (d)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(0,0,1,1),0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,map(1,1,2,2),0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,map(0,0,1,1),0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,map(1,1,2,2),0,0);
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b CONTAINS ? ALLOW FILTERING",0,0),row(0,map(0,0,1,1),0,0),row(1,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE d=? AND b CONTAINS KEY ? ALLOW FILTERING",0,0),row(0,map(0,0,1,1),0,0),row(1,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND d=? AND b CONTAINS ? ALLOW FILTERING",0,0,0),row(0,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND d=? AND b CONTAINS KEY ? ALLOW FILTERING",0,0,0),row(0,map(0,0,1,1),0,0));
  dropIndex("DROP INDEX %s.d_index");
  assertRows(execute("SELECT * FROM %s WHERE c=? AND b CONTAINS ? ALLOW FILTERING",0,0),row(0,map(0,0,1,1),0,0),row(1,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE c=? AND b CONTAINS KEY ? ALLOW FILTERING",0,0),row(0,map(0,0,1,1),0,0),row(1,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND c=? AND b CONTAINS ? ALLOW FILTERING",0,0,0),row(0,map(0,0,1,1),0,0));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND c=? AND b CONTAINS KEY ? ALLOW FILTERING",0,0,0),row(0,map(0,0,1,1),0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFrozenListInMap() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, m map<frozen<list<int>>, int>)");
  execute("INSERT INTO %s (k, m) VALUES (1, {[1, 2, 3] : 1})");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(list(1,2,3),1)));
  execute("UPDATE %s SET m[[1, 2, 3]]=2 WHERE k=1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(list(1,2,3),2)));
  execute("UPDATE %s SET m = m + ? WHERE k=1",map(list(4,5,6),3));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(list(1,2,3),2,list(4,5,6),3)));
  execute("DELETE m[[1, 2, 3]] FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,map(list(4,5,6),3)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.JsonTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertJsonSyntaxWithNonNativeMapKeys() throws Throwable {
  String typeName=createType("CREATE TYPE %s (a int)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "intmap map<int, boolean>, "+ "bigintmap map<bigint, boolean>, "+ "varintmap map<varint, boolean>, "+ "booleanmap map<boolean, boolean>, "+ "floatmap map<float, boolean>, "+ "doublemap map<double, boolean>, "+ "decimalmap map<decimal, boolean>, "+ "tuplemap map<frozen<tuple<int, text>>, boolean>, "+ "udtmap map<frozen<" + typeName + ">, boolean>, "+ "setmap map<frozen<set<int>>, boolean>, "+ "listmap map<frozen<list<int>>, boolean>, "+ "textsetmap map<frozen<set<text>>, boolean>, "+ "nestedsetmap map<frozen<map<set<text>, text>>, boolean>, "+ "frozensetmap frozen<map<set<int>, boolean>>)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"intmap\": {\"0\": true, \"1\": false}}");
  assertRows(execute("SELECT JSON k, intmap FROM %s"),row("{\"k\": 0, \"intmap\": {\"0\": true, \"1\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"bigintmap\": {\"0\": true, \"1\": false}}");
  assertRows(execute("SELECT JSON k, bigintmap FROM %s"),row("{\"k\": 0, \"bigintmap\": {\"0\": true, \"1\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"varintmap\": {\"0\": true, \"1\": false}}");
  assertRows(execute("SELECT JSON k, varintmap FROM %s"),row("{\"k\": 0, \"varintmap\": {\"0\": true, \"1\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"booleanmap\": {\"true\": true, \"false\": false}}");
  assertRows(execute("SELECT JSON k, booleanmap FROM %s"),row("{\"k\": 0, \"booleanmap\": {\"false\": false, \"true\": true}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"floatmap\": {\"1.23\": true, \"4.56\": false}}");
  assertRows(execute("SELECT JSON k, floatmap FROM %s"),row("{\"k\": 0, \"floatmap\": {\"1.23\": true, \"4.56\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"doublemap\": {\"1.23\": true, \"4.56\": false}}");
  assertRows(execute("SELECT JSON k, doublemap FROM %s"),row("{\"k\": 0, \"doublemap\": {\"1.23\": true, \"4.56\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"decimalmap\": {\"1.23\": true, \"4.56\": false}}");
  assertRows(execute("SELECT JSON k, decimalmap FROM %s"),row("{\"k\": 0, \"decimalmap\": {\"1.23\": true, \"4.56\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"tuplemap\": {\"[0, \\\"a\\\"]\": true, \"[1, \\\"b\\\"]\": false}}");
  assertRows(execute("SELECT JSON k, tuplemap FROM %s"),row("{\"k\": 0, \"tuplemap\": {\"[0, \\\"a\\\"]\": true, \"[1, \\\"b\\\"]\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"udtmap\": {\"{\\\"a\\\": 0}\": true, \"{\\\"a\\\": 1}\": false}}");
  assertRows(execute("SELECT JSON k, udtmap FROM %s"),row("{\"k\": 0, \"udtmap\": {\"{\\\"a\\\": 0}\": true, \"{\\\"a\\\": 1}\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"setmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}");
  assertRows(execute("SELECT JSON k, setmap FROM %s"),row("{\"k\": 0, \"setmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"listmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}");
  assertRows(execute("SELECT JSON k, listmap FROM %s"),row("{\"k\": 0, \"listmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"textsetmap\": {\"[\\\"0\\\", \\\"1\\\"]\": true, \"[\\\"3\\\", \\\"4\\\"]\": false}}");
  assertRows(execute("SELECT JSON k, textsetmap FROM %s"),row("{\"k\": 0, \"textsetmap\": {\"[\\\"0\\\", \\\"1\\\"]\": true, \"[\\\"3\\\", \\\"4\\\"]\": false}}"));
  String innerKey1="[\"0\", \"1\"]";
  String fullKey1=String.format("{\"%s\": \"%s\"}",new String(Json.JSON_STRING_ENCODER.quoteAsString(innerKey1)),"a");
  String stringKey1=new String(Json.JSON_STRING_ENCODER.quoteAsString(fullKey1));
  String innerKey2="[\"3\", \"4\"]";
  String fullKey2=String.format("{\"%s\": \"%s\"}",new String(Json.JSON_STRING_ENCODER.quoteAsString(innerKey2)),"b");
  String stringKey2=new String(Json.JSON_STRING_ENCODER.quoteAsString(fullKey2));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"nestedsetmap\": {\"" + stringKey1 + "\": true, \""+ stringKey2+ "\": false}}");
  assertRows(execute("SELECT JSON k, nestedsetmap FROM %s"),row("{\"k\": 0, \"nestedsetmap\": {\"" + stringKey1 + "\": true, \""+ stringKey2+ "\": false}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"frozensetmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}");
  assertRows(execute("SELECT JSON k, frozensetmap FROM %s"),row("{\"k\": 0, \"frozensetmap\": {\"[0, 1, 2]\": true, \"[3, 4, 5]\": false}}"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCaseSensitivity() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, \"Foo\" int)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"\\\"Foo\\\"\": 0}");
  execute("INSERT INTO %s JSON ?","{\"K\": 0, \"\\\"Foo\\\"\": 0}");
  execute("INSERT INTO %s JSON ?","{\"\\\"k\\\"\": 0, \"\\\"Foo\\\"\": 0}");
  assertRows(execute("SELECT JSON * FROM %s"),row("{\"k\": 0, \"\\\"Foo\\\"\": 0}"));
  assertRows(execute("SELECT JSON k, \"Foo\" as foo FROM %s"),row("{\"k\": 0, \"foo\": 0}"));
  assertRows(execute("SELECT JSON k, \"Foo\" as \"Bar\" FROM %s"),row("{\"k\": 0, \"\\\"Bar\\\"\": 0}"));
  assertInvalid("INSERT INTO %s JSON ?","{\"k\": 0, \"foo\": 0}");
  assertInvalid("INSERT INTO %s JSON ?","{\"k\": 0, \"\\\"foo\\\"\": 0}");
  String typeName=createType("CREATE TYPE %s (a int, \"Foo\" int)");
  createTable("CREATE TABLE %s (k int primary key, v frozen<" + typeName + ">)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"v\": {\"a\": 0, \"\\\"Foo\\\"\": 0}}");
  assertRows(execute("SELECT JSON k, v FROM %s"),row("{\"k\": 0, \"v\": {\"a\": 0, \"\\\"Foo\\\"\": 0}}"));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"v\": {\"A\": 0, \"\\\"Foo\\\"\": 0}}");
  assertRows(execute("SELECT JSON k, v FROM %s"),row("{\"k\": 0, \"v\": {\"a\": 0, \"\\\"Foo\\\"\": 0}}"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectJsonSyntax() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, v int)");
  execute("INSERT INTO %s (k, v) VALUES (0, 0)");
  execute("INSERT INTO %s (k, v) VALUES (1, 1)");
  assertRows(execute("SELECT JSON * FROM %s"),row("{\"k\": 0, \"v\": 0}"),row("{\"k\": 1, \"v\": 1}"));
  assertRows(execute("SELECT JSON k, v FROM %s"),row("{\"k\": 0, \"v\": 0}"),row("{\"k\": 1, \"v\": 1}"));
  assertRows(execute("SELECT JSON v, k FROM %s"),row("{\"v\": 0, \"k\": 0}"),row("{\"v\": 1, \"k\": 1}"));
  assertRows(execute("SELECT JSON v as foo, k as bar FROM %s"),row("{\"foo\": 0, \"bar\": 0}"),row("{\"foo\": 1, \"bar\": 1}"));
  assertRows(execute("SELECT JSON ttl(v), k FROM %s"),row("{\"ttl(v)\": null, \"k\": 0}"),row("{\"ttl(v)\": null, \"k\": 1}"));
  assertRows(execute("SELECT JSON ttl(v) as foo, k FROM %s"),row("{\"foo\": null, \"k\": 0}"),row("{\"foo\": null, \"k\": 1}"));
  assertRows(execute("SELECT JSON count(*) FROM %s"),row("{\"count\": 2}"));
  assertRows(execute("SELECT JSON count(*) as foo FROM %s"),row("{\"foo\": 2}"));
  assertRows(execute("SELECT JSON toJson(blobAsInt(intAsBlob(v))) FROM %s LIMIT 1"),row("{\"system.tojson(system.blobasint(system.intasblob(v)))\": \"0\"}"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertJsonSyntaxWithCollections() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "m map<text, boolean>, "+ "mf frozen<map<text, boolean>>, "+ "s set<int>, "+ "sf frozen<set<int>>, "+ "l list<int>, "+ "lf frozen<list<int>>)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"m\": {\"a\": true, \"b\": false}}");
  assertRows(execute("SELECT k, m FROM %s"),row(0,map("a",true,"b",false)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"mf\": {\"a\": true, \"b\": false}}");
  assertRows(execute("SELECT k, mf FROM %s"),row(0,map("a",true,"b",false)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"s\": [3, 1, 2]}");
  assertRows(execute("SELECT k, s FROM %s"),row(0,set(1,2,3)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"sf\": [3, 1, 2]}");
  assertRows(execute("SELECT k, sf FROM %s"),row(0,set(1,2,3)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"l\": [1, 2, 3]}");
  assertRows(execute("SELECT k, l FROM %s"),row(0,list(1,2,3)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"lf\": [1, 2, 3]}");
  assertRows(execute("SELECT k, lf FROM %s"),row(0,list(1,2,3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testToJsonFct() throws Throwable {
  String typeName=createType("CREATE TYPE %s (a int, b uuid, c set<text>)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "asciival ascii, "+ "bigintval bigint, "+ "blobval blob, "+ "booleanval boolean, "+ "dateval date, "+ "decimalval decimal, "+ "doubleval double, "+ "floatval float, "+ "inetval inet, "+ "intval int, "+ "textval text, "+ "timeval time, "+ "timestampval timestamp, "+ "timeuuidval timeuuid, "+ "uuidval uuid,"+ "varcharval varchar, "+ "varintval varint, "+ "listval list<int>, "+ "frozenlistval frozen<list<int>>, "+ "setval set<uuid>, "+ "frozensetval frozen<set<uuid>>, "+ "mapval map<ascii, int>, "+ "frozenmapval frozen<map<ascii, int>>, "+ "tupleval frozen<tuple<int, ascii, uuid>>,"+ "udtval frozen<" + typeName + ">)");
  assertInvalidMessage("toJson() may only be used within the selection clause","INSERT INTO %s (k, asciival) VALUES (?, toJson(?))",0,0);
  assertInvalidMessage("toJson() may only be used within the selection clause","UPDATE %s SET asciival = toJson(?) WHERE k = ?",0,0);
  assertInvalidMessage("toJson() may only be used within the selection clause","DELETE FROM %s WHERE k = fromJson(toJson(?))",0);
  execute("INSERT INTO %s (k, asciival) VALUES (?, ?)",0,"ascii text");
  assertRows(execute("SELECT k, toJson(asciival) FROM %s WHERE k = ?",0),row(0,"\"ascii text\""));
  execute("INSERT INTO %s (k, asciival) VALUES (?, ?)",0,"");
  assertRows(execute("SELECT k, toJson(asciival) FROM %s WHERE k = ?",0),row(0,"\"\""));
  execute("INSERT INTO %s (k, bigintval) VALUES (?, ?)",0,123123123123L);
  assertRows(execute("SELECT k, toJson(bigintval) FROM %s WHERE k = ?",0),row(0,"123123123123"));
  execute("INSERT INTO %s (k, bigintval) VALUES (?, ?)",0,0L);
  assertRows(execute("SELECT k, toJson(bigintval) FROM %s WHERE k = ?",0),row(0,"0"));
  execute("INSERT INTO %s (k, bigintval) VALUES (?, ?)",0,-123123123123L);
  assertRows(execute("SELECT k, toJson(bigintval) FROM %s WHERE k = ?",0),row(0,"-123123123123"));
  execute("INSERT INTO %s (k, blobval) VALUES (?, ?)",0,ByteBufferUtil.bytes(1));
  assertRows(execute("SELECT k, toJson(blobval) FROM %s WHERE k = ?",0),row(0,"\"0x00000001\""));
  execute("INSERT INTO %s (k, blobval) VALUES (?, ?)",0,ByteBufferUtil.EMPTY_BYTE_BUFFER);
  assertRows(execute("SELECT k, toJson(blobval) FROM %s WHERE k = ?",0),row(0,"\"0x\""));
  execute("INSERT INTO %s (k, booleanval) VALUES (?, ?)",0,true);
  assertRows(execute("SELECT k, toJson(booleanval) FROM %s WHERE k = ?",0),row(0,"true"));
  execute("INSERT INTO %s (k, booleanval) VALUES (?, ?)",0,false);
  assertRows(execute("SELECT k, toJson(booleanval) FROM %s WHERE k = ?",0),row(0,"false"));
  execute("INSERT INTO %s (k, dateval) VALUES (?, ?)",0,SimpleDateSerializer.dateStringToDays("1987-03-23"));
  assertRows(execute("SELECT k, toJson(dateval) FROM %s WHERE k = ?",0),row(0,"\"1987-03-23\""));
  execute("INSERT INTO %s (k, decimalval) VALUES (?, ?)",0,new BigDecimal("123123.123123"));
  assertRows(execute("SELECT k, toJson(decimalval) FROM %s WHERE k = ?",0),row(0,"123123.123123"));
  execute("INSERT INTO %s (k, decimalval) VALUES (?, ?)",0,new BigDecimal("-1.23E-12"));
  assertRows(execute("SELECT k, toJson(decimalval) FROM %s WHERE k = ?",0),row(0,"-1.23E-12"));
  execute("INSERT INTO %s (k, doubleval) VALUES (?, ?)",0,123123.123123d);
  assertRows(execute("SELECT k, toJson(doubleval) FROM %s WHERE k = ?",0),row(0,"123123.123123"));
  execute("INSERT INTO %s (k, doubleval) VALUES (?, ?)",0,123123d);
  assertRows(execute("SELECT k, toJson(doubleval) FROM %s WHERE k = ?",0),row(0,"123123.0"));
  execute("INSERT INTO %s (k, floatval) VALUES (?, ?)",0,123.123f);
  assertRows(execute("SELECT k, toJson(floatval) FROM %s WHERE k = ?",0),row(0,"123.123"));
  execute("INSERT INTO %s (k, floatval) VALUES (?, ?)",0,123123f);
  assertRows(execute("SELECT k, toJson(floatval) FROM %s WHERE k = ?",0),row(0,"123123.0"));
  execute("INSERT INTO %s (k, inetval) VALUES (?, ?)",0,InetAddress.getByName("127.0.0.1"));
  assertRows(execute("SELECT k, toJson(inetval) FROM %s WHERE k = ?",0),row(0,"\"127.0.0.1\""));
  execute("INSERT INTO %s (k, inetval) VALUES (?, ?)",0,InetAddress.getByName("::1"));
  assertRows(execute("SELECT k, toJson(inetval) FROM %s WHERE k = ?",0),row(0,"\"0:0:0:0:0:0:0:1\""));
  execute("INSERT INTO %s (k, intval) VALUES (?, ?)",0,123123);
  assertRows(execute("SELECT k, toJson(intval) FROM %s WHERE k = ?",0),row(0,"123123"));
  execute("INSERT INTO %s (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, toJson(intval) FROM %s WHERE k = ?",0),row(0,"0"));
  execute("INSERT INTO %s (k, intval) VALUES (?, ?)",0,-123123);
  assertRows(execute("SELECT k, toJson(intval) FROM %s WHERE k = ?",0),row(0,"-123123"));
  execute("INSERT INTO %s (k, textval) VALUES (?, ?)",0,"");
  assertRows(execute("SELECT k, toJson(textval) FROM %s WHERE k = ?",0),row(0,"\"\""));
  execute("INSERT INTO %s (k, textval) VALUES (?, ?)",0,"abcd");
  assertRows(execute("SELECT k, toJson(textval) FROM %s WHERE k = ?",0),row(0,"\"abcd\""));
  execute("INSERT INTO %s (k, textval) VALUES (?, ?)",0,"\u8422");
  assertRows(execute("SELECT k, toJson(textval) FROM %s WHERE k = ?",0),row(0,"\"\u8422\""));
  execute("INSERT INTO %s (k, textval) VALUES (?, ?)",0,"\u0000");
  assertRows(execute("SELECT k, toJson(textval) FROM %s WHERE k = ?",0),row(0,"\"\\u0000\""));
  execute("INSERT INTO %s (k, timeval) VALUES (?, ?)",0,123L);
  assertRows(execute("SELECT k, toJson(timeval) FROM %s WHERE k = ?",0),row(0,"\"00:00:00.000000123\""));
  execute("INSERT INTO %s (k, timestampval) VALUES (?, ?)",0,new SimpleDateFormat("y-M-d").parse("2014-01-01"));
  assertRows(execute("SELECT k, toJson(timestampval) FROM %s WHERE k = ?",0),row(0,"\"2014-01-01 00:00:00.000\""));
  execute("INSERT INTO %s (k, timeuuidval) VALUES (?, ?)",0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"));
  assertRows(execute("SELECT k, toJson(timeuuidval) FROM %s WHERE k = ?",0),row(0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\""));
  execute("INSERT INTO %s (k, uuidval) VALUES (?, ?)",0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"));
  assertRows(execute("SELECT k, toJson(uuidval) FROM %s WHERE k = ?",0),row(0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\""));
  execute("INSERT INTO %s (k, varintval) VALUES (?, ?)",0,new BigInteger("123123123123123123123"));
  assertRows(execute("SELECT k, toJson(varintval) FROM %s WHERE k = ?",0),row(0,"123123123123123123123"));
  execute("INSERT INTO %s (k, listval) VALUES (?, ?)",0,list(1,2,3));
  assertRows(execute("SELECT k, toJson(listval) FROM %s WHERE k = ?",0),row(0,"[1, 2, 3]"));
  execute("INSERT INTO %s (k, listval) VALUES (?, ?)",0,list());
  assertRows(execute("SELECT k, toJson(listval) FROM %s WHERE k = ?",0),row(0,"null"));
  execute("INSERT INTO %s (k, frozenlistval) VALUES (?, ?)",0,list(1,2,3));
  assertRows(execute("SELECT k, toJson(frozenlistval) FROM %s WHERE k = ?",0),row(0,"[1, 2, 3]"));
  execute("INSERT INTO %s (k, setval) VALUES (?, ?)",0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, toJson(setval) FROM %s WHERE k = ?",0),row(0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]"));
  execute("INSERT INTO %s (k, setval) VALUES (?, ?)",0,set());
  assertRows(execute("SELECT k, toJson(setval) FROM %s WHERE k = ?",0),row(0,"null"));
  execute("INSERT INTO %s (k, frozensetval) VALUES (?, ?)",0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, toJson(frozensetval) FROM %s WHERE k = ?",0),row(0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]"));
  execute("INSERT INTO %s (k, mapval) VALUES (?, ?)",0,map("a",1,"b",2));
  assertRows(execute("SELECT k, toJson(mapval) FROM %s WHERE k = ?",0),row(0,"{\"a\": 1, \"b\": 2}"));
  execute("INSERT INTO %s (k, mapval) VALUES (?, ?)",0,map());
  assertRows(execute("SELECT k, toJson(mapval) FROM %s WHERE k = ?",0),row(0,"null"));
  execute("INSERT INTO %s (k, frozenmapval) VALUES (?, ?)",0,map("a",1,"b",2));
  assertRows(execute("SELECT k, toJson(frozenmapval) FROM %s WHERE k = ?",0),row(0,"{\"a\": 1, \"b\": 2}"));
  execute("INSERT INTO %s (k, tupleval) VALUES (?, ?)",0,tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertRows(execute("SELECT k, toJson(tupleval) FROM %s WHERE k = ?",0),row(0,"[1, \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]"));
  execute("INSERT INTO %s (k, tupleval) VALUES (?, ?)",0,tuple(1,"foobar",null));
  assertRows(execute("SELECT k, toJson(tupleval) FROM %s WHERE k = ?",0),row(0,"[1, \"foobar\", null]"));
  execute("INSERT INTO %s (k, udtval) VALUES (?, {a: ?, b: ?, c: ?})",0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("foo","bar"));
  assertRows(execute("SELECT k, toJson(udtval) FROM %s WHERE k = ?",0),row(0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"bar\", \"foo\"]}"));
  execute("INSERT INTO %s (k, udtval) VALUES (?, {a: ?, b: ?})",0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"));
  assertRows(execute("SELECT k, toJson(udtval) FROM %s WHERE k = ?",0),row(0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": null}"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromJsonFct() throws Throwable {
  String typeName=createType("CREATE TYPE %s (a int, b uuid, c set<text>)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "asciival ascii, "+ "bigintval bigint, "+ "blobval blob, "+ "booleanval boolean, "+ "dateval date, "+ "decimalval decimal, "+ "doubleval double, "+ "floatval float, "+ "inetval inet, "+ "intval int, "+ "textval text, "+ "timeval time, "+ "timestampval timestamp, "+ "timeuuidval timeuuid, "+ "uuidval uuid,"+ "varcharval varchar, "+ "varintval varint, "+ "listval list<int>, "+ "frozenlistval frozen<list<int>>, "+ "setval set<uuid>, "+ "frozensetval frozen<set<uuid>>, "+ "mapval map<ascii, int>,"+ "frozenmapval frozen<map<ascii, int>>,"+ "tupleval frozen<tuple<int, ascii, uuid>>,"+ "udtval frozen<" + typeName + ">)");
  assertInvalidMessage("fromJson() cannot be used in the selection clause","SELECT fromJson(asciival) FROM %s",0,0);
  String func1=createFunction(KEYSPACE,"int","CREATE FUNCTION %s (a int) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return a.toString(); $$");
  createFunctionOverload(func1,"int","CREATE FUNCTION %s (a text) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return new String(a); $$");
  assertInvalidMessage("Ambiguous call to function","INSERT INTO %s (k, textval) VALUES (?, " + func1 + "(fromJson(?)))",0,"123");
  assertInvalidMessage("Could not decode JSON string '\u038E\u0394\u03B4\u03E0'","INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\u038E\u0394\u03B4\u03E0");
  execute("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,null);
  execute("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii text"));
  execute("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii \\\" text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii \" text"));
  assertInvalidMessage("Invalid ASCII character in string literal","INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"\\u1fff\\u2013\\u33B4\\u2014\"");
  assertInvalidMessage("Expected an ascii string, but got a Integer","INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"123");
  assertRows(execute("SELECT asciival FROM %s WHERE k = fromJson(?)","0"),row("ascii \" text"));
  execute("UPDATE %s SET asciival = fromJson(?) WHERE k = fromJson(?)","\"ascii \\\" text\"","0");
  execute("DELETE FROM %s WHERE k = fromJson(?)","0");
  execute("INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, bigintval FROM %s WHERE k = ?",0),row(0,123123123123L));
  execute("INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"\"123123123123\"");
  assertRows(execute("SELECT k, bigintval FROM %s WHERE k = ?",0),row(0,123123123123L));
  assertInvalidMessage("Expected a bigint value, but got a","INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"9223372036854775808");
  assertInvalidMessage("Expected a bigint value, but got a","INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"123.456");
  assertInvalidMessage("Unable to make long from","INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"\"abc\"");
  assertInvalidMessage("Expected a bigint value, but got a","INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"[\"abc\"]");
  execute("INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"0x00000001\"");
  assertRows(execute("SELECT k, blobval FROM %s WHERE k = ?",0),row(0,ByteBufferUtil.bytes(1)));
  assertInvalidMessage("Value 'xyzz' is not a valid blob representation","INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("String representation of blob is missing 0x prefix: 123","INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"123\"");
  assertInvalidMessage("Value '0x123' is not a valid blob representation","INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"0x123\"");
  assertInvalidMessage("Value '123' is not a valid blob representation","INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"true");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,true));
  execute("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"false");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,false));
  execute("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"\"false\"");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,false));
  assertInvalidMessage("Unable to make boolean from","INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"\"abc\"");
  assertInvalidMessage("Expected a boolean value, but got a Integer","INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, dateval) VALUES (?, fromJson(?))",0,"\"1987-03-23\"");
  assertRows(execute("SELECT k, dateval FROM %s WHERE k = ?",0),row(0,SimpleDateSerializer.dateStringToDays("1987-03-23")));
  assertInvalidMessage("Expected a string representation of a date","INSERT INTO %s (k, dateval) VALUES (?, fromJson(?))",0,"123");
  assertInvalidMessage("Unable to coerce 'xyz' to a formatted date","INSERT INTO %s (k, dateval) VALUES (?, fromJson(?))",0,"\"xyz\"");
  execute("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  execute("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123")));
  execute("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"123123.123123\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  execute("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"-1.23E-12\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("-1.23E-12")));
  assertInvalidMessage("Value 'xyzz' is not a valid representation of a decimal value","INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Value 'true' is not a valid representation of a decimal value","INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"true");
  execute("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.123123d));
  execute("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.0d));
  execute("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"\"123123\"");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.0d));
  assertInvalidMessage("Unable to make double from","INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Expected a double value, but got","INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"true");
  execute("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.123123f));
  execute("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.0f));
  execute("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"\"123123.0\"");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.0f));
  assertInvalidMessage("Unable to make float from","INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Expected a float value, but got a","INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"true");
  execute("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"127.0.0.1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("127.0.0.1")));
  execute("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"::1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("::1")));
  assertInvalidMessage("Unable to make inet address from 'xyzz'","INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Expected a string representation of an inet value, but got a Integer","INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,123123));
  execute("INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"\"123123\"");
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,123123));
  assertInvalidMessage("Expected an int value, but got a","INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"2147483648");
  assertInvalidMessage("Expected an int value, but got a","INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"123.456");
  assertInvalidMessage("Unable to make int from","INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Expected an int value, but got a","INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"true");
  execute("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,""));
  execute("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"abcd\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"abcd"));
  execute("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"some \\\" text\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"some \" text"));
  execute("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"\\u2013\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"\u2013"));
  assertInvalidMessage("Expected a UTF-8 string, but got a Integer","INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, timeval) VALUES (?, fromJson(?))",0,"\"07:35:07.000111222\"");
  assertRows(execute("SELECT k, timeval FROM %s WHERE k = ?",0),row(0,TimeSerializer.timeStringToLong("07:35:07.000111222")));
  assertInvalidMessage("Expected a string representation of a time value","INSERT INTO %s (k, timeval) VALUES (?, fromJson(?))",0,"123456");
  assertInvalidMessage("Unable to coerce 'xyz' to a formatted time","INSERT INTO %s (k, timeval) VALUES (?, fromJson(?))",0,"\"xyz\"");
  execute("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new Date(123123123123L)));
  execute("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"\"2014-01-01\"");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new SimpleDateFormat("y-M-d").parse("2014-01-01")));
  assertInvalidMessage("Expected a long or a datestring representation of a timestamp value, but got a Double","INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"123.456");
  assertInvalidMessage("Unable to coerce 'abcd' to a formatted date","INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"\"abcd\"");
  execute("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  execute("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertInvalidMessage("TimeUUID supports only version 1 UUIDs","INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"00000000-0000-0000-0000-000000000000\"");
  assertInvalidMessage("Expected a string representation of a timeuuid, but got a Integer","INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  execute("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertInvalidMessage("Unable to make UUID from","INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"00000000-0000-0000-zzzz-000000000000\"");
  assertInvalidMessage("Expected a string representation of a uuid, but got a Integer","INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"123");
  execute("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("123123123123")));
  execute("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"\"1234567890123456789012345678901234567890\"");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("1234567890123456789012345678901234567890")));
  assertInvalidMessage("Value '123123.123' is not a valid representation of a varint value","INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"123123.123");
  assertInvalidMessage("Value 'xyzz' is not a valid representation of a varint value","INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"\"xyzz\"");
  assertInvalidMessage("Value '' is not a valid representation of a varint value","INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"\"\"");
  assertInvalidMessage("Value 'true' is not a valid representation of a varint value","INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"true");
  execute("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  execute("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,null));
  assertInvalidMessage("Expected a list, but got a Integer","INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"123");
  assertInvalidMessage("Unable to make int from","INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[\"abc\"]");
  assertInvalidMessage("Invalid null element in list","INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[null]");
  execute("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  execute("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  execute("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  execute("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,null));
  assertInvalidMessage("Expected a list (representing a set), but got a Integer","INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"123");
  assertInvalidMessage("Unable to make UUID from","INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"abc\"]");
  assertInvalidMessage("Invalid null element in set","INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[null]");
  execute("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  execute("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9799\", \"6bddc89a-5644-11e4-97fc-56847afe9798\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  execute("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  execute("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,null));
  assertInvalidMessage("Expected a map, but got a Integer","INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"123");
  assertInvalidMessage("Invalid ASCII character in string literal","INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{\"\\u1fff\\u2013\\u33B4\\u2014\": 1}");
  assertInvalidMessage("Invalid null value in map","INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{\"a\": null}");
  execute("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  execute("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"b\": 2, \"a\": 1}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  execute("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  execute("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, null, \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertInvalidMessage("Tuple contains extra items","INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\", 1, 2, 3]");
  assertInvalidMessage("Tuple is missing items","INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, \"foobar\"]");
  assertInvalidMessage("Unable to make int from","INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[\"not an int\", \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  execute("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  execute("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"a\": 1, \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  execute("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  execute("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\"}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),null));
  assertInvalidMessage("Unknown field","INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"xxx\": 1}");
  assertInvalidMessage("Unable to make int from","INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": \"foobar\"}");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertJsonSyntax() throws Throwable {
  createTable("CREATE TABLE %s (k int primary key, v int)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"v\": 0}");
  assertRows(execute("SELECT * FROM %s"),row(0,0));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"v\": 0}");
  assertRows(execute("SELECT * FROM %s"),row(0,0));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"v\": null}");
  assertRows(execute("SELECT * FROM %s"),row(0,null));
  execute("INSERT INTO %s JSON ?","{\"v\": 1, \"k\": 0}");
  assertRows(execute("SELECT * FROM %s"),row(0,1));
  execute("INSERT INTO %s JSON ?","{\"k\": 0}");
  assertRows(execute("SELECT * FROM %s"),row(0,null));
  if (USE_PREPARED_VALUES)   assertInvalidMessage("Got null for INSERT JSON values","INSERT INTO %s JSON ?",new Object[]{null});
  assertInvalidMessage("Got null for INSERT JSON values","INSERT INTO %s JSON ?","null");
  assertInvalidMessage("Could not decode JSON string as a map","INSERT INTO %s JSON ?","\"notamap\"");
  assertInvalidMessage("Could not decode JSON string as a map","INSERT INTO %s JSON ?","12.34");
  assertInvalidMessage("JSON values map contains unrecognized column","INSERT INTO %s JSON ?","{\"k\": 0, \"v\": 0, \"zzz\": 0}");
  assertInvalidMessage("Unable to make int from","INSERT INTO %s JSON ?","{\"k\": 0, \"v\": \"notanint\"}");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertJsonSyntaxWithTuplesAndUDTs() throws Throwable {
  String typeName=createType("CREATE TYPE %s (a int, b frozen<set<int>>, c tuple<int, int>)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "a frozen<" + typeName + ">, "+ "b tuple<int, boolean>)");
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"a\": {\"a\": 0, \"b\": [1, 2, 3], \"c\": [0, 1]}, \"b\": [0, true]}");
  assertRows(execute("SELECT k, a.a, a.b, a.c, b FROM %s"),row(0,0,set(1,2,3),tuple(0,1),tuple(0,true)));
  execute("INSERT INTO %s JSON ?","{\"k\": 0, \"a\": {\"a\": 0, \"b\": [1, 2, 3], \"c\": null}, \"b\": null}");
  assertRows(execute("SELECT k, a.a, a.b, a.c, b FROM %s"),row(0,0,set(1,2,3),null,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.RowUpdateBuilderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddListEntryDurable() throws Throwable {
  testAddListEntry(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddListEntryTransient() throws Throwable {
  testAddListEntry(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexOnMapEntriesTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldFindRowsMatchingSingleEqualityRestriction() throws Throwable {
  createSimpleTableAndIndex();
  Object[] foo=insertIntoSimpleTable("foo",map("a",1,"c",3));
  Object[] bar=insertIntoSimpleTable("bar",map("a",1,"b",2));
  Object[] baz=insertIntoSimpleTable("baz",map("b",2,"c",5,"d",4));
  Object[] qux=insertIntoSimpleTable("qux",map("b",2,"d",4));
  assertRowsForConditions(entry("a",1),bar,foo);
  assertRowsForConditions(entry("b",2),bar,baz,qux);
  assertRowsForConditions(entry("c",3),foo);
  assertRowsForConditions(entry("c",5),baz);
  assertRowsForConditions(entry("d",4),baz,qux);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldFindRowsMatchingEqualityAndContainsRestrictions() throws Throwable {
  createSimpleTableAndIndex();
  Object[] foo=insertIntoSimpleTable("foo",map("common",31415,"k1",1,"k2",2,"k3",3));
  Object[] bar=insertIntoSimpleTable("bar",map("common",31415,"k3",3,"k4",4,"k5",5));
  Object[] baz=insertIntoSimpleTable("baz",map("common",31415,"k5",5,"k6",6,"k7",7));
  assertRowsForConditions(entry("common",31415),bar,baz,foo);
  assertRowsForConditions(entry("common",31415).key("k1"),foo);
  assertRowsForConditions(entry("common",31415).key("k2"),foo);
  assertRowsForConditions(entry("common",31415).key("k3"),bar,foo);
  assertRowsForConditions(entry("common",31415).key("k3").value(2),foo);
  assertRowsForConditions(entry("common",31415).key("k3").value(3),bar,foo);
  assertRowsForConditions(entry("common",31415).key("k3").value(4),bar);
  assertRowsForConditions(entry("common",31415).key("k3").key("k5"),bar);
  assertRowsForConditions(entry("common",31415).key("k5"),bar,baz);
  assertRowsForConditions(entry("common",31415).key("k5").value(4),bar);
  assertRowsForConditions(entry("common",31415).key("k5").value(5),bar,baz);
  assertRowsForConditions(entry("common",31415).key("k5").value(6),baz);
  assertNoRowsForConditions(entry("common",31415).key("k5").value(8));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRequireFilteringDirectiveIfMultipleRestrictionsSpecified() throws Throwable {
  createSimpleTableAndIndex();
  String baseQuery="SELECT * FROM %s WHERE v['foo'] = 31415 AND v['baz'] = 31416";
  assertInvalid(baseQuery);
  assertReturnsNoRows(baseQuery + " ALLOW FILTERING");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldFindRowsMatchingMultipleEqualityRestrictions() throws Throwable {
  createSimpleTableAndIndex();
  Object[] foo=insertIntoSimpleTable("foo",map("k1",1));
  Object[] bar=insertIntoSimpleTable("bar",map("k1",1,"k2",2));
  Object[] baz=insertIntoSimpleTable("baz",map("k2",2,"k3",3));
  Object[] qux=insertIntoSimpleTable("qux",map("k2",2,"k3",3,"k4",4));
  assertRowsForConditions(entry("k1",1),bar,foo);
  assertRowsForConditions(entry("k1",1).entry("k2",2),bar);
  assertNoRowsForConditions(entry("k1",1).entry("k2",2).entry("k3",3));
  assertRowsForConditions(entry("k2",2).entry("k3",3),baz,qux);
  assertRowsForConditions(entry("k2",2).entry("k3",3).entry("k4",4),qux);
  assertRowsForConditions(entry("k3",3).entry("k4",4),qux);
  assertNoRowsForConditions(entry("k3",3).entry("k4",4).entry("k5",5));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldNotAcceptUnsupportedRelationsOnEntries() throws Throwable {
  createSimpleTableAndIndex();
  assertInvalidRelation("< 31415");
  assertInvalidRelation("<= 31415");
  assertInvalidRelation("> 31415");
  assertInvalidRelation(">= 31415");
  assertInvalidRelation("IN (31415, 31416, 31417)");
  assertInvalidRelation("CONTAINS 31415");
  assertInvalidRelation("CONTAINS KEY 'foo'");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldRecognizeAlteredOrDeletedMapEntries() throws Throwable {
  createSimpleTableAndIndex();
  Object[] foo=insertIntoSimpleTable("foo",map("common",31415,"target",8192));
  Object[] bar=insertIntoSimpleTable("bar",map("common",31415,"target",8192));
  Object[] baz=insertIntoSimpleTable("baz",map("common",31415,"target",8192));
  assertRowsForConditions(entry("target",8192),bar,baz,foo);
  baz=updateMapInSimpleTable(baz,"target",4096);
  assertRowsForConditions(entry("target",8192),bar,foo);
  bar=updateMapInSimpleTable(bar,"target",null);
  assertRowsForConditions(entry("target",8192),foo);
  execute("DELETE FROM %s WHERE k = 'foo'");
  assertNoRowsForConditions(entry("target",8192));
  assertRowsForConditions(entry("common",31415),bar,baz);
  assertRowsForConditions(entry("target",4096),baz);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldNotCreateIndexOnFrozenMaps() throws Throwable {
  createTable("CREATE TABLE %s (k TEXT PRIMARY KEY, v FROZEN<MAP<TEXT, TEXT>>)");
  assertIndexInvalidForColumn("v");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldNotCreateIndexOnNonMapTypes() throws Throwable {
  createTable("CREATE TABLE %s (k TEXT PRIMARY KEY, i INT, t TEXT, b BLOB, s SET<TEXT>, l LIST<TEXT>, tu TUPLE<TEXT>)");
  assertIndexInvalidForColumn("i");
  assertIndexInvalidForColumn("t");
  assertIndexInvalidForColumn("b");
  assertIndexInvalidForColumn("s");
  assertIndexInvalidForColumn("l");
  assertIndexInvalidForColumn("tu");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldValidateMapKeyAndValueTypes() throws Throwable {
  createSimpleTableAndIndex();
  String query="SELECT * FROM %s WHERE v[?] = ?";
  Object validKey="valid key";
  Object invalidKey=31415;
  Object validValue=31415;
  Object invalidValue="invalid value";
  assertInvalid(query,invalidKey,invalidValue);
  assertInvalid(query,invalidKey,validValue);
  assertInvalid(query,validKey,invalidValue);
  assertReturnsNoRows(query,validKey,validValue);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldRejectQueriesForNullEntries() throws Throwable {
  createSimpleTableAndIndex();
  assertInvalid("SELECT * FROM %s WHERE v['somekey'] = null");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexOnStaticColumnTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnCompoundRowKey() throws Throwable {
  createTable("CREATE TABLE %s (interval text, seq int, id int, severity int static, PRIMARY KEY ((interval, seq), id) ) WITH CLUSTERING ORDER BY (id DESC)");
  execute("CREATE INDEX ON %s (severity)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 3, 10)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 4, 10)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 3, 10)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 4, 10)");
  execute("insert into %s (interval, seq, id , severity) values('m',1, 3, 11)");
  execute("insert into %s (interval, seq, id , severity) values('m',1, 4, 11)");
  execute("insert into %s (interval, seq, id , severity) values('m',2, 3, 11)");
  execute("insert into %s (interval, seq, id , severity) values('m',2, 4, 11)");
  assertRows(execute("select * from %s where severity = 10 and interval = 't' and seq = 1"),row("t",1,4,10),row("t",1,3,10));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleStaticColumn() throws Throwable {
  createTable("CREATE TABLE %s (id int, name text, age int static, PRIMARY KEY (id, name))");
  createIndex("CREATE INDEX static_age on %s(age)");
  int id1=1, id2=2, age1=24, age2=32;
  String name1A="Taylor", name1B="Swift", name2="Jamie";
  execute("INSERT INTO %s (id, name, age) VALUES (?, ?, ?)",id1,name1A,age1);
  execute("INSERT INTO %s (id, name, age) VALUES (?, ?, ?)",id1,name1B,age1);
  execute("INSERT INTO %s (id, name, age) VALUES (?, ?, ?)",id2,name2,age2);
  assertRows(execute("SELECT id, name, age FROM %s WHERE age=?",age1),row(id1,name1B,age1),row(id1,name1A,age1));
  assertRows(execute("SELECT id, name, age FROM %s WHERE age=?",age2),row(id2,name2,age2));
  int newAge1=40;
  execute("UPDATE %s SET age = ? WHERE id = ?",newAge1,id1);
  assertEmpty(execute("SELECT id, name, age FROM %s WHERE age=?",age1));
  assertRows(execute("SELECT id, name, age FROM %s WHERE age=?",newAge1),row(id1,name1B,newAge1),row(id1,name1A,newAge1));
  execute("DELETE FROM %s WHERE id = ?",id2);
  assertEmpty(execute("SELECT id, name, age FROM %s WHERE age=?",age2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStaticIndexAndNonStaticIndex() throws Throwable {
  createTable("CREATE TABLE %s (id int, company text, age int static, salary int, PRIMARY KEY(id, company))");
  createIndex("CREATE INDEX on %s(age)");
  createIndex("CREATE INDEX on %s(salary)");
  String company1="company1", company2="company2";
  execute("INSERT INTO %s(id, company, age, salary) VALUES(?, ?, ?, ?)",1,company1,20,1000);
  execute("INSERT INTO %s(id, company,      salary) VALUES(?, ?,    ?)",1,company2,2000);
  execute("INSERT INTO %s(id, company, age, salary) VALUES(?, ?, ?, ?)",2,company1,40,2000);
  assertRows(execute("SELECT id, company, age, salary FROM %s WHERE age = 20 AND salary = 2000 ALLOW FILTERING"),row(1,company2,20,2000));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnUDT() throws Throwable {
  String typeName=createType("CREATE TYPE %s (street text, city text)");
  createTable(String.format("CREATE TABLE %%s (id int, company text, home frozen<%s> static, price int, PRIMARY KEY(id, company))",typeName));
  createIndex("CREATE INDEX on %s(home)");
  String addressString="{street: 'Centre', city: 'C'}";
  String companyName="Random";
  execute("INSERT INTO %s(id, company, home, price) " + "VALUES(1, '" + companyName + "', "+ addressString+ ", 10000)");
  assertRows(execute("SELECT id, company FROM %s WHERE home = " + addressString),row(1,companyName));
  String newAddressString="{street: 'Fifth', city: 'P'}";
  execute("UPDATE %s SET home = " + newAddressString + " WHERE id = 1");
  assertEmpty(execute("SELECT id, company FROM %s WHERE home = " + addressString));
  assertRows(execute("SELECT id, company FROM %s WHERE home = " + newAddressString),row(1,companyName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnFrozenCollections() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, l frozen<list<int>> static, s frozen<set<text>> static, m frozen<map<text, int>> static, PRIMARY KEY (k, v))");
  createIndex("CREATE INDEX ON %s (FULL(l))");
  createIndex("CREATE INDEX ON %s (FULL(s))");
  createIndex("CREATE INDEX ON %s (FULL(m))");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (0, 0, [1, 2],    {'a'},      {'a' : 1, 'b' : 2})");
  execute("INSERT INTO %s (k, v)          VALUES (0, 1)                                  ");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (1, 0, [4, 5],    {'d'},      {'b' : 1, 'c' : 4})");
  execute("UPDATE %s SET l=[3], s={'3'}, m={'3': 3} WHERE k=3");
  assertRows(execute("SELECT k, v FROM %s WHERE l = [1, 2]"),row(0,0),row(0,1));
  assertEmpty(execute("SELECT k, v FROM %s WHERE k = 1 AND l = [1, 2]"));
  assertEmpty(execute("SELECT k, v FROM %s WHERE l = [4]"));
  assertRows(execute("SELECT k, v FROM %s WHERE l = [3]"),row(3,null));
  execute("UPDATE %s SET l = [1, 2, 3] WHERE k = ?",0);
  assertEmpty(execute("SELECT k, v FROM %s WHERE l = [1, 2]"));
  assertRows(execute("SELECT k, v FROM %s WHERE l = [1, 2, 3]"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE s = {'a'}"),row(0,0),row(0,1));
  assertEmpty(execute("SELECT k, v FROM %s WHERE k = 1 AND s = {'a'}"));
  assertEmpty(execute("SELECT k, v FROM %s WHERE s = {'b'}"));
  assertRows(execute("SELECT k, v FROM %s WHERE s = {'3'}"),row(3,null));
  execute("UPDATE %s SET s = {'a', 'b'} WHERE k = ?",0);
  assertEmpty(execute("SELECT k, v FROM %s WHERE s = {'a'}"));
  assertRows(execute("SELECT k, v FROM %s WHERE s = {'a', 'b'}"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m = {'a' : 1, 'b' : 2}"),row(0,0),row(0,1));
  assertEmpty(execute("SELECT k, v FROM %s WHERE k = 1 AND m = {'a' : 1, 'b' : 2}"));
  assertEmpty(execute("SELECT k, v FROM %s WHERE m = {'a' : 1, 'b' : 3}"));
  assertEmpty(execute("SELECT k, v FROM %s WHERE m = {'a' : 1, 'c' : 2}"));
  assertRows(execute("SELECT k, v FROM %s WHERE m = {'3': 3}"),row(3,null));
  execute("UPDATE %s SET m = {'a': 2, 'b': 3} WHERE k = ?",0);
  assertEmpty(execute("SELECT k, v FROM %s WHERE m = {'a': 1, 'b': 2}"));
  assertRows(execute("SELECT k, v FROM %s WHERE m = {'a': 2, 'b': 3}"),row(0,0),row(0,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnCollections() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, l list<int> static, s set<text> static, m map<text, int> static, PRIMARY KEY (k, v))");
  createIndex("CREATE INDEX ON %s (l)");
  createIndex("CREATE INDEX ON %s (s)");
  createIndex("CREATE INDEX ON %s (m)");
  createIndex("CREATE INDEX ON %s (keys(m))");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (0, 0, [1, 2],    {'a'},      {'a' : 1, 'b' : 2})");
  execute("INSERT INTO %s (k, v)          VALUES (0, 1)                                  ");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (1, 0, [4, 5],    {'d'},      {'b' : 1, 'c' : 4})");
  assertRows(execute("SELECT k, v FROM %s WHERE l CONTAINS 1"),row(0,0),row(0,1));
  assertEmpty(execute("SELECT k, v FROM %s WHERE k = 1 AND l CONTAINS 1"));
  assertRows(execute("SELECT k, v FROM %s WHERE l CONTAINS 4"),row(1,0));
  assertEmpty(execute("SELECT k, v FROM %s WHERE l CONTAINS 6"));
  execute("UPDATE %s SET l = l + [3] WHERE k = ?",0);
  assertRows(execute("SELECT k, v FROM %s WHERE l CONTAINS 3"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE s CONTAINS 'a'"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND s CONTAINS 'a'"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE s CONTAINS 'd'"),row(1,0));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE s CONTAINS 'e'"));
  execute("UPDATE %s SET s = s + {'b'} WHERE k = ?",0);
  assertRows(execute("SELECT k, v FROM %s WHERE s CONTAINS 'b'"),row(0,0),row(0,1));
  execute("UPDATE %s SET s = s - {'a'} WHERE k = ?",0);
  assertEmpty(execute("SELECT k, v FROM %s WHERE s CONTAINS 'a'"));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS 1"),row(1,0),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND m CONTAINS 1"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS 4"),row(1,0));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE m CONTAINS 5"));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS KEY 'b'"),row(1,0),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND m CONTAINS KEY 'b'"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS KEY 'c'"),row(1,0));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE m CONTAINS KEY 'd'"));
  execute("UPDATE %s SET m['c'] = 5 WHERE k = 0");
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS 5"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS KEY 'c'"),row(1,0),row(0,0),row(0,1));
  execute("DELETE m['a'] FROM %s WHERE k = 0");
  assertEmpty(execute("SELECT k, v FROM %s  WHERE m CONTAINS KEY 'a'"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check for unknown compression parameters options (#4266),
 * migrated from cql_tests.py:TestCQL.compression_option_validation_test()
 */
@Test public void testUnknownCompressionOptions() throws Throwable {
  String tableName=createTableName();
  assertInvalidThrow(SyntaxException.class,String.format("CREATE TABLE %s (key varchar PRIMARY KEY, password varchar, gender varchar) WITH compression_parameters:sstable_compressor = 'DeflateCompressor'",tableName));
  assertInvalidThrow(ConfigurationException.class,String.format("CREATE TABLE %s (key varchar PRIMARY KEY, password varchar, gender varchar) WITH compression = { 'sstable_compressor': 'DeflateCompressor' }",tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test range queries with 2ndary indexes (#4257),
 * migrated from cql_tests.py:TestCQL.range_query_2ndary_test()
 */
@Test public void testRangeQuery() throws Throwable {
  createTable("CREATE TABLE %s (id int primary key, row int, setid int)");
  createIndex("CREATE INDEX indextest_setid_idx ON %s (setid)");
  execute("INSERT INTO %s (id, row, setid) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (id, row, setid) VALUES (?, ?, ?)",1,1,0);
  execute("INSERT INTO %s (id, row, setid) VALUES (?, ?, ?)",2,2,0);
  execute("INSERT INTO %s (id, row, setid) VALUES (?, ?, ?)",3,3,0);
  assertInvalid("SELECT * FROM %s WHERE setid = 0 AND row < 1");
  assertRows(execute("SELECT * FROM %s WHERE setid = 0 AND row < 1 ALLOW FILTERING"),row(0,0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.secondary_index_counters()
 */
@Test public void testIndexOnCountersInvalid() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, c counter)");
  assertInvalid("CREATE INDEX ON test(c)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check that you can query for an indexed column even with a key EQ clause,
 * migrated from cql_tests.py:TestCQL.static_cf_test()
 */
@Test public void testSelectWithEQ() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid PRIMARY KEY, firstname text, lastname text, age int)");
  createIndex("CREATE INDEX byAge ON %s(age)");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, firstname, lastname, age) VALUES (?, 'Frodo', 'Baggins', 32)",id1);
  execute("UPDATE %s SET firstname = 'Samwise', lastname = 'Gamgee', age = 33 WHERE userid = ?",id2);
  assertEmpty(execute("SELECT firstname FROM %s WHERE userid = ? AND age = 33",id1));
  assertRows(execute("SELECT firstname FROM %s WHERE userid = ? AND age = 33",id2),row("Samwise"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateAndDropIndex() throws Throwable {
  testCreateAndDropIndex("test",false);
  testCreateAndDropIndex("test2",true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnCompositeValueOver64k() throws Throwable {
  createTable("CREATE TABLE %s(a int, b int, c blob, PRIMARY KEY (a))");
  createIndex("CREATE INDEX ON %s(c)");
  failInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?)",ByteBuffer.allocate(TOO_BIG));
  failInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?) IF NOT EXISTS",ByteBuffer.allocate(TOO_BIG));
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (0, 0, ?);\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (0, 0, ?) IF NOT EXISTS;\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexesOnNonStaticColumnsWhereSchemaIncludesStaticColumns() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int static, d int, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX b_idx on %s(b)");
  createIndex("CREATE INDEX d_idx on %s(d)");
  execute("INSERT INTO %s (a, b, c ,d) VALUES (0, 0, 0, 0)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 1, 1, 1)");
  assertRows(execute("SELECT * FROM %s WHERE b = 0"),row(0,0,0,0));
  assertRows(execute("SELECT * FROM %s WHERE d = 1"),row(1,1,1,1));
  execute("UPDATE %s SET c = 2 WHERE a = 0");
  execute("UPDATE %s SET c = 3, d = 4 WHERE a = 1 AND b = 1");
  assertRows(execute("SELECT * FROM %s WHERE b = 0"),row(0,0,2,0));
  assertRows(execute("SELECT * FROM %s WHERE d = 4"),row(1,1,3,4));
  execute("DELETE FROM %s WHERE a = 0");
  execute("DELETE FROM %s WHERE a = 1 AND b = 1");
  assertEmpty(execute("SELECT * FROM %s WHERE b = 0"));
  assertEmpty(execute("SELECT * FROM %s WHERE d = 3"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateAndDropIndexWithCamelCaseIdentifier() throws Throwable {
  testCreateAndDropIndex("CamelCase",false);
  testCreateAndDropIndex("CamelCase2",true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check one can use arbitrary name for datacenter when creating keyspace (#4278),
 * migrated from cql_tests.py:TestCQL.keyspace_creation_options_test()
 */
@Test public void testDataCenterName() throws Throwable {
  execute("CREATE KEYSPACE Foo WITH replication = { 'class' : 'NetworkTopologyStrategy', 'us-east' : 1, 'us-west' : 1 };");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check CREATE INDEX without name and validate the index can be dropped,
 * migrated from cql_tests.py:TestCQL.nameless_index_test()
 */
@Test public void testNamelessIndex() throws Throwable {
  createTable(" CREATE TABLE %s (id text PRIMARY KEY, birth_year int)");
  createIndex("CREATE INDEX on %s (birth_year)");
  execute("INSERT INTO %s (id, birth_year) VALUES ('Tom', 42)");
  execute("INSERT INTO %s (id, birth_year) VALUES ('Paul', 24)");
  execute("INSERT INTO %s (id, birth_year) VALUES ('Bob', 42)");
  assertRows(execute("SELECT id FROM %s WHERE birth_year = 42"),row("Tom"),row("Bob"));
  execute("DROP INDEX %s_birth_year_idx");
  assertInvalid("SELECT id FROM users WHERE birth_year = 42");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateIndexWithQuotedColumnNames() throws Throwable {
  createTable("CREATE TABLE %s (" + " k int," + " v int, "+ " lower_case_map map<int, int>,"+ " \"MixedCaseMap\" map<int, int>,"+ " lower_case_frozen_list frozen<list<int>>,"+ " \"UPPER_CASE_FROZEN_LIST\" frozen<list<int>>,"+ " \"set name with spaces\" set<int>,"+ " \"column_name_with\"\"escaped quote\" int,"+ " PRIMARY KEY (k))");
  createAndDropIndexWithQuotedColumnIdentifier("\"v\"");
  createAndDropIndexWithQuotedColumnIdentifier("keys(\"lower_case_map\")");
  createAndDropIndexWithQuotedColumnIdentifier("keys(\"MixedCaseMap\")");
  createAndDropIndexWithQuotedColumnIdentifier("full(\"lower_case_frozen_list\")");
  createAndDropIndexWithQuotedColumnIdentifier("full(\"UPPER_CASE_FROZEN_LIST\")");
  createAndDropIndexWithQuotedColumnIdentifier("values(\"set name with spaces\")");
  createAndDropIndexWithQuotedColumnIdentifier("\"column_name_with\"\"escaped quote\"");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnPartitionKeyInsertValueOver64k() throws Throwable {
  createTable("CREATE TABLE %s(a int, b int, c blob, PRIMARY KEY ((a, b)))");
  createIndex("CREATE INDEX ON %s(a)");
  succeedInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?) IF NOT EXISTS",ByteBuffer.allocate(TOO_BIG));
  succeedInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?)",ByteBuffer.allocate(TOO_BIG));
  succeedInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (0, 0, ?);\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  long batchSizeThreshold=DatabaseDescriptor.getBatchSizeFailThreshold();
  try {
    DatabaseDescriptor.setBatchSizeFailThresholdInKB((TOO_BIG / 1024) * 2);
    succeedInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (1, 1, ?) IF NOT EXISTS;\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  }
  finally {
    DatabaseDescriptor.setBatchSizeFailThresholdInKB((int)(batchSizeThreshold / 1024));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.map_keys_indexing()
 */
@Test public void testIndexOnMapKeys() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, m map<text, int>, PRIMARY KEY (k, v))");
  createIndex("CREATE INDEX ON %s(keys(m))");
  execute("INSERT INTO %s (k, v, m) VALUES (0, 0, {'a' : 1})");
  execute("INSERT INTO %s (k, v, m) VALUES (0, 1, {'a' : 1, 'b' : 2})");
  execute("INSERT INTO %s (k, v, m) VALUES (0, 2, {'c' : 3})");
  execute("INSERT INTO %s (k, v, m) VALUES (1, 0, {'b' : 1})");
  execute("INSERT INTO %s (k, v, m) VALUES (1, 1, {'a' : 1, 'b' : 3})");
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS KEY 'a'"),row(1,1),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND m CONTAINS KEY 'a'"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS KEY 'c'"),row(0,2));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE m CONTAINS KEY 'd'"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for the validation bug of #4709,
 * migrated from cql_tests.py:TestCQL.refuse_in_with_indexes_test()
 */
@Test public void testInvalidIndexSelect() throws Throwable {
  createTable("create table %s (pk varchar primary key, col1 varchar, col2 varchar)");
  createIndex("create index on %s (col1)");
  createIndex("create index on %s (col2)");
  execute("insert into %s (pk, col1, col2) values ('pk1','foo1','bar1')");
  execute("insert into %s (pk, col1, col2) values ('pk1a','foo1','bar1')");
  execute("insert into %s (pk, col1, col2) values ('pk1b','foo1','bar1')");
  execute("insert into %s (pk, col1, col2) values ('pk1c','foo1','bar1')");
  execute("insert into %s (pk, col1, col2) values ('pk2','foo2','bar2')");
  execute("insert into %s (pk, col1, col2) values ('pk3','foo3','bar3')");
  assertInvalid("select * from %s where col2 in ('bar1', 'bar2')");
  createTable("CREATE TABLE %s (k int PRIMARY KEY, a int, b int)");
  createIndex("CREATE INDEX ON %s (a)");
  assertInvalid("SELECT * FROM %s WHERE a = 3 AND b IN (1, 3)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.collection_indexing_test()
 */
@Test public void testIndexOnCollections() throws Throwable {
  createTable(" CREATE TABLE %s ( k int, v int, l list<int>, s set<text>, m map<text, int>, PRIMARY KEY (k, v))");
  createIndex("CREATE INDEX ON %s (l)");
  createIndex("CREATE INDEX ON %s (s)");
  createIndex("CREATE INDEX ON %s (m)");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (0, 0, [1, 2],    {'a'},      {'a' : 1})");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (0, 1, [3, 4],    {'b', 'c'}, {'a' : 1, 'b' : 2})");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (0, 2, [1],       {'a', 'c'}, {'c' : 3})");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (1, 0, [1, 2, 4], {},         {'b' : 1})");
  execute("INSERT INTO %s (k, v, l, s, m) VALUES (1, 1, [4, 5],    {'d'},      {'a' : 1, 'b' : 3})");
  assertRows(execute("SELECT k, v FROM %s WHERE l CONTAINS 1"),row(1,0),row(0,0),row(0,2));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND l CONTAINS 1"),row(0,0),row(0,2));
  assertRows(execute("SELECT k, v FROM %s WHERE l CONTAINS 2"),row(1,0),row(0,0));
  assertEmpty(execute("SELECT k, v FROM %s WHERE l CONTAINS 6"));
  assertRows(execute("SELECT k, v FROM %s WHERE s CONTAINS 'a'"),row(0,0),row(0,2));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND s CONTAINS 'a'"),row(0,0),row(0,2));
  assertRows(execute("SELECT k, v FROM %s WHERE s CONTAINS 'd'"),row(1,1));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE s CONTAINS 'e'"));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS 1"),row(1,0),row(1,1),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE k = 0 AND m CONTAINS 1"),row(0,0),row(0,1));
  assertRows(execute("SELECT k, v FROM %s WHERE m CONTAINS 2"),row(0,1));
  assertEmpty(execute("SELECT k, v FROM %s  WHERE m CONTAINS 4"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnFullCollectionEntryInsertCollectionValueOver64k() throws Throwable {
  createTable("CREATE TABLE %s(a int, b frozen<map<int, blob>>, PRIMARY KEY (a))");
  createIndex("CREATE INDEX ON %s(full(b))");
  Map<Integer,ByteBuffer> map=new HashMap<>();
  map.put(0,ByteBuffer.allocate(1024 * 65));
  failInsert("INSERT INTO %s (a, b) VALUES (0, ?)",map);
  failInsert("INSERT INTO %s (a, b) VALUES (0, ?) IF NOT EXISTS",map);
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b) VALUES (0, ?);\n" + "APPLY BATCH",map);
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b) VALUES (0, ?) IF NOT EXISTS;\n" + "APPLY BATCH",map);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateAndDropIndexWithQuotedIdentifier() throws Throwable {
  testCreateAndDropIndex("\"quoted_ident\"",false);
  testCreateAndDropIndex("\"quoted_ident2\"",true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.edge_2i_on_complex_pk_test()
 */
@Test public void testIndexesOnComplexPrimaryKey() throws Throwable {
  createTable("CREATE TABLE %s (pk0 int, pk1 int, ck0 int, ck1 int, ck2 int, value int, PRIMARY KEY ((pk0, pk1), ck0, ck1, ck2))");
  execute("CREATE INDEX ON %s (pk0)");
  execute("CREATE INDEX ON %s (ck0)");
  execute("CREATE INDEX ON %s (ck1)");
  execute("CREATE INDEX ON %s (ck2)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (0, 1, 2, 3, 4, 5)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (1, 2, 3, 4, 5, 0)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (2, 3, 4, 5, 0, 1)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (3, 4, 5, 0, 1, 2)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (4, 5, 0, 1, 2, 3)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (5, 0, 1, 2, 3, 4)");
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 2"),row(1));
  assertRows(execute("SELECT value FROM %s WHERE ck0 = 0"),row(3));
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 3 AND pk1 = 4 AND ck1 = 0"),row(2));
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 5 AND pk1 = 0 AND ck0 = 1 AND ck2 = 3 ALLOW FILTERING"),row(4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #6950 bug,
 * migrated from cql_tests.py:TestCQL.key_index_with_reverse_clustering()
 */
@Test public void testIndexOnKeyWithReverseClustering() throws Throwable {
  createTable("CREATE TABLE %s (k1 int, k2 int, v int, PRIMARY KEY ((k1, k2), v) ) WITH CLUSTERING ORDER BY (v DESC)");
  createIndex("CREATE INDEX ON %s (k2)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (0, 0, 1)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (0, 1, 2)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (0, 0, 3)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (1, 0, 4)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (1, 1, 5)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (2, 0, 7)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (2, 1, 8)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (3, 0, 1)");
  assertRows(execute("SELECT * FROM %s WHERE k2 = 0 AND v >= 2 ALLOW FILTERING"),row(2,0,7),row(0,0,3),row(1,0,4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactTableWithValueOver64k() throws Throwable {
  createTable("CREATE TABLE %s(a int, b blob, PRIMARY KEY (a)) WITH COMPACT STORAGE");
  createIndex("CREATE INDEX ON %s(b)");
  failInsert("INSERT INTO %s (a, b) VALUES (0, ?)",ByteBuffer.allocate(TOO_BIG));
  failInsert("INSERT INTO %s (a, b) VALUES (0, ?) IF NOT EXISTS",ByteBuffer.allocate(TOO_BIG));
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b) VALUES (0, ?);\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  failInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b) VALUES (0, ?) IF NOT EXISTS;\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.invalid_clustering_indexing_test()
 */
@Test public void testIndexesOnClusteringInvalid() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY ((a, b))) WITH COMPACT STORAGE");
  assertInvalid("CREATE INDEX ON %s (a)");
  assertInvalid("CREATE INDEX ON %s (b)");
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b)) WITH COMPACT STORAGE");
  assertInvalid("CREATE INDEX ON %s (a)");
  assertInvalid("CREATE INDEX ON %s (b)");
  assertInvalid("CREATE INDEX ON %s (c)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-6612,
 * migrated from cql_tests.py:TestCQL.bug_6612_test()
 */
@Test public void testSelectCountOnIndexedColumn() throws Throwable {
  createTable("CREATE TABLE %s (username text, session_id text, app_name text, account text, last_access timestamp, created_on timestamp, PRIMARY KEY (username, session_id, app_name, account))");
  createIndex("create index ON %s (app_name)");
  createIndex("create index ON %s (last_access)");
  assertRows(execute("select count(*) from %s where app_name='foo' and account='bar' and last_access > 4 allow filtering"),row(0L));
  execute("insert into %s (username, session_id, app_name, account, last_access, created_on) values ('toto', 'foo', 'foo', 'bar', 12, 13)");
  assertRows(execute("select count(*) from %s where app_name='foo' and account='bar' and last_access > 4 allow filtering"),row(1L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.clustering_indexing_test()
 */
@Test public void testIndexesOnClustering() throws Throwable {
  createTable("CREATE TABLE %s ( id1 int, id2 int, author text, time bigint, v1 text, v2 text, PRIMARY KEY ((id1, id2), author, time))");
  createIndex("CREATE INDEX ON %s (time)");
  execute("CREATE INDEX ON %s (id2)");
  execute("INSERT INTO %s (id1, id2, author, time, v1, v2) VALUES(0, 0, 'bob', 0, 'A', 'A')");
  execute("INSERT INTO %s (id1, id2, author, time, v1, v2) VALUES(0, 0, 'bob', 1, 'B', 'B')");
  execute("INSERT INTO %s (id1, id2, author, time, v1, v2) VALUES(0, 1, 'bob', 2, 'C', 'C')");
  execute("INSERT INTO %s (id1, id2, author, time, v1, v2) VALUES(0, 0, 'tom', 0, 'D', 'D')");
  execute("INSERT INTO %s (id1, id2, author, time, v1, v2) VALUES(0, 1, 'tom', 1, 'E', 'E')");
  assertRows(execute("SELECT v1 FROM %s WHERE time = 1"),row("B"),row("E"));
  assertRows(execute("SELECT v1 FROM %s WHERE id2 = 1"),row("C"),row("E"));
  assertRows(execute("SELECT v1 FROM %s WHERE id1 = 0 AND id2 = 0 AND author = 'bob' AND time = 0"),row("A"));
  execute("UPDATE %s SET v2 = null WHERE id1 = 0 AND id2 = 0 AND author = 'bob' AND time = 1");
  assertRows(execute("SELECT v1 FROM %s WHERE id2 = 0"),row("A"),row("B"),row("D"));
  assertRows(execute("SELECT v1 FROM %s WHERE time = 1"),row("B"),row("E"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnClusteringColumnInsertValueOver64k() throws Throwable {
  createTable("CREATE TABLE %s(a int, b int, c blob, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX ON %s(b)");
  succeedInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?) IF NOT EXISTS",ByteBuffer.allocate(TOO_BIG));
  succeedInsert("INSERT INTO %s (a, b, c) VALUES (0, 0, ?)",ByteBuffer.allocate(TOO_BIG));
  succeedInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (0, 0, ?);\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  long batchSizeThreshold=DatabaseDescriptor.getBatchSizeFailThreshold();
  try {
    DatabaseDescriptor.setBatchSizeFailThresholdInKB((TOO_BIG / 1024) * 2);
    succeedInsert("BEGIN BATCH\n" + "INSERT INTO %s (a, b, c) VALUES (1, 1, ?) IF NOT EXISTS;\n" + "APPLY BATCH",ByteBuffer.allocate(TOO_BIG));
  }
  finally {
    DatabaseDescriptor.setBatchSizeFailThresholdInKB((int)(batchSizeThreshold / 1024));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-5240,
 * migrated from cql_tests.py:TestCQL.bug_5240_test()
 */
@Test public void testIndexOnCompoundRowKey() throws Throwable {
  createTable("CREATE TABLE %s (interval text, seq int, id int, severity int, PRIMARY KEY ((interval, seq), id) ) WITH CLUSTERING ORDER BY (id DESC)");
  execute("CREATE INDEX ON %s (severity)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 1, 1)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 2, 1)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 3, 2)");
  execute("insert into %s (interval, seq, id , severity) values('t',1, 4, 3)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 1, 3)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 2, 3)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 3, 1)");
  execute("insert into %s (interval, seq, id , severity) values('t',2, 4, 2)");
  assertRows(execute("select * from %s where severity = 3 and interval = 't' and seq =1"),row("t",1,4,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyntaxVariationsForIndexOnCollectionsValue() throws Throwable {
  createTable("CREATE TABLE %s (k int, m map<int, int>, l list<int>, s set<int>, PRIMARY KEY (k))");
  createAndDropCollectionValuesIndex("m");
  createAndDropCollectionValuesIndex("l");
  createAndDropCollectionValuesIndex("s");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.StaticColumnsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test LIMIT when static columns are present (#6956),
 * migrated from cql_tests.py:TestCQL.static_with_limit_test()
 */
@Test public void testStaticColumnsWithLimit() throws Throwable {
  createTable(" CREATE TABLE %s (k int, s int static, v int, PRIMARY KEY (k, v))");
  execute("INSERT INTO %s (k, s) VALUES(0, 42)");
  for (int i=0; i < 4; i++)   execute("INSERT INTO %s(k, v) VALUES(0, ?)",i);
  assertRows(execute("SELECT * FROM %s WHERE k = 0 LIMIT 1"),row(0,0,42));
  assertRows(execute("SELECT * FROM %s WHERE k = 0 LIMIT 2"),row(0,0,42),row(0,1,42));
  assertRows(execute("SELECT * FROM %s WHERE k = 0 LIMIT 3"),row(0,0,42),row(0,1,42),row(0,2,42));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.static_columns_with_2i_test()
 */
@Test public void testStaticColumnsWithSecondaryIndex() throws Throwable {
  createTable(" CREATE TABLE %s (k int, p int, s int static, v int, PRIMARY KEY (k, p) ) ");
  createIndex("CREATE INDEX ON %s (v)");
  execute("INSERT INTO %s (k, p, s, v) VALUES (0, 0, 42, 1)");
  execute("INSERT INTO %s (k, p, v) VALUES (0, 1, 1)");
  execute("INSERT INTO %s (k, p, v) VALUES (0, 2, 2)");
  assertRows(execute("SELECT * FROM %s WHERE v = 1"),row(0,0,42,1),row(0,1,42,1));
  assertRows(execute("SELECT p, s FROM %s WHERE v = 1"),row(0,42),row(1,42));
  assertRows(execute("SELECT p FROM %s WHERE v = 1"),row(0),row(1));
  assertInvalid("SELECT s FROM %s WHERE v = 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.alter_clustering_and_static_test()
 */
@Test public void testAlterClusteringAndStatic() throws Throwable {
  createTable("CREATE TABLE %s (bar int, PRIMARY KEY (bar))");
  assertInvalid("ALTER TABLE %s ADD bar2 text static");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for bug of #7455,
 * migrated from cql_tests.py:TestCQL.static_with_empty_clustering_test()
 */
@Test public void testStaticColumnsWithEmptyClustering() throws Throwable {
  createTable("CREATE TABLE %s (pkey text, ckey text, value text, static_value text static, PRIMARY KEY(pkey, ckey))");
  execute("INSERT INTO %s (pkey, static_value) VALUES ('partition1', 'static value')");
  execute("INSERT INTO %s (pkey, ckey, value) VALUES('partition1', '', 'value')");
  assertRows(execute("SELECT * FROM %s"),row("partition1","","static value","value"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TimestampTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNegativeTimestamps() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int)");
  execute("INSERT INTO %s (k, v) VALUES (?, ?) USING TIMESTAMP ?",1,1,-42L);
  assertRows(execute("SELECT writetime(v) FROM %s WHERE k = ?",1),row(-42L));
  assertInvalid("INSERT INTO %s (k, v) VALUES (?, ?) USING TIMESTAMP ?",2,2,Long.MIN_VALUE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertTimestampWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, i int)");
  execute("INSERT INTO %s (k, i) VALUES (1, 1) USING TIMESTAMP ?",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.invalid_custom_timestamp_test()
 */
@Test public void testInvalidCustomTimestamp() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY (k, v))");
  execute("BEGIN BATCH " + "INSERT INTO %1$s (k, v) VALUES(0, 0) IF NOT EXISTS; " + "INSERT INTO %1$s (k, v) VALUES(0, 1) IF NOT EXISTS; "+ "APPLY BATCH");
  assertInvalid("BEGIN BATCH " + "INSERT INTO %1$s (k, v) VALUES(0, 2) IF NOT EXISTS USING TIMESTAMP 1; " + "INSERT INTO %1$s (k, v) VALUES(0, 3) IF NOT EXISTS; "+ "APPLY BATCH");
  assertInvalid("BEGIN BATCH " + "USING TIMESTAMP 1 INSERT INTO %1$s (k, v) VALUES(0, 4) IF NOT EXISTS; " + "INSERT INTO %1$s (k, v) VALUES(0, 1) IF NOT EXISTS; "+ "APPLY BATCH");
  execute("INSERT INTO %s (k, v) VALUES(1, 0) IF NOT EXISTS");
  assertInvalid("INSERT INTO %s (k, v) VALUES(1, 1) IF NOT EXISTS USING TIMESTAMP 5");
  createTable("CREATE TABLE %s (k int PRIMARY KEY, c counter)");
  execute("UPDATE %s SET c = c + 1 WHERE k = 0");
  assertInvalid("UPDATE %s USING TIMESTAMP 10 SET c = c + 1 WHERE k = 0");
  execute("BEGIN COUNTER BATCH " + "UPDATE %1$s SET c = c + 1 WHERE k = 0; " + "UPDATE %1$s SET c = c + 1 WHERE k = 0; "+ "APPLY BATCH");
  assertInvalid("BEGIN COUNTER BATCH " + "UPDATE %1$s USING TIMESTAMP 3 SET c = c + 1 WHERE k = 0; " + "UPDATE %1$s SET c = c + 1 WHERE k = 0; "+ "APPLY BATCH");
  assertInvalid("BEGIN COUNTER BATCH " + "USING TIMESTAMP 3 UPDATE %1$s SET c = c + 1 WHERE k = 0; " + "UPDATE %1$s SET c = c + 1 WHERE k = 0; "+ "APPLY BATCH");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TimeuuidTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for 5386,
 * migrated from cql_tests.py:TestCQL.function_and_reverse_type_test()
 */
@Test public void testDescClusteringOnTimeuuid() throws Throwable {
  createTable("CREATE TABLE %s (k int, c timeuuid, v int, PRIMARY KEY (k, c)) WITH CLUSTERING ORDER BY (c DESC)");
  execute("INSERT INTO %s (k, c, v) VALUES (0, now(), 0)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TupleTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, t tuple<int, text, double>)");
  assertInvalidMessage("Invalid unset value for tuple field number 1","INSERT INTO %s (k, t) VALUES(0, (3, ?, 2.1))",unset());
  createIndex("CREATE INDEX tuple_index ON %s (t)");
  assertInvalidMessage("Invalid unset value for tuple field number 0","SELECT * FROM %s WHERE k = ? and t = (?,?,?)",unset(),unset(),unset(),unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleFromString() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, t frozen<tuple<int, text>>, PRIMARY KEY (k, c))");
  execute("INSERT INTO %s (k, c, t) VALUES (0, 0, '0:0')");
  execute("INSERT INTO %s (k, c, t) VALUES (0, 1, '0:1')");
  execute("INSERT INTO %s (k, c, t) VALUES (0, 2, '1')");
  execute("INSERT INTO %s (k, c, t) VALUES (0, 3, '1:1\\:1')");
  execute("INSERT INTO %s (k, c, t) VALUES (0, 4, '@:1')");
  assertAllRows(row(0,0,tuple(0,"0")),row(0,1,tuple(0,"1")),row(0,2,tuple(1)),row(0,3,tuple(1,"1:1")),row(0,4,tuple(null,"1")));
  assertInvalidMessage("Invalid tuple literal: too many elements. Type frozen<tuple<int, text>> expects 2 but got 3","INSERT INTO %s(k, t) VALUES (1,'1:2:3')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidQueries() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, t frozen<tuple<int, text, double>>)");
  assertInvalidSyntax("INSERT INTO %s (k, t) VALUES (0, ())");
  assertInvalidMessage("Invalid tuple literal for t: too many elements. Type frozen<tuple<int, text, double>> expects 3 but got 4","INSERT INTO %s (k, t) VALUES (0, (2, 'foo', 3.1, 'bar'))");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleInPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (t frozen<tuple<int, text>> PRIMARY KEY)");
  execute("INSERT INTO %s (t) VALUES (?)",tuple(3,"foo"));
  assertAllRows(row(tuple(3,"foo")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleInClusteringKey() throws Throwable {
  createTable("CREATE TABLE %s (k int, t frozen<tuple<int, text>>, PRIMARY KEY (k, t))");
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(5,"bar"));
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(3,"foo"));
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(6,"bar"));
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(5,"foo"));
  assertAllRows(row(0,tuple(3,"foo")),row(0,tuple(5,"bar")),row(0,tuple(5,"foo")),row(0,tuple(6,"bar")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-8062,
 * migrated from cql_tests.py:TestCQL.test_v2_protocol_IN_with_tuples()
 */
@Test public void testSelectInStatementWithTuples() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 text, PRIMARY KEY (k, c1, c2))");
  execute("INSERT INTO %s (k, c1, c2) VALUES (0, 0, 'a')");
  execute("INSERT INTO %s (k, c1, c2) VALUES (0, 0, 'b')");
  execute("INSERT INTO %s (k, c1, c2) VALUES (0, 0, 'c')");
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND (c1, c2) IN ((0, 'b'), (0, 'c'))"),row(0,0,"b"),row(0,0,"c"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedTuple() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, t frozen<tuple<int, tuple<text, double>>>)");
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(3,tuple("foo",3.4)));
  execute("INSERT INTO %s (k, t) VALUES (?, ?)",1,tuple(8,tuple("bar",0.2)));
  assertAllRows(row(1,tuple(8,tuple("bar",0.2))),row(0,tuple(3,tuple("foo",3.4))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTuplePutAndGet() throws Throwable {
  String[] valueTypes={"frozen<tuple<int, text, double>>","tuple<int, text, double>"};
  for (  String valueType : valueTypes) {
    createTable("CREATE TABLE %s (k int PRIMARY KEY, t " + valueType + ")");
    execute("INSERT INTO %s (k, t) VALUES (?, ?)",0,tuple(3,"foo",3.4));
    execute("INSERT INTO %s (k, t) VALUES (?, ?)",1,tuple(8,"bar",0.2));
    assertAllRows(row(1,tuple(8,"bar",0.2)),row(0,tuple(3,"foo",3.4)));
    execute("INSERT INTO %s (k, t) VALUES (?, ?)",2,tuple(5,null,3.4));
    assertRows(execute("SELECT * FROM %s WHERE k=?",2),row(2,tuple(5,null,3.4)));
    execute("INSERT INTO %s (k, t) VALUES (?, ?)",3,tuple(5,"bar"));
    assertRows(execute("SELECT * FROM %s WHERE k=?",3),row(3,tuple(5,"bar")));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the syntax introduced by #4851,
 * migrated from cql_tests.py:TestCQL.tuple_notation_test()
 */
@Test public void testTupleNotation() throws Throwable {
  createTable("CREATE TABLE %s (k int, v1 int, v2 int, v3 int, PRIMARY KEY (k, v1, v2, v3))");
  for (int i=0; i < 2; i++)   for (int j=0; j < 2; j++)   for (int k=0; k < 2; k++)   execute("INSERT INTO %s (k, v1, v2, v3) VALUES (0, ?, ?, ?)",i,j,k);
  assertRows(execute("SELECT v1, v2, v3 FROM %s WHERE k = 0"),row(0,0,0),row(0,0,1),row(0,1,0),row(0,1,1),row(1,0,0),row(1,0,1),row(1,1,0),row(1,1,1));
  assertRows(execute("SELECT v1, v2, v3 FROM %s WHERE k = 0 AND (v1, v2, v3) >= (1, 0, 1)"),row(1,0,1),row(1,1,0),row(1,1,1));
  assertRows(execute("SELECT v1, v2, v3 FROM %s WHERE k = 0 AND (v1, v2) >= (1, 1)"),row(1,1,0),row(1,1,1));
  assertRows(execute("SELECT v1, v2, v3 FROM %s WHERE k = 0 AND (v1, v2) > (0, 1) AND (v1, v2, v3) <= (1, 1, 0)"),row(1,0,0),row(1,0,1),row(1,1,0));
  assertInvalid("SELECT v1, v2, v3 FROM %s WHERE k = 0 AND (v1, v3) > (1, 0)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonExistingOnes() throws Throwable {
  assertInvalidMessage("No user type named","DROP TYPE " + KEYSPACE + ".type_does_not_exist");
  assertInvalidMessage("Cannot drop type in unknown keyspace","DROP TYPE keyspace_does_not_exist.type_does_not_exist");
  execute("DROP TYPE IF EXISTS " + KEYSPACE + ".type_does_not_exist");
  execute("DROP TYPE IF EXISTS keyspace_does_not_exist.type_does_not_exist");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterReversedColumn() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b 'org.apache.cassandra.db.marshal.DateType', PRIMARY KEY (a, b)) WITH CLUSTERING ORDER BY (b DESC)");
  alterTable("ALTER TABLE %s ALTER b TYPE 'org.apache.cassandra.db.marshal.ReversedType(org.apache.cassandra.db.marshal.TimestampType)'");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFAuthTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectTokenSliceRestriction() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE token(k) < token(%s)",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInClusteringValuesForDelete() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("DELETE FROM %s WHERE k = 0 AND v1 = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void revokeExecutePermissionsOnAggregateComponents() throws Throwable {
  String sFunc=createSimpleStateFunction();
  String fFunc=createSimpleFinalFunction();
  String aggDef=aggregateCql(sFunc,fFunc);
  grantExecuteOnFunction(sFunc);
  grantExecuteOnFunction(fFunc);
  String aggregate=createAggregate(KEYSPACE,"int",aggDef);
  grantExecuteOnFunction(aggregate);
  String cql=String.format("SELECT %s(v1) FROM %s",aggregate,KEYSPACE + "." + currentTable());
  getStatement(cql).checkAccess(clientState);
  revokeExecuteOnFunction(aggregate);
  assertUnauthorized(cql,aggregate,"int");
  grantExecuteOnFunction(aggregate);
  getStatement(cql).checkAccess(clientState);
  revokeExecuteOnFunction(sFunc);
  assertUnauthorized(cql,sFunc,"int, int");
  grantExecuteOnFunction(sFunc);
  getStatement(cql).checkAccess(clientState);
  revokeExecuteOnFunction(fFunc);
  assertUnauthorized(cql,fFunc,"int");
  grantExecuteOnFunction(fFunc);
  getStatement(cql).checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void aggregateWrappingFunction() throws Throwable {
  String innerFunc=createFunction("int","CREATE FUNCTION %s(input int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return input;'");
  String sFunc=createSimpleStateFunction();
  String fFunc=createSimpleFinalFunction();
  String aggDef=aggregateCql(sFunc,fFunc);
  grantExecuteOnFunction(sFunc);
  grantExecuteOnFunction(fFunc);
  String aggregate=createAggregate(KEYSPACE,"int",aggDef);
  String cql=String.format("SELECT %s(%s(v1)) FROM %s",aggregate,innerFunc,KEYSPACE + "." + currentTable());
  assertUnauthorized(cql,aggregate,"int");
  grantExecuteOnFunction(aggregate);
  assertUnauthorized(cql,innerFunc,"int");
  grantExecuteOnFunction(innerFunc);
  getStatement(cql).checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelection() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT k, %s FROM %s WHERE k = 1;",functionCall(functionName),KEYSPACE + "." + currentTable());
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectTokenEQRestriction() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE token(k) = token(%s)",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectMultiColumnInRestriction() throws Throwable {
  setupTable("CREATE TABLE %s (k int, v1 int, v2 int, v3 int, PRIMARY KEY (k, v1, v2))");
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k=0 AND (v1, v2) IN ((%s, %s))",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInPKForInsert() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("INSERT INTO %s (k, v1, v2) VALUES (%s, 0, 0)",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectMultiColumnSliceRestriction() throws Throwable {
  setupTable("CREATE TABLE %s (k int, v1 int, v2 int, v3 int, PRIMARY KEY (k, v1, v2))");
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k=0 AND (v1, v2) < (%s, %s)",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectMultiColumnEQRestriction() throws Throwable {
  setupTable("CREATE TABLE %s (k int, v1 int, v2 int, v3 int, PRIMARY KEY (k, v1, v2))");
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k=0 AND (v1, v2) = (%s, %s)",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedFunctions() throws Throwable {
  String innerFunctionName=createSimpleFunction();
  String outerFunctionName=createFunction("int","CREATE FUNCTION %s(input int) " + " CALLED ON NULL INPUT" + " RETURNS int"+ " LANGUAGE java"+ " AS 'return Integer.valueOf(0);'");
  assertPermissionsOnNestedFunctions(innerFunctionName,outerFunctionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInCollectionElementCondition() throws Throwable {
  setupTable("CREATE TABLE %s (k int, v1 int, m_val map<int, int>, PRIMARY KEY(k))");
  String functionName=createSimpleFunction();
  String cql=String.format("UPDATE %s SET v1 = 0 WHERE k = 0 IF m_val[%s] = %s",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInPKForDelete() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("DELETE FROM %s WHERE k = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectInRestriction() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k IN (%s, %s)",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void requireExecutePermissionOnComponentFunctionsWhenDefiningAggregate() throws Throwable {
  String sFunc=createSimpleStateFunction();
  String fFunc=createSimpleFinalFunction();
  DatabaseDescriptor.getAuthorizer().grant(AuthenticatedUser.SYSTEM_USER,ImmutableSet.of(Permission.CREATE),FunctionResource.keyspace(KEYSPACE),role);
  String aggDef=String.format(aggregateCql(sFunc,fFunc),KEYSPACE + ".aggregate_for_permissions_test");
  assertUnauthorized(aggDef,sFunc,"int, int");
  grantExecuteOnFunction(sFunc);
  assertUnauthorized(aggDef,fFunc,"int");
  grantExecuteOnFunction(fFunc);
  getStatement(aggDef).checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectClusteringRestriction() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k = 0 AND v1 = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void systemFunctionsRequireNoExplicitPrivileges() throws Throwable {
  String cql=String.format("UPDATE %s SET v2 = 0 WHERE k = blobasint(intasblob(0)) and v1 = 0",KEYSPACE + "." + currentTable());
  getStatement(cql).checkAccess(clientState);
  String functionName=createSimpleFunction();
  grantExecuteOnFunction(functionName);
  cql=String.format("UPDATE %s SET v2 = 0 WHERE k = blobasint(intasblob(%s)) and v1 = 0",KEYSPACE + "." + currentTable(),functionCall(functionName));
  getStatement(cql).checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInStaticColumnRestrictionInSelect() throws Throwable {
  setupTable("CREATE TABLE %s (k int, s int STATIC, v1 int, v2 int, PRIMARY KEY(k, v1))");
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT k FROM %s WHERE k = 0 AND s = %s ALLOW FILTERING",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInSelectPKRestriction() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("SELECT * FROM %s WHERE k = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInStaticColumnCondition() throws Throwable {
  setupTable("CREATE TABLE %s (k int, s int STATIC, v1 int, v2 int, PRIMARY KEY(k, v1))");
  String functionName=createSimpleFunction();
  String cql=String.format("UPDATE %s SET v2 = 0 WHERE k = 0 AND v1 = 0 IF s = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchStatement() throws Throwable {
  List<ModificationStatement> statements=new ArrayList<>();
  List<String> functions=new ArrayList<>();
  for (int i=0; i < 3; i++) {
    String functionName=createSimpleFunction();
    ModificationStatement stmt=(ModificationStatement)getStatement(String.format("INSERT INTO %s (k, v1, v2) " + "VALUES (%s, %s, %s)",KEYSPACE + "." + currentTable(),i,i,functionCall(functionName)));
    functions.add(functionName);
    statements.add(stmt);
  }
  BatchStatement batch=new BatchStatement(-1,BatchStatement.Type.LOGGED,statements,Attributes.none());
  assertUnauthorized(batch,functions);
  grantExecuteOnFunction(functions.get(0));
  assertUnauthorized(batch,functions.subList(1,functions.size()));
  grantExecuteOnFunction(functions.get(1));
  assertUnauthorized(batch,functions.subList(2,functions.size()));
  grantExecuteOnFunction(functions.get(2));
  batch.checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInClusteringValuesForInsert() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("INSERT INTO %s (k, v1, v2) VALUES (0, %s, 0)",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInCollectionLiteralCondition() throws Throwable {
  setupTable("CREATE TABLE %s (k int, v1 int, m_val map<int, int>, PRIMARY KEY(k))");
  String functionName=createSimpleFunction();
  String cql=String.format("UPDATE %s SET v1 = 0 WHERE k = 0 IF m_val = {%s : %s}",KEYSPACE + "." + currentTable(),functionCall(functionName),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionWrappingAggregate() throws Throwable {
  String outerFunc=createFunction("int","CREATE FUNCTION %s(input int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return input;'");
  String sFunc=createSimpleStateFunction();
  String fFunc=createSimpleFinalFunction();
  String aggDef=aggregateCql(sFunc,fFunc);
  grantExecuteOnFunction(sFunc);
  grantExecuteOnFunction(fFunc);
  String aggregate=createAggregate(KEYSPACE,"int",aggDef);
  String cql=String.format("SELECT %s(%s(v1)) FROM %s",outerFunc,aggregate,KEYSPACE + "." + currentTable());
  assertUnauthorized(cql,outerFunc,"int");
  grantExecuteOnFunction(outerFunc);
  assertUnauthorized(cql,aggregate,"int");
  grantExecuteOnFunction(aggregate);
  getStatement(cql).checkAccess(clientState);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void functionInRegularCondition() throws Throwable {
  String functionName=createSimpleFunction();
  String cql=String.format("UPDATE %s SET v2 = 0 WHERE k = 0 AND v1 = 0 IF v2 = %s",KEYSPACE + "." + currentTable(),functionCall(functionName));
  assertPermissionsOnFunction(cql,functionName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFIdentificationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testModificationStatementWithConditions() throws Throwable {
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF t_sc=%s",functionCall(tFunc,"'foo'")),tFunc);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF i_val=%s",functionCall(iFunc,"1")),iFunc);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF l_val=%s",functionCall(lFunc,"[1]")),lFunc);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF s_val=%s",functionCall(sFunc,"{1}")),sFunc);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF m_val=%s",functionCall(mFunc,"{1:1}")),mFunc);
  String iFunc2=createEchoFunction("int");
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF i_val IN (%s, %S)",functionCall(iFunc,"1"),functionCall(iFunc2,"2")),iFunc,iFunc2);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF u_val=%s",functionCall(uFunc,"now()")),uFunc,"system.now");
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF l_val[%s] = %s",functionCall(iFunc,"1"),functionCall(iFunc2,"1")),iFunc,iFunc2);
  assertFunctions(cql("UPDATE %s SET i_val=0 WHERE key=0 AND i_cc = 0 AND t_cc = 'A' IF m_val[%s] = %s",functionCall(iFunc,"1"),functionCall(iFunc2,"1")),iFunc,iFunc2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchStatement() throws Throwable {
  String iFunc2=createEchoFunction("int");
  List<ModificationStatement> statements=new ArrayList<>();
  statements.add(modificationStatement(cql("INSERT INTO %s (key, i_cc, t_cc) VALUES (%s, 0, 'foo')",functionCall(iFunc,"0"))));
  statements.add(modificationStatement(cql("INSERT INTO %s (key, i_cc, t_cc) VALUES (1, %s, 'foo')",functionCall(iFunc2,"1"))));
  statements.add(modificationStatement(cql("INSERT INTO %s (key, i_cc, t_cc) VALUES (2, 2, %s)",functionCall(tFunc,"'foo'"))));
  BatchStatement batch=new BatchStatement(-1,BatchStatement.Type.LOGGED,statements,Attributes.none());
  assertFunctions(batch,iFunc,iFunc2,tFunc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectStatementSimpleSelections() throws Throwable {
  String iFunc2=createEchoFunction("int");
  execute("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'foo', 0)");
  assertFunctions(cql2("SELECT i_val, %s FROM %s WHERE key=0",functionCall(iFunc,"i_val")),iFunc);
  assertFunctions(cql2("SELECT i_val, %s FROM %s WHERE key=0",nestedFunctionCall(iFunc,iFunc2,"i_val")),iFunc,iFunc2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTerminalTupleInSelectRestrictions() throws Throwable {
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND (i_cc, t_cc) IN ((%s, %s))",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'")),iFunc,tFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND (i_cc, t_cc) = (%s, %s)",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'")),iFunc,tFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND (i_cc, t_cc) > (%s, %s)",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'")),iFunc,tFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND (i_cc, t_cc) < (%s, %s)",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'")),iFunc,tFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND (i_cc, t_cc) > (%s, %s) AND (i_cc, t_cc) < (%s, %s)",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'"),functionCall(iFunc,"1"),functionCall(tFunc,"'foo'")),iFunc,tFunc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTerminalUDTLiterals() throws Throwable {
  String udtValue=String.format("{ i: %s, t : %s } ",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'"));
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, udt_val) VALUES (0, 0, 'A', %s)",udtValue),iFunc,tFunc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchStatementWithConditions() throws Throwable {
  List<ModificationStatement> statements=new ArrayList<>();
  statements.add(modificationStatement(cql("UPDATE %s SET i_val = %s WHERE key=0 AND i_cc=0 and t_cc='foo' IF l_val = %s",functionCall(iFunc,"0"),functionCall(lFunc,"[1]"))));
  statements.add(modificationStatement(cql("UPDATE %s SET i_val = %s WHERE key=0 AND i_cc=1 and t_cc='foo' IF s_val = %s",functionCall(iFunc,"0"),functionCall(sFunc,"{1}"))));
  BatchStatement batch=new BatchStatement(-1,BatchStatement.Type.LOGGED,statements,Attributes.none());
  assertFunctions(batch,iFunc,lFunc,sFunc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectStatementNestedSelections() throws Throwable {
  String iFunc2=createEchoFunction("int");
  execute("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'foo', 0)");
  assertFunctions(cql2("SELECT i_val, %s FROM %s WHERE key=0",functionCall(iFunc,"i_val")),iFunc);
  assertFunctions(cql2("SELECT i_val, %s FROM %s WHERE key=0",nestedFunctionCall(iFunc,iFunc2,"i_val")),iFunc,iFunc2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testModificationStatementWithNestedFunctions() throws Throwable {
  String iFunc2=createEchoFunction("int");
  String iFunc3=createEchoFunction("int");
  String iFunc4=createEchoFunction("int");
  String iFunc5=createEchoFunction("int");
  String iFunc6=createEchoFunction("int");
  String nestedFunctionCall=nestedFunctionCall(iFunc6,iFunc5,nestedFunctionCall(iFunc4,iFunc3,nestedFunctionCall(iFunc2,iFunc,"1")));
  assertFunctions(cql("DELETE FROM %s WHERE key=%s",nestedFunctionCall),iFunc,iFunc2,iFunc3,iFunc4,iFunc5,iFunc6);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTerminalCollectionLiterals() throws Throwable {
  String iFunc2=createEchoFunction("int");
  String mapValue=String.format("{%s:%s}",functionCall(iFunc,"1"),functionCall(iFunc2,"1"));
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, m_val) VALUES (0, 0, 'A', %s)",mapValue),iFunc,iFunc2);
  String listValue=String.format("[%s]",functionCall(iFunc,"1"));
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, l_val) VALUES (0, 0, 'A',  %s)",listValue),iFunc);
  String setValue=String.format("{%s}",functionCall(iFunc,"1"));
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, s_val) VALUES (0, 0, 'A', %s)",setValue),iFunc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectStatementRestrictionsWithNestedFunctions() throws Throwable {
  String iFunc2=createEchoFunction("int");
  String iFunc3=createEchoFunction("int");
  String iFunc4=createEchoFunction("int");
  String iFunc5=createEchoFunction("int");
  String iFunc6=createEchoFunction("int");
  String nestedFunctionCall=nestedFunctionCall(iFunc6,iFunc5,nestedFunctionCall(iFunc3,iFunc4,nestedFunctionCall(iFunc,iFunc2,"1")));
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=%s",nestedFunctionCall),iFunc,iFunc2,iFunc3,iFunc4,iFunc5,iFunc6);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleModificationStatement() throws Throwable {
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, t_sc) VALUES (0, 0, 'A', %s)",functionCall(tFunc,"'foo'")),tFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc) VALUES (0, %s, 'A')",functionCall(iFunc,"1")),iFunc);
  assertFunctions(cql("INSERT INTO %s (key, t_cc, i_cc) VALUES (0, %s, 1)",functionCall(tFunc,"'foo'")),tFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'A', %s)",functionCall(iFunc,"1")),iFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, l_val) VALUES (0, 0, 'A', %s)",functionCall(lFunc,"[1]")),lFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, s_val) VALUES (0, 0, 'A', %s)",functionCall(sFunc,"{1}")),sFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, m_val) VALUES (0, 0, 'A', %s)",functionCall(mFunc,"{1:1}")),mFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, udt_val) VALUES (0, 0, 'A', %s)",functionCall(udtFunc,"{i : 1, t : 'foo'}")),udtFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, u_val) VALUES (0, 0, 'A', %s)",functionCall(uFunc,"now()")),uFunc,"system.now");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelectStatementSimpleRestrictions() throws Throwable {
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=%s",functionCall(iFunc,"1")),iFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND t_sc=%s ALLOW FILTERING",functionCall(tFunc,"'foo'")),tFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND i_cc=%s AND t_cc='foo' ALLOW FILTERING",functionCall(iFunc,"1")),iFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=0 AND i_cc=0 AND t_cc=%s ALLOW FILTERING",functionCall(tFunc,"'foo'")),tFunc);
  String iFunc2=createEchoFunction("int");
  String tFunc2=createEchoFunction("text");
  assertFunctions(cql("SELECT i_val FROM %s WHERE key=%s AND t_sc=%s AND i_cc=%s AND t_cc=%s ALLOW FILTERING",functionCall(iFunc,"1"),functionCall(tFunc,"'foo'"),functionCall(iFunc2,"1"),functionCall(tFunc2,"'foo'")),iFunc,tFunc,iFunc2,tFunc2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedFunctionInTokenRestriction() throws Throwable {
  String iFunc2=createEchoFunction("int");
  assertFunctions(cql("SELECT i_val FROM %s WHERE token(key) = token(%s)",functionCall(iFunc,"1")),"system.token",iFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE token(key) > token(%s)",functionCall(iFunc,"1")),"system.token",iFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE token(key) < token(%s)",functionCall(iFunc,"1")),"system.token",iFunc);
  assertFunctions(cql("SELECT i_val FROM %s WHERE token(key) > token(%s) AND token(key) < token(%s)",functionCall(iFunc,"1"),functionCall(iFunc2,"1")),"system.token",iFunc,iFunc2);
}

</code></pre>

<br>
<pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testModificationStatementWithAttributesFromFunction() throws Throwable {
  String longFunc=createEchoFunction("bigint");
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'foo', 0) USING TIMESTAMP %s",functionCall(longFunc,"9999")),longFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'foo', 0) USING TTL %s",functionCall(iFunc,"8888")),iFunc);
  assertFunctions(cql("INSERT INTO %s (key, i_cc, t_cc, i_val) VALUES (0, 0, 'foo', 0) USING TIMESTAMP %s AND TTL %s",functionCall(longFunc,"9999"),functionCall(iFunc,"8888")),longFunc,iFunc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFPureScriptTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptUTCollections() throws Throwable {
  String type=createType("CREATE TYPE %s (txt text, i int)");
  createTable(String.format("CREATE TABLE %%s " + "(key int primary key, lst list<frozen<%s>>, st set<frozen<%s>>, mp map<int, frozen<%s>>)",type,type,type));
  String fName=createFunction(KEYSPACE,"list<frozen<" + type + ">>","CREATE FUNCTION %s( lst list<frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE javascript\n"+ "AS $$"+ "        lst.get(1).getString(\"txt\");$$;");
  createFunctionOverload(fName,"set<frozen<" + type + ">>","CREATE FUNCTION %s( st set<frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE javascript\n"+ "AS $$"+ "        st.iterator().next().getString(\"txt\");$$;");
  createFunctionOverload(fName,"map<int, frozen<" + type + ">>","CREATE FUNCTION %s( mp map<int, frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE javascript\n"+ "AS $$"+ "        mp.get(java.lang.Integer.valueOf(3)).getString(\"txt\");$$;");
  execute("INSERT INTO %s (key, lst, st, mp) values (1, " + "[ {txt: 'one', i:1}, {txt: 'three', i:1}, {txt: 'one', i:1} ] , " + "{ {txt: 'one', i:1}, {txt: 'three', i:3}, {txt: 'two', i:2} }, "+ "{ 1: {txt: 'one', i:1}, 2: {txt: 'one', i:3}, 3: {txt: 'two', i:2} })");
  assertRows(execute("SELECT " + fName + "(lst) FROM %s WHERE key = 1"),row("three"));
  assertRows(execute("SELECT " + fName + "(st) FROM %s WHERE key = 1"),row("one"));
  assertRows(execute("SELECT " + fName + "(mp) FROM %s WHERE key = 1"),row("two"));
  String cqlSelect="SELECT " + fName + "(lst), "+ fName+ "(st), "+ fName+ "(mp) FROM %s WHERE key = 1";
  assertRows(execute(cqlSelect),row("three","one","two"));
  for (  int version : PROTOCOL_VERSIONS)   assertRowsNet(version,executeNet(version,cqlSelect),row("three","one","two"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptThrow() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript\n"+ "AS 'throw \"fool\";';");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  assertInvalidThrowMessage("fool",FunctionExecutionException.class,"SELECT key, val, " + fName + "(val) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptTupleType() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, tup frozen<tuple<double, text, int, boolean>>)");
  String fName=createFunction(KEYSPACE_PER_TEST,"tuple<double, text, int, boolean>","CREATE FUNCTION %s( tup tuple<double, text, int, boolean> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS tuple<double, text, int, boolean> "+ "LANGUAGE javascript\n"+ "AS $$tup;$$;");
  Object t=tuple(1d,"foo",2,true);
  execute("INSERT INTO %s (key, tup) VALUES (1, ?)",t);
  assertRows(execute("SELECT tup FROM %s WHERE key = 1"),row(t));
  assertRows(execute("SELECT " + fName + "(tup) FROM %s WHERE key = 1"),row(t));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScriptParamReturnTypes() throws Throwable {
  UUID ruuid=UUID.randomUUID();
  UUID tuuid=UUIDGen.getTimeUUID();
  createTable("CREATE TABLE %s (key int primary key, " + "tival tinyint, sival smallint, ival int, lval bigint, fval float, dval double, vval varint, ddval decimal, " + "timval time, dtval date, tsval timestamp, uval uuid, tuval timeuuid)");
  execute("INSERT INTO %s (key, tival, sival, ival, lval, fval, dval, vval, ddval, timval, dtval, tsval, uval, tuval) VALUES " + "(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",1,(byte)1,(short)1,1,1L,1f,1d,BigInteger.valueOf(1L),BigDecimal.valueOf(1d),1L,Integer.MAX_VALUE,new Date(1),ruuid,tuuid);
  Object[][] variations={new Object[]{"tinyint","tival",(byte)1,(byte)2},new Object[]{"smallint","sival",(short)1,(short)2},new Object[]{"int","ival",1,2},new Object[]{"bigint","lval",1L,2L},new Object[]{"float","fval",1f,2f},new Object[]{"double","dval",1d,2d},new Object[]{"varint","vval",BigInteger.valueOf(1L),BigInteger.valueOf(2L)},new Object[]{"decimal","ddval",BigDecimal.valueOf(1d),BigDecimal.valueOf(2d)},new Object[]{"time","timval",1L,2L}};
  for (  Object[] variation : variations) {
    Object type=variation[0];
    Object col=variation[1];
    Object expected1=variation[2];
    Object expected2=variation[3];
    String fName=createFunction(KEYSPACE,type.toString(),"CREATE OR REPLACE FUNCTION %s(val " + type + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ ' '+ "LANGUAGE javascript "+ "AS 'val+1;';");
    assertRows(execute("SELECT key, " + col + ", "+ fName+ '('+ col+ ") FROM %s"),row(1,expected1,expected2));
  }
  variations=new Object[][]{new Object[]{"timestamp","tsval",new Date(1),new Date(1)},new Object[]{"uuid","uval",ruuid,ruuid},new Object[]{"timeuuid","tuval",tuuid,tuuid},new Object[]{"date","dtval",Integer.MAX_VALUE,Integer.MAX_VALUE}};
  for (  Object[] variation : variations) {
    Object type=variation[0];
    Object col=variation[1];
    Object expected1=variation[2];
    Object expected2=variation[3];
    String fName=createFunction(KEYSPACE,type.toString(),"CREATE OR REPLACE FUNCTION %s(val " + type + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ ' '+ "LANGUAGE javascript "+ "AS 'val;';");
    assertRows(execute("SELECT key, " + col + ", "+ fName+ '('+ col+ ") FROM %s"),row(1,expected1,expected2));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptBadReturnType() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript\n"+ "AS '\"string\";';");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  assertInvalidMessage("Invalid value for CQL type double","SELECT key, val, " + fName + "(val) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScriptReturnTypeCasting() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  Object[][] variations={new Object[]{"true","boolean",true},new Object[]{"false","boolean",false},new Object[]{"100","tinyint",(byte)100},new Object[]{"100.","tinyint",(byte)100},new Object[]{"100","smallint",(short)100},new Object[]{"100.","smallint",(short)100},new Object[]{"100","int",100},new Object[]{"100.","int",100},new Object[]{"100","double",100d},new Object[]{"100.","double",100d},new Object[]{"100","bigint",100L},new Object[]{"100.","bigint",100L},new Object[]{"100","varint",BigInteger.valueOf(100L)},new Object[]{"100.","varint",BigInteger.valueOf(100L)},new Object[]{"parseInt(\"100\");","decimal",BigDecimal.valueOf(100d)},new Object[]{"100.","decimal",BigDecimal.valueOf(100d)}};
  for (  Object[] variation : variations) {
    Object functionBody=variation[0];
    Object returnType=variation[1];
    Object expectedResult=variation[2];
    String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS " + returnType + ' '+ "LANGUAGE javascript "+ "AS '"+ functionBody+ ";';");
    assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,expectedResult));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptDisabled() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  DatabaseDescriptor.enableScriptedUserDefinedFunctions(false);
  try {
    assertInvalid("double","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".assertNotEnabled(val double) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE javascript\n"+ "AS 'Math.sin(val);';");
  }
  finally {
    DatabaseDescriptor.enableScriptedUserDefinedFunctions(true);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptFunction() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String functionBody='\n' + "  Math.sin(val);\n";
  String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript\n"+ "AS '" + functionBody + "';");
  FunctionName fNameName=parseFunctionName(fName);
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",fNameName.keyspace,fNameName.name),row("javascript",functionBody));
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,Math.sin(1d)),row(2,2d,Math.sin(2d)),row(3,3d,Math.sin(3d)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptSimpleCollections() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, lst list<double>, st set<text>, mp map<int, boolean>)");
  String fName1=createFunction(KEYSPACE_PER_TEST,"list<double>","CREATE FUNCTION %s( lst list<double> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS list<double> "+ "LANGUAGE javascript\n"+ "AS 'lst;';");
  String fName2=createFunction(KEYSPACE_PER_TEST,"set<text>","CREATE FUNCTION %s( st set<text> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS set<text> "+ "LANGUAGE javascript\n"+ "AS 'st;';");
  String fName3=createFunction(KEYSPACE_PER_TEST,"map<int, boolean>","CREATE FUNCTION %s( mp map<int, boolean> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS map<int, boolean> "+ "LANGUAGE javascript\n"+ "AS 'mp;';");
  List<Double> list=Arrays.asList(1d,2d,3d);
  Set<String> set=new TreeSet<>(Arrays.asList("one","three","two"));
  Map<Integer,Boolean> map=new TreeMap<>();
  map.put(1,true);
  map.put(2,false);
  map.put(3,true);
  execute("INSERT INTO %s (key, lst, st, mp) VALUES (1, ?, ?, ?)",list,set,map);
  assertRows(execute("SELECT lst, st, mp FROM %s WHERE key = 1"),row(list,set,map));
  assertRows(execute("SELECT " + fName1 + "(lst), "+ fName2+ "(st), "+ fName3+ "(mp) FROM %s WHERE key = 1"),row(list,set,map));
  for (  int version : PROTOCOL_VERSIONS)   assertRowsNet(version,executeNet(version,"SELECT " + fName1 + "(lst), "+ fName2+ "(st), "+ fName3+ "(mp) FROM %s WHERE key = 1"),row(list,set,map));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFPureScriptTupleCollectionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptTupleTypeCollection() throws Throwable {
  String tupleTypeDef="tuple<double, list<double>, set<text>, map<int, boolean>>";
  createTable("CREATE TABLE %s (key int primary key, tup frozen<" + tupleTypeDef + ">)");
  String fTup1=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS tuple<double, list<double>, set<text>, map<int, boolean>> "+ "LANGUAGE javascript\n"+ "AS $$"+ "       tup;$$;");
  String fTup2=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE javascript\n"+ "AS $$"+ "       tup.getDouble(0);$$;");
  String fTup3=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS list<double> "+ "LANGUAGE javascript\n"+ "AS $$"+ "       tup.getList(1, java.lang.Double.class);$$;");
  String fTup4=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS set<text> "+ "LANGUAGE javascript\n"+ "AS $$"+ "       tup.getSet(2, java.lang.String.class);$$;");
  String fTup5=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS map<int, boolean> "+ "LANGUAGE javascript\n"+ "AS $$"+ "       tup.getMap(3, java.lang.Integer.class, java.lang.Boolean.class);$$;");
  List<Double> list=Arrays.asList(1d,2d,3d);
  Set<String> set=new TreeSet<>(Arrays.asList("one","three","two"));
  Map<Integer,Boolean> map=new TreeMap<>();
  map.put(1,true);
  map.put(2,false);
  map.put(3,true);
  Object t=tuple(1d,list,set,map);
  execute("INSERT INTO %s (key, tup) VALUES (1, ?)",t);
  assertRows(execute("SELECT " + fTup1 + "(tup) FROM %s WHERE key = 1"),row(t));
  assertRows(execute("SELECT " + fTup2 + "(tup) FROM %s WHERE key = 1"),row(1d));
  assertRows(execute("SELECT " + fTup3 + "(tup) FROM %s WHERE key = 1"),row(list));
  assertRows(execute("SELECT " + fTup4 + "(tup) FROM %s WHERE key = 1"),row(set));
  assertRows(execute("SELECT " + fTup5 + "(tup) FROM %s WHERE key = 1"),row(map));
  TupleType tType=tupleTypeOf(Server.VERSION_3,DataType.cdouble(),DataType.list(DataType.cdouble()),DataType.set(DataType.text()),DataType.map(DataType.cint(),DataType.cboolean()));
  TupleValue tup=tType.newValue(1d,list,set,map);
  for (  int version : PROTOCOL_VERSIONS) {
    assertRowsNet(version,executeNet(version,"SELECT " + fTup1 + "(tup) FROM %s WHERE key = 1"),row(tup));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup2 + "(tup) FROM %s WHERE key = 1"),row(1d));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup3 + "(tup) FROM %s WHERE key = 1"),row(list));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup4 + "(tup) FROM %s WHERE key = 1"),row(set));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup5 + "(tup) FROM %s WHERE key = 1"),row(map));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenListType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<list<int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,list());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,list(1,2,3));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,list(4,5,6));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,list(7,8,9));
  assertInvalidMessage("The function arguments should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".withFrozenArg(values frozen<list<int>>) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values) {sum += value;} return sum;';");
  assertInvalidMessage("The function return type should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenReturnType(values list<int>) "+ "CALLED ON NULL INPUT "+ "RETURNS frozen<list<int>> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String functionName=createFunction(KEYSPACE,"list<int>","CREATE FUNCTION %s (values list<int>) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values) {sum += ((Integer) value);} return sum;';");
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 0"),row(0,0));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 1"),row(1,6));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 2"),row(2,15));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 3"),row(3,24));
  functionName=createFunction(KEYSPACE,"list<int>","CREATE FUNCTION %s (values list<int>) " + "CALLED ON NULL INPUT " + "RETURNS list<int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  assertRows(execute("SELECT a FROM %s WHERE b = " + functionName + "(?)",set(1,2,3)),row(1));
  assertInvalidMessage("The function arguments should not be frozen","DROP FUNCTION " + functionName + "(frozen<list<int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBrokenFunction() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'throw new RuntimeException();';");
  KeyspaceMetadata ksm=Schema.instance.getKSMetaData(KEYSPACE_PER_TEST);
  UDFunction f=(UDFunction)ksm.functions.get(parseFunctionName(fName)).iterator().next();
  UDFunction broken=UDFunction.createBrokenFunction(f.name(),f.argNames(),f.argTypes(),f.returnType(),true,"java",f.body(),new InvalidRequestException("foo bar is broken"));
  Schema.instance.setKeyspaceMetadata(ksm.withSwapped(ksm.functions.without(f.name(),f.argTypes()).with(broken)));
  assertInvalidThrowMessage("foo bar is broken",InvalidRequestException.class,"SELECT key, " + fName + "(dval) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaKeyspaceFunction() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String functionBody='\n' + "  // parameter val is of type java.lang.Double\n" + "  /* return type is of type java.lang.Double */\n"+ "  if (val == null) {\n"+ "    return null;\n"+ "  }\n"+ "  return Math.sin( val );\n";
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS '" + functionBody + "';");
  FunctionName fNameName=parseFunctionName(fName);
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",fNameName.keyspace,fNameName.name),row("java",functionBody));
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,Math.sin(1d)),row(2,2d,Math.sin(2d)),row(3,3d,Math.sin(3d)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSimpleCollections() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, lst list<double>, st set<text>, mp map<int, boolean>)");
  String fList=createFunction(KEYSPACE_PER_TEST,"list<double>","CREATE FUNCTION %s( lst list<double> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS list<double> "+ "LANGUAGE java\n"+ "AS $$return lst;$$;");
  String fSet=createFunction(KEYSPACE_PER_TEST,"set<text>","CREATE FUNCTION %s( st set<text> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS set<text> "+ "LANGUAGE java\n"+ "AS $$return st;$$;");
  String fMap=createFunction(KEYSPACE_PER_TEST,"map<int, boolean>","CREATE FUNCTION %s( mp map<int, boolean> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS map<int, boolean> "+ "LANGUAGE java\n"+ "AS $$return mp;$$;");
  List<Double> list=Arrays.asList(1d,2d,3d);
  Set<String> set=new TreeSet<>(Arrays.asList("one","three","two"));
  Map<Integer,Boolean> map=new TreeMap<>();
  map.put(1,true);
  map.put(2,false);
  map.put(3,true);
  execute("INSERT INTO %s (key, lst, st, mp) VALUES (1, ?, ?, ?)",list,set,map);
  assertRows(execute("SELECT " + fList + "(lst), "+ fSet+ "(st), "+ fMap+ "(mp) FROM %s WHERE key = 1"),row(list,set,map));
  for (  int version : PROTOCOL_VERSIONS)   assertRowsNet(version,executeNet(version,"SELECT " + fList + "(lst), "+ fSet+ "(st), "+ fMap+ "(mp) FROM %s WHERE key = 1"),row(list,set,map));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionAfterOnDropKeyspace() throws Throwable {
  dropPerTestKeyspace();
  assertInvalidMessage("Keyspace " + KEYSPACE_PER_TEST + " doesn't exist","CREATE OR REPLACE FUNCTION " + KEYSPACE_PER_TEST + ".jnft(val double) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropFunctionDropsPreparedStatementsWithDelayedValues() throws Throwable {
  checkDelayedValuesCorrectlyIdentifyFunctionsInUse(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaFunctionInvalidReturn() throws Throwable {
  assertInvalidMessage("system keyspace is not user-modifiable","CREATE OR REPLACE FUNCTION jfir(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'return 1L;';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaTupleTypeCollection() throws Throwable {
  String tupleTypeDef="tuple<double, list<double>, set<text>, map<int, boolean>>";
  createTable("CREATE TABLE %s (key int primary key, tup frozen<" + tupleTypeDef + ">)");
  String fTup0=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS "+ tupleTypeDef+ ' '+ "LANGUAGE java\n"+ "AS $$return "+ "       tup;$$;");
  String fTup1=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java\n"+ "AS $$return "+ "       Double.valueOf(tup.getDouble(0));$$;");
  String fTup2=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS list<double> "+ "LANGUAGE java\n"+ "AS $$return "+ "       tup.getList(1, Double.class);$$;");
  String fTup3=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS set<text> "+ "LANGUAGE java\n"+ "AS $$return "+ "       tup.getSet(2, String.class);$$;");
  String fTup4=createFunction(KEYSPACE_PER_TEST,tupleTypeDef,"CREATE FUNCTION %s( tup " + tupleTypeDef + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS map<int, boolean> "+ "LANGUAGE java\n"+ "AS $$return "+ "       tup.getMap(3, Integer.class, Boolean.class);$$;");
  List<Double> list=Arrays.asList(1d,2d,3d);
  Set<String> set=new TreeSet<>(Arrays.asList("one","three","two"));
  Map<Integer,Boolean> map=new TreeMap<>();
  map.put(1,true);
  map.put(2,false);
  map.put(3,true);
  Object t=tuple(1d,list,set,map);
  execute("INSERT INTO %s (key, tup) VALUES (1, ?)",t);
  assertRows(execute("SELECT " + fTup0 + "(tup) FROM %s WHERE key = 1"),row(t));
  assertRows(execute("SELECT " + fTup1 + "(tup) FROM %s WHERE key = 1"),row(1d));
  assertRows(execute("SELECT " + fTup2 + "(tup) FROM %s WHERE key = 1"),row(list));
  assertRows(execute("SELECT " + fTup3 + "(tup) FROM %s WHERE key = 1"),row(set));
  assertRows(execute("SELECT " + fTup4 + "(tup) FROM %s WHERE key = 1"),row(map));
  TupleType tType=tupleTypeOf(Server.VERSION_3,DataType.cdouble(),DataType.list(DataType.cdouble()),DataType.set(DataType.text()),DataType.map(DataType.cint(),DataType.cboolean()));
  TupleValue tup=tType.newValue(1d,list,set,map);
  for (  int version : PROTOCOL_VERSIONS) {
    assertRowsNet(version,executeNet(version,"SELECT " + fTup0 + "(tup) FROM %s WHERE key = 1"),row(tup));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup1 + "(tup) FROM %s WHERE key = 1"),row(1d));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup2 + "(tup) FROM %s WHERE key = 1"),row(list));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup3 + "(tup) FROM %s WHERE key = 1"),row(set));
    assertRowsNet(version,executeNet(version,"SELECT " + fTup4 + "(tup) FROM %s WHERE key = 1"),row(map));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenUDType() throws Throwable {
  String myType=createType("CREATE TYPE %s (f int)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<" + myType + ">)");
  createIndex("CREATE INDEX ON %s (b)");
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",0,0);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",1,1);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",2,4);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",3,7);
  assertInvalidMessage("The function arguments should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".withFrozenArg(values frozen<"+ myType+ ">) "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return values.toString();';");
  assertInvalidMessage("The function return type should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenReturnType(values "+ myType+ ") "+ "CALLED ON NULL INPUT "+ "RETURNS frozen<"+ myType+ "> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String functionName=createFunction(KEYSPACE,myType,"CREATE FUNCTION %s (values " + myType + ") "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return values.toString();';");
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 0"),row(0,"{f:0}"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 1"),row(1,"{f:1}"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 2"),row(2,"{f:4}"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 3"),row(3,"{f:7}"));
  functionName=createFunction(KEYSPACE,myType,"CREATE FUNCTION %s (values " + myType + ") "+ "CALLED ON NULL INPUT "+ "RETURNS "+ myType+ " "+ "LANGUAGE java\n"+ "AS 'return values;';");
  assertRows(execute("SELECT a FROM %s WHERE b = " + functionName + "({f: ?})",1),row(1));
  assertInvalidMessage("The function arguments should not be frozen","DROP FUNCTION " + functionName + "(frozen<"+ myType+ ">);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropKeyspaceContainingFunctionDropsPreparedStatementsWithDelayedValues() throws Throwable {
  checkDelayedValuesCorrectlyIdentifyFunctionsInUse(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateOrReplaceJavaFunction() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s( input double ) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS '\n"+ "  // parameter val is of type java.lang.Double\n"+ "  /* return type is of type java.lang.Double */\n"+ "  if (input == null) {\n"+ "    return null;\n"+ "  }\n"+ "  return Math.sin( input );\n"+ "';");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,Math.sin(1d)),row(2,2d,Math.sin(2d)),row(3,3d,Math.sin(3d)));
  execute("CREATE OR REPLACE FUNCTION " + fName + "( input double ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java\n"+ "AS '\n"+ "  return input;\n"+ "';");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,1d),row(2,2d,2d),row(3,3d,3d));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyString() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, sval text, aval ascii, bval blob, empty_int int)");
  execute("INSERT INTO %s (key, sval, aval, bval, empty_int) VALUES (?, ?, ?, ?, blobAsInt(0x))",1,"","",ByteBuffer.allocate(0));
  String fNameSRC=createFunction(KEYSPACE_PER_TEST,"text","CREATE OR REPLACE FUNCTION %s(val text) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameSCC=createFunction(KEYSPACE_PER_TEST,"text","CREATE OR REPLACE FUNCTION %s(val text) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE JAVA\n"+ "AS 'return \"\";'");
  String fNameSRN=createFunction(KEYSPACE_PER_TEST,"text","CREATE OR REPLACE FUNCTION %s(val text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameSCN=createFunction(KEYSPACE_PER_TEST,"text","CREATE OR REPLACE FUNCTION %s(val text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE JAVA\n"+ "AS 'return \"\";'");
  String fNameBRC=createFunction(KEYSPACE_PER_TEST,"blob","CREATE OR REPLACE FUNCTION %s(val blob) " + "CALLED ON NULL INPUT " + "RETURNS blob "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameBCC=createFunction(KEYSPACE_PER_TEST,"blob","CREATE OR REPLACE FUNCTION %s(val blob) " + "CALLED ON NULL INPUT " + "RETURNS blob "+ "LANGUAGE JAVA\n"+ "AS 'return ByteBuffer.allocate(0);'");
  String fNameBRN=createFunction(KEYSPACE_PER_TEST,"blob","CREATE OR REPLACE FUNCTION %s(val blob) " + "RETURNS NULL ON NULL INPUT " + "RETURNS blob "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameBCN=createFunction(KEYSPACE_PER_TEST,"blob","CREATE OR REPLACE FUNCTION %s(val blob) " + "RETURNS NULL ON NULL INPUT " + "RETURNS blob "+ "LANGUAGE JAVA\n"+ "AS 'return ByteBuffer.allocate(0);'");
  String fNameIRC=createFunction(KEYSPACE_PER_TEST,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameICC=createFunction(KEYSPACE_PER_TEST,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return 0;'");
  String fNameIRN=createFunction(KEYSPACE_PER_TEST,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return val;'");
  String fNameICN=createFunction(KEYSPACE_PER_TEST,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return 0;'");
  assertRows(execute("SELECT " + fNameSRC + "(sval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSRN + "(sval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSCC + "(sval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSCN + "(sval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSRC + "(aval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSRN + "(aval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSCC + "(aval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameSCN + "(aval) FROM %s"),row(""));
  assertRows(execute("SELECT " + fNameBRC + "(bval) FROM %s"),row(ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertRows(execute("SELECT " + fNameBRN + "(bval) FROM %s"),row(ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertRows(execute("SELECT " + fNameBCC + "(bval) FROM %s"),row(ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertRows(execute("SELECT " + fNameBCN + "(bval) FROM %s"),row(ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertRows(execute("SELECT " + fNameIRC + "(empty_int) FROM %s"),row(new Object[]{null}));
  assertRows(execute("SELECT " + fNameIRN + "(empty_int) FROM %s"),row(new Object[]{null}));
  assertRows(execute("SELECT " + fNameICC + "(empty_int) FROM %s"),row(0));
  assertRows(execute("SELECT " + fNameICN + "(empty_int) FROM %s"),row(new Object[]{null}));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSchemaChange() throws Throwable {
  String f=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(state double, val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  assertLastSchemaChange(Event.SchemaChange.Change.CREATED,Event.SchemaChange.Target.FUNCTION,KEYSPACE,parseFunctionName(f).name,"double","double");
  createFunctionOverload(f,"double, double","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  assertLastSchemaChange(Event.SchemaChange.Change.CREATED,Event.SchemaChange.Target.FUNCTION,KEYSPACE,parseFunctionName(f).name,"int","int");
  schemaChange("CREATE OR REPLACE FUNCTION " + f + "(state int, val int) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  assertLastSchemaChange(Event.SchemaChange.Change.UPDATED,Event.SchemaChange.Target.FUNCTION,KEYSPACE,parseFunctionName(f).name,"int","int");
  schemaChange("DROP FUNCTION " + f + "(double, double)");
  assertLastSchemaChange(Event.SchemaChange.Change.DROPPED,Event.SchemaChange.Target.FUNCTION,KEYSPACE,parseFunctionName(f).name,"double","double");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrongKeyspace() throws Throwable {
  String typeName=createType("CREATE TYPE %s (txt text, i int)");
  String type=KEYSPACE + '.' + typeName;
  assertInvalidMessage(String.format("Statement on keyspace %s cannot refer to a user type in keyspace %s; user types can only be used in the keyspace they are defined in",KEYSPACE_PER_TEST,KEYSPACE),"CREATE FUNCTION " + KEYSPACE_PER_TEST + ".test_wrong_ks( val int ) "+ "CALLED ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
  assertInvalidMessage(String.format("Statement on keyspace %s cannot refer to a user type in keyspace %s; user types can only be used in the keyspace they are defined in",KEYSPACE_PER_TEST,KEYSPACE),"CREATE FUNCTION " + KEYSPACE_PER_TEST + ".test_wrong_ks( val "+ type+ " ) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenMapType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<map<int, int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,map());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,map(1,1,2,2,3,3));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,map(4,4,5,5,6,6));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,map(7,7,8,8,9,9));
  assertInvalidMessage("The function arguments should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".withFrozenArg(values frozen<map<int, int>>) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values.values()) {sum += value;} return sum;';");
  assertInvalidMessage("The function return type should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenReturnType(values map<int, int>) "+ "CALLED ON NULL INPUT "+ "RETURNS frozen<map<int, int>> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String functionName=createFunction(KEYSPACE,"map<int, int>","CREATE FUNCTION %s (values map<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values.values()) {sum += ((Integer) value);} return sum;';");
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 0"),row(0,0));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 1"),row(1,6));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 2"),row(2,15));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 3"),row(3,24));
  functionName=createFunction(KEYSPACE,"map<int, int>","CREATE FUNCTION %s (values map<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS map<int, int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  assertRows(execute("SELECT a FROM %s WHERE b = " + functionName + "(?)",map(1,1,2,2,3,3)),row(1));
  assertInvalidMessage("The function arguments should not be frozen","DROP FUNCTION " + functionName + "(frozen<map<int, int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllNativeTypes() throws Throwable {
  StringBuilder sig=new StringBuilder();
  StringBuilder args=new StringBuilder();
  for (  CQL3Type.Native type : CQL3Type.Native.values()) {
    if (type == CQL3Type.Native.EMPTY)     continue;
    if (sig.length() > 0)     sig.append(',');
    sig.append(type.toString());
    if (args.length() > 0)     args.append(',');
    args.append("arg").append(type.toString()).append(' ').append(type.toString());
  }
  createFunction(KEYSPACE,sig.toString(),"CREATE OR REPLACE FUNCTION %s(" + args + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return 0;'");
  for (  CQL3Type.Native type : CQL3Type.Native.values()) {
    if (type == CQL3Type.Native.EMPTY)     continue;
    createFunction(KEYSPACE_PER_TEST,type.toString(),"CREATE OR REPLACE FUNCTION %s(val " + type.toString() + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE JAVA\n"+ "AS 'return 0;'");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaUserTypeRenameField() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + type + ">)");
  String fName=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$return udt.getString(\"txt\");$$;");
  execute("INSERT INTO %s (key, udt) VALUES (1, {txt: 'one', i:1})");
  assertRows(execute("SELECT " + fName + "(udt) FROM %s WHERE key = 1"),row("one"));
  execute("ALTER TYPE " + type + " RENAME txt TO str");
  assertInvalidMessage("txt is not a field defined in this UDT","SELECT " + fName + "(udt) FROM %s WHERE key = 1");
  execute("ALTER TYPE " + type + " RENAME str TO txt");
  assertRows(execute("SELECT " + fName + "(udt) FROM %s WHERE key = 1"),row("one"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionInTargetKeyspace() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  execute("CREATE TABLE " + KEYSPACE_PER_TEST + ".second_tab (key int primary key, val double)");
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS 'return Double.valueOf(val);';");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertInvalidMessage("Unknown function","SELECT key, val, " + parseFunctionName(fName).name + "(val) FROM %s");
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM "+ KEYSPACE_PER_TEST+ ".second_tab"),row(1,1d,1d),row(2,2d,2d),row(3,3d,3d));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionNonExistingKeyspace() throws Throwable {
  assertInvalidMessage("Keyspace this_ks_does_not_exist doesn't exist","CREATE OR REPLACE FUNCTION this_ks_does_not_exist.jnft(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplaceAllowNulls() throws Throwable {
  String fNulls=createFunction(KEYSPACE,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
  String fNoNulls=createFunction(KEYSPACE,"int","CREATE OR REPLACE FUNCTION %s(val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
  assertInvalid("CREATE OR REPLACE FUNCTION " + fNulls + "(val int) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
  assertInvalid("CREATE OR REPLACE FUNCTION " + fNoNulls + "(val int) "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
  execute("CREATE OR REPLACE FUNCTION " + fNulls + "(val int) "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
  execute("CREATE OR REPLACE FUNCTION " + fNoNulls + "(val int) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"foo bar\";';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScriptInvalidLanguage() throws Throwable {
  assertInvalidMessage("Invalid language 'artificial_intelligence' for function 'cql_test_keyspace.scrinv'","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".scrinv(val double) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE artificial_intelligence\n"+ "AS 'question for 42?';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonExistingOnes() throws Throwable {
  assertInvalidThrowMessage("Cannot drop non existing function",InvalidRequestException.class,"DROP FUNCTION " + KEYSPACE + ".func_does_not_exist");
  assertInvalidThrowMessage("Cannot drop non existing function",InvalidRequestException.class,"DROP FUNCTION " + KEYSPACE + ".func_does_not_exist(int,text)");
  assertInvalidThrowMessage("Cannot drop non existing function",InvalidRequestException.class,"DROP FUNCTION keyspace_does_not_exist.func_does_not_exist");
  assertInvalidThrowMessage("Cannot drop non existing function",InvalidRequestException.class,"DROP FUNCTION keyspace_does_not_exist.func_does_not_exist(int,text)");
  execute("DROP FUNCTION IF EXISTS " + KEYSPACE + ".func_does_not_exist");
  execute("DROP FUNCTION IF EXISTS " + KEYSPACE + ".func_does_not_exist(int,text)");
  execute("DROP FUNCTION IF EXISTS keyspace_does_not_exist.func_does_not_exist");
  execute("DROP FUNCTION IF EXISTS keyspace_does_not_exist.func_does_not_exist(int,text)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionInSystemKS() throws Throwable {
  execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".totimestamp(val timeuuid) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS timestamp "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
  assertInvalidMessage("system keyspace is not user-modifiable","CREATE OR REPLACE FUNCTION system.jnft(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
  assertInvalidMessage("system keyspace is not user-modifiable","CREATE OR REPLACE FUNCTION system.totimestamp(val timeuuid) " + "RETURNS NULL ON NULL INPUT " + "RETURNS timestamp "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
  assertInvalidMessage("system keyspace is not user-modifiable","DROP FUNCTION system.now");
  assertInvalidMessage("system keyspace is not user-modifiable","CREATE OR REPLACE FUNCTION jnft(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
  assertInvalidMessage("system keyspace is not user-modifiable","CREATE OR REPLACE FUNCTION totimestamp(val timeuuid) " + "RETURNS NULL ON NULL INPUT " + "RETURNS timestamp "+ "LANGUAGE JAVA\n"+ "AS 'return null;';");
  assertInvalidMessage("system keyspace is not user-modifiable","DROP FUNCTION now");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaFunctionNoParameters() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String functionBody="\n  return 1L;\n";
  String fName=createFunction(KEYSPACE,"","CREATE OR REPLACE FUNCTION %s() " + "RETURNS NULL ON NULL INPUT " + "RETURNS bigint "+ "LANGUAGE JAVA\n"+ "AS '" + functionBody + "';");
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",KEYSPACE,parseFunctionName(fName).name),row("java",functionBody));
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, " + fName + "() FROM %s"),row(1,1d,1L),row(2,2d,1L),row(3,3d,1L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaDollarQuotedFunction() throws Throwable {
  String functionBody='\n' + "  // parameter val is of type java.lang.Double\n" + "  /* return type is of type java.lang.Double */\n"+ "  if (input == null) {\n"+ "    return null;\n"+ "  }\n"+ "  return \"'\"+Math.sin(input)+'\\\'';\n";
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s( input double ) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java\n"+ "AS $$" + functionBody + "$$;");
  FunctionName fNameName=parseFunctionName(fName);
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",fNameName.keyspace,fNameName.name),row("java",functionBody));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaFunction() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String functionBody='\n' + "  // parameter val is of type java.lang.Double\n" + "  /* return type is of type java.lang.Double */\n"+ "  if (val == null) {\n"+ "    return null;\n"+ "  }\n"+ "  return Math.sin(val);\n";
  String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS '" + functionBody + "';");
  FunctionName fNameName=parseFunctionName(fName);
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",fNameName.keyspace,fNameName.name),row("java",functionBody));
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1d,Math.sin(1d)),row(2,2d,Math.sin(2d)),row(3,3d,Math.sin(3d)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateArgNames() throws Throwable {
  assertInvalidMessage("duplicate argument names for given function","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".scrinv(val double, val text) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE javascript\n"+ "AS '\"foo bar\";';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionCreationAndDrop() throws Throwable {
  createTable("CREATE TABLE %s (key int PRIMARY KEY, d double)");
  execute("INSERT INTO %s(key, d) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s(key, d) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s(key, d) VALUES (?, ?)",3,3d);
  String fSin=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s ( input double ) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Math.sin(input);'");
  assertInvalidMessage("already exists","CREATE FUNCTION " + fSin + " ( input double ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  execute("CREATE FUNCTION IF NOT EXISTS " + fSin + " ( input double ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  assertRows(execute("SELECT key, " + fSin + "(d) FROM %s"),row(1,Math.sin(1d)),row(2,Math.sin(2d)),row(3,Math.sin(3d)));
  assertInvalidMessage("the new return type text is not compatible with the return type double of existing function","CREATE OR REPLACE FUNCTION " + fSin + " ( input double ) "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java AS 'return Double.valueOf(42d);'");
  execute("CREATE OR REPLACE FUNCTION " + fSin + " ( input double ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java AS 'return Double.valueOf(42d);'");
  assertRows(execute("SELECT key, " + fSin + "(d) FROM %s"),row(1,42.0),row(2,42.0),row(3,42.0));
  String fSin2=createFunction(KEYSPACE,"double","CREATE FUNCTION %s ( input double ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Math.sin(input);'");
  assertRows(execute("SELECT key, " + fSin2 + "(d) FROM %s"),row(1,Math.sin(1d)),row(2,Math.sin(2d)),row(3,Math.sin(3d)));
  execute("DROP FUNCTION " + fSin);
  execute("DROP FUNCTION " + fSin2);
  assertInvalidMessage("Cannot drop non existing function","DROP FUNCTION " + fSin);
  execute("DROP FUNCTION IF EXISTS " + fSin);
  assertInvalidMessage("system keyspace is not user-modifiable","DROP FUNCTION totimestamp");
  assertInvalidMessage("system keyspace is not user-modifiable","DROP FUNCTION uuid");
  assertInvalidMessage("Unknown function","SELECT key, sin(d) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionExecutionWithReversedTypeAsOutput() throws Throwable {
  createTable("CREATE TABLE %s (k int, v text, PRIMARY KEY(k, v)) WITH CLUSTERING ORDER BY (v DESC)");
  String fRepeat=createFunction(KEYSPACE_PER_TEST,"text","CREATE FUNCTION %s(v text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return v + v;'");
  execute("INSERT INTO %s(k, v) VALUES (?, " + fRepeat + "(?))",1,"a");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionOverloading() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, v int)");
  execute("INSERT INTO %s(k, v) VALUES (?, ?)","f2",1);
  String fOverload=createFunction(KEYSPACE_PER_TEST,"varchar","CREATE FUNCTION %s ( input varchar ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"f1\";'");
  createFunctionOverload(fOverload,"int","CREATE OR REPLACE FUNCTION %s(i int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"f2\";'");
  createFunctionOverload(fOverload,"text,text","CREATE OR REPLACE FUNCTION %s(v1 text, v2 text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"f3\";'");
  createFunctionOverload(fOverload,"ascii","CREATE OR REPLACE FUNCTION %s(v ascii) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"f1\";'");
  assertInvalidMessage("already exists","CREATE FUNCTION " + fOverload + "(v varchar) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java AS 'return \"f1\";'");
  assertRows(execute("SELECT " + fOverload + "(k), "+ fOverload+ "(v), "+ fOverload+ "(k, k) FROM %s"),row("f1","f2","f3"));
  forcePreparedValues();
  assertInvalidMessage("Ambiguous call to function","SELECT v FROM %s WHERE k = " + fOverload + "(?)","foo");
  stopForcingPreparedValues();
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + fOverload + "((text)?)","foo"));
  assertRows(execute("SELECT v FROM %s WHERE k = " + fOverload + "((int)?)",3),row(1));
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + fOverload + "((ascii)?)","foo"));
  assertEmpty(execute("SELECT v FROM %s WHERE k = " + fOverload + "((varchar)?)","foo"));
  assertInvalidMessage("non existing function","DROP FUNCTION " + fOverload + "(boolean)");
  assertInvalidMessage("non existing function","DROP FUNCTION " + fOverload + "(bigint)");
  assertInvalidMessage("matches multiple function definitions","DROP FUNCTION " + fOverload);
  execute("DROP FUNCTION " + fOverload + "(varchar)");
  assertInvalidMessage("none of its type signatures match","SELECT v FROM %s WHERE k = " + fOverload + "((text)?)","foo");
  execute("DROP FUNCTION " + fOverload + "(text, text)");
  assertInvalidMessage("none of its type signatures match","SELECT v FROM %s WHERE k = " + fOverload + "((text)?,(text)?)","foo","bar");
  execute("DROP FUNCTION " + fOverload + "(ascii)");
  assertInvalidMessage("cannot be passed as argument 0 of function","SELECT v FROM %s WHERE k = " + fOverload + "((ascii)?)","foo");
  assertRows(execute("SELECT v FROM %s WHERE k = " + fOverload + "((int)?)",3),row(1));
  execute("DROP FUNCTION " + fOverload);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaFunctionCounter() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val counter)");
  String fName=createFunction(KEYSPACE,"counter","CREATE OR REPLACE FUNCTION %s(val counter) " + "CALLED ON NULL INPUT " + "RETURNS bigint "+ "LANGUAGE JAVA "+ "AS 'return val + 1;';");
  execute("UPDATE %s SET val = val + 1 WHERE key = 1");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,1L,2L));
  execute("UPDATE %s SET val = val + 1 WHERE key = 1");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,2L,3L));
  execute("UPDATE %s SET val = val + 2 WHERE key = 1");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,4L,5L));
  execute("UPDATE %s SET val = val - 2 WHERE key = 1");
  assertRows(execute("SELECT key, val, " + fName + "(val) FROM %s"),row(1,2L,3L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaRuntimeException() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val double)");
  String functionBody='\n' + "  throw new RuntimeException(\"oh no!\");\n";
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS '" + functionBody + "';");
  FunctionName fNameName=parseFunctionName(fName);
  assertRows(execute("SELECT language, body FROM system_schema.functions WHERE keyspace_name=? AND function_name=?",fNameName.keyspace,fNameName.name),row("java",functionBody));
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3d);
  assertInvalidThrowMessage("java.lang.RuntimeException: oh no",FunctionExecutionException.class,"SELECT key, val, " + fName + "(val) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptCompileFailure() throws Throwable {
  assertInvalidMessage("Failed to compile function 'cql_test_keyspace.scrinv'","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".scrinv(val double) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE javascript\n"+ "AS 'foo bar';");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTypesWithAndWithoutNulls() throws Throwable {
  String type=createType("CREATE TYPE %s (txt text, i int)");
  TypesTestDef[] typeDefs={new TypesTestDef("timestamp","timestamp","ts",new Date()),new TypesTestDef("date","date","dt",12345),new TypesTestDef("time","time","tim",12345L),new TypesTestDef("uuid","uuid","uu",UUID.randomUUID()),new TypesTestDef("timeuuid","timeuuid","tu",UUIDGen.getTimeUUID()),new TypesTestDef("tinyint","tinyint","ti",(byte)42),new TypesTestDef("smallint","smallint","si",(short)43),new TypesTestDef("int","int","i",44),new TypesTestDef("bigint","bigint","b",45L),new TypesTestDef("float","float","f",46f),new TypesTestDef("double","double","d",47d),new TypesTestDef("boolean","boolean","x",true),new TypesTestDef("ascii","ascii","a","tqbfjutld"),new TypesTestDef("text","text","t","k\u00f6lsche jung"),new TypesTestDef("tuple<int, text>","frozen<tuple<int, text>>","tup",tuple(1,"foo"))};
  String createTableDDL="CREATE TABLE %s (key int PRIMARY KEY";
  String insertDML="INSERT INTO %s (key";
  List values=new ArrayList<>();
  for (  TypesTestDef typeDef : typeDefs) {
    createTableDDL+=", " + typeDef.columnName + ' '+ typeDef.tableType;
    insertDML+=", " + typeDef.columnName;
    String typeName=typeDef.udfType;
    typeDef.fCheckArgAndReturn=createFunction(KEYSPACE,typeName,"CREATE OR REPLACE FUNCTION %s(val " + typeName + ") "+ "CALLED ON NULL INPUT "+ "RETURNS "+ typeName+ ' '+ "LANGUAGE java\n"+ "AS 'return val;';");
    typeDef.fCalledOnNull=createFunction(KEYSPACE,typeName,"CREATE OR REPLACE FUNCTION %s(val " + typeName + ") "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"called\";';");
    typeDef.fReturnsNullOnNull=createFunction(KEYSPACE,typeName,"CREATE OR REPLACE FUNCTION %s(val " + typeName + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return \"called\";';");
    values.add(typeDef.referenceValue);
  }
  createTableDDL+=')';
  createTable(createTableDDL);
  insertDML+=") VALUES (1";
  for (  TypesTestDef ignored : typeDefs)   insertDML+=", ?";
  insertDML+=')';
  execute(insertDML,values.toArray());
  for (int i=0; i < values.size(); i++)   values.set(i,null);
  execute(insertDML.replace('1','2'),values.toArray());
  for (  TypesTestDef typeDef : typeDefs) {
    assertRows(execute("SELECT " + typeDef.fCheckArgAndReturn + '('+ typeDef.columnName+ ") FROM %s WHERE key = 1"),row(new Object[]{typeDef.referenceValue}));
  }
  for (  TypesTestDef typeDef : typeDefs) {
    assertRows(execute("SELECT " + typeDef.fCalledOnNull + '('+ typeDef.columnName+ ") FROM %s WHERE key = 1"),row(new Object[]{"called"}));
  }
  for (  TypesTestDef typeDef : typeDefs) {
    assertRows(execute("SELECT " + typeDef.fCalledOnNull + '('+ typeDef.columnName+ ") FROM %s WHERE key = 2"),row(new Object[]{"called"}));
  }
  for (  TypesTestDef typeDef : typeDefs) {
    assertRows(execute("SELECT " + typeDef.fReturnsNullOnNull + '('+ typeDef.columnName+ ") FROM %s WHERE key = 1"),row(new Object[]{"called"}));
  }
  for (  TypesTestDef typeDef : typeDefs) {
    assertRows(execute("SELECT " + typeDef.fReturnsNullOnNull + '('+ typeDef.columnName+ ") FROM %s WHERE key = 2"),row(new Object[]{null}));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaUTCollections() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable(String.format("CREATE TABLE %%s " + "(key int primary key, lst list<frozen<%s>>, st set<frozen<%s>>, mp map<int, frozen<%s>>)",type,type,type));
  String fName1=createFunction(KEYSPACE,"list<frozen<" + type + ">>","CREATE FUNCTION %s( lst list<frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$"+ "     com.datastax.driver.core.UDTValue udtVal = (com.datastax.driver.core.UDTValue)lst.get(1);"+ "     return udtVal.getString(\"txt\");$$;");
  String fName2=createFunction(KEYSPACE,"set<frozen<" + type + ">>","CREATE FUNCTION %s( st set<frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$"+ "     com.datastax.driver.core.UDTValue udtVal = (com.datastax.driver.core.UDTValue)st.iterator().next();"+ "     return udtVal.getString(\"txt\");$$;");
  String fName3=createFunction(KEYSPACE,"map<int, frozen<" + type + ">>","CREATE FUNCTION %s( mp map<int, frozen<" + type + ">> ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$"+ "     com.datastax.driver.core.UDTValue udtVal = (com.datastax.driver.core.UDTValue)mp.get(Integer.valueOf(3));"+ "     return udtVal.getString(\"txt\");$$;");
  execute("INSERT INTO %s (key, lst, st, mp) values (1, " + "[ {txt: 'one', i:1}, {txt: 'three', i:1}, {txt: 'one', i:1} ] , " + "{ {txt: 'one', i:1}, {txt: 'three', i:3}, {txt: 'two', i:2} }, "+ "{ 1: {txt: 'one', i:1}, 2: {txt: 'one', i:3}, 3: {txt: 'two', i:2} })");
  assertRows(execute("SELECT " + fName1 + "(lst), "+ fName2+ "(st), "+ fName3+ "(mp) FROM %s WHERE key = 1"),row("three","one","two"));
  for (  int version : PROTOCOL_VERSIONS)   assertRowsNet(version,executeNet(version,"SELECT " + fName1 + "(lst), "+ fName2+ "(st), "+ fName3+ "(mp) FROM %s WHERE key = 1"),row("three","one","two"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenTupleType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<tuple<int, int>>)");
  createIndex("CREATE INDEX ON %s (b)");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,tuple());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,tuple(1,2));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,tuple(4,5));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,tuple(7,8));
  assertInvalidMessage("The function arguments should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".withFrozenArg(values frozen<tuple<int, int>>) "+ "CALLED ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return values.toString();';");
  assertInvalidMessage("The function return type should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenReturnType(values tuple<int, int>) "+ "CALLED ON NULL INPUT "+ "RETURNS frozen<tuple<int, int>> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String functionName=createFunction(KEYSPACE,"tuple<int, int>","CREATE FUNCTION %s (values tuple<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java\n"+ "AS 'return values.toString();';");
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 0"),row(0,"(null, null)"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 1"),row(1,"(1, 2)"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 2"),row(2,"(4, 5)"));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 3"),row(3,"(7, 8)"));
  functionName=createFunction(KEYSPACE,"tuple<int, int>","CREATE FUNCTION %s (values tuple<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS tuple<int, int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  assertRows(execute("SELECT a FROM %s WHERE b = " + functionName + "(?)",tuple(1,2)),row(1));
  assertInvalidMessage("The function arguments should not be frozen","DROP FUNCTION " + functionName + "(frozen<tuple<int, int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaTupleType() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, tup frozen<tuple<double, text, int, boolean>>)");
  String fName=createFunction(KEYSPACE,"tuple<double, text, int, boolean>","CREATE FUNCTION %s( tup tuple<double, text, int, boolean> ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS tuple<double, text, int, boolean> "+ "LANGUAGE java\n"+ "AS $$return tup;$$;");
  Object t=tuple(1d,"foo",2,true);
  execute("INSERT INTO %s (key, tup) VALUES (1, ?)",t);
  assertRows(execute("SELECT tup FROM %s WHERE key = 1"),row(t));
  assertRows(execute("SELECT " + fName + "(tup) FROM %s WHERE key = 1"),row(t));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenSetType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<set<int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,set());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,set(1,2,3));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,set(4,5,6));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,set(7,8,9));
  assertInvalidMessage("The function arguments should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenSetArg(values frozen<set<int>>) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values) {sum += value;} return sum;';");
  assertInvalidMessage("The function return type should not be frozen","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".frozenReturnType(values set<int>) "+ "CALLED ON NULL INPUT "+ "RETURNS frozen<set<int>> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String functionName=createFunction(KEYSPACE,"set<int>","CREATE FUNCTION %s (values set<int>) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'int sum = 0; for (Object value : values) {sum += ((Integer) value);} return sum;';");
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 0"),row(0,0));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 1"),row(1,6));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 2"),row(2,15));
  assertRows(execute("SELECT a, " + functionName + "(b) FROM %s WHERE a = 3"),row(3,24));
  functionName=createFunction(KEYSPACE,"set<int>","CREATE FUNCTION %s (values set<int>) " + "CALLED ON NULL INPUT " + "RETURNS set<int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  assertRows(execute("SELECT a FROM %s WHERE b = " + functionName + "(?)",set(1,2,3)),row(1));
  assertInvalidMessage("The function arguments should not be frozen","DROP FUNCTION " + functionName + "(frozen<set<int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionExecution() throws Throwable {
  createTable("CREATE TABLE %s (v text PRIMARY KEY)");
  execute("INSERT INTO %s(v) VALUES (?)","aaa");
  String fRepeat=createFunction(KEYSPACE_PER_TEST,"text,int","CREATE FUNCTION %s(v text, n int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'StringBuilder sb = new StringBuilder();\n"+ "    for (int i = 0; i < n; i++)\n"+ "        sb.append(v);\n"+ "    return sb.toString();'");
  assertRows(execute("SELECT v FROM %s WHERE v=" + fRepeat + "(?, ?)","a",3),row("aaa"));
  assertEmpty(execute("SELECT v FROM %s WHERE v=" + fRepeat + "(?, ?)","a",2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaFunctionArgumentTypeMismatch() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val bigint)");
  String fName=createFunction(KEYSPACE,"double","CREATE OR REPLACE FUNCTION %s(val double)" + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS 'return Double.valueOf(val);';");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1L);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",2,2L);
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",3,3L);
  assertInvalidMessage("val cannot be passed as argument 0 of function","SELECT key, val, " + fName + "(val) FROM %s");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFVerifierTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testByteCodeVerifier(){
  new UDFByteCodeVerifier().verify(readClass(GoodClass.class));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidByteCodeUDFs() throws Throwable {
  assertInvalidByteCode("try\n" + "{\n" + "    clone();\n"+ "}\n"+ "catch (CloneNotSupportedException e)\n"+ "{\n"+ "    throw new RuntimeException(e);\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.clone()]");
  assertInvalidByteCode("try\n" + "{\n" + "    finalize();\n"+ "}\n"+ "catch (Throwable e)\n"+ "{\n"+ "    throw new RuntimeException(e);\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.finalize()]");
  assertInvalidByteCode('\n' + "return 0d;\n" + "    }\n"+ '\n'+ "    Object field;\n"+ '\n'+ "    {","Java UDF validation failed: [field declared: field]");
  assertInvalidByteCode('\n' + "return 0d;\n" + "    }\n"+ '\n'+ "    final Object field;\n"+ '\n'+ "    {\n"+ "field = new Object();","Java UDF validation failed: [field declared: field, initializer declared]");
  assertInvalidByteCode('\n' + "return 0d;\n" + "    }\n"+ '\n'+ "    Object field = new Object();\n"+ '\n'+ "    {\n"+ "Math.sin(1d);","Java UDF validation failed: [field declared: field, initializer declared]");
  assertInvalidByteCode('\n' + "return 0d;\n" + "    }\n"+ '\n'+ "    {\n"+ "Math.sin(1d);","Java UDF validation failed: [initializer declared]");
  assertInvalidByteCode('\n' + "return 0d;\n" + "    }\n"+ '\n'+ "    static\n"+ "    {\n"+ "Math.sin(1d);","Java UDF validation failed: [static initializer declared]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    Math.sin(1d);\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [use of synchronized]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    notify();\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.notify(), use of synchronized]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    notifyAll();\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.notifyAll(), use of synchronized]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    try\n"+ "    {\n"+ "        wait();\n"+ "    }\n"+ "    catch (InterruptedException e)\n"+ "    {\n"+ "        throw new RuntimeException(e);\n"+ "    }\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.wait(), use of synchronized]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    try\n"+ "    {\n"+ "        wait(1000L);\n"+ "    }\n"+ "    catch (InterruptedException e)\n"+ "    {\n"+ "        throw new RuntimeException(e);\n"+ "    }\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.wait(), use of synchronized]");
  assertInvalidByteCode("synchronized (this)\n" + "{\n" + "    try\n"+ "    {\n"+ "        wait(1000L, 100);\n"+ "    }\n"+ "    catch (InterruptedException e)\n"+ "    {\n"+ "        throw new RuntimeException(e);\n"+ "    }\n"+ "}\n"+ "return 0d;","Java UDF validation failed: [call to java.lang.Object.wait(), use of synchronized]");
  assertInvalidByteCode("try {" + "     java.nio.ByteBuffer.allocateDirect(123); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.nio.ByteBuffer.allocateDirect()]");
  assertInvalidByteCode("try {" + "     java.net.InetAddress.getLocalHost(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.net.InetAddress.getLocalHost()]");
  assertInvalidByteCode("try {" + "     java.net.InetAddress.getAllByName(\"localhost\"); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.net.InetAddress.getAllByName()]");
  assertInvalidByteCode("try {" + "     java.net.Inet4Address.getByName(\"127.0.0.1\"); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.net.Inet4Address.getByName()]");
  assertInvalidByteCode("try {" + "     java.net.Inet6Address.getByAddress(new byte[]{127,0,0,1}); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.net.Inet6Address.getByAddress()]");
  assertInvalidByteCode("try {" + "     java.net.NetworkInterface.getNetworkInterfaces(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}',"Java UDF validation failed: [call to java.net.NetworkInterface.getNetworkInterfaces()]");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UserTypesTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUDTWithUnsetValues() throws Throwable {
  String myType=createType("CREATE TYPE %s (x int, y int)");
  String myOtherType=createType("CREATE TYPE %s (a frozen<" + myType + ">)");
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v frozen<" + myType + ">, z frozen<"+ myOtherType+ ">)");
  assertInvalidMessage("Invalid unset value for field 'y' of user defined type " + myType,"INSERT INTO %s (k, v) VALUES (10, {x:?, y:?})",1,unset());
  assertInvalidMessage("Invalid unset value for field 'y' of user defined type " + myType,"INSERT INTO %s (k, v, z) VALUES (10, {x:?, y:?}, {a:{x: ?, y: ?}})",1,1,1,unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateInvalidTablesWithUDT() throws Throwable {
  String myType=createType("CREATE TYPE %s (f int)");
  assertInvalidMessage("Non-frozen User-Defined types are not supported, please use frozen<>","CREATE TABLE " + KEYSPACE + ".wrong (k int PRIMARY KEY, v "+ KEYSPACE+ '.'+ myType+ ")");
  assertInvalidMessage("Statement on keyspace " + KEYSPACE + " cannot refer to a user type in keyspace otherkeyspace;"+ " user types can only be used in the keyspace they are defined in","CREATE TABLE " + KEYSPACE + ".wrong (k int PRIMARY KEY, v frozen<otherKeyspace.myType>)");
  assertInvalidMessage("Unknown type " + KEYSPACE + ".unknowntype","CREATE TABLE " + KEYSPACE + ".wrong (k int PRIMARY KEY, v frozen<"+ KEYSPACE+ '.'+ "unknownType>)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterUDT() throws Throwable {
  String myType=KEYSPACE + '.' + createType("CREATE TYPE %s (a int)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<" + myType + ">)");
  execute("INSERT INTO %s (a, b) VALUES (1, {a: 1})");
  assertRows(execute("SELECT b.a FROM %s"),row(1));
  flush();
  execute("ALTER TYPE " + myType + " ADD b int");
  execute("INSERT INTO %s (a, b) VALUES (2, {a: 2, b :2})");
  assertRows(execute("SELECT b.a, b.b FROM %s"),row(1,null),row(2,2));
  flush();
  assertRows(execute("SELECT b.a, b.b FROM %s"),row(1,null),row(2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCassandra8105() throws Throwable {
  String ut1=createType("CREATE TYPE %s (a int, b int)");
  String ut2=createType("CREATE TYPE %s (j frozen<" + KEYSPACE + "."+ ut1+ ">, k int)");
  createTable("CREATE TABLE %s (x int PRIMARY KEY, y set<frozen<" + KEYSPACE + "."+ ut2+ ">>)");
  execute("INSERT INTO %s (x, y) VALUES (1, { { k: 1 } })");
  String ut3=createType("CREATE TYPE %s (a int, b int)");
  String ut4=createType("CREATE TYPE %s (j frozen<" + KEYSPACE + "."+ ut3+ ">, k int)");
  createTable("CREATE TABLE %s (x int PRIMARY KEY, y list<frozen<" + KEYSPACE + "."+ ut4+ ">>)");
  execute("INSERT INTO %s (x, y) VALUES (1, [ { k: 1 } ])");
  String ut5=createType("CREATE TYPE %s (a int, b int)");
  String ut6=createType("CREATE TYPE %s (i int, j frozen<" + KEYSPACE + "."+ ut5+ ">)");
  createTable("CREATE TABLE %s (x int PRIMARY KEY, y set<frozen<" + KEYSPACE + "."+ ut6+ ">>)");
  execute("INSERT INTO %s (x, y) VALUES (1, { { i: 1 } })");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinNestedTuple() throws Throwable {
  String type=createType("CREATE TYPE %s (a int, b int)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<tuple<int, tuple<int, " + KEYSPACE + "."+ type+ ">>>)");
  execute("INSERT INTO %s (a, b) VALUES(1, (1, (1, {a:1, b:1})))");
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,tuple(1,userType(1,1)))));
  flush();
  execute("ALTER TYPE " + KEYSPACE + "."+ type+ " ADD c int");
  execute("INSERT INTO %s (a, b) VALUES(2, (2, (1, {a: 2, b: 2, c: 2})))");
  execute("INSERT INTO %s (a, b) VALUES(3, (3, (1, {a: 3, b: 3})))");
  execute("INSERT INTO %s (a, b) VALUES(4, (4, (1, {b:4})))");
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,tuple(1,userType(1,1)))),row(2,tuple(2,tuple(1,userType(2,2,2)))),row(3,tuple(3,tuple(1,userType(3,3,null)))),row(4,tuple(4,tuple(1,userType(null,4,null)))));
  flush();
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,tuple(1,userType(1,1)))),row(2,tuple(2,tuple(1,userType(2,2,2)))),row(3,tuple(3,tuple(1,userType(3,3,null)))),row(4,tuple(4,tuple(1,userType(null,4,null)))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCircularReferences() throws Throwable {
  String type1=createType("CREATE TYPE %s (foo int)");
  String typeX=createType("CREATE TYPE %s (bar frozen<" + typeWithKs(type1) + ">)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<list<" + typeWithKs(type1) + ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<set<" + typeWithKs(type1) + ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<map<text, " + typeWithKs(type1) + ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<map<" + typeWithKs(type1) + ", text>>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  String type2=createType("CREATE TYPE %s (foo frozen<" + typeWithKs(type1) + ">)");
  typeX=createType("CREATE TYPE %s (bar frozen<" + keyspace() + '.'+ type2+ ">)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<list<" + keyspace() + '.'+ type2+ ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<set<" + keyspace() + '.'+ type2+ ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<map<text, " + keyspace() + '.'+ type2+ ">>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  typeX=createType("CREATE TYPE %s (bar frozen<map<" + keyspace() + '.'+ type2+ ", text>>)");
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<"+ typeWithKs(typeX)+ '>');
  assertInvalidMessage("would create a circular reference","ALTER TYPE " + typeWithKs(type1) + " ADD needs_to_fail frozen<list<"+ typeWithKs(type1)+ ">>");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidField() throws Throwable {
  String myType=createType("CREATE TYPE %s (f int)");
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v frozen<" + myType + ">)");
  assertInvalid("INSERT INTO %s (k, v) VALUES (?, {s : ?})",0,1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.add_field_to_udt_test()
 */
@Test public void testAddFieldToUdt() throws Throwable {
  String typeName=createType("CREATE TYPE %s (fooint int, fooset set <text>)");
  createTable("CREATE TABLE %s (key int PRIMARY KEY, data frozen <" + typeName + ">)");
  execute("INSERT INTO %s (key, data) VALUES (1, {fooint: 1, fooset: {'2'}})");
  execute("ALTER TYPE " + keyspace() + "."+ typeName+ " ADD foomap map <int,text>");
  execute("INSERT INTO %s (key, data) VALUES (1, {fooint: 1, fooset: {'2'}, foomap: {3 : 'bar'}})");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.user_types_test()
 */
@Test public void testUserTypes() throws Throwable {
  UUID userID_1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  String addressType=createType("CREATE TYPE %s (street text, city text, zip_code int, phones set<text >)");
  String nameType=createType("CREATE TYPE %s (firstname text, lastname text)");
  createTable("CREATE TABLE %s (id uuid PRIMARY KEY, name frozen < " + nameType + " >, addresses map < text, frozen < "+ addressType+ " >> )");
  execute("INSERT INTO %s (id, name) VALUES(?, { firstname: 'Paul', lastname: 'smith' } )",userID_1);
  assertRows(execute("SELECT name.firstname FROM %s WHERE id = ?",userID_1),row("Paul"));
  execute("UPDATE %s SET addresses = addresses + { 'home': { street: '...', city:'SF', zip_code:94102, phones:{ } } } WHERE id = ?",userID_1);
  execute("SELECT addresses FROM %s WHERE id = ? ",userID_1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinTuple() throws Throwable {
  String type=createType("CREATE TYPE %s (a int, b int)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<tuple<int, " + KEYSPACE + "."+ type+ ">>)");
  execute("INSERT INTO %s (a, b) VALUES(1, (1, {a:1, b:1}))");
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,userType(1,1))));
  flush();
  execute("ALTER TYPE " + KEYSPACE + "."+ type+ " ADD c int");
  execute("INSERT INTO %s (a, b) VALUES(2, (2, {a: 2, b: 2, c: 2}))");
  execute("INSERT INTO %s (a, b) VALUES(3, (3, {a: 3, b: 3}))");
  execute("INSERT INTO %s (a, b) VALUES(4, (4, {b:4}))");
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,userType(1,1))),row(2,tuple(2,userType(2,2,2))),row(3,tuple(3,userType(3,3,null))),row(4,tuple(4,userType(null,4,null))));
  flush();
  assertRows(execute("SELECT * FROM %s"),row(1,tuple(1,userType(1,1))),row(2,tuple(2,userType(2,2,2))),row(3,tuple(3,userType(3,3,null))),row(4,tuple(4,userType(null,4,null))));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test user type test that does a little more nesting,
 * migrated from cql_tests.py:TestCQL.more_user_types_test()
 */
@Test public void testNestedUserTypes() throws Throwable {
  String type1=createType("CREATE TYPE %s ( s set<text>, m map<text, text>, l list<text>)");
  String type2=createType("CREATE TYPE %s ( s set < frozen < " + type1 + " >>,)");
  createTable("CREATE TABLE %s (id int PRIMARY KEY, val frozen<" + type2 + ">)");
  execute("INSERT INTO %s (id, val) VALUES (0, { s : {{ s : {'foo', 'bar'}, m : { 'foo' : 'bar' }, l : ['foo', 'bar']} }})");
  execute("SELECT * FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinUserType() throws Throwable {
  String type=createType("CREATE TYPE %s (a int, b int)");
  String otherType=createType("CREATE TYPE %s (x frozen<" + KEYSPACE + "."+ type+ ">)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<" + KEYSPACE + "."+ otherType+ ">)");
  execute("INSERT INTO %s (a, b) VALUES(1, {x: {a:1, b:1}})");
  assertRows(execute("SELECT b.x.a, b.x.b FROM %s"),row(1,1));
  flush();
  execute("ALTER TYPE " + KEYSPACE + "."+ type+ " ADD c int");
  execute("INSERT INTO %s (a, b) VALUES(2, {x: {a: 2, b: 2, c: 2}})");
  execute("INSERT INTO %s (a, b) VALUES(3, {x: {a: 3, b: 3}})");
  execute("INSERT INTO %s (a, b) VALUES(4, {x: {b:4}})");
  assertRows(execute("SELECT b.x.a, b.x.b, b.x.c FROM %s"),row(1,1,null),row(2,2,2),row(3,3,null),row(null,4,null));
  flush();
  assertRows(execute("SELECT b.x.a, b.x.b, b.x.c FROM %s"),row(1,1,null),row(2,2,2),row(3,3,null),row(null,4,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinSet() throws Throwable {
  String[] columnTypePrefixes={"frozen<set<","set<frozen<"};
  for (  String columnTypePrefix : columnTypePrefixes) {
    String ut1=createType("CREATE TYPE %s (a int)");
    String columnType=columnTypePrefix + KEYSPACE + "."+ ut1+ ">>";
    createTable("CREATE TABLE %s (x int PRIMARY KEY, y " + columnType + ")");
    execute("INSERT INTO %s (x, y) VALUES(1, {1} )");
    assertRows(execute("SELECT * FROM %s"),row(1,set(userType(1))));
    flush();
    execute("ALTER TYPE " + KEYSPACE + "."+ ut1+ " ADD b int");
    execute("INSERT INTO %s (x, y) VALUES(2, {{a:2, b:2}})");
    execute("INSERT INTO %s (x, y) VALUES(3, {{a:3}})");
    execute("INSERT INTO %s (x, y) VALUES(4, {{b:4}})");
    assertRows(execute("SELECT * FROM %s"),row(1,set(userType(1))),row(2,set(userType(2,2))),row(3,set(userType(3,null))),row(4,set(userType(null,4))));
    flush();
    assertRows(execute("SELECT * FROM %s"),row(1,set(userType(1))),row(2,set(userType(2,2))),row(3,set(userType(3,null))),row(4,set(userType(null,4))));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinList() throws Throwable {
  String[] columnTypePrefixes={"frozen<list<","list<frozen<"};
  for (  String columnTypePrefix : columnTypePrefixes) {
    String ut1=createType("CREATE TYPE %s (a int)");
    String columnType=columnTypePrefix + KEYSPACE + "."+ ut1+ ">>";
    createTable("CREATE TABLE %s (x int PRIMARY KEY, y " + columnType + ")");
    execute("INSERT INTO %s (x, y) VALUES(1, [1] )");
    assertRows(execute("SELECT * FROM %s"),row(1,list(userType(1))));
    flush();
    execute("ALTER TYPE " + KEYSPACE + "."+ ut1+ " ADD b int");
    execute("INSERT INTO %s (x, y) VALUES(2, [{a:2, b:2}])");
    execute("INSERT INTO %s (x, y) VALUES(3, [{a:3}])");
    execute("INSERT INTO %s (x, y) VALUES(4, [{b:4}])");
    assertRows(execute("SELECT * FROM %s"),row(1,list(userType(1))),row(2,list(userType(2,2))),row(3,list(userType(3,null))),row(4,list(userType(null,4))));
    flush();
    assertRows(execute("SELECT * FROM %s"),row(1,list(userType(1))),row(2,list(userType(2,2))),row(3,list(userType(3,null))),row(4,list(userType(null,4))));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlteringUserTypeNestedWithinMap() throws Throwable {
  String[] columnTypePrefixes={"frozen<map<text, ","map<text, frozen<"};
  for (  String columnTypePrefix : columnTypePrefixes) {
    String ut1=createType("CREATE TYPE %s (a int)");
    String columnType=columnTypePrefix + KEYSPACE + "."+ ut1+ ">>";
    createTable("CREATE TABLE %s (x int PRIMARY KEY, y " + columnType + ")");
    execute("INSERT INTO %s (x, y) VALUES(1, {'firstValue':{a:1}})");
    assertRows(execute("SELECT * FROM %s"),row(1,map("firstValue",userType(1))));
    flush();
    execute("ALTER TYPE " + KEYSPACE + "."+ ut1+ " ADD b int");
    execute("INSERT INTO %s (x, y) VALUES(2, {'secondValue':{a:2, b:2}})");
    execute("INSERT INTO %s (x, y) VALUES(3, {'thirdValue':{a:3}})");
    execute("INSERT INTO %s (x, y) VALUES(4, {'fourthValue':{b:4}})");
    assertRows(execute("SELECT * FROM %s"),row(1,map("firstValue",userType(1))),row(2,map("secondValue",userType(2,2))),row(3,map("thirdValue",userType(3,null))),row(4,map("fourthValue",userType(null,4))));
    flush();
    assertRows(execute("SELECT * FROM %s"),row(1,map("firstValue",userType(1))),row(2,map("secondValue",userType(2,2))),row(3,map("thirdValue",userType(3,null))),row(4,map("fourthValue",userType(null,4))));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFor7684() throws Throwable {
  String myType=createType("CREATE TYPE %s (x double)");
  createTable("CREATE TABLE %s (k int, v frozen<" + myType + ">, b boolean static, PRIMARY KEY (k, v))");
  execute("INSERT INTO %s(k, v) VALUES (?, {x:?})",1,-104.99251);
  execute("UPDATE %s SET b = ? WHERE k = ?",true,1);
  assertRows(execute("SELECT v.x FROM %s WHERE k = ? AND v = {x:?}",1,-104.99251),row(-104.99251));
  flush();
  assertRows(execute("SELECT v.x FROM %s WHERE k = ? AND v = {x:?}",1,-104.99251),row(-104.99251));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.CrcCheckChanceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChangingCrcCheckChanceOldFormat() throws Throwable {
  testChangingCrcCheckChance(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChangingCrcCheckChanceNewFormat() throws Throwable {
  testChangingCrcCheckChance(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropDuringCompaction() throws Throwable {
  CompactionManager.instance.disableAutoCompaction();
  createTable("CREATE TABLE %s (p text, c text, v text, s text static, PRIMARY KEY (p, c)) WITH compression = {'sstable_compression': 'LZ4Compressor', 'crc_check_chance' : 0.99}");
  ColumnFamilyStore cfs=Keyspace.open(CQLTester.KEYSPACE).getColumnFamilyStore(currentTable());
  for (int i=0; i < 100; i++) {
    execute("INSERT INTO %s(p, c, v, s) values (?, ?, ?, ?)","p1","k1","v1","sv1");
    execute("INSERT INTO %s(p, c, v) values (?, ?, ?)","p1","k2","v2");
    execute("INSERT INTO %s(p, s) values (?, ?)","p2","sv2");
    cfs.forceBlockingFlush();
  }
  DatabaseDescriptor.setCompactionThroughputMbPerSec(1);
  List<Future<?>> futures=CompactionManager.instance.submitMaximal(cfs,CompactionManager.getDefaultGcBefore(cfs,FBUtilities.nowInSeconds()),false);
  execute("DROP TABLE %s");
  try {
    FBUtilities.waitOnFutures(futures);
  }
 catch (  Throwable t) {
    if (!(t.getCause() instanceof ExecutionException) || !(t.getCause().getCause() instanceof CompactionInterruptedException))     throw t;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.OverflowTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conversion_functions_test()
 */
@Test public void testConversionFunctions() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, i varint, b blob)");
  execute("INSERT INTO %s (k, i, b) VALUES (0, blobAsVarint(bigintAsBlob(3)), textAsBlob('foobar'))");
  assertRows(execute("SELECT i, blobAsText(b) FROM %s WHERE k = 0"),row(BigInteger.valueOf(3),"foobar"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.empty_blob_test()
 */
@Test public void testEmptyBlob() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, b blob)");
  execute("INSERT INTO %s (k, b) VALUES (0, 0x)");
  assertRows(execute("SELECT * FROM %s"),row(0,ByteBufferUtil.bytes("")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test support for nulls
 * migrated from cql_tests.py:TestCQL.null_support_test()
 */
@Test public void testNullSupport() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v1 int, v2 set<text>, PRIMARY KEY (k, c))");
  execute("INSERT INTO %s (k, c, v1, v2) VALUES (0, 0, null, {'1', '2'})");
  execute("INSERT INTO %s (k, c, v1) VALUES (0, 1, 1)");
  assertRows(execute("SELECT * FROM %s"),row(0,0,null,set("1","2")),row(0,1,1,null));
  execute("INSERT INTO %s (k, c, v1) VALUES (0, 1, null)");
  execute("INSERT INTO %s (k, c, v2) VALUES (0, 0, null)");
  assertRows(execute("SELECT * FROM %s"),row(0,0,null,null),row(0,1,null,null));
  assertInvalid("INSERT INTO %s (k, c, v2) VALUES (0, 2, {1, null})");
  assertInvalid("SELECT * FROM %s WHERE k = null");
  assertInvalid("INSERT INTO %s (k, c, v2) VALUES (0, 0, { 'foo', 'bar', null })");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.boolean_test()
 */
@Test public void testBoolean() throws Throwable {
  createTable("CREATE TABLE %s (k boolean PRIMARY KEY, b boolean)");
  execute("INSERT INTO %s (k, b) VALUES (true, false)");
  assertRows(execute("SELECT * FROM %s WHERE k = true"),row(true,false));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test table options
 * migrated from cql_tests.py:TestCQL.table_options_test()
 */
@Test public void testTableOptions() throws Throwable {
  createTable("CREATE TABLE %s ( k int PRIMARY KEY, c int ) WITH " + "comment = 'My comment' " + "AND read_repair_chance = 0.5 "+ "AND dclocal_read_repair_chance = 0.5 "+ "AND gc_grace_seconds = 4 "+ "AND bloom_filter_fp_chance = 0.01 "+ "AND compaction = { 'class' : 'LeveledCompactionStrategy', 'sstable_size_in_mb' : 10 } "+ "AND compression = { 'enabled': false } "+ "AND caching = { 'keys': 'ALL', 'rows_per_partition': 'ALL' }");
  execute("ALTER TABLE %s WITH " + "comment = 'other comment' " + "AND read_repair_chance = 0.3 "+ "AND dclocal_read_repair_chance = 0.3 "+ "AND gc_grace_seconds = 100 "+ "AND bloom_filter_fp_chance = 0.1 "+ "AND compaction = { 'class': 'SizeTieredCompactionStrategy', 'min_sstable_size' : 42 } "+ "AND compression = { 'class' : 'SnappyCompressor' } "+ "AND caching = { 'rows_per_partition': 'ALL' }");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.blobAs_functions_test()
 */
@Test public void testBlobAsFunction() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int)");
  assertInvalid("INSERT INTO %s (k, v) VALUES (0, blobAsInt(0x01))");
  execute("INSERT INTO %s (k, v) VALUES (0, blobAsInt(0x00000001))");
  assertRows(execute("select v from %s where k=0"),row(1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.unescaped_string_test()
 */
@Test public void testUnescapedString() throws Throwable {
  createTable("CREATE TABLE %s ( k text PRIMARY KEY, c text, )");
  assertInvalidThrow(SyntaxException.class,"INSERT INTO %s (k, c) VALUES ('foo', 'CQL is cassandra\'s best friend')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.column_name_validation_test()
 */
@Test public void testColumnNameValidation() throws Throwable {
  createTable("CREATE TABLE %s (k text, c int, v timeuuid, PRIMARY KEY (k, c))");
  assertInvalid("INSERT INTO %s (k, c) VALUES ('', 0)");
  assertInvalid("INSERT INTO %s (k, c) VALUES (0, 10000000000)");
  assertInvalid("INSERT INTO %s (k, c, v) VALUES (0, 0, 550e8400-e29b-41d4-a716-446655440000)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.float_with_exponent_test()
 */
@Test public void testFloatWithExponent() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, d double, f float)");
  execute("INSERT INTO %s (k, d, f) VALUES (0, 3E+10, 3.4E3)");
  execute("INSERT INTO %s (k, d, f) VALUES (1, 3.E10, -23.44E-3)");
  execute("INSERT INTO %s (k, d, f) VALUES (2, 3, -2)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test identifiers
 * migrated from cql_tests.py:TestCQL.identifier_test()
 */
@Test public void testIdentifiers() throws Throwable {
  createTable("CREATE TABLE %s (key_23 int PRIMARY KEY, CoLuMn int)");
  execute("INSERT INTO %s (Key_23, Column) VALUES (0, 0)");
  execute("INSERT INTO %s (KEY_23, COLUMN) VALUES (0, 0)");
  assertInvalid("INSERT INTO %s (key_23, column, column) VALUES (0, 0, 0)");
  assertInvalid("INSERT INTO %s (key_23, column, COLUMN) VALUES (0, 0, 0)");
  assertInvalid("INSERT INTO %s (key_23, key_23, column) VALUES (0, 0, 0)");
  assertInvalid("INSERT INTO %s (key_23, KEY_23, column) VALUES (0, 0, 0)");
  String tableName=createTableName();
  assertInvalidThrow(SyntaxException.class,String.format("CREATE TABLE %s.%s (select int PRIMARY KEY, column int)",keyspace(),tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test reserved keywords
 * migrated from cql_tests.py:TestCQL.reserved_keyword_test()
 */
@Test public void testReservedKeywords() throws Throwable {
  createTable("CREATE TABLE %s (key text PRIMARY KEY, count counter)");
  String tableName=createTableName();
  assertInvalidThrow(SyntaxException.class,String.format("CREATE TABLE %s.%s (select text PRIMARY KEY, x int)",keyspace(),tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test regression from #5189,
 * migrated from cql_tests.py:TestCQL.compact_metadata_test()
 */
@Test public void testCompactMetadata() throws Throwable {
  createTable("CREATE TABLE %s (id int primary key, i int ) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (id, i) VALUES (1, 2)");
  assertRows(execute("SELECT * FROM %s"),row(1,2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.PgStringTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPgSyleFunction() throws Throwable {
  execute("create or replace function " + KEYSPACE + ".pgfun1 ( input double ) called on null input returns text language java\n"+ "AS $$return \"foobar\";$$");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=SyntaxException.class) public void testMarkerPgFail() throws Throwable {
  execute("create function " + KEYSPACE + ".pgfun1 ( input double ) called on null input returns bigint language java\n"+ "AS $javasrc$return 0L;$javasrc$;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPgSyleInsert() throws Throwable {
  createTable("CREATE TABLE %s (key ascii primary key, val text)");
  assertInvalidSyntax("INSERT INTO %s (key, val) VALUES ($ $key_empty$$, $$'' value for empty$$)");
  assertInvalidSyntax("INSERT INTO %s (key, val) VALUES ($$key_empty$$, $$'' value for empty$ $)");
  assertInvalidSyntax("INSERT INTO %s (key, val) VALUES ($$key_empty$ $, $$'' value for empty$$)");
  execute("INSERT INTO %s (key, val) VALUES ($$prim$ $ $key$$, $$some '' arbitrary value$$)");
  execute("INSERT INTO %s (key, val) VALUES ($$key_empty$$, $$'' value for empty$$)");
  execute("INSERT INTO %s (key, val) VALUES ($$$foo$_$foo$$, $$$'' value for empty$$)");
  execute("INSERT INTO %s (key, val) VALUES ('$txt$key$$$$txt$', '$txt$'' other value$txt$')");
  assertRows(execute("SELECT key, val FROM %s WHERE key='prim$ $ $key'"),row("prim$ $ $key","some '' arbitrary value"));
  assertRows(execute("SELECT key, val FROM %s WHERE key='key_empty'"),row("key_empty","'' value for empty"));
  assertRows(execute("SELECT key, val FROM %s WHERE key='$foo$_$foo'"),row("$foo$_$foo","$'' value for empty"));
  assertRows(execute("SELECT key, val FROM %s WHERE key='$txt$key$$$$txt$'"),row("$txt$key$$$$txt$","$txt$' other value$txt$"));
  assertInvalidSyntax("INSERT INTO %s (key, val) VALUES ($ascii$prim$$$key$invterm$, $txt$some '' arbitrary value$txt$)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.RoleSyntaxTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void listPermissionsSyntaxTest() throws Throwable {
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL ROLES OF r1");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL ROLES OF 'r1'");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL ROLES OF \"r1\"");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL ROLES OF $$ r '1' $$");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE 'r1' OF r2");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE \"r1\" OF r2");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE $$ r '1' $$ OF r2");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE 'r1' OF 'r2'");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE \"r1\" OF \"r2\"");
  assertValidSyntax("LIST ALL PERMISSIONS ON ROLE $$r1$$ OF $$ r '2' $$");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL KEYSPACES OF r1");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL KEYSPACES OF 'r1'");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL KEYSPACES OF \"r1\"");
  assertValidSyntax("LIST ALL PERMISSIONS ON ALL KEYSPACES OF $$ r '1' $$");
  assertValidSyntax("LIST ALL PERMISSIONS OF r1");
  assertValidSyntax("LIST ALL PERMISSIONS OF 'r1'");
  assertValidSyntax("LIST ALL PERMISSIONS OF \"r1\"");
  assertValidSyntax("LIST ALL PERMISSIONS OF $$ r '1' $$");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void grantRevokePermissionsSyntaxTest() throws Throwable {
  assertValidSyntax("GRANT ALTER ON ROLE r1 TO r2");
  assertValidSyntax("GRANT ALTER ON ROLE 'r1' TO \"r2\"");
  assertValidSyntax("GRANT ALTER ON ROLE \"r1\" TO 'r2'");
  assertValidSyntax("GRANT ALTER ON ROLE $$r1$$ TO $$ r '2' $$");
  assertValidSyntax("REVOKE ALTER ON ROLE r1 FROM r2");
  assertValidSyntax("REVOKE ALTER ON ROLE 'r1' FROM \"r2\"");
  assertValidSyntax("REVOKE ALTER ON ROLE \"r1\" FROM 'r2'");
  assertValidSyntax("REVOKE ALTER ON ROLE $$r1$$ FROM $$ r '2' $$");
  assertValidSyntax("GRANT SELECT ON KEYSPACE ks TO r1");
  assertValidSyntax("GRANT SELECT ON KEYSPACE ks TO 'r1'");
  assertValidSyntax("GRANT SELECT ON KEYSPACE ks TO \"r1\"");
  assertValidSyntax("GRANT SELECT ON KEYSPACE ks TO $$ r '1' $$");
  assertValidSyntax("REVOKE SELECT ON KEYSPACE ks FROM r1");
  assertValidSyntax("REVOKE SELECT ON KEYSPACE ks FROM 'r1'");
  assertValidSyntax("REVOKE SELECT ON KEYSPACE ks FROM \"r1\"");
  assertValidSyntax("REVOKE SELECT ON KEYSPACE ks FROM $$ r '1' $$");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void alterSyntaxTest() throws Throwable {
  assertValidSyntax("ALTER ROLE r1 WITH PASSWORD = 'password'");
  assertValidSyntax("ALTER ROLE 'r1' WITH PASSWORD = 'password'");
  assertValidSyntax("ALTER ROLE \"r1\" WITH PASSWORD = 'password'");
  assertValidSyntax("ALTER ROLE $$r1$$ WITH PASSWORD = 'password'");
  assertValidSyntax("ALTER ROLE $$ r1 ' x $ x ' $$ WITH PASSWORD = 'password'");
  assertValidSyntax("ALTER USER u1 WITH PASSWORD 'password'");
  assertValidSyntax("ALTER USER 'u1' WITH PASSWORD 'password'");
  assertValidSyntax("ALTER USER $$u1$$ WITH PASSWORD 'password'");
  assertValidSyntax("ALTER USER $$ u1 ' x $ x ' $$ WITH PASSWORD 'password'");
  assertInvalidSyntax("ALTER USER \"u1\" WITH PASSWORD 'password'",NO_QUOTED_USERNAME);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void createSyntaxTest() throws Throwable {
  assertValidSyntax("CREATE ROLE r1");
  assertValidSyntax("CREATE ROLE 'r1'");
  assertValidSyntax("CREATE ROLE \"r1\"");
  assertValidSyntax("CREATE ROLE $$r1$$");
  assertValidSyntax("CREATE ROLE $$ r1 ' x $ x ' $$");
  assertValidSyntax("CREATE USER u1");
  assertValidSyntax("CREATE USER 'u1'");
  assertValidSyntax("CREATE USER $$u1$$");
  assertValidSyntax("CREATE USER $$ u1 ' x $ x ' $$");
  assertInvalidSyntax("CREATE USER \"u1\"",NO_QUOTED_USERNAME);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dropSyntaxTest() throws Throwable {
  assertValidSyntax("DROP ROLE r1");
  assertValidSyntax("DROP ROLE 'r1'");
  assertValidSyntax("DROP ROLE \"r1\"");
  assertValidSyntax("DROP ROLE $$r1$$");
  assertValidSyntax("DROP ROLE $$ r1 ' x $ x ' $$");
  assertValidSyntax("DROP USER u1");
  assertValidSyntax("DROP USER 'u1'");
  assertValidSyntax("DROP USER $$u1$$");
  assertValidSyntax("DROP USER $$ u1 ' x $ x ' $$");
  assertInvalidSyntax("DROP USER \"u1\"",NO_QUOTED_USERNAME);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void listRolesSyntaxTest() throws Throwable {
  assertValidSyntax("LIST ROLES OF r1");
  assertValidSyntax("LIST ROLES OF 'r1'");
  assertValidSyntax("LIST ROLES OF \"r1\"");
  assertValidSyntax("LIST ROLES OF $$ r '1' $$");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void customOptionsSyntaxTest() throws Throwable {
  assertValidSyntax("CREATE ROLE r WITH OPTIONS = {'a':'b', 'b':1}");
  assertInvalidSyntax("CREATE ROLE r WITH OPTIONS = 'term'");
  assertInvalidSyntax("CREATE ROLE r WITH OPTIONS = 99");
  assertValidSyntax("ALTER ROLE r WITH OPTIONS = {'a':'b', 'b':1}");
  assertInvalidSyntax("ALTER ROLE r WITH OPTIONS = 'term'");
  assertInvalidSyntax("ALTER ROLE r WITH OPTIONS = 99");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void standardOptionsSyntaxTest() throws Throwable {
  assertValidSyntax("CREATE ROLE r WITH LOGIN = true AND SUPERUSER = false AND PASSWORD = 'foo'");
  assertValidSyntax("CREATE ROLE r WITH PASSWORD = 'foo' AND LOGIN = true AND SUPERUSER = false");
  assertValidSyntax("CREATE ROLE r WITH SUPERUSER = true AND PASSWORD = 'foo' AND LOGIN = false");
  assertValidSyntax("CREATE ROLE r WITH LOGIN = true AND PASSWORD = 'foo' AND SUPERUSER = false");
  assertValidSyntax("CREATE ROLE r WITH SUPERUSER = true AND PASSWORD = 'foo' AND LOGIN = false");
  assertValidSyntax("ALTER ROLE r WITH LOGIN = true AND SUPERUSER = false AND PASSWORD = 'foo'");
  assertValidSyntax("ALTER ROLE r WITH PASSWORD = 'foo' AND LOGIN = true AND SUPERUSER = false");
  assertValidSyntax("ALTER ROLE r WITH SUPERUSER = true AND PASSWORD = 'foo' AND LOGIN = false");
  assertValidSyntax("ALTER ROLE r WITH LOGIN = true AND PASSWORD = 'foo' AND SUPERUSER = false");
  assertValidSyntax("ALTER ROLE r WITH SUPERUSER = true AND PASSWORD = 'foo' AND LOGIN = false");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.AggregationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropStatements() throws Throwable {
  String f=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(state double, val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  createFunctionOverload(f,"double, double","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  assertInvalidMessage("matches multiple function definitions","DROP AGGREGATE " + f);
  assertInvalidMessage("non existing","DROP AGGREGATE " + f + "(double, double)");
  String a=createAggregate(KEYSPACE,"double","CREATE OR REPLACE AGGREGATE %s(double) " + "SFUNC " + shortFunctionName(f) + " "+ "STYPE double "+ "INITCOND 0");
  createAggregateOverload(a,"int","CREATE OR REPLACE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(f) + " "+ "STYPE int "+ "INITCOND 0");
  assertInvalidMessage("matches multiple function definitions","DROP FUNCTION " + a);
  assertInvalidMessage("non existing function","DROP FUNCTION " + a + "(double)");
  assertInvalidMessage("matches multiple function definitions","DROP AGGREGATE " + a);
  assertInvalidMessage("matches multiple function definitions","DROP AGGREGATE IF EXISTS " + a);
  execute("DROP AGGREGATE IF EXISTS " + KEYSPACE + ".non_existing");
  execute("DROP AGGREGATE IF EXISTS " + a + "(int, text)");
  execute("DROP AGGREGATE " + a + "(double)");
  execute("DROP AGGREGATE IF EXISTS " + a + "(double)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyListInitcond() throws Throwable {
  String f=createFunction(KEYSPACE,"list, int","CREATE FUNCTION %s(s list<text>, i int) " + "CALLED ON NULL INPUT " + "RETURNS list<text> "+ "LANGUAGE java "+ "AS 'if (i != null) s.add(String.valueOf(i)); return s;'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(f) + ' '+ "STYPE list<text> "+ "INITCOND [  ]");
  assertRows(execute("SELECT initcond FROM system_schema.aggregates WHERE keyspace_name=? AND aggregate_name=?",KEYSPACE,shortFunctionName(a)),row("[]"));
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, null)");
  execute("INSERT INTO %s (a, b) VALUES (3, 2)");
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row(Arrays.asList("1","2")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateIncompatibleTypes() throws Throwable {
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  String fState2=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a double, b double) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf((a!=null?a.doubleValue():0d) + b.doubleValue());'");
  String fFinal2=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a double) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState2)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(double)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE double "+ "FINALFUNC "+ shortFunctionName(fFinal2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateNullInitcond() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND null");
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row("6"));
  execute("DROP AGGREGATE " + a + "(int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionsWithCompactStorage() throws Throwable {
  createTable("CREATE TABLE %s (a int , b int, c double, primary key(a, b) ) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 11.5)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, 9.5)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 3, 9.0)");
  assertRows(execute("SELECT max(b), min(b), sum(b), avg(b) , max(c), sum(c), avg(c) FROM %s"),row(3,1,6,2,11.5,30.0,10.0));
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(3L));
  assertRows(execute("SELECT COUNT(1) FROM %s"),row(3L));
  assertRows(execute("SELECT COUNT(*) FROM %s WHERE a = 1 AND b > 1"),row(2L));
  assertRows(execute("SELECT COUNT(1) FROM %s WHERE a = 1 AND b > 1"),row(2L));
  assertRows(execute("SELECT max(b), min(b), sum(b), avg(b) , max(c), sum(c), avg(c) FROM %s WHERE a = 1 AND b > 1"),row(3,2,5,2,9.5,18.5,9.25));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropReferenced() throws Throwable {
  String f=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(state double, val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  String a=createAggregate(KEYSPACE,"double","CREATE OR REPLACE AGGREGATE %s(double) " + "SFUNC " + shortFunctionName(f) + " "+ "STYPE double "+ "INITCOND 0");
  assertInvalidMessage("still referenced by","DROP FUNCTION " + f);
  execute("DROP AGGREGATE " + a + "(double)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateWithoutStateOrFinal() throws Throwable {
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".jSumFooNE1(int) "+ "SFUNC jSumFooNEstate "+ "STYPE int");
  String f=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(a + b);'");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".jSumFooNE2(int) "+ "SFUNC "+ shortFunctionName(f)+ " "+ "STYPE int "+ "FINALFUNC jSumFooNEfinal");
  execute("DROP FUNCTION " + f + "(int, int)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateComplex() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"tuple<bigint, int>, int","CREATE FUNCTION %s(a tuple<bigint, int>, b int) " + "CALLED ON NULL INPUT " + "RETURNS tuple<bigint, int> "+ "LANGUAGE java "+ "AS '"+ "a.setLong(0, a.getLong(0) + b.intValue());"+ "a.setInt(1, a.getInt(1) + 1);"+ "return a;"+ "'");
  String fFinal=createFunction(KEYSPACE,"tuple<bigint, int>","CREATE FUNCTION %s(a tuple<bigint, int>) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS '"+ "double r = a.getLong(0);"+ "r /= a.getInt(1);"+ "return Double.valueOf(r);"+ "'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE tuple<bigint, int> "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND (0, 0)");
  assertRows(execute("SELECT initcond FROM system_schema.aggregates WHERE keyspace_name=? AND aggregate_name=?",KEYSPACE,shortFunctionName(a)),row("(0, 0)"));
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row(2d));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateInvalidInitcond() throws Throwable {
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  assertInvalidMessage("Invalid STRING constant (foobar)","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND 'foobar'");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenMapType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<map<int, int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,map());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,map(1,2,3,4));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,map(4,5,6,7));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,map(7,8,9,10));
  String fState=createFunction(KEYSPACE,"map<int, int>","CREATE FUNCTION %s (state map<int, int>, values map<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS map<int, int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String fFinal=createFunction(KEYSPACE,"map<int, int>","CREATE FUNCTION %s(state map<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS map<int, int> "+ "LANGUAGE java "+ "AS 'return state;'");
  assertInvalidMessage("The function state type should not be frozen","CREATE AGGREGATE %s(map<int, int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE frozen<map<int, int>> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  String aggregation=createAggregate(KEYSPACE,"map<int, int>","CREATE AGGREGATE %s(map<int, int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE map<int, int> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  assertRows(execute("SELECT " + aggregation + "(b) FROM %s"),row(map(7,8,9,10)));
  assertInvalidMessage("The function arguments should not be frozen","DROP AGGREGATE %s (frozen<map<int, int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyValues() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b text)");
  execute("INSERT INTO %s (a, b) VALUES (1, '')");
  execute("INSERT INTO %s (a, b) VALUES (2, '')");
  execute("INSERT INTO %s (a, b) VALUES (3, '')");
  String fCON=createFunction(KEYSPACE,"text, text","CREATE FUNCTION %s(a text, b text) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a + \"x\" + b + \"y\";'");
  String fCONf=createFunction(KEYSPACE,"text","CREATE FUNCTION %s(a text) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"fin\" + a;'");
  String aCON=createAggregate(KEYSPACE,"text","CREATE AGGREGATE %s(text) " + "SFUNC " + shortFunctionName(fCON) + ' '+ "STYPE text "+ "FINALFUNC "+ shortFunctionName(fCONf)+ ' '+ "INITCOND ''");
  assertRows(execute("SELECT initcond FROM system_schema.aggregates WHERE keyspace_name=? AND aggregate_name=?",KEYSPACE,shortFunctionName(aCON)),row("''"));
  String fRNON=createFunction(KEYSPACE,"text, text","CREATE FUNCTION %s(a text, b text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a + \"x\" + b + \"y\";'");
  String fRNONf=createFunction(KEYSPACE,"text","CREATE FUNCTION %s(a text) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"fin\" + a;'");
  String aRNON=createAggregate(KEYSPACE,"text","CREATE AGGREGATE %s(text) " + "SFUNC " + shortFunctionName(fRNON) + ' '+ "STYPE text "+ "FINALFUNC "+ shortFunctionName(fRNONf)+ ' '+ "INITCOND ''");
  assertRows(execute("SELECT " + aCON + "(b) FROM %s"),row("finxyxyxy"));
  assertRows(execute("SELECT " + aRNON + "(b) FROM %s"),row("finxyxyxy"));
  createTable("CREATE TABLE %s (a int primary key, b text)");
  execute("INSERT INTO %s (a, b) VALUES (1, null)");
  execute("INSERT INTO %s (a, b) VALUES (2, null)");
  execute("INSERT INTO %s (a, b) VALUES (3, null)");
  assertRows(execute("SELECT " + aCON + "(b) FROM %s"),row("finxnullyxnullyxnully"));
  assertRows(execute("SELECT " + aRNON + "(b) FROM %s"),row("fin"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReversedType() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, primary key (a, b)) WITH CLUSTERING ORDER BY (b DESC)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 10)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, 9)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 3, 8)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 4, 7)");
  assertRows(execute("SELECT max(c), min(c), avg(c) FROM %s WHERE a = 1 AND b > 1"),row(9,7,8));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCountStarFunction() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c double, primary key (a, b))");
  assertColumnNames(execute("SELECT COUNT(*) FROM %s"),"count");
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(0L));
  assertColumnNames(execute("SELECT COUNT(1) FROM %s"),"count");
  assertRows(execute("SELECT COUNT(1) FROM %s"),row(0L));
  assertColumnNames(execute("SELECT COUNT(*), COUNT(*) FROM %s"),"count","count");
  assertRows(execute("SELECT COUNT(*), COUNT(*) FROM %s"),row(0L,0L));
  assertColumnNames(execute("SELECT COUNT(*) as myCount FROM %s"),"mycount");
  assertRows(execute("SELECT COUNT(*) as myCount FROM %s"),row(0L));
  assertColumnNames(execute("SELECT COUNT(1) as myCount FROM %s"),"mycount");
  assertRows(execute("SELECT COUNT(1) as myCount FROM %s"),row(0L));
  assertInvalidSyntaxMessage("Only COUNT(1) is supported, got COUNT(2)","SELECT COUNT(2) FROM %s");
  assertColumnNames(execute("SELECT COUNT(*), max(b), b FROM %s"),"count","system.max(b)","b");
  assertRows(execute("SELECT COUNT(*), max(b), b  FROM %s"),row(0L,null,null));
  assertColumnNames(execute("SELECT COUNT(1), max(b), b FROM %s"),"count","system.max(b)","b");
  assertRows(execute("SELECT COUNT(1), max(b), b  FROM %s"),row(0L,null,null));
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 11.5)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, 9.5)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 3, 9.0)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 5, 1.0)");
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(4L));
  assertRows(execute("SELECT COUNT(1) FROM %s"),row(4L));
  assertRows(execute("SELECT max(b), b, COUNT(*) FROM %s"),row(5,1,4L));
  assertRows(execute("SELECT max(b), COUNT(1), b FROM %s"),row(5,4L,1));
  assertRows(execute("SELECT max(b), COUNT(1), b FROM %s LIMIT 2"),row(5,4L,1));
  assertRows(execute("SELECT max(b), COUNT(1), b FROM %s WHERE a = 1 LIMIT 2"),row(5,4L,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAggregateWithColumns() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, primary key (a, b))");
  assertColumnNames(execute("SELECT count(b), max(b) as max, b, c as first FROM %s"),"system.count(b)","max","b","first");
  assertRows(execute("SELECT count(b), max(b) as max, b, c as first FROM %s"),row(0L,null,null,null));
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, null)");
  execute("INSERT INTO %s (a, b, c) VALUES (2, 4, 6)");
  execute("INSERT INTO %s (a, b, c) VALUES (4, 8, 12)");
  assertRows(execute("SELECT count(b), max(b) as max, b, c as first FROM %s"),row(3L,8,2,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenTupleType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<tuple<int, int>>)");
  createIndex("CREATE INDEX ON %s (b)");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,tuple());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,tuple(1,2));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,tuple(4,5));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,tuple(7,8));
  String fState=createFunction(KEYSPACE,"tuple<int, int>","CREATE FUNCTION %s (state tuple<int, int>, values tuple<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS tuple<int, int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String fFinal=createFunction(KEYSPACE,"tuple<int, int>","CREATE FUNCTION %s(state tuple<int, int>) " + "CALLED ON NULL INPUT " + "RETURNS tuple<int, int> "+ "LANGUAGE java "+ "AS 'return state;'");
  assertInvalidMessage("The function state type should not be frozen","CREATE AGGREGATE %s(tuple<int, int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE frozen<tuple<int, int>> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  String aggregation=createAggregate(KEYSPACE,"tuple<int, int>","CREATE AGGREGATE %s(tuple<int, int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE tuple<int, int> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  assertRows(execute("SELECT " + aggregation + "(b) FROM %s"),row(tuple(7,8)));
  assertInvalidMessage("The function arguments should not be frozen","DROP AGGREGATE %s (frozen<tuple<int, int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSchemaChange() throws Throwable {
  String f=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(state double, val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  createFunctionOverload(f,"double, double","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS '\"string\";';");
  String a=createAggregate(KEYSPACE,"double","CREATE OR REPLACE AGGREGATE %s(double) " + "SFUNC " + shortFunctionName(f) + " "+ "STYPE double "+ "INITCOND 0");
  assertLastSchemaChange(Event.SchemaChange.Change.CREATED,Event.SchemaChange.Target.AGGREGATE,KEYSPACE,parseFunctionName(a).name,"double");
  schemaChange("CREATE OR REPLACE AGGREGATE " + a + "(double) "+ "SFUNC "+ shortFunctionName(f)+ " "+ "STYPE double "+ "INITCOND 0");
  assertLastSchemaChange(Event.SchemaChange.Change.UPDATED,Event.SchemaChange.Target.AGGREGATE,KEYSPACE,parseFunctionName(a).name,"double");
  createAggregateOverload(a,"int","CREATE OR REPLACE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(f) + " "+ "STYPE int "+ "INITCOND 0");
  assertLastSchemaChange(Event.SchemaChange.Change.CREATED,Event.SchemaChange.Target.AGGREGATE,KEYSPACE,parseFunctionName(a).name,"int");
  schemaChange("DROP AGGREGATE " + a + "(double)");
  assertLastSchemaChange(Event.SchemaChange.Change.DROPPED,Event.SchemaChange.Target.AGGREGATE,KEYSPACE,parseFunctionName(a).name,"double");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptAggregateSimple() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS 'a + b;'");
  String a=createAggregate(KEYSPACE,"int, int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int ");
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row(6));
  execute("DROP AGGREGATE " + a + "(int)");
  execute("DROP FUNCTION " + fState + "(int, int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateNonExistingFuncs() throws Throwable {
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ "_not_there "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ "_not_there");
  execute("CREATE AGGREGATE " + KEYSPACE + ".aggrInvalid(int)"+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal));
  execute("DROP AGGREGATE " + KEYSPACE + ".aggrInvalid(int)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrongStateType() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val int)");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1);
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(1.0);'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(1);';");
  assertInvalidMessage("return type must be the same as the first argument type - check STYPE, argument and return types","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + ' '+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ ' '+ "INITCOND 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavascriptAggregate() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS 'a + b;'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE javascript "+ "AS '\"\"+a'");
  String a=createFunction(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND 42");
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row("48"));
  execute("DROP AGGREGATE " + a + "(int)");
  execute("DROP FUNCTION " + fFinal + "(int)");
  execute("DROP FUNCTION " + fState + "(int, int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateSimple() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String a=createAggregate(KEYSPACE,"int, int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int");
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row(6));
  execute("DROP AGGREGATE " + a + "(int)");
  execute("DROP FUNCTION " + fState + "(int, int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctions() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c double, d decimal, e smallint, f tinyint, primary key (a, b))");
  assertColumnNames(execute("SELECT COUNT(*) FROM %s"),"count");
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(0L));
  assertColumnNames(execute("SELECT max(b), min(b), sum(b), avg(b)," + "max(c), sum(c), avg(c)," + "sum(d), avg(d),"+ "max(e), min(e), sum(e), avg(e),"+ "max(f), min(f), sum(f), avg(f) FROM %s"),"system.max(b)","system.min(b)","system.sum(b)","system.avg(b)","system.max(c)","system.sum(c)","system.avg(c)","system.sum(d)","system.avg(d)","system.max(e)","system.min(e)","system.sum(e)","system.avg(e)","system.max(f)","system.min(f)","system.sum(f)","system.avg(f)");
  assertRows(execute("SELECT max(b), min(b), sum(b), avg(b)," + "max(c), sum(c), avg(c)," + "sum(d), avg(d),"+ "max(e), min(e), sum(e), avg(e),"+ "max(f), min(f), sum(f), avg(f) FROM %s"),row(null,null,0,0,null,0.0,0.0,new BigDecimal("0"),new BigDecimal("0"),null,null,(short)0,(short)0,null,null,(byte)0,(byte)0));
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 11.5, 11.5, 1, 1)");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 2, 9.5, 1.5, 2, 2)");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 3, 9.0, 2.0, 3, 3)");
  assertRows(execute("SELECT max(b), min(b), sum(b), avg(b) , max(c), sum(c), avg(c), sum(d), avg(d)," + "max(e), min(e), sum(e), avg(e)," + "max(f), min(f), sum(f), avg(f)"+ " FROM %s"),row(3,1,6,2,11.5,30.0,10.0,new BigDecimal("15.0"),new BigDecimal("5.0"),(short)3,(short)1,(short)6,(short)2,(byte)3,(byte)1,(byte)6,(byte)2));
  execute("INSERT INTO %s (a, b, d) VALUES (1, 5, 1.0)");
  assertRows(execute("SELECT COUNT(*) FROM %s"),row(4L));
  assertRows(execute("SELECT COUNT(1) FROM %s"),row(4L));
  assertRows(execute("SELECT COUNT(b), count(c), count(e), count(f) FROM %s"),row(4L,3L,3L,3L));
  assertRows(execute("SELECT COUNT(b), count(c), count(e), count(f) FROM %s LIMIT 2"),row(4L,3L,3L,3L));
  assertRows(execute("SELECT COUNT(b), count(c), count(e), count(f) FROM %s WHERE a = 1 LIMIT 2"),row(4L,3L,3L,3L));
  assertRows(execute("SELECT AVG(CAST(b AS double)) FROM %s"),row(11.0 / 4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidCalls() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, primary key (a, b))");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 10)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, 9)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 3, 8)");
  assertInvalidSyntax("SELECT max(b), max(c) FROM %s WHERE max(a) = 1");
  assertInvalidMessage("aggregate functions cannot be used as arguments of aggregate functions","SELECT max(sum(c)) FROM %s");
  assertInvalidSyntax("SELECT COUNT(2) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenUDFType() throws Throwable {
  String myType=createType("CREATE TYPE %s (f int)");
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<" + myType + ">)");
  createIndex("CREATE INDEX ON %s (b)");
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",0,1);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",1,2);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",2,4);
  execute("INSERT INTO %s (a, b) VALUES (?, {f : ?})",3,7);
  String fState=createFunction(KEYSPACE,myType + ',' + myType,"CREATE FUNCTION %s (state " + myType + ", values "+ myType+ ") "+ "CALLED ON NULL INPUT "+ "RETURNS "+ myType+ " "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String fFinal=createFunction(KEYSPACE,myType,"CREATE FUNCTION %s(state " + myType + ") "+ "CALLED ON NULL INPUT "+ "RETURNS "+ myType+ " "+ "LANGUAGE java "+ "AS 'return state;'");
  assertInvalidMessage("The function state type should not be frozen","CREATE AGGREGATE %s(" + myType + ") "+ "SFUNC "+ parseFunctionName(fState).name+ ' '+ "STYPE frozen<"+ myType+ "> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  String aggregation=createAggregate(KEYSPACE,myType,"CREATE AGGREGATE %s(" + myType + ") "+ "SFUNC "+ parseFunctionName(fState).name+ ' '+ "STYPE "+ myType+ ' '+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  assertRows(execute("SELECT " + aggregation + "(b).f FROM %s"),row(7));
  assertInvalidMessage("The function arguments should not be frozen","DROP AGGREGATE %s (frozen<" + myType + ">);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBrokenAggregate() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, val int)");
  execute("INSERT INTO %s (key, val) VALUES (?, ?)",1,1);
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS 'a + b;'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int ");
  KeyspaceMetadata ksm=Schema.instance.getKSMetaData(keyspace());
  UDAggregate f=(UDAggregate)ksm.functions.get(parseFunctionName(a)).iterator().next();
  UDAggregate broken=UDAggregate.createBroken(f.name(),f.argTypes(),f.returnType(),null,new InvalidRequestException("foo bar is broken"));
  Schema.instance.setKeyspaceMetadata(ksm.withSwapped(ksm.functions.without(f.name(),f.argTypes()).with(broken)));
  assertInvalidThrowMessage("foo bar is broken",InvalidRequestException.class,"SELECT " + a + "(val) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrongKeyspace() throws Throwable {
  String typeName=createType("CREATE TYPE %s (txt text, i int)");
  String type=KEYSPACE + '.' + typeName;
  String fState=createFunction(KEYSPACE_PER_TEST,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(1.0);'");
  String fFinal=createFunction(KEYSPACE_PER_TEST,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(1);';");
  String fStateWrong=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(1.0);'");
  String fFinalWrong=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(1);';");
  assertInvalidMessage(String.format("Statement on keyspace %s cannot refer to a user type in keyspace %s; user types can only be used in the keyspace they are defined in",KEYSPACE_PER_TEST,KEYSPACE),"CREATE AGGREGATE " + KEYSPACE_PER_TEST + ".test_wrong_ks(int) "+ "SFUNC "+ shortFunctionName(fState)+ ' '+ "STYPE "+ type+ " "+ "FINALFUNC "+ shortFunctionName(fFinal)+ ' '+ "INITCOND 1");
  assertInvalidMessage("mismatched input","CREATE AGGREGATE " + KEYSPACE_PER_TEST + ".test_wrong_ks(int) "+ "SFUNC "+ fStateWrong+ ' '+ "STYPE "+ type+ " "+ "FINALFUNC "+ shortFunctionName(fFinal)+ ' '+ "INITCOND 1");
  assertInvalidMessage("missing EOF","CREATE AGGREGATE " + KEYSPACE_PER_TEST + ".test_wrong_ks(int) "+ "SFUNC "+ shortFunctionName(fState)+ ' '+ "STYPE "+ type+ " "+ "FINALFUNC "+ fFinalWrong+ ' '+ "INITCOND 1");
  assertInvalidMessage("missing EOF","CREATE AGGREGATE " + KEYSPACE_PER_TEST + ".test_wrong_ks(int) "+ "SFUNC "+ shortFunctionName(fState)+ ' '+ "STYPE "+ type+ ' '+ "FINALFUNC "+ SystemKeyspace.NAME+ ".min "+ "INITCOND 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCalledOnNullInput() throws Throwable {
  String fStateNonNull=createFunction(KEYSPACE,"int, int","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'return Integer.valueOf(state + val);';");
  String fStateNull=createFunction(KEYSPACE,"int, int","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'return Integer.valueOf("+ "   (state != null ? state.intValue() : 0) "+ "   + (val != null ? val.intValue() : 0));';");
  String fStateAlwaysNull=createFunction(KEYSPACE,"int, int","CREATE OR REPLACE FUNCTION %s(state int, val int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'return null;';");
  String fFinalNonNull=createFunction(KEYSPACE,"int","CREATE OR REPLACE FUNCTION %s(state int) " + "RETURNS NULL ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'return Integer.valueOf(state);';");
  String fFinalNull=createFunction(KEYSPACE,"int","CREATE OR REPLACE FUNCTION %s(state int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS 'return state;';");
  assertInvalid("CREATE AGGREGATE " + KEYSPACE + ".invAggr(int) "+ "SFUNC "+ shortFunctionName(fStateNonNull)+ " "+ "STYPE int");
  assertInvalid("CREATE AGGREGATE " + KEYSPACE + ".invAggr(int) "+ "SFUNC "+ shortFunctionName(fStateNonNull)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNonNull));
  String aStateNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNull) + " "+ "STYPE int");
  String aStateNullFinalNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNull));
  String aStateNullFinalNonNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNonNull));
  String aStateNonNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNonNull) + " "+ "STYPE int "+ "INITCOND 0");
  String aStateNonNullFinalNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNonNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNull)+ " "+ "INITCOND 0");
  String aStateNonNullFinalNonNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateNonNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNonNull)+ " "+ "INITCOND 0");
  String aStateAlwaysNullFinalNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateAlwaysNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNull));
  String aStateAlwaysNullFinalNonNull=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateAlwaysNull) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalNonNull));
  createTable("CREATE TABLE %s (key int PRIMARY KEY, i int)");
  execute("INSERT INTO %s (key, i) VALUES (0, null)");
  execute("INSERT INTO %s (key, i) VALUES (1, 1)");
  execute("INSERT INTO %s (key, i) VALUES (2, 2)");
  execute("INSERT INTO %s (key, i) VALUES (3, 3)");
  assertRows(execute("SELECT " + aStateNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateNullFinalNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateNullFinalNonNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateNonNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateNonNullFinalNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateNonNullFinalNonNull + "(i) FROM %s WHERE key = 0"),row(0));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNull + "(i) FROM %s WHERE key = 0"),row(new Object[]{null}));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNonNull + "(i) FROM %s WHERE key = 0"),row(new Object[]{null}));
  assertRows(execute("SELECT " + aStateNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateNullFinalNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateNullFinalNonNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateNonNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateNonNullFinalNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateNonNullFinalNonNull + "(i) FROM %s WHERE key = 1"),row(1));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNull + "(i) FROM %s WHERE key = 1"),row(new Object[]{null}));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNonNull + "(i) FROM %s WHERE key = 1"),row(new Object[]{null}));
  assertRows(execute("SELECT " + aStateNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateNullFinalNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateNullFinalNonNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateNonNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateNonNullFinalNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateNonNullFinalNonNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(6));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(new Object[]{null}));
  assertRows(execute("SELECT " + aStateAlwaysNullFinalNonNull + "(i) FROM %s WHERE key IN (1, 2, 3)"),row(new Object[]{null}));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateFailingFuncs() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'throw new RuntimeException(\"thrown to unit test - not a bug\");'");
  String fStateOK=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf(42);'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'throw new RuntimeException(\"thrown to unit test - not a bug\");'");
  String fFinalOK=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return \"foobar\";'");
  String a0=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND null");
  String a1=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateOK) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND null");
  String a2=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fStateOK) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinalOK)+ " "+ "INITCOND null");
  assertInvalidThrowMessage("java.lang.RuntimeException",FunctionExecutionException.class,"SELECT " + a0 + "(b) FROM %s");
  assertInvalidThrowMessage("java.lang.RuntimeException",FunctionExecutionException.class,"SELECT " + a1 + "(b) FROM %s");
  assertRows(execute("SELECT " + a2 + "(b) FROM %s"),row("foobar"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAggregateWithUdtFields() throws Throwable {
  String myType=createType("CREATE TYPE %s (x int)");
  createTable("CREATE TABLE %s (a int primary key, b frozen<" + myType + ">, c frozen<"+ myType+ ">)");
  assertColumnNames(execute("SELECT count(b.x), max(b.x) as max, b.x, c.x as first FROM %s"),"system.count(b.x)","max","b.x","first");
  assertRows(execute("SELECT count(b.x), max(b.x) as max, b.x, c.x as first FROM %s"),row(0L,null,null,null));
  execute("INSERT INTO %s (a, b, c) VALUES (1, {x:2}, null)");
  execute("INSERT INTO %s (a, b, c) VALUES (2, {x:4}, {x:6})");
  execute("INSERT INTO %s (a, b, c) VALUES (4, {x:8}, {x:12})");
  assertRows(execute("SELECT count(b.x), max(b.x) as max, b.x, c.x as first FROM %s"),row(3L,8,2,null));
  assertInvalidMessage("Invalid field selection: max(b) of type blob is not a user type","SELECT max(b).x as max FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregate() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal)+ " "+ "INITCOND 42");
  assertRows(execute("SELECT initcond FROM system_schema.aggregates WHERE keyspace_name=? AND aggregate_name=?",KEYSPACE,shortFunctionName(a)),row("42"));
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row("48"));
  execute("DROP AGGREGATE " + a + "(int)");
  execute("DROP FUNCTION " + fFinal + "(int)");
  execute("DROP FUNCTION " + fState + "(int, int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonExistingOnes() throws Throwable {
  assertInvalidThrowMessage("Cannot drop non existing aggregate",InvalidRequestException.class,"DROP AGGREGATE " + KEYSPACE + ".aggr_does_not_exist");
  assertInvalidThrowMessage("Cannot drop non existing aggregate",InvalidRequestException.class,"DROP AGGREGATE " + KEYSPACE + ".aggr_does_not_exist(int,text)");
  assertInvalidThrowMessage("Cannot drop non existing aggregate",InvalidRequestException.class,"DROP AGGREGATE keyspace_does_not_exist.aggr_does_not_exist");
  assertInvalidThrowMessage("Cannot drop non existing aggregate",InvalidRequestException.class,"DROP AGGREGATE keyspace_does_not_exist.aggr_does_not_exist(int,text)");
  execute("DROP AGGREGATE IF EXISTS " + KEYSPACE + ".aggr_does_not_exist");
  execute("DROP AGGREGATE IF EXISTS " + KEYSPACE + ".aggr_does_not_exist(int,text)");
  execute("DROP AGGREGATE IF EXISTS keyspace_does_not_exist.aggr_does_not_exist");
  execute("DROP AGGREGATE IF EXISTS keyspace_does_not_exist.aggr_does_not_exist(int,text)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedFunctions() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b timeuuid, c double, d double)");
  String copySign=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(magnitude double, sign double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS 'return Double.valueOf(Math.copySign(magnitude, sign));';");
  assertColumnNames(execute("SELECT max(a), max(toUnixTimestamp(b)) FROM %s"),"system.max(a)","system.max(system.tounixtimestamp(b))");
  assertRows(execute("SELECT max(a), max(toUnixTimestamp(b)) FROM %s"),row(null,null));
  assertColumnNames(execute("SELECT max(a), toUnixTimestamp(max(b)) FROM %s"),"system.max(a)","system.tounixtimestamp(system.max(b))");
  assertRows(execute("SELECT max(a), toUnixTimestamp(max(b)) FROM %s"),row(null,null));
  assertColumnNames(execute("SELECT max(" + copySign + "(c, d)) FROM %s"),"system.max(" + copySign + "(c, d))");
  assertRows(execute("SELECT max(" + copySign + "(c, d)) FROM %s"),row((Object)null));
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, maxTimeuuid('2011-02-03 04:05:00+0000'), -1.2, 2.1)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (2, maxTimeuuid('2011-02-03 04:06:00+0000'), 1.3, -3.4)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (3, maxTimeuuid('2011-02-03 04:10:00+0000'), 1.4, 1.2)");
  SimpleDateFormat format=new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");
  format.setTimeZone(TimeZone.getTimeZone("GMT"));
  Date date=format.parse("2011-02-03 04:10:00");
  date=DateUtils.truncate(date,Calendar.MILLISECOND);
  assertRows(execute("SELECT max(a), max(toUnixTimestamp(b)) FROM %s"),row(3,date.getTime()));
  assertRows(execute("SELECT max(a), toUnixTimestamp(max(b)) FROM %s"),row(3,date.getTime()));
  assertRows(execute("SELECT " + copySign + "(max(c), min(c)) FROM %s"),row(-1.4));
  assertRows(execute("SELECT " + copySign + "(c, d) FROM %s"),row(1.2),row(-1.3),row(1.4));
  assertRows(execute("SELECT max(" + copySign + "(c, d)) FROM %s"),row(1.4));
  assertRows(execute("SELECT " + copySign + "(c, max(c)) FROM %s"),row(1.2));
  assertRows(execute("SELECT " + copySign + "(max(c), c) FROM %s"),row(-1.4));
  ;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenSetType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<set<int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,set());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,set(1,2,3));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,set(4,5,6));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,set(7,8,9));
  String fState=createFunction(KEYSPACE,"set<int>","CREATE FUNCTION %s (state set<int>, values set<int>) " + "CALLED ON NULL INPUT " + "RETURNS set<int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String fFinal=createFunction(KEYSPACE,"set<int>","CREATE FUNCTION %s(state set<int>) " + "CALLED ON NULL INPUT " + "RETURNS set<int> "+ "LANGUAGE java "+ "AS 'return state;'");
  assertInvalidMessage("The function state type should not be frozen","CREATE AGGREGATE %s(set<int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE frozen<set<int>> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  String aggregation=createAggregate(KEYSPACE,"set<int>","CREATE AGGREGATE %s(set<int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE set<int> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  assertRows(execute("SELECT initcond FROM system_schema.aggregates WHERE keyspace_name=? AND aggregate_name=?",KEYSPACE,shortFunctionName(aggregation)),row((Object)null));
  assertRows(execute("SELECT " + aggregation + "(b) FROM %s"),row(set(7,8,9)));
  assertInvalidMessage("The function arguments should not be frozen","DROP AGGREGATE %s (frozen<set<int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionWithFrozenListType() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b frozen<list<int>>)");
  createIndex("CREATE INDEX ON %s (FULL(b))");
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,list());
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,list(1,2,3));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,list(4,5,6));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",3,list(7,8,9));
  String fState=createFunction(KEYSPACE,"list<int>","CREATE FUNCTION %s (state list<int>, values list<int>) " + "CALLED ON NULL INPUT " + "RETURNS list<int> "+ "LANGUAGE java\n"+ "AS 'return values;';");
  String fFinal=createFunction(KEYSPACE,"list<int>","CREATE FUNCTION %s(state list<int>) " + "CALLED ON NULL INPUT " + "RETURNS list<int> "+ "LANGUAGE java "+ "AS 'return state;'");
  assertInvalidMessage("The function state type should not be frozen","CREATE AGGREGATE %s(list<int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE frozen<list<int>> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ " "+ "INITCOND null");
  String aggregation=createAggregate(KEYSPACE,"list<int>","CREATE AGGREGATE %s(list<int>) " + "SFUNC " + parseFunctionName(fState).name + ' '+ "STYPE list<int> "+ "FINALFUNC "+ parseFunctionName(fFinal).name+ ' '+ "INITCOND null");
  assertRows(execute("SELECT " + aggregation + "(b) FROM %s"),row(list(7,8,9)));
  assertInvalidMessage("The function arguments should not be frozen","DROP AGGREGATE %s (frozen<list<int>>);");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAggregatesReferencedInAggregates() throws Throwable {
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS 'a + b;'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int ");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggInv(int) "+ "SFUNC "+ shortFunctionName(a)+ " "+ "STYPE int ");
  assertInvalidMessage("does not exist or is not a scalar function","CREATE AGGREGATE " + KEYSPACE + ".aggInv(int) "+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(a));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaAggregateNoInit() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (1, 1)");
  execute("INSERT INTO %s (a, b) VALUES (2, 2)");
  execute("INSERT INTO %s (a, b) VALUES (3, 3)");
  String fState=createFunction(KEYSPACE,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java "+ "AS 'return Integer.valueOf((a!=null?a.intValue():0) + b.intValue());'");
  String fFinal=createFunction(KEYSPACE,"int","CREATE FUNCTION %s(a int) " + "CALLED ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java "+ "AS 'return a.toString();'");
  String a=createAggregate(KEYSPACE,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int "+ "FINALFUNC "+ shortFunctionName(fFinal));
  assertRows(execute("SELECT " + a + "(b) FROM %s"),row("6"));
  execute("DROP AGGREGATE " + a + "(int)");
  assertInvalidMessage("Unknown function","SELECT " + a + "(b) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAggregateWithFunctions() throws Throwable {
  createTable("CREATE TABLE %s (a int, b double, c double, primary key(a, b))");
  String copySign=createFunction(KEYSPACE,"double, double","CREATE OR REPLACE FUNCTION %s(magnitude double, sign double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA "+ "AS 'return Double.valueOf(Math.copySign(magnitude, sign));';");
  assertColumnNames(execute("SELECT count(b), max(b) as max, " + copySign + "(b, c), "+ copySign+ "(c, b) as first FROM %s"),"system.count(b)","max",copySign + "(b, c)","first");
  assertRows(execute("SELECT count(b), max(b) as max, " + copySign + "(b, c), "+ copySign+ "(c, b) as first FROM %s"),row(0L,null,null,null));
  execute("INSERT INTO %s (a, b, c) VALUES (0, -1.2, 2.1)");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 1.3, -3.4)");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 1.4, 1.2)");
  assertRows(execute("SELECT count(b), max(b) as max, " + copySign + "(b, c), "+ copySign+ "(c, b) as first FROM %s"),row(3L,1.4,1.2,-2.1));
  execute("INSERT INTO %s (a, b, c) VALUES (1, -1.2, null)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1.3, -3.4)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1.4, 1.2)");
  assertRows(execute("SELECT count(b), max(b) as max, " + copySign + "(b, c), "+ copySign+ "(c, b) as first FROM %s WHERE a = 1"),row(3L,1.4,null,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAggregateOnCounters() throws Throwable {
  createTable("CREATE TABLE %s (a int, b counter, primary key (a))");
  assertColumnNames(execute("SELECT count(b), max(b) as max, b FROM %s"),"system.count(b)","max","b");
  assertRows(execute("SELECT count(b), max(b) as max, b FROM %s"),row(0L,null,null));
  execute("UPDATE %s SET b = b + 1 WHERE a = 1");
  execute("UPDATE %s SET b = b + 1 WHERE a = 1");
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(1L,2L,2L,2L,2L));
  flush();
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(1L,2L,2L,2L,2L));
  execute("UPDATE %s SET b = b + 2 WHERE a = 1");
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(1L,4L,4L,4L,4L));
  execute("UPDATE %s SET b = b - 2 WHERE a = 1");
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(1L,2L,2L,2L,2L));
  flush();
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(1L,2L,2L,2L,2L));
  execute("UPDATE %s SET b = b + 1 WHERE a = 2");
  execute("UPDATE %s SET b = b + 1 WHERE a = 2");
  execute("UPDATE %s SET b = b + 2 WHERE a = 2");
  assertRows(execute("SELECT count(b), max(b) as max, min(b) as min, avg(b) as avg, sum(b) as sum FROM %s"),row(2L,4L,2L,3L,6L));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.AlterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChangeStrategyWithUnquotedAgrument() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY);");
  assertInvalidSyntaxMessage("no viable alternative at input '}'","ALTER TABLE %s WITH caching = {'keys' : 'all', 'rows_per_partition' : ALL};");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropMap() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text, myCollection map<text, text>);");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', { '1' : 'first element'});");
  execute("ALTER TABLE %s DROP myCollection;");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddMap() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text);");
  execute("ALTER TABLE %s ADD myCollection map<text, text>;");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', { '1' : 'first element'});");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test",map("1","first element")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.create_alter_options_test()
 */
@Test public void testCreateAlterKeyspaces() throws Throwable {
  assertInvalidThrow(SyntaxException.class,"CREATE KEYSPACE ks1");
  assertInvalidThrow(ConfigurationException.class,"CREATE KEYSPACE ks1 WITH replication= { 'replication_factor' : 1 }");
  execute("CREATE KEYSPACE ks1 WITH replication={ 'class' : 'SimpleStrategy', 'replication_factor' : 1 }");
  execute("CREATE KEYSPACE ks2 WITH replication={ 'class' : 'SimpleStrategy', 'replication_factor' : 1 } AND durable_writes=false");
  assertRows(execute("SELECT keyspace_name, durable_writes FROM system_schema.keyspaces"),row("ks1",true),row(KEYSPACE,true),row(KEYSPACE_PER_TEST,true),row("ks2",false));
  execute("ALTER KEYSPACE ks1 WITH replication = { 'class' : 'NetworkTopologyStrategy', 'dc1' : 1 } AND durable_writes=False");
  execute("ALTER KEYSPACE ks2 WITH durable_writes=true");
  assertRows(execute("SELECT keyspace_name, durable_writes, replication FROM system_schema.keyspaces"),row("ks1",false,map("class","org.apache.cassandra.locator.NetworkTopologyStrategy","dc1","1")),row(KEYSPACE,true,map("class","org.apache.cassandra.locator.SimpleStrategy","replication_factor","1")),row(KEYSPACE_PER_TEST,true,map("class","org.apache.cassandra.locator.SimpleStrategy","replication_factor","1")),row("ks2",true,map("class","org.apache.cassandra.locator.SimpleStrategy","replication_factor","1")));
  execute("USE ks1");
  assertInvalidThrow(ConfigurationException.class,"CREATE TABLE cf1 (a int PRIMARY KEY, b int) WITH compaction = { 'min_threshold' : 4 }");
  execute("CREATE TABLE cf1 (a int PRIMARY KEY, b int) WITH compaction = { 'class' : 'SizeTieredCompactionStrategy', 'min_threshold' : 7 }");
  assertRows(execute("SELECT table_name, compaction FROM system_schema.tables WHERE keyspace_name='ks1'"),row("cf1",map("class","org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy","min_threshold","7","max_threshold","32")));
  execute("DROP KEYSPACE ks1");
  execute("DROP KEYSPACE ks2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for 7744,
 * migrated from cql_tests.py:TestCQL.downgrade_to_compact_bug_test()
 */
@Test public void testDowngradeToCompact() throws Throwable {
  createTable("create table %s (k int primary key, v set<text>)");
  execute("insert into %s (k, v) VALUES (0, {'f'})");
  flush();
  execute("alter table %s drop v");
  execute("alter table %s add v int");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterType() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text);");
  alterTable("ALTER TABLE %s ALTER content TYPE blob");
  createTable("CREATE TABLE %s (pk int, ck text, value blob, PRIMARY KEY (pk, ck)) WITH CLUSTERING ORDER BY (ck DESC)");
  alterTable("ALTER TABLE %s ALTER ck TYPE blob");
  createTable("CREATE TABLE %s (pk int, ck int, value blob, PRIMARY KEY (pk, ck))");
  assertThrowsConfigurationException("Cannot change value from type blob to type text: types are incompatible.","ALTER TABLE %s ALTER value TYPE TEXT;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * tests CASSANDRA-10027
 */
@Test public void testAlterColumnTypeToDate() throws Throwable {
  createTable("CREATE TABLE %s (key int PRIMARY KEY, c1 int);");
  execute("INSERT INTO %s (key, c1) VALUES (1,1);");
  execute("ALTER TABLE %s ALTER c1 TYPE date;");
  assertRows(execute("SELECT * FROM %s"),row(1,1));
  createTable("CREATE TABLE %s (key int PRIMARY KEY, c1 varint);");
  execute("INSERT INTO %s (key, c1) VALUES (1,1);");
  assertInvalidMessage("Cannot change c1 from type varint to type date: types are incompatible.","ALTER TABLE %s ALTER c1 TYPE date;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddList() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text);");
  execute("ALTER TABLE %s ADD myCollection list<text>;");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', ['first element']);");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test",list("first element")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropList() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text, myCollection list<text>);");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', ['first element']);");
  execute("ALTER TABLE %s DROP myCollection;");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterClusteringColumnTypeInCompactTable() throws Throwable {
  createTable("CREATE TABLE %s (key blob, column1 blob, value blob, PRIMARY KEY ((key), column1)) WITH COMPACT STORAGE");
  assertInvalidThrow(InvalidRequestException.class,"ALTER TABLE %s ALTER column1 TYPE ascii");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for bug of 5232,
 * migrated from cql_tests.py:TestCQL.alter_bug_test()
 */
@Test public void testAlterStatementWithAdd() throws Throwable {
  createTable("CREATE TABLE %s (id int PRIMARY KEY, t text)");
  execute("UPDATE %s SET t = '111' WHERE id = 1");
  execute("ALTER TABLE %s ADD l list<text>");
  assertRows(execute("SELECT * FROM %s"),row(1,null,"111"));
  execute("ALTER TABLE %s ADD m map<int, text>");
  assertRows(execute("SELECT * FROM %s"),row(1,null,null,"111"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropListAndAddMapWithSameName() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text, myCollection list<text>);");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', ['first element']);");
  execute("ALTER TABLE %s DROP myCollection;");
  assertInvalid("ALTER TABLE %s ADD myCollection map<int, int>;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleWith() throws Throwable {
  String[] stmts={"ALTER KEYSPACE WITH WITH DURABLE_WRITES = true","ALTER KEYSPACE ks WITH WITH DURABLE_WRITES = true"};
  for (  String stmt : stmts) {
    assertInvalidSyntaxMessage("no viable alternative at input 'WITH'",stmt);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableWithCompression() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","64","class","org.apache.cassandra.io.compress.LZ4Compressor")));
  execute("ALTER TABLE %s WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_in_kb' : 32 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","32","class","org.apache.cassandra.io.compress.SnappyCompressor")));
  execute("ALTER TABLE %s WITH compression = { 'sstable_compression' : 'LZ4Compressor', 'chunk_length_kb' : 64 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","64","class","org.apache.cassandra.io.compress.LZ4Compressor")));
  execute("ALTER TABLE %s WITH compression = { 'sstable_compression' : '', 'chunk_length_kb' : 32 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("enabled","false")));
  execute("ALTER TABLE %s WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_in_kb' : 32 };");
  execute("ALTER TABLE %s WITH compression = { 'enabled' : 'false'};");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("enabled","false")));
  assertThrowsConfigurationException("Missing sub-option 'class' for the 'compression' option.","ALTER TABLE %s WITH  compression = {'chunk_length_in_kb' : 32};");
  assertThrowsConfigurationException("The 'class' option must not be empty. To disable compression use 'enabled' : false","ALTER TABLE %s WITH  compression = { 'class' : ''};");
  assertThrowsConfigurationException("If the 'enabled' option is set to false no other options must be specified","ALTER TABLE %s WITH compression = { 'enabled' : 'false', 'class' : 'SnappyCompressor'};");
  assertThrowsConfigurationException("The 'sstable_compression' option must not be used if the compression algorithm is already specified by the 'class' option","ALTER TABLE %s WITH compression = { 'sstable_compression' : 'SnappyCompressor', 'class' : 'SnappyCompressor'};");
  assertThrowsConfigurationException("The 'chunk_length_kb' option must not be used if the chunk length is already specified by the 'chunk_length_in_kb' option","ALTER TABLE %s WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_kb' : 32 , 'chunk_length_in_kb' : 32 };");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropListAndAddListWithSameName() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY, content text, myCollection list<text>);");
  execute("INSERT INTO %s (id, content , myCollection) VALUES ('test', 'first test', ['first element']);");
  execute("ALTER TABLE %s DROP myCollection;");
  execute("ALTER TABLE %s ADD myCollection list<text>;");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test",null));
  execute("UPDATE %s set myCollection = ['second element'] WHERE id = 'test';");
  assertRows(execute("SELECT * FROM %s;"),row("test","first test",list("second element")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.BatchTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchRangeDelete() throws Throwable {
  createTable("CREATE TABLE %s (partitionKey int," + "clustering int," + "value int,"+ " PRIMARY KEY (partitionKey, clustering)) WITH COMPACT STORAGE");
  int value=0;
  for (int partitionKey=0; partitionKey < 4; partitionKey++)   for (int clustering1=0; clustering1 < 5; clustering1++)   execute("INSERT INTO %s (partitionKey, clustering, value) VALUES (?, ?, ?)",partitionKey,clustering1,value++);
  execute("BEGIN BATCH " + "DELETE FROM %1$s WHERE partitionKey = 1;" + "DELETE FROM %1$s WHERE partitionKey = 0 AND  clustering >= 4;"+ "DELETE FROM %1$s WHERE partitionKey = 0 AND clustering <= 0;"+ "DELETE FROM %1$s WHERE partitionKey = 2 AND clustering >= 0 AND clustering <= 3;"+ "DELETE FROM %1$s WHERE partitionKey = 2 AND clustering <= 3 AND clustering >= 4;"+ "DELETE FROM %1$s WHERE partitionKey = 3 AND (clustering) >= (3) AND (clustering) <= (6);"+ "APPLY BATCH;");
  assertRows(execute("SELECT * FROM %s"),row(0,1,1),row(0,2,2),row(0,3,3),row(2,4,14),row(3,0,15),row(3,1,16),row(3,2,17));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchEmpty() throws Throwable {
  assertEmpty(execute("BEGIN BATCH APPLY BATCH;"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchUpdate() throws Throwable {
  createTable("CREATE TABLE %s (partitionKey int," + "clustering_1 int," + "value int,"+ " PRIMARY KEY (partitionKey, clustering_1))");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 0, 0)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 1, 1)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 2, 2)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 3, 3)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 4, 4)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 5, 5)");
  execute("INSERT INTO %s (partitionKey, clustering_1, value) VALUES (0, 6, 6)");
  execute("BEGIN BATCH " + "UPDATE %1$s SET value = 7 WHERE partitionKey = 0 AND clustering_1 = 1" + "UPDATE %1$s SET value = 8 WHERE partitionKey = 0 AND (clustering_1) = (2)"+ "UPDATE %1$s SET value = 10 WHERE partitionKey = 0 AND clustering_1 IN (3, 4)"+ "UPDATE %1$s SET value = 20 WHERE partitionKey = 0 AND (clustering_1) IN ((5), (6))"+ "APPLY BATCH;");
  assertRows(execute("SELECT * FROM %s"),row(0,0,0),row(0,1,7),row(0,2,8),row(0,3,10),row(0,4,10),row(0,5,20),row(0,6,20));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchMultipleTable() throws Throwable {
  String tbl1=KEYSPACE + "." + createTableName();
  String tbl2=KEYSPACE + "." + createTableName();
  schemaChange(String.format("CREATE TABLE %s (k1 int PRIMARY KEY, v11 int, v12 int)",tbl1));
  schemaChange(String.format("CREATE TABLE %s (k2 int PRIMARY KEY, v21 int, v22 int)",tbl2));
  execute("BEGIN BATCH " + String.format("UPDATE %s SET v11 = 1 WHERE k1 = 0;",tbl1) + String.format("UPDATE %s SET v12 = 2 WHERE k1 = 0;",tbl1)+ String.format("UPDATE %s SET v21 = 3 WHERE k2 = 0;",tbl2)+ String.format("UPDATE %s SET v22 = 4 WHERE k2 = 0;",tbl2)+ "APPLY BATCH;");
  assertRows(execute(String.format("SELECT * FROM %s",tbl1)),row(0,1,2));
  assertRows(execute(String.format("SELECT * FROM %s",tbl2)),row(0,3,4));
  flush();
  assertRows(execute(String.format("SELECT * FROM %s",tbl1)),row(0,1,2));
  assertRows(execute(String.format("SELECT * FROM %s",tbl2)),row(0,3,4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test batch statements
 * migrated from cql_tests.py:TestCQL.batch_test()
 */
@Test public void testBatch() throws Throwable {
  createTable("CREATE TABLE %s (userid text PRIMARY KEY, name text, password text)");
  String query="BEGIN BATCH\n" + "INSERT INTO %1$s (userid, password, name) VALUES ('user2', 'ch@ngem3b', 'second user');\n" + "UPDATE %1$s SET password = 'ps22dhds' WHERE userid = 'user3';\n"+ "INSERT INTO %1$s (userid, password) VALUES ('user4', 'ch@ngem3c');\n"+ "DELETE name FROM %1$s WHERE userid = 'user1';\n"+ "APPLY BATCH;";
  execute(query);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s text, i int)");
  execute("BEGIN BATCH " + "INSERT INTO %1$s (k, s, i) VALUES (100, 'batchtext', 7); " + "INSERT INTO %1$s (k, s, i) VALUES (111, 'batchtext', 7); "+ "UPDATE %1$s SET s=?, i=? WHERE k = 100; "+ "UPDATE %1$s SET s=?, i=? WHERE k=111; "+ "APPLY BATCH;",null,unset(),unset(),null);
  assertRows(execute("SELECT k, s, i FROM %s where k in (100,111)"),row(100,null,7),row(111,"batchtext",null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_6115_test()
 */
@Test public void testBatchDeleteInsert() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY (k, v))");
  execute("INSERT INTO %s (k, v) VALUES (0, 1)");
  execute("BEGIN BATCH DELETE FROM %1$s WHERE k=0 AND v=1; INSERT INTO %1$s (k, v) VALUES (0, 2); APPLY BATCH");
  assertRows(execute("SELECT * FROM %s"),row(0,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.batch_and_list_test()
 */
@Test public void testBatchAndList() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, l list<int>)");
  execute("BEGIN BATCH " + "UPDATE %1$s SET l = l +[ 1 ] WHERE k = 0; " + "UPDATE %1$s SET l = l + [ 2 ] WHERE k = 0; "+ "UPDATE %1$s SET l = l + [ 3 ] WHERE k = 0; "+ "APPLY BATCH");
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list(1,2,3)));
  execute("BEGIN BATCH " + "UPDATE %1$s SET l =[ 1 ] + l WHERE k = 1; " + "UPDATE %1$s SET l = [ 2 ] + l WHERE k = 1; "+ "UPDATE %1$s SET l = [ 3 ] + l WHERE k = 1; "+ "APPLY BATCH ");
  assertRows(execute("SELECT l FROM %s WHERE k = 1"),row(list(3,2,1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.CreateTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropTriggerIfExists() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a))");
  execute("DROP TRIGGER IF EXISTS trigger_1 ON %s");
  assertTriggerDoesNotExists("trigger_1");
  execute("CREATE TRIGGER trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
  execute("DROP TRIGGER IF EXISTS trigger_1 ON %s");
  assertTriggerDoesNotExists("trigger_1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test create and drop table
 * migrated from cql_tests.py:TestCQL.table_test()
 */
@Test public void testTable() throws Throwable {
  String table1=createTable(" CREATE TABLE %s (k int PRIMARY KEY, c int)");
  createTable(" CREATE TABLE %s (k int, name int, value int, PRIMARY KEY(k, name)) WITH COMPACT STORAGE ");
  createTable(" CREATE TABLE %s (k int, c int, PRIMARY KEY (k),)");
  String table4=createTableName();
  assertInvalidMessage("Multiple definition of identifier k",String.format("CREATE TABLE %s (k int PRIMARY KEY, c int, k text)",table4));
  assertInvalidThrow(SyntaxException.class,String.format("CREATE TABLE %s (k int, name, int, c1 int, c2 int, PRIMARY KEY(k, name)) WITH COMPACT STORAGE",table4));
  execute(String.format("DROP TABLE %s.%s",keyspace(),table1));
  createTable(String.format("CREATE TABLE %s.%s ( k int PRIMARY KEY, c1 int, c2 int, ) ",keyspace(),table1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Creation and basic operations on a composite table,
 * migrated from cql_tests.py:TestCQL.sparse_cf_test()
 */
@Test public void testSparseCompositeTable() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid, posted_month int, posted_day int, body text, posted_by text, PRIMARY KEY (userid, posted_month, posted_day))");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, posted_month, posted_day, body, posted_by) VALUES (?, 1, 12, 'Something else', 'Frodo Baggins')",id1);
  execute("INSERT INTO %s (userid, posted_month, posted_day, body, posted_by) VALUES (?, 1, 24, 'Something something', 'Frodo Baggins')",id1);
  execute("UPDATE %s SET body = 'Yo Froddo', posted_by = 'Samwise Gamgee' WHERE userid = ? AND posted_month = 1 AND posted_day = 3",id2);
  execute("UPDATE %s SET body = 'Yet one more message' WHERE userid = ? AND posted_month = 1 and posted_day = 30",id1);
  assertRows(execute("SELECT body, posted_by FROM %s WHERE userid = ? AND posted_month = 1 AND posted_day = 24",id1),row("Something something","Frodo Baggins"));
  assertRows(execute("SELECT posted_day, body, posted_by FROM %s WHERE userid = ? AND posted_month = 1 AND posted_day > 12",id1),row(24,"Something something","Frodo Baggins"),row(30,"Yet one more message",null));
  assertRows(execute("SELECT posted_day, body, posted_by FROM %s WHERE userid = ? AND posted_month = 1",id1),row(12,"Something else","Frodo Baggins"),row(24,"Something something","Frodo Baggins"),row(30,"Yet one more message",null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateIndexOnCompactTableWithoutClusteringColumns() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b int) WITH COMPACT STORAGE;");
  assertInvalidMessage("Secondary indexes are not supported on PRIMARY KEY columns in COMPACT STORAGE tables","CREATE INDEX ON %s (a);");
  createIndex("CREATE INDEX ON %s (b);");
  execute("INSERT INTO %s (a, b) values (1, 1)");
  execute("INSERT INTO %s (a, b) values (2, 4)");
  execute("INSERT INTO %s (a, b) values (3, 6)");
  assertRows(execute("SELECT * FROM %s WHERE b = ?",4),row(2,4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTriggerIfNotExists() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  execute("CREATE TRIGGER IF NOT EXISTS trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
  execute("CREATE TRIGGER IF NOT EXISTS trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Creation and basic operations on a static table,
 * migrated from cql_tests.py:TestCQL.static_cf_test()
 */
@Test public void testStaticTable() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid PRIMARY KEY, firstname text, lastname text, age int)");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, firstname, lastname, age) VALUES (?, ?, ?, ?)",id1,"Frodo","Baggins",32);
  execute("UPDATE %s SET firstname = ?, lastname = ?, age = ? WHERE userid = ?","Samwise","Gamgee",33,id2);
  assertRows(execute("SELECT firstname, lastname FROM %s WHERE userid = ?",id1),row("Frodo","Baggins"));
  assertRows(execute("SELECT * FROM %s WHERE userid = ?",id1),row(id1,32,"Frodo","Baggins"));
  assertRows(execute("SELECT * FROM %s"),row(id2,33,"Samwise","Gamgee"),row(id1,32,"Frodo","Baggins"));
  String batch="BEGIN BATCH " + "INSERT INTO %1$s (userid, age) VALUES (?, ?) " + "UPDATE %1$s SET age = ? WHERE userid = ? "+ "DELETE firstname, lastname FROM %1$s WHERE userid = ? "+ "DELETE firstname, lastname FROM %1$s WHERE userid = ? "+ "APPLY BATCH";
  execute(batch,id1,36,37,id2,id1,id2);
  assertRows(execute("SELECT * FROM %s"),row(id2,37,null,null),row(id1,36,null,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test create and drop keyspace
 * migrated from cql_tests.py:TestCQL.keyspace_test()
 */
@Test public void testKeyspace() throws Throwable {
  assertInvalidThrow(SyntaxException.class,"CREATE KEYSPACE %s testXYZ ");
  execute("CREATE KEYSPACE testXYZ WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 }");
  assertInvalid("CREATE KEYSPACE My_much_much_too_long_identifier_that_should_not_work WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 }");
  execute("DROP KEYSPACE testXYZ");
  assertInvalidThrow(ConfigurationException.class,"DROP KEYSPACE non_existing");
  execute("CREATE KEYSPACE testXYZ WITH replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 }");
  execute("DROP KEYSPACE testXYZ");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check obsolete properties from CQL2 are rejected
 * migrated from cql_tests.py:TestCQL.invalid_old_property_test()
 */
@Test public void testObsoleteTableProperties() throws Throwable {
  assertInvalidThrow(SyntaxException.class,"CREATE TABLE test (foo text PRIMARY KEY, c int) WITH default_validation=timestamp");
  createTable("CREATE TABLE %s (foo text PRIMARY KEY, c int)");
  assertInvalidThrow(SyntaxException.class,"ALTER TABLE %s WITH default_validation=int");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multiordering_validation_test()
 */
@Test public void testMultiOrderingValidation() throws Throwable {
  String tableName=KEYSPACE + "." + createTableName();
  assertInvalid(String.format("CREATE TABLE test (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c2 DESC)",tableName));
  tableName=KEYSPACE + "." + createTableName();
  assertInvalid(String.format("CREATE TABLE test (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c2 ASC, c1 DESC)",tableName));
  tableName=KEYSPACE + "." + createTableName();
  assertInvalid(String.format("CREATE TABLE test (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c1 DESC, c2 DESC, c3 DESC)",tableName));
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c1 DESC, c2 DESC)");
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c1 ASC, c2 DESC)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Creation and basic operations on a composite table with compact storage,
 * migrated from cql_tests.py:TestCQL.dense_cf_test()
 */
@Test public void testDenseCompositeTable() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid, ip text, port int, time bigint, PRIMARY KEY (userid, ip, port)) WITH COMPACT STORAGE");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, ip, port, time) VALUES (?, '192.168.0.1', 80, 42)",id1);
  execute("INSERT INTO %s (userid, ip, port, time) VALUES (?, '192.168.0.2', 80, 24)",id1);
  execute("INSERT INTO %s (userid, ip, port, time) VALUES (?, '192.168.0.2', 90, 42)",id1);
  execute("UPDATE %s SET time = 24 WHERE userid = ? AND ip = '192.168.0.2' AND port = 80",id2);
  execute("INSERT INTO %s (userid, ip, time) VALUES (?, '192.168.0.3', 42)",id2);
  execute("UPDATE %s SET time = 42 WHERE userid = ? AND ip = '192.168.0.4'",id2);
  assertRows(execute("SELECT ip, port, time FROM %s WHERE userid = ?",id1),row("192.168.0.1",80,42L),row("192.168.0.2",80,24L),row("192.168.0.2",90,42L));
  assertRows(execute("SELECT ip, port, time FROM %s WHERE userid = ? and ip >= '192.168.0.2'",id1),row("192.168.0.2",80,24L),row("192.168.0.2",90,42L));
  assertRows(execute("SELECT ip, port, time FROM %s WHERE userid = ? and ip = '192.168.0.2'",id1),row("192.168.0.2",80,24L),row("192.168.0.2",90,42L));
  assertEmpty(execute("SELECT ip, port, time FROM %s WHERE userid = ? and ip > '192.168.0.2'",id1));
  assertRows(execute("SELECT ip, port, time FROM %s WHERE userid = ? AND ip = '192.168.0.3'",id2),row("192.168.0.3",null,42L));
  assertRows(execute("SELECT ip, port, time FROM %s WHERE userid = ? AND ip = '192.168.0.4'",id2),row("192.168.0.4",null,42L));
  execute("DELETE time FROM %s WHERE userid = ? AND ip = '192.168.0.2' AND port = 80",id1);
  assertRowCount(execute("SELECT * FROM %s WHERE userid = ?",id1),2);
  execute("DELETE FROM %s WHERE userid = ?",id1);
  assertEmpty(execute("SELECT * FROM %s WHERE userid = ?",id1));
  execute("DELETE FROM %s WHERE userid = ? AND ip = '192.168.0.3'",id2);
  assertEmpty(execute("SELECT * FROM %s WHERE userid = ? AND ip = '192.168.0.3'",id2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test truncate statement,
 * migrated from cql_tests.py:TestCQL.table_test().
 */
@Test public void testTruncate() throws Throwable {
  createTable(" CREATE TABLE %s (k int, name int, value int, PRIMARY KEY(k, name)) WITH COMPACT STORAGE ");
  execute("TRUNCATE %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Creation and basic operations on a non-composite table with compact storage,
 * migrated from cql_tests.py:TestCQL.dynamic_cf_test()
 */
@Test public void testDenseNonCompositeTable() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid, url text, time bigint, PRIMARY KEY (userid, url)) WITH COMPACT STORAGE");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  UUID id3=UUID.fromString("810e8500-e29b-41d4-a716-446655440000");
  execute("INSERT INTO %s (userid, url, time) VALUES (?, ?, ?)",id1,"http://foo.bar",42L);
  execute("INSERT INTO %s (userid, url, time) VALUES (?, ?, ?)",id1,"http://foo-2.bar",24L);
  execute("INSERT INTO %s (userid, url, time) VALUES (?, ?, ?)",id1,"http://bar.bar",128L);
  execute("UPDATE %s SET time = 24 WHERE userid = ? and url = 'http://bar.foo'",id2);
  execute("UPDATE %s SET time = 12 WHERE userid IN (?, ?) and url = 'http://foo-3'",id2,id1);
  assertRows(execute("SELECT url, time FROM %s WHERE userid = ?",id1),row("http://bar.bar",128L),row("http://foo-2.bar",24L),row("http://foo-3",12L),row("http://foo.bar",42L));
  assertRows(execute("SELECT * FROM %s WHERE userid = ?",id2),row(id2,"http://bar.foo",24L),row(id2,"http://foo-3",12L));
  assertRows(execute("SELECT time FROM %s"),row(24L),row(12L),row(128L),row(24L),row(12L),row(42L));
  assertInvalid("INSERT INTO %s (userid, url, time) VALUES (?, '', 42)",id3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithCompression() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","64","class","org.apache.cassandra.io.compress.LZ4Compressor")));
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_in_kb' : 32 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","32","class","org.apache.cassandra.io.compress.SnappyCompressor")));
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_in_kb' : 32, 'enabled' : true };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","32","class","org.apache.cassandra.io.compress.SnappyCompressor")));
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'sstable_compression' : 'SnappyCompressor', 'chunk_length_kb' : 32 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("chunk_length_in_kb","32","class","org.apache.cassandra.io.compress.SnappyCompressor")));
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'sstable_compression' : '', 'chunk_length_kb' : 32 };");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("enabled","false")));
  createTable("CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'enabled' : 'false'};");
  assertRows(execute(format("SELECT compression FROM %s.%s WHERE keyspace_name = ? and table_name = ?;",SchemaKeyspace.NAME,SchemaKeyspace.TABLES),KEYSPACE,currentTable()),row(map("enabled","false")));
  assertThrowsConfigurationException("Missing sub-option 'class' for the 'compression' option.","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = {'chunk_length_in_kb' : 32};");
  assertThrowsConfigurationException("The 'class' option must not be empty. To disable compression use 'enabled' : false","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'class' : ''};");
  assertThrowsConfigurationException("If the 'enabled' option is set to false no other options must be specified","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'enabled' : 'false', 'class' : 'SnappyCompressor'};");
  assertThrowsConfigurationException("If the 'enabled' option is set to false no other options must be specified","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'enabled' : 'false', 'chunk_length_in_kb' : 32};");
  assertThrowsConfigurationException("The 'sstable_compression' option must not be used if the compression algorithm is already specified by the 'class' option","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'sstable_compression' : 'SnappyCompressor', 'class' : 'SnappyCompressor'};");
  assertThrowsConfigurationException("The 'chunk_length_kb' option must not be used if the chunk length is already specified by the 'chunk_length_in_kb' option","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'class' : 'SnappyCompressor', 'chunk_length_kb' : 32 , 'chunk_length_in_kb' : 32 };");
  assertThrowsConfigurationException("Unknown compression options unknownOption","CREATE TABLE %s (a text, b int, c int, primary key (a, b))" + " WITH compression = { 'class' : 'SnappyCompressor', 'unknownOption' : 32 };");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropTrigger() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a))");
  execute("CREATE TRIGGER trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
  execute("DROP TRIGGER trigger_1 ON %s");
  assertTriggerDoesNotExists("trigger_1");
  execute("CREATE TRIGGER trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
  assertInvalid("DROP TRIGGER trigger_2 ON %s");
  execute("CREATE TRIGGER \"Trigger 3\" ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("Trigger 3");
  execute("DROP TRIGGER \"Trigger 3\" ON %s");
  assertTriggerDoesNotExists("Trigger 3");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTinyintColumns() throws Throwable {
  createTable("CREATE TABLE %s (a text, b tinyint, c tinyint, primary key (a, b));");
  execute("INSERT INTO %s (a, b, c) VALUES ('1', 1, 2)");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","2",Byte.MAX_VALUE,Byte.MIN_VALUE);
  assertRows(execute("SELECT * FROM %s"),row("2",Byte.MAX_VALUE,Byte.MIN_VALUE),row("1",(byte)1,(byte)2));
  assertInvalidMessage("Expected 1 byte for a tinyint (4)","INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","3",1,2);
  assertInvalidMessage("Expected 1 byte for a tinyint (0)","INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","3",(byte)1,ByteBufferUtil.EMPTY_BYTE_BUFFER);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Creation and basic operations on a static table with compact storage,
 * migrated from cql_tests.py:TestCQL.noncomposite_static_cf_test()
 */
@Test public void testDenseStaticTable() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid PRIMARY KEY, firstname text, lastname text, age int) WITH COMPACT STORAGE");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, firstname, lastname, age) VALUES (?, ?, ?, ?)",id1,"Frodo","Baggins",32);
  execute("UPDATE %s SET firstname = ?, lastname = ?, age = ? WHERE userid = ?","Samwise","Gamgee",33,id2);
  assertRows(execute("SELECT firstname, lastname FROM %s WHERE userid = ?",id1),row("Frodo","Baggins"));
  assertRows(execute("SELECT * FROM %s WHERE userid = ?",id1),row(id1,32,"Frodo","Baggins"));
  assertRows(execute("SELECT * FROM %s"),row(id2,33,"Samwise","Gamgee"),row(id1,32,"Frodo","Baggins"));
  String batch="BEGIN BATCH " + "INSERT INTO %1$s (userid, age) VALUES (?, ?) " + "UPDATE %1$s SET age = ? WHERE userid = ? "+ "DELETE firstname, lastname FROM %1$s WHERE userid = ? "+ "DELETE firstname, lastname FROM %1$s WHERE userid = ? "+ "APPLY BATCH";
  execute(batch,id1,36,37,id2,id1,id2);
  assertRows(execute("SELECT * FROM %s"),row(id2,37,null,null),row(id1,36,null,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check invalid create table statements,
 * migrated from cql_tests.py:TestCQL.create_invalid_test()
 */
@Test public void testInvalidCreateTableStatements() throws Throwable {
  assertInvalidThrow(SyntaxException.class,"CREATE TABLE test ()");
  assertInvalid("CREATE TABLE test (c1 text, c2 text, c3 text)");
  assertInvalid("CREATE TABLE test (key1 text PRIMARY KEY, key2 text PRIMARY KEY)");
  assertInvalid("CREATE TABLE test (key text PRIMARY KEY, key int)");
  assertInvalid("CREATE TABLE test (key text PRIMARY KEY, c int, c text)");
  assertInvalid("CREATE TABLE test (key text, key2 text, c int, d text, PRIMARY KEY (key, key2)) WITH COMPACT STORAGE");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleWith() throws Throwable {
  String[] stmts={"CREATE KEYSPACE WITH WITH DURABLE_WRITES = true","CREATE KEYSPACE ks WITH WITH DURABLE_WRITES = true"};
  for (  String stmt : stmts)   assertInvalidSyntaxMessage("no viable alternative at input 'WITH'",stmt);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithSmallintColumns() throws Throwable {
  createTable("CREATE TABLE %s (a text, b smallint, c smallint, primary key (a, b));");
  execute("INSERT INTO %s (a, b, c) VALUES ('1', 1, 2)");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","2",Short.MAX_VALUE,Short.MIN_VALUE);
  assertRows(execute("SELECT * FROM %s"),row("2",Short.MAX_VALUE,Short.MIN_VALUE),row("1",(short)1,(short)2));
  assertInvalidMessage("Expected 2 bytes for a smallint (4)","INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","3",1,2);
  assertInvalidMessage("Expected 2 bytes for a smallint (0)","INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","3",(short)1,ByteBufferUtil.EMPTY_BYTE_BUFFER);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTrigger() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a))");
  execute("CREATE TRIGGER trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_1");
  execute("CREATE TRIGGER trigger_2 ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("trigger_2");
  assertInvalid("CREATE TRIGGER trigger_1 ON %s USING '" + TestTrigger.class.getName() + "'");
  execute("CREATE TRIGGER \"Trigger 3\" ON %s USING '" + TestTrigger.class.getName() + "'");
  assertTriggerExists("Trigger 3");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateIndexOnCompactTableWithClusteringColumns() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int , c int, PRIMARY KEY (a, b)) WITH COMPACT STORAGE;");
  assertInvalidMessage("Secondary indexes are not supported on COMPACT STORAGE tables that have clustering columns","CREATE INDEX ON %s (a);");
  assertInvalidMessage("Secondary indexes are not supported on COMPACT STORAGE tables that have clustering columns","CREATE INDEX ON %s (b);");
  assertInvalidMessage("Secondary indexes are not supported on COMPACT STORAGE tables that have clustering columns","CREATE INDEX ON %s (c);");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.DeleteTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithRangeAndOneClusteringColumn() throws Throwable {
  testDeleteWithRangeAndOneClusteringColumn(false);
  testDeleteWithRangeAndOneClusteringColumn(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithOnlyPK() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY (k, v)) WITH gc_grace_seconds=1");
  execute("INSERT INTO %s(k, v) VALUES (?, ?)",1,2);
  execute("DELETE FROM %s WHERE k = ? AND v = ?",1,2);
  execute("INSERT INTO %s(k, v) VALUES (?, ?)",2,3);
  Thread.sleep(500);
  execute("DELETE FROM %s WHERE k = ? AND v = ?",2,3);
  execute("INSERT INTO %s(k, v) VALUES (?, ?)",1,2);
  Thread.sleep(500);
  flush();
  assertRows(execute("SELECT * FROM %s"),row(1,2));
  Thread.sleep(1000);
  compact();
  assertRows(execute("SELECT * FROM %s"),row(1,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithNoClusteringColumns() throws Throwable {
  testDeleteWithNoClusteringColumns(false);
  testDeleteWithNoClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.remove_range_slice_test()
 */
@Test public void testRemoveRangeSlice() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int)");
  for (int i=0; i < 3; i++)   execute("INSERT INTO %s (k, v) VALUES (?, ?)",i,i);
  execute("DELETE FROM %s WHERE k = 1");
  assertRows(execute("SELECT * FROM %s"),row(0,0),row(2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithAStaticColumn() throws Throwable {
  testDeleteWithAStaticColumn(false);
  testDeleteWithAStaticColumn(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithRangeAndTwoClusteringColumns() throws Throwable {
  testDeleteWithRangeAndTwoClusteringColumns(false);
  testDeleteWithRangeAndTwoClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithTwoClusteringColumns() throws Throwable {
  testDeleteWithTwoClusteringColumns(false);
  testDeleteWithTwoClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.range_with_deletes_test()
 */
@Test public void testRandomDeletions() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int,)");
  int nb_keys=30;
  int nb_deletes=5;
  List<Integer> deletions=new ArrayList<>(nb_keys);
  for (int i=0; i < nb_keys; i++) {
    execute("INSERT INTO %s (k, v) VALUES (?, ?)",i,i);
    deletions.add(i);
  }
  Collections.shuffle(deletions);
  for (int i=0; i < nb_deletes; i++)   execute("DELETE FROM %s WHERE k = ?",deletions.get(i));
  assertRowCount(execute("SELECT * FROM %s LIMIT ?",(nb_keys / 2)),nb_keys / 2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CASSANDRA-8558, deleted row still can be selected out
 * migrated from cql_tests.py:TestCQL.bug_8558_test()
 */
@Test public void testDeletedRowCannotBeSelected() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c text,primary key(a,b))");
  execute("INSERT INTO %s (a,b,c) VALUES(1,1,'1')");
  flush();
  execute("DELETE FROM %s  where a=1 and b=1");
  flush();
  assertEmpty(execute("select * from %s  where a=1 and b=1"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithOneClusteringColumns() throws Throwable {
  testDeleteWithOneClusteringColumns(false);
  testDeleteWithOneClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test simple deletion and in particular check for #4193 bug
 * migrated from cql_tests.py:TestCQL.deletion_test()
 */
@Test public void testDeletion() throws Throwable {
  createTable("CREATE TABLE %s (username varchar, id int, name varchar, stuff varchar, PRIMARY KEY(username, id))");
  execute("INSERT INTO %s (username, id, name, stuff) VALUES (?, ?, ?, ?)","abc",2,"rst","some value");
  execute("INSERT INTO %s (username, id, name, stuff) VALUES (?, ?, ?, ?)","abc",4,"xyz","some other value");
  assertRows(execute("SELECT * FROM %s"),row("abc",2,"rst","some value"),row("abc",4,"xyz","some other value"));
  execute("DELETE FROM %s WHERE username='abc' AND id=2");
  assertRows(execute("SELECT * FROM %s"),row("abc",4,"xyz","some other value"));
  createTable("CREATE TABLE %s (username varchar, id int, name varchar, stuff varchar, PRIMARY KEY(username, id, name)) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (username, id, name, stuff) VALUES (?, ?, ?, ?)","abc",2,"rst","some value");
  execute("INSERT INTO %s (username, id, name, stuff) VALUES (?, ?, ?, ?)","abc",4,"xyz","some other value");
  assertRows(execute("SELECT * FROM %s"),row("abc",2,"rst","some value"),row("abc",4,"xyz","some other value"));
  execute("DELETE FROM %s WHERE username='abc' AND id=2");
  assertRows(execute("SELECT * FROM %s"),row("abc",4,"xyz","some other value"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check the semantic of CQL row existence (part of #4361),
 * migrated from cql_tests.py:TestCQL.row_existence_test()
 */
@Test public void testRowExistence() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v1 int, v2 int, PRIMARY KEY (k, c))");
  execute("INSERT INTO %s (k, c, v1, v2) VALUES (1, 1, 1, 1)");
  assertRows(execute("SELECT * FROM %s"),row(1,1,1,1));
  assertInvalid("DELETE c FROM %s WHERE k = 1 AND c = 1");
  execute("DELETE v2 FROM %s WHERE k = 1 AND c = 1");
  assertRows(execute("SELECT * FROM %s"),row(1,1,1,null));
  execute("DELETE v1 FROM %s WHERE k = 1 AND c = 1");
  assertRows(execute("SELECT * FROM %s"),row(1,1,null,null));
  execute("DELETE FROM %s WHERE k = 1 AND c = 1");
  assertEmpty(execute("SELECT * FROM %s"));
  execute("INSERT INTO %s (k, c) VALUES (2, 2)");
  assertRows(execute("SELECT * FROM %s"),row(2,2,null,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for cassandra 8558 
 */
@Test public void testRangeDeletion() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,1,1,1);
  flush();
  execute("DELETE FROM %s WHERE a=? AND b=?",1,1);
  flush();
  assertEmpty(execute("SELECT * FROM %s WHERE a=? AND b=? AND c=?",1,1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithSecondaryIndices() throws Throwable {
  testDeleteWithSecondaryIndices(false);
  testDeleteWithSecondaryIndices(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test deletion of rows
 * migrated from cql_tests.py:TestCQL.delete_row_test()
 */
@Test public void testRowDeletion() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v1 int, v2 int, PRIMARY KEY (k, c1, c2))");
  execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",0,0,0,0,0);
  execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",0,0,1,1,1);
  execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",0,0,2,2,2);
  execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",0,1,0,3,3);
  execute("DELETE FROM %s WHERE k = 0 AND c1 = 0 AND c2 = 0");
  assertRowCount(execute("SELECT * FROM %s"),3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.DropRecreateAndRestoreTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testCreateWithIdInvalid() throws Throwable {
  createTableMayThrow(String.format("CREATE TABLE %%s (a int, b int, c int, PRIMARY KEY(a, b)) WITH ID = %s",55));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AlreadyExistsException.class) public void testCreateWithIdDuplicate() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY(a, b))");
  UUID id=currentTableMetadata().cfId;
  execute(String.format("CREATE TABLE %%s (a int, b int, c int, PRIMARY KEY(a, b)) WITH ID = %s",id));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testAlterWithId() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY(a, b))");
  UUID id=currentTableMetadata().cfId;
  execute(String.format("ALTER TABLE %%s WITH ID = %s",id));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateWithIdRestore() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY(a, b))");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
  long time=System.currentTimeMillis();
  UUID id=currentTableMetadata().cfId;
  assertRows(execute("SELECT * FROM %s"),row(0,0,0),row(0,1,1));
  Thread.sleep(5);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,0,2);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,3);
  assertRows(execute("SELECT * FROM %s"),row(1,0,2),row(1,1,3),row(0,0,0),row(0,1,1));
  List<String> segments=CommitLog.instance.getActiveSegmentNames();
  File logPath=new File(DatabaseDescriptor.getCommitLogLocation());
  for (  String segment : segments)   FileUtils.createHardLink(new File(logPath,segment),new File(logPath,segment + ".save"));
  execute("DROP TABLE %s");
  assertInvalidThrow(InvalidRequestException.class,"SELECT * FROM %s");
  execute(String.format("CREATE TABLE %%s (a int, b int, c int, PRIMARY KEY(a, b)) WITH ID = %s",id));
  for (  String segment : segments)   FileUtils.renameWithConfirm(new File(logPath,segment + ".save"),new File(logPath,segment));
  try {
    CommitLog.instance.archiver.restorePointInTime=time;
    CommitLog.instance.resetUnsafe(false);
  }
  finally {
    CommitLog.instance.archiver.restorePointInTime=Long.MAX_VALUE;
  }
  assertRows(execute("SELECT * FROM %s"),row(0,0,0),row(0,1,1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.DropTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonExistingOnes() throws Throwable {
  assertInvalidMessage("Cannot drop non existing table","DROP TABLE " + KEYSPACE + ".table_does_not_exist");
  assertInvalidMessage("Cannot drop table in unknown keyspace","DROP TABLE keyspace_does_not_exist.table_does_not_exist");
  execute("DROP TABLE IF EXISTS " + KEYSPACE + ".table_does_not_exist");
  execute("DROP TABLE IF EXISTS keyspace_does_not_exist.table_does_not_exist");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.InsertTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertTtlWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, i int)");
  execute("INSERT INTO %s (k, i) VALUES (1, 1) USING TTL ?",unset());
  assertRows(execute("SELECT ttl(i) FROM %s"),row(new Object[]{null}));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s text, i int)");
  execute("INSERT INTO %s (k, s, i) VALUES (10, ?, ?)","text",10);
  execute("INSERT INTO %s (k, s, i) VALUES (10, ?, ?)",null,null);
  assertRows(execute("SELECT s, i FROM %s WHERE k = 10"),row(null,null));
  execute("INSERT INTO %s (k, s, i) VALUES (11, ?, ?)","text",10);
  execute("INSERT INTO %s (k, s, i) VALUES (11, ?, ?)",unset(),unset());
  assertRows(execute("SELECT s, i FROM %s WHERE k=11"),row("text",10));
  assertInvalidMessage("Invalid unset value for column k","UPDATE %s SET i = 0 WHERE k = ?",unset());
  assertInvalidMessage("Invalid unset value for column k","DELETE FROM %s WHERE k = ?",unset());
  assertInvalidMessage("Invalid unset value for argument in call to function blobasint","SELECT * FROM %s WHERE k = blobAsInt(?)",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertWithTwoClusteringColumns() throws Throwable {
  testInsertWithTwoClusteringColumns(false);
  testInsertWithTwoClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsert() throws Throwable {
  testInsert(false);
  testInsert(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertWithAStaticColumn() throws Throwable {
  testInsertWithAStaticColumn(false);
  testInsertWithAStaticColumn(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertWithCompactStorageAndTwoClusteringColumns() throws Throwable {
  testInsertWithCompactStorageAndTwoClusteringColumns(false);
  testInsertWithCompactStorageAndTwoClusteringColumns(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertWithCompactFormat() throws Throwable {
  testInsertWithCompactFormat(false);
  testInsertWithCompactFormat(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.static_columns_cas_test()
 */
@Test public void testStaticColumnsCas() throws Throwable {
  createTable("CREATE TABLE %s (id int, k text, version int static, v text, PRIMARY KEY (id, k))");
  execute("INSERT INTO %s (id, k, v) VALUES (1, 'foo', 'foo')");
  assertRows(execute("INSERT INTO %s (id, k, version) VALUES (1, 'foo', 1) IF NOT EXISTS"),row(false,1,"foo",null,"foo"));
  assertRows(execute("INSERT INTO %s (id, version) VALUES (1, 1) IF NOT EXISTS"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(1,"foo",1,"foo"));
  execute("DELETE FROM %s WHERE id = 1");
  execute("INSERT INTO %s(id, version) VALUES (0, 0)");
  assertRows(execute("UPDATE %s SET v='foo', version=1 WHERE id=0 AND k='k1' IF version = 0"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,"k1",1,"foo"));
  assertRows(execute("UPDATE %s SET v='bar', version=1 WHERE id=0 AND k='k2' IF version = 0"),row(false,1));
  assertRows(execute("SELECT * FROM %s"),row(0,"k1",1,"foo"));
  assertRows(execute("UPDATE %s SET v='bar', version=2 WHERE id=0 AND k='k2' IF version = 1"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,"k1",2,"foo"),row(0,"k2",2,"bar"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET v='foobar' WHERE id=0 AND k='k1'; " + "UPDATE %1$s SET v='barfoo' WHERE id=0 AND k='k2'; "+ "UPDATE %1$s SET version=3 WHERE id=0 IF version=1; "+ "APPLY BATCH "),row(false,0,null,2));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET v = 'foobar' WHERE id = 0 AND k = 'k1'; " + "UPDATE %1$s SET v = 'barfoo' WHERE id = 0 AND k = 'k2'; "+ "UPDATE %1$s SET version = 3 WHERE id = 0 IF version = 2; "+ "APPLY BATCH "),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,"k1",3,"foobar"),row(0,"k2",3,"barfoo"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET version = 4 WHERE id = 0 IF version = 3; " + "UPDATE %1$s SET v='row1' WHERE id=0 AND k='k1' IF v='foo'; "+ "UPDATE %1$s SET v='row2' WHERE id=0 AND k='k2' IF v='bar'; "+ "APPLY BATCH "),row(false,0,"k1",3,"foobar"),row(false,0,"k2",3,"barfoo"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET version = 4 WHERE id = 0 IF version = 3; " + "UPDATE %1$s SET v='row1' WHERE id = 0 AND k='k1' IF v='foobar'; "+ "UPDATE %1$s SET v='row2' WHERE id = 0 AND k='k2' IF v='barfoo'; "+ "APPLY BATCH "),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,"k1",4,"row1"),row(0,"k2",4,"row2"));
  assertInvalid("BEGIN BATCH " + "UPDATE %1$s SET version=5 WHERE id=0 IF version=4; " + "UPDATE %1$s SET v='row1' WHERE id=0 AND k='k1'; "+ "UPDATE %1$s SET v='row2' WHERE id=1 AND k='k2'; "+ "APPLY BATCH ");
  assertRows(execute("BEGIN BATCH " + "INSERT INTO %1$s (id, k, v) VALUES (1, 'k1', 'val1') IF NOT EXISTS; " + "INSERT INTO %1$s (id, k, v) VALUES (1, 'k2', 'val2') IF NOT EXISTS; "+ "APPLY BATCH "),row(true));
  assertRows(execute("SELECT * FROM %s WHERE id=1"),row(1,"k1",null,"val1"),row(1,"k2",null,"val2"));
  assertRows(execute("INSERT INTO %s (id, k, v) VALUES (1, 'k2', 'val2') IF NOT EXISTS"),row(false,1,"k2",null,"val2"));
  assertRows(execute("BEGIN BATCH " + "INSERT INTO %1$s (id, k, v) VALUES (1, 'k2', 'val2') IF NOT EXISTS; " + "INSERT INTO %1$s (id, k, v) VALUES (1, 'k3', 'val3') IF NOT EXISTS; "+ "APPLY BATCH"),row(false,1,"k2",null,"val2"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET v = 'newVal' WHERE id = 1 AND k = 'k2' IF v = 'val0'; " + "INSERT INTO %1$s (id, k, v) VALUES (1, 'k3', 'val3') IF NOT EXISTS; "+ "APPLY BATCH"),row(false,1,"k2",null,"val2"));
  assertRows(execute("SELECT * FROM %s WHERE id=1"),row(1,"k1",null,"val1"),row(1,"k2",null,"val2"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET v = 'newVal' WHERE id = 1 AND k = 'k2' IF v = 'val2'; " + "INSERT INTO %1$s (id, k, v, version) VALUES(1, 'k3', 'val3', 1) IF NOT EXISTS; "+ "APPLY BATCH"),row(true));
  assertRows(execute("SELECT * FROM %s WHERE id=1"),row(1,"k1",1,"val1"),row(1,"k2",1,"newVal"),row(1,"k3",1,"val3"));
  assertRows(execute("BEGIN BATCH " + "UPDATE %1$s SET v = 'newVal1' WHERE id = 1 AND k = 'k2' IF v = 'val2'; " + "UPDATE %1$s SET v = 'newVal2' WHERE id = 1 AND k = 'k2' IF v = 'val3'; "+ "APPLY BATCH"),row(false,1,"k2","newVal"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_ddl_keyspace_test()
 */
@Test public void testDropCreateKeyspaceIfNotExists() throws Throwable {
  String keyspace=KEYSPACE_PER_TEST;
  dropPerTestKeyspace();
  dropPerTestKeyspace();
  schemaChange("CREATE KEYSPACE IF NOT EXISTS " + keyspace + " WITH replication = { 'class':'SimpleStrategy', 'replication_factor':1} and durable_writes = true ");
  assertRows(execute(format("select durable_writes from %s.%s where keyspace_name = ?",SchemaKeyspace.NAME,SchemaKeyspace.KEYSPACES),keyspace),row(true));
  schemaChange("CREATE KEYSPACE IF NOT EXISTS " + keyspace + " WITH replication = {'class':'SimpleStrategy', 'replication_factor':1} and durable_writes = false ");
  assertRows(execute(format("select durable_writes from %s.%s where keyspace_name = ?",SchemaKeyspace.NAME,SchemaKeyspace.KEYSPACES),keyspace),row(true));
  schemaChange("DROP KEYSPACE IF EXISTS " + keyspace);
  assertEmpty(execute(format("select * from %s.%s where keyspace_name = ?",SchemaKeyspace.NAME,SchemaKeyspace.KEYSPACES),keyspace));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.map_item_conditional_test()
 */
@Test public void testMapItem() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, m %s)",frozen ? "frozen<map<text, text>>" : "map<text, text>"));
    execute("INSERT INTO %s (k, m) VALUES (0, {'foo' : 'bar'})");
    assertInvalid("DELETE FROM %s WHERE k=0 IF m[null] = 'foo'");
    assertRows(execute("DELETE FROM %s WHERE k=0 IF m['foo'] = 'foo'"),row(false,map("foo","bar")));
    assertRows(execute("DELETE FROM %s WHERE k=0 IF m['foo'] = null"),row(false,map("foo","bar")));
    assertRows(execute("SELECT * FROM %s"),row(0,map("foo","bar")));
    assertRows(execute("DELETE FROM %s WHERE k=0 IF m['foo'] = 'bar'"),row(true));
    assertEmpty(execute("SELECT * FROM %s"));
    execute("INSERT INTO %s(k, m) VALUES (1, null)");
    if (frozen)     assertInvalid("UPDATE %s set m['foo'] = 'bar', m['bar'] = 'foo' WHERE k = 1 IF m['foo'] IN ('blah', null)");
 else     assertRows(execute("UPDATE %s set m['foo'] = 'bar', m['bar'] = 'foo' WHERE k = 1 IF m['foo'] IN ('blah', null)"),row(true));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.whole_list_conditional_test()
 */
@Test public void testWholeList() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, l %s)",frozen ? "frozen<list<text>>" : "list<text>"));
    execute("INSERT INTO %s(k, l) VALUES (0, ['foo', 'bar', 'foobar'])");
    check_applies_list("l = ['foo', 'bar', 'foobar']");
    check_applies_list("l != ['baz']");
    check_applies_list("l > ['a']");
    check_applies_list("l >= ['a']");
    check_applies_list("l < ['z']");
    check_applies_list("l <= ['z']");
    check_applies_list("l IN (null, ['foo', 'bar', 'foobar'], ['a'])");
    check_applies_list("l > ['aaa', 'bbb'] AND l > ['aaa']");
    check_applies_list("l != null AND l IN (['foo', 'bar', 'foobar'])");
    check_does_not_apply_list("l = ['baz']");
    check_does_not_apply_list("l != ['foo', 'bar', 'foobar']");
    check_does_not_apply_list("l > ['z']");
    check_does_not_apply_list("l >= ['z']");
    check_does_not_apply_list("l < ['a']");
    check_does_not_apply_list("l <= ['a']");
    check_does_not_apply_list("l IN (['a'], null)");
    check_does_not_apply_list("l IN ()");
    check_does_not_apply_list("l IN () AND l IN (['foo', 'bar', 'foobar'])");
    check_does_not_apply_list("l > ['zzz'] AND l < ['zzz']");
    check_invalid_list("l = [null]",InvalidRequestException.class);
    check_invalid_list("l < null",InvalidRequestException.class);
    check_invalid_list("l <= null",InvalidRequestException.class);
    check_invalid_list("l > null",InvalidRequestException.class);
    check_invalid_list("l >= null",InvalidRequestException.class);
    check_invalid_list("l IN null",SyntaxException.class);
    check_invalid_list("l IN 367",SyntaxException.class);
    check_invalid_list("l CONTAINS KEY 123",SyntaxException.class);
    check_invalid_list("m CONTAINS 'bar'",SyntaxException.class);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_delete_test()
 */
@Test public void testConditionalDelete() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v1 int,)");
  assertRows(execute("DELETE FROM %s WHERE k=1 IF EXISTS"),row(false));
  execute("INSERT INTO %s (k, v1) VALUES (1, 2)");
  assertRows(execute("DELETE FROM %s WHERE k=1 IF EXISTS"),row(true));
  assertEmpty(execute("SELECT * FROM %s WHERE k=1"));
  assertRows(execute("DELETE FROM %s WHERE k=1 IF EXISTS"),row(false));
  execute("UPDATE %s USING TTL 1 SET v1=2 WHERE k=1");
  Thread.sleep(1001);
  assertRows(execute("DELETE FROM %s WHERE k=1 IF EXISTS"),row(false));
  assertEmpty(execute("SELECT * FROM %s WHERE k=1"));
  execute("INSERT INTO %s (k, v1) VALUES (2, 2) USING TTL 1");
  Thread.sleep(1001);
  assertRows(execute("DELETE FROM %s WHERE k=2 IF EXISTS"),row(false));
  assertEmpty(execute("SELECT * FROM %s WHERE k=2"));
  execute("INSERT INTO %s (k, v1) VALUES (3, 2)");
  assertRows(execute("DELETE v1 FROM %s WHERE k=3 IF EXISTS"),row(true));
  assertRows(execute("SELECT * FROM %s WHERE k=3"),row(3,null));
  assertRows(execute("DELETE v1 FROM %s WHERE k=3 IF EXISTS"),row(true));
  assertRows(execute("DELETE FROM %s WHERE k=3 IF EXISTS"),row(true));
  execute("INSERT INTO %s (k, v1) VALUES (4, 2)");
  execute("UPDATE %s USING TTL 1 SET v1=2 WHERE k=4");
  Thread.sleep(1001);
  assertRows(execute("SELECT * FROM %s WHERE k=4"),row(4,null));
  assertRows(execute("DELETE FROM %s WHERE k=4 IF EXISTS"),row(true));
  assertEmpty(execute("SELECT * FROM %s WHERE k=4"));
  createTable("CREATE TABLE %s (k text, s text static, i int, v text, PRIMARY KEY (k, i) )");
  execute("INSERT INTO %s (k, s, i, v) VALUES ('k', 's', 0, 'v')");
  assertRows(execute("DELETE v FROM %s WHERE k='k' AND i=0 IF EXISTS"),row(true));
  assertRows(execute("DELETE FROM %s WHERE k='k' AND i=0 IF EXISTS"),row(true));
  assertRows(execute("DELETE v FROM %s WHERE k='k' AND i=0 IF EXISTS"),row(false));
  assertRows(execute("DELETE FROM %s WHERE k='k' AND i=0 IF EXISTS"),row(false));
  assertInvalidMessage("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order to use IF conditions","DELETE FROM %s WHERE k = 'k' IF EXISTS");
  assertInvalidMessage("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order to use IF conditions","DELETE FROM %s WHERE k = 'k' IF v = 'foo'");
  assertInvalidMessage("Some partition key parts are missing: k","DELETE FROM %s WHERE i = 0 IF EXISTS");
  assertInvalidMessage("Invalid INTEGER constant (0) for \"k\" of type text","DELETE FROM %s WHERE k = 0 AND i > 0 IF EXISTS");
  assertInvalidMessage("Invalid INTEGER constant (0) for \"k\" of type text","DELETE FROM %s WHERE k = 0 AND i > 0 IF v = 'foo'");
  assertInvalidMessage("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order to use IF conditions","DELETE FROM %s WHERE k = 'k' AND i > 0 IF EXISTS");
  assertInvalidMessage("DELETE statements must restrict all PRIMARY KEY columns with equality relations in order to use IF conditions","DELETE FROM %s WHERE k = 'k' AND i > 0 IF v = 'foo'");
  assertInvalidMessage("IN on the clustering key columns is not supported with conditional deletions","DELETE FROM %s WHERE k = 'k' AND i IN (0, 1) IF v = 'foo'");
  assertInvalidMessage("IN on the clustering key columns is not supported with conditional deletions","DELETE FROM %s WHERE k = 'k' AND i IN (0, 1) IF EXISTS");
  createTable("CREATE TABLE %s(k int, s int static, i int, v text, PRIMARY KEY(k, i))");
  execute("INSERT INTO %s (k, s, i, v) VALUES ( 1, 1, 2, '1')");
  assertRows(execute("DELETE v FROM %s WHERE k = 1 AND i = 2 IF s != 1"),row(false,1));
  assertRows(execute("DELETE v FROM %s WHERE k = 1 AND i = 2 IF s = 1"),row(true));
  assertRows(execute("SELECT * FROM %s WHERE k = 1 AND i = 2"),row(1,2,1,null));
  assertRows(execute("DELETE FROM %s WHERE  k = 1 AND i = 2 IF s != 1"),row(false,1));
  assertRows(execute("DELETE FROM %s WHERE k = 1 AND i = 2 IF s = 1"),row(true));
  assertEmpty(execute("SELECT * FROM %s WHERE k = 1 AND i = 2"));
  assertRows(execute("SELECT * FROM %s WHERE k = 1"),row(1,null,1,null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.whole_map_conditional_test()
 */
@Test public void testWholeMap() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, m %s)",frozen ? "frozen<map<text, text>>" : "map<text, text>"));
    execute("INSERT INTO %s (k, m) VALUES (0, {'foo' : 'bar'})");
    check_applies_map("m = {'foo': 'bar'}");
    check_applies_map("m > {'a': 'a'}");
    check_applies_map("m >= {'a': 'a'}");
    check_applies_map("m < {'z': 'z'}");
    check_applies_map("m <= {'z': 'z'}");
    check_applies_map("m != {'a': 'a'}");
    check_applies_map("m IN (null, {'a': 'a'}, {'foo': 'bar'})");
    check_applies_map("m > {'a': 'a'} AND m < {'z': 'z'}");
    check_applies_map("m != null AND m IN (null, {'a': 'a'}, {'foo': 'bar'})");
    check_does_not_apply_map("m = {'a': 'a'}");
    check_does_not_apply_map("m > {'z': 'z'}");
    check_does_not_apply_map("m >= {'z': 'z'}");
    check_does_not_apply_map("m < {'a': 'a'}");
    check_does_not_apply_map("m <= {'a': 'a'}");
    check_does_not_apply_map("m != {'foo': 'bar'}");
    check_does_not_apply_map("m IN ({'a': 'a'}, null)");
    check_does_not_apply_map("m IN ()");
    check_does_not_apply_map("m = null AND m != null");
    check_invalid_map("m = {null: null}",InvalidRequestException.class);
    check_invalid_map("m = {'a': null}",InvalidRequestException.class);
    check_invalid_map("m = {null: 'a'}",InvalidRequestException.class);
    check_invalid_map("m < null",InvalidRequestException.class);
    check_invalid_map("m IN null",SyntaxException.class);
    check_invalid_map("m CONTAINS 'bar'",SyntaxException.class);
    check_invalid_map("m CONTAINS KEY 'foo'",SyntaxException.class);
    check_invalid_map("m CONTAINS null",SyntaxException.class);
    check_invalid_map("m CONTAINS KEY null",SyntaxException.class);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.cas_simple_test()
 */
@Test public void testSimpleCas() throws Throwable {
  createTable("CREATE TABLE %s (tkn int, consumed boolean, PRIMARY KEY (tkn))");
  for (int i=0; i < 10; i++) {
    execute("INSERT INTO %s (tkn, consumed) VALUES (?, FALSE)",i);
    assertRows(execute("UPDATE %s SET consumed = TRUE WHERE tkn = ? IF consumed = FALSE",i),row(true));
    assertRows(execute("UPDATE %s SET consumed = TRUE WHERE tkn = ? IF consumed = FALSE",i),row(false,true));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test expanded functionality from CASSANDRA-6839, 
 * migrated from cql_tests.py:TestCQL.expanded_list_item_conditional_test()
 */
@Test public void testExpandedListItem() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, l %s)",frozen ? "frozen<list<text>>" : "list<text>"));
    execute("INSERT INTO %s (k, l) VALUES (0, ['foo', 'bar', 'foobar'])");
    check_applies_list("l[1] < 'zzz'");
    check_applies_list("l[1] <= 'bar'");
    check_applies_list("l[1] > 'aaa'");
    check_applies_list("l[1] >= 'bar'");
    check_applies_list("l[1] != 'xxx'");
    check_applies_list("l[1] != null");
    check_applies_list("l[1] IN (null, 'xxx', 'bar')");
    check_applies_list("l[1] > 'aaa' AND l[1] < 'zzz'");
    check_applies_list("l[3] = null");
    check_applies_list("l[3] IN (null, 'xxx', 'bar')");
    check_does_not_apply_list("l[1] < 'aaa'");
    check_does_not_apply_list("l[1] <= 'aaa'");
    check_does_not_apply_list("l[1] > 'zzz'");
    check_does_not_apply_list("l[1] >= 'zzz'");
    check_does_not_apply_list("l[1] != 'bar'");
    check_does_not_apply_list("l[1] IN (null, 'xxx')");
    check_does_not_apply_list("l[1] IN ()");
    check_does_not_apply_list("l[1] != null AND l[1] IN ()");
    check_does_not_apply_list("l[3] != null");
    check_does_not_apply_list("l[3] = 'xxx'");
    check_invalid_list("l[1] < null",InvalidRequestException.class);
    check_invalid_list("l[1] <= null",InvalidRequestException.class);
    check_invalid_list("l[1] > null",InvalidRequestException.class);
    check_invalid_list("l[1] >= null",InvalidRequestException.class);
    check_invalid_list("l[1] IN null",SyntaxException.class);
    check_invalid_list("l[1] IN 367",SyntaxException.class);
    check_invalid_list("l[1] IN (1, 2, 3)",InvalidRequestException.class);
    check_invalid_list("l[1] CONTAINS 367",SyntaxException.class);
    check_invalid_list("l[1] CONTAINS KEY 367",SyntaxException.class);
    check_invalid_list("l[null] = null",InvalidRequestException.class);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.list_item_conditional_test()
 */
@Test public void testListItem() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, l %s)",frozen ? "frozen<list<text>>" : "list<text>"));
    execute("INSERT INTO %s(k, l) VALUES (0, ['foo', 'bar', 'foobar'])");
    assertInvalid("DELETE FROM %s WHERE k=0 IF l[null] = 'foobar'");
    assertInvalid("DELETE FROM %s WHERE k=0 IF l[-2] = 'foobar'");
    assertRows(execute("DELETE FROM %s WHERE k=0 IF l[1] = null"),row(false,list("foo","bar","foobar")));
    assertRows(execute("DELETE FROM %s WHERE k=0 IF l[1] = 'foobar'"),row(false,list("foo","bar","foobar")));
    assertRows(execute("SELECT * FROM %s"),row(0,list("foo","bar","foobar")));
    assertRows(execute("DELETE FROM %s WHERE k=0 IF l[1] = 'bar'"),row(true));
    assertEmpty(execute("SELECT * FROM %s"));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_ddl_type_test()
 */
@Test public void testDropCreateTypeIfNotExists() throws Throwable {
  execute("use " + KEYSPACE);
  execute("DROP TYPE IF EXISTS mytype");
  execute("CREATE TYPE IF NOT EXISTS mytype (somefield int)");
  assertRows(execute(format("SELECT type_name from %s.%s where keyspace_name = ? and type_name = ?",SchemaKeyspace.NAME,SchemaKeyspace.TYPES),KEYSPACE,"mytype"),row("mytype"));
  execute("CREATE TYPE IF NOT EXISTS mytype (somefield blob)");
  execute("DROP TYPE IF EXISTS mytype");
  assertEmpty(execute(format("SELECT type_name from %s.%s where keyspace_name = ? and type_name = ?",SchemaKeyspace.NAME,SchemaKeyspace.TYPES),KEYSPACE,"mytype"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.non_eq_conditional_update_test()
 */
@Test public void testNonEqConditionalUpdate() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v1 int, v2 text, v3 int)");
  execute("INSERT INTO %s (k, v1, v2) VALUES (0, 2, 'foo')");
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 < 3"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 <= 3"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 > 1"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 >= 1"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 != 1"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 != 2"),row(false,2));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 IN (0, 1, 2)"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 IN (142, 276)"),row(false,2));
  assertRows(execute("UPDATE %s SET v2 = 'bar' WHERE k = 0 IF v1 IN ()"),row(false,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test expanded functionality from CASSANDRA-6839,
 * migrated from cql_tests.py:TestCQL.expanded_map_item_conditional_test()
 */
@Test public void testExpandedMapItem() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, m %s)",frozen ? "frozen<map<text, text>>" : "map<text, text>"));
    execute("INSERT INTO %s (k, m) VALUES (0, {'foo' : 'bar'})");
    check_applies_map("m['xxx'] = null");
    check_applies_map("m['foo'] < 'zzz'");
    check_applies_map("m['foo'] <= 'bar'");
    check_applies_map("m['foo'] > 'aaa'");
    check_applies_map("m['foo'] >= 'bar'");
    check_applies_map("m['foo'] != 'xxx'");
    check_applies_map("m['foo'] != null");
    check_applies_map("m['foo'] IN (null, 'xxx', 'bar')");
    check_applies_map("m['xxx'] IN (null, 'xxx', 'bar')");
    check_applies_map("m['foo'] < 'zzz' AND m['foo'] > 'aaa'");
    check_does_not_apply_map("m['foo'] < 'aaa'");
    check_does_not_apply_map("m['foo'] <= 'aaa'");
    check_does_not_apply_map("m['foo'] > 'zzz'");
    check_does_not_apply_map("m['foo'] >= 'zzz'");
    check_does_not_apply_map("m['foo'] != 'bar'");
    check_does_not_apply_map("m['xxx'] != null");
    check_does_not_apply_map("m['foo'] IN (null, 'xxx')");
    check_does_not_apply_map("m['foo'] IN ()");
    check_does_not_apply_map("m['foo'] != null AND m['foo'] = null");
    check_invalid_map("m['foo'] < null",InvalidRequestException.class);
    check_invalid_map("m['foo'] <= null",InvalidRequestException.class);
    check_invalid_map("m['foo'] > null",InvalidRequestException.class);
    check_invalid_map("m['foo'] >= null",InvalidRequestException.class);
    check_invalid_map("m['foo'] IN null",SyntaxException.class);
    check_invalid_map("m['foo'] IN 367",SyntaxException.class);
    check_invalid_map("m['foo'] IN (1, 2, 3)",InvalidRequestException.class);
    check_invalid_map("m['foo'] CONTAINS 367",SyntaxException.class);
    check_invalid_map("m['foo'] CONTAINS KEY 367",SyntaxException.class);
    check_invalid_map("m[null] = null",InvalidRequestException.class);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_ddl_table_test()
 */
@Test public void testDropCreateTableIfNotExists() throws Throwable {
  String tableName=createTableName();
  String fullTableName=KEYSPACE + "." + tableName;
  schemaChange("DROP TABLE IF EXISTS " + fullTableName);
  schemaChange("CREATE TABLE IF NOT EXISTS " + fullTableName + " (id text PRIMARY KEY, value1 blob) with comment = 'foo'");
  assertRows(execute("select comment from system_schema.tables where keyspace_name = ? and table_name = ?",KEYSPACE,tableName),row("foo"));
  schemaChange("CREATE TABLE IF NOT EXISTS " + fullTableName + " (id text PRIMARY KEY, value2 blob)with comment = 'bar'");
  assertRows(execute("select comment from system_schema.tables where keyspace_name = ? and table_name = ?",KEYSPACE,tableName),row("foo"));
  schemaChange("DROP TABLE IF EXISTS " + fullTableName);
  assertEmpty(execute("select * from system_schema.tables where keyspace_name = ? and table_name = ?",KEYSPACE,tableName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_6069_test()
 */
@Test public void testInsertSetIfNotExists() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s set<int>)");
  assertRows(execute("INSERT INTO %s (k, s) VALUES (0, {1, 2, 3}) IF NOT EXISTS"),row(true));
  assertRows(execute("SELECT * FROM %s "),row(0,set(1,2,3)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for 7499,
 * migrated from cql_tests.py:TestCQL.cas_and_list_index_test()
 */
@Test public void testCasAndListIndex() throws Throwable {
  createTable("CREATE TABLE %s ( k int PRIMARY KEY, v text, l list<text>)");
  execute("INSERT INTO %s (k, v, l) VALUES(0, 'foobar', ['foi', 'bar'])");
  assertRows(execute("UPDATE %s SET l[0] = 'foo' WHERE k = 0 IF v = 'barfoo'"),row(false,"foobar"));
  assertRows(execute("UPDATE %s SET l[0] = 'foo' WHERE k = 0 IF v = 'foobar'"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,list("foo","bar"),"foobar"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_update_test()
 */
@Test public void testConditionalUpdate() throws Throwable {
  createTable(" CREATE TABLE %s (k int PRIMARY KEY, v1 int, v2 text, v3 int)");
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF v1 = 4"),row(false));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF EXISTS"),row(false));
  assertRows(execute("INSERT INTO %s (k, v1, v2) VALUES (0, 2, 'foo') IF NOT EXISTS"),row(true));
  assertRows(execute("INSERT INTO %s (k, v1, v2) VALUES (0, 5, 'bar') IF NOT EXISTS"),row(false,0,2,"foo",null));
  assertRows(execute("SELECT * FROM %s"),row(0,2,"foo",null));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF v1 = 4"),row(false,2));
  assertRows(execute("SELECT * FROM %s"),row(0,2,"foo",null));
  assertRows(execute("UPDATE %s SET v2 = 'bar', v1 = 3 WHERE k = 0 IF v1 = 2"),row(true));
  assertRows(execute("UPDATE %s SET v2 = 'bar', v1 = 3 WHERE k = 0 IF EXISTS"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,3,"bar",null));
  assertRows(execute("UPDATE %s SET v1 = 5, v2 = 'foobar' WHERE k = 0 IF v1 = 3 AND v2 = 'foo'"),row(false,3,"bar"));
  assertRows(execute("SELECT * FROM %s"),row(0,3,"bar",null));
  assertRows(execute("UPDATE %s SET v1 = 5, v2 = 'foobar' WHERE k = 0 IF v1 = 3 AND v2 = 'bar'"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = 3"),row(false,5));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = null"),row(false,5));
  assertRows(execute("SELECT * FROM %s"),row(0,5,"foobar",null));
  assertRows(execute("DELETE v2 FROM %s WHERE k = 0 IF v1 = 5"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,5,null,null));
  assertRows(execute("DELETE v1 FROM %s WHERE k = 0 IF v3 = 4"),row(false,null));
  assertRows(execute("DELETE v1 FROM %s WHERE k = 0 IF v3 = null"),row(true));
  assertRows(execute("SELECT * FROM %s"),row(0,null,null,null));
  assertRows(execute("DELETE FROM %s WHERE k = 0 IF v1 = null"),row(true));
  assertEmpty(execute("SELECT * FROM %s"));
  assertRows(execute("UPDATE %s SET v1 = 3, v2 = 'bar' WHERE k = 0 IF EXISTS"),row(false));
  assertRows(execute("DELETE FROM %s WHERE k = 0 IF v1 IN (null)"),row(true));
  createTable(" CREATE TABLE %s (k int, c int, v1 text, PRIMARY KEY(k, c))");
  assertInvalidMessage("IN on the clustering key columns is not supported with conditional updates","UPDATE %s SET v1 = 'A' WHERE k = 0 AND c IN (1, 2) IF EXISTS");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.cas_and_ttl_test()
 */
@Test public void testCasAndTTL() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int, lock boolean)");
  execute("INSERT INTO %s (k, v, lock) VALUES (0, 0, false)");
  execute("UPDATE %s USING TTL 1 SET lock=true WHERE k=0");
  Thread.sleep(1001);
  assertRows(execute("UPDATE %s SET v = 1 WHERE k = 0 IF lock = null"),row(true));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for CAS with compact storage table, and #6813 in particular,
 * migrated from cql_tests.py:TestCQL.cas_and_compact_test()
 */
@Test public void testCompactStorage() throws Throwable {
  createTable("CREATE TABLE %s (partition text, key text, owner text, PRIMARY KEY (partition, key) ) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (partition, key, owner) VALUES ('a', 'b', null)");
  assertRows(execute("UPDATE %s SET owner='z' WHERE partition='a' AND key='b' IF owner=null"),row(true));
  assertRows(execute("UPDATE %s SET owner='b' WHERE partition='a' AND key='b' IF owner='a'"),row(false,"z"));
  assertRows(execute("UPDATE %s SET owner='b' WHERE partition='a' AND key='b' IF owner='z'"),row(true));
  assertRows(execute("INSERT INTO %s (partition, key, owner) VALUES ('a', 'c', 'x') IF NOT EXISTS"),row(true));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.whole_set_conditional_test()
 */
@Test public void testWholeSet() throws Throwable {
  for (  boolean frozen : new boolean[]{false,true}) {
    createTable(String.format("CREATE TABLE %%s (k int PRIMARY KEY, s %s)",frozen ? "frozen<set<text>>" : "set<text>"));
    execute("INSERT INTO %s (k, s) VALUES (0, {'bar', 'foo'})");
    check_applies_set("s = {'bar', 'foo'}");
    check_applies_set("s = {'foo', 'bar'}");
    check_applies_set("s != {'baz'}");
    check_applies_set("s > {'a'}");
    check_applies_set("s >= {'a'}");
    check_applies_set("s < {'z'}");
    check_applies_set("s <= {'z'}");
    check_applies_set("s IN (null, {'bar', 'foo'}, {'a'})");
    check_applies_set("s > {'a'} AND s < {'z'}");
    check_applies_set("s IN (null, {'bar', 'foo'}, {'a'}) AND s IN ({'a'}, {'bar', 'foo'}, null)");
    check_does_not_apply_set("s = {'baz'}");
    check_does_not_apply_set("s != {'bar', 'foo'}");
    check_does_not_apply_set("s > {'z'}");
    check_does_not_apply_set("s >= {'z'}");
    check_does_not_apply_set("s < {'a'}");
    check_does_not_apply_set("s <= {'a'}");
    check_does_not_apply_set("s IN ({'a'}, null)");
    check_does_not_apply_set("s IN ()");
    check_does_not_apply_set("s != null AND s IN ()");
    check_invalid_set("s = {null}",InvalidRequestException.class);
    check_invalid_set("s < null",InvalidRequestException.class);
    check_invalid_set("s <= null",InvalidRequestException.class);
    check_invalid_set("s > null",InvalidRequestException.class);
    check_invalid_set("s >= null",InvalidRequestException.class);
    check_invalid_set("s IN null",SyntaxException.class);
    check_invalid_set("s IN 367",SyntaxException.class);
    check_invalid_set("s CONTAINS KEY 123",SyntaxException.class);
    check_invalid_set("s['foo'] = 'foobar'",InvalidRequestException.class);
    check_invalid_set("m CONTAINS 'bar'",SyntaxException.class);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectLimitTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check for #7052 bug,
 * migrated from cql_tests.py:TestCQL.limit_compact_table()
 */
@Test public void testLimitInCompactTable() throws Throwable {
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY (k, v) ) WITH COMPACT STORAGE ");
  for (int i=0; i < 4; i++)   for (int j=0; j < 4; j++)   execute("INSERT INTO %s(k, v) VALUES (?, ?)",i,j);
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND v > 0 AND v <= 4 LIMIT 2"),row(1),row(2));
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND v > -1 AND v <= 4 LIMIT 2"),row(0),row(1));
  assertRows(execute("SELECT * FROM %s WHERE k IN (0, 1, 2) AND v > 0 AND v <= 4 LIMIT 2"),row(0,1),row(0,2));
  assertRows(execute("SELECT * FROM %s WHERE k IN (0, 1, 2) AND v > -1 AND v <= 4 LIMIT 2"),row(0,0),row(0,1));
  assertRows(execute("SELECT * FROM %s WHERE k IN (0, 1, 2) AND v > 0 AND v <= 4 LIMIT 6"),row(0,1),row(0,2),row(0,3),row(1,1),row(1,2),row(1,3));
  assertRows(execute("SELECT * FROM %s WHERE v > 1 AND v <= 3 LIMIT 6 ALLOW FILTERING"),row(0,2),row(0,3),row(1,2),row(1,3),row(2,2),row(2,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test limit across a partition range, requires byte ordered partitioner,
 * migrated from cql_tests.py:TestCQL.limit_range_test()
 */
@Test public void testPartitionRange() throws Throwable {
  createTable("CREATE TABLE %s (userid int, url text, time bigint, PRIMARY KEY (userid, url)) WITH COMPACT STORAGE");
  for (int i=0; i < 100; i++)   for (  String tld : new String[]{"com","org","net"})   execute("INSERT INTO %s (userid, url, time) VALUES (?, ?, ?)",i,String.format("http://foo.%s",tld),42L);
  assertRows(execute("SELECT * FROM %s WHERE token(userid) >= token(2) LIMIT 1"),row(2,"http://foo.com",42L));
  assertRows(execute("SELECT * FROM %s WHERE token(userid) > token(2) LIMIT 1"),row(3,"http://foo.com",42L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test limit across a column range,
 * migrated from cql_tests.py:TestCQL.limit_multiget_test()
 */
@Test public void testColumnRange() throws Throwable {
  createTable("CREATE TABLE %s (userid int, url text, time bigint, PRIMARY KEY (userid, url)) WITH COMPACT STORAGE");
  for (int i=0; i < 100; i++)   for (  String tld : new String[]{"com","org","net"})   execute("INSERT INTO %s (userid, url, time) VALUES (?, ?, ?)",i,String.format("http://foo.%s",tld),42L);
  assertRows(execute("SELECT * FROM %s WHERE userid IN (48, 2) LIMIT 1"),row(2,"http://foo.com",42L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test limit queries on a sparse table,
 * migrated from cql_tests.py:TestCQL.limit_sparse_test()
 */
@Test public void testSparseTable() throws Throwable {
  createTable("CREATE TABLE %s (userid int, url text, day int, month text, year int, PRIMARY KEY (userid, url))");
  for (int i=0; i < 100; i++)   for (  String tld : new String[]{"com","org","net"})   execute("INSERT INTO %s (userid, url, day, month, year) VALUES (?, ?, 1, 'jan', 2012)",i,String.format("http://foo.%s",tld));
  assertRowCount(execute("SELECT * FROM %s LIMIT 4"),4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectMultiColumnRelationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidColumnNames() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
  assertInvalidMessage("Undefined name e in where clause ('(b, e) = (0, 0)')","SELECT * FROM %s WHERE (b, e) = (0, 0)");
  assertInvalidMessage("Undefined name e in where clause ('(b, e) IN ((0, 1), (2, 4))')","SELECT * FROM %s WHERE (b, e) IN ((0, 1), (2, 4))");
  assertInvalidMessage("Undefined name e in where clause ('(b, e) > (0, 1)')","SELECT * FROM %s WHERE (b, e) > (0, 1) and b <= 2");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('(b, e) = (0, 0)')","SELECT c AS e FROM %s WHERE (b, e) = (0, 0)");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('(b, e) IN ((0, 1), (2, 4))')","SELECT c AS e FROM %s WHERE (b, e) IN ((0, 1), (2, 4))");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('(b, e) > (0, 1)')","SELECT c AS e FROM %s WHERE (b, e) > (0, 1) and b <= 2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleClustering() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))" + compactOption);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,2,0);
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) = (?)",0,1),row(0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) = ?",0,tuple(1)),row(0,1,0));
    assertEmpty(execute("SELECT * FROM %s WHERE a = ? AND (b) = (?)",0,3));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?)",0,0),row(0,1,0),row(0,2,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) >= (?)",0,1),row(0,1,0),row(0,2,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) < (?)",0,2),row(0,0,0),row(0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) <= (?)",0,1),row(0,0,0),row(0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?) AND (b) < (?)",0,0,2),row(0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?) AND b < ?",0,0,2),row(0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND b > ? AND (b) < (?)",0,0,2),row(0,1,0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int, i int, j int, s text, PRIMARY KEY(k,i,j))");
  createIndex("CREATE INDEX s_index ON %s (s)");
  assertInvalidMessage("Invalid unset value for tuple field number 0","SELECT * from %s WHERE (i, j) = (?,?) ALLOW FILTERING",unset(),1);
  assertInvalidMessage("Invalid unset value for tuple field number 0","SELECT * from %s WHERE (i, j) IN ((?,?)) ALLOW FILTERING",unset(),1);
  assertInvalidMessage("Invalid unset value for tuple field number 1","SELECT * from %s WHERE (i, j) > (1,?) ALLOW FILTERING",unset());
  assertInvalidMessage("Invalid unset value for tuple (i,j)","SELECT * from %s WHERE (i, j) = ? ALLOW FILTERING",unset());
  assertInvalidMessage("Invalid unset value for tuple (j)","SELECT * from %s WHERE i = ? AND (j) > ? ALLOW FILTERING",1,unset());
  assertInvalidMessage("Invalid unset value for tuple (i,j)","SELECT * from %s WHERE (i, j) IN (?, ?) ALLOW FILTERING",unset(),tuple(1,1));
  assertInvalidMessage("Invalid unset value for in(i,j)","SELECT * from %s WHERE (i, j) IN ? ALLOW FILTERING",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testINWithDuplicateValue() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (k1 int, k2 int, v int, PRIMARY KEY (k1, k2))" + compactOption);
    execute("INSERT INTO %s (k1,  k2, v) VALUES (?, ?, ?)",1,1,1);
    assertRows(execute("SELECT * FROM %s WHERE k1 IN (?, ?) AND (k2) IN ((?), (?))",1,1,1,2),row(1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE k1 = ? AND (k2) IN ((?), (?))",1,1,1),row(1,1,1));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check select on tuple relations, see CASSANDRA-8613
 * migrated from cql_tests.py:TestCQL.simple_tuple_query_test()
 */
@Test public void testSimpleTupleQuery() throws Throwable {
  createTable("create table %s (a int, b int, c int, d int , e int, PRIMARY KEY (a, b, c, d, e))");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 2, 0, 0, 0)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 1, 0, 0, 0)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 0, 0, 0, 0)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 0, 1, 1, 1)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 0, 2, 2, 2)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 0, 3, 3, 3)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (0, 0, 1, 1, 1)");
  assertRows(execute("SELECT * FROM %s WHERE b=0 AND (c, d, e) > (1, 1, 1) ALLOW FILTERING"),row(0,0,2,2,2),row(0,0,3,3,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeveralMultiColumnRelation() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c, d))" + compactOption);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,1);
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) = (?, ?)",0,1,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) IN ((?), (?)) and (c, d) = (?, ?)",0,0,1,0,0),row(0,0,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c) IN ((?))",0,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) IN ((?),(?)) and (c) IN ((?))",0,0,1,0),row(0,0,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c) IN ((?), (?))",0,1,0,1),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) IN ((?, ?))",0,1,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) IN ((?, ?), (?, ?))",0,1,0,0,1,1),row(0,1,0,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) IN ((?), (?)) and (c, d) IN ((?, ?), (?, ?))",0,0,1,0,0,1,1),row(0,0,0,0),row(0,0,1,1),row(0,1,0,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) > (?, ?)",0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) IN ((?),(?)) and (c, d) > (?, ?)",0,0,1,0,0),row(0,0,1,0),row(0,0,1,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) > (?, ?) and (c) <= (?) ",0,1,0,0,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) > (?, ?) and c <= ? ",0,1,0,0,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) = (?) and (c, d) >= (?, ?) and (c, d) < (?, ?)",0,1,0,0,1,1),row(0,1,0,0),row(0,1,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) = (?, ?) and d = ?",0,0,1,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) IN ((?, ?), (?, ?)) and d = ?",0,0,1,0,0,0),row(0,0,0,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (d) < (1) and (b, c) = (?, ?) and (d) >= (?)",0,0,1,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (d) < (1) and (b, c) IN ((?, ?), (?, ?)) and (d) >= (?)",0,0,1,0,0,0),row(0,0,0,0),row(0,0,1,0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleClusteringReversedComponents() throws Throwable {
  for (  String compactOption : new String[]{""," COMPACT STORAGE AND"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c, d)) WITH" + compactOption + " CLUSTERING ORDER BY (b DESC, c ASC, d DESC)");
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,1);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?)",0,0),row(0,1,0,0),row(0,1,1,1),row(0,1,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) >= (?)",0,0),row(0,1,0,0),row(0,1,1,1),row(0,1,1,0),row(0,0,0,0),row(0,0,1,1),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) < (?)",0,1),row(0,0,0,0),row(0,0,1,1),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) <= (?)",0,1),row(0,1,0,0),row(0,1,1,1),row(0,1,1,0),row(0,0,0,0),row(0,0,1,1),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND (b, c, d) IN ((?, ?, ?), (?, ?, ?))",0,1,1,1,0,1,1),row(0,1,1,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a=? AND (b, c, d) IN ((?, ?, ?), (?, ?, ?))",0,0,1,1,1,1,1),row(0,1,1,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) IN (?, ?, ?, ?, ?, ?)",0,tuple(1,0,0),tuple(1,1,1),tuple(1,1,0),tuple(0,0,0),tuple(0,1,1),tuple(0,1,0)),row(0,1,0,0),row(0,1,1,1),row(0,1,1,0),row(0,0,0,0),row(0,0,1,1),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) IN (?)",0,tuple(0,1)),row(0,0,1,1),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) IN (?)",0,tuple(0,0)),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) IN ((?))",0,0),row(0,0,0,0),row(0,0,1,1),row(0,0,1,0));
    assertEmpty(execute("SELECT * FROM %s WHERE a = ? AND (b, c) > (?, ?)",0,1,0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleClusteringInvalidQueries() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))" + compactOption);
    assertInvalidSyntax("SELECT * FROM %s WHERE () = (?, ?)",1,2);
    assertInvalidMessage("b cannot be restricted by more than one relation if it includes an Equal","SELECT * FROM %s WHERE a = 0 AND (b) = (?) AND (b) > (?)",0,0);
    assertInvalidMessage("More than one restriction was found for the start bound on b","SELECT * FROM %s WHERE a = 0 AND (b) > (?) AND (b) > (?)",0,1);
    assertInvalidMessage("More than one restriction was found for the start bound on b","SELECT * FROM %s WHERE a = 0 AND (b) > (?) AND b > ?",0,1);
    assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a, b) = (?, ?)",0,0);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSinglePartitionInvalidQueries() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int PRIMARY KEY, b int)" + compactOption);
    assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a) > (?)",0);
    assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a) = (?)",0);
    assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: b","SELECT * FROM %s WHERE (b) = (?)",0);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiAndSingleColumnRelationMix() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c, d))" + compactOption);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,1);
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) = (?, ?)",0,1,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b IN (?, ?) and (c, d) = (?, ?)",0,0,1,0,0),row(0,0,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c) IN ((?))",0,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b IN (?, ?) and (c) IN ((?))",0,0,1,0),row(0,0,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c) IN ((?), (?))",0,1,0,1),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) IN ((?, ?))",0,1,0,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) IN ((?, ?), (?, ?))",0,1,0,0,1,1),row(0,1,0,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b IN (?, ?) and (c, d) IN ((?, ?), (?, ?))",0,0,1,0,0,1,1),row(0,0,0,0),row(0,0,1,1),row(0,1,0,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) > (?, ?)",0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b IN (?, ?) and (c, d) > (?, ?)",0,0,1,0,0),row(0,0,1,0),row(0,0,1,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) > (?, ?) and (c) <= (?) ",0,1,0,0,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) > (?, ?) and c <= ? ",0,1,0,0,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c, d) >= (?, ?) and (c, d) < (?, ?)",0,1,0,0,1,1),row(0,1,0,0),row(0,1,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) = (?, ?) and d = ?",0,0,1,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) IN ((?, ?), (?, ?)) and d = ?",0,0,1,0,0,0),row(0,0,0,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c) = (?) and d = ?",0,0,1,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) = (?, ?) and d IN (?, ?)",0,0,1,0,2),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and b = ? and (c) = (?) and d IN (?, ?)",0,0,1,0,2),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) = (?, ?) and d >= ?",0,0,1,0),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and d < 1 and (b, c) = (?, ?) and d >= ?",0,0,1,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and d < 1 and (b, c) IN ((?, ?), (?, ?)) and d >= ?",0,0,1,0,0,0),row(0,0,0,0),row(0,0,1,0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonEqualsRelation() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int PRIMARY KEY, b int)" + compactOption);
    assertInvalidMessage("Unsupported \"!=\" relation: (b) != (0)","SELECT * FROM %s WHERE a = 0 AND (b) != (0)");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiplePartitionKeyAndMultiClusteringWithIndex() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, f int, PRIMARY KEY ((a, b), c, d, e))");
  createIndex("CREATE INDEX ON %s (c)");
  createIndex("CREATE INDEX ON %s (f)");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,0,1);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,1,2);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,0,0,3);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,0,4);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,1,5);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,2,0,0,5);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c) = (?)");
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c) = (?) ALLOW FILTERING",0,1),row(0,0,1,0,0,3),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c, d) = (?, ?)",0,1,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c, d) = (?, ?) ALLOW FILTERING",0,1,1),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND (c, d) IN ((?, ?)) ALLOW FILTERING",0,1,1);
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND (c, d) >= (?, ?) ALLOW FILTERING",0,1,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND (c) IN ((?)) AND f = ?",0,0,1,5),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c) IN ((?)) AND f = ?",0,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c) IN ((?)) AND f = ? ALLOW FILTERING",0,1,5),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c) IN ((?), (?)) AND f = ?",0,1,2,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND (c) IN ((?), (?)) AND f = ?",0,0,1,2,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c) IN ((?), (?)) AND f = ? ALLOW FILTERING",0,1,2,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND (c, d) IN ((?, ?)) AND f = ?",0,0,1,0,3),row(0,0,1,0,0,3));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c, d) IN ((?, ?)) AND f = ?",0,1,0,3);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c, d) IN ((?, ?)) AND f = ? ALLOW FILTERING",0,1,0,3),row(0,0,1,0,0,3));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c) >= (?) AND f = ?",0,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND (c) >= (?) AND f = ?",0,0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c) >= (?) AND f = ? ALLOW FILTERING",0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND (c, d) >= (?, ?) AND f = ?",0,0,1,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND (c, d) >= (?, ?) AND f = ?",0,1,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (c, d) >= (?, ?) AND f = ? ALLOW FILTERING",0,1,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleClusteringWithIndex() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, PRIMARY KEY (a, b, c, d))");
  createIndex("CREATE INDEX ON %s (b)");
  createIndex("CREATE INDEX ON %s (e)");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,1,0,1);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,0,1,1,2);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,1,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,1,1,0,1);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,1,1,1,2);
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (?, ?, ?, ?, ?)",0,2,0,0,0);
  assertRows(execute("SELECT * FROM %s WHERE a= ? AND (b) = (?)",0,1),row(0,1,0,0,0),row(0,1,1,0,1),row(0,1,1,1,2));
  assertRows(execute("SELECT * FROM %s WHERE (b) = (?)",1),row(0,1,0,0,0),row(0,1,1,0,1),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b, c) = (?, ?)",1,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) = (?, ?)",0,1,1),row(0,1,1,0,1),row(0,1,1,1,2));
  assertRows(execute("SELECT * FROM %s WHERE (b, c) = (?, ?) ALLOW FILTERING",1,1),row(0,1,1,0,1),row(0,1,1,1,2));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) = (?, ?) AND e = ?",0,1,1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b, c) = (?, ?) AND e = ?",1,1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b, c) = (?, ?) AND e = ? ALLOW FILTERING",1,1,2),row(0,1,1,1,2));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) IN ((?)) AND e = ? ALLOW FILTERING",0,1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b) IN ((?)) AND e = ?",1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b) IN ((?)) AND e = ? ALLOW FILTERING",1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b) IN ((?), (?)) AND e = ?",0,1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b) IN ((?), (?)) AND e = ? ALLOW FILTERING",0,1,2),row(0,0,1,1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b, c) IN ((?, ?)) AND e = ?",0,1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b, c) IN ((?, ?)) AND e = ? ALLOW FILTERING",0,1,2),row(0,0,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b, c) IN ((?, ?), (?, ?)) AND e = ?",0,1,1,1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b, c) IN ((?, ?), (?, ?)) AND e = ? ALLOW FILTERING",0,1,1,1,2),row(0,0,1,1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b) >= (?) AND e = ?",1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b) >= (?) AND e = ? ALLOW FILTERING",1,2),row(0,1,1,1,2));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE (b, c) >= (?, ?) AND e = ?",1,1,2);
  assertRows(execute("SELECT * FROM %s WHERE (b, c) >= (?, ?) AND e = ? ALLOW FILTERING",1,1,2),row(0,1,1,1,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleClustering() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c, d))" + compactOption);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,1);
    assertEmpty(execute("SELECT * FROM %s WHERE a = 0 AND (b, c, d) IN ()"));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) = (?)",0,1),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) = ?",0,tuple(1)),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) = (?, ?)",0,1,1),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) = ?",0,tuple(1,1)),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) = (?, ?, ?)",0,1,1,1),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) = ?",0,tuple(1,1,1)),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?)",0,0),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) >= (?)",0,0),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) > (?, ?)",0,1,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) >= (?, ?)",0,1,0),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?)",0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) >= (?, ?, ?)",0,1,1,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) < (?)",0,1),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) <= (?)",0,1),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1),row(0,1,0,0),row(0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) < (?, ?)",0,0,1),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) <= (?, ?)",0,0,1),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) < (?, ?, ?)",0,0,1,1),row(0,0,0,0),row(0,0,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) <= (?, ?, ?)",0,0,1,1),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b) < (?)",0,0,1,0,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND b < ?",0,0,1,0,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b, c) < (?, ?)",0,0,1,1,1,1),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b, c, d) < (?, ?, ?)",0,0,1,1,1,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > ? AND (b, c, d) < ?",0,tuple(0,1,1),tuple(1,1,0)),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) > (?) ORDER BY b DESC, c DESC, d DESC",0,0),row(0,1,1,1),row(0,1,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) >= (?) ORDER BY b DESC, c DESC, d DESC",0,0),row(0,1,1,1),row(0,1,1,0),row(0,1,0,0),row(0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) > (?, ?) ORDER BY b DESC, c DESC, d DESC",0,1,0),row(0,1,1,1),row(0,1,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) >= (?, ?) ORDER BY b DESC, c DESC, d DESC",0,1,0),row(0,1,1,1),row(0,1,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) ORDER BY b DESC, c DESC, d DESC",0,1,1,0),row(0,1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) >= (?, ?, ?) ORDER BY b DESC, c DESC, d DESC",0,1,1,0),row(0,1,1,1),row(0,1,1,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) < (?) ORDER BY b DESC, c DESC, d DESC",0,1),row(0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b) <= (?) ORDER BY b DESC, c DESC, d DESC",0,1),row(0,1,1,1),row(0,1,1,0),row(0,1,0,0),row(0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) < (?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) <= (?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1),row(0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) < (?, ?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) <= (?, ?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1,1),row(0,0,1,1),row(0,0,1,0),row(0,0,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b) < (?) ORDER BY b DESC, c DESC, d DESC",0,0,1,0,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND b < ? ORDER BY b DESC, c DESC, d DESC",0,0,1,0,1),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b, c) < (?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1,1,1,1),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) > (?, ?, ?) AND (b, c, d) < (?, ?, ?) ORDER BY b DESC, c DESC, d DESC",0,0,1,1,1,1,0),row(0,1,0,0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) IN ((?, ?, ?), (?, ?, ?))",0,0,1,0,0,1,1),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) IN (?, ?)",0,tuple(0,1,0),tuple(0,1,1)),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) IN ?",0,list(tuple(0,1,0),tuple(0,1,1))),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c, d) IN (?, ?)",0,tuple(0,1,1),tuple(0,1,0)),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b, c) IN ((?, ?))",0,0,1),row(0,0,1,0),row(0,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a = ? and (b) IN ((?))",0,0),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1));
    assertEmpty(execute("SELECT * FROM %s WHERE a = ? and (b) IN ()",0));
    assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) IN ((?, ?)) ORDER BY b DESC, c DESC, d DESC",0,0,1),row(0,0,1,1),row(0,0,1,0));
    assertEmpty(execute("SELECT * FROM %s WHERE a = ? AND (b, c) IN () ORDER BY b DESC, c DESC, d DESC",0));
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,0,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,0);
    execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",1,0,1,1);
    assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?) AND (b, c, d) IN (?, ?)",0,1,tuple(0,1,0),tuple(0,1,1)),row(0,0,1,0),row(0,0,1,1),row(1,0,1,0),row(1,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a IN ? AND (b, c, d) IN ?",list(0,1),list(tuple(0,1,0),tuple(0,1,1))),row(0,0,1,0),row(0,0,1,1),row(1,0,1,0),row(1,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?) AND (b, c, d) IN (?, ?)",1,0,tuple(0,1,1),tuple(0,1,0)),row(0,0,1,0),row(0,0,1,1),row(1,0,1,0),row(1,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?) and (b, c) IN ((?, ?))",0,1,0,1),row(0,0,1,0),row(0,0,1,1),row(1,0,1,0),row(1,0,1,1));
    assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?) and (b) IN ((?))",0,1,0),row(0,0,0,0),row(0,0,1,0),row(0,0,1,1),row(1,0,0,0),row(1,0,1,0),row(1,0,1,1));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiClusteringInvalidQueries() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c, d))" + compactOption);
    assertInvalidSyntax("SELECT * FROM %s WHERE a = 0 AND (b, c) > ()");
    assertInvalidMessage("Expected 2 elements in value tuple, but got 3: (?, ?, ?)","SELECT * FROM %s WHERE a = 0 AND (b, c) > (?, ?, ?)",1,2,3);
    assertInvalidMessage("Invalid null value in condition for column c","SELECT * FROM %s WHERE a = 0 AND (b, c) > (?, ?)",1,null);
    assertInvalidMessage("Clustering columns must appear in the PRIMARY KEY order in multi-column relations: (d, c, b) = (?, ?, ?)","SELECT * FROM %s WHERE a = 0 AND (d, c, b) = (?, ?, ?)",0,0,0);
    assertInvalidMessage("Clustering columns must appear in the PRIMARY KEY order in multi-column relations: (d, c, b) > (?, ?, ?)","SELECT * FROM %s WHERE a = 0 AND (d, c, b) > (?, ?, ?)",0,0,0);
    assertInvalidMessage("Expected 3 elements in value tuple, but got 2: (?, ?)","SELECT * FROM %s WHERE a=0 AND (b, c, d) IN ((?, ?))",0,1);
    assertInvalidMessage("Expected 3 elements in value tuple, but got 5: (?, ?, ?, ?, ?)","SELECT * FROM %s WHERE a=0 AND (b, c, d) IN ((?, ?, ?, ?, ?))",0,1,2,3,4);
    assertInvalidMessage("PRIMARY KEY column \"c\" cannot be restricted as preceding column \"b\" is not restricted","SELECT * FROM %s WHERE a = 0 AND (c, d) = (?, ?)",0,0);
    assertInvalidMessage("PRIMARY KEY column \"c\" cannot be restricted as preceding column \"b\" is not restricted","SELECT * FROM %s WHERE a = 0 AND (c, d) > (?, ?)",0,0);
    assertInvalidMessage("Invalid null value in condition for columns: [b, c, d]","SELECT * FROM %s WHERE a = 0 AND (b, c, d) IN ((?, ?, ?))",1,2,null);
    assertInvalid("SELECT * FROM %s WHERE a = 0 AND (b, c, d) = (?, ?, ?)",1,2,"foobar");
    assertInvalid("SELECT * FROM %s WHERE a = 0 AND b = (?, ?, ?)",1,2,3);
    assertInvalidMessage("Column \"c\" cannot be restricted by two inequalities not starting with the same column","SELECT * FROM %s WHERE a = 0 AND (b, c, d) > (?, ?, ?) AND c < ?",0,1,0,1);
    assertInvalidMessage("Column \"c\" cannot be restricted by two inequalities not starting with the same column","SELECT * FROM %s WHERE a = 0 AND c > ? AND (b, c, d) < (?, ?, ?)",1,1,1,0);
    assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a, b, c, d) IN ((?, ?, ?, ?))",0,1,2,3);
    assertInvalidMessage("PRIMARY KEY column \"c\" cannot be restricted as preceding column \"b\" is not restricted","SELECT * FROM %s WHERE (c, d) IN ((?, ?))",0,1);
    assertInvalidMessage("Clustering column \"c\" cannot be restricted (preceding column \"b\" is restricted by a non-EQ relation)","SELECT * FROM %s WHERE a = ? AND b > ?  AND (c, d) IN ((?, ?))",0,0,0,0);
    assertInvalidMessage("Clustering column \"c\" cannot be restricted (preceding column \"b\" is restricted by a non-EQ relation)","SELECT * FROM %s WHERE a = ? AND b > ?  AND (c, d) > (?, ?)",0,0,0,0);
    assertInvalidMessage("PRIMARY KEY column \"c\" cannot be restricted (preceding column \"b\" is restricted by a non-EQ relation)","SELECT * FROM %s WHERE a = ? AND (c, d) > (?, ?) AND b > ?  ",0,0,0,0);
    assertInvalidMessage("Column \"c\" cannot be restricted by two inequalities not starting with the same column","SELECT * FROM %s WHERE a = ? AND (b, c) > (?, ?) AND (b) < (?) AND (c) < (?)",0,0,0,0,0);
    assertInvalidMessage("Column \"c\" cannot be restricted by two inequalities not starting with the same column","SELECT * FROM %s WHERE a = ? AND (c) < (?) AND (b, c) > (?, ?) AND (b) < (?)",0,0,0,0,0);
    assertInvalidMessage("Clustering column \"c\" cannot be restricted (preceding column \"b\" is restricted by a non-EQ relation)","SELECT * FROM %s WHERE a = ? AND (b) < (?) AND (c) < (?) AND (b, c) > (?, ?)",0,0,0,0,0);
    assertInvalidMessage("Clustering column \"c\" cannot be restricted (preceding column \"b\" is restricted by a non-EQ relation)","SELECT * FROM %s WHERE a = ? AND (b) < (?) AND c < ? AND (b, c) > (?, ?)",0,0,0,0,0);
    assertInvalidMessage("Column \"c\" cannot be restricted by two inequalities not starting with the same column","SELECT * FROM %s WHERE a = ? AND (b, c) > (?, ?) AND (c) < (?)",0,0,0,0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectOrderByTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInOrderByWithTwoPartitionKeyColumns() throws Throwable {
  for (  String option : asList("","WITH CLUSTERING ORDER BY (col_3 DESC)")) {
    createTable("CREATE TABLE %s (col_1 int, col_2 int, col_3 int, PRIMARY KEY ((col_1, col_2), col_3)) " + option);
    execute("INSERT INTO %s (col_1, col_2, col_3) VALUES(?, ?, ?)",1,1,1);
    execute("INSERT INTO %s (col_1, col_2, col_3) VALUES(?, ?, ?)",1,1,2);
    execute("INSERT INTO %s (col_1, col_2, col_3) VALUES(?, ?, ?)",1,1,13);
    execute("INSERT INTO %s (col_1, col_2, col_3) VALUES(?, ?, ?)",1,2,10);
    execute("INSERT INTO %s (col_1, col_2, col_3) VALUES(?, ?, ?)",1,2,11);
    assertRows(execute("select * from %s where col_1=? and col_2 IN (?, ?) order by col_3;",1,1,2),row(1,1,1),row(1,1,2),row(1,2,10),row(1,2,11),row(1,1,13));
    assertRows(execute("select * from %s where col_1=? and col_2 IN (?, ?) order by col_3 desc;",1,1,2),row(1,1,13),row(1,2,11),row(1,2,10),row(1,1,2),row(1,1,1));
    assertRows(execute("select * from %s where col_2 IN (?, ?) and col_1=? order by col_3;",1,2,1),row(1,1,1),row(1,1,2),row(1,2,10),row(1,2,11),row(1,1,13));
    assertRows(execute("select * from %s where col_2 IN (?, ?) and col_1=? order by col_3 desc;",1,2,1),row(1,1,13),row(1,2,11),row(1,2,10),row(1,1,2),row(1,1,1));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFieldSelectionOrderSingleClustering() throws Throwable {
  String type=createType("CREATE TYPE %s (a int)");
  for (  String descOption : new String[]{""," WITH CLUSTERING ORDER BY (b DESC)"}) {
    createTable("CREATE TABLE %s (a int, b int, c frozen<" + type + "   >, PRIMARY KEY (a, b))"+ descOption);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, {a: ?})",0,0,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, {a: ?})",0,1,1);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, {a: ?})",0,2,2);
    assertRows(execute("SELECT c.a FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2));
    assertRows(execute("SELECT c.a FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
    assertRows(execute("SELECT blobAsInt(intAsBlob(c.a)) FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
    dropTable("DROP TABLE %s");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalSelectionOrderMultipleClustering() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,2,2);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,3);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,4);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,2,5);
  assertRows(execute("SELECT * FROM %s WHERE a=? ORDER BY b ASC",0),row(0,0,0,0),row(0,0,1,1),row(0,0,2,2),row(0,1,0,3),row(0,1,1,4),row(0,1,2,5));
  assertRows(execute("SELECT * FROM %s WHERE a=? ORDER BY b DESC",0),row(0,1,2,5),row(0,1,1,4),row(0,1,0,3),row(0,0,2,2),row(0,0,1,1),row(0,0,0,0));
  assertRows(execute("SELECT * FROM %s WHERE a=? ORDER BY b DESC, c DESC",0),row(0,1,2,5),row(0,1,1,4),row(0,1,0,3),row(0,0,2,2),row(0,0,1,1),row(0,0,0,0));
  assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY c ASC",0);
  assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY c DESC",0);
  assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY b ASC, c DESC",0);
  assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY b DESC, c ASC",0);
  assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY d ASC",0);
  assertRows(execute("SELECT b FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(0),row(0),row(1),row(1),row(1));
  assertRows(execute("SELECT b FROM %s WHERE a=? ORDER BY b DESC",0),row(1),row(1),row(1),row(0),row(0),row(0));
  assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2),row(0),row(1),row(2));
  assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0),row(2),row(1),row(0));
  assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b ASC, c ASC",0),row(0),row(1),row(2),row(0),row(1),row(2));
  assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b DESC, c DESC",0),row(2),row(1),row(0),row(2),row(1),row(0));
  assertRows(execute("SELECT d FROM %s WHERE a=? ORDER BY b ASC, c ASC",0),row(0),row(1),row(2),row(3),row(4),row(5));
  assertRows(execute("SELECT d FROM %s WHERE a=? ORDER BY b DESC, c DESC",0),row(5),row(4),row(3),row(2),row(1),row(0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalSelectionOrderSingleClustering() throws Throwable {
  for (  String descOption : new String[]{""," WITH CLUSTERING ORDER BY (b DESC)"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))" + descOption);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,2,2);
    assertRows(execute("SELECT * FROM %s WHERE a=? ORDER BY b ASC",0),row(0,0,0),row(0,1,1),row(0,2,2));
    assertRows(execute("SELECT * FROM %s WHERE a=? ORDER BY b DESC",0),row(0,2,2),row(0,1,1),row(0,0,0));
    assertRows(execute("SELECT b FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2));
    assertRows(execute("SELECT b FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
    assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2));
    assertRows(execute("SELECT c FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionSelectionOrderMultipleClustering() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,2,2);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,3);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,4);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,2,5);
  assertInvalid("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY c ASC",0);
  assertInvalid("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY c DESC",0);
  assertInvalid("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b ASC, c DESC",0);
  assertInvalid("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b DESC, c ASC",0);
  assertInvalid("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY d ASC",0);
  assertRows(execute("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(0),row(0),row(1),row(1),row(1));
  assertRows(execute("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b DESC",0),row(1),row(1),row(1),row(0),row(0),row(0));
  assertRows(execute("SELECT b, blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b ASC",0),row(0,0),row(0,0),row(0,0),row(1,1),row(1,1),row(1,1));
  assertRows(execute("SELECT b, blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b DESC",0),row(1,1),row(1,1),row(1,1),row(0,0),row(0,0),row(0,0));
  assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2),row(0),row(1),row(2));
  assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0),row(2),row(1),row(0));
  assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b ASC, c ASC",0),row(0),row(1),row(2),row(0),row(1),row(2));
  assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b DESC, c DESC",0),row(2),row(1),row(0),row(2),row(1),row(0));
  assertRows(execute("SELECT blobAsInt(intAsBlob(d)) FROM %s WHERE a=? ORDER BY b ASC, c ASC",0),row(0),row(1),row(2),row(3),row(4),row(5));
  assertRows(execute("SELECT blobAsInt(intAsBlob(d)) FROM %s WHERE a=? ORDER BY b DESC, c DESC",0),row(5),row(4),row(3),row(2),row(1),row(0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check ORDER BY support in SELECT statement
 * migrated from cql_tests.py:TestCQL.order_by_test()
 */
@Test public void testSimpleOrderBy() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c)) WITH COMPACT STORAGE");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c, v) VALUES (0, ?, ?)",i,i);
  assertRows(execute("SELECT v FROM %s WHERE k = 0 ORDER BY c DESC"),row(9),row(8),row(7),row(6),row(5),row(4),row(3),row(2),row(1),row(0));
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v int, PRIMARY KEY (k, c1, c2)) WITH COMPACT STORAGE");
  for (int i=0; i < 4; i++)   for (int j=0; j < 2; j++)   execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, ?, ?, ?)",i,j,i * 2 + j);
  assertInvalid("SELECT v FROM %s WHERE k = 0 ORDER BY c DESC");
  assertInvalid("SELECT v FROM %s WHERE k = 0 ORDER BY c2 DESC");
  assertInvalid("SELECT v FROM %s WHERE k = 0 ORDER BY k DESC");
  assertRows(execute("SELECT v FROM %s WHERE k = 0 ORDER BY c1 DESC"),row(7),row(6),row(5),row(4),row(3),row(2),row(1),row(0));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 ORDER BY c1"),row(0),row(1),row(2),row(3),row(4),row(5),row(6),row(7));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test reversed comparators
 * migrated from cql_tests.py:TestCQL.reversed_comparator_test()
 */
@Test public void testReversedComparator() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c)) WITH CLUSTERING ORDER BY (c DESC);");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c, v) VALUES (0, ?, ?)",i,i);
  assertRows(execute("SELECT c, v FROM %s WHERE k = 0 ORDER BY c ASC"),row(0,0),row(1,1),row(2,2),row(3,3),row(4,4),row(5,5),row(6,6),row(7,7),row(8,8),row(9,9));
  assertRows(execute("SELECT c, v FROM %s WHERE k = 0 ORDER BY c DESC"),row(9,9),row(8,8),row(7,7),row(6,6),row(5,5),row(4,4),row(3,3),row(2,2),row(1,1),row(0,0));
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v text, PRIMARY KEY (k, c1, c2)) WITH CLUSTERING ORDER BY (c1 ASC, c2 DESC)");
  for (int i=0; i < 10; i++)   for (int j=0; j < 10; j++)   execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, ?, ?, ?)",i,j,String.format("%d%d",i,j));
  assertInvalid("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c1 ASC, c2 ASC");
  assertInvalid("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c1 DESC, c2 DESC");
  Object[][] expectedRows=new Object[100][];
  for (int i=0; i < 10; i++)   for (int j=9; j >= 0; j--)   expectedRows[i * 10 + (9 - j)]=row(i,j,String.format("%d%d",i,j));
  assertRows(execute("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c1 ASC"),expectedRows);
  assertRows(execute("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c1 ASC, c2 DESC"),expectedRows);
  for (int i=9; i >= 0; i--)   for (int j=0; j < 10; j++)   expectedRows[(9 - i) * 10 + j]=row(i,j,String.format("%d%d",i,j));
  assertRows(execute("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c1 DESC, c2 ASC"),expectedRows);
  assertInvalid("SELECT c1, c2, v FROM %s WHERE k = 0 ORDER BY c2 DESC, c1 ASC");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * More ORDER BY checks (#4160)
 * migrated from cql_tests.py:TestCQL.more_order_by_test()
 */
@Test public void testMoreOrderBy() throws Throwable {
  createTable("CREATE TABLE %s (row text, number int, string text, PRIMARY KEY(row, number)) WITH COMPACT STORAGE ");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 1, 'one')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 2, 'two')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 3, 'three')");
  execute("INSERT INTO %s (row, number, string) VALUES ('row', 4, 'four')");
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number < 3 ORDER BY number ASC"),row(1),row(2));
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number >= 3 ORDER BY number ASC"),row(3),row(4));
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number < 3 ORDER BY number DESC"),row(2),row(1));
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number >= 3 ORDER BY number DESC"),row(4),row(3));
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number > 3 ORDER BY number DESC"),row(4));
  assertRows(execute("SELECT number FROM %s WHERE row='row' AND number <= 3 ORDER BY number DESC"),row(3),row(2),row(1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.in_with_desc_order_test()
 */
@Test public void testSelectInStatementWithDesc() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, PRIMARY KEY (k, c1, c2))");
  execute("INSERT INTO %s(k, c1, c2) VALUES (0, 0, 0)");
  execute("INSERT INTO %s(k, c1, c2) VALUES (0, 0, 1)");
  execute("INSERT INTO %s(k, c1, c2) VALUES (0, 0, 2)");
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0) ORDER BY c1 DESC"),row(0,0,2),row(0,0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionSelectionOrderSingleClustering() throws Throwable {
  for (  String descOption : new String[]{""," WITH CLUSTERING ORDER BY (b DESC)"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))" + descOption);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,2,2);
    assertRows(execute("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2));
    assertRows(execute("SELECT blobAsInt(intAsBlob(b)) FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
    assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b ASC",0),row(0),row(1),row(2));
    assertRows(execute("SELECT blobAsInt(intAsBlob(c)) FROM %s WHERE a=? ORDER BY b DESC",0),row(2),row(1),row(0));
    assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY c ASC",0);
    assertInvalid("SELECT * FROM %s WHERE a=? ORDER BY c DESC",0);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multiordering_test()
 */
@Test public void testMultiordering() throws Throwable {
  createTable("CREATE TABLE %s (k text, c1 int, c2 int, PRIMARY KEY (k, c1, c2) ) WITH CLUSTERING ORDER BY (c1 ASC, c2 DESC)");
  for (int i=0; i < 2; i++)   for (int j=0; j < 2; j++)   execute("INSERT INTO %s (k, c1, c2) VALUES ('foo', ?, ?)",i,j);
  assertRows(execute("SELECT c1, c2 FROM %s WHERE k = 'foo'"),row(0,1),row(0,0),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE k = 'foo' ORDER BY c1 ASC, c2 DESC"),row(0,1),row(0,0),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE k = 'foo' ORDER BY c1 DESC, c2 ASC"),row(1,0),row(1,1),row(0,0),row(0,1));
  assertInvalid("SELECT c1, c2 FROM %s WHERE k = 'foo' ORDER BY c2 DESC");
  assertInvalid("SELECT c1, c2 FROM %s WHERE k = 'foo' ORDER BY c2 ASC");
  assertInvalid("SELECT c1, c2 FROM %s WHERE k = 'foo' ORDER BY c1 ASC, c2 ASC");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByForInClauseWithNullValue() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, s int static, d int, PRIMARY KEY (a, b, c))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 1, 1, 1)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 1, 2, 1)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (2, 2, 1, 1)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (2, 2, 2, 1)");
  execute("UPDATE %s SET s = 1 WHERE a = 1");
  execute("UPDATE %s SET s = 2 WHERE a = 2");
  execute("UPDATE %s SET s = 3 WHERE a = 3");
  assertRows(execute("SELECT a, b, c, d, s FROM %s WHERE a IN (1, 2, 3) ORDER BY b DESC"),row(2,2,2,1,2),row(2,2,1,1,2),row(1,1,2,1,1),row(1,1,1,1,1),row(3,null,null,null,3));
  assertRows(execute("SELECT a, b, c, d, s FROM %s WHERE a IN (1, 2, 3) ORDER BY b ASC"),row(3,null,null,null,3),row(1,1,1,1,1),row(1,1,2,1,1),row(2,2,1,1,2),row(2,2,2,1,2));
  assertRows(execute("SELECT a, b, c, d, s FROM %s WHERE a IN (1, 2, 3) ORDER BY b DESC , c DESC"),row(2,2,2,1,2),row(2,2,1,1,2),row(1,1,2,1,1),row(1,1,1,1,1),row(3,null,null,null,3));
  assertRows(execute("SELECT a, b, c, d, s FROM %s WHERE a IN (1, 2, 3) ORDER BY b ASC, c ASC"),row(3,null,null,null,3),row(1,1,1,1,1),row(1,1,2,1,1),row(2,2,1,1,2),row(2,2,2,1,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check we don't allow order by on row key (#4246)
 * migrated from cql_tests.py:TestCQL.order_by_validation_test()
 */
@Test public void testInvalidOrderBy() throws Throwable {
  createTable("CREATE TABLE %s( k1 int, k2 int, v int, PRIMARY KEY (k1, k2))");
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",1,1,1);
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",2,2,2);
  assertInvalid("SELECT * FROM %s ORDER BY k2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check that order-by works with IN (#4327)
 * migrated from cql_tests.py:TestCQL.order_by_with_in_test()
 */
@Test public void testOrderByForInClause() throws Throwable {
  createTable("CREATE TABLE %s (my_id varchar, col1 int, value varchar, PRIMARY KEY (my_id, col1))");
  execute("INSERT INTO %s (my_id, col1, value) VALUES ( 'key1', 1, 'a')");
  execute("INSERT INTO %s (my_id, col1, value) VALUES ( 'key2', 3, 'c')");
  execute("INSERT INTO %s (my_id, col1, value) VALUES ( 'key3', 2, 'b')");
  execute("INSERT INTO %s (my_id, col1, value) VALUES ( 'key4', 4, 'd')");
  assertRows(execute("SELECT col1 FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1"),row(1),row(2),row(3));
  assertRows(execute("SELECT col1 FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1 LIMIT 2"),row(1),row(2));
  assertRows(execute("SELECT col1 FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1 LIMIT 10"),row(1),row(2),row(3));
  assertRows(execute("SELECT col1, my_id FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1"),row(1,"key1"),row(2,"key3"),row(3,"key2"));
  assertRows(execute("SELECT my_id, col1 FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1"),row("key1",1),row("key3",2),row("key2",3));
  createTable("CREATE TABLE %s (pk1 int, pk2 int, c int, v text, PRIMARY KEY ((pk1, pk2), c) )");
  execute("INSERT INTO %s (pk1, pk2, c, v) VALUES (?, ?, ?, ?)",1,1,2,"A");
  execute("INSERT INTO %s (pk1, pk2, c, v) VALUES (?, ?, ?, ?)",1,2,1,"B");
  execute("INSERT INTO %s (pk1, pk2, c, v) VALUES (?, ?, ?, ?)",1,3,3,"C");
  execute("INSERT INTO %s (pk1, pk2, c, v) VALUES (?, ?, ?, ?)",1,1,4,"D");
  assertRows(execute("SELECT v, ttl(v), c FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c; ",1,1,2),row("B",null,1),row("A",null,2),row("D",null,4));
  assertRows(execute("SELECT v, ttl(v), c as name_1 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c; ",1,1,2),row("B",null,1),row("A",null,2),row("D",null,4));
  assertRows(execute("SELECT v FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c; ",1,1,2),row("B"),row("A"),row("D"));
  assertRows(execute("SELECT v FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c LIMIT 2; ",1,1,2),row("B"),row("A"));
  assertRows(execute("SELECT v FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c LIMIT 10; ",1,1,2),row("B"),row("A"),row("D"));
  assertRows(execute("SELECT v as c FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c; ",1,1,2),row("B"),row("A"),row("D"));
  createTable("CREATE TABLE %s (pk1 int, pk2 int, c1 int, c2 int, v text, PRIMARY KEY ((pk1, pk2), c1, c2) )");
  execute("INSERT INTO %s (pk1, pk2, c1, c2, v) VALUES (?, ?, ?, ?, ?)",1,1,4,4,"A");
  execute("INSERT INTO %s (pk1, pk2, c1, c2, v) VALUES (?, ?, ?, ?, ?)",1,2,1,2,"B");
  execute("INSERT INTO %s (pk1, pk2, c1, c2, v) VALUES (?, ?, ?, ?, ?)",1,3,3,3,"C");
  execute("INSERT INTO %s (pk1, pk2, c1, c2, v) VALUES (?, ?, ?, ?, ?)",1,1,4,1,"D");
  assertRows(execute("SELECT v, ttl(v), c1, c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2; ",1,1,2),row("B",null,1,2),row("D",null,4,1),row("A",null,4,4));
  assertRows(execute("SELECT v, ttl(v), c1 as name_1, c2 as name_2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2; ",1,1,2),row("B",null,1,2),row("D",null,4,1),row("A",null,4,4));
  assertRows(execute("SELECT v FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2; ",1,1,2),row("B"),row("D"),row("A"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2; ",1,1,2),row("B"),row("D"),row("A"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2 LIMIT 2; ",1,1,2),row("B"),row("D"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1, c2 LIMIT 10; ",1,1,2),row("B"),row("D"),row("A"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1 DESC , c2 DESC; ",1,1,2),row("A"),row("D"),row("B"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1 DESC , c2 DESC LIMIT 2; ",1,1,2),row("A"),row("D"));
  assertRows(execute("SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1 DESC , c2 DESC LIMIT 10; ",1,1,2),row("A"),row("D"),row("B"));
  assertInvalidMessage("LIMIT must be strictly positive","SELECT v as c2 FROM %s where pk1 = ? AND pk2 IN (?, ?) ORDER BY c1 DESC , c2 DESC LIMIT 0; ",1,1,2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectOrderedPartitionerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #4612 bug and more generally order by when multiple C* rows are queried
 * migrated from cql_tests.py:TestCQL.order_by_multikey_test()
 */
@Test public void testOrderByMultikey() throws Throwable {
  createTable("CREATE TABLE %s (my_id varchar, col1 int, col2 int, value varchar, PRIMARY KEY (my_id, col1, col2))");
  execute("INSERT INTO %s (my_id, col1, col2, value) VALUES ( 'key1', 1, 1, 'a');");
  execute("INSERT INTO %s (my_id, col1, col2, value) VALUES ( 'key2', 3, 3, 'a');");
  execute("INSERT INTO %s (my_id, col1, col2, value) VALUES ( 'key3', 2, 2, 'b');");
  execute("INSERT INTO %s (my_id, col1, col2, value) VALUES ( 'key4', 2, 1, 'b');");
  assertRows(execute("SELECT col1 FROM %s WHERE my_id in('key1', 'key2', 'key3') ORDER BY col1"),row(1),row(2),row(3));
  assertRows(execute("SELECT col1, value, my_id, col2 FROM %s WHERE my_id in('key3', 'key4') ORDER BY col1, col2"),row(2,"b","key4",1),row(2,"b","key3",2));
  assertInvalid("SELECT col1 FROM %s ORDER BY col1");
  assertInvalid("SELECT col1 FROM %s WHERE my_id > 'key1' ORDER BY col1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check table with only a PK (#4361),
 * migrated from cql_tests.py:TestCQL.only_pk_test()
 */
@Test public void testPrimaryKeyOnly() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, PRIMARY KEY (k, c))");
  for (int k=0; k < 2; k++)   for (int c=0; c < 2; c++)   execute("INSERT INTO %s (k, c) VALUES (?, ?)",k,c);
  assertRows(execute("SELECT * FROM %s"),row(0,0),row(0,1),row(1,0),row(1,1));
  createTable(" CREATE TABLE %s (k int, c int, PRIMARY KEY (k, c)) WITH COMPACT STORAGE");
  for (int k=0; k < 2; k++)   for (int c=0; c < 2; c++)   execute("INSERT INTO %s (k, c) VALUES (?, ?)",k,c);
  assertRows(execute("SELECT * FROM %s"),row(0,0),row(0,1),row(1,0),row(1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFunctionWithPartitionKeyAndClusteringKeyArguments() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b text, PRIMARY KEY (a, b))");
  assertInvalidMessage("The token() function must contains only partition key components","SELECT * FROM %s WHERE token(a, b) > token(0, 'c')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.truncate_clean_cache_test()
 */
@Test public void testTruncateWithCaching() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v1 int, v2 int) WITH CACHING = { 'keys': 'ALL', 'rows_per_partition': 'ALL' };");
  for (int i=0; i < 3; i++)   execute("INSERT INTO %s (k, v1, v2) VALUES (?, ?, ?)",i,i,i * 2);
  assertRows(execute("SELECT v1, v2 FROM %s WHERE k IN (0, 1, 2)"),row(0,0),row(1,2),row(2,4));
  execute("TRUNCATE %s");
  assertEmpty(execute("SELECT v1, v2 FROM %s WHERE k IN (0, 1, 2)"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiColumnPartitionKeyWithIndexAndTokenNonTokenRestrictionsMix() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, primary key((a, b)))");
  createIndex("CREATE INDEX ON %s(b)");
  createIndex("CREATE INDEX ON %s(c)");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 0, 0);");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 1, 1);");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 2, 2);");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 0, 3);");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 4);");
  assertRows(execute("SELECT * FROM %s WHERE b = ?;",1),row(0,1,1),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE token(a, b) > token(?, ?) AND b = ?;",0,0,1),row(0,1,1),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE b = ? AND token(a, b) > token(?, ?);",1,0,0),row(0,1,1),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE b = ? AND token(a, b) > token(?, ?) and c = ? ALLOW FILTERING;",1,0,0,4),row(1,1,4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFunctionWithInvalidColumnNames() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY ((a, b), c))");
  assertInvalidMessage("Undefined name e in where clause ('token(a, e) = token(0, 0)')","SELECT * FROM %s WHERE token(a, e) = token(0, 0)");
  assertInvalidMessage("Undefined name e in where clause ('token(a, e) > token(0, 1)')","SELECT * FROM %s WHERE token(a, e) > token(0, 1)");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('token(a, e) = token(0, 0)')","SELECT b AS e FROM %s WHERE token(a, e) = token(0, 0)");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('token(a, e) > token(0, 1)')","SELECT b AS e FROM %s WHERE token(a, e) > token(0, 1)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFunctionWithCompoundPartitionAndClusteringCols() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b int, c int, d int, PRIMARY KEY ((a, b), c, d))");
  execute("SELECT * FROM %s WHERE token(a, b) > token(0, 0) AND c > 10 ALLOW FILTERING;");
  execute("SELECT * FROM %s WHERE c > 10 AND token(a, b) > token(0, 0) ALLOW FILTERING;");
  execute("SELECT * FROM %s WHERE token(a, b) > token(0, 0) AND (c, d) > (0, 0) ALLOW FILTERING;");
  execute("SELECT * FROM %s WHERE (c, d) > (0, 0) AND token(a, b) > token(0, 0) ALLOW FILTERING;");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFunctionWithSingleColumnPartitionKey() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int PRIMARY KEY, b text)");
  execute("INSERT INTO %s (a, b) VALUES (0, 'a')");
  assertRows(execute("SELECT * FROM %s WHERE token(a) >= token(?)",0),row(0,"a"));
  assertRows(execute("SELECT * FROM %s WHERE token(a) >= token(?) and token(a) < token(?)",0,1),row(0,"a"));
  assertInvalid("SELECT * FROM %s WHERE token(a) > token(?)","a");
  assertInvalidMessage("The token() function must contains only partition key components","SELECT * FROM %s WHERE token(a, b) >= token(?, ?)","b",0);
  assertInvalidMessage("More than one restriction was found for the start bound on a","SELECT * FROM %s WHERE token(a) >= token(?) and token(a) >= token(?)",0,1);
  assertInvalidMessage("Columns \"a\" cannot be restricted by both an equality and an inequality relation","SELECT * FROM %s WHERE token(a) >= token(?) and token(a) = token(?)",0,1);
  assertInvalidSyntax("SELECT * FROM %s WHERE token(a) = token(?) and token(a) IN (token(?))",0,1);
  assertInvalidMessage("More than one restriction was found for the start bound on a","SELECT * FROM %s WHERE token(a) > token(?) AND token(a) > token(?)",1,2);
  assertInvalidMessage("More than one restriction was found for the end bound on a","SELECT * FROM %s WHERE token(a) <= token(?) AND token(a) < token(?)",1,2);
  assertInvalidMessage("Columns \"a\" cannot be restricted by both an equality and an inequality relation","SELECT * FROM %s WHERE token(a) > token(?) AND token(a) = token(?)",1,2);
  assertInvalidMessage("a cannot be restricted by more than one relation if it includes an Equal","SELECT * FROM %s WHERE  token(a) = token(?) AND token(a) > token(?)",1,2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.composite_index_with_pk_test()
 */
@Test public void testCompositeIndexWithPK() throws Throwable {
  createTable("CREATE TABLE %s (blog_id int, time1 int, time2 int, author text, content text, PRIMARY KEY (blog_id, time1, time2))");
  createIndex("CREATE INDEX ON %s(author)");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, ?)",1,0,0,"foo","bar1");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, ?)",1,0,1,"foo","bar2");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, ?)",2,1,0,"foo","baz");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, ?)",3,0,1,"gux","qux");
  assertRows(execute("SELECT blog_id, content FROM %s WHERE author='foo'"),row(1,"bar1"),row(1,"bar2"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 > 0 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 = 1 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 = 1 AND time2 = 0 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertEmpty(execute("SELECT content FROM %s WHERE time1 = 1 AND time2 = 1 AND author='foo' ALLOW FILTERING"));
  assertEmpty(execute("SELECT content FROM %s WHERE time1 = 1 AND time2 > 0 AND author='foo' ALLOW FILTERING"));
  assertInvalid("SELECT content FROM %s WHERE time2 >= 0 AND author='foo'");
  assertInvalid("SELECT blog_id, content FROM %s WHERE time1 > 0 AND author='foo'");
  assertInvalid("SELECT blog_id, content FROM %s WHERE time1 = 1 AND author='foo'");
  assertInvalid("SELECT blog_id, content FROM %s WHERE time1 = 1 AND time2 = 0 AND author='foo'");
  assertInvalid("SELECT content FROM %s WHERE time1 = 1 AND time2 = 1 AND author='foo'");
  assertInvalid("SELECT content FROM %s WHERE time1 = 1 AND time2 > 0 AND author='foo'");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.range_key_ordered_test()
 */
@Test public void testRangeKey() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY)");
  execute("INSERT INTO %s (k) VALUES (-1)");
  execute("INSERT INTO %s (k) VALUES ( 0)");
  execute("INSERT INTO %s (k) VALUES ( 1)");
  assertRows(execute("SELECT * FROM %s"),row(0),row(1),row(-1));
  assertInvalid("SELECT * FROM %s WHERE k >= -1 AND k < 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleColumnPartitionKeyWithTokenNonTokenRestrictionsMix() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int)");
  execute("INSERT INTO %s (a, b) VALUES (0, 0);");
  execute("INSERT INTO %s (a, b) VALUES (1, 1);");
  execute("INSERT INTO %s (a, b) VALUES (2, 2);");
  execute("INSERT INTO %s (a, b) VALUES (3, 3);");
  execute("INSERT INTO %s (a, b) VALUES (4, 4);");
  assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?);",1,3),row(1,1),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a)> token(?) and token(a) <= token(?);",1,3),row(2,2),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a)= token(2);"),row(2,2));
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND token(a) <= token(?) AND a IN (?, ?);",1,3,1,3),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) < token(?) AND token(a) >= token(?) AND a IN (?, ?);",1,3,1,3),row(3,3));
  assertInvalidMessage("Only EQ and IN relation are supported on the partition key (unless you use the token() function)","SELECT * FROM %s WHERE token(a) > token(?) AND token(a) <= token(?) AND a > ?;",1,3,1);
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND token(a) <= token(?) AND a IN ?;",1,3,Arrays.asList(1,3)),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND a = ?;",1,3),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND token(a) > token(?);",3,1),row(3,3));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) > token(?) AND a = ?;",3,1));
  assertEmpty(execute("SELECT * FROM %s WHERE a = ? AND token(a) > token(?);",1,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND a IN (?, ?);",2,1,3),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND token(a) < token(?) AND a IN (?, ?) ;",2,5,1,3),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE a IN (?, ?) AND token(a) > token(?) AND token(a) < token(?);",1,3,2,5),row(3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) > token(?) AND a IN (?, ?) AND token(a) < token(?);",2,1,3,5),row(3,3));
  assertEmpty(execute("SELECT * FROM %s WHERE a IN (?, ?) AND token(a) > token(?);",1,3,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) <= token(?) AND a = ?;",2,2),row(2,2));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) <= token(?) AND a = ?;",2,3));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) = token(?) AND a = ?;",2,3));
  assertRows(execute("SELECT * FROM %s WHERE token(a) >= token(?) AND token(a) <= token(?) AND a = ?;",2,2,2),row(2,2));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) >= token(?) AND token(a) < token(?) AND a = ?;",2,2,2));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) > token(?) AND token(a) <= token(?) AND a = ?;",2,2,2));
  assertEmpty(execute("SELECT * FROM %s WHERE token(a) > token(?) AND token(a) < token(?) AND a = ?;",2,2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFunctionWithMultiColumnPartitionKey() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b text, PRIMARY KEY ((a, b)))");
  execute("INSERT INTO %s (a, b) VALUES (0, 'a')");
  execute("INSERT INTO %s (a, b) VALUES (0, 'b')");
  execute("INSERT INTO %s (a, b) VALUES (0, 'c')");
  assertRows(execute("SELECT * FROM %s WHERE token(a, b) > token(?, ?)",0,"a"),row(0,"b"),row(0,"c"));
  assertRows(execute("SELECT * FROM %s WHERE token(a, b) > token(?, ?) and token(a, b) < token(?, ?)",0,"a",0,"d"),row(0,"b"),row(0,"c"));
  assertInvalidMessage("The token() function must be applied to all partition key components or none of them","SELECT * FROM %s WHERE token(a) > token(?) and token(b) > token(?)",0,"a");
  assertInvalidMessage("The token() function must be applied to all partition key components or none of them","SELECT * FROM %s WHERE token(a) > token(?, ?) and token(a) < token(?, ?) and token(b) > token(?, ?) ",0,"a",0,"d",0,"a");
  assertInvalidMessage("The token function arguments must be in the partition key order: a, b","SELECT * FROM %s WHERE token(b, a) > token(0, 'c')");
  assertInvalidMessage("The token() function must be applied to all partition key components or none of them","SELECT * FROM %s WHERE token(a, b) > token(?, ?) and token(b) < token(?, ?)",0,"a",0,"a");
  assertInvalidMessage("The token() function must be applied to all partition key components or none of them","SELECT * FROM %s WHERE token(a) > token(?, ?) and token(b) > token(?, ?)",0,"a",0,"a");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.composite_index_collections_test()
 */
@Test public void testIndexOnCompositeWithCollections() throws Throwable {
  createTable("CREATE TABLE %s (blog_id int, time1 int, time2 int, author text, content set<text>, PRIMARY KEY (blog_id, time1, time2))");
  createIndex("CREATE INDEX ON %s (author)");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, { 'bar1', 'bar2' })",1,0,0,"foo");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, { 'bar2', 'bar3' })",1,0,1,"foo");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, { 'baz' })",2,1,0,"foo");
  execute("INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, { 'qux' })",3,0,1,"gux");
  assertRows(execute("SELECT blog_id, content FROM %s WHERE author='foo'"),row(1,set("bar1","bar2")),row(1,set("bar2","bar3")),row(2,set("baz")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiColumnPartitionKeyWithTokenNonTokenRestrictionsMix() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, primary key((a, b)))");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 0, 0);");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 1, 1);");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 2, 2);");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 0, 3);");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 4);");
  assertRows(execute("SELECT * FROM %s WHERE token(a, b) > token(?, ?);",0,0),row(0,1,1),row(0,2,2),row(1,0,3),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE token(a, b) > token(?, ?) AND a = ? AND b IN (?, ?);",0,0,1,0,1),row(1,0,3),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND token(a, b) > token(?, ?) AND b IN (?, ?);",1,0,0,0,1),row(1,0,3),row(1,1,4));
  assertRows(execute("SELECT * FROM %s WHERE b IN (?, ?) AND token(a, b) > token(?, ?) AND a = ?;",0,1,0,0,1),row(1,0,3),row(1,1,4));
  assertEmpty(execute("SELECT * FROM %s WHERE b IN (?, ?) AND token(a, b) > token(?, ?) AND token(a, b) < token(?, ?) AND a = ?;",0,1,0,0,0,0,1));
  assertEmpty(execute("SELECT * FROM %s WHERE b IN (?, ?) AND token(a, b) > token(?, ?) AND token(a, b) <= token(?, ?) AND a = ?;",0,1,0,0,0,0,1));
  assertEmpty(execute("SELECT * FROM %s WHERE b IN (?, ?) AND token(a, b) >= token(?, ?) AND token(a, b) < token(?, ?) AND a = ?;",0,1,0,0,0,0,1));
  assertEmpty(execute("SELECT * FROM %s WHERE b IN (?, ?) AND token(a, b) = token(?, ?) AND a = ?;",0,1,0,0,1));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE token(a, b) > token(?, ?) AND a = ?;",0,0,1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for LIMIT bugs from 4579,
 * migrated from cql_tests.py:TestCQL.limit_bugs_test()
 */
@Test public void testLimitBug() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (1, 1, 1, 1, 1);");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (2, 2, 2, 2, 2);");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (3, 3, 3, 3, 3);");
  execute("INSERT INTO %s (a, b, c, d, e) VALUES (4, 4, 4, 4, 4);");
  assertRows(execute("SELECT * FROM %s"),row(1,1,1,1,1),row(2,2,2,2,2),row(3,3,3,3,3),row(4,4,4,4,4));
  assertRows(execute("SELECT * FROM %s LIMIT 1"),row(1,1,1,1,1));
  assertRows(execute("SELECT * FROM %s LIMIT 2"),row(1,1,1,1,1),row(2,2,2,2,2));
  createTable("CREATE TABLE %s (a int primary key, b int, c int,)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 1, 1)");
  execute("INSERT INTO %s (a, b, c) VALUES (2, 2, 2)");
  execute("INSERT INTO %s (a, b, c) VALUES (3, 3, 3)");
  execute("INSERT INTO %s (a, b, c) VALUES (4, 4, 4)");
  assertRows(execute("SELECT * FROM %s"),row(1,1,1),row(2,2,2),row(3,3,3),row(4,4,4));
  assertRows(execute("SELECT * FROM %s LIMIT 1"),row(1,1,1));
  assertRows(execute("SELECT * FROM %s LIMIT 2"),row(1,1,1),row(2,2,2));
  assertRows(execute("SELECT * FROM %s LIMIT 3"),row(1,1,1),row(2,2,2),row(3,3,3));
  assertRows(execute("SELECT * FROM %s LIMIT 4"),row(1,1,1),row(2,2,2),row(3,3,3),row(4,4,4));
  assertRows(execute("SELECT * FROM %s LIMIT 5"),row(1,1,1),row(2,2,2),row(3,3,3),row(4,4,4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectSingleColumnRelationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompositeIndexWithPrimaryKey() throws Throwable {
  createTable("CREATE TABLE %s (blog_id int, time1 int, time2 int, author text, content text, PRIMARY KEY (blog_id, time1, time2))");
  createIndex("CREATE INDEX ON %s(author)");
  String req="INSERT INTO %s (blog_id, time1, time2, author, content) VALUES (?, ?, ?, ?, ?)";
  execute(req,1,0,0,"foo","bar1");
  execute(req,1,0,1,"foo","bar2");
  execute(req,2,1,0,"foo","baz");
  execute(req,3,0,1,"gux","qux");
  assertRows(execute("SELECT blog_id, content FROM %s WHERE author='foo'"),row(1,"bar1"),row(1,"bar2"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 > 0 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 = 1 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertRows(execute("SELECT blog_id, content FROM %s WHERE time1 = 1 AND time2 = 0 AND author='foo' ALLOW FILTERING"),row(2,"baz"));
  assertEmpty(execute("SELECT content FROM %s WHERE time1 = 1 AND time2 = 1 AND author='foo' ALLOW FILTERING"));
  assertEmpty(execute("SELECT content FROM %s WHERE time1 = 1 AND time2 > 0 AND author='foo' ALLOW FILTERING"));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT content FROM %s WHERE time2 >= 0 AND author='foo'");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexOnClusteringColumns() throws Throwable {
  createTable("CREATE TABLE %s (id1 int, id2 int, author text, time bigint, v1 text, v2 text, PRIMARY KEY ((id1, id2), author, time))");
  createIndex("CREATE INDEX ON %s(time)");
  createIndex("CREATE INDEX ON %s(id2)");
  execute("INSERT INTO %s(id1, id2, author, time, v1, v2) VALUES(0, 0, 'bob', 0, 'A', 'A')");
  execute("INSERT INTO %s(id1, id2, author, time, v1, v2) VALUES(0, 0, 'bob', 1, 'B', 'B')");
  execute("INSERT INTO %s(id1, id2, author, time, v1, v2) VALUES(0, 1, 'bob', 2, 'C', 'C')");
  execute("INSERT INTO %s(id1, id2, author, time, v1, v2) VALUES(0, 0, 'tom', 0, 'D', 'D')");
  execute("INSERT INTO %s(id1, id2, author, time, v1, v2) VALUES(0, 1, 'tom', 1, 'E', 'E')");
  assertRows(execute("SELECT v1 FROM %s WHERE time = 1"),row("B"),row("E"));
  assertRows(execute("SELECT v1 FROM %s WHERE id2 = 1"),row("C"),row("E"));
  assertRows(execute("SELECT v1 FROM %s WHERE id1 = 0 AND id2 = 0 AND author = 'bob' AND time = 0"),row("A"));
  execute("UPDATE %s SET v2 = null WHERE id1 = 0 AND id2 = 0 AND author = 'bob' AND time = 1");
  assertRows(execute("SELECT v1 FROM %s WHERE id2 = 0"),row("A"),row("B"),row("D"));
  assertRows(execute("SELECT v1 FROM %s WHERE time = 1"),row("B"),row("E"));
  assertInvalidMessage("IN restrictions are not supported on indexed columns","SELECT v1 FROM %s WHERE id2 = 0 and time IN (1, 2) ALLOW FILTERING");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidColumnNames() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c map<int, int>, PRIMARY KEY (a, b))");
  assertInvalidMessage("Undefined name d in where clause ('d = 0')","SELECT * FROM %s WHERE d = 0");
  assertInvalidMessage("Undefined name d in where clause ('d IN [0, 1]')","SELECT * FROM %s WHERE d IN (0, 1)");
  assertInvalidMessage("Undefined name d in where clause ('d > 0')","SELECT * FROM %s WHERE d > 0 and d <= 2");
  assertInvalidMessage("Undefined name d in where clause ('d CONTAINS 0')","SELECT * FROM %s WHERE d CONTAINS 0");
  assertInvalidMessage("Undefined name d in where clause ('d CONTAINS KEY 0')","SELECT * FROM %s WHERE d CONTAINS KEY 0");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('d = 0')","SELECT a AS d FROM %s WHERE d = 0");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('d IN [0, 1]')","SELECT b AS d FROM %s WHERE d IN (0, 1)");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('d > 0')","SELECT b AS d FROM %s WHERE d > 0 and d <= 2");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('d CONTAINS 0')","SELECT c AS d FROM %s WHERE d CONTAINS 0");
  assertInvalidMessage("Aliases aren't allowed in the where clause ('d CONTAINS KEY 0')","SELECT c AS d FROM %s WHERE d CONTAINS KEY 0");
  assertInvalidMessage("Undefined name d in selection clause","SELECT d FROM %s WHERE a = 0");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringColumnRelations() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, d int, primary key(a, b, c))");
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",1,5,1);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",2,6,2);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",3,7,3);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","second",4,8,4);
  testSelectQueriesWithClusteringColumnRelations();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, i int)");
  execute("INSERT INTO %s (k, i) VALUES (1, 1)");
  execute("INSERT INTO %s (k, i) VALUES (2, 1)");
  assertRows(execute("SELECT k FROM %s LIMIT ?",unset()),row(1),row(2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeQueryOnIndex() throws Throwable {
  createTable("CREATE TABLE %s (id int primary key, row int, setid int);");
  createIndex("CREATE INDEX ON %s (setid)");
  String q="INSERT INTO %s (id, row, setid) VALUES (?, ?, ?);";
  execute(q,0,0,0);
  execute(q,1,1,0);
  execute(q,2,2,0);
  execute(q,3,3,0);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE setid = 0 AND row < 1;");
  assertRows(execute("SELECT * FROM %s WHERE setid = 0 AND row < 1 ALLOW FILTERING;"),row(0,0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyIN() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (k1 int, k2 int, v int, PRIMARY KEY (k1, k2))" + compactOption);
    for (int i=0; i <= 2; i++)     for (int j=0; j <= 2; j++)     execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",i,j,i + j);
    assertEmpty(execute("SELECT v FROM %s WHERE k1 IN ()"));
    assertEmpty(execute("SELECT v FROM %s WHERE k1 = 0 AND k2 IN ()"));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLargeClusteringINValues() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c))");
  execute("INSERT INTO %s (k, c, v) VALUES (0, 0, 0)");
  List<Integer> inValues=new ArrayList<>(10000);
  for (int i=0; i < 10000; i++)   inValues.add(i);
  assertRows(execute("SELECT * FROM %s WHERE k=? AND c IN ?",0,inValues),row(0,0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllowFilteringWithIndexedColumn() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, a int, b int)");
  createIndex("CREATE INDEX ON %s(a)");
  execute("INSERT INTO %s(k, a, b) VALUES(?, ?, ?)",1,10,100);
  execute("INSERT INTO %s(k, a, b) VALUES(?, ?, ?)",2,20,200);
  execute("INSERT INTO %s(k, a, b) VALUES(?, ?, ?)",3,30,300);
  execute("INSERT INTO %s(k, a, b) VALUES(?, ?, ?)",4,40,400);
  assertRows(execute("SELECT * FROM %s WHERE k = ?",1),row(1,10,100));
  assertRows(execute("SELECT * FROM %s WHERE a = ?",20),row(2,20,200));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ALLOW FILTERING",1),row(1,10,100));
  assertRows(execute("SELECT * FROM %s WHERE a = ? ALLOW FILTERING",20),row(2,20,200));
  assertInvalid("SELECT * FROM %s WHERE a = ? AND b = ?");
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? ALLOW FILTERING",20,200),row(2,20,200));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringColumnRelationsWithCompactStorage() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, d int, primary key(a, b, c)) WITH COMPACT STORAGE;");
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",1,5,1);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",2,6,2);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",3,7,3);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","second",4,8,4);
  testSelectQueriesWithClusteringColumnRelations();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidCollectionEqualityRelation() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b set<int>, c list<int>, d map<int, int>)");
  createIndex("CREATE INDEX ON %s (b)");
  createIndex("CREATE INDEX ON %s (c)");
  createIndex("CREATE INDEX ON %s (d)");
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a '=' relation","SELECT * FROM %s WHERE a = 0 AND b=?",set(0));
  assertInvalidMessage("Collection column 'c' (list<int>) cannot be restricted by a '=' relation","SELECT * FROM %s WHERE a = 0 AND c=?",list(0));
  assertInvalidMessage("Collection column 'd' (map<int, int>) cannot be restricted by a '=' relation","SELECT * FROM %s WHERE a = 0 AND d=?",map(0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllowFilteringWithClusteringColumn() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c))");
  execute("INSERT INTO %s (k, c, v) VALUES(?, ?, ?)",1,2,1);
  execute("INSERT INTO %s (k, c, v) VALUES(?, ?, ?)",1,3,2);
  execute("INSERT INTO %s (k, c, v) VALUES(?, ?, ?)",2,2,3);
  assertRows(execute("SELECT * FROM %s WHERE k = ?",1),row(1,2,1),row(1,3,2));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND c > ?",1,2),row(1,3,2));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND c = ?",1,2),row(1,2,1));
  assertRows(execute("SELECT * FROM %s WHERE k = ? ALLOW FILTERING",1),row(1,2,1),row(1,3,2));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND c > ? ALLOW FILTERING",1,2),row(1,3,2));
  assertRows(execute("SELECT * FROM %s WHERE k = ? AND c = ? ALLOW FILTERING",1,2),row(1,2,1));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE c = ?",2);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE c > ? AND c <= ?",2,4);
  assertRows(execute("SELECT * FROM %s WHERE c = ? ALLOW FILTERING",2),row(1,2,1),row(2,2,3));
  assertRows(execute("SELECT * FROM %s WHERE c > ? AND c <= ? ALLOW FILTERING",2,4),row(1,3,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiplePartitionKeyWithIndex() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, f int, PRIMARY KEY ((a, b), c, d, e))");
  createIndex("CREATE INDEX ON %s (c)");
  createIndex("CREATE INDEX ON %s (f)");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,0,1);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,0,1,1,2);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,0,0,3);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,0,4);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,1,1,1,5);
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (?, ?, ?, ?, ?, ?)",0,0,2,0,0,5);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c = ?",0,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? ALLOW FILTERING",0,1),row(0,0,1,0,0,3),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c = ? AND d = ?",0,1,1);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? AND d = ? ALLOW FILTERING",0,1,1),row(0,0,1,1,0,4),row(0,0,1,1,1,5));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND c IN (?) AND  d IN (?) ALLOW FILTERING",0,1,1);
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND (c, d) >= (?, ?) ALLOW FILTERING",0,1,1);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c IN (?) AND f = ?",0,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c IN (?) AND f = ? ALLOW FILTERING",0,1,5),row(0,0,1,1,1,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c IN (?, ?) AND f = ?",0,1,2,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c IN (?, ?) AND f = ? ALLOW FILTERING",0,1,2,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c IN (?) AND d IN (?) AND f = ?",0,1,0,3);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c IN (?) AND d IN (?) AND f = ? ALLOW FILTERING",0,1,0,3),row(0,0,1,0,0,3));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","SELECT * FROM %s WHERE a = ? AND c >= ? ALLOW FILTERING",0,1);
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c >= ? AND f = ?",0,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND c >= ? AND f = ?",0,0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c >= ? AND f = ? ALLOW FILTERING",0,1,5),row(0,0,1,1,1,5),row(0,0,2,0,0,5));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering","SELECT * FROM %s WHERE a = ? AND c = ? AND d >= ? AND f = ?",0,1,1,5);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ? AND c = ? AND d >= ? AND f = ?",0,0,1,1,5),row(0,0,1,1,1,5));
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND c = ? AND d >= ? AND f = ? ALLOW FILTERING",0,1,1,5),row(0,0,1,1,1,5));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringColumnRelationsWithClusteringOrder() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, d int, primary key(a, b, c)) WITH CLUSTERING ORDER BY (b DESC);");
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",1,5,1);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",2,6,2);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",3,7,3);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","second",4,8,4);
  assertRows(execute("select * from %s where a = ? and c in (?, ?) and b in (?, ?) order by b DESC","first",7,6,3,2),row("first",3,7,3),row("first",2,6,2));
  assertRows(execute("select * from %s where a = ? and c in (?, ?) and b in (?, ?) order by b ASC","first",7,6,3,2),row("first",2,6,2),row("first",3,7,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testINWithDuplicateValue() throws Throwable {
  for (  String compactOption : new String[]{""," WITH COMPACT STORAGE"}) {
    createTable("CREATE TABLE %s (k1 int, k2 int, v int, PRIMARY KEY (k1, k2))" + compactOption);
    execute("INSERT INTO %s (k1,  k2, v) VALUES (?, ?, ?)",1,1,1);
    assertRows(execute("SELECT * FROM %s WHERE k1 IN (?, ?)",1,1),row(1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE k1 IN (?, ?) AND k2 IN (?, ?)",1,1,1,1),row(1,1,1));
    assertRows(execute("SELECT * FROM %s WHERE k1 = ? AND k2 IN (?, ?)",1,1,1),row(1,1,1));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidCollectionNonEQRelation() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b set<int>, c int)");
  createIndex("CREATE INDEX ON %s (c)");
  execute("INSERT INTO %s (a, b, c) VALUES (0, {0}, 0)");
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a '>' relation","SELECT * FROM %s WHERE c = 0 AND b > ?",set(0));
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a '>=' relation","SELECT * FROM %s WHERE c = 0 AND b >= ?",set(0));
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a '<' relation","SELECT * FROM %s WHERE c = 0 AND b < ?",set(0));
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a '<=' relation","SELECT * FROM %s WHERE c = 0 AND b <= ?",set(0));
  assertInvalidMessage("Collection column 'b' (set<int>) cannot be restricted by a 'IN' relation","SELECT * FROM %s WHERE c = 0 AND b IN (?)",set(0));
  assertInvalidMessage("Unsupported \"!=\" relation: b != 5","SELECT * FROM %s WHERE c = 0 AND b != 5");
  assertInvalidMessage("Unsupported restriction: b IS NOT NULL","SELECT * FROM %s WHERE c = 0 AND b IS NOT NULL");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidSliceRestrictionOnPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (a int PRIMARY KEY, b int, c text)");
  assertInvalidMessage("Only EQ and IN relation are supported on the partition key (unless you use the token() function)","SELECT * FROM %s WHERE a >= 1 and a < 4");
  assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a) >= (1) and (a) < (4)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithUnsetValues() throws Throwable {
  createTable("CREATE TABLE %s (k int, i int, j int, s text, PRIMARY KEY(k,i,j))");
  createIndex("CREATE INDEX s_index ON %s (s)");
  assertInvalidMessage("Invalid unset value for column k","SELECT * from %s WHERE k = ?",unset());
  assertInvalidMessage("Invalid unset value for column k","SELECT * from %s WHERE k IN ?",unset());
  assertInvalidMessage("Invalid unset value for column k","SELECT * from %s WHERE k IN(?)",unset());
  assertInvalidMessage("Invalid unset value for column k","SELECT * from %s WHERE k IN(?,?)",1,unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE k = 1 AND i = ?",unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE k = 1 AND i IN ?",unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE k = 1 AND i IN(?)",unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE k = 1 AND i IN(?,?)",1,unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE i = ? ALLOW FILTERING",unset());
  assertInvalidMessage("Unsupported unset value for indexed column s","SELECT * from %s WHERE s = ?",unset());
  assertInvalidMessage("Invalid unset value for column i","SELECT * from %s WHERE k = 1 AND i > ?",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidMulticolumnSliceRestrictionOnPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c text, PRIMARY KEY ((a, b)))");
  assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a, b) >= (1, 1) and (a, b) < (4, 1)");
  assertInvalidMessage("Only EQ and IN relation are supported on the partition key (unless you use the token() function)","SELECT * FROM %s WHERE a >= 1 and (a, b) < (4, 1)");
  assertInvalidMessage("Only EQ and IN relation are supported on the partition key (unless you use the token() function)","SELECT * FROM %s WHERE b >= 1 and (a, b) < (4, 1)");
  assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a, b) >= (1, 1) and (b) < (4)");
  assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: b","SELECT * FROM %s WHERE (b) < (4) and (a, b) >= (1, 1)");
  assertInvalidMessage("Multi-column relations can only be applied to clustering columns but was applied to: a","SELECT * FROM %s WHERE (a, b) >= (1, 1) and a = 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartitionKeyColumnRelations() throws Throwable {
  createTable("CREATE TABLE %s (a text, b int, c int, d int, primary key((a, b), c))");
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",1,1,1);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",2,2,2);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",3,3,3);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","first",4,4,4);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","second",1,1,1);
  execute("insert into %s (a, b, c, d) values (?, ?, ?, ?)","second",4,4,4);
  assertRows(execute("select * from %s where a = ? and b = ?","first",2),row("first",2,2,2));
  assertRows(execute("select * from %s where a in (?, ?) and b in (?, ?)","first","second",2,3),row("first",2,2,2),row("first",3,3,3));
  assertRows(execute("select * from %s where a in (?, ?) and b = ?","first","second",4),row("first",4,4,4),row("second",4,4,4));
  assertRows(execute("select * from %s where a = ? and b in (?, ?)","first",3,4),row("first",3,3,3),row("first",4,4,4));
  assertRows(execute("select * from %s where a in (?, ?) and b in (?, ?)","first","second",1,4),row("first",1,1,1),row("first",4,4,4),row("second",1,1,1),row("second",4,4,4));
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","select * from %s where a in (?, ?)","first","second");
  assertInvalidMessage("Partition key parts: b must be restricted as other parts are","select * from %s where a = ?","first");
  assertInvalidMessage("b cannot be restricted by more than one relation if it includes a IN","select * from %s where a = ? AND b IN (?, ?) AND b = ?","first",2,2,3);
  assertInvalidMessage("b cannot be restricted by more than one relation if it includes an Equal","select * from %s where a = ? AND b = ? AND b IN (?, ?)","first",2,2,3);
  assertInvalidMessage("a cannot be restricted by more than one relation if it includes a IN","select * from %s where a IN (?, ?) AND a = ? AND b = ?","first","second","first",3);
  assertInvalidMessage("a cannot be restricted by more than one relation if it includes an Equal","select * from %s where a = ? AND a IN (?, ?) AND b IN (?, ?)","first","second","first",2,3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunctionCallWithUnset() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, s text, i int)");
  assertInvalidMessage("Invalid unset value for argument in call to function token","SELECT * FROM %s WHERE token(k) >= token(?)",unset());
  assertInvalidMessage("Invalid unset value for argument in call to function blobasint","SELECT * FROM %s WHERE k = blobAsInt(?)",unset());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexQueriesOnComplexPrimaryKey() throws Throwable {
  createTable("CREATE TABLE %s (pk0 int, pk1 int, ck0 int, ck1 int, ck2 int, value int, PRIMARY KEY ((pk0, pk1), ck0, ck1, ck2))");
  createIndex("CREATE INDEX ON %s (ck1)");
  createIndex("CREATE INDEX ON %s (ck2)");
  createIndex("CREATE INDEX ON %s (pk0)");
  createIndex("CREATE INDEX ON %s (ck0)");
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",0,1,2,3,4,5);
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",1,2,3,4,5,0);
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",2,3,4,5,0,1);
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",3,4,5,0,1,2);
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",4,5,0,1,2,3);
  execute("INSERT INTO %s (pk0, pk1, ck0, ck1, ck2, value) VALUES (?, ?, ?, ?, ?, ?)",5,0,1,2,3,4);
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 2"),row(1));
  assertRows(execute("SELECT value FROM %s WHERE ck0 = 0"),row(3));
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 3 AND pk1 = 4 AND ck1 = 0"),row(2));
  assertRows(execute("SELECT value FROM %s WHERE pk0 = 5 AND pk1 = 0 AND ck0 = 1 AND ck2 = 3 ALLOW FILTERING"),row(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.allow_filtering_test()
 */
@Test public void testAllowFiltering() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c))");
  for (int i=0; i < 3; i++)   for (int j=0; j < 3; j++)   execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",i,j,j);
  String[] queries=new String[]{"SELECT * FROM %s WHERE k = 1","SELECT * FROM %s WHERE k = 1 AND c > 2","SELECT * FROM %s WHERE k = 1 AND c = 2"};
  for (  String q : queries) {
    execute(q);
    execute(q + " ALLOW FILTERING");
  }
  queries=new String[]{"SELECT * FROM %s WHERE c = 2","SELECT * FROM %s WHERE c > 2 AND c <= 4"};
  for (  String q : queries) {
    assertInvalid(q);
    execute(q + " ALLOW FILTERING");
  }
  createTable("CREATE TABLE %s (k int PRIMARY KEY, a int, b int,)");
  createIndex("CREATE INDEX ON %s (a)");
  for (int i=0; i < 5; i++)   execute("INSERT INTO %s (k, a, b) VALUES (?, ?, ?)",i,i * 10,i * 100);
  queries=new String[]{"SELECT * FROM %s WHERE k = 1","SELECT * FROM %s WHERE a = 20"};
  for (  String q : queries) {
    execute(q);
    execute(q + " ALLOW FILTERING");
  }
  queries=new String[]{"SELECT * FROM %s WHERE a = 20 AND b = 200"};
  for (  String q : queries) {
    assertInvalid(q);
    execute(q + " ALLOW FILTERING");
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check SELECT respects inclusive and exclusive bounds
 * migrated from cql_tests.py:TestCQL.exclusive_slice_test()
 */
@Test public void testSelectBounds() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c)) WITH COMPACT STORAGE");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c, v) VALUES (0, ?, ?)",i,i);
  assertRowCount(execute("SELECT v FROM %s WHERE k = 0"),10);
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c >= 2 AND c <= 6"),row(2),row(3),row(4),row(5),row(6));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c > 2 AND c <= 6"),row(3),row(4),row(5),row(6));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c >= 2 AND c < 6"),row(2),row(3),row(4),row(5));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c > 2 AND c < 6"),row(3),row(4),row(5));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c > 2 AND c <= 6 LIMIT 2"),row(3),row(4));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c >= 2 AND c < 6 ORDER BY c DESC LIMIT 2"),row(5),row(4));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListContains() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories list<text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(categories)");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,list("lmn"));
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","xyz","lmn"));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?;","test","lmn"),row("test",5,list("lmn")));
  assertRows(execute("SELECT * FROM %s WHERE categories CONTAINS ?","lmn"),row("test",5,list("lmn")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?;","test",5,"lmn"),row("test",5,list("lmn")));
  assertInvalidMessage("Unsupported null value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,null);
  assertInvalidMessage("Unsupported unset value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,unset());
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ? AND categories CONTAINS ?","test",5,"lmn","notPresent");
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ? AND categories CONTAINS ? ALLOW FILTERING","test",5,"lmn","notPresent"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlias() throws Throwable {
  createTable("CREATE TABLE %s (id int PRIMARY KEY, name text)");
  for (int i=0; i < 5; i++)   execute("INSERT INTO %s (id, name) VALUES (?, ?) USING TTL 10 AND TIMESTAMP 0",i,Integer.toString(i));
  assertInvalidMessage("Aliases aren't allowed in the where clause","SELECT id AS user_id, name AS user_name FROM %s WHERE user_id = 0");
  assertInvalidMessage("Aliases are not allowed in order by clause","SELECT id AS user_id, name AS user_name FROM %s WHERE id IN (0) ORDER BY user_name");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.select_distinct_test()
 */
@Test public void testSelectDistinct() throws Throwable {
  createTable("CREATE TABLE %s (pk0 int, pk1 int, ck0 int, val int, PRIMARY KEY((pk0, pk1), ck0))");
  for (int i=0; i < 3; i++) {
    execute("INSERT INTO %s (pk0, pk1, ck0, val) VALUES (?, ?, 0, 0)",i,i);
    execute("INSERT INTO %s (pk0, pk1, ck0, val) VALUES (?, ?, 1, 1)",i,i);
  }
  assertRows(execute("SELECT DISTINCT pk0, pk1 FROM %s LIMIT 1"),row(0,0));
  assertRows(execute("SELECT DISTINCT pk0, pk1 FROM %s LIMIT 3"),row(0,0),row(2,2),row(1,1));
  assertInvalidMessage("queries must request all the partition key columns","SELECT DISTINCT pk0 FROM %s");
  assertInvalidMessage("queries must only request partition key columns","SELECT DISTINCT pk0, pk1, ck0 FROM %s");
  createTable("CREATE TABLE %s (pk0 int, pk1 int, val int, PRIMARY KEY((pk0, pk1))) WITH COMPACT STORAGE");
  for (int i=0; i < 3; i++)   execute("INSERT INTO %s (pk0, pk1, val) VALUES (?, ?, ?)",i,i,i);
  assertRows(execute("SELECT DISTINCT pk0, pk1 FROM %s LIMIT 1"),row(0,0));
  assertRows(execute("SELECT DISTINCT pk0, pk1 FROM %s LIMIT 3"),row(0,0),row(2,2),row(1,1));
  createTable("CREATE TABLE %s (pk int, name text, val int, PRIMARY KEY(pk, name)) WITH COMPACT STORAGE");
  for (int i=0; i < 3; i++) {
    execute("INSERT INTO %s (pk, name, val) VALUES (?, 'name0', 0)",i);
    execute("INSERT INTO %s (pk, name, val) VALUES (?, 'name1', 1)",i);
  }
  assertRows(execute("SELECT DISTINCT pk FROM %s LIMIT 1"),row(1));
  assertRows(execute("SELECT DISTINCT pk FROM %s LIMIT 3"),row(1),row(0),row(2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_6327_test()
 */
@Test public void testSelectInClauseAtOne() throws Throwable {
  createTable("CREATE TABLE %s ( k int, v int, PRIMARY KEY (k, v))");
  execute("INSERT INTO %s (k, v) VALUES (0, 0)");
  flush();
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND v IN (1, 0)"),row(0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #7105 bug,
 * SELECT with IN on final column of composite and compound primary key fails
 * migrated from cql_tests.py:TestCQL.bug7105_test()
 */
@Test public void testSelectInFinalColumn() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 2, 3, 3)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (1, 4, 6, 5)");
  assertRows(execute("SELECT * FROM %s WHERE a=1 AND b=2 ORDER BY b DESC"),row(1,2,3,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multi_in_compact_non_composite_test()
 */
@Test public void testMultiSelectsNonCompositeCompactStorage() throws Throwable {
  createTable("CREATE TABLE %s (key int, c int, v int, PRIMARY KEY (key, c)) WITH COMPACT STORAGE");
  execute("INSERT INTO %s (key, c, v) VALUES (0, 0, 0)");
  execute("INSERT INTO %s (key, c, v) VALUES (0, 1, 1)");
  execute("INSERT INTO %s (key, c, v) VALUES (0, 2, 2)");
  assertRows(execute("SELECT * FROM %s WHERE key=0 AND c IN (0, 2)"),row(0,0,0),row(0,2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multi_in_test()
 */
@Test public void testMultiSelects() throws Throwable {
  doTestVariousSelects(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexLookupWithClusteringPrefix() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d set<int>, PRIMARY KEY (a, b, c))");
  createIndex("CREATE INDEX ON %s(d)");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,set(1,2,3));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,set(3,4,5));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,set(1,2,3));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,1,set(3,4,5));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND b=? AND d CONTAINS ?",0,1,3),row(0,1,0,set(1,2,3)),row(0,1,1,set(3,4,5)));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND b=? AND d CONTAINS ?",0,1,2),row(0,1,0,set(1,2,3)));
  assertRows(execute("SELECT * FROM %s WHERE a=? AND b=? AND d CONTAINS ?",0,1,5),row(0,1,1,set(3,4,5)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test select count
 * migrated from cql_tests.py:TestCQL.count_test()
 */
@Test public void testSelectCount() throws Throwable {
  createTable(" CREATE TABLE %s (kind text, time int, value1 int, value2 int, PRIMARY KEY(kind, time))");
  execute("INSERT INTO %s (kind, time, value1, value2) VALUES ('ev1', ?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (kind, time, value1, value2) VALUES ('ev1', ?, ?, ?)",1,1,1);
  execute("INSERT INTO %s (kind, time, value1) VALUES ('ev1', ?, ?)",2,2);
  execute("INSERT INTO %s (kind, time, value1, value2) VALUES ('ev1', ?, ?, ?)",3,3,3);
  execute("INSERT INTO %s (kind, time, value1) VALUES ('ev1', ?, ?)",4,4);
  execute("INSERT INTO %s (kind, time, value1, value2) VALUES ('ev2', 0, 0, 0)");
  assertRows(execute("SELECT COUNT(*) FROM %s WHERE kind = 'ev1'"),row(5L));
  assertRows(execute("SELECT COUNT(1) FROM %s WHERE kind IN ('ev1', 'ev2') AND time=0"),row(2L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.multi_in_compact_test()
 */
@Test public void testMultiSelectsCompactStorage() throws Throwable {
  doTestVariousSelects(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleClusteringReversed() throws Throwable {
  createTable("CREATE TABLE %s (p text, c text, v text, s text static, PRIMARY KEY (p, c)) WITH CLUSTERING ORDER BY (c DESC)");
  execute("INSERT INTO %s(p, c, v, s) values (?, ?, ?, ?)","p1","k1","v1","sv1");
  execute("INSERT INTO %s(p, c, v) values (?, ?, ?)","p1","k2","v2");
  execute("INSERT INTO %s(p, s) values (?, ?)","p2","sv2");
  assertRows(execute("SELECT * FROM %s WHERE p=?","p1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=?","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c ASC","p1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c ASC","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c DESC","p1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c DESC","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c=?","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=?","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=?","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c=? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c ASC","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c=? ORDER BY c DESC","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c DESC","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c DESC","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?)","p1","k1","k2"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?) ORDER BY c ASC","p1","k1","k2"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?) ORDER BY c DESC","p1","k1","k2"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Range test query from #4372
 * migrated from cql_tests.py:TestCQL.range_query_test()
 */
@Test public void testRangeQuery() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, f text, PRIMARY KEY (a, b, c, d, e) )");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 1, 1, 2, '2')");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 1, 1, 1, '1')");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 1, 2, 1, '1')");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 1, 1, 3, '3')");
  execute("INSERT INTO %s (a, b, c, d, e, f) VALUES (1, 1, 1, 1, 5, '5')");
  assertRows(execute("SELECT a, b, c, d, e, f FROM %s WHERE a = 1 AND b = 1 AND c = 1 AND d = 1 AND e >= 2"),row(1,1,1,1,2,"2"),row(1,1,1,1,3,"3"),row(1,1,1,1,5,"5"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check query with KEY IN clause for wide row tables
 * migrated from cql_tests.py:TestCQL.in_clause_wide_rows_test()
 */
@Test public void testSelectKeyInForWideRows() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c)) WITH COMPACT STORAGE");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c, v) VALUES (0, ?, ?)",i,i);
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c IN (5, 2, 8)"),row(2),row(5),row(8));
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v int, PRIMARY KEY (k, c1, c2)) WITH COMPACT STORAGE");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, ?, ?)",i,i);
  assertEmpty(execute("SELECT v FROM %s WHERE k = 0 AND c1 IN (5, 2, 8) AND c2 = 3"));
  assertRows(execute("SELECT v FROM %s WHERE k = 0 AND c1 = 0 AND c2 IN (5, 2, 8)"),row(2),row(5),row(8));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterForContains() throws Throwable {
  createTable("CREATE TABLE %s (k1 int, k2 int, v set<int>, PRIMARY KEY ((k1, k2)))");
  createIndex("CREATE INDEX ON %s(k2)");
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",0,0,set(1,2,3));
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",0,1,set(2,3,4));
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",1,0,set(3,4,5));
  execute("INSERT INTO %s (k1, k2, v) VALUES (?, ?, ?)",1,1,set(4,5,6));
  assertRows(execute("SELECT * FROM %s WHERE k2 = ?",1),row(0,1,set(2,3,4)),row(1,1,set(4,5,6)));
  assertRows(execute("SELECT * FROM %s WHERE k2 = ? AND v CONTAINS ? ALLOW FILTERING",1,6),row(1,1,set(4,5,6)));
  assertEmpty(execute("SELECT * FROM %s WHERE k2 = ? AND v CONTAINS ? ALLOW FILTERING",1,7));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.composite_row_key_test()
 */
@Test public void testCompositeRowKey() throws Throwable {
  createTable("CREATE TABLE %s (k1 int, k2 int, c int, v int, PRIMARY KEY ((k1, k2), c))");
  for (int i=0; i < 4; i++)   execute("INSERT INTO %s (k1, k2, c, v) VALUES (?, ?, ?, ?)",0,i,i,i);
  assertRows(execute("SELECT * FROM %s"),row(0,2,2,2),row(0,3,3,3),row(0,0,0,0),row(0,1,1,1));
  assertRows(execute("SELECT * FROM %s WHERE k1 = 0 and k2 IN (1, 3)"),row(0,1,1,1),row(0,3,3,3));
  assertInvalid("SELECT * FROM %s WHERE k2 = 3");
  assertRows(execute("SELECT * FROM %s WHERE token(k1, k2) = token(0, 1)"),row(0,1,1,1));
  assertRows(execute("SELECT * FROM %s WHERE token(k1, k2) > ?",Long.MIN_VALUE),row(0,2,2,2),row(0,3,3,3),row(0,0,0,0),row(0,1,1,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.clustering_order_and_functions_test()
 */
@Test public void testFunctionsWithClusteringDesc() throws Throwable {
  createTable("CREATE TABLE %s ( k int, t timeuuid, PRIMARY KEY (k, t) ) WITH CLUSTERING ORDER BY (t DESC)");
  for (int i=0; i < 5; i++)   execute("INSERT INTO %s (k, t) VALUES (?, now())",i);
  execute("SELECT dateOf(t) FROM %s");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsKeyAndContainsWithIndexOnMapKey() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories map<text,text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(keys(categories))");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,map("lmn","foo"));
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",6,map("lmn","foo2"));
  assertInvalidMessage("No supported secondary index found for the non primary key columns restrictions","SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","test","foo");
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ?","test","lmn"),row("test",5,map("lmn","foo")),row("test",6,map("lmn","foo2")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ? AND categories CONTAINS ? ALLOW FILTERING","test","lmn","foo"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ? AND categories CONTAINS KEY ? ALLOW FILTERING","test","foo","lmn"),row("test",5,map("lmn","foo")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check query with KEY IN clause
 * migrated from cql_tests.py:TestCQL.select_key_in_test()
 */
@Test public void testSelectKeyIn() throws Throwable {
  createTable("CREATE TABLE %s (userid uuid PRIMARY KEY, firstname text, lastname text, age int)");
  UUID id1=UUID.fromString("550e8400-e29b-41d4-a716-446655440000");
  UUID id2=UUID.fromString("f47ac10b-58cc-4372-a567-0e02b2c3d479");
  execute("INSERT INTO %s (userid, firstname, lastname, age) VALUES (?, 'Frodo', 'Baggins', 32)",id1);
  execute("INSERT INTO %s (userid, firstname, lastname, age) VALUES (?, 'Samwise', 'Gamgee', 33)",id2);
  assertRowCount(execute("SELECT firstname, lastname FROM %s WHERE userid IN (?, ?)",id1,id2),2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for the bug from #4760 and #4759,
 * migrated from cql_tests.py:TestCQL.reversed_compact_multikey_test()
 */
@Test public void testReversedCompactMultikey() throws Throwable {
  createTable("CREATE TABLE %s (key text, c1 int, c2 int, value text, PRIMARY KEY(key, c1, c2) ) WITH COMPACT STORAGE AND CLUSTERING ORDER BY(c1 DESC, c2 DESC)");
  for (int i=0; i < 3; i++)   for (int j=0; j < 3; j++)   execute("INSERT INTO %s (key, c1, c2, value) VALUES ('foo', ?, ?, 'bar')",i,j);
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 = 1"),row(1,2),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 = 1 ORDER BY c1 ASC, c2 ASC"),row(1,0),row(1,1),row(1,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 = 1 ORDER BY c1 DESC, c2 DESC"),row(1,2),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 > 1"),row(2,2),row(2,1),row(2,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 > 1 ORDER BY c1 ASC, c2 ASC"),row(2,0),row(2,1),row(2,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 > 1 ORDER BY c1 DESC, c2 DESC"),row(2,2),row(2,1),row(2,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 >= 1"),row(2,2),row(2,1),row(2,0),row(1,2),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 >= 1 ORDER BY c1 ASC, c2 ASC"),row(1,0),row(1,1),row(1,2),row(2,0),row(2,1),row(2,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 >= 1 ORDER BY c1 ASC"),row(1,0),row(1,1),row(1,2),row(2,0),row(2,1),row(2,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 >= 1 ORDER BY c1 DESC, c2 DESC"),row(2,2),row(2,1),row(2,0),row(1,2),row(1,1),row(1,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 < 1"),row(0,2),row(0,1),row(0,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 < 1 ORDER BY c1 ASC, c2 ASC"),row(0,0),row(0,1),row(0,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 < 1 ORDER BY c1 DESC, c2 DESC"),row(0,2),row(0,1),row(0,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 <= 1"),row(1,2),row(1,1),row(1,0),row(0,2),row(0,1),row(0,0));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 <= 1 ORDER BY c1 ASC, c2 ASC"),row(0,0),row(0,1),row(0,2),row(1,0),row(1,1),row(1,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 <= 1 ORDER BY c1 ASC"),row(0,0),row(0,1),row(0,2),row(1,0),row(1,1),row(1,2));
  assertRows(execute("SELECT c1, c2 FROM %s WHERE key='foo' AND c1 <= 1 ORDER BY c1 DESC, c2 DESC"),row(1,2),row(1,1),row(1,0),row(0,2),row(0,1),row(0,0));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #4532, NPE when trying to select a slice from a composite table
 * migrated from cql_tests.py:TestCQL.bug_4532_test()
 */
@Test public void testSelectSliceFromComposite() throws Throwable {
  createTable("CREATE TABLE %s (status ascii, ctime bigint, key ascii, nil ascii, PRIMARY KEY (status, ctime, key))");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345678,'key1','')");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345678,'key2','')");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345679,'key3','')");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345679,'key4','')");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345679,'key5','')");
  execute("INSERT INTO %s (status,ctime,key,nil) VALUES ('C',12345680,'key6','')");
  assertInvalid("SELECT * FROM %s WHERE ctime>=12345679 AND key='key3' AND ctime<=12345680 LIMIT 3;");
  assertInvalid("SELECT * FROM %s WHERE ctime=12345679  AND key='key3' AND ctime<=12345680 LIMIT 3");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #7105 bug,
 * migrated from cql_tests.py:TestCQL.clustering_order_in_test()
 */
@Test public void testClusteringOrder() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY ((a, b), c) ) with clustering order by (c desc)");
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, 3)");
  execute("INSERT INTO %s (a, b, c) VALUES (4, 5, 6)");
  assertRows(execute("SELECT * FROM %s WHERE a=1 AND b=2 AND c IN (3)"),row(1,2,3));
  assertRows(execute("SELECT * FROM %s WHERE a=1 AND b=2 AND c IN (3, 4)"),row(1,2,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.ticket_5230_test()
 */
@Test public void testMultipleClausesOnPrimaryKey() throws Throwable {
  createTable("CREATE TABLE %s (key text, c text, v text, PRIMARY KEY(key, c))");
  execute("INSERT INTO %s (key, c, v) VALUES ('foo', '1', '1')");
  execute("INSERT INTO %s(key, c, v) VALUES ('foo', '2', '2')");
  execute("INSERT INTO %s(key, c, v) VALUES ('foo', '3', '3')");
  assertRows(execute("SELECT c FROM %s WHERE key = 'foo' AND c IN ('1', '2')"),row("1"),row("2"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for the #6579 'select count' paging bug,
 * migrated from cql_tests.py:TestCQL.select_count_paging_test()
 */
@Test public void testSelectCountPaging() throws Throwable {
  createTable("create table %s (field1 text, field2 timeuuid, field3 boolean, primary key(field1, field2))");
  createIndex("create index test_index on %s (field3)");
  execute("insert into %s (field1, field2, field3) values ('hola', now(), false)");
  execute("insert into %s (field1, field2, field3) values ('hola', now(), false)");
  assertRows(execute("select count(*) from %s where field3 = false limit 1"),row(2L));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleClustering() throws Throwable {
  createTable("CREATE TABLE %s (p text, c text, v text, s text static, PRIMARY KEY (p, c))");
  execute("INSERT INTO %s(p, c, v, s) values (?, ?, ?, ?)","p1","k1","v1","sv1");
  execute("INSERT INTO %s(p, c, v) values (?, ?, ?)","p1","k2","v2");
  execute("INSERT INTO %s(p, s) values (?, ?)","p2","sv2");
  assertRows(execute("SELECT * FROM %s WHERE p=?","p1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=?","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c ASC","p1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c ASC","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c DESC","p1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? ORDER BY c DESC","p2"),row("p2",null,"sv2",null));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=?","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c =?","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=?","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=?","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c ASC","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c =? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c ASC","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c ASC","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k1"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k2"),row("p1","k2","sv1","v2"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c>=? ORDER BY c DESC","p1","k3"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c =? ORDER BY c DESC","p1","k1"),row("p1","k1","sv1","v1"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c DESC","p1","k1"),row("p1","k1","sv1","v1"));
  assertEmpty(execute("SELECT * FROM %s WHERE p=? AND c<=? ORDER BY c DESC","p1","k0"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?)","p1","k1","k2"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?) ORDER BY c ASC","p1","k1","k2"),row("p1","k1","sv1","v1"),row("p1","k2","sv1","v2"));
  assertRows(execute("SELECT * FROM %s WHERE p=? AND c IN (?, ?) ORDER BY c DESC","p1","k1","k2"),row("p1","k2","sv1","v2"),row("p1","k1","sv1","v1"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_5404()
 */
@Test public void testSelectWithToken() throws Throwable {
  createTable("CREATE TABLE %s (key text PRIMARY KEY)");
  assertInvalid("select * from %s where token(key) > token(int(3030343330393233)) limit 1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapValueContains() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories map<text,text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(categories)");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,map("lmn","foo"));
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","xyz","foo"));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","test","foo"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE categories CONTAINS ?","foo"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,"foo"),row("test",5,map("lmn","foo")));
  assertInvalidMessage("Unsupported null value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,null);
  assertInvalidMessage("Unsupported unset value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,unset());
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ? AND categories CONTAINS ?","test",5,"foo","notPresent");
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ? AND categories CONTAINS ? ALLOW FILTERING","test",5,"foo","notPresent"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetContains() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories set<text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(categories)");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,set("lmn"));
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","xyz","lmn"));
  assertRows(execute("SELECT * FROM %s WHERE categories CONTAINS ?","lmn"),row("test",5,set("lmn")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","test","lmn"),row("test",5,set("lmn")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,"lmn"),row("test",5,set("lmn")));
  assertInvalidMessage("Unsupported null value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,null);
  assertInvalidMessage("Unsupported unset value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS ?","test",5,unset());
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE account = ? AND categories CONTAINS ? AND categories CONTAINS ?","xyz","lmn","notPresent");
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ? AND categories CONTAINS ? ALLOW FILTERING","xyz","lmn","notPresent"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for #4716 bug and more generally for good behavior of ordering,
 * migrated from cql_tests.py:TestCQL.reversed_compact_test()
 */
@Test public void testReverseCompact() throws Throwable {
  createTable("CREATE TABLE %s ( k text, c int, v int, PRIMARY KEY (k, c) ) WITH COMPACT STORAGE AND CLUSTERING ORDER BY (c DESC)");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (k, c, v) VALUES ('foo', ?, ?)",i,i);
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo'"),row(5),row(4),row(3));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo'"),row(6),row(5),row(4),row(3),row(2));
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo' ORDER BY c ASC"),row(3),row(4),row(5));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo' ORDER BY c ASC"),row(2),row(3),row(4),row(5),row(6));
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo' ORDER BY c DESC"),row(5),row(4),row(3));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo' ORDER BY c DESC"),row(6),row(5),row(4),row(3),row(2));
  createTable("CREATE TABLE %s ( k text, c int, v int, PRIMARY KEY (k, c) ) WITH COMPACT STORAGE");
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s(k, c, v) VALUES ('foo', ?, ?)",i,i);
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo'"),row(3),row(4),row(5));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo'"),row(2),row(3),row(4),row(5),row(6));
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo' ORDER BY c ASC"),row(3),row(4),row(5));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo' ORDER BY c ASC"),row(2),row(3),row(4),row(5),row(6));
  assertRows(execute("SELECT c FROM %s WHERE c > 2 AND c < 6 AND k = 'foo' ORDER BY c DESC"),row(5),row(4),row(3));
  assertRows(execute("SELECT c FROM %s WHERE c >= 2 AND c <= 6 AND k = 'foo' ORDER BY c DESC"),row(6),row(5),row(4),row(3),row(2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.bug_4882_test()
 */
@Test public void testDifferentOrdering() throws Throwable {
  createTable(" CREATE TABLE %s ( k int, c1 int, c2 int, v int, PRIMARY KEY (k, c1, c2) ) WITH CLUSTERING ORDER BY (c1 ASC, c2 DESC)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, 0, 0)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 1, 1, 1)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, 2, 2)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 1, 3, 3)");
  assertRows(execute("select * from %s where k = 0 limit 1"),row(0,0,2,2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListContainsWithFiltering() throws Throwable {
  createTable("CREATE TABLE %s (e int PRIMARY KEY, f list<text>, s int)");
  createIndex("CREATE INDEX ON %s(f)");
  for (int i=0; i < 3; i++) {
    execute("INSERT INTO %s (e, f, s) VALUES (?, ?, ?)",i,list("Dubai"),4);
  }
  for (int i=3; i < 5; i++) {
    execute("INSERT INTO %s (e, f, s) VALUES (?, ?, ?)",i,list("Dubai"),3);
  }
  assertRows(execute("SELECT * FROM %s WHERE f CONTAINS ? AND s=? allow filtering","Dubai",3),row(4,list("Dubai"),3),row(3,list("Dubai"),3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for bug from #5122,
 * migrated from cql_tests.py:TestCQL.composite_partition_key_validation_test()
 */
@Test public void testSelectOnCompositeInvalid() throws Throwable {
  createTable("CREATE TABLE %s (a int, b text, c uuid, PRIMARY KEY ((a, b)))");
  execute("INSERT INTO %s (a, b , c ) VALUES (1, 'aze', 4d481800-4c5f-11e1-82e0-3f484de45426)");
  execute("INSERT INTO %s (a, b , c ) VALUES (1, 'ert', 693f5800-8acb-11e3-82e0-3f484de45426)");
  execute("INSERT INTO %s (a, b , c ) VALUES (1, 'opl', d4815800-2d8d-11e0-82e0-3f484de45426)");
  assertRowCount(execute("SELECT * FROM %s"),3);
  assertInvalid("SELECT * FROM %s WHERE a=1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQueryMultipleIndexTypes() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories map<text,text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX id_index ON %s(id)");
  createIndex("CREATE INDEX categories_values_index ON %s(categories)");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,map("lmn","foo"));
  assertRows(execute("SELECT * FROM %s WHERE categories CONTAINS ? AND id = ? ALLOW FILTERING","foo",5),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ? AND id = ? ALLOW FILTERING","test","foo",5),row("test",5,map("lmn","foo")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapKeyContains() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories map<text,text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(keys(categories))");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,map("lmn","foo"));
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ?","xyz","lmn"));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ?","test","lmn"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE categories CONTAINS KEY ?","lmn"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ?","test",5,"lmn"),row("test",5,map("lmn","foo")));
  assertInvalidMessage("Unsupported null value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ?","test",5,null);
  assertInvalidMessage("Unsupported unset value for indexed column categories","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ?","test",5,unset());
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ? AND categories CONTAINS KEY ?","test",5,"lmn","notPresent");
  assertEmpty(execute("SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ? AND categories CONTAINS KEY ? ALLOW FILTERING","test",5,"lmn","notPresent"));
  assertInvalidMessage("Cannot execute this query as it might involve data filtering and thus may have unpredictable performance. If you want to execute this query despite the performance unpredictability, use ALLOW FILTERING","SELECT * FROM %s WHERE account = ? AND id = ? AND categories CONTAINS KEY ? AND categories CONTAINS ?","test",5,"lmn","foo");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsKeyAndContainsWithIndexOnMapValue() throws Throwable {
  createTable("CREATE TABLE %s (account text, id int, categories map<text,text>, PRIMARY KEY (account, id))");
  createIndex("CREATE INDEX ON %s(categories)");
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",5,map("lmn","foo"));
  execute("INSERT INTO %s (account, id , categories) VALUES (?, ?, ?)","test",6,map("lmn2","foo"));
  assertInvalidMessage("No supported secondary index found for the non primary key columns restrictions","SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ?","test","lmn");
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ?","test","foo"),row("test",5,map("lmn","foo")),row("test",6,map("lmn2","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS KEY ? AND categories CONTAINS ? ALLOW FILTERING","test","lmn","foo"),row("test",5,map("lmn","foo")));
  assertRows(execute("SELECT * FROM %s WHERE account = ? AND categories CONTAINS ? AND categories CONTAINS KEY ? ALLOW FILTERING","test","foo","lmn"),row("test",5,map("lmn","foo")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.TruncateTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTruncate() throws Throwable {
  for (  String table : new String[]{"","TABLE"}) {
    createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY(a, b))");
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,0,0);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,1,1);
    flush();
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,0,2);
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,3);
    assertRows(execute("SELECT * FROM %s"),row(1,0,2),row(1,1,3),row(0,0,0),row(0,1,1));
    execute("TRUNCATE " + table + " %s");
    assertEmpty(execute("SELECT * FROM %s"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.UpdateTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTypeCasts() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, t text, a ascii, d double, i int)");
  execute("UPDATE %s SET t = 'foo' WHERE k = ?",0);
  execute("UPDATE %s SET t = (ascii)'foo' WHERE k = ?",0);
  execute("UPDATE %s SET t = (text)(ascii)'foo' WHERE k = ?",0);
  execute("UPDATE %s SET a = 'foo' WHERE k = ?",0);
  execute("UPDATE %s SET a = (ascii)'foo' WHERE k = ?",0);
  assertInvalid("UPDATE %s SET a = (text)'foo' WHERE k = ?",0);
  execute("UPDATE %s SET i = 3 WHERE k = ?",0);
  execute("UPDATE %s SET i = (int)3 WHERE k = ?",0);
  execute("UPDATE %s SET d = 3 WHERE k = ?",0);
  execute("UPDATE %s SET d = (double)3 WHERE k = ?",0);
  assertInvalid("UPDATE %s SET d = (int)3 WHERE k = ?",0);
  assertInvalid("UPDATE %s SET i = (double)3 WHERE k = ?",0);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateWithMultiplePartitionKeyComponents() throws Throwable {
  testUpdateWithMultiplePartitionKeyComponents(false);
  testUpdateWithMultiplePartitionKeyComponents(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateWithStaticList() throws Throwable {
  createTable("CREATE TABLE %s (k int," + "clustering int," + "value int,"+ "l list<text> static,"+ " PRIMARY KEY (k, clustering))");
  execute("INSERT INTO %s(k, clustering, value, l) VALUES (?, ?, ?, ?)",0,0,0,list("v1","v2","v3"));
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1","v2","v3")));
  execute("UPDATE %s SET l[?] = ? WHERE k = ?",1,"v4",0);
  assertRows(execute("SELECT l FROM %s WHERE k = 0"),row(list("v1","v4","v3")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdate() throws Throwable {
  testUpdate(false);
  testUpdate(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateWithAStaticColumn() throws Throwable {
  testUpdateWithAStaticColumn(false);
  testUpdateWithAStaticColumn(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test altering the type of a column, including the one in the primary key (#4041)
 * migrated from cql_tests.py:TestCQL.update_type_test()
 */
@Test public void testUpdateColumnType() throws Throwable {
  createTable("CREATE TABLE %s (k text, c text, s set <text>, v text, PRIMARY KEY(k, c))");
  execute("INSERT INTO %s (k, c, v, s) VALUES ('ɸ', 'ɸ', 'ɸ', {'ɸ'})");
  assertRows(execute("SELECT * FROM %s"),row("ɸ","ɸ",set("ɸ"),"ɸ"));
  execute("ALTER TABLE %s ALTER v TYPE blob");
  assertRows(execute("SELECT * FROM %s"),row("ɸ","ɸ",set("ɸ"),ByteBufferUtil.bytes("ɸ")));
  execute("ALTER TABLE %s ALTER k TYPE blob");
  assertRows(execute("SELECT * FROM %s"),row(ByteBufferUtil.bytes("ɸ"),"ɸ",set("ɸ"),ByteBufferUtil.bytes("ɸ")));
  execute("ALTER TABLE %s ALTER c TYPE blob");
  assertRows(execute("SELECT * FROM %s"),row(ByteBufferUtil.bytes("ɸ"),ByteBufferUtil.bytes("ɸ"),set("ɸ"),ByteBufferUtil.bytes("ɸ")));
  execute("ALTER TABLE %s ALTER s TYPE set<blob>");
  assertRows(execute("SELECT * FROM %s"),row(ByteBufferUtil.bytes("ɸ"),ByteBufferUtil.bytes("ɸ"),set(ByteBufferUtil.bytes("ɸ")),ByteBufferUtil.bytes("ɸ")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateWithSecondaryIndices() throws Throwable {
  testUpdateWithSecondaryIndices(false);
  testUpdateWithSecondaryIndices(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateWithTwoClusteringColumns() throws Throwable {
  testUpdateWithTwoClusteringColumns(false);
  testUpdateWithTwoClusteringColumns(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.UseTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUseStatementWithBindVariable() throws Throwable {
  assertInvalidSyntaxMessage("Bind variables cannot be used for keyspace names","USE ?");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnFamilyStoreTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteStandardRowSticksAfterFlush() throws Throwable {
  String keyspaceName=KEYSPACE1;
  String cfName=CF_STANDARD1;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  ByteBuffer col=ByteBufferUtil.bytes("val");
  ByteBuffer val=ByteBufferUtil.bytes("val1");
  ColumnDefinition newCol=ColumnDefinition.regularDef(cfs.metadata,ByteBufferUtil.bytes("val2"),AsciiType.instance);
  new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("Column1").add("val","val1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"key2").clustering("Column1").add("val","val1").build().applyUnsafe();
  assertRangeCount(cfs,col,val,2);
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,"key3").clustering("Column1").add("val","val1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,1,"key4").clustering("Column1").add("val","val1").build().applyUnsafe();
  assertRangeCount(cfs,col,val,4);
  RowUpdateBuilder.deleteRow(cfs.metadata,5,"key1","Column1").applyUnsafe();
  RowUpdateBuilder.deleteRow(cfs.metadata,5,"key3","Column1").applyUnsafe();
  assertRangeCount(cfs,col,val,2);
  cfs.forceBlockingFlush();
  assertRangeCount(cfs,col,val,2);
  new RowUpdateBuilder(cfs.metadata,2,"key1").clustering("Column1").add("val","val1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,2,"key3").clustering("Column1").add("val","val1").build().applyUnsafe();
  assertRangeCount(cfs,col,val,2);
  new RowUpdateBuilder(cfs.metadata,10,"key5").clustering("Column1").add("val","val1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,10,"key6").clustering("Column1").add("val","val1").build().applyUnsafe();
  assertRangeCount(cfs,col,val,4);
  cfs.forceBlockingFlush();
  assertRangeCount(cfs,col,val,4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyRow() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  final ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD2);
  RowUpdateBuilder.deleteRow(cfs.metadata,FBUtilities.timestampMicros(),"key1","Column1").applyUnsafe();
  Runnable r=new WrappedRunnable(){
    public void runMayThrow() throws IOException {
      Row toCheck=Util.getOnlyRowUnfiltered(Util.cmd(cfs,"key1").build());
      Iterator<Cell> iter=toCheck.cells().iterator();
      assert (Iterators.size(iter) == 0);
    }
  }
;
  reTest(cfs,r);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialize() throws IOException {
  testSerialize(Columns.NONE,Collections.emptyList());
  for (  ColumnsCheck randomColumns : randomSmall(false))   testSerialize(randomColumns.columns,randomColumns.definitions);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializeSmallSubset() throws IOException {
  for (  ColumnsCheck randomColumns : randomSmall(true))   testSerializeSubset(randomColumns);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsWithoutAndMergeTo(){
  for (  ColumnsCheck randomColumns : randomSmall(true))   testContainsWithoutAndMergeTo(randomColumns);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializeHugeSubset() throws IOException {
  for (  ColumnsCheck randomColumns : randomHuge())   testSerializeSubset(randomColumns);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterCellTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateDigest() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  ByteBuffer col=ByteBufferUtil.bytes("val");
  MessageDigest digest1=MessageDigest.getInstance("md5");
  MessageDigest digest2=MessageDigest.getInstance("md5");
  CounterContext.ContextState state=CounterContext.ContextState.allocate(0,2,2);
  state.writeRemote(CounterId.fromInt(1),4L,4L);
  state.writeLocal(CounterId.fromInt(2),4L,4L);
  state.writeRemote(CounterId.fromInt(3),4L,4L);
  state.writeLocal(CounterId.fromInt(4),4L,4L);
  Cell original=createCounterCellFromContext(cfs,col,state,5);
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(col);
  Cell cleared=BufferCell.live(cfs.metadata,cDef,5,CounterContext.instance().clearAllLocal(state.context));
  CounterContext.instance().updateDigest(digest1,original.value());
  CounterContext.instance().updateDigest(digest2,cleared.value());
  assert Arrays.equals(digest1.digest(),digest2.digest());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterMutationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleCell() throws WriteTimeoutException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF1);
  cfs.truncateBlocking();
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  addAndCheck(cfs,1,1);
  addAndCheck(cfs,2,3);
  addAndCheck(cfs,-3,0);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTwoCells() throws WriteTimeoutException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF1);
  cfs.truncateBlocking();
  addTwoAndCheck(cfs,1L,1L,-1L,-1L);
  addTwoAndCheck(cfs,2L,3L,-2L,-3L);
  addTwoAndCheck(cfs,-3L,0L,3L,0L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DeletePartitionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeletePartition(){
  testDeletePartition(Util.dk("key1"),true,true);
  testDeletePartition(Util.dk("key2"),true,false);
  testDeletePartition(Util.dk("key3"),false,true);
  testDeletePartition(Util.dk("key4"),false,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DirectoriesTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSSTableLister(){
  for (  CFMetaData cfm : CFM) {
    Directories directories=new Directories(cfm);
    Directories.SSTableLister lister;
    Set<File> listed;
    lister=directories.sstableLister(Directories.OnTxnErr.THROW);
    listed=new HashSet<>(lister.listFiles());
    for (    File f : files.get(cfm.cfName)) {
      if (f.getPath().contains(Directories.SNAPSHOT_SUBDIR) || f.getPath().contains(Directories.BACKUPS_SUBDIR))       assert !listed.contains(f) : f + " should not be listed";
 else       assert listed.contains(f) : f + " is missing";
    }
    lister=directories.sstableLister(Directories.OnTxnErr.THROW).includeBackups(true);
    listed=new HashSet<>(lister.listFiles());
    for (    File f : files.get(cfm.cfName)) {
      if (f.getPath().contains(Directories.SNAPSHOT_SUBDIR))       assert !listed.contains(f) : f + " should not be listed";
 else       assert listed.contains(f) : f + " is missing";
    }
    lister=directories.sstableLister(Directories.OnTxnErr.THROW).skipTemporary(true);
    listed=new HashSet<>(lister.listFiles());
    for (    File f : files.get(cfm.cfName)) {
      if (f.getPath().contains(Directories.SNAPSHOT_SUBDIR) || f.getPath().contains(Directories.BACKUPS_SUBDIR))       assert !listed.contains(f) : f + " should not be listed";
 else       if (f.getName().contains("tmp-"))       assert !listed.contains(f) : f + " should not be listed";
 else       assert listed.contains(f) : f + " is missing";
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.KeyCacheTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyCache() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COLUMN_FAMILY1);
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY1);
  Mutation rm;
  new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"key2").clustering("2").build().applyUnsafe();
  cfs.forceBlockingFlush();
  Util.getAll(Util.cmd(cfs,"key1").build());
  Util.getAll(Util.cmd(cfs,"key2").build());
  assertKeyCacheSize(2,KEYSPACE1,COLUMN_FAMILY1);
  Set<SSTableReader> readers=cfs.getLiveSSTables();
  Refs<SSTableReader> refs=Refs.tryRef(readers);
  if (refs == null)   throw new IllegalStateException();
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  boolean noEarlyOpen=DatabaseDescriptor.getSSTablePreempiveOpenIntervalInMB() < 0;
  assertKeyCacheSize(noEarlyOpen ? 2 : 4,KEYSPACE1,COLUMN_FAMILY1);
  refs.release();
  LifecycleTransaction.waitForDeletions();
  assertKeyCacheSize(2,KEYSPACE1,COLUMN_FAMILY1);
  Util.getAll(Util.cmd(cfs,"key1").build());
  Util.getAll(Util.cmd(cfs,"key2").build());
  assertKeyCacheSize(noEarlyOpen ? 4 : 2,KEYSPACE1,COLUMN_FAMILY1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyCacheLoadWithLostTable() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  ColumnFamilyStore store=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COLUMN_FAMILY3);
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY3);
  SchemaLoader.insertData(KEYSPACE1,COLUMN_FAMILY3,0,100);
  store.forceBlockingFlush();
  Collection<SSTableReader> firstFlushTables=ImmutableList.copyOf(store.getLiveSSTables());
  readData(KEYSPACE1,COLUMN_FAMILY3,0,100);
  assertKeyCacheSize(100,KEYSPACE1,COLUMN_FAMILY3);
  SchemaLoader.insertData(KEYSPACE1,COLUMN_FAMILY3,100,50);
  store.forceBlockingFlush();
  readData(KEYSPACE1,COLUMN_FAMILY3,100,50);
  assertKeyCacheSize(150,KEYSPACE1,COLUMN_FAMILY3);
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY3);
  CacheService.instance.keyCache.loadSaved();
  assertKeyCacheSize(150,KEYSPACE1,COLUMN_FAMILY3);
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY3);
  store.markObsolete(firstFlushTables,OperationType.UNKNOWN);
  CacheService.instance.keyCache.loadSaved();
  assertKeyCacheSize(50,KEYSPACE1,COLUMN_FAMILY3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.KeyspaceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceFromAdvanced() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=1; i < 7; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  cfs.forceBlockingFlush();
  for (int i=1; i < 4; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,-1);
  for (int round=0; round < 2; round++) {
    SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",slices(cfs,2,null,false),3);
    assertRowsInResult(cfs,command,-1,-1,4);
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceWithCutoff() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c text, PRIMARY KEY (a, b))");
  String prefix="omg!thisisthevalue!";
  for (int i=0; i < 300; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,prefix + i);
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int round=0; round < 2; round++) {
    assertRowsInSlice(cfs,"0",96,99,4,false,prefix);
    assertRowsInSlice(cfs,"0",96,99,4,true,prefix);
    assertRowsInSlice(cfs,"0",100,103,4,false,prefix);
    assertRowsInSlice(cfs,"0",100,103,4,true,prefix);
    assertRowsInSlice(cfs,"0",0,99,100,false,prefix);
    assertRowsInSlice(cfs,"0",288,299,12,true,prefix);
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceWithExpiration() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",0,0);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TTL 60","0",1,1);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",2,2);
  for (int round=0; round < 2; round++) {
    SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",slices(cfs,null,null,false),2);
    assertRowsInResult(cfs,command,0,1);
    command=singlePartitionSlice(cfs,"0",slices(cfs,1,null,false),1);
    assertRowsInResult(cfs,command,1);
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceFromLarge() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=1000; i < 2000; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  cfs.forceBlockingFlush();
  validateSliceLarge(cfs);
  if (cfs.getLiveSSTables().size() > 1)   CompactionManager.instance.performMaximal(cfs,false);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  RowIndexEntry indexEntry=sstable.getPosition(Util.dk("0"),SSTableReader.Operator.EQ);
  assert indexEntry.columnsIndex().size() > 2;
  validateSliceLarge(cfs);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceFromBasic() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=1; i < 10; i++) {
    if (i == 6 || i == 8)     continue;
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  }
  execute("DELETE FROM %s WHERE a = ? AND b = ?","0",4);
  for (int round=0; round < 2; round++) {
    ClusteringIndexSliceFilter filter=slices(cfs,5,null,false);
    SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",filter,2);
    assertRowsInResult(cfs,command,5,7);
    command=singlePartitionSlice(cfs,"0",slices(cfs,4,null,false),2);
    assertRowsInResult(cfs,command,5,7);
    command=singlePartitionSlice(cfs,"0",slices(cfs,null,5,true),2);
    assertRowsInResult(cfs,command,5,3);
    command=singlePartitionSlice(cfs,"0",slices(cfs,null,6,true),2);
    assertRowsInResult(cfs,command,5,3);
    command=singlePartitionSlice(cfs,"0",slices(cfs,null,6,true),2);
    assertRowsInResult(cfs,command,5,3);
    command=singlePartitionSlice(cfs,"0",slices(cfs,null,null,true),2);
    assertRowsInResult(cfs,command,9,7);
    command=singlePartitionSlice(cfs,"0",slices(cfs,95,null,false),2);
    assertRowsInResult(cfs,command);
    command=singlePartitionSlice(cfs,"0",slices(cfs,null,0,true),2);
    assertRowsInResult(cfs,command);
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetRowNoColumns() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",0,0);
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int round=0; round < 2; round++) {
    Util.assertEmpty(Util.cmd(cfs,"0").columns("c").withLimit(0).build());
    Util.assertEmpty(Util.cmd(cfs,"0").columns("c").fromIncl(1).toIncl(1).build());
    Util.assertEmpty(Util.cmd(cfs,"0").columns("c").includeRow(1).build());
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.LegacyCellNameTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testColumnSameNameAsPartitionKeyCql3() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int PRIMARY KEY, v int)","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("k"));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testColumnSameNameAsClusteringKeyCql3() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int, c text, v int, PRIMARY KEY(k, c))","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("c"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.MultiKeyspaceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSameTableNames() throws Throwable {
  schemaChange("CREATE KEYSPACE multikstest1 WITH replication = {'class': 'SimpleStrategy', 'replication_factor': '1'}");
  schemaChange("CREATE TABLE multikstest1.standard1 (a int PRIMARY KEY, b int)");
  schemaChange("CREATE KEYSPACE multikstest2 WITH replication = {'class': 'SimpleStrategy', 'replication_factor': '1'}");
  schemaChange("CREATE TABLE multikstest2.standard1 (a int PRIMARY KEY, b int)");
  execute("INSERT INTO multikstest1.standard1 (a, b) VALUES (0, 0)");
  execute("INSERT INTO multikstest2.standard1 (a, b) VALUES (0, 0)");
  Keyspace.open("multikstest1").flush();
  Keyspace.open("multikstest2").flush();
  assertRows(execute("SELECT * FROM multikstest1.standard1"),row(0,0));
  assertRows(execute("SELECT * FROM multikstest2.standard1"),row(0,0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.NameSortTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNameSort1() throws IOException {
  testNameSort(1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNameSort100() throws IOException {
  testNameSort(100);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNameSort10() throws IOException {
  testNameSort(10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.NativeCellTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCells() throws IOException {
  for (int run=0; run < 1000; run++) {
    Row.Builder builder=BTreeRow.unsortedBuilder(1);
    builder.newRow(rndclustering());
    int count=1 + rand.nextInt(10);
    for (int i=0; i < count; i++)     rndcd(builder);
    test(builder.build());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.PartitionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyDigest() throws NoSuchAlgorithmException {
  testDigest(MessagingService.VERSION_22);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleColumn() throws IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  PartitionUpdate update=new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("c").add("val","val1").buildUpdate();
  CachedBTreePartition partition=CachedBTreePartition.create(update.unfilteredIterator(),FBUtilities.nowInSeconds());
  DataOutputBuffer bufOut=new DataOutputBuffer();
  CachedPartition.cacheSerializer.serialize(partition,bufOut);
  CachedPartition deserialized=CachedPartition.cacheSerializer.deserialize(new DataInputBuffer(bufOut.getData()));
  assert deserialized != null;
  assert deserialized.metadata().cfName.equals(CF_STANDARD1);
  assert deserialized.partitionKey().equals(partition.partitionKey());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigest() throws NoSuchAlgorithmException {
  testDigest(MessagingService.current_version);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneListTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nonSortedAdditionTestWithOneTombstoneWithEmptyEnd(){
  nonSortedAdditionTestWithOneRangeWithEmptyEnd(0);
  nonSortedAdditionTestWithOneRangeWithEmptyEnd(10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nonSortedAdditionTest(){
  nonSortedAdditionTest(0);
  nonSortedAdditionTest(10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void simpleOverlapTest(){
  RangeTombstoneList l1=new RangeTombstoneList(cmp,0);
  l1.add(rt(0,10,3));
  l1.add(rt(3,7,5));
  Iterator<RangeTombstone> iter1=l1.iterator();
  assertRT(rtie(0,3,3),iter1.next());
  assertRT(rt(3,7,5),iter1.next());
  assertRT(rtei(7,10,3),iter1.next());
  assert !iter1.hasNext();
  RangeTombstoneList l2=new RangeTombstoneList(cmp,0);
  l2.add(rt(0,10,3));
  l2.add(rt(3,7,2));
  Iterator<RangeTombstone> iter2=l2.iterator();
  assertRT(rt(0,10,3),iter2.next());
  assert !iter2.hasNext();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void overlappingAdditionTest(){
  overlappingAdditionTest(0);
  overlappingAdditionTest(10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addAllIncludedTest(){
  RangeTombstoneList l1=new RangeTombstoneList(cmp,0);
  l1.add(rt(3,10,5));
  RangeTombstoneList l2=new RangeTombstoneList(cmp,0);
  l2.add(rt(4,5,2));
  l2.add(rt(5,7,3));
  l2.add(rt(7,9,4));
  l1.addAll(l2);
  Iterator<RangeTombstone> iter=l1.iterator();
  assertRT(rt(3,10,5),iter.next());
  assert !iter.hasNext();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sortedAdditionTest(){
  sortedAdditionTest(0);
  sortedAdditionTest(10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addAllSequentialTest(){
  RangeTombstoneList l1=new RangeTombstoneList(cmp,0);
  l1.add(rt(3,5,2));
  RangeTombstoneList l2=new RangeTombstoneList(cmp,0);
  l2.add(rt(5,7,7));
  l1.addAll(l2);
  Iterator<RangeTombstone> iter=l1.iterator();
  assertRT(rtie(3,5,2),iter.next());
  assertRT(rt(5,7,7),iter.next());
  assert !iter.hasNext();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addAllTest(){
  RangeTombstoneList l1=new RangeTombstoneList(cmp,0);
  l1.add(rt(0,4,5));
  l1.add(rt(6,10,2));
  l1.add(rt(15,17,1));
  RangeTombstoneList l2=new RangeTombstoneList(cmp,0);
  l2.add(rt(3,5,7));
  l2.add(rt(7,8,3));
  l2.add(rt(8,12,1));
  l2.add(rt(14,17,4));
  l1.addAll(l2);
  Iterator<RangeTombstone> iter=l1.iterator();
  assertRT(rtie(0,3,5),iter.next());
  assertRT(rt(3,5,7),iter.next());
  assertRT(rtie(6,7,2),iter.next());
  assertRT(rt(7,8,3),iter.next());
  assertRT(rtei(8,10,2),iter.next());
  assertRT(rtei(10,12,1),iter.next());
  assertRT(rt(14,17,4),iter.next());
  assert !iter.hasNext();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addAllBugFrom9799(){
  RangeTombstoneList l1=fromString("{ (6, 7]@4 - (7, 8)@1 - [12, 12]@0 - [13, 13]@0 - (20, 21)@3 - [27, 27]@2 - (33, 34)@2 - (35, 36]@4 - (40, 41]@0 - (42, 43)@2 - (44, 45)@3 - [47, 47]@1 - (47, 48)@0 - [55, 55]@4 - [61, 61]@4 - [67, 67]@0 - [70, 70]@4 - [77, 77]@1 - (83, 84)@1 - [90, 90]@0 - (91, 92]@4 - [93, 93]@0 - (94, 95)@2 - (100, 101]@3 - (103, 104]@0 - (108, 109]@2 - (115, 116]@3 - (116, 117]@3 - (118, 119)@4 - (125, 126)@2 - [131, 131]@1 - [132, 132]@3 - [139, 139]@0 - [145, 145]@1 - (145, 146]@3 - (147, 148]@4 - (150, 151]@1 - (156, 157)@2 - (158, 159)@2 - [164, 164]@4 - (168, 169)@0 - (171, 172)@4 - (173, 174]@0 - [179, 179]@1 - (186, 187]@4 - [191, 191]@1 }");
  RangeTombstoneList l2=fromString("{ (1, 12)@8 - [12, 13)@8 - [13, 18]@7 }");
  l1.addAll(l2);
  assertValid(l1);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addAllRandomTest() throws Throwable {
  int TEST_COUNT=1000;
  int MAX_LIST_SIZE=50;
  int MAX_IT_SIZE=20;
  int MAX_IT_DISTANCE=10;
  int MAX_MARKEDAT=10;
  long seed=System.nanoTime();
  Random rand=new Random(seed);
  for (int i=0; i < TEST_COUNT; i++) {
    RangeTombstoneList l1=makeRandom(rand,rand.nextInt(MAX_LIST_SIZE) + 1,rand.nextInt(MAX_IT_SIZE) + 1,rand.nextInt(MAX_IT_DISTANCE) + 1,rand.nextInt(MAX_MARKEDAT) + 1);
    RangeTombstoneList l2=makeRandom(rand,rand.nextInt(MAX_LIST_SIZE) + 1,rand.nextInt(MAX_IT_SIZE) + 1,rand.nextInt(MAX_IT_DISTANCE) + 1,rand.nextInt(MAX_MARKEDAT) + 1);
    RangeTombstoneList l1Initial=l1.copy();
    try {
      l1.addAll(l2);
      assertValid(l1);
    }
 catch (    Throwable e) {
      System.out.println("Error merging:");
      System.out.println(" l1: " + toString(l1Initial));
      System.out.println(" l2: " + toString(l2));
      System.out.println("Seed was: " + seed);
      throw e;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7808_1() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.metadata.gcGraceSeconds(2);
  String key="7808_1";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.apply();
  cfs.forceBlockingFlush();
  new Mutation(PartitionUpdate.fullPartitionDelete(cfs.metadata,Util.dk(key),1,1)).apply();
  cfs.forceBlockingFlush();
  Thread.sleep(5);
  cfs.forceMajorCompaction();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTrackTimesRangeTombstone() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.truncateBlocking();
  String key="rt_times";
  int nowInSec=FBUtilities.nowInSeconds();
  new RowUpdateBuilder(cfs.metadata,nowInSec,1000L,key).addRangeTombstone(1,2).build().apply();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),1000,1000,nowInSec);
  cfs.forceMajorCompaction();
  sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),1000,1000,nowInSec);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTrackTimesRangeTombstoneWithData() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.truncateBlocking();
  String key="rt_times";
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(999).newRow(5).add("val",5).apply();
  key="rt_times2";
  int nowInSec=FBUtilities.nowInSeconds();
  new Mutation(PartitionUpdate.fullPartitionDelete(cfs.metadata,Util.dk(key),1000,nowInSec)).apply();
  cfs.forceBlockingFlush();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),999,1000,Integer.MAX_VALUE);
  cfs.forceMajorCompaction();
  sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),999,1000,Integer.MAX_VALUE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTrackTimesPartitionTombstoneWithData() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.truncateBlocking();
  String key="rt_times";
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(999).newRow(5).add("val",5).apply();
  key="rt_times2";
  int nowInSec=FBUtilities.nowInSeconds();
  new Mutation(PartitionUpdate.fullPartitionDelete(cfs.metadata,Util.dk(key),1000,nowInSec)).apply();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),999,1000,Integer.MAX_VALUE);
  cfs.forceMajorCompaction();
  sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),999,1000,Integer.MAX_VALUE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTrackTimesPartitionTombstone() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.truncateBlocking();
  String key="rt_times";
  int nowInSec=FBUtilities.nowInSeconds();
  new Mutation(PartitionUpdate.fullPartitionDelete(cfs.metadata,Util.dk(key),1000,nowInSec)).apply();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),1000,1000,nowInSec);
  cfs.forceMajorCompaction();
  sstable=cfs.getLiveSSTables().iterator().next();
  assertTimes(sstable.getSSTableMetadata(),1000,1000,nowInSec);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ReadResponseTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyResponseSkipWrongBounds(){
  createTable("CREATE TABLE %s (k text PRIMARY KEY)");
  ColumnFamilyStore cfs=getCurrentColumnFamilyStore();
  List<ImmutableBTreePartition> responses=Arrays.asList(makePartition(cfs.metadata,"k1"),makePartition(cfs.metadata,"k2"),makePartition(cfs.metadata,"k3"));
  ReadResponse.LegacyRemoteDataResponse response=new ReadResponse.LegacyRemoteDataResponse(responses);
  assertPartitions(response.makeIterator(Util.cmd(cfs).fromKeyExcl("k1").toKeyExcl("k3").build()),"k2");
  assertPartitions(response.makeIterator(Util.cmd(cfs).fromKeyExcl("k0").toKeyExcl("k3").build()),"k1","k2");
  assertPartitions(response.makeIterator(Util.cmd(cfs).fromKeyExcl("k1").toKeyExcl("k4").build()),"k2","k3");
  assertPartitions(response.makeIterator(Util.cmd(cfs).fromKeyIncl("k1").toKeyExcl("k3").build()),"k1","k2");
  assertPartitions(response.makeIterator(Util.cmd(cfs).fromKeyIncl("k1").toKeyExcl("k4").build()),"k1","k2","k3");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerFlushedTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFlush() throws Exception {
  FBUtilities.waitOnFutures(Keyspace.open(SystemKeyspace.NAME).flush());
  FBUtilities.waitOnFutures(Keyspace.open(SchemaKeyspace.NAME).flush());
  CompactionManager.instance.disableAutoCompaction();
  insertRow("Standard2","key");
  for (int i=0; i < 100; i++) {
    String key="key" + i;
    insertRow("Standard1",key);
  }
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace1.getColumnFamilyStore("Standard1");
  logger.debug("forcing flush");
  cfs.forceBlockingFlush();
  logger.debug("begin manual replay");
  int replayed=CommitLog.instance.resetUnsafe(false);
  assert replayed == 1 : "Expecting only 1 replayed mutation, got " + replayed;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNothingToRecover() throws IOException {
  CommitLog.instance.resetUnsafe(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RemoveCellTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteCell() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",0,0,0,0L);
  cfs.forceBlockingFlush();
  execute("DELETE c FROM %s USING TIMESTAMP ? WHERE a = ? AND b = ?",1L,0,0);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b = ?",0,0),row(0,0,null));
  assertRows(execute("SELECT c FROM %s WHERE a = ? AND b = ?",0,0),row(new Object[]{null}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RepairedDataTombstonesTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void readTest() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=0; i < 10; i++) {
    execute("update %s set t2=null where id=? and id2=?",123,i);
  }
  flush();
  SSTableReader repairedSSTable=getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next();
  repair(getCurrentColumnFamilyStore(),repairedSSTable);
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("update %s set t2=null where id=? and id2=?",123,i);
  }
  flush();
  Thread.sleep(1000);
  verify();
  verify2(123);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void readOnlyUnrepairedTest() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=10; i < 20; i++) {
    execute("update %s set t2=null where id=? and id2=?",123,i);
  }
  flush();
  Thread.sleep(1000);
  verify();
  verify2(123);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void readTestRowTombstones() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=0; i < 10; i++) {
    execute("delete from %s where id=? and id2=?",1,i);
  }
  flush();
  SSTableReader repairedSSTable=getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next();
  repair(getCurrentColumnFamilyStore(),repairedSSTable);
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("delete from %s where id=? and id2=?",1,i);
  }
  flush();
  Thread.sleep(1000);
  verify();
  verify2(1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void readTestOldUnrepaired() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  getCurrentColumnFamilyStore().disableAutoCompaction();
  for (int i=0; i < 10; i++) {
    execute("delete from %s where id=1 and id2=?",i);
  }
  flush();
  SSTableReader oldSSTable=getCurrentColumnFamilyStore().getLiveSSTables().iterator().next();
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("delete from %s where id=1 and id2=?",i);
  }
  flush();
  for (  SSTableReader sstable : getCurrentColumnFamilyStore().getLiveSSTables())   if (sstable != oldSSTable)   repair(getCurrentColumnFamilyStore(),sstable);
  Thread.sleep(2000);
  for (int i=20; i < 30; i++) {
    execute("delete from %s where id=1 and id2=?",i);
  }
  flush();
  Thread.sleep(2000);
  verify(30,0,30);
  verify2(1,30,0,30);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowCacheTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowCachePartialLoad() throws Exception {
  CacheService.instance.setRowCacheCapacityInMB(1);
  rowCacheLoad(100,50,0);
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowCacheLoad() throws Exception {
  CacheService.instance.setRowCacheCapacityInMB(1);
  rowCacheLoad(100,Integer.MAX_VALUE,0);
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ScrubTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailScrubCompositeIndex() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX2,COL_INDEX,true,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubMultiRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.clearUnsafe();
  fillCF(cfs,10);
  assertOrderedAll(cfs,10);
  CompactionManager.instance.performScrub(cfs,false,true);
  assertOrderedAll(cfs,10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailScrubKeysIndex() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX1,COL_INDEX,false,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubTwice() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX1,COL_INDEX,false,true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubNoIndex() throws IOException, ExecutionException, InterruptedException, ConfigurationException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.clearUnsafe();
  fillCF(cfs,10);
  assertOrderedAll(cfs,10);
  for (  SSTableReader sstable : cfs.getLiveSSTables())   new File(sstable.descriptor.filenameFor(Component.PRIMARY_INDEX)).delete();
  CompactionManager.instance.performScrub(cfs,false,true,true);
  assertOrderedAll(cfs,10);
}

</code></pre>

<br>
<pre class="type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubOneRowWithCorruptedKey() throws IOException, ExecutionException, InterruptedException, ConfigurationException {
  assumeTrue(!Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false")));
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.clearUnsafe();
  fillCF(cfs,4);
  assertOrderedAll(cfs,4);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,0,2);
  CompactionManager.instance.performScrub(cfs,false,true);
  assertOrderedAll(cfs,4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubCompositeIndex_preserveOrder() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX2_BYTEORDERED,COL_INDEX,true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubOneRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.clearUnsafe();
  fillCF(cfs,1);
  assertOrderedAll(cfs,1);
  CompactionManager.instance.performScrub(cfs,false,true);
  assertOrderedAll(cfs,1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubCorruptedCounterRowNoEarlyOpen() throws IOException, WriteTimeoutException {
  boolean oldDisabledVal=SSTableRewriter.disableEarlyOpeningForTests;
  try {
    SSTableRewriter.disableEarlyOpeningForTests=true;
    testScrubCorruptedCounterRow();
  }
  finally {
    SSTableRewriter.disableEarlyOpeningForTests=oldDisabledVal;
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubCompositeIndex() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX2,COL_INDEX,true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubColumnValidation() throws InterruptedException, RequestExecutionException, ExecutionException {
  QueryProcessor.process(String.format("CREATE TABLE \"%s\".test_compact_static_columns (a bigint, b timeuuid, c boolean static, d text, PRIMARY KEY (a, b))",KEYSPACE),ConsistencyLevel.ONE);
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("test_compact_static_columns");
  QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".test_compact_static_columns (a, b, c, d) VALUES (123, c3db07e8-b602-11e3-bc6b-e0b9a54a6d93, true, 'foobar')",KEYSPACE));
  cfs.forceBlockingFlush();
  CompactionManager.instance.performScrub(cfs,false,true);
  QueryProcessor.process("CREATE TABLE \"Keyspace1\".test_scrub_validation (a text primary key, b int)",ConsistencyLevel.ONE);
  ColumnFamilyStore cfs2=keyspace.getColumnFamilyStore("test_scrub_validation");
  new Mutation(UpdateBuilder.create(cfs2.metadata,"key").newRow().add("b",LongType.instance.decompose(1L)).build()).apply();
  cfs2.forceBlockingFlush();
  CompactionManager.instance.performScrub(cfs2,false,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubKeysIndex() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX1,COL_INDEX,false,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScrubKeysIndex_preserveOrder() throws IOException, ExecutionException, InterruptedException {
  testScrubIndex(CF_INDEX1_BYTEORDERED,COL_INDEX,false,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SecondaryIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeysSearcherSimple() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(WITH_KEYS_INDEX);
  for (int i=0; i < 10; i++)   new RowUpdateBuilder(cfs.metadata,0,"k" + i).noRowMarker().add("birthdate",1l).build().applyUnsafe();
  assertIndexedCount(cfs,ByteBufferUtil.bytes("birthdate"),1l,10);
  cfs.forceBlockingFlush();
  assertIndexedCount(cfs,ByteBufferUtil.bytes("birthdate"),1l,10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteKeysIndex() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_KEYS_INDEX);
  ByteBuffer colName=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,1,"k1").add("birthdate",10l).build().applyUnsafe();
  RowUpdateBuilder.deleteRow(cfs.metadata,2,"k1").applyUnsafe();
  try {
    Thread.sleep(1000);
  }
 catch (  Exception e) {
  }
  assertIndexedNone(cfs,colName,10l);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexUpdateOverwritingExpiringColumns() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  ByteBuffer col=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,1L,500,"K100").clustering("c").add("birthdate",100L).build().applyUnsafe();
  assertIndexedOne(cfs,col,100L);
  TimeUnit.SECONDS.sleep(1);
  new RowUpdateBuilder(cfs.metadata,1L,500,"K100").clustering("c").add("birthdate",100L).build().applyUnsafe();
  assertIndexedOne(cfs,col,100L);
  new RowUpdateBuilder(cfs.metadata,1L,500,"K101").clustering("c").add("birthdate",101L).build().applyUnsafe();
  assertIndexedOne(cfs,col,101L);
  TimeUnit.SECONDS.sleep(1);
  new RowUpdateBuilder(cfs.metadata,1L,500,"K101").clustering("c").add("birthdate",102L).build().applyUnsafe();
  assertIndexedNone(cfs,col,101L);
  assertIndexedOne(cfs,col,102L);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteOfInconsistentValuesFromCompositeIndex() throws Exception {
  runDeleteOfInconsistentValuesFromCompositeIndexTest(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteOfInconsistentValuesFromCompositeIndexOnStaticColumn() throws Exception {
  runDeleteOfInconsistentValuesFromCompositeIndexTest(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteCompositeIndex() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  ByteBuffer colName=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,1,"k1").clustering("c").add("birthdate",10l).build().applyUnsafe();
  RowUpdateBuilder.deleteRow(cfs.metadata,2,"k1","c").applyUnsafe();
  try {
    Thread.sleep(1000);
  }
 catch (  Exception e) {
  }
  assertIndexedNone(cfs,colName,10l);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompositeIndexUpdate() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  ByteBuffer col=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,1,"testIndexUpdate").clustering("c").add("birthdate",100L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,2,"testIndexUpdate").clustering("c").add("birthdate",200L).build().applyUnsafe();
  assertIndexedNone(cfs,col,100L);
  assertIndexedOne(cfs,col,200L);
  assertIndexedNone(cfs,col,300L);
  assertIndexedOne(cfs,col,200L);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteOfInconsistentValuesInKeysIndex() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(WITH_KEYS_INDEX);
  ByteBuffer col=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,1,"k1").noRowMarker().add("birthdate",1L).build().applyUnsafe();
  keyspace.getColumnFamilyStore(WITH_KEYS_INDEX).forceBlockingFlush();
  keyspace.apply(new RowUpdateBuilder(cfs.metadata,2,"k1").noRowMarker().add("birthdate",2L).build(),true,false);
  assertIndexedNone(cfs,col,1L);
  assertIndexedNone(cfs,col,2L);
  keyspace.apply(new RowUpdateBuilder(cfs.metadata,3,"k1").noRowMarker().add("birthdate",1L).build(),true,false);
  assertIndexedNone(cfs,col,1L);
  ColumnFamilyStore indexCfs=cfs.indexManager.getAllIndexColumnFamilyStores().iterator().next();
  assertIndexCfsIsEmpty(indexCfs);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexScanWithLimitOne(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  Mutation rm;
  new RowUpdateBuilder(cfs.metadata,0,"kk1").clustering("c").add("birthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk1").clustering("c").add("notbirthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk2").clustering("c").add("birthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk2").clustering("c").add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk3").clustering("c").add("birthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk3").clustering("c").add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk4").clustering("c").add("birthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"kk4").clustering("c").add("notbirthdate",2L).build().applyUnsafe();
  Util.getOnlyRow(Util.cmd(cfs).filterOn("birthdate",Operator.EQ,1L).filterOn("notbirthdate",Operator.EQ,1L).withLimit(1).build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SystemKeyspaceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonLocalToken() throws UnknownHostException {
  BytesToken token=new BytesToken(ByteBufferUtil.bytes("token3"));
  InetAddress address=InetAddress.getByName("127.0.0.2");
  SystemKeyspace.updateTokens(address,Collections.<Token>singletonList(token));
  assert SystemKeyspace.loadTokens().get(address).contains(token);
  SystemKeyspace.removeEndpoint(address);
  assert !SystemKeyspace.loadTokens().containsValue(token);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocalTokens(){
  Collection<Token> current=SystemKeyspace.loadTokens().asMap().get(FBUtilities.getLocalAddress());
  if (current != null && !current.isEmpty())   SystemKeyspace.updateTokens(current);
  List<Token> tokens=new ArrayList<Token>(){
{
      for (int i=0; i < 9; i++)       add(new BytesToken(ByteBufferUtil.bytes(String.format("token%d",i))));
    }
  }
;
  SystemKeyspace.updateTokens(tokens);
  int count=0;
  for (  Token tok : SystemKeyspace.getSavedTokens())   assert tokens.get(count++).equals(tok);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMigrateDataDirs_2_1() throws IOException {
  testMigrateDataDirs("2.1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocalHostID(){
  UUID firstId=SystemKeyspace.getLocalHostId();
  UUID secondId=SystemKeyspace.getLocalHostId();
  assert firstId.equals(secondId) : String.format("%s != %s%n",firstId.toString(),secondId.toString());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMigrateDataDirs_2_2() throws IOException {
  testMigrateDataDirs("2.2");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.TimeSortTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMixedSources() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",0,100,0,100L);
  cfs.forceBlockingFlush();
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",0,0,1,0L);
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b >= ? LIMIT 1000",0,10),row(0,100,0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogDescriptorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDescriptorPersistence() throws IOException {
  testDescriptorPersistence(new CommitLogDescriptor(11,null,neverEnabledEncryption));
  testDescriptorPersistence(new CommitLogDescriptor(CommitLogDescriptor.VERSION_21,13,null,neverEnabledEncryption));
  testDescriptorPersistence(new CommitLogDescriptor(CommitLogDescriptor.VERSION_22,15,null,neverEnabledEncryption));
  testDescriptorPersistence(new CommitLogDescriptor(CommitLogDescriptor.VERSION_22,17,new ParameterizedClass("LZ4Compressor",null),neverEnabledEncryption));
  testDescriptorPersistence(new CommitLogDescriptor(CommitLogDescriptor.VERSION_22,19,new ParameterizedClass("StubbyCompressor",ImmutableMap.of("parameter1","value1","flag2","55","argument3","null")),neverEnabledEncryption));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogStressTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDiscardedRun() throws Exception {
  randomSize=true;
  discardedRun=true;
  testAllLogConfigs();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomSize() throws Exception {
  randomSize=true;
  discardedRun=false;
  testAllLogConfigs();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFixedSize() throws Exception {
  randomSize=false;
  discardedRun=false;
  testAllLogConfigs();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithZeroLog() throws Exception {
  testRecovery(new byte[10],null);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void replay_Compressed_Deflate() throws IOException {
  replay_Compressed(new ParameterizedClass(DeflateCompressor.class.getName(),Collections.<String,String>emptyMap()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithShortLog() throws Exception {
  testRecoveryWithBadSizeArgument(100,10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void replay_StandardMmapped() throws IOException {
  DatabaseDescriptor.setCommitLogCompression(null);
  DatabaseDescriptor.setEncryptionContext(EncryptionContextGenerator.createDisabledContext());
  CommitLog commitLog=new CommitLog(logDirectory,CommitLogArchiver.disabled()).start();
  replaySimple(commitLog);
  replayWithDiscard(commitLog);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void replay_Encrypted() throws IOException {
  DatabaseDescriptor.setCommitLogCompression(null);
  DatabaseDescriptor.setEncryptionContext(EncryptionContextGenerator.createContext(true));
  CommitLog commitLog=new CommitLog(logDirectory,CommitLogArchiver.disabled()).start();
  try {
    replaySimple(commitLog);
    replayWithDiscard(commitLog);
  }
  finally {
    for (    String file : commitLog.getActiveSegmentNames())     FileUtils.delete(new File(commitLog.location,file));
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithGarbageLog_ignoredByProperty() throws Exception {
  try {
    System.setProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY,"true");
    testRecoveryWithGarbageLog();
  }
  finally {
    System.clearProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithShortMutationSize() throws Exception {
  testRecoveryWithBadSizeArgument(9,10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithEmptyLog20() throws Exception {
  CommitLog.instance.recover(tmpFile(CommitLogDescriptor.VERSION_20));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithBadSizeChecksum() throws Exception {
  Checksum checksum=new CRC32();
  checksum.update(100);
  testRecoveryWithBadSizeArgument(100,100,~checksum.getValue());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEqualRecordLimit() throws Exception {
  CommitLog.instance.resetUnsafe(true);
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(STANDARD1);
  Mutation rm=new RowUpdateBuilder(cfs.metadata,0,"k").clustering("bytes").add("val",ByteBuffer.allocate(getMaxRecordDataSize())).build();
  CommitLog.instance.add(rm);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void replay_Compressed_Snappy() throws IOException {
  replay_Compressed(new ParameterizedClass(SnappyCompressor.class.getName(),Collections.<String,String>emptyMap()));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testExceedRecordLimit() throws Exception {
  CommitLog.instance.resetUnsafe(true);
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(STANDARD1);
  Mutation rm=new RowUpdateBuilder(cfs.metadata,0,"k").clustering("bytes").add("val",ByteBuffer.allocate(1 + getMaxRecordDataSize())).build();
  CommitLog.instance.add(rm);
  throw new AssertionError("mutation larger than limit was accepted");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void replay_Compressed_LZ4() throws IOException {
  replay_Compressed(new ParameterizedClass(LZ4Compressor.class.getName(),Collections.<String,String>emptyMap()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveryWithNegativeSizeArgument() throws Exception {
  testRecoveryWithBadSizeArgument(-10,10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogUpgradeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test21() throws Exception {
  testRestore(DATA_DIR + "2.1");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CommitLogReplayException.class) public void test22_bitrot() throws Exception {
  shouldBeKilled=true;
  testRestore(DATA_DIR + "2.2-lz4-bitrot");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22() throws Exception {
  testRestore(DATA_DIR + "2.2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22_bitrot2_ignored() throws Exception {
  try {
    System.setProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY,"true");
    testRestore(DATA_DIR + "2.2-lz4-bitrot2");
  }
  finally {
    System.clearProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test34_encrypted() throws Exception {
  testRestore(DATA_DIR + "3.4-encrypted");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22_LZ4() throws Exception {
  testRestore(DATA_DIR + "2.2-lz4");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CommitLogReplayException.class) public void test22_bitrot2() throws Exception {
  shouldBeKilled=true;
  testRestore(DATA_DIR + "2.2-lz4-bitrot2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test20() throws Exception {
  testRestore(DATA_DIR + "2.0");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22_bitrot_ignored() throws Exception {
  try {
    System.setProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY,"true");
    testRestore(DATA_DIR + "2.2-lz4-bitrot");
  }
  finally {
    System.clearProperty(CommitLogReplayer.IGNORE_REPLAY_ERRORS_PROPERTY);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22_Snappy() throws Exception {
  testRestore(DATA_DIR + "2.2-snappy");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.SegmentReaderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void compressedSegmenter_Deflate() throws IOException {
  compressedSegmenter(DeflateCompressor.create(null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void compressedSegmenter_Snappy() throws IOException {
  compressedSegmenter(SnappyCompressor.create(null));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void compressedSegmenter_LZ4() throws IOException {
  compressedSegmenter(LZ4Compressor.create(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.AntiCompactionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void antiCompactTenSTC() throws InterruptedException, IOException {
  antiCompactTen("SizeTieredCompactionStrategy");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void antiCompactTenLC() throws InterruptedException, IOException {
  antiCompactTen("LeveledCompactionStrategy");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.BlacklistingCompactionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlacklistingWithLeveledCompactionStrategy() throws Exception {
  testBlacklisting(LeveledCompactionStrategy.class.getCanonicalName());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlacklistingWithSizeTieredCompactionStrategy() throws Exception {
  testBlacklisting(SizeTieredCompactionStrategy.class.getCanonicalName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsCQLTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testBadLocalCompactionStrategyOptions(){
  createTable("CREATE TABLE %s (id text PRIMARY KEY)");
  Map<String,String> localOptions=new HashMap<>();
  localOptions.put("class","SizeTieredCompactionStrategy");
  localOptions.put("sstable_size_in_mb","1234");
  getCurrentColumnFamilyStore().setCompactionParameters(localOptions);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleSSTableCompactionWithSizeTieredCompaction() throws Exception {
  testSingleSSTableCompaction(SizeTieredCompactionStrategy.class.getCanonicalName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LongCompactionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compaction with lots of skinny rows.
 */
@Test public void testCompactionSlim() throws Exception {
  testCompaction(2,200000,1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compaction with a very wide row.
 */
@Test public void testCompactionWide() throws Exception {
  testCompaction(2,1,200000);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test compaction with lots of small sstables.
 */
@Test public void testCompactionMany() throws Exception {
  testCompaction(100,800,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LongLeveledCompactionStrategyTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParallelLeveledCompaction() throws Exception {
  String ksname=KEYSPACE1;
  String cfname="StandardLeveled";
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(cfname);
  store.disableAutoCompaction();
  CompactionStrategyManager mgr=store.getCompactionStrategyManager();
  LeveledCompactionStrategy lcs=(LeveledCompactionStrategy)mgr.getStrategies().get(1).get(0);
  ByteBuffer value=ByteBuffer.wrap(new byte[100 * 1024]);
  int rows=128;
  int columns=10;
  for (int r=0; r < rows; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    UpdateBuilder builder=UpdateBuilder.create(store.metadata,key);
    for (int c=0; c < columns; c++)     builder.newRow("column" + c).add("val",value);
    Mutation rm=new Mutation(builder.build());
    rm.apply();
    store.forceBlockingFlush();
  }
  ExecutorService executor=new ThreadPoolExecutor(4,4,Long.MAX_VALUE,TimeUnit.SECONDS,new LinkedBlockingDeque<Runnable>());
  List<Runnable> tasks=new ArrayList<Runnable>();
  while (true) {
    while (true) {
      final AbstractCompactionTask nextTask=lcs.getNextBackgroundTask(Integer.MIN_VALUE);
      if (nextTask == null)       break;
      tasks.add(new Runnable(){
        public void run(){
          nextTask.execute(null);
        }
      }
);
    }
    if (tasks.isEmpty())     break;
    List<Future<?>> futures=new ArrayList<Future<?>>(tasks.size());
    for (    Runnable r : tasks)     futures.add(executor.submit(r));
    FBUtilities.waitOnFutures(futures);
    tasks.clear();
  }
  LeveledManifest manifest=lcs.manifest;
  int levels=manifest.getLevelCount();
  for (int level=0; level < levels; level++) {
    List<SSTableReader> sstables=manifest.getLevel(level);
    assert (double)SSTableReader.getTotalBytes(sstables) / LeveledManifest.maxBytesForLevel(level,1 * 1024 * 1024) < 1.00;
    for (    SSTableReader sstable : sstables) {
      assert level == sstable.getSSTableLevel();
      if (level > 0) {
        Set<SSTableReader> overlaps=LeveledManifest.overlapping(sstable,sstables);
        assert overlaps.size() == 1 && overlaps.contains(sstable);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.OneCompactionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompaction1(){
  testCompaction("Standard1",1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompaction2(){
  testCompaction("Standard2",2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.composites.CTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleType1(){
  CompositeType baseType=CompositeType.getInstance(BytesType.instance);
  ByteBuffer a=baseType.builder().add(ByteBufferUtil.bytes("a")).build();
  ByteBuffer z=baseType.builder().add(ByteBufferUtil.bytes("z")).build();
  assert baseType.compare(a,z) < 0;
  assert baseType.compare(z,a) > 0;
  assert baseType.compare(a,a) == 0;
  assert baseType.compare(z,z) == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompoundType(){
  CompositeType baseType=CompositeType.getInstance(AsciiType.instance,UUIDType.instance,LongType.instance);
  ByteBuffer a1=baseType.builder().add(ByteBufferUtil.bytes("a")).add(UUIDType.instance.fromString("00000000-0000-0000-0000-000000000000")).add(ByteBufferUtil.bytes(1)).build();
  ByteBuffer a2=baseType.builder().add(ByteBufferUtil.bytes("a")).add(UUIDType.instance.fromString("00000000-0000-0000-0000-000000000000")).add(ByteBufferUtil.bytes(100)).build();
  ByteBuffer b1=baseType.builder().add(ByteBufferUtil.bytes("a")).add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).add(ByteBufferUtil.bytes(1)).build();
  ByteBuffer b2=baseType.builder().add(ByteBufferUtil.bytes("a")).add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).add(ByteBufferUtil.bytes(100)).build();
  ByteBuffer c1=baseType.builder().add(ByteBufferUtil.bytes("z")).add(UUIDType.instance.fromString("00000000-0000-0000-0000-000000000000")).add(ByteBufferUtil.bytes(1)).build();
  ByteBuffer c2=baseType.builder().add(ByteBufferUtil.bytes("z")).add(UUIDType.instance.fromString("00000000-0000-0000-0000-000000000000")).add(ByteBufferUtil.bytes(100)).build();
  ByteBuffer d1=baseType.builder().add(ByteBufferUtil.bytes("z")).add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).add(ByteBufferUtil.bytes(1)).build();
  ByteBuffer d2=baseType.builder().add(ByteBufferUtil.bytes("z")).add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).add(ByteBufferUtil.bytes(100)).build();
  ByteBuffer z1=baseType.builder().add(ByteBufferUtil.EMPTY_BYTE_BUFFER).add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).add(ByteBufferUtil.bytes(100)).build();
  assert baseType.compare(a1,a2) < 0;
  assert baseType.compare(a2,b1) < 0;
  assert baseType.compare(b1,b2) < 0;
  assert baseType.compare(b2,c1) < 0;
  assert baseType.compare(c1,c2) < 0;
  assert baseType.compare(c2,d1) < 0;
  assert baseType.compare(d1,d2) < 0;
  assert baseType.compare(a2,a1) > 0;
  assert baseType.compare(b1,a2) > 0;
  assert baseType.compare(b2,b1) > 0;
  assert baseType.compare(c1,b2) > 0;
  assert baseType.compare(c2,c1) > 0;
  assert baseType.compare(d1,c2) > 0;
  assert baseType.compare(d2,d1) > 0;
  assert baseType.compare(z1,a1) < 0;
  assert baseType.compare(z1,a2) < 0;
  assert baseType.compare(z1,b1) < 0;
  assert baseType.compare(z1,b2) < 0;
  assert baseType.compare(z1,c1) < 0;
  assert baseType.compare(z1,c2) < 0;
  assert baseType.compare(z1,d1) < 0;
  assert baseType.compare(z1,d2) < 0;
  assert baseType.compare(a1,a1) == 0;
  assert baseType.compare(a2,a2) == 0;
  assert baseType.compare(b1,b1) == 0;
  assert baseType.compare(b2,b2) == 0;
  assert baseType.compare(c1,c1) == 0;
  assert baseType.compare(c2,c2) == 0;
  assert baseType.compare(z1,z1) == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleType2(){
  CompositeType baseType=CompositeType.getInstance(UUIDType.instance);
  ByteBuffer a=baseType.builder().add(UUIDType.instance.fromString("00000000-0000-0000-0000-000000000000")).build();
  ByteBuffer z=baseType.builder().add(UUIDType.instance.fromString("ffffffff-ffff-ffff-ffff-ffffffffffff")).build();
  assert baseType.compare(a,z) < 0;
  assert baseType.compare(z,a) > 0;
  assert baseType.compare(a,a) == 0;
  assert baseType.compare(z,z) == 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.filter.SliceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSliceNormalization(){
  List<AbstractType<?>> types=new ArrayList<>();
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  ClusteringComparator cc=new ClusteringComparator(types);
  assertSlicesNormalization(cc,slices(s(0,2),s(2,4)),slices(s(0,4)));
  assertSlicesNormalization(cc,slices(s(0,2),s(1,4)),slices(s(0,4)));
  assertSlicesNormalization(cc,slices(s(0,2),s(3,4),s(3,4)),slices(s(0,2),s(3,4)));
  assertSlicesNormalization(cc,slices(s(-1,3),s(-1,4)),slices(s(-1,4)));
  assertSlicesNormalization(cc,slices(s(-1,2),s(-1,3),s(5,9)),slices(s(-1,3),s(5,9)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.HelpersTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcatUniq(){
  check(Helpers.concatUniq(a,b,a,c,b,a),abc);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterOut(){
  check(Helpers.filterOut(abc,a),set(4,5,6,7,8,9));
  check(Helpers.filterOut(abc,b),set(1,2,3,7,8,9));
  check(Helpers.filterOut(a,a),set());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterIn(){
  check(Helpers.filterIn(abc,a),a);
  check(Helpers.filterIn(abc,a,c),set(1,2,3,7,8,9));
  check(Helpers.filterIn(a,c),set());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.RealTransactionsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRewriteAborted() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(REWRITE_ABORTED_CF);
  SSTableReader oldSSTable=getSSTable(cfs,1);
  LifecycleTransaction txn=cfs.getTracker().tryModify(oldSSTable,OperationType.COMPACTION);
  replaceSSTable(cfs,txn,true);
  LogTransaction.waitForDeletions();
  assertFiles(oldSSTable.descriptor.directory.getPath(),new HashSet<>(oldSSTable.getAllFilePaths()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlush() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(FLUSH_CF);
  SSTableReader ssTableReader=getSSTable(cfs,100);
  String dataFolder=cfs.getLiveSSTables().iterator().next().descriptor.directory.getPath();
  assertFiles(dataFolder,new HashSet<>(ssTableReader.getAllFilePaths()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRewriteFinished() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(REWRITE_FINISHED_CF);
  SSTableReader oldSSTable=getSSTable(cfs,1);
  LifecycleTransaction txn=cfs.getTracker().tryModify(oldSSTable,OperationType.COMPACTION);
  SSTableReader newSSTable=replaceSSTable(cfs,txn,false);
  LogTransaction.waitForDeletions();
  assertFiles(oldSSTable.descriptor.directory.getPath(),new HashSet<>(newSSTable.getAllFilePaths()));
  assertFiles(newSSTable.descriptor.directory.getPath(),new HashSet<>(newSSTable.getAllFilePaths()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.TrackerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropSSTables(){
  testDropSSTables(false);
  LogTransaction.waitForDeletions();
  testDropSSTables(true);
  LogTransaction.waitForDeletions();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.BytesTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromStringWithValidString(){
  BytesType.instance.fromString(VALID_HEX);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testFromStringWithInvalidString(){
  BytesType.instance.fromString(INVALID_HEX);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.CompositeTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompatibility() throws Exception {
  assert TypeParser.parse("CompositeType(IntegerType, BytesType)").isCompatibleWith(TypeParser.parse("CompositeType(IntegerType)"));
  assert TypeParser.parse("CompositeType(IntegerType, BytesType)").isCompatibleWith(TypeParser.parse("CompositeType(IntegerType, BytesType)"));
  assert TypeParser.parse("CompositeType(BytesType, BytesType)").isCompatibleWith(TypeParser.parse("CompositeType(AsciiType, BytesType)"));
  assert !TypeParser.parse("CompositeType(IntegerType)").isCompatibleWith(TypeParser.parse("CompositeType(IntegerType, BytesType)"));
  assert !TypeParser.parse("CompositeType(IntegerType)").isCompatibleWith(TypeParser.parse("CompositeType(BytesType)"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFullRound() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARDCOMPOSITE);
  ByteBuffer cname1=createCompositeKey("test1",null,-1,false);
  ByteBuffer cname2=createCompositeKey("test1",uuids[0],24,false);
  ByteBuffer cname3=createCompositeKey("test1",uuids[0],42,false);
  ByteBuffer cname4=createCompositeKey("test2",uuids[0],-1,false);
  ByteBuffer cname5=createCompositeKey("test2",uuids[1],42,false);
  ByteBuffer key=ByteBufferUtil.bytes("k");
  long ts=FBUtilities.timestampMicros();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname5).add("val","cname5").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname1).add("val","cname1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname4).add("val","cname4").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname2).add("val","cname2").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname3).add("val","cname3").build().applyUnsafe();
  ColumnDefinition cdef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ImmutableBTreePartition readPartition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  Iterator<Row> iter=readPartition.iterator();
  compareValues(iter.next().getCell(cdef),"cname1");
  compareValues(iter.next().getCell(cdef),"cname2");
  compareValues(iter.next().getCell(cdef),"cname3");
  compareValues(iter.next().getCell(cdef),"cname4");
  compareValues(iter.next().getCell(cdef),"cname5");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEndOfComponent(){
  ByteBuffer[] cnames={createCompositeKey("test1",uuids[0],-1,false),createCompositeKey("test1",uuids[1],24,false),createCompositeKey("test1",uuids[1],42,false),createCompositeKey("test1",uuids[1],83,false),createCompositeKey("test1",uuids[2],-1,false),createCompositeKey("test1",uuids[2],42,false)};
  ByteBuffer start=createCompositeKey("test1",uuids[1],-1,false);
  ByteBuffer stop=createCompositeKey("test1",uuids[1],-1,true);
  for (int i=0; i < 1; ++i) {
    assert comparator.compare(start,cnames[i]) > 0;
    assert comparator.compare(stop,cnames[i]) > 0;
  }
  for (int i=1; i < 4; ++i) {
    assert comparator.compare(start,cnames[i]) < 0;
    assert comparator.compare(stop,cnames[i]) > 0;
  }
  for (int i=4; i < cnames.length; ++i) {
    assert comparator.compare(start,cnames[i]) < 0;
    assert comparator.compare(stop,cnames[i]) < 0;
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetString(){
  String test1Hex=ByteBufferUtil.bytesToHex(ByteBufferUtil.bytes("test1"));
  ByteBuffer key=createCompositeKey("test1",uuids[1],42,false);
  assert comparator.getString(key).equals(test1Hex + ":" + uuids[1]+ ":42");
  key=createCompositeKey("test1",uuids[1],-1,true);
  assert comparator.getString(key).equals(test1Hex + ":" + uuids[1]+ ":!");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromString(){
  String test1Hex=ByteBufferUtil.bytesToHex(ByteBufferUtil.bytes("test1"));
  ByteBuffer key=createCompositeKey("test1",uuids[1],42,false);
  assert key.equals(comparator.fromString(test1Hex + ":" + uuids[1]+ ":42"));
  key=createCompositeKey("test1",uuids[1],-1,true);
  assert key.equals(comparator.fromString(test1Hex + ":" + uuids[1]+ ":!"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.DynamicCompositeTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEndOfComponent(){
  ByteBuffer[] cnames={createDynamicCompositeKey("test1",uuids[0],-1,false),createDynamicCompositeKey("test1",uuids[1],24,false),createDynamicCompositeKey("test1",uuids[1],42,false),createDynamicCompositeKey("test1",uuids[1],83,false),createDynamicCompositeKey("test1",uuids[2],-1,false),createDynamicCompositeKey("test1",uuids[2],42,false)};
  ByteBuffer start=createDynamicCompositeKey("test1",uuids[1],-1,false);
  ByteBuffer stop=createDynamicCompositeKey("test1",uuids[1],-1,true);
  for (int i=0; i < 1; ++i) {
    assert comparator.compare(start,cnames[i]) > 0;
    assert comparator.compare(stop,cnames[i]) > 0;
  }
  for (int i=1; i < 4; ++i) {
    assert comparator.compare(start,cnames[i]) < 0;
    assert comparator.compare(stop,cnames[i]) > 0;
  }
  for (int i=4; i < cnames.length; ++i) {
    assert comparator.compare(start,cnames[i]) < 0;
    assert comparator.compare(stop,cnames[i]) < 0;
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetString(){
  String test1Hex=ByteBufferUtil.bytesToHex(ByteBufferUtil.bytes("test1"));
  ByteBuffer key=createDynamicCompositeKey("test1",uuids[1],42,false);
  assert comparator.getString(key).equals("b@" + test1Hex + ":t@"+ uuids[1]+ ":IntegerType@42");
  key=createDynamicCompositeKey("test1",uuids[1],-1,true);
  assert comparator.getString(key).equals("b@" + test1Hex + ":t@"+ uuids[1]+ ":!");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromString(){
  String test1Hex=ByteBufferUtil.bytesToHex(ByteBufferUtil.bytes("test1"));
  ByteBuffer key=createDynamicCompositeKey("test1",uuids[1],42,false);
  assert key.equals(comparator.fromString("b@" + test1Hex + ":t@"+ uuids[1]+ ":IntegerType@42"));
  key=createDynamicCompositeKey("test1",uuids[1],-1,true);
  assert key.equals(comparator.fromString("b@" + test1Hex + ":t@"+ uuids[1]+ ":!"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFullRoundReversed() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARDDYNCOMPOSITE);
  ByteBuffer cname1=createDynamicCompositeKey("test1",null,-1,false,true);
  ByteBuffer cname2=createDynamicCompositeKey("test1",uuids[0],24,false,true);
  ByteBuffer cname3=createDynamicCompositeKey("test1",uuids[0],42,false,true);
  ByteBuffer cname4=createDynamicCompositeKey("test2",uuids[0],-1,false,true);
  ByteBuffer cname5=createDynamicCompositeKey("test2",uuids[1],42,false,true);
  ByteBuffer key=ByteBufferUtil.bytes("kr");
  long ts=FBUtilities.timestampMicros();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname5).add("val","cname5").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname1).add("val","cname1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname4).add("val","cname4").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname2).add("val","cname2").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname3).add("val","cname3").build().applyUnsafe();
  ColumnDefinition cdef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ImmutableBTreePartition readPartition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  Iterator<Row> iter=readPartition.iterator();
  compareValues(iter.next().getCell(cdef),"cname5");
  compareValues(iter.next().getCell(cdef),"cname4");
  compareValues(iter.next().getCell(cdef),"cname1");
  compareValues(iter.next().getCell(cdef),"cname3");
  compareValues(iter.next().getCell(cdef),"cname2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFullRound() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARDDYNCOMPOSITE);
  ByteBuffer cname1=createDynamicCompositeKey("test1",null,-1,false);
  ByteBuffer cname2=createDynamicCompositeKey("test1",uuids[0],24,false);
  ByteBuffer cname3=createDynamicCompositeKey("test1",uuids[0],42,false);
  ByteBuffer cname4=createDynamicCompositeKey("test2",uuids[0],-1,false);
  ByteBuffer cname5=createDynamicCompositeKey("test2",uuids[1],42,false);
  ByteBuffer key=ByteBufferUtil.bytes("k");
  long ts=FBUtilities.timestampMicros();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname5).add("val","cname5").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname1).add("val","cname1").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname4).add("val","cname4").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname2).add("val","cname2").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,ts,key).clustering(cname3).add("val","cname3").build().applyUnsafe();
  ColumnDefinition cdef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ImmutableBTreePartition readPartition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  Iterator<Row> iter=readPartition.iterator();
  compareValues(iter.next().getCell(cdef),"cname1");
  compareValues(iter.next().getCell(cdef),"cname2");
  compareValues(iter.next().getCell(cdef),"cname3");
  compareValues(iter.next().getCell(cdef),"cname4");
  compareValues(iter.next().getCell(cdef),"cname5");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.IntegerTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testZeroLengthArray(){
  assertSignum("0-1",-1,comparator.compare(ByteBuffer.wrap(new byte[0]),ByteBuffer.wrap(new byte[1])));
  assertSignum("1-0",1,comparator.compare(ByteBuffer.wrap(new byte[1]),ByteBuffer.wrap(new byte[0])));
  assertSignum("0-0",0,comparator.compare(ByteBuffer.wrap(new byte[0]),ByteBuffer.wrap(new byte[0])));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void testNullBoth(){
  comparator.compare(null,null);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void testNullRight(){
  comparator.compare(ByteBuffer.wrap(new byte[1]),null);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void testNullLeft(){
  comparator.compare(null,ByteBuffer.wrap(new byte[1]));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSameLength(){
  ByteBuffer n1=ByteBuffer.wrap(new byte[]{-2,2,-4,-5});
  ByteBuffer n2=ByteBuffer.wrap(new byte[]{-2,3,-5,-4});
  ByteBuffer p1=ByteBuffer.wrap(new byte[]{2,3,-4,-5});
  ByteBuffer p2=ByteBuffer.wrap(new byte[]{2,-2,-5,-4});
  assertSignum("n1n2",-1,comparator.compare(n1,n2));
  assertSignum("n2n1",1,comparator.compare(n2,n1));
  assertSignum("p1p2",-1,comparator.compare(p1,p2));
  assertSignum("p2p1",1,comparator.compare(p2,p1));
  assertSignum("p1n1",1,comparator.compare(p1,n1));
  assertSignum("p1n2",1,comparator.compare(p1,n2));
  assertSignum("n1p1",-1,comparator.compare(n1,p1));
  assertSignum("n2p1",-1,comparator.compare(n2,p1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSanity(){
  ByteBuffer nN=ByteBuffer.wrap(new byte[]{-1});
  ByteBuffer nZ=ByteBuffer.wrap(new byte[]{0});
  ByteBuffer nP=ByteBuffer.wrap(new byte[]{1});
  assertSignum("ZN",1,comparator.compare(nZ,nN));
  assertSignum("NZ",-1,comparator.compare(nN,nZ));
  assertSignum("ZP",-1,comparator.compare(nZ,nP));
  assertSignum("PZ",1,comparator.compare(nP,nZ));
  assertSignum("PN",1,comparator.compare(nP,nN));
  assertSignum("NP",-1,comparator.compare(nN,nP));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.ReversedTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReverseComparison(){
  ReversedType<Long> t=ReversedType.getInstance(LongType.instance);
  assert t.compare(bytes(2L),bytes(4L)) > 0;
  assert t.compare(bytes(4L),bytes(2L)) < 0;
  assert t.compare(EMPTY_BYTE_BUFFER,bytes(2L)) < 0;
  assert t.compare(bytes(2L),EMPTY_BYTE_BUFFER) > 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.RoundTripTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeUUID(){
  UUID uuid=UUIDGen.getTimeUUID();
  assert TimeUUIDType.instance.getString(TimeUUIDType.instance.fromString(uuid.toString())).equals(uuid.toString());
  assert TimeUUIDType.instance.fromString(TimeUUIDType.instance.getString(ByteBuffer.wrap(UUIDGen.decompose(uuid)))).equals(ByteBuffer.wrap(UUIDGen.decompose(uuid)));
  assert TimeUUIDType.instance.compose(ByteBuffer.wrap(UUIDGen.decompose(uuid))).equals(uuid);
  assert uuid.equals(TimeUUIDType.instance.compose(TimeUUIDType.instance.fromString(uuid.toString())));
  assert UUIDSerializer.instance.toString(uuid).equals(uuid.toString());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void intLong(){
  byte[] v=new byte[]{0,0,0,1};
  assert Int32Type.instance.getString(Int32Type.instance.fromString("1")).equals("1");
  assert Int32Type.instance.fromString(Int32Type.instance.getString(ByteBuffer.wrap(v))).equals(ByteBuffer.wrap(v));
  assert Int32Type.instance.compose(ByteBuffer.wrap(v)) == 1;
  assert Int32Serializer.instance.toString(1).equals("1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBytes(){
  byte[] v=new byte[]{1,2,3,4,5,6,7,8,9,10};
  assert BytesType.instance.compose(ByteBuffer.wrap(v)).equals(ByteBuffer.wrap(v));
  assert BytesSerializer.instance.toString(ByteBuffer.wrap(v)).equals(Hex.bytesToHex(v));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLong(){
  byte[] v=new byte[]{0,0,0,0,0,0,0,1};
  assert LongType.instance.getString(LongType.instance.fromString("1")).equals("1");
  assert LongType.instance.fromString(LongType.instance.getString(ByteBuffer.wrap(v))).equals(ByteBuffer.wrap(v));
  assert LongType.instance.compose(ByteBuffer.wrap(v)) == 1L;
  assert LongSerializer.instance.toString(1L).equals("1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteger(){
  BigInteger bi=new BigInteger("1");
  assert bi.intValue() == 1;
  assert IntegerType.instance.getString(IntegerType.instance.fromString("1")).equals("1");
  assert IntegerType.instance.fromString(IntegerType.instance.getString(ByteBuffer.wrap(bi.toByteArray()))).equals(ByteBuffer.wrap(bi.toByteArray()));
  assert IntegerType.instance.compose(ByteBuffer.wrap(bi.toByteArray())).equals(bi);
  assert IntegerSerializer.instance.toString(bi).equals("1");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUtf8() throws Exception {
  String v="\u2297\u5432\u2376\u263d\uf543";
  assert UTF8Type.instance.getString(UTF8Type.instance.fromString(v)).equals(v);
  assert UTF8Type.instance.fromString(UTF8Type.instance.getString(ByteBuffer.wrap(v.getBytes(StandardCharsets.UTF_8)))).equals(ByteBuffer.wrap(v.getBytes(StandardCharsets.UTF_8)));
  assert UTF8Type.instance.compose(ByteBuffer.wrap(v.getBytes(StandardCharsets.UTF_8))).equals(v);
  assert UTF8Serializer.instance.toString(v).equals(v);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAscii() throws Exception {
  byte[] abc="abc".getBytes(StandardCharsets.US_ASCII);
  assert AsciiType.instance.getString(AsciiType.instance.fromString("abc")).equals("abc");
  assert AsciiType.instance.fromString(AsciiType.instance.getString(ByteBuffer.wrap(abc))).equals(ByteBuffer.wrap(abc));
  assert AsciiType.instance.compose(ByteBuffer.wrap(abc)).equals("abc");
  assert AsciiSerializer.instance.toString("abc").equals("abc");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLexicalUUID(){
  UUID uuid=UUIDGen.getTimeUUID();
  assert LexicalUUIDType.instance.fromString(LexicalUUIDType.instance.getString(ByteBuffer.wrap(UUIDGen.decompose(uuid)))).equals(ByteBuffer.wrap(UUIDGen.decompose(uuid)));
  assert LexicalUUIDType.instance.compose(ByteBuffer.wrap(UUIDGen.decompose(uuid))).equals(uuid);
  assert UUIDSerializer.instance.toString(uuid).equals(uuid.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.SimpleDateTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestComparison(){
  ByteBuffer d1=SimpleDateType.instance.fromString("1970-01-05");
  ByteBuffer d2=SimpleDateSerializer.instance.serialize(makeUnsigned(4));
  assert SimpleDateType.instance.compare(d1,d2) == 0 : "Failed == comparison";
  String.format("Failed == comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1970-01-05");
  d2=SimpleDateSerializer.instance.serialize(makeUnsigned(10));
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed comparison of %s and %s, expected <",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1970-01-05");
  d2=SimpleDateSerializer.instance.serialize(makeUnsigned(-10));
  assert SimpleDateType.instance.compare(d1,d2) > 0 : String.format("Failed comparison of %s and %s, expected > 0",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1");
  d2=SimpleDateType.instance.fromString("1000");
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed < comparison with string inputs %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  Integer intLimit=Integer.MAX_VALUE;
  d1=SimpleDateType.instance.fromString("0");
  d2=SimpleDateType.instance.fromString(intLimit.toString());
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed < comparison with string inputs at integer bounds %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  Long overLimit=(long)(Integer.MAX_VALUE);
  d1=SimpleDateType.instance.fromString("0");
  d2=SimpleDateType.instance.fromString(overLimit.toString());
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed < comparison with string inputs at integer bounds %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  Long i1=0L;
  Long i2=(long)Math.pow(2,32) - 1;
  d1=SimpleDateType.instance.fromString(i1.toString());
  d2=SimpleDateType.instance.fromString(i2.toString());
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed limits comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("256");
  d2=SimpleDateType.instance.fromString("512");
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateSerializer.instance.serialize(makeUnsigned(0));
  d2=SimpleDateSerializer.instance.serialize(makeUnsigned(Integer.MAX_VALUE));
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed neg/pos comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("-10000-10-10");
  d2=SimpleDateType.instance.fromString("10000-10-10");
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed neg/pos string comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1969-12-31");
  d2=SimpleDateType.instance.fromString("1970-1-1");
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed pre/post epoch comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1970-1-1");
  d2=SimpleDateType.instance.fromString("1970-1-1");
  assert SimpleDateType.instance.compare(d1,d2) == 0 : String.format("Failed == date from string comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  d1=SimpleDateType.instance.fromString("1970-1-1");
  d2=SimpleDateType.instance.fromString("1970-1-2");
  assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed post epoch string comparison with %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  for (int i=0; i < 32; ++i) {
    int offset=(int)Math.pow(2,i);
    d1=SimpleDateSerializer.instance.serialize(makeUnsigned(0 - offset));
    d2=SimpleDateSerializer.instance.serialize(makeUnsigned(offset));
    assert SimpleDateType.instance.compare(d1,d2) < 0 : String.format("Failed < comparison of %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  }
  for (int i=0; i < 32; ++i) {
    int offset=(int)Math.pow(2,i);
    d1=SimpleDateSerializer.instance.serialize(makeUnsigned(offset));
    d2=SimpleDateSerializer.instance.serialize(makeUnsigned(0 - offset));
    assert SimpleDateType.instance.compare(d1,d2) > 0 : String.format("Failed > comparison of %s and %s",SimpleDateSerializer.instance.deserialize(d1),SimpleDateSerializer.instance.deserialize(d2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TimeTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestComparison(){
  Long t1=TimeSerializer.timeStringToLong("01:00:00.123456789");
  Long t2=new Long((1L * 60L * 60L* 1000L* 1000L* 1000L) + 123456789);
  ByteBuffer b1=TimeSerializer.instance.serialize(t1);
  ByteBuffer b2=TimeSerializer.instance.serialize(t2);
  assert TimeType.instance.compare(b1,b2) == 0 : "Failed == comparison";
  b2=TimeSerializer.instance.serialize(123456789L);
  assert TimeType.instance.compare(b1,b2) > 0 : "Failed > comparison";
  t2=new Long(2L * 60L * 60L* 1000L* 1000L* 1000L + 123456789);
  b2=TimeSerializer.instance.serialize(t2);
  assert TimeType.instance.compare(b1,b2) < 0 : "Failed < comparison";
  b1=TimeSerializer.instance.serialize(0L);
  b2=TimeSerializer.instance.serialize(0L);
  assert TimeType.instance.compare(b1,b2) == 0 : "Failed == comparison on 0";
  b1=TimeSerializer.instance.serialize(0L);
  b2=TimeSerializer.instance.serialize(10000000L);
  assert TimeType.instance.compare(b1,b2) == -1 : "Failed < comparison on 0";
  b1=TimeSerializer.instance.serialize(0L);
  b2=TimeSerializer.instance.serialize(TimeUnit.DAYS.toNanos(1));
  assert TimeType.instance.compare(b1,b2) == -1 : "Failed < comparison against max range.";
  b1=TimeSerializer.instance.serialize(TimeUnit.DAYS.toNanos(1));
  b2=TimeSerializer.instance.serialize(0L);
  assert TimeType.instance.compare(b1,b2) == 1 : "Failed > comparison against max range.";
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TimeUUIDTypeTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalidTimeVersion(){
  UUID uuid2=UUID.fromString("00000000-0000-2100-0000-000000000000");
  assert uuid2.version() == 2;
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(uuid2)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidTimeVersion(){
  UUID uuid1=UUID.fromString("00000000-0000-1000-0000-000000000000");
  assert uuid1.version() == 1;
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(uuid1)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBigger(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=UUIDGen.getTimeUUID();
  UUID c=UUIDGen.getTimeUUID();
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(a)));
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(b)));
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(c)));
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(c)),ByteBuffer.wrap(UUIDGen.decompose(b))) > 0;
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(b)),ByteBuffer.wrap(UUIDGen.decompose(a))) > 0;
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(c)),ByteBuffer.wrap(UUIDGen.decompose(a))) > 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimestampComparison(){
  compareAll(UUIDTypeTest.random(1000,(byte)0x10));
  for (  ByteBuffer[] permutations : UUIDTypeTest.permutations(100,(byte)0x10))   compareAll(permutations);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSmaller(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=UUIDGen.getTimeUUID();
  UUID c=UUIDGen.getTimeUUID();
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(a)));
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(b)));
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(c)));
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(a)),ByteBuffer.wrap(UUIDGen.decompose(b))) < 0;
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(b)),ByteBuffer.wrap(UUIDGen.decompose(c))) < 0;
  assert timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(a)),ByteBuffer.wrap(UUIDGen.decompose(c))) < 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TypeCompareTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeUUID(){
  UUID uuid1=UUID.fromString("1077e700-c7f2-11de-86d5-f5bcc793a028");
  byte[] bytes1=new byte[16];
  ByteBuffer bb1=ByteBuffer.wrap(bytes1);
  bb1.putLong(uuid1.getMostSignificantBits());
  bb1.putLong(uuid1.getLeastSignificantBits());
  UUID uuid2=UUID.fromString("1077e700-c7f2-11de-982e-6fad363d5f29");
  byte[] bytes2=new byte[16];
  ByteBuffer bb2=ByteBuffer.wrap(bytes2);
  bb2.putLong(uuid2.getMostSignificantBits());
  bb2.putLong(uuid2.getLeastSignificantBits());
  assert new TimeUUIDType().compare(ByteBuffer.wrap(bytes1),ByteBuffer.wrap(bytes2)) != 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBytes(){
  BytesType comparator=new BytesType();
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.bytes("asdf")) < 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdf"),ByteBufferUtil.EMPTY_BYTE_BUFFER) > 0;
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("z"),ByteBufferUtil.bytes("a")) > 0;
  assert comparator.compare(ByteBufferUtil.bytes("a"),ByteBufferUtil.bytes("z")) < 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdf"),ByteBufferUtil.bytes("asdf")) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdz"),ByteBufferUtil.bytes("asdf")) > 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUTF8(){
  UTF8Type comparator=new UTF8Type();
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.bytes("asdf")) < 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdf"),ByteBufferUtil.EMPTY_BYTE_BUFFER) > 0;
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("z"),ByteBufferUtil.bytes("a")) > 0;
  assert comparator.compare(ByteBufferUtil.bytes("z"),ByteBufferUtil.bytes("z")) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("a"),ByteBufferUtil.bytes("z")) < 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAscii(){
  AsciiType comparator=new AsciiType();
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.bytes("asdf")) < 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdf"),ByteBufferUtil.EMPTY_BYTE_BUFFER) > 0;
  assert comparator.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("z"),ByteBufferUtil.bytes("a")) > 0;
  assert comparator.compare(ByteBufferUtil.bytes("a"),ByteBufferUtil.bytes("z")) < 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdf"),ByteBufferUtil.bytes("asdf")) == 0;
  assert comparator.compare(ByteBufferUtil.bytes("asdz"),ByteBufferUtil.bytes("asdf")) > 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TypeParserTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParse() throws ConfigurationException, SyntaxException {
  AbstractType<?> type;
  type=TypeParser.parse(null);
  assert type == BytesType.instance;
  type=TypeParser.parse("");
  assert type == BytesType.instance;
  type=TypeParser.parse("    ");
  assert type == BytesType.instance;
  type=TypeParser.parse("LongType");
  assert type == LongType.instance;
  type=TypeParser.parse("  LongType   ");
  assert type == LongType.instance;
  type=TypeParser.parse("LongType()");
  assert type == LongType.instance;
  type=TypeParser.parse("LongType(reversed=false)");
  assert type == LongType.instance;
  type=TypeParser.parse("LongType(reversed=true)");
  assert type == ReversedType.getInstance(LongType.instance);
  assert ((ReversedType<?>)type).baseType == LongType.instance;
  type=TypeParser.parse("LongType(reversed)");
  assert type == ReversedType.getInstance(LongType.instance);
  assert ((ReversedType<?>)type).baseType == LongType.instance;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TypeValidationTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLong(){
  LongType.instance.validate(Util.getBytes(5L));
  LongType.instance.validate(Util.getBytes(5555555555555555555L));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalidTimeUUID(){
  UUID uuid=UUID.randomUUID();
  TimeUUIDType.instance.validate(ByteBuffer.wrap(UUIDGen.decompose(uuid)));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalid2nd(){
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xc2,(byte)0xff}));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidUtf8() throws UnsupportedEncodingException {
  assert Character.MAX_CODE_POINT == 0x0010ffff;
  CharBuffer cb=CharBuffer.allocate(2837314);
  for (int i=0; i < Character.MAX_CODE_POINT; i++) {
    if (i >= 55296 && i <= 57343)     continue;
    char[] ch=Character.toChars(i);
    for (    char c : ch)     cb.append(c);
  }
  String s=new String(cb.array());
  byte[] arr=s.getBytes("UTF8");
  ByteBuffer buf=ByteBuffer.wrap(arr);
  UTF8Type.instance.validate(buf);
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{}));
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{0}));
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{99,(byte)0xc0,(byte)0x80,112}));
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xc2,(byte)0x81}));
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xe0,(byte)0xa0,(byte)0x81}));
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xf0,(byte)0x90,(byte)0x81,(byte)0x81}));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalidAscii(){
  AsciiType.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0x80}));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalid3rd(){
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xe0,(byte)0xa0,(byte)0xff}));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidTimeUUID(){
  TimeUUIDType.instance.validate(ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInt(){
  Int32Type.instance.validate(Util.getBytes(5));
  Int32Type.instance.validate(Util.getBytes(2057022603));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testInvalid4th(){
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{(byte)0xf0,(byte)0x90,(byte)0x81,(byte)0xff}));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testFloatingc0(){
  UTF8Type.instance.validate(ByteBuffer.wrap(new byte[]{99,(byte)0xc0,112}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.UUIDTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeSmaller(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=UUIDGen.getTimeUUID();
  UUID c=UUIDGen.getTimeUUID();
  assert uuidType.compare(bytebuffer(a),bytebuffer(b)) < 0;
  assert uuidType.compare(bytebuffer(b),bytebuffer(c)) < 0;
  assert uuidType.compare(bytebuffer(a),bytebuffer(c)) < 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPermutations(){
  compareAll(random(1000,(byte)0x00,(byte)0x10,(byte)0x20));
  for (  ByteBuffer[] permutations : permutations(10,(byte)0x00,(byte)0x10,(byte)0x20))   compareAll(permutations);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomCompare(){
  UUID t1=UUIDGen.getTimeUUID();
  UUID t2=UUIDGen.getTimeUUID();
  testCompare(null,t2,-1);
  testCompare(t1,null,1);
  testCompare(t1,t2,-1);
  testCompare(t1,t1,0);
  testCompare(t2,t2,0);
  UUID nullId=new UUID(0,0);
  testCompare(nullId,t1,-1);
  testCompare(t2,nullId,1);
  testCompare(nullId,nullId,0);
  for (int test=1; test < 32; test++) {
    UUID r1=UUID.randomUUID();
    UUID r2=UUID.randomUUID();
    testCompare(r1,r2,compareUUID(r1,r2));
    testCompare(r1,r1,0);
    testCompare(r2,r2,0);
    testCompare(t1,r1,-1);
    testCompare(r2,t2,1);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeBigger(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=UUIDGen.getTimeUUID();
  UUID c=UUIDGen.getTimeUUID();
  assert uuidType.compare(bytebuffer(c),bytebuffer(b)) > 0;
  assert uuidType.compare(bytebuffer(b),bytebuffer(a)) > 0;
  assert uuidType.compare(bytebuffer(c),bytebuffer(a)) > 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.monitoring.MonitoringTaskTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxTimedoutOperationsExceeded() throws InterruptedException {
  doTestMaxTimedoutOperations(5,10,6);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testZeroMaxTimedoutOperations() throws InterruptedException {
  doTestMaxTimedoutOperations(0,1,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.DigestBackwardCompatibilityTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactTable() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v text, PRIMARY KEY (k, t)) WITH COMPACT STORAGE");
  String key="someKey";
  int N=10;
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s(k, t, v) VALUES (?, ?, ?) USING TIMESTAMP ? AND TTL ?",key,i,"v" + i,1L,200);
  assertDigest("44785ddd7c62c73287b448b6063645e5",readAndDigest(key));
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE k = ? AND t = ?",2L,key,2);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE k = ?",0L,key);
  assertDigest("55d9bd6335276395d83b18eb17f9abe7",readAndDigest(key));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCounterTable() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, c counter) WITH COMPACT STORAGE");
  String key="someKey";
  CFMetaData metadata=getCurrentColumnFamilyStore().metadata;
  ColumnDefinition column=metadata.getColumnDefinition(ByteBufferUtil.bytes("c"));
  ByteBuffer value=CounterContext.instance().createGlobal(CounterId.fromInt(1),1L,42L);
  Row row=BTreeRow.singleCellRow(Clustering.STATIC_CLUSTERING,BufferCell.live(metadata,column,0L,value));
  new Mutation(PartitionUpdate.singleRowUpdate(metadata,Util.dk(key),row)).applyUnsafe();
  assertDigest("3a5f7b48c320538b4cd2f829e05c6db3",readAndDigest(key));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCQLTable() throws Throwable {
  createTable("CREATE TABLE %s (k text, t int, v1 text, v2 int, PRIMARY KEY (k, t))");
  String key="someKey";
  int N=10;
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s(k, t, v1, v2) VALUES (?, ?, ?, ?) USING TIMESTAMP ? AND TTL ?",key,i,"v" + i,i,1L,200);
  assertDigest("aa608035cf6574a97061b5c166b64939",readAndDigest(key));
  execute("DELETE v1 FROM %s USING TIMESTAMP ? WHERE k = ? AND t = ?",2L,key,2);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE k = ? AND t = ?",3L,key,4);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE k = ?",0L,key);
  assertDigest("b5f38d2dc7b917d221f98ab1641f82bf",readAndDigest(key));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableWithCollection() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, m map<text, text>)");
  String key="someKey";
  execute("INSERT INTO %s(k, m) VALUES (?, { 'foo' : 'value1', 'bar' : 'value2' }) USING TIMESTAMP ?",key,1L);
  assertDigest("708f3fc8bc8149cc3513eef300bf0182",readAndDigest(key));
  execute("DELETE m FROM %s USING TIMESTAMP ? WHERE k = ?",2L,key);
  assertDigest("f39937fc3ed96956ef507e81717fa5cd",readAndDigest(key));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStaticCompactTable() throws Throwable {
  createTable("CREATE TABLE %s (k text PRIMARY KEY, v1 text, v2 int) WITH COMPACT STORAGE");
  String key="someKey";
  execute("INSERT INTO %s(k, v1, v2) VALUES (?, ?, ?) USING TIMESTAMP ?",key,"v",0,1L);
  assertDigest("d2080f9f57d6edf92da1fdaaa76573d3",readAndDigest(key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.RowsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyCellIterator(){
  CFMetaData metadata=CFMetaData.Builder.create("dummy_ks","dummy_tbl").addPartitionKey("k",BytesType.instance).addRegularColumn("a",BytesType.instance).addRegularColumn("b",MapType.getInstance(Int32Type.instance,BytesType.instance,true)).addRegularColumn("c",BytesType.instance).addRegularColumn("d",MapType.getInstance(Int32Type.instance,BytesType.instance,true)).addRegularColumn("e",BytesType.instance).build();
  ColumnDefinition a=metadata.getColumnDefinition(new ColumnIdentifier("a",false));
  ColumnDefinition b=metadata.getColumnDefinition(new ColumnIdentifier("b",false));
  ColumnDefinition c=metadata.getColumnDefinition(new ColumnIdentifier("c",false));
  ColumnDefinition d=metadata.getColumnDefinition(new ColumnIdentifier("d",false));
  ColumnDefinition e=metadata.getColumnDefinition(new ColumnIdentifier("e",false));
  Row row;
  row=makeDummyRow(liveCell(a),liveCell(c),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(a),liveCell(c),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(e),liveCell(c),liveCell(a));
  row=makeDummyRow(liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(d,4),liveCell(d,3),liveCell(b,2),liveCell(b,1));
  row=makeDummyRow(liveCell(a),liveCell(c),liveCell(e),liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(a),liveCell(b,1),liveCell(b,2),liveCell(c),liveCell(d,3),liveCell(d,4),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(e),liveCell(d,4),liveCell(d,3),liveCell(c),liveCell(b,2),liveCell(b,1),liveCell(a));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.UnfilteredRowIteratorsMergeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateRangeCase(){
  testForInput("67<=[98] [98]<=67","66<=[11] [11]<71","66<[13] [13]<67");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTombstoneMergeReversed(){
  testTombstoneMerge(true,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTombstoneMergeReversedIterative(){
  testTombstoneMerge(true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTombstoneMerge(){
  testTombstoneMerge(false,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTombstoneMergeIterative(){
  testTombstoneMerge(false,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.BootStrapperTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllocateTokens() throws UnknownHostException {
  int vn=16;
  String ks="BootStrapperTestKeyspace3";
  TokenMetadata tm=new TokenMetadata();
  generateFakeEndpoints(tm,10,vn);
  InetAddress addr=FBUtilities.getBroadcastAddress();
  allocateTokensForNode(vn,ks,tm,addr);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSourceTargetComputation() throws UnknownHostException {
  final int[] clusterSizes=new int[]{1,3,5,10,100};
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    int replicationFactor=Keyspace.open(keyspaceName).getReplicationStrategy().getReplicationFactor();
    for (    int clusterSize : clusterSizes)     if (clusterSize >= replicationFactor)     testSourceTargetComputation(keyspaceName,clusterSize,replicationFactor);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllocateTokensMultipleKeyspaces() throws UnknownHostException {
  int vn=16;
  String ks3="BootStrapperTestKeyspace4";
  String ks2="BootStrapperTestKeyspace5";
  TokenMetadata tm=new TokenMetadata();
  generateFakeEndpoints(tm,10,vn);
  InetAddress dcaddr=FBUtilities.getBroadcastAddress();
  SummaryStatistics os3=TokenAllocation.replicatedOwnershipStats(tm,Keyspace.open(ks3).getReplicationStrategy(),dcaddr);
  SummaryStatistics os2=TokenAllocation.replicatedOwnershipStats(tm,Keyspace.open(ks2).getReplicationStrategy(),dcaddr);
  String cks=ks3;
  String nks=ks2;
  for (int i=11; i <= 20; ++i) {
    allocateTokensForNode(vn,cks,tm,InetAddress.getByName("127.0.0." + (i + 1)));
    String t=cks;
    cks=nks;
    nks=t;
  }
  SummaryStatistics ns3=TokenAllocation.replicatedOwnershipStats(tm,Keyspace.open(ks3).getReplicationStrategy(),dcaddr);
  SummaryStatistics ns2=TokenAllocation.replicatedOwnershipStats(tm,Keyspace.open(ks2).getReplicationStrategy(),dcaddr);
  verifyImprovement(os3,ns3);
  verifyImprovement(os2,ns2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.KeyCollisionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetSliceWithCollision() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.clearUnsafe();
  insert("k1","k2","kq");
  insert("key1","key2","key3");
  insert("longKey1","longKey2");
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("k2").toKeyIncl("key2").build());
  assert partitions.get(0).partitionKey().getKey().equals(ByteBufferUtil.bytes("k2"));
  assert partitions.get(1).partitionKey().getKey().equals(ByteBufferUtil.bytes("kq"));
  assert partitions.get(2).partitionKey().getKey().equals(ByteBufferUtil.bytes("key1"));
  assert partitions.get(3).partitionKey().getKey().equals(ByteBufferUtil.bytes("key2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.OrderPreservingPartitionerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompare(){
  assert tok("").compareTo(tok("asdf")) < 0;
  assert tok("asdf").compareTo(tok("")) > 0;
  assert tok("").compareTo(tok("")) == 0;
  assert tok("z").compareTo(tok("a")) > 0;
  assert tok("a").compareTo(tok("z")) < 0;
  assert tok("asdf").compareTo(tok("asdf")) == 0;
  assert tok("asdz").compareTo(tok("asdf")) > 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.PartitionerTestCase </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFactoryBytes(){
  Token.TokenFactory factory=partitioner.getTokenFactory();
  assert tok("a").compareTo(factory.fromByteArray(factory.toByteArray(tok("a")))) == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMidpointWrapping(){
  assertMidpoint(tok("b"),tok("a"),16);
  assertMidpoint(tok("bbb"),tok("a"),16);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMidpointMinimum(){
  midpointMinimumTestCase();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMidpoint(){
  assertMidpoint(tok("a"),tok("b"),16);
  assertMidpoint(tok("a"),tok("bbb"),16);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenFactoryStrings(){
  Token.TokenFactory factory=partitioner.getTokenFactory();
  assert tok("a").compareTo(factory.fromString(factory.toString(tok("a")))) == 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.RangeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsRangeWrapping(){
  Range<Token> one=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("2"));
  Range<Token> two=new Range<Token>(new BigIntegerToken("5"),new BigIntegerToken("3"));
  Range<Token> thr=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("12"));
  Range<Token> fou=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("6"));
  Range<Token> fiv=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("0"));
  assert !one.contains(two);
  assert one.contains(thr);
  assert !one.contains(fou);
  assert two.contains(one);
  assert two.contains(thr);
  assert !two.contains(fou);
  assert !thr.contains(one);
  assert !thr.contains(two);
  assert !thr.contains(fou);
  assert !fou.contains(one);
  assert !fou.contains(two);
  assert !fou.contains(thr);
  assert fiv.contains(one);
  assert fiv.contains(two);
  assert fiv.contains(thr);
  assert fiv.contains(fou);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSubtractAllWithWrapAround(){
  Range<Token> range=new Range<Token>(new Murmur3Partitioner.LongToken(100L),new Murmur3Partitioner.LongToken(10L));
  Collection<Range<Token>> collection=new HashSet<>();
  collection.add(makeRange(20L,30L));
  assertRanges(range.subtractAll(collection),100L,10L);
  collection.add(makeRange(200L,500L));
  assertRanges(range.subtractAll(collection),100L,200L,500L,10L);
  collection.add(makeRange(1L,10L));
  assertRanges(range.subtractAll(collection),100L,200L,500L,1L);
  collection.add(makeRange(0L,1L));
  assertRanges(range.subtractAll(collection),100L,200L,500L,0L);
  collection.add(makeRange(1000L,0));
  assertRanges(range.subtractAll(collection),100L,200L,500L,1000L);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDifferenceToFetchOldWraps(){
  Range<Token> oldRange=makeRange("1010","40");
  String[][] newTokens1={{"0","30"},{"0","40"},{"10","40"}};
  String[][] expected1={};
  checkDifference(oldRange,newTokens1,expected1);
  String[][] newTokens2={{"0","50"},{"10","50"},{"40","50"}};
  String[][] expected2={{"40","50"}};
  checkDifference(oldRange,newTokens2,expected2);
  String[][] newTokens3={{"50","90"}};
  String[][] expected3={{"50","90"}};
  checkDifference(oldRange,newTokens3,expected3);
  String[][] newTokens4={{"10","1010"},{"40","1010"},{"10","1030"},{"40","1030"}};
  String[][] expected4={{"40","1010"}};
  checkDifference(oldRange,newTokens4,expected4);
  String[][] newTokens5={{"60","1010"},{"60","1030"}};
  String[][] expected5={{"60","1010"}};
  checkDifference(oldRange,newTokens5,expected5);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoIntersection(){
  Range<Token> wraps1=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("10"));
  Range<Token> wraps2=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("0"));
  Range<Token> nowrap1=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("100"));
  Range<Token> nowrap2=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("200"));
  Range<Token> nowrap3=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("100"));
  assertNoIntersection(wraps1,nowrap3);
  assertNoIntersection(wraps2,nowrap1);
  assertNoIntersection(nowrap1,nowrap2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContains(){
  Range<Token> left=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("100"));
  assert !left.contains(new BigIntegerToken("0"));
  assert left.contains(new BigIntegerToken("10"));
  assert left.contains(new BigIntegerToken("100"));
  assert !left.contains(new BigIntegerToken("101"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDifferenceToFetchNoWrap(){
  Range<Token> oldRange=makeRange("10","40");
  String[][] newTokens1={{"20","30"},{"10","20"},{"10","40"},{"20","40"}};
  String[][] expected1={};
  checkDifference(oldRange,newTokens1,expected1);
  String[][] newTokens2={{"10","50"},{"20","50"},{"40","50"}};
  String[][] expected2={{"40","50"}};
  checkDifference(oldRange,newTokens2,expected2);
  String[][] newTokens3={{"0","10"},{"0","20"},{"0","40"}};
  String[][] expected3={{"0","10"}};
  checkDifference(oldRange,newTokens3,expected3);
  String[][] newTokens4={{"0","50"}};
  String[][] expected4={{"0","10"},{"40","50"}};
  checkDifference(oldRange,newTokens4,expected4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalizeUnwrap(){
  List<Range<PartitionPosition>> input, expected;
  input=asList(range("9","2"));
  expected=asList(range("","2"),range("9",""));
  assertNormalize(input,expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectionWithAll(){
  Range<Token> all0=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("0"));
  Range<Token> all10=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("10"));
  Range<Token> all100=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("100"));
  Range<Token> all1000=new Range<Token>(new BigIntegerToken("1000"),new BigIntegerToken("1000"));
  Range<Token> wraps=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("10"));
  assertIntersection(all0,wraps,wraps);
  assertIntersection(all10,wraps,wraps);
  assertIntersection(all100,wraps,wraps);
  assertIntersection(all1000,wraps,wraps);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDifferenceToFetchBothWrap(){
  Range<Token> oldRange=makeRange("1010","40");
  String[][] newTokens1={{"1020","30"},{"1010","20"},{"1010","40"},{"1020","40"}};
  String[][] expected1={};
  checkDifference(oldRange,newTokens1,expected1);
  String[][] newTokens2={{"1010","50"},{"1020","50"},{"1040","50"}};
  String[][] expected2={{"40","50"}};
  checkDifference(oldRange,newTokens2,expected2);
  String[][] newTokens3={{"1000","10"},{"1000","20"},{"1000","40"}};
  String[][] expected3={{"1000","1010"}};
  checkDifference(oldRange,newTokens3,expected3);
  String[][] newTokens4={{"1000","50"}};
  String[][] expected4={{"1000","1010"},{"40","50"}};
  checkDifference(oldRange,newTokens4,expected4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalizeComplex(){
  List<Range<PartitionPosition>> input, expected;
  input=asList(range("8","2"),range("7","9"),range("4","5"));
  expected=asList(range("","2"),range("4","5"),range("7",""));
  assertNormalize(input,expected);
  input=asList(range("5","9"),range("2","5"));
  expected=asList(range("2","9"));
  assertNormalize(input,expected);
  input=asList(range("","1"),range("9","2"),range("4","5"),range("",""));
  expected=asList(range("",""));
  assertNormalize(input,expected);
  input=asList(range("","1"),range("1","4"),range("4","5"),range("5",""));
  expected=asList(range("",""));
  assertNormalize(input,expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSubtractAll(){
  Range<Token> range=new Range<Token>(new Murmur3Partitioner.LongToken(1L),new Murmur3Partitioner.LongToken(100L));
  Collection<Range<Token>> collection=new HashSet<>();
  collection.add(makeRange(1L,10L));
  assertRanges(range.subtractAll(collection),10L,100L);
  collection.add(makeRange(90L,100L));
  assertRanges(range.subtractAll(collection),10L,90L);
  collection.add(makeRange(54L,60L));
  assertRanges(range.subtractAll(collection),10L,54L,60L,90L);
  collection.add(makeRange(80L,95L));
  assertRanges(range.subtractAll(collection),10L,54L,60L,80L);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testByteTokensCompare(){
  Token t1=new BytesToken(ByteBuffer.wrap(new byte[]{1,2,3}));
  Token t2=new BytesToken(ByteBuffer.wrap(new byte[]{1,2,3}));
  Token t3=new BytesToken(ByteBuffer.wrap(new byte[]{1,2,3,4}));
  assert t1.compareTo(t2) == 0;
  assert t1.compareTo(t3) < 0;
  assert t3.compareTo(t1) > 0;
  assert t1.compareTo(t1) == 0;
  Token t4=new BytesToken(new byte[]{1,2,3});
  Token t5=new BytesToken(new byte[]{4,5,6,7});
  assert t4.compareTo(t5) < 0;
  assert t5.compareTo(t4) > 0;
  assert t1.compareTo(t4) == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalizeSort(){
  List<Range<PartitionPosition>> input, expected;
  input=asList(range("4","5"),range("1","3"));
  expected=asList(range("1","3"),range("4","5"));
  assertNormalize(input,expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsWrapping(){
  Range<Token> range=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("0"));
  assert range.contains(new BigIntegerToken("0"));
  assert range.contains(new BigIntegerToken("10"));
  assert range.contains(new BigIntegerToken("100"));
  assert range.contains(new BigIntegerToken("101"));
  range=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("0"));
  assert range.contains(new BigIntegerToken("0"));
  assert !range.contains(new BigIntegerToken("1"));
  assert !range.contains(new BigIntegerToken("100"));
  assert range.contains(new BigIntegerToken("200"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDifferenceToFetchNewWraps(){
  Range<Token> oldRange=makeRange("0","40");
  String[][] newTokens1={{"1010","0"},{"1010","10"},{"1010","40"}};
  String[][] expected1={{"1010","0"}};
  checkDifference(oldRange,newTokens1,expected1);
  String[][] newTokens2={{"1010","50"}};
  String[][] expected2={{"1010","0"},{"40","50"}};
  checkDifference(oldRange,newTokens2,expected2);
  oldRange=makeRange("20","40");
  String[][] newTokens3={{"1010","0"}};
  String[][] expected3={{"1010","0"}};
  checkDifference(oldRange,newTokens3,expected3);
  String[][] newTokens4={{"1010","20"}};
  String[][] expected4={{"1010","20"}};
  checkDifference(oldRange,newTokens4,expected4);
  String[][] newTokens5={{"30","0"},{"40","0"}};
  String[][] expected5={{"40","0"}};
  checkDifference(oldRange,newTokens5,expected5);
  String[][] newTokens6={{"30","20"},{"40","20"}};
  String[][] expected6={{"40","20"}};
  checkDifference(oldRange,newTokens6,expected6);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectsWrapping(){
  Range<Token> onewrap=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("2"));
  Range<Token> onecomplement=new Range<Token>(onewrap.right,onewrap.left);
  Range<Token> onestartswith=new Range<Token>(onewrap.left,new BigIntegerToken("12"));
  Range<Token> oneendswith=new Range<Token>(new BigIntegerToken("1"),onewrap.right);
  Range<Token> twowrap=new Range<Token>(new BigIntegerToken("5"),new BigIntegerToken("3"));
  Range<Token> not=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("6"));
  assert !onewrap.intersects(onecomplement);
  assert onewrap.intersects(onestartswith);
  assert onewrap.intersects(oneendswith);
  assert onewrap.intersects(twowrap);
  assert twowrap.intersects(onewrap);
  assert !onewrap.intersects(not);
  assert !not.intersects(onewrap);
  assert twowrap.intersects(not);
  assert not.intersects(twowrap);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersects(){
  Range<Token> all=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("0"));
  Range<Token> one=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("10"));
  Range<Token> two=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("8"));
  Range<Token> not=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("12"));
  assert all.intersects(one);
  assert all.intersects(two);
  assert one.intersects(two);
  assert two.intersects(one);
  assert !one.intersects(not);
  assert !not.intersects(one);
  assert !two.intersects(not);
  assert !not.intersects(two);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsRange(){
  Range<Token> one=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("10"));
  Range<Token> two=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("5"));
  Range<Token> thr=new Range<Token>(new BigIntegerToken("5"),new BigIntegerToken("10"));
  Range<Token> fou=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("12"));
  assert one.contains(two);
  assert one.contains(thr);
  assert !one.contains(fou);
  assert !two.contains(one);
  assert !two.contains(thr);
  assert !two.contains(fou);
  assert !thr.contains(one);
  assert !thr.contains(two);
  assert !thr.contains(fou);
  assert !fou.contains(one);
  assert !fou.contains(two);
  assert !fou.contains(thr);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectionTwoWraps(){
  Range<Token> wraps1=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("20"));
  Range<Token> wraps2=new Range<Token>(new BigIntegerToken("120"),new BigIntegerToken("90"));
  Range<Token> wraps3=new Range<Token>(new BigIntegerToken("120"),new BigIntegerToken("110"));
  Range<Token> wraps4=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("0"));
  Range<Token> wraps5=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("1"));
  Range<Token> wraps6=new Range<Token>(new BigIntegerToken("30"),new BigIntegerToken("10"));
  assertIntersection(wraps1,wraps2,new Range<Token>(new BigIntegerToken("120"),new BigIntegerToken("20")));
  assertIntersection(wraps1,wraps3,new Range<Token>(new BigIntegerToken("120"),new BigIntegerToken("20")),new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("110")));
  assertIntersection(wraps1,wraps4,new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("20")),new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("0")));
  assertIntersection(wraps1,wraps5,new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("20")),new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("1")));
  assertIntersection(wraps1,wraps6,new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("10")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectionOneWraps(){
  Range<Token> wraps1=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("10"));
  Range<Token> wraps2=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("0"));
  Range<Token> nowrap1=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("200"));
  Range<Token> nowrap2=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("100"));
  assertIntersection(wraps1,nowrap1,new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("10")),new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("200")));
  assertIntersection(wraps2,nowrap1,new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("200")));
  assertIntersection(wraps1,nowrap2,new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("10")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testContainsRangeOneWrapping(){
  Range<Token> wrap1=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("0"));
  Range<Token> wrap2=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("2"));
  Range<Token> nowrap1=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("2"));
  Range<Token> nowrap2=new Range<Token>(new BigIntegerToken("2"),new BigIntegerToken("10"));
  Range<Token> nowrap3=new Range<Token>(new BigIntegerToken("10"),new BigIntegerToken("100"));
  assert wrap1.contains(nowrap1);
  assert wrap1.contains(nowrap2);
  assert wrap1.contains(nowrap3);
  assert wrap2.contains(nowrap1);
  assert !wrap2.contains(nowrap2);
  assert wrap2.contains(nowrap3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectionContains(){
  Range<Token> wraps1=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("10"));
  Range<Token> wraps2=new Range<Token>(new BigIntegerToken("90"),new BigIntegerToken("20"));
  Range<Token> wraps3=new Range<Token>(new BigIntegerToken("90"),new BigIntegerToken("0"));
  Range<Token> nowrap1=new Range<Token>(new BigIntegerToken("100"),new BigIntegerToken("110"));
  Range<Token> nowrap2=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("10"));
  Range<Token> nowrap3=new Range<Token>(new BigIntegerToken("0"),new BigIntegerToken("9"));
  assertIntersection(wraps1,wraps2,wraps1);
  assertIntersection(wraps3,wraps2,wraps3);
  assertIntersection(wraps1,nowrap1,nowrap1);
  assertIntersection(wraps1,nowrap2,nowrap2);
  assertIntersection(nowrap2,nowrap3,nowrap3);
  assertIntersection(wraps1,wraps1,wraps1);
  assertIntersection(nowrap1,nowrap1,nowrap1);
  assertIntersection(nowrap2,nowrap2,nowrap2);
  assertIntersection(wraps3,wraps3,wraps3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalizeSimpleOverlap(){
  List<Range<PartitionPosition>> input, expected;
  input=asList(range("1","4"),range("3","5"));
  expected=asList(range("1","5"));
  assertNormalize(input,expected);
  input=asList(range("1","4"),range("1","4"));
  expected=asList(range("1","4"));
  assertNormalize(input,expected);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNormalizeNoop(){
  List<Range<PartitionPosition>> l;
  l=asList(range("1","3"),range("4","5"));
  assertNormalize(l,l);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.SplitterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void randomSplitTestNoVNodesMurmur3Partitioner(){
  randomSplitTestNoVNodes(new Murmur3Partitioner());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void randomSplitTestNoVNodesRandomPartitioner(){
  randomSplitTestNoVNodes(new RandomPartitioner());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void randomSplitTestVNodesRandomPartitioner(){
  randomSplitTestVNodes(new RandomPartitioner());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void randomSplitTestVNodesMurmur3Partitioner(){
  randomSplitTestVNodes(new Murmur3Partitioner());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.tokenallocator.ReplicationAwareTokenAllocatorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExistingCluster(){
  for (int rf=1; rf <= 5; ++rf) {
    for (int perUnitCount=1; perUnitCount <= MAX_VNODE_COUNT; perUnitCount*=4) {
      testExistingCluster(perUnitCount,fixedTokenCount,new SimpleReplicationStrategy(rf));
      testExistingCluster(perUnitCount,varyingTokenCount,new SimpleReplicationStrategy(rf));
      if (rf == 1)       continue;
      for (int groupSize=4; groupSize <= 64 && groupSize * rf * 4 < TARGET_CLUSTER_SIZE; groupSize*=4) {
        testExistingCluster(perUnitCount,fixedTokenCount,new BalancedGroupReplicationStrategy(rf,groupSize));
        testExistingCluster(perUnitCount,varyingTokenCount,new UnbalancedGroupReplicationStrategy(rf,groupSize / 2,groupSize * 2,seededRand));
      }
      testExistingCluster(perUnitCount,fixedTokenCount,new FixedGroupCountReplicationStrategy(rf,rf * 2));
    }
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNewCluster(){
  for (int rf=2; rf <= 5; ++rf) {
    for (int perUnitCount=1; perUnitCount <= MAX_VNODE_COUNT; perUnitCount*=4) {
      testNewCluster(perUnitCount,fixedTokenCount,new SimpleReplicationStrategy(rf));
      testNewCluster(perUnitCount,varyingTokenCount,new SimpleReplicationStrategy(rf));
      if (rf == 1)       continue;
      for (int groupSize=4; groupSize <= 64 && groupSize * rf * 8 < TARGET_CLUSTER_SIZE; groupSize*=4) {
        testNewCluster(perUnitCount,fixedTokenCount,new BalancedGroupReplicationStrategy(rf,groupSize));
        testNewCluster(perUnitCount,varyingTokenCount,new UnbalancedGroupReplicationStrategy(rf,groupSize / 2,groupSize * 2,seededRand));
      }
      testNewCluster(perUnitCount,fixedTokenCount,new FixedGroupCountReplicationStrategy(rf,rf * 2));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.gms.ArrayBackedBoundedStatsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleRounds() throws Exception {
  int size=5;
  ArrayBackedBoundedStats bsd=new ArrayBackedBoundedStats(size);
  for (long i=0; i <= 1000; i++) {
    bsd.add(i);
  }
  long[] expected=new long[]{1000,999,998,997,996};
  assertArrivalIntervals(bsd,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.gms.EndpointStateTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiThreadWriteConsistency() throws InterruptedException {
  for (int i=0; i < 500; i++)   innerTestMultiThreadWriteConsistency();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiThreadedReadConsistency() throws InterruptedException {
  for (int i=0; i < 500; i++)   innerTestMultiThreadedReadConsistency();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.gms.SerializationsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEndpointStateRead() throws IOException {
  if (EXECUTE_WRITES)   testEndpointStateWrite();
  DataInputStreamPlus in=getInput("gms.EndpointState.bin");
  assert HeartBeatState.serializer.deserialize(in,getVersion()) != null;
  assert EndpointState.serializer.deserialize(in,getVersion()) != null;
  assert VersionedValue.serializer.deserialize(in,getVersion()) != null;
  assert VersionedValue.serializer.deserialize(in,getVersion()) != null;
  in.close();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGossipDigestRead() throws IOException {
  if (EXECUTE_WRITES)   testGossipDigestWrite();
  int count=0;
  DataInputStreamPlus in=getInput("gms.Gossip.bin");
  while (count < Statics.Digests.size())   assert GossipDigestAck2.serializer.deserialize(in,getVersion()) != null;
  assert GossipDigestAck.serializer.deserialize(in,getVersion()) != null;
  assert GossipDigestAck2.serializer.deserialize(in,getVersion()) != null;
  assert GossipDigestSyn.serializer.deserialize(in,getVersion()) != null;
  in.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hadoop.ColumnFamilyInputFormatTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSlicePredicate(){
  long columnValue=1271253600000l;
  ByteBuffer columnBytes=ByteBufferUtil.bytes(columnValue);
  List<ByteBuffer> columnNames=new ArrayList<ByteBuffer>();
  columnNames.add(columnBytes);
  SlicePredicate originalPredicate=new SlicePredicate().setColumn_names(columnNames);
  Configuration conf=new Configuration();
  ConfigHelper.setInputSlicePredicate(conf,originalPredicate);
  SlicePredicate rtPredicate=ConfigHelper.getInputSlicePredicate(conf);
  assert rtPredicate.column_names.size() == 1;
  assert originalPredicate.column_names.get(0).equals(rtPredicate.column_names.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testApply(){
  long now=FBUtilities.timestampMicros();
  String key="testApply";
  Mutation mutation=createMutation(key,now);
  Hint hint=Hint.create(mutation,now / 1000);
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
  hint.apply();
  for (  PartitionUpdate partition : mutation.getPartitionUpdates())   assertPartitionsEqual(partition,readPartition(key,partition.metadata().cfName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testApplyWithTruncation(){
  long now=FBUtilities.timestampMicros();
  String key="testApplyWithTruncation";
  Mutation mutation=createMutation(key,now);
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
  Keyspace.open(KEYSPACE).getColumnFamilyStore(TABLE1).truncateBlocking();
  Hint.create(mutation,now / 1000 - 1).apply();
  assertNoPartitions(key,TABLE1);
  assertPartitionsEqual(mutation.getPartitionUpdate(Schema.instance.getId(KEYSPACE,TABLE0)),readPartition(key,TABLE0));
  assertPartitionsEqual(mutation.getPartitionUpdate(Schema.instance.getId(KEYSPACE,TABLE2)),readPartition(key,TABLE2));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testApplyWithGCGSReducedLater(){
  long now=FBUtilities.timestampMicros();
  String key="testApplyWithGCGSReducedLater";
  Mutation mutation=createMutation(key,now);
  Hint hint=Hint.create(mutation,now / 1000);
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
  Schema.instance.getCFMetaData(KEYSPACE,TABLE0).gcGraceSeconds(0);
  hint.apply();
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testApplyWithRegularExpiration(){
  long now=FBUtilities.timestampMicros();
  String key="testApplyWithRegularExpiration";
  Mutation mutation=createMutation(key,now);
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
  Schema.instance.getCFMetaData(KEYSPACE,TABLE0).gcGraceSeconds(0);
  Hint.create(mutation,now / 1000).apply();
  assertNoPartitions(key,TABLE0);
  assertNoPartitions(key,TABLE1);
  assertNoPartitions(key,TABLE2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsCatalogTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void loadCompletenessAndOrderTest() throws IOException {
  File directory=Files.createTempDirectory(null).toFile();
  try {
    loadCompletenessAndOrderTest(directory);
  }
  finally {
    directory.deleteOnExit();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsCompressionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void deflateCompressor() throws Exception {
  multiFlushAndDeserializeTest(DeflateCompressor.class);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void snappyCompressor() throws Exception {
  multiFlushAndDeserializeTest(SnappyCompressor.class);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void lz4Compressor() throws Exception {
  multiFlushAndDeserializeTest(LZ4Compressor.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsDescriptorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializerWithEmptyParameters() throws IOException {
  UUID hostId=UUID.randomUUID();
  int version=HintsDescriptor.CURRENT_VERSION;
  long timestamp=System.currentTimeMillis();
  ImmutableMap<String,Object> parameters=ImmutableMap.of();
  HintsDescriptor descriptor=new HintsDescriptor(hostId,version,timestamp,parameters);
  testSerializeDeserializeLoop(descriptor);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializerNormal() throws IOException {
  UUID hostId=UUID.randomUUID();
  int version=HintsDescriptor.CURRENT_VERSION;
  long timestamp=System.currentTimeMillis();
  ImmutableMap<String,Object> parameters=ImmutableMap.of("compression",(Object)ImmutableMap.of("class_name",LZ4Compressor.class.getName()));
  HintsDescriptor descriptor=new HintsDescriptor(hostId,version,timestamp,parameters);
  testSerializeDeserializeLoop(descriptor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsWriteThenReadTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWriteReadCycle() throws IOException {
  SchemaLoader.prepareServer();
  SchemaLoader.createKeyspace(KEYSPACE,KeyspaceParams.simple(1),SchemaLoader.standardCFMD(KEYSPACE,TABLE));
  HintsDescriptor descriptor=new HintsDescriptor(UUID.randomUUID(),System.currentTimeMillis());
  File directory=Files.createTempDirectory(null).toFile();
  try {
    testWriteReadCycle(directory,descriptor);
  }
  finally {
    directory.deleteOnExit();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.LegacyHintsMigratorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMigrationIsComplete() throws IOException {
  File directory=Files.createTempDirectory(null).toFile();
  try {
    testMigrationIsComplete(directory);
  }
  finally {
    directory.deleteOnExit();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNothingToMigrate() throws IOException {
  File directory=Files.createTempDirectory(null).toFile();
  try {
    testNothingToMigrate(directory);
  }
  finally {
    directory.deleteOnExit();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.CustomIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void customExpressionsMustTargetCustomIndex() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX non_custom_index ON %s(c)");
  assertInvalidMessage(String.format(IndexRestrictions.NON_CUSTOM_INDEX_IN_EXPRESSION,"non_custom_index"),"SELECT * FROM %s WHERE expr(non_custom_index, 'c=0')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void requireFullQualifierForFrozenCollectionTargets() throws Throwable {
  createTable("CREATE TABLE %s(" + " k int," + " c int,"+ " fmap frozen<map<int, text>>,"+ " flist frozen<list<int>>,"+ " fset frozen<set<int>>,"+ " PRIMARY KEY(k,c))");
  assertInvalidMessage("Cannot create keys() index on frozen column fmap. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, keys(fmap)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create entries() index on frozen column fmap. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, entries(fmap)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create values() index on frozen column fmap. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, fmap) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create keys() index on frozen column flist. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, keys(flist)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create entries() index on frozen column flist. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, entries(flist)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create values() index on frozen column flist. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, flist) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create keys() index on frozen column fset. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, keys(fset)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create entries() index on frozen column fset. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, entries(fset)) USING'%s'",StubIndex.class.getName()));
  assertInvalidMessage("Cannot create values() index on frozen column fset. " + "Frozen collections only support full() indexes",String.format("CREATE CUSTOM INDEX ON %%s(c, fset) USING'%s'",StubIndex.class.getName()));
  createIndex(String.format("CREATE CUSTOM INDEX ON %%s(c, full(fmap)) USING'%s'",StubIndex.class.getName()));
  createIndex(String.format("CREATE CUSTOM INDEX ON %%s(c, full(flist)) USING'%s'",StubIndex.class.getName()));
  createIndex(String.format("CREATE CUSTOM INDEX ON %%s(c, full(fset)) USING'%s'",StubIndex.class.getName()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCustomIndexExpressionSyntax() throws Throwable {
  Object[] row=row(0,0,0,0);
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",row);
  assertInvalidMessage(String.format(IndexRestrictions.INDEX_NOT_FOUND,"custom_index",keyspace(),currentTable()),"SELECT * FROM %s WHERE expr(custom_index, 'foo bar baz')");
  createIndex(String.format("CREATE CUSTOM INDEX custom_index ON %%s(c) USING '%s'",StubIndex.class.getName()));
  assertInvalidMessage(String.format(IndexRestrictions.INDEX_NOT_FOUND,"no_such_index",keyspace(),currentTable()),"SELECT * FROM %s WHERE expr(no_such_index, 'foo bar baz ')");
  assertRows(execute("SELECT * FROM %s WHERE expr(custom_index, 'foo bar baz')"),row);
  assertRows(execute("SELECT * FROM %s WHERE expr(\"custom_index\", 'foo bar baz')"),row);
  assertRows(execute("SELECT * FROM %s WHERE expr(custom_index, $$foo \" ~~~ bar Baz$$)"),row);
  assertInvalidMessage(IndexRestrictions.MULTIPLE_EXPRESSIONS,"SELECT * FROM %s WHERE expr(custom_index, 'foo') AND expr(custom_index, 'bar')");
  createIndex(String.format("CREATE CUSTOM INDEX other_custom_index ON %%s(d) USING '%s'",StubIndex.class.getName()));
  assertInvalidMessage(IndexRestrictions.MULTIPLE_EXPRESSIONS,"SELECT * FROM %s WHERE expr(custom_index, 'foo') AND expr(other_custom_index, 'bar')");
  assertInvalidMessage(SelectStatement.REQUIRES_ALLOW_FILTERING_MESSAGE,"SELECT * FROM %s WHERE expr(custom_index, 'foo') AND d=0");
  assertRows(execute("SELECT * FROM %s WHERE expr(custom_index, 'foo') AND d=0 ALLOW FILTERING"),row);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCustomExpressionValueType() throws Throwable {
  createTable("CREATE TABLE %s (k int, v1 uuid, v2 blob, PRIMARY KEY(k))");
  createIndex(String.format("CREATE CUSTOM INDEX int_index ON %%s() USING '%s'",Int32ExpressionIndex.class.getName()));
  createIndex(String.format("CREATE CUSTOM INDEX text_index ON %%s() USING '%s'",UTF8ExpressionIndex.class.getName()));
  execute("SELECT * FROM %s WHERE expr(text_index, 'foo')");
  assertInvalidMessage("Invalid INTEGER constant (99) for \"custom index expression\" of type text","SELECT * FROM %s WHERE expr(text_index, 99)");
  execute("SELECT * FROM %s WHERE expr(int_index, 99)");
  assertInvalidMessage("Invalid STRING constant (foo) for \"custom index expression\" of type int","SELECT * FROM %s WHERE expr(int_index, 'foo')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nonCustomIndexesRequireExactlyOneTargetColumn() throws Throwable {
  createTable("CREATE TABLE %s(k int, c int, v1 int, v2 int, PRIMARY KEY (k,c))");
  assertInvalidMessage("Only CUSTOM indexes support multiple columns","CREATE INDEX multi_idx on %s(v1,v2)");
  assertInvalidMessage("Only CUSTOM indexes can be created without specifying a target column","CREATE INDEX no_targets on %s()");
  createIndex(String.format("CREATE CUSTOM INDEX multi_idx ON %%s(v1, v2) USING '%s'",StubIndex.class.getName()));
  assertIndexCreated("multi_idx","v1","v2");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void customExpressionsDisallowedInModifications() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  createIndex(String.format("CREATE CUSTOM INDEX custom_index ON %%s(c) USING '%s'",StubIndex.class.getName()));
  assertInvalidMessage(ModificationStatement.CUSTOM_EXPRESSIONS_NOT_ALLOWED,"DELETE FROM %s WHERE expr(custom_index, 'foo bar baz ')");
  assertInvalidMessage(ModificationStatement.CUSTOM_EXPRESSIONS_NOT_ALLOWED,"UPDATE %s SET d=0 WHERE expr(custom_index, 'foo bar baz ')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void customIndexRejectsExpressionSyntax() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  createIndex(String.format("CREATE CUSTOM INDEX custom_index ON %%s(c) USING '%s'",ExpressionRejectingIndex.class.getName()));
  assertInvalidMessage("None shall pass","SELECT * FROM %s WHERE expr(custom_index, 'foo bar baz')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void customIndexDoesntSupportCustomExpressions() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  createIndex(String.format("CREATE CUSTOM INDEX custom_index ON %%s(c) USING '%s'",NoCustomExpressionsIndex.class.getName()));
  assertInvalidMessage(String.format(IndexRestrictions.CUSTOM_EXPRESSION_NOT_SUPPORTED,"custom_index"),"SELECT * FROM %s WHERE expr(custom_index, 'foo bar baz')");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInsertsOnCfsBackedIndex() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b))");
  createIndex("CREATE CUSTOM INDEX myindex ON %s(c) USING 'org.apache.cassandra.index.internal.CustomCassandraIndex'");
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,2);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,0,1);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,2,0,0);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void createMultiColumnIndexes() throws Throwable {
  createTable("CREATE TABLE %s (" + " pk1 int," + " pk2 int,"+ " c1 int,"+ " c2 int,"+ " v1 int,"+ " v2 int,"+ " mval map<text, int>,"+ " lval list<int>,"+ " sval set<int>,"+ " fmap frozen<map<text,int>>,"+ " flist frozen<list<int>>,"+ " fset frozen<set<int>>,"+ " PRIMARY KEY ((pk1, pk2), c1, c2))");
  testCreateIndex("idx_1","pk1","pk2");
  testCreateIndex("idx_2","pk1","c1");
  testCreateIndex("idx_3","pk1","c2");
  testCreateIndex("idx_4","c1","c2");
  testCreateIndex("idx_5","c2","v1");
  testCreateIndex("idx_6","v1","v2");
  testCreateIndex("idx_7","pk2","c2","v2");
  testCreateIndex("idx_8","pk1","c1","v1","mval","sval","lval");
  createIndex(String.format("CREATE CUSTOM INDEX inc_frozen ON %%s(" + "  pk2, c2, v2, full(fmap), full(fset), full(flist)" + ") USING '%s'",StubIndex.class.getName()));
  assertIndexCreated("inc_frozen",new HashMap<>(),ImmutableList.of(indexTarget("pk2",IndexTarget.Type.VALUES),indexTarget("c2",IndexTarget.Type.VALUES),indexTarget("v2",IndexTarget.Type.VALUES),indexTarget("fmap",IndexTarget.Type.FULL),indexTarget("fset",IndexTarget.Type.FULL),indexTarget("flist",IndexTarget.Type.FULL)));
  createIndex(String.format("CREATE CUSTOM INDEX all_teh_things ON %%s(" + "  pk1, pk2, c1, c2, v1, v2, keys(mval), lval, sval, full(fmap), full(fset), full(flist)" + ") USING '%s'",StubIndex.class.getName()));
  assertIndexCreated("all_teh_things",new HashMap<>(),ImmutableList.of(indexTarget("pk1",IndexTarget.Type.VALUES),indexTarget("pk2",IndexTarget.Type.VALUES),indexTarget("c1",IndexTarget.Type.VALUES),indexTarget("c2",IndexTarget.Type.VALUES),indexTarget("v1",IndexTarget.Type.VALUES),indexTarget("v2",IndexTarget.Type.VALUES),indexTarget("mval",IndexTarget.Type.KEYS),indexTarget("lval",IndexTarget.Type.VALUES),indexTarget("sval",IndexTarget.Type.VALUES),indexTarget("fmap",IndexTarget.Type.FULL),indexTarget("fset",IndexTarget.Type.FULL),indexTarget("flist",IndexTarget.Type.FULL)));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rejectDuplicateColumnsInTargetList() throws Throwable {
  createTable("CREATE TABLE %s(k int, c int, v1 int, v2 int, PRIMARY KEY (k,c))");
  assertInvalidMessage("Duplicate column v1 in index target list",String.format("CREATE CUSTOM INDEX ON %%s(v1, v1) USING '%s'",StubIndex.class.getName()));
  assertInvalidMessage("Duplicate column v1 in index target list",String.format("CREATE CUSTOM INDEX ON %%s(v1, v1, c, c) USING '%s'",StubIndex.class.getName()));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void createIndexWithoutTargets() throws Throwable {
  createTable("CREATE TABLE %s(k int, c int, v1 int, v2 int, PRIMARY KEY(k,c))");
  assertInvalidMessage("Only CUSTOM indexes can be created without specifying a target column","CREATE INDEX ON %s()");
  assertInvalidSyntax("CREATE CUSTOM INDEX ON %%s USING '%s'",StubIndex.class.getName());
  createIndex(String.format("CREATE CUSTOM INDEX no_targets ON %%s() USING '%s'",StubIndex.class.getName()));
  assertIndexCreated("no_targets",new HashMap<>());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.internal.CassandraIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnRegularColumn() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c));").target("v").indexName("v_index").withFirstRow(row(0,0,0)).withSecondRow(row(1,1,1)).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("v=0").secondQueryExpression("v=1").updateExpression("SET v=2").postUpdateQueryExpression("v=2").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenListWithInPlaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, l list<int>, PRIMARY KEY (k, c));").target("l").indexName("l_index2").withFirstRow(row(0,0,Lists.newArrayList(10,20,30))).withSecondRow(row(1,1,Lists.newArrayList(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("l CONTAINS 10").secondQueryExpression("l CONTAINS 11").updateExpression("SET l = l - [10]").postUpdateQueryExpression("l CONTAINS 20").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void updateTTLOnIndexedClusteringValue() throws Throwable {
  int basePk=1;
  int indexedVal=2;
  int initialTtl=3600;
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY(k,c))");
  createIndex("CREATE INDEX c_index on %s(c)");
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, 0) USING TTL ?",basePk,indexedVal,initialTtl);
  ColumnFamilyStore baseCfs=getCurrentColumnFamilyStore();
  ColumnFamilyStore indexCfs=baseCfs.indexManager.listIndexes().iterator().next().getBackingTable().orElseThrow(throwAssert("No index found"));
  assertIndexRowTtl(indexCfs,indexedVal,initialTtl);
  int updatedTtl=9999;
  execute("INSERT INTO %s (k, c ,v) VALUES (?, ?, 0) USING TTL ?",basePk,indexedVal,updatedTtl);
  assertIndexRowTtl(indexCfs,indexedVal,updatedTtl);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnSecondPartitionKeyColumn() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k1 int, k2 int, c1 int, c2 int, v int, PRIMARY KEY ((k1, k2), c1, c2));").target("k2").indexName("k2_index").withFirstRow(row(0,0,0,0,0)).withSecondRow(row(1,1,1,1,1)).missingIndexMessage("Partition key parts: k1 must be restricted as other parts are").firstQueryExpression("k2=0").secondQueryExpression("k2=1").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnFrozenMap() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m frozen<map<text,int>>, PRIMARY KEY (k, c));").target("full(m)").indexName("fm_index").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m = {'a':10, 'b':20, 'c':30}").secondQueryExpression("m = {'d':11, 'e':21, 'f':31}").updateExpression("SET m = {'x':40, 'y':50, 'z':60}").postUpdateQueryExpression("m = {'x':40, 'y':50, 'z':60}").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapValuesWithInPlaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("m").indexName("m_index2").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m CONTAINS 10").secondQueryExpression("m CONTAINS 11").updateExpression("SET m['a'] = 40").postUpdateQueryExpression("m CONTAINS 40").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapEntriesWithInPlaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("entries(m)").indexName("m_index6").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m['a'] = 10").secondQueryExpression("m['d'] = 11").updateExpression("SET m['a'] = 40").postUpdateQueryExpression("m['a'] = 40").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenListWithReplaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, l list<int>, PRIMARY KEY (k, c));").target("l").indexName("l_index1").withFirstRow(row(0,0,Lists.newArrayList(10,20,30))).withSecondRow(row(1,1,Lists.newArrayList(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("l CONTAINS 10").secondQueryExpression("l CONTAINS 11").updateExpression("SET l = [40, 50, 60]").postUpdateQueryExpression("l CONTAINS 40").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenSetWithReplaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, s set<int>, PRIMARY KEY (k, c));").target("s").indexName("s_index1").withFirstRow(row(0,0,Sets.newHashSet(10,20,30))).withSecondRow(row(1,1,Sets.newHashSet(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("s CONTAINS 10").secondQueryExpression("s CONTAINS 11").updateExpression("SET s = {40, 50, 60}").postUpdateQueryExpression("s CONTAINS 40").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapKeysWithInPlaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("keys(m)").indexName("m_index4").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m CONTAINS KEY 'a'").secondQueryExpression("m CONTAINS KEY 'd'").updateExpression("SET m['a'] = NULL").postUpdateQueryExpression("m CONTAINS KEY 'b'").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void insertWithTombstoneRemovesEntryFromIndex() throws Throwable {
  int key=0;
  int indexedValue=99;
  createTable("CREATE TABLE %s (k int, v int, PRIMARY KEY(k))");
  createIndex("CREATE INDEX v_index on %s(v)");
  execute("INSERT INTO %s (k, v) VALUES (?, ?)",key,indexedValue);
  assertRows(execute("SELECT * FROM %s WHERE v = ?",indexedValue),row(key,indexedValue));
  execute("DELETE v FROM %s WHERE k=?",key);
  assertEmpty(execute("SELECT * FROM %s WHERE v = ?",indexedValue));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexCorrectlyMarkedAsBuildAndRemoved() throws Throwable {
  String indexName="build_remove_test_idx";
  String tableName=createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  createIndex(String.format("CREATE INDEX %s ON %%s(c)",indexName));
  waitForIndex(KEYSPACE,tableName,indexName);
  assertRows(execute(String.format("SELECT * FROM %s.\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BUILT_INDEXES)),row(KEYSPACE,indexName));
  getCurrentColumnFamilyStore().rebuildSecondaryIndex(indexName);
  waitForIndex(KEYSPACE,tableName,indexName);
  assertRows(execute(String.format("SELECT * FROM %s.\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BUILT_INDEXES)),row(KEYSPACE,indexName));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexStatementsWithConditions() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX ON %s(c)");
  execute("INSERT INTO %s (a, b, c) VALUES (0, 0, 0) IF NOT EXISTS");
  assertRows(execute("SELECT * FROM %s WHERE c = 0"),row(0,0,0));
  execute("INSERT INTO %s (a, b, c) VALUES (0, 0, 1) IF NOT EXISTS");
  assertEmpty(execute("SELECT * FROM %s WHERE c = 1"));
  execute("UPDATE %s SET c = 1 WHERE a = 0 AND b =0 IF c = 0");
  assertRows(execute("SELECT * FROM %s WHERE c = 1"),row(0,0,1));
  assertEmpty(execute("SELECT * FROM %s WHERE c = 0"));
  execute("DELETE FROM %s WHERE a = 0 AND b = 0 IF c = 0");
  assertRows(execute("SELECT * FROM %s WHERE c = 1"),row(0,0,1));
  execute("DELETE FROM %s WHERE a = 0 AND b = 0 IF c = 1");
  assertEmpty(execute("SELECT * FROM %s WHERE c = 1"));
  execute("BEGIN BATCH\n" + "INSERT INTO %1$s (a, b, c) VALUES (2, 2, 2) IF NOT EXISTS;\n" + "INSERT INTO %1$s (a, b, c) VALUES (2, 3, 3)\n"+ "APPLY BATCH");
  assertRows(execute("SELECT * FROM %s WHERE c = 2"),row(2,2,2));
  assertRows(execute("SELECT * FROM %s WHERE c = 3"),row(2,3,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnFirstPartitionKeyColumn() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k1 int, k2 int, c1 int, c2 int, v int, PRIMARY KEY ((k1, k2), c1, c2));").target("k1").indexName("k1_index").withFirstRow(row(0,0,0,0,0)).withSecondRow(row(1,1,1,1,1)).missingIndexMessage("Partition key parts: k2 must be restricted as other parts are").firstQueryExpression("k1=0").secondQueryExpression("k1=1").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnSecondClusteringColumn() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c1 int, c2 int, v int, PRIMARY KEY (k, c1, c2));").target("c2").indexName("c2_index").withFirstRow(row(0,0,0,0)).withSecondRow(row(1,1,1,1)).missingIndexMessage(String.format("PRIMARY KEY column \"%s\" cannot be restricted " + "as preceding column \"%s\" is not restricted","c2","c1")).firstQueryExpression("c2=0").secondQueryExpression("c2=1").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenSetWithInPlaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, s set<int>, PRIMARY KEY (k, c));").target("s").indexName("s_index2").withFirstRow(row(0,0,Sets.newHashSet(10,20,30))).withSecondRow(row(1,1,Sets.newHashSet(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("s CONTAINS 10").secondQueryExpression("s CONTAINS 11").updateExpression("SET s = s - {10}").postUpdateQueryExpression("s CONTAINS 20").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapKeysWithReplaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("keys(m)").indexName("m_index3").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m CONTAINS KEY 'a'").secondQueryExpression("m CONTAINS KEY 'd'").updateExpression("SET m = {'x':40, 'y':50, 'z':60}").postUpdateQueryExpression("m CONTAINS KEY 'x'").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexBatchStatements() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  createIndex("CREATE INDEX ON %s(c)");
  execute("BEGIN BATCH\n" + "UPDATE %1$s SET c = 0 WHERE a = 0 AND b = 0;\n" + "UPDATE %1$s SET c = 1 WHERE a = 1 AND b = 1;\n"+ "APPLY BATCH");
  assertRows(execute("SELECT * FROM %s WHERE c = 0"),row(0,0,0));
  assertRows(execute("SELECT * FROM %s WHERE c = 1"),row(1,1,1));
  execute("BEGIN BATCH\n" + "UPDATE %1$s SET c = 2 WHERE a = 2 AND b = 0;\n" + "UPDATE %1$s SET c = 3 WHERE a = 2 AND b = 1;\n"+ "APPLY BATCH");
  assertRows(execute("SELECT * FROM %s WHERE c = 2"),row(2,0,2));
  assertRows(execute("SELECT * FROM %s WHERE c = 3"),row(2,1,3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnFirstClusteringColumn() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k, c));").target("c").indexName("c_index").withFirstRow(row(0,0,0)).withSecondRow(row(1,1,1)).missingIndexMessage(SelectStatement.REQUIRES_ALLOW_FILTERING_MESSAGE).firstQueryExpression("c=0").secondQueryExpression("c=1").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnFrozenList() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, l frozen<list<int>>, PRIMARY KEY (k, c));").target("full(l)").indexName("fl_index").withFirstRow(row(0,0,Lists.newArrayList(10,20,30))).withSecondRow(row(1,1,Lists.newArrayList(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("l = [10, 20, 30]").secondQueryExpression("l = [11, 21, 31]").updateExpression("SET l = [40, 50, 60]").postUpdateQueryExpression("l = [40, 50, 60]").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnRegularColumnWithCompactStorage() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, v int, PRIMARY KEY (k)) WITH COMPACT STORAGE;").target("v").indexName("cv_index").withFirstRow(row(0,0)).withSecondRow(row(1,1)).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("v=0").secondQueryExpression("v=1").updateExpression("SET v=2").postUpdateQueryExpression("v=2").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void createIndexesOnMultipleMapDimensions() throws Throwable {
  Object[] row1=row(0,0,ImmutableMap.of("a",10,"b",20,"c",30));
  Object[] row2=row(1,1,ImmutableMap.of("d",11,"e",21,"f",32));
  createTable("CREATE TABLE %s (k int, c int, m map<text, int>, PRIMARY KEY(k, c))");
  createIndex("CREATE INDEX mkey_index on %s(keys(m))");
  createIndex("CREATE INDEX mval_index on %s(m)");
  execute("INSERT INTO %s (k, c, m) VALUES (?, ?, ?)",row1);
  execute("INSERT INTO %s (k, c, m) VALUES (?, ?, ?)",row2);
  assertRows(execute("SELECT * FROM %s WHERE m CONTAINS KEY 'a'"),row1);
  assertRows(execute("SELECT * FROM %s WHERE m CONTAINS 20"),row1);
  assertRows(execute("SELECT * FROM %s WHERE m CONTAINS KEY 'f'"),row2);
  assertRows(execute("SELECT * FROM %s WHERE m CONTAINS 32"),row2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnFrozenSet() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, s frozen<set<int>>, PRIMARY KEY (k, c));").target("full(s)").indexName("fs_index").withFirstRow(row(0,0,Sets.newHashSet(10,20,30))).withSecondRow(row(1,1,Sets.newHashSet(11,21,31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("s = {10, 20, 30}").secondQueryExpression("s = {11, 21, 31}").updateExpression("SET s = {40, 50, 60}").postUpdateQueryExpression("s = {40, 50, 60}").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapEntriesWithReplaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("entries(m)").indexName("m_index5").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m['a'] = 10").secondQueryExpression("m['d'] = 11").updateExpression("SET m = {'x':40, 'y':50, 'z':60}").postUpdateQueryExpression("m['x'] = 40").run();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void indexOnNonFrozenMapValuesWithReplaceOperation() throws Throwable {
  new TestScript().tableDefinition("CREATE TABLE %s (k int, c int, m map<text,int>, PRIMARY KEY (k, c));").target("m").indexName("m_index1").withFirstRow(row(0,0,ImmutableMap.of("a",10,"b",20,"c",30))).withSecondRow(row(1,1,ImmutableMap.of("d",11,"e",21,"f",31))).missingIndexMessage(StatementRestrictions.NO_INDEX_FOUND_MESSAGE).firstQueryExpression("m CONTAINS 10").secondQueryExpression("m CONTAINS 11").updateExpression("SET m = {'x':40, 'y':50, 'z':60}").postUpdateQueryExpression("m CONTAINS 40").run();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.SASIIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnNamesWithSlashes() throws Exception {
  testColumnNamesWithSlashes(false);
  cleanupData();
  testColumnNamesWithSlashes(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPagination() throws Exception {
  testPagination(false);
  cleanupData();
  testPagination(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiExpressionQueries() throws Exception {
  testMultiExpressionQueries(false);
  cleanupData();
  testMultiExpressionQueries(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQueriesThatShouldBeTokenized() throws Exception {
  testQueriesThatShouldBeTokenized(false);
  cleanupData();
  testQueriesThatShouldBeTokenized(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLowerCaseAnalyzer(){
  testLowerCaseAnalyzer(false);
  cleanupData();
  testLowerCaseAnalyzer(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidate() throws Exception {
  testInvalidate(false);
  cleanupData();
  testInvalidate(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyTokenizedResults() throws Exception {
  testEmptyTokenizedResults(false);
  cleanupData();
  testEmptyTokenizedResults(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiExpressionQueriesWhereRowSplitBetweenSSTables() throws Exception {
  testMultiExpressionQueriesWhereRowSplitBetweenSSTables(false);
  cleanupData();
  testMultiExpressionQueriesWhereRowSplitBetweenSSTables(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossSSTableQueries() throws Exception {
  testCrossSSTableQueries(false);
  cleanupData();
  testCrossSSTableQueries(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleExpressionQueries() throws Exception {
  testSingleExpressionQueries(false);
  cleanupData();
  testSingleExpressionQueries(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusteringIndexes() throws Exception {
  testClusteringIndexes(false);
  cleanupData();
  testClusteringIndexes(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.OnDiskIndexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSuperBlockRetrieval() throws Exception {
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,LongType.instance,OnDiskIndexBuilder.Mode.SPARSE);
  for (long i=0; i < 100000; i++)   builder.add(LongType.instance.decompose(i),keyAt(i),i);
  File index=File.createTempFile("on-disk-sa-multi-superblock-match",".db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDiskIndex=new OnDiskIndex(index,LongType.instance,new KeyConverter());
  testSearchRangeWithSuperBlocks(onDiskIndex,0,500);
  testSearchRangeWithSuperBlocks(onDiskIndex,300,93456);
  testSearchRangeWithSuperBlocks(onDiskIndex,210,1700);
  testSearchRangeWithSuperBlocks(onDiskIndex,530,3200);
  Random random=new Random(0xdeadbeef);
  for (int i=0; i < 100000; i+=random.nextInt(1500)) {
    for (int j=0; j < 3; j++)     testSearchRangeWithSuperBlocks(onDiskIndex,i,ThreadLocalRandom.current().nextInt(i,100000));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.TokenTreeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void skipPastEnd() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  final File treeFile=File.createTempFile("token-tree-skip-past-test","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final RangeIterator<Long,Token> tokenTree=new TokenTree(new MappedBuffer(reader)).iterator(KEY_CONVERTER);
  tokenTree.skipTo(simpleTokenMap.lastKey() + 10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.MappedBufferTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testLimitGreaterThanCapacity() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.limit(buffer.capacity() + 1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testPositionGreaterThanLimit() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.limit(4);
  try {
    buffer.position(buffer.limit() + 1);
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetLongRelativeUnderflow() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.position(buffer.capacity() - 7);
  try {
    buffer.getLong();
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testMisalignedRegionAccess() throws Exception {
  try (MappedBuffer buffer=createTestFile(100,8,4,0)){
    buffer.getPageRegion(13,27);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetLongAbsoluteNegativePosition() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.getLong(-1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetIntRelativeUnderflow() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.position(buffer.capacity() - 3);
  try {
    buffer.getInt();
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetShortRelativeUnderflow() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.position(buffer.capacity() - 1);
  try {
    buffer.getShort();
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetRelativeUnderflow() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.position(buffer.limit());
  try {
    buffer.get();
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetAbsoluteNegativePosition() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.get(-1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetIntAbsoluteNegativePosition() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.getInt(-1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetShortAbsoluteNegativePosition() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.getShort(-1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testGetAbsoluteGreaterThanCapacity() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.get(buffer.limit());
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNegativePosition() throws Exception {
  try (MappedBuffer buffer=createTestFile(1)){
    buffer.position(-1);
  }
 }

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testLimitLessThanPosition() throws Exception {
  final MappedBuffer buffer=createTestFile(1);
  buffer.position(1);
  try {
    buffer.limit(0);
  }
  finally {
    buffer.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.RangeIntersectionIteratorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntersectionOfRandomRanges(){
  for (  Strategy strategy : Strategy.values())   testIntersectionOfRandomRanges(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoOverlappingValues(){
  for (  Strategy strategy : Strategy.values())   testNoOverlappingValues(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinMaxAndCount(){
  for (  Strategy strategy : Strategy.values())   testMinMaxAndCount(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOverlappingValues(){
  for (  Strategy strategy : Strategy.values())   testOverlappingValues(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClose() throws IOException {
  for (  Strategy strategy : Strategy.values())   testClose(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuilder(){
  for (  Strategy strategy : Strategy.values())   testBuilder(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkipTo(){
  for (  Strategy strategy : Strategy.values())   testSkipTo(strategy);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleIterator(){
  for (  Strategy strategy : Strategy.values())   testSingleIterator(strategy);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressedRandomAccessReaderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testResetAndTruncateCompressedMmap() throws IOException {
  testResetAndTruncate(File.createTempFile("compressed_mmap","1"),true,true,10);
  testResetAndTruncate(File.createTempFile("compressed_mmap","2"),true,true,CompressionParams.DEFAULT_CHUNK_LENGTH);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testResetAndTruncate() throws IOException {
  testResetAndTruncate(File.createTempFile("normal","1"),false,false,10);
  testResetAndTruncate(File.createTempFile("normal","2"),false,false,CompressionParams.DEFAULT_CHUNK_LENGTH);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testResetAndTruncateCompressed() throws IOException {
  testResetAndTruncate(File.createTempFile("compressed","1"),true,false,10);
  testResetAndTruncate(File.createTempFile("compressed","2"),true,false,CompressionParams.DEFAULT_CHUNK_LENGTH);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressedSequentialWriterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeflateWriter() throws IOException {
  compressionParameters=CompressionParams.deflate();
  runTests("Deflate");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLZ4Writer() throws IOException {
  compressionParameters=CompressionParams.lz4();
  runTests("LZ4");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnappyWriter() throws IOException {
  compressionParameters=CompressionParams.snappy();
  runTests("Snappy");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLZ4ByteBuffers() throws IOException {
  compressor=LZ4Compressor.create(Collections.<String,String>emptyMap());
  testByteBuffers();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllCompressors() throws IOException {
  for (  ICompressor compressor : compressors) {
    this.compressor=compressor;
    testEmptyArray();
    testLongArray();
    testShortArray();
    testMappedFile();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeflateByteBuffers() throws IOException {
  compressor=DeflateCompressor.create(Collections.<String,String>emptyMap());
  testByteBuffers();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnappyByteBuffers() throws IOException {
  compressor=SnappyCompressor.create(Collections.<String,String>emptyMap());
  testByteBuffers();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.CQLSSTableWriterLongTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWideRow() throws Exception {
  String KS="cql_keyspace";
  String TABLE="table1";
  int size=30000;
  File tempdir=Files.createTempDir();
  File dataDir=new File(tempdir.getAbsolutePath() + File.separator + KS+ File.separator+ TABLE);
  assert dataDir.mkdirs();
  StringBuilder schemaColumns=new StringBuilder();
  StringBuilder queryColumns=new StringBuilder();
  StringBuilder queryValues=new StringBuilder();
  for (int i=0; i < size; i++) {
    schemaColumns.append("v");
    schemaColumns.append(i);
    schemaColumns.append(" int,");
    queryColumns.append(", v");
    queryColumns.append(i);
    queryValues.append(", ?");
  }
  String schema="CREATE TABLE cql_keyspace.table1 (" + "  k int," + "  c int," + schemaColumns.toString() + "  PRIMARY KEY (k, c)"+ ")";
  String insert="INSERT INTO cql_keyspace.table1 (k, c" + queryColumns.toString() + ") VALUES (?, ?"+ queryValues.toString()+ ")";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(schema).using(insert).withBufferSizeInMB(1).build();
  long high=100;
  Random r=new Random(0);
  for (int i=0; i < high; i++) {
    List values=new ArrayList<>(size + 2);
    values.add(0);
    values.add(r.nextInt());
    for (int j=0; j < size; j++) {
      values.add(i);
    }
    writer.addRow(values);
  }
  writer.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.CQLSSTableWriterTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testForbidCounterUpdates() throws Exception {
  String KS="cql_keyspace";
  String TABLE="counter1";
  File tempdir=Files.createTempDir();
  File dataDir=new File(tempdir.getAbsolutePath() + File.separator + KS+ File.separator+ TABLE);
  assert dataDir.mkdirs();
  String schema="CREATE TABLE cql_keyspace.counter1 (" + "  my_id int, " + "  my_counter counter, "+ "  PRIMARY KEY (my_id)"+ ")";
  String insert=String.format("UPDATE cql_keyspace.counter1 SET my_counter = my_counter - ? WHERE my_id = ?");
  CQLSSTableWriter.builder().inDirectory(dataDir).forTable(schema).withPartitioner(Murmur3Partitioner.instance).using(insert).build();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyncNoEmptyRows() throws Exception {
  File tempdir=Files.createTempDir();
  String schema="CREATE TABLE ks.test2 (" + "  k UUID," + "  c int,"+ "  PRIMARY KEY (k)"+ ")";
  String insert="INSERT INTO ks.test2 (k, c) VALUES (?, ?)";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(tempdir).forTable(schema).using(insert).withBufferSizeInMB(1).build();
  for (int i=0; i < 50000; i++) {
    writer.addRow(UUID.randomUUID(),0);
  }
  writer.close();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyncWithinPartition() throws Exception {
  String KS="ks";
  String TABLE="test";
  File tempdir=Files.createTempDir();
  File dataDir=new File(tempdir.getAbsolutePath() + File.separator + KS+ File.separator+ TABLE);
  assert dataDir.mkdirs();
  String schema="CREATE TABLE ks.test (" + "  k int PRIMARY KEY," + "  v blob"+ ")";
  String insert="INSERT INTO ks.test (k, v) VALUES (?, ?)";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(schema).using(insert).withBufferSizeInMB(1).build();
  ByteBuffer val=ByteBuffer.allocate(1024 * 1050);
  writer.addRow(0,val);
  writer.addRow(1,val);
  writer.close();
  FilenameFilter filterDataFiles=new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.endsWith("-Data.db");
    }
  }
;
  assert dataDir.list(filterDataFiles).length > 1 : Arrays.toString(dataDir.list(filterDataFiles));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.DescriptorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromFilenameInLegacyDirectory() throws Exception {
  File cfDir=new File(tempDataDir.getAbsolutePath() + File.separator + ksname+ File.separator+ cfname);
  testFromFilenameFor(cfDir);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromFilenameInBackup() throws Exception {
  File backupDir=new File(StringUtils.join(new String[]{tempDataDir.getAbsolutePath(),ksname,cfname + '-' + cfId,Directories.BACKUPS_SUBDIR},File.separator));
  testFromFilenameFor(backupDir);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromFilename() throws Exception {
  File cfIdDir=new File(tempDataDir.getAbsolutePath() + File.separator + ksname+ File.separator+ cfname+ '-'+ cfId);
  testFromFilenameFor(cfIdDir);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void validateNames(){
  String names[]={"system-schema_keyspace-ka-1-" + SSTableFormat.Type.BIG.name + "-Data.db"};
  for (  String name : names) {
    Descriptor d=Descriptor.fromFilename(name);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromFilenameInSnapshot() throws Exception {
  File snapshotDir=new File(StringUtils.join(new String[]{tempDataDir.getAbsolutePath(),ksname,cfname + '-' + cfId,Directories.SNAPSHOT_SUBDIR,"snapshot_name"},File.separator));
  testFromFilenameFor(snapshotDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.LegacySSTableTest </h4><pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Generates sstables for 4 CQL tables (see {@link #createTables(String)}) in <i>current</i>
 * sstable format (version) into {@code test/data/legacy-sstables/VERSION}, where{@code VERSION} matches {@link Version#getVersion() BigFormat.latestVersion.getVersion()}.
 * <p>
 * Run this test alone (e.g. from your IDE) when a new version is introduced or format changed
 * during development. I.e. remove the {@code @Ignore} annotation temporarily.
 * </p>
 */
@Test @Ignore public void testGenerateSstables() throws Throwable {
  createKeyspace();
  createTables(BigFormat.latestVersion.getVersion());
  Random rand=new Random();
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 128; i++) {
    sb.append((char)('a' + rand.nextInt(26)));
  }
  String randomString=sb.toString();
  for (int pk=0; pk < 5; pk++) {
    String valPk=Integer.toString(pk);
    QueryProcessor.executeInternal(String.format("INSERT INTO legacy_tables.legacy_%s_simple (pk, val) VALUES ('%s', '%s')",BigFormat.latestVersion,valPk,"foo bar baz"));
    QueryProcessor.executeInternal(String.format("UPDATE legacy_tables.legacy_%s_simple_counter SET val = val + 1 WHERE pk = '%s'",BigFormat.latestVersion,valPk));
    for (int ck=0; ck < 50; ck++) {
      String valCk=Integer.toString(ck);
      QueryProcessor.executeInternal(String.format("INSERT INTO legacy_tables.legacy_%s_clust (pk, ck, val) VALUES ('%s', '%s', '%s')",BigFormat.latestVersion,valPk,valCk + longString,randomString));
      QueryProcessor.executeInternal(String.format("UPDATE legacy_tables.legacy_%s_clust_counter SET val = val + 1 WHERE pk = '%s' AND ck='%s'",BigFormat.latestVersion,valPk,valCk + longString));
    }
  }
  StorageService.instance.forceKeyspaceFlush("legacy_tables");
  File ksDir=new File(LEGACY_SSTABLE_ROOT,String.format("%s/legacy_tables",BigFormat.latestVersion));
  ksDir.mkdirs();
  copySstablesFromTestData(String.format("legacy_%s_simple",BigFormat.latestVersion),ksDir);
  copySstablesFromTestData(String.format("legacy_%s_simple_counter",BigFormat.latestVersion),ksDir);
  copySstablesFromTestData(String.format("legacy_%s_clust",BigFormat.latestVersion),ksDir);
  copySstablesFromTestData(String.format("legacy_%s_clust_counter",BigFormat.latestVersion),ksDir);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStreaming() throws Throwable {
  StorageService.instance.initServer();
  for (  File version : LEGACY_SSTABLE_ROOT.listFiles()) {
    if (!new File(LEGACY_SSTABLE_ROOT + File.separator + version.getName()+ File.separator+ KSNAME).isDirectory())     continue;
    if (Version.validate(version.getName()) && SSTableFormat.Type.LEGACY.info.getVersion(version.getName()).isCompatibleForStreaming())     testStreaming(version.getName());
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVersions() throws Throwable {
  boolean notSkipped=false;
  for (  File version : LEGACY_SSTABLE_ROOT.listFiles()) {
    if (!new File(LEGACY_SSTABLE_ROOT + File.separator + version.getName()+ File.separator+ KSNAME).isDirectory())     continue;
    if (Version.validate(version.getName()) && SSTableFormat.Type.LEGACY.info.getVersion(version.getName()).isCompatible()) {
      notSkipped=true;
      testVersion(version.getName());
    }
  }
  assert notSkipped;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyCqlTables() throws Exception {
  createKeyspace();
  loadLegacyTables();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableReaderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadingSummaryUsesCorrectPartitioner() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Indexed1");
  new RowUpdateBuilder(store.metadata,System.currentTimeMillis(),"k1").clustering("0").add("birthdate",1L).build().applyUnsafe();
  store.forceBlockingFlush();
  for (  ColumnFamilyStore indexCfs : store.indexManager.getAllIndexColumnFamilyStores()) {
    assert indexCfs.isIndex();
    SSTableReader sstable=indexCfs.getLiveSSTables().iterator().next();
    assert sstable.first.getToken() instanceof LocalToken;
    try (SegmentedFile.Builder ibuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getIndexAccessMode(),false);SegmentedFile.Builder dbuilder=SegmentedFile.getBuilder(DatabaseDescriptor.getDiskAccessMode(),sstable.compression)){
      sstable.saveSummary(ibuilder,dbuilder);
    }
     SSTableReader reopened=SSTableReader.open(sstable.descriptor);
    assert reopened.first.getToken() instanceof LocalToken;
    reopened.selfRef().release();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetPositionsForRanges(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard2");
  partitioner=store.getPartitioner();
  CompactionManager.instance.disableAutoCompaction();
  for (int j=0; j < 10; j++) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  List<Range<Token>> ranges=new ArrayList<Range<Token>>();
  ranges.add(new Range<>(t(0),t(1)));
  ranges.add(new Range<>(t(2),t(4)));
  ranges.add(new Range<>(t(6),partitioner.getMinimumToken()));
  ranges.add(new Range<>(t(9),t(91)));
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  long previous=-1;
  for (  Pair<Long,Long> section : sstable.getPositionsForRanges(ranges)) {
    assert previous <= section.left : previous + " ! < " + section.left;
    assert section.left < section.right : section.left + " ! < " + section.right;
    previous=section.right;
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpannedIndexPositions() throws IOException {
  MmappedRegions.MAX_SEGMENT_SIZE=40;
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  partitioner=store.getPartitioner();
  CompactionManager.instance.disableAutoCompaction();
  for (int j=0; j < 100; j+=2) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  for (int j=0; j < 100; j+=2) {
    DecoratedKey dk=Util.dk(String.valueOf(j));
    FileDataInput file=sstable.getFileDataInput(sstable.getPosition(dk,SSTableReader.Operator.EQ).position);
    DecoratedKey keyInDisk=sstable.decorateKey(ByteBufferUtil.readWithShortLength(file));
    assert keyInDisk.equals(dk) : String.format("%s != %s in %s",keyInDisk,dk,file.getPath());
  }
  for (int j=1; j < 110; j+=2) {
    DecoratedKey dk=Util.dk(String.valueOf(j));
    assert sstable.getPosition(dk,SSTableReader.Operator.EQ) == null;
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetPositionsForRangesWithKeyCache(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard2");
  partitioner=store.getPartitioner();
  CacheService.instance.keyCache.setCapacity(100);
  CompactionManager.instance.disableAutoCompaction();
  for (int j=0; j < 10; j++) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  long p2=sstable.getPosition(k(2),SSTableReader.Operator.EQ).position;
  long p3=sstable.getPosition(k(3),SSTableReader.Operator.EQ).position;
  long p6=sstable.getPosition(k(6),SSTableReader.Operator.EQ).position;
  long p7=sstable.getPosition(k(7),SSTableReader.Operator.EQ).position;
  Pair<Long,Long> p=sstable.getPositionsForRanges(makeRanges(t(2),t(6))).get(0);
  assert p.left == p3;
  assert p.right == p7;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPersistentStatistics(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  partitioner=store.getPartitioner();
  for (int j=0; j < 100; j+=2) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  clearAndLoad(store);
  assert store.metric.maxPartitionSize.getValue() != 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetPositionsForRangesFromTableOpenedForBulkLoading() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard2");
  partitioner=store.getPartitioner();
  CompactionManager.instance.disableAutoCompaction();
  for (int j=0; j < 130; j++) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  List<Range<Token>> ranges=new ArrayList<Range<Token>>();
  ranges.add(new Range<Token>(t(98),t(99)));
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  List<Pair<Long,Long>> sections=sstable.getPositionsForRanges(ranges);
  assert sections.size() == 1 : "Expected to find range in sstable";
  Set<Component> components=Sets.newHashSet(Component.DATA,Component.PRIMARY_INDEX);
  if (sstable.components.contains(Component.COMPRESSION_INFO))   components.add(Component.COMPRESSION_INFO);
  SSTableReader bulkLoaded=SSTableReader.openForBatch(sstable.descriptor,components,store.metadata);
  sections=bulkLoaded.getPositionsForRanges(ranges);
  assert sections.size() == 1 : "Expected to find range in sstable opened for bulk loading";
  bulkLoaded.selfRef().release();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPersistentStatisticsWithSecondaryIndex(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(CF_INDEXED);
  partitioner=store.getPartitioner();
  new RowUpdateBuilder(store.metadata,System.currentTimeMillis(),"k1").clustering("0").add("birthdate",1L).build().applyUnsafe();
  store.forceBlockingFlush();
  assertIndexQueryWorks(store);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableRewriterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAbort2() throws Exception {
  testAbortHelper(true,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSSTableSplit() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  cfs.disableAutoCompaction();
  SSTableReader s=writeFile(cfs,1000);
  try (LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.UNKNOWN,s)){
    SSTableSplitter splitter=new SSTableSplitter(cfs,txn,10);
    splitter.split();
    assertFileCounts(s.descriptor.directory.list());
    LifecycleTransaction.waitForDeletions();
    for (    File f : s.descriptor.directory.listFiles()) {
      FileUtils.deleteRecursive(f);
    }
  }
   truncate(cfs);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAbort() throws Exception {
  testAbortHelper(false,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOfflineAbort() throws Exception {
  testAbortHelper(true,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOfflineAbort2() throws Exception {
  testAbortHelper(false,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.format.ClientModeSSTableTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVersions() throws Throwable {
  boolean notSkipped=false;
  for (  File version : LEGACY_SSTABLE_ROOT.listFiles()) {
    if (!new File(LEGACY_SSTABLE_ROOT + File.separator + version.getName()+ File.separator+ KSNAME).isDirectory())     continue;
    if (Version.validate(version.getName()) && SSTableFormat.Type.LEGACY.info.getVersion(version.getName()).isCompatible()) {
      notSkipped=true;
      testVersion(version.getName());
    }
  }
  assert notSkipped;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedDataOutputStreamTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testTooBigLengthWithOffset() throws Exception {
  byte type[]=new byte[10];
  fakeStream.write(type,8,3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFuzz() throws Exception {
  for (int ii=0; ii < 30; ii++)   fuzzOnce();
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void testNullBuffer() throws Exception {
  byte type[]=null;
  fakeStream.write(type,0,1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testNegativeLength() throws Exception {
  byte type[]=new byte[10];
  fakeStream.write(type,0,-1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testNegativeOffset() throws Exception {
  byte type[]=new byte[10];
  fakeStream.write(type,-1,1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testTooBigLength() throws Exception {
  byte type[]=new byte[10];
  fakeStream.write(type,0,11);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testTooBigOffset() throws Exception {
  byte type[]=new byte[10];
  fakeStream.write(type,11,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedRandomAccessFileTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetPath() throws IOException {
  SequentialWriter file=createTempFile("brafGetPath");
  assert file.getPath().contains("brafGetPath");
  file.finish();
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSetNegativeLength() throws IOException, IllegalArgumentException {
  File tmpFile=File.createTempFile("set_negative_length","bin");
  try (SequentialWriter file=SequentialWriter.open(tmpFile)){
    file.truncate(-8L);
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadAndWriteOnCapacity() throws IOException {
  File tmpFile=File.createTempFile("readtest","bin");
  SequentialWriter w=SequentialWriter.open(tmpFile);
  byte[] in=generateByteArray(RandomAccessReader.DEFAULT_BUFFER_SIZE);
  w.write(in);
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader r=RandomAccessReader.open(channel);
  byte[] out=new byte[RandomAccessReader.DEFAULT_BUFFER_SIZE];
  r.read(out);
  int negone=r.read();
  assert negone == -1 : "We read past the end of the file, should have gotten EOF -1. Instead, " + negone;
  r.close();
  w.finish();
  channel.close();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AssertionError.class) public void testAssertionErrorWhenBytesPastMarkIsNegative() throws IOException {
  try (SequentialWriter w=createTempFile("brafAssertionErrorWhenBytesPastMarkIsNegative")){
    w.write(new byte[30]);
    w.flush();
    try (ChannelProxy channel=new ChannelProxy(w.getPath());RandomAccessReader r=RandomAccessReader.open(channel)){
      r.seek(10);
      r.mark();
      r.seek(0);
      r.bytesPastMark();
    }
   }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBytesPastMark() throws IOException {
  File tmpFile=File.createTempFile("overflowtest","bin");
  tmpFile.deleteOnExit();
  try (final RandomAccessReader r=RandomAccessReader.open(new File(tmpFile.getPath()))){
    assert tmpFile.getPath().equals(r.getPath());
    final FileMark mark=r.mark();
    r.reset(mark);
    r.bytesPastMark(mark);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.DataOutputTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataOutputBufferMaxSize() throws IOException {
  if (Runtime.getRuntime().maxMemory() < 5033164800L)   return;
  try (DataOutputBuffer write=new DataOutputBuffer()){
    for (int ii=0; ii < DataOutputBuffer.MAX_ARRAY_SIZE / 8; ii++)     write.writeLong(0);
    write.write(new byte[7]);
    checkThrowsRuntimeException(validateReallocationCallable(write,DataOutputBuffer.MAX_ARRAY_SIZE + 1));
    checkThrowsRuntimeException(new Callable(){
      public Object call() throws Exception {
        write.write(42);
        return null;
      }
    }
);
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataOutputHeapByteBuffer() throws IOException {
  ByteBuffer buf=wrap(new byte[345],false);
  BufferedDataOutputStreamPlus write=new BufferedDataOutputStreamPlus(null,buf.duplicate());
  DataInput canon=testWrite(write);
  DataInput test=new DataInputStream(new ByteArrayInputStream(ByteBufferUtil.getArray(buf)));
  testRead(test,canon);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrappedDataOutputChannelAndChannel() throws IOException {
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStreamPlus write=new WrappedDataOutputStreamPlus(bos);
  DataInput canon=testWrite(write);
  DataInput test=new DataInputStream(new ByteArrayInputStream(bos.toByteArray()));
  testRead(test,canon);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataOutputBuffer() throws IOException {
  DataOutputBuffer write=new DataOutputBuffer();
  DataInput canon=testWrite(write);
  DataInput test=new DataInputStream(new ByteArrayInputStream(write.toByteArray()));
  testRead(test,canon);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSafeMemoryWriter() throws IOException {
  try (SafeMemoryWriter write=new SafeMemoryWriter(10)){
    DataInput canon=testWrite(write);
    byte[] bytes=new byte[345];
    write.currentBuffer().getBytes(0,bytes,0,345);
    DataInput test=new DataInputStream(new ByteArrayInputStream(bytes));
    testRead(test,canon);
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataOutputDirectByteBuffer() throws IOException {
  ByteBuffer buf=wrap(new byte[345],true);
  BufferedDataOutputStreamPlus write=new BufferedDataOutputStreamPlus(null,buf.duplicate());
  DataInput canon=testWrite(write);
  DataInput test=new DataInputStream(new ByteArrayInputStream(ByteBufferUtil.getArray(buf)));
  testRead(test,canon);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataOutputBufferZeroReallocate() throws IOException {
  try (DataOutputBufferSpy write=new DataOutputBufferSpy()){
    for (int ii=0; ii < 1000000; ii++) {
      write.superReallocate(0);
    }
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBufferedDataOutputStreamPlusAndChannel() throws IOException {
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStreamPlus write=new BufferedDataOutputStreamPlus(Channels.newChannel(bos));
  DataInput canon=testWrite(write);
  write.close();
  DataInput test=new DataInputStream(new ByteArrayInputStream(bos.toByteArray()));
  testRead(test,canon);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrappedDataOutputStreamPlus() throws IOException {
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStreamPlus write=new WrappedDataOutputStreamPlus(bos);
  DataInput canon=testWrite(write);
  DataInput test=new DataInputStream(new ByteArrayInputStream(bos.toByteArray()));
  testRead(test,canon);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.FileSegmentInputStreamTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=EOFException.class) public void testReadBytesTooMany() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",1024);
  ByteBufferUtil.read(reader,2049);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSeekNegative() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",0);
  reader.seek(-1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRead() throws IOException {
  testRead(0,4096,1024);
  testRead(1024,4096,1024);
  testRead(4096,4096,1024);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSeekBeforeOffset() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",1024);
  reader.seek(1023);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testResetNotSupported() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",0);
  reader.reset(null);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSeekPastLength() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",1024);
  reader.seek(2049);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MemoryTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testByteBuffers(){
  byte[] bytes=new byte[1000];
  ThreadLocalRandom.current().nextBytes(bytes);
  final Memory memory=Memory.allocate(bytes.length);
  memory.setBytes(0,bytes,0,bytes.length);
  ByteBuffer canon=ByteBuffer.wrap(bytes).order(ByteOrder.nativeOrder());
  test(canon,memory);
  memory.setBytes(0,new byte[1000],0,1000);
  memory.setBytes(0,canon.duplicate());
  test(canon,memory);
  memory.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MmappedRegionsTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNegativeExtend() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testNegativeExtend",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(-1);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.NIODataInputStreamTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testReadLine() throws Exception {
  fakeStream.readLine();
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testNegativeOffsetReadBuffer() throws Exception {
  fakeStream.read(new byte[1],-1,1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testLengthToBigReadBuffer() throws Exception {
  fakeStream.read(new byte[1],0,2);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testResetThrows() throws Exception {
  fakeStream.reset();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFuzz() throws Exception {
  for (int ii=0; ii < 80; ii++)   fuzzOnce();
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testLengthToWithOffsetBigReadBuffer() throws Exception {
  fakeStream.read(new byte[1],1,1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void testNullReadBuffer() throws Exception {
  fakeStream.read(null,0,1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IndexOutOfBoundsException.class) public void testNegativeLengthReadBuffer() throws Exception {
  fakeStream.read(new byte[1],0,-1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.RandomAccessReaderTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBigBufferSize() throws IOException {
  testReadFully(new Parameters(8192,65536).bufferType(BufferType.ON_HEAP));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBufferedOffHeap() throws IOException {
  testReadFully(new Parameters(8192,4096).bufferType(BufferType.OFF_HEAP));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBufferedOnHeap() throws IOException {
  testReadFully(new Parameters(8192,4096).bufferType(BufferType.ON_HEAP));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTinyBufferSize() throws IOException {
  testReadFully(new Parameters(8192,16).bufferType(BufferType.ON_HEAP));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekMultipleThreads() throws IOException, InterruptedException {
  testSeek(10);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleSegments() throws IOException {
  testReadFully(new Parameters(8192,4096).mmappedRegions(true).maxSegmentSize(1024));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekSingleThread() throws IOException, InterruptedException {
  testSeek(1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOneSegment() throws IOException {
  testReadFully(new Parameters(8192,4096).mmappedRegions(true));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.DynamicEndpointSnitchLongTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcurrency() throws InterruptedException, IOException, ConfigurationException {
  double badness=DatabaseDescriptor.getDynamicBadnessThreshold();
  DatabaseDescriptor.setDynamicBadnessThreshold(0.0);
  try {
    final int ITERATIONS=10000;
    StorageService.instance.unsafeInitialize();
    SimpleSnitch ss=new SimpleSnitch();
    DynamicEndpointSnitch dsnitch=new DynamicEndpointSnitch(ss,String.valueOf(ss.hashCode()));
    InetAddress self=FBUtilities.getBroadcastAddress();
    List<InetAddress> hosts=new ArrayList<>();
    for (int i=0; i < 100; i++)     for (int j=0; j < 256; j++)     hosts.add(InetAddress.getByAddress(new byte[]{127,0,(byte)i,(byte)j}));
    ScoreUpdater updater=new ScoreUpdater(dsnitch,hosts);
    updater.start();
    List<InetAddress> result=null;
    for (int i=0; i < ITERATIONS; i++)     result=dsnitch.getSortedListByProximity(self,hosts);
    updater.stopped=true;
    updater.join();
  }
  finally {
    DatabaseDescriptor.setDynamicBadnessThreshold(badness);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.GossipingPropertyFileSnitchTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadConfig() throws Exception {
  final GossipingPropertyFileSnitch snitch=new GossipingPropertyFileSnitch();
  checkEndpoint(snitch,FBUtilities.getBroadcastAddress().getHostAddress(),"DC1","RAC1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.NetworkTopologyStrategyTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProperties() throws IOException, ConfigurationException {
  IEndpointSnitch snitch=new PropertyFileSnitch();
  DatabaseDescriptor.setEndpointSnitch(snitch);
  TokenMetadata metadata=new TokenMetadata();
  createDummyTokens(metadata,true);
  Map<String,String> configOptions=new HashMap<String,String>();
  configOptions.put("DC1","3");
  configOptions.put("DC2","2");
  configOptions.put("DC3","1");
  NetworkTopologyStrategy strategy=new NetworkTopologyStrategy(keyspaceName,metadata,snitch,configOptions);
  assert strategy.getReplicationFactor("DC1") == 3;
  assert strategy.getReplicationFactor("DC2") == 2;
  assert strategy.getReplicationFactor("DC3") == 1;
  ArrayList<InetAddress> endpoints=strategy.getNaturalEndpoints(new StringToken("123"));
  assert 6 == endpoints.size();
  assert 6 == new HashSet<InetAddress>(endpoints).size();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPropertiesWithEmptyDC() throws IOException, ConfigurationException {
  IEndpointSnitch snitch=new PropertyFileSnitch();
  DatabaseDescriptor.setEndpointSnitch(snitch);
  TokenMetadata metadata=new TokenMetadata();
  createDummyTokens(metadata,false);
  Map<String,String> configOptions=new HashMap<String,String>();
  configOptions.put("DC1","3");
  configOptions.put("DC2","3");
  configOptions.put("DC3","0");
  NetworkTopologyStrategy strategy=new NetworkTopologyStrategy(keyspaceName,metadata,snitch,configOptions);
  assert strategy.getReplicationFactor("DC1") == 3;
  assert strategy.getReplicationFactor("DC2") == 3;
  assert strategy.getReplicationFactor("DC3") == 0;
  ArrayList<InetAddress> endpoints=strategy.getNaturalEndpoints(new StringToken("123"));
  assert 6 == endpoints.size();
  assert 6 == new HashSet<InetAddress>(endpoints).size();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCalculateEndpoints() throws UnknownHostException {
  final int NODES=100;
  final int VNODES=64;
  final int RUNS=10;
  StorageService.instance.setPartitionerUnsafe(Murmur3Partitioner.instance);
  Map<String,Integer> datacenters=ImmutableMap.of("rf1",1,"rf3",3,"rf5_1",5,"rf5_2",5,"rf5_3",5);
  List<InetAddress> nodes=new ArrayList<>(NODES);
  for (byte i=0; i < NODES; ++i)   nodes.add(InetAddress.getByAddress(new byte[]{127,0,0,i}));
  for (int run=0; run < RUNS; ++run) {
    Random rand=new Random();
    IEndpointSnitch snitch=generateSnitch(datacenters,nodes,rand);
    DatabaseDescriptor.setEndpointSnitch(snitch);
    TokenMetadata meta=new TokenMetadata();
    for (int i=0; i < NODES; ++i)     for (int j=0; j < VNODES; ++j)     meta.updateNormalToken(Murmur3Partitioner.instance.getRandomToken(rand),nodes.get(i));
    testEquivalence(meta,snitch,datacenters,rand);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.OldNetworkTopologyStrategyTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * 3 same rack endpoints
 * 1 external datacenter
 * @throws java.net.UnknownHostException
 */
@Test public void testBigIntegerEndpointsB() throws UnknownHostException {
  RackInferringSnitch endpointSnitch=new RackInferringSnitch();
  AbstractReplicationStrategy strategy=new OldNetworkTopologyStrategy("Keyspace1",tmd,endpointSnitch,optsWithRF(1));
  addEndpoint("0","5","254.0.0.1");
  addEndpoint("10","15","254.0.0.2");
  addEndpoint("20","25","254.1.0.3");
  addEndpoint("30","35","254.0.0.4");
  expectedResults.put("5",buildResult("254.0.0.2","254.1.0.3","254.0.0.4"));
  expectedResults.put("15",buildResult("254.1.0.3","254.0.0.4","254.0.0.1"));
  expectedResults.put("25",buildResult("254.0.0.4","254.1.0.3","254.0.0.1"));
  expectedResults.put("35",buildResult("254.0.0.1","254.1.0.3","254.0.0.2"));
  testGetEndpoints(strategy,keyTokens.toArray(new Token[0]));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * 4 same rack endpoints
 * @throws java.net.UnknownHostException
 */
@Test public void testBigIntegerEndpointsA() throws UnknownHostException {
  RackInferringSnitch endpointSnitch=new RackInferringSnitch();
  AbstractReplicationStrategy strategy=new OldNetworkTopologyStrategy("Keyspace1",tmd,endpointSnitch,optsWithRF(1));
  addEndpoint("0","5","254.0.0.1");
  addEndpoint("10","15","254.0.0.2");
  addEndpoint("20","25","254.0.0.3");
  addEndpoint("30","35","254.0.0.4");
  expectedResults.put("5",buildResult("254.0.0.2","254.0.0.3","254.0.0.4"));
  expectedResults.put("15",buildResult("254.0.0.3","254.0.0.4","254.0.0.1"));
  expectedResults.put("25",buildResult("254.0.0.4","254.0.0.1","254.0.0.2"));
  expectedResults.put("35",buildResult("254.0.0.1","254.0.0.2","254.0.0.3"));
  testGetEndpoints(strategy,keyTokens.toArray(new Token[0]));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * 2 same rack endpoints
 * 1 same datacenter, different rack endpoints
 * 1 external datacenter
 * @throws java.net.UnknownHostException
 */
@Test public void testBigIntegerEndpointsC() throws UnknownHostException {
  RackInferringSnitch endpointSnitch=new RackInferringSnitch();
  AbstractReplicationStrategy strategy=new OldNetworkTopologyStrategy("Keyspace1",tmd,endpointSnitch,optsWithRF(1));
  addEndpoint("0","5","254.0.0.1");
  addEndpoint("10","15","254.0.0.2");
  addEndpoint("20","25","254.0.1.3");
  addEndpoint("30","35","254.1.0.4");
  expectedResults.put("5",buildResult("254.0.0.2","254.0.1.3","254.1.0.4"));
  expectedResults.put("15",buildResult("254.0.1.3","254.1.0.4","254.0.0.1"));
  expectedResults.put("25",buildResult("254.1.0.4","254.0.0.1","254.0.0.2"));
  expectedResults.put("35",buildResult("254.0.0.1","254.0.1.3","254.1.0.4"));
  testGetEndpoints(strategy,keyTokens.toArray(new Token[0]));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.PropertyFileSnitchTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that removing a host from the configuration file changes the host rack only if the host
 * is not live. The original configuration file contains 127.0.0.2=DC1:RAC2 and default=DC1:r1 so removing
 * this host should result in a different rack if the host is not live.
 */
@Test public void testRemoveHost() throws Exception {
  final InetAddress host=InetAddress.getByName("127.0.0.2");
  final PropertyFileSnitch snitch=new PropertyFileSnitch(1);
  checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC2");
  try {
    setNodeLive(host);
    Files.copy(effectiveFile,backupFile);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),""));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC2");
    setNodeShutdown(host);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),""));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","r1");
  }
  finally {
    restoreOrigConfigFile();
    setNodeShutdown(host);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adding a host to the configuration file changes the host dc and rack only if the host
 * is not live. The original configuration file does not contain 127.0.0.9 and so it should use
 * the default default=DC1:r1.
 */
@Test public void testAddHost() throws Exception {
  final InetAddress host=InetAddress.getByName("127.0.0.9");
  final PropertyFileSnitch snitch=new PropertyFileSnitch(1);
  checkEndpoint(snitch,host.getHostAddress(),"DC1","r1");
  try {
    setNodeLive(host);
    Files.copy(effectiveFile,backupFile);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC2:RAC2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","r1");
    setNodeShutdown(host);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC2:RAC2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC2","RAC2");
  }
  finally {
    restoreOrigConfigFile();
    setNodeShutdown(host);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can change the default only if this does not result in any live node changing dc or rack.
 * The configuration file contains default=DC1:r1 and we change it to default=DC2:r2. Let's use host 127.0.0.9
 * since it is not in the configuration file.
 */
@Test public void testChangeDefault() throws Exception {
  final InetAddress host=InetAddress.getByName("127.0.0.9");
  final PropertyFileSnitch snitch=new PropertyFileSnitch(1);
  checkEndpoint(snitch,host.getHostAddress(),"DC1","r1");
  try {
    setNodeLive(host);
    Files.copy(effectiveFile,backupFile);
    replaceConfigFile(Collections.singletonMap("default","DC2:r2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","r1");
    setNodeShutdown(host);
    replaceConfigFile(Collections.singletonMap("default","DC2:r2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC2","r2");
  }
  finally {
    restoreOrigConfigFile();
    setNodeShutdown(host);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that changing dc for a host in the configuration file is only effective if the host is not live.
 * The original configuration file contains: 127.0.0.1=DC1:RAC1
 */
@Test public void testChangeHostDc() throws Exception {
  final InetAddress host=InetAddress.getByName("127.0.0.1");
  final PropertyFileSnitch snitch=new PropertyFileSnitch(1);
  checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC1");
  try {
    setNodeLive(host);
    Files.copy(effectiveFile,backupFile);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC2:RAC1"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC1");
    setNodeShutdown(host);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC2:RAC1"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC2","RAC1");
  }
  finally {
    restoreOrigConfigFile();
    setNodeShutdown(host);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that changing rack for a host in the configuration file is only effective if the host is not live.
 * The original configuration file contains: 127.0.0.1=DC1:RAC1
 */
@Test public void testChangeHostRack() throws Exception {
  final InetAddress host=InetAddress.getByName("127.0.0.1");
  final PropertyFileSnitch snitch=new PropertyFileSnitch(1);
  checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC1");
  try {
    setNodeLive(host);
    Files.copy(effectiveFile,backupFile);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC1:RAC2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC1");
    setNodeShutdown(host);
    replaceConfigFile(Collections.singletonMap(host.getHostAddress(),"DC1:RAC2"));
    Thread.sleep(1500);
    checkEndpoint(snitch,host.getHostAddress(),"DC1","RAC2");
  }
  finally {
    restoreOrigConfigFile();
    setNodeShutdown(host);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.ReplicationStrategyEndpointCacheTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEndpointsWereCached() throws Exception {
  runEndpointsWereCachedTest(FakeSimpleStrategy.class,null);
  runEndpointsWereCachedTest(FakeOldNetworkTopologyStrategy.class,null);
  runEndpointsWereCachedTest(FakeNetworkTopologyStrategy.class,new HashMap<String,String>());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCacheRespectsTokenChanges() throws Exception {
  runCacheRespectsTokenChangesTest(SimpleStrategy.class,null);
  runCacheRespectsTokenChangesTest(OldNetworkTopologyStrategy.class,null);
  runCacheRespectsTokenChangesTest(NetworkTopologyStrategy.class,new HashMap<String,String>());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.SimpleStrategyTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringEndpoints() throws UnknownHostException {
  IPartitioner partitioner=OrderPreservingPartitioner.instance;
  List<Token> endpointTokens=new ArrayList<Token>();
  List<Token> keyTokens=new ArrayList<Token>();
  for (int i=0; i < 5; i++) {
    endpointTokens.add(new StringToken(String.valueOf((char)('a' + i * 2))));
    keyTokens.add(partitioner.getToken(ByteBufferUtil.bytes(String.valueOf((char)('a' + i * 2 + 1)))));
  }
  verifyGetNaturalEndpoints(endpointTokens.toArray(new Token[0]),keyTokens.toArray(new Token[0]));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBigIntegerEndpoints() throws UnknownHostException {
  List<Token> endpointTokens=new ArrayList<Token>();
  List<Token> keyTokens=new ArrayList<Token>();
  for (int i=0; i < 5; i++) {
    endpointTokens.add(new BigIntegerToken(String.valueOf(10 * i)));
    keyTokens.add(new BigIntegerToken(String.valueOf(10 * i + 5)));
  }
  verifyGetNaturalEndpoints(endpointTokens.toArray(new Token[0]),keyTokens.toArray(new Token[0]));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void tryValidKeyspace(){
  assert Keyspace.open(KEYSPACE1).getReplicationStrategy() != null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.TokenMetadataTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRingIteratorEmptyRing(){
  testRingIterator(new ArrayList<Token>(),"2",false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRingIteratorIncludeMin(){
  ArrayList<Token> ring=tmd.sortedTokens();
  testRingIterator(ring,"2",true,"6","","1");
  testRingIterator(ring,"7",true,"","1","6");
  testRingIterator(ring,"0",true,"1","6","");
  testRingIterator(ring,"",true,"1","6","");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRingIterator(){
  ArrayList<Token> ring=tmd.sortedTokens();
  testRingIterator(ring,"2",false,"6","1");
  testRingIterator(ring,"7",false,"1","6");
  testRingIterator(ring,"0",false,"1","6");
  testRingIterator(ring,"",false,"1","6");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.net.WriteCallbackInfoTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShouldHint() throws Exception {
  testShouldHint(Verb.COUNTER_MUTATION,ConsistencyLevel.ALL,true,false);
  for (  Verb verb : new Verb[]{Verb.PAXOS_COMMIT,Verb.MUTATION}) {
    testShouldHint(verb,ConsistencyLevel.ALL,true,true);
    testShouldHint(verb,ConsistencyLevel.ANY,true,false);
    testShouldHint(verb,ConsistencyLevel.ALL,false,false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.DefsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void addNewCfToBogusKeyspace(){
  CFMetaData newCf=addTestTable("MadeUpKeyspace","NewCF","new cf");
  try {
    MigrationManager.announceNewColumnFamily(newCf);
    throw new AssertionError("You shouldn't be able to do anything to a keyspace that doesn't exist.");
  }
 catch (  ConfigurationException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.SchemaKeyspaceTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConversionsInverses() throws Exception {
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    ColumnFamilyStore cfs : Keyspace.open(keyspaceName).getColumnFamilyStores()) {
      CFMetaData cfm=cfs.metadata;
      if (!cfm.isThriftCompatible())       continue;
      checkInverses(cfm);
      CFMetaData withCompression=cfm.copy();
      withCompression.compression(CompressionParams.snappy(32768));
      checkInverses(withCompression);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.security.CipherFactoryTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AssertionError.class) public void getDecryptor_EmptyIv() throws IOException {
  cipherFactory.getDecryptor(encryptionOptions.cipher,encryptionOptions.key_alias,new byte[0]);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AssertionError.class) public void getDecryptor_NullIv() throws IOException {
  cipherFactory.getDecryptor(encryptionOptions.cipher,encryptionOptions.key_alias,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.serializers.ClientUtilsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Exercises the classes in the clientutil jar to expose missing dependencies. 
 */
@Test public void test(){
  AsciiSerializer.instance.deserialize(AsciiSerializer.instance.serialize("string"));
  BooleanSerializer.instance.deserialize(BooleanSerializer.instance.serialize(true));
  BytesSerializer.instance.deserialize(BytesSerializer.instance.serialize(ByteBuffer.wrap("string".getBytes())));
  Date date=new Date(System.currentTimeMillis());
  ByteBuffer dateBB=TimestampSerializer.instance.serialize(date);
  TimestampSerializer.instance.deserialize(dateBB);
  DecimalSerializer.instance.deserialize(DecimalSerializer.instance.serialize(new BigDecimal(1)));
  DoubleSerializer.instance.deserialize(DoubleSerializer.instance.serialize(new Double(1.0d)));
  FloatSerializer.instance.deserialize(FloatSerializer.instance.serialize(new Float(1.0f)));
  Int32Serializer.instance.deserialize(Int32Serializer.instance.serialize(1));
  IntegerSerializer.instance.deserialize(IntegerSerializer.instance.serialize(new BigInteger("1")));
  LongSerializer.instance.deserialize(LongSerializer.instance.serialize(1L));
  UTF8Serializer.instance.deserialize(UTF8Serializer.instance.serialize("string"));
  UUID uuid=UUIDGen.getTimeUUID();
  UUIDSerializer.instance.deserialize(UUIDSerializer.instance.serialize(uuid));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.serializers.SimpleDateSerializerTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testOutOfBoundsLow(){
  Integer days=SimpleDateSerializer.dateStringToDays(new Date(Integer.MIN_VALUE * millisPerDay - millisPerDay).toString());
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadMonth(){
  Integer days=SimpleDateSerializer.dateStringToDays("1000-13-01");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDaysStringToInt(){
  Integer value=SimpleDateSerializer.dateStringToDays("12345");
  assert value.compareTo(12345) == 0 : String.format("Failed to parse integer based date.  Expected %s, got %s",12345,value);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateStringToTimestamp(){
  List<String> unparsedDates=new ArrayList<>();
  List<String> badParseResults=new ArrayList<>();
  for (  String date : dates) {
    try {
      Integer days=SimpleDateSerializer.dateStringToDays(date);
      ByteBuffer value=SimpleDateSerializer.instance.serialize(days);
      Integer deserialized=SimpleDateSerializer.instance.deserialize(value);
      String toStringValue=SimpleDateSerializer.instance.toString(deserialized);
      if (!date.equals(toStringValue)) {
        badParseResults.add(String.format("Failed to parse date correctly.  Expected %s, got %s\n",date,toStringValue));
      }
    }
 catch (    MarshalException e) {
      System.err.println("Got an exception: " + e);
      unparsedDates.add(date);
    }
  }
  assert unparsedDates.isEmpty() : "Unable to parse: " + unparsedDates;
  assert badParseResults.isEmpty() : "Incorrect parse results: " + badParseResults;
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadDayToMonth(){
  Integer days=SimpleDateSerializer.dateStringToDays("1000-09-31");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testOutOfBoundsHigh(){
  Integer days=SimpleDateSerializer.dateStringToDays(new Date(Integer.MAX_VALUE * millisPerDay + millisPerDay).toString());
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadDay(){
  Integer days=SimpleDateSerializer.dateStringToDays("1000-12-32");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProlepticRange(){
  for (int i=1; i < 31; ++i) {
    String date="1582-10-";
    if (i < 10)     date+="0";
    date+=i;
    Integer days=SimpleDateSerializer.dateStringToDays(date);
    ByteBuffer value=SimpleDateType.instance.fromString(days.toString());
    Integer deserialized=SimpleDateSerializer.instance.deserialize(value);
    deserialized-=Integer.MIN_VALUE;
    Timestamp ts=new Timestamp(deserialized * millisPerDay);
    testCalendar.setTime(ts);
    Date newDate=testCalendar.getTime();
    assert (dateFormatUTC.format(newDate)).equals(date) : String.format("Expected [%s], got [%s]",date,dateFormatUTC.format(newDate).toString());
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadInput(){
  Integer days=SimpleDateSerializer.dateStringToDays("12A-01-01");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.serializers.TimeSerializerTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadNanoHigh(){
  Long time=TimeSerializer.timeStringToLong("23:59:59.1234567899");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testRawLongOverflow(){
  Long input=TimeUnit.DAYS.toNanos(1) + 1;
  Long time=TimeSerializer.timeStringToLong(input.toString());
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadNanoLow(){
  Long time=TimeSerializer.timeStringToLong("23:59:59.-123456789");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadHourHigh(){
  Long time=TimeSerializer.timeStringToLong("24:0:0.123456789");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadMinuteHigh(){
  Long time=TimeSerializer.timeStringToLong("23:60:0.123456789");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadSecondHighNoMilli(){
  Long time=TimeSerializer.timeStringToLong("23:59:60");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testNegativeLongTime(){
  Long time=TimeSerializer.timeStringToLong("-10");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadNanoCharacter(){
  Long time=TimeSerializer.timeStringToLong("23:59:59.12345A789");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialization(){
  String source="01:01:01.123123123";
  Long nt=TimeSerializer.timeStringToLong(source);
  ByteBuffer buf=TimeSerializer.instance.serialize(nt);
  TimeSerializer.instance.validate(buf);
  Long result=TimeSerializer.instance.deserialize(buf);
  String strResult=TimeSerializer.instance.toString(result);
  assert (strResult.equals(source));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadHourLow(){
  Long time=TimeSerializer.timeStringToLong("-1:0:0.123456789");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadSecondLow(){
  Long time=TimeSerializer.timeStringToLong("23:59:-1.123456789");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializerFromString(){
  long expected=5;
  Long time=TimeSerializer.timeStringToLong("00:00:00.000000005");
  assert time == expected : String.format("Failed nano conversion.  Expected %s, got %s",expected,time);
  expected=TimeUnit.MICROSECONDS.toNanos(123);
  time=TimeSerializer.timeStringToLong("00:00:00.000123000");
  assert time == expected : String.format("Failed usec conversion.  Expected %s, got %s",expected,time);
  expected=TimeUnit.MILLISECONDS.toNanos(123);
  time=TimeSerializer.timeStringToLong("00:00:00.123000");
  assert time == expected : String.format("Failed milli conversion.  Expected %s, got %s",expected,time);
  expected=TimeUnit.SECONDS.toNanos(15);
  time=TimeSerializer.timeStringToLong("00:00:15.000");
  assert time == expected : String.format("Failed sec conversion.  Expected %s, got %s",expected,time);
  expected=TimeUnit.MINUTES.toNanos(13);
  time=TimeSerializer.timeStringToLong("00:13:00.000");
  assert time == expected : String.format("Failed min conversion.  Expected %s, got %s",expected,time);
  expected=TimeUnit.HOURS.toNanos(2);
  time=TimeSerializer.timeStringToLong("02:0:00.000");
  assert time == expected : String.format("Failed min conversion.  Expected %s, got %s",expected,time);
  expected=buildExpected(4,31,12,123,456,789);
  time=TimeSerializer.timeStringToLong("4:31:12.123456789");
  assert time == expected : String.format("Failed complex conversion.  Expected %s, got %s",expected,time);
  expected=buildExpected(23,59,59,999,999,999);
  time=TimeSerializer.timeStringToLong("23:59:59.999999999");
  assert time == expected : String.format("Failed upper bounds conversion.  Expected %s, got %s",expected,time);
  expected=buildExpected(12,13,14,123,654,120);
  time=TimeSerializer.timeStringToLong("12:13:14.12365412");
  assert time == expected : String.format("Failed partial nano timestring.  Expected %s, got %s",expected,time);
  expected=10;
  time=TimeSerializer.timeStringToLong("10");
  assert time == expected : String.format("Failed long conversion.  Expected %s, got %s",expected,time);
  expected=0;
  time=TimeSerializer.timeStringToLong("0");
  assert time == expected : String.format("Failed long conversion.  Expected %s, got %s",expected,time);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerializerToString(){
  String source="00:00:00.000000011";
  Long time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="00:00:00.000012311";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="00:00:00.123000000";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="00:00:12.123450000";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="00:34:12.123450000";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="15:00:12.123450000";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="00:00:00.000000000";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="23:59:59.999999999";
  time=TimeSerializer.timeStringToLong(source);
  assert (source.equals(TimeSerializer.instance.toString(time)));
  source="01:14:18.12";
  time=TimeSerializer.timeStringToLong(source);
  String result=TimeSerializer.instance.toString(time);
  assert (result.equals("01:14:18.120000000"));
  source="01:14:18.1201";
  time=TimeSerializer.timeStringToLong(source);
  result=TimeSerializer.instance.toString(time);
  assert (result.equals("01:14:18.120100000"));
  source="01:14:18.1201098";
  time=TimeSerializer.timeStringToLong(source);
  result=TimeSerializer.instance.toString(time);
  assert (result.equals("01:14:18.120109800"));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadMinuteLow(){
  Long time=TimeSerializer.timeStringToLong("23:-1:0.123456789");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testEmpty(){
  Long time=TimeSerializer.timeStringToLong("");
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MarshalException.class) public void testBadSecondHigh(){
  Long time=TimeSerializer.timeStringToLong("23:59:60.123456789");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.ActiveRepairServiceTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testGetNeighborsSpecifiedHostsWithNoLocalHost() throws Throwable {
  addTokens(2 * Keyspace.open(KEYSPACE5).getReplicationStrategy().getReplicationFactor());
  Collection<String> hosts=Arrays.asList("127.0.0.3");
  ActiveRepairService.getNeighbors(KEYSPACE5,StorageService.instance.getLocalRanges(KEYSPACE5).iterator().next(),null,hosts);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.LeaveAndBootstrapTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemovingStatusForNonMember() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  Util.createInitialRing(ss,partitioner,new ArrayList<Token>(),new ArrayList<Token>(),new ArrayList<InetAddress>(),new ArrayList<UUID>(),1);
  ss.onChange(InetAddress.getByName("192.168.1.42"),ApplicationState.STATUS,valueFactory.removingNonlocal(UUID.randomUUID()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.MoveTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveWithPendingRangesForSimpleStrategyFourNode() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=4;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  ArrayList<Token> keyTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  List<UUID> hostIds=new ArrayList<>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  int MOVING_NODE=0;
  moveHost(hosts.get(MOVING_NODE),2,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),2,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  moveHost(hosts.get(MOVING_NODE),1500,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),1500,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1500,0,"127.0.0.1")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  moveHost(hosts.get(MOVING_NODE),15,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(10,15,"127.0.0.1"),generatePendingMapEntry(30,0,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(20,30,"127.0.0.2"),generatePendingMapEntry(10,15,"127.0.0.1"),generatePendingMapEntry(0,10,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(15,20,"127.0.0.2"),generatePendingMapEntry(0,10,"127.0.0.1")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),15,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,0,"127.0.0.1"),generatePendingMapEntry(10,15,"127.0.0.3")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(20,30,"127.0.0.1"),generatePendingMapEntry(10,15,"127.0.0.4"),generatePendingMapEntry(0,10,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(15,20,"127.0.0.1"),generatePendingMapEntry(0,10,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  moveHost(hosts.get(MOVING_NODE),26,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(20,26,"127.0.0.1"),generatePendingMapEntry(30,0,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(26,30,"127.0.0.2"),generatePendingMapEntry(30,0,"127.0.0.3"),generatePendingMapEntry(10,20,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,10,"127.0.0.1"),generatePendingMapEntry(26,30,"127.0.0.3")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),26,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(20,26,"127.0.0.4"),generatePendingMapEntry(30,0,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,0,"127.0.0.1"),generatePendingMapEntry(26,30,"127.0.0.1"),generatePendingMapEntry(10,20,"127.0.0.4")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(26,30,"127.0.0.1"),generatePendingMapEntry(0,10,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  MOVING_NODE=3;
  moveHost(hosts.get(MOVING_NODE),33,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.4")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.4")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),33,tmd);
  moveHost(hosts.get(MOVING_NODE),30,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.2")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,33,"127.0.0.3")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),30,tmd);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveWithPendingRangesNetworkStrategyRackAwareThirtyNodes() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=60;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  ArrayList<Token> keyTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  List<UUID> hostIds=new ArrayList<>();
  for (int i=0; i < RING_SIZE / 2; i++) {
    endpointTokens.add(new BigIntegerToken(String.valueOf(10 * i)));
    endpointTokens.add(new BigIntegerToken(String.valueOf((10 * i) + 1)));
  }
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  int MOVING_NODE=36;
  moveHost(hosts.get(MOVING_NODE),215,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(150,151,"127.0.0.43"),generatePendingMapEntry(151,160,"127.0.0.43"),generatePendingMapEntry(160,161,"127.0.0.43"),generatePendingMapEntry(161,170,"127.0.0.43"),generatePendingMapEntry(170,171,"127.0.0.43"),generatePendingMapEntry(171,180,"127.0.0.43"),generatePendingMapEntry(210,211,"127.0.0.37"),generatePendingMapEntry(211,215,"127.0.0.37")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),215,tmd);
  moveHost(hosts.get(MOVING_NODE),180,tmd,valueFactory);
  finishMove(hosts.get(MOVING_NODE),180,tmd);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveWithPendingRangesNetworkStrategyTenNode() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=14;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  ArrayList<Token> keyTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  List<UUID> hostIds=new ArrayList<>();
  for (int i=0; i < RING_SIZE / 2; i++) {
    endpointTokens.add(new BigIntegerToken(String.valueOf(10 * i)));
    endpointTokens.add(new BigIntegerToken(String.valueOf((10 * i) + 1)));
  }
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  int MOVING_NODE=0;
  moveHost(hosts.get(MOVING_NODE),5,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.1"),generatePendingMapEntry(1,5,"127.0.0.1")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.1"),generatePendingMapEntry(1,5,"127.0.0.1")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.1"),generatePendingMapEntry(1,5,"127.0.0.1")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),5,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.3"),generatePendingMapEntry(1,5,"127.0.0.3")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.5"),generatePendingMapEntry(1,5,"127.0.0.5")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,1,"127.0.0.7"),generatePendingMapEntry(1,5,"127.0.0.7")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  MOVING_NODE=1;
  moveHost(hosts.get(MOVING_NODE),5,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.2")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.2")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.2")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),5,tmd);
  moveHost(hosts.get(MOVING_NODE),1,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.4")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.6")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,5,"127.0.0.8")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),1,tmd);
  MOVING_NODE=3;
  moveHost(hosts.get(MOVING_NODE),25,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,10,"127.0.0.6"),generatePendingMapEntry(10,11,"127.0.0.6"),generatePendingMapEntry(21,25,"127.0.0.4")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(61,0,"127.0.0.6"),generatePendingMapEntry(0,1,"127.0.0.6"),generatePendingMapEntry(21,25,"127.0.0.4"),generatePendingMapEntry(11,20,"127.0.0.4"),generatePendingMapEntry(20,21,"127.0.0.4")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(51,60,"127.0.0.6"),generatePendingMapEntry(60,61,"127.0.0.6"),generatePendingMapEntry(21,25,"127.0.0.4"),generatePendingMapEntry(11,20,"127.0.0.4"),generatePendingMapEntry(20,21,"127.0.0.4")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),25,tmd);
  moveHost(hosts.get(MOVING_NODE),11,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1,10,"127.0.0.4"),generatePendingMapEntry(10,11,"127.0.0.4"),generatePendingMapEntry(21,25,"127.0.0.8")),Network_11_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(61,0,"127.0.0.4"),generatePendingMapEntry(0,1,"127.0.0.4"),generatePendingMapEntry(11,20,"127.0.0.8"),generatePendingMapEntry(20,21,"127.0.0.8"),generatePendingMapEntry(21,25,"127.0.0.10")),Network_22_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(51,60,"127.0.0.4"),generatePendingMapEntry(60,61,"127.0.0.4"),generatePendingMapEntry(21,25,"127.0.0.12"),generatePendingMapEntry(11,20,"127.0.0.10"),generatePendingMapEntry(20,21,"127.0.0.10")),Network_33_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),11,tmd);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveWithPendingRangesSimpleStrategyTenNode() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  ArrayList<Token> keyTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  List<UUID> hostIds=new ArrayList<>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  final int MOVING_NODE=0;
  moveHost(hosts.get(MOVING_NODE),2,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.1")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),2,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(0,2,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  moveHost(hosts.get(MOVING_NODE),1000,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.4")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),1000,tmd);
  moveHost(hosts.get(MOVING_NODE),0,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.1")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.1")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(1000,0,"127.0.0.1")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),0,tmd);
  moveHost(hosts.get(MOVING_NODE),35,tmd,valueFactory);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,35,"127.0.0.1"),generatePendingMapEntry(90,0,"127.0.0.2")),Simple_RF1_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,35,"127.0.0.1"),generatePendingMapEntry(20,30,"127.0.0.1"),generatePendingMapEntry(80,90,"127.0.0.2"),generatePendingMapEntry(90,0,"127.0.0.3")),Simple_RF2_KeyspaceName);
  assertPendingRanges(tmd,generatePendingRanges(generatePendingMapEntry(30,35,"127.0.0.1"),generatePendingMapEntry(20,30,"127.0.0.1"),generatePendingMapEntry(80,90,"127.0.0.3"),generatePendingMapEntry(90,0,"127.0.0.4"),generatePendingMapEntry(10,20,"127.0.0.1"),generatePendingMapEntry(70,80,"127.0.0.2")),Simple_RF3_KeyspaceName);
  finishMove(hosts.get(MOVING_NODE),35,tmd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.PaxosStateTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommittingAfterTruncation() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open("PaxosStateTestKeyspace1").getColumnFamilyStore("Standard1");
  String key="key" + System.nanoTime();
  ByteBuffer value=ByteBufferUtil.bytes(0);
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros(),key);
  builder.clustering("a").add("val",value);
  PartitionUpdate update=Iterables.getOnlyElement(builder.build().getPartitionUpdates());
  assertNoDataPresent(cfs,Util.dk(key));
  Commit beforeTruncate=newProposal(0,update);
  PaxosState.commit(beforeTruncate);
  assertDataPresent(cfs,Util.dk(key),"val",value);
  cfs.truncateBlocking();
  PaxosState.commit(beforeTruncate);
  assertNoDataPresent(cfs,Util.dk(key));
  long timestamp=SystemKeyspace.getTruncatedAt(update.metadata().cfId) + 1;
  Commit afterTruncate=newProposal(timestamp,update);
  PaxosState.commit(afterTruncate);
  assertDataPresent(cfs,Util.dk(key),"val",value);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.QueryPagerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void reversedSliceQueryTest() throws Exception {
  reversedSliceQueryTest(false,Server.VERSION_3);
  reversedSliceQueryTest(true,Server.VERSION_4);
  reversedSliceQueryTest(false,Server.VERSION_3);
  reversedSliceQueryTest(true,Server.VERSION_4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rangeNamesQueryTest() throws Exception {
  rangeNamesQueryTest(false,Server.VERSION_3);
  rangeNamesQueryTest(true,Server.VERSION_4);
  rangeNamesQueryTest(false,Server.VERSION_3);
  rangeNamesQueryTest(true,Server.VERSION_4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void multiQueryTest() throws Exception {
  multiQueryTest(false,Server.VERSION_3);
  multiQueryTest(true,Server.VERSION_4);
  multiQueryTest(false,Server.VERSION_3);
  multiQueryTest(true,Server.VERSION_4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void SliceQueryWithTombstoneTest() throws Exception {
  String keyspace="cql_keyspace";
  String table="table2";
  ColumnFamilyStore cfs=Keyspace.open(keyspace).getColumnFamilyStore(table);
  for (int i=0; i < 5; i++)   executeInternal(String.format("INSERT INTO %s.%s (k, c, v) VALUES ('k%d', 'c%d', null)",keyspace,table,0,i));
  ReadCommand command=SinglePartitionReadCommand.create(cfs.metadata,nowInSec,Util.dk("k0"),Slice.ALL);
  QueryPager pager=command.getPager(null,Server.CURRENT_VERSION);
  for (int i=0; i < 5; i++) {
    List<FilteredPartition> partitions=query(pager,1);
    assertRow(partitions.get(0),"k0","c" + i);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sliceQueryTest() throws Exception {
  sliceQueryTest(false,Server.VERSION_3);
  sliceQueryTest(true,Server.VERSION_4);
  sliceQueryTest(false,Server.VERSION_3);
  sliceQueryTest(true,Server.VERSION_4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rangeSliceQueryTest() throws Exception {
  rangeSliceQueryTest(false,Server.VERSION_3);
  rangeSliceQueryTest(true,Server.VERSION_4);
  rangeSliceQueryTest(false,Server.VERSION_3);
  rangeSliceQueryTest(true,Server.VERSION_4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.RemoveTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testLocalHostId(){
  ss.removeNode(hostIds.get(0).toString());
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testNonmemberId(){
  VersionedValueFactory valueFactory=new VersionedValueFactory(DatabaseDescriptor.getPartitioner());
  Collection<Token> tokens=Collections.singleton(DatabaseDescriptor.getPartitioner().getRandomToken());
  InetAddress joininghost=hosts.get(4);
  UUID joiningId=hostIds.get(4);
  hosts.remove(joininghost);
  hostIds.remove(joiningId);
  Gossiper.instance.injectApplicationState(joininghost,ApplicationState.TOKENS,valueFactory.tokens(tokens));
  ss.onChange(joininghost,ApplicationState.STATUS,valueFactory.bootstrapping(tokens));
  ss.removeNode(joiningId.toString());
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testBadHostId(){
  ss.removeNode("ffffffff-aaaa-aaaa-aaaa-ffffffffffff");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.SerializationsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidationRequestRead() throws IOException {
  if (EXECUTE_WRITES)   testValidationRequestWrite();
  try (DataInputStreamPlus in=getInput("service.ValidationRequest.bin")){
    RepairMessage message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.VALIDATION_REQUEST;
    assert DESC.equals(message.desc);
    assert ((ValidationRequest)message).gcBefore == 1234;
    assert MessageIn.read(in,getVersion(),-1) != null;
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidationCompleteRead() throws IOException {
  if (EXECUTE_WRITES)   testValidationCompleteWrite();
  try (DataInputStreamPlus in=getInput("service.ValidationComplete.bin")){
    RepairMessage message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.VALIDATION_COMPLETE;
    assert DESC.equals(message.desc);
    assert ((ValidationComplete)message).success();
    assert ((ValidationComplete)message).trees != null;
    message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.VALIDATION_COMPLETE;
    assert DESC.equals(message.desc);
    assert ((ValidationComplete)message).success();
    assert ((ValidationComplete)message).trees != null;
    message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.VALIDATION_COMPLETE;
    assert DESC.equals(message.desc);
    assert !((ValidationComplete)message).success();
    assert ((ValidationComplete)message).trees == null;
    for (int i=0; i < 3; i++)     assert MessageIn.read(in,getVersion(),-1) != null;
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyncCompleteRead() throws IOException {
  if (EXECUTE_WRITES)   testSyncCompleteWrite();
  InetAddress src=InetAddress.getByAddress(new byte[]{127,0,0,2});
  InetAddress dest=InetAddress.getByAddress(new byte[]{127,0,0,3});
  NodePair nodes=new NodePair(src,dest);
  try (DataInputStreamPlus in=getInput("service.SyncComplete.bin")){
    RepairMessage message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.SYNC_COMPLETE;
    assert DESC.equals(message.desc);
    assert nodes.equals(((SyncComplete)message).nodes);
    assert ((SyncComplete)message).success;
    message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.SYNC_COMPLETE;
    assert DESC.equals(message.desc);
    assert nodes.equals(((SyncComplete)message).nodes);
    assert !((SyncComplete)message).success;
    for (int i=0; i < 2; i++)     assert MessageIn.read(in,getVersion(),-1) != null;
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyncRequestRead() throws IOException {
  if (EXECUTE_WRITES)   testSyncRequestWrite();
  InetAddress local=InetAddress.getByAddress(new byte[]{127,0,0,1});
  InetAddress src=InetAddress.getByAddress(new byte[]{127,0,0,2});
  InetAddress dest=InetAddress.getByAddress(new byte[]{127,0,0,3});
  try (DataInputStreamPlus in=getInput("service.SyncRequest.bin")){
    RepairMessage message=RepairMessage.serializer.deserialize(in,getVersion());
    assert message.messageType == RepairMessage.Type.SYNC_REQUEST;
    assert DESC.equals(message.desc);
    assert local.equals(((SyncRequest)message).initiator);
    assert src.equals(((SyncRequest)message).src);
    assert dest.equals(((SyncRequest)message).dst);
    assert ((SyncRequest)message).ranges.size() == 1 && ((SyncRequest)message).ranges.contains(FULL_RANGE);
    assert MessageIn.read(in,getVersion(),-1) != null;
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StartupChecksTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void failStartupIfInvalidSSTablesFound() throws Exception {
  startupChecks=startupChecks.withTest(StartupChecks.checkSSTablesFormat);
  copyInvalidLegacySSTables(sstableDir);
  verifyFailure(startupChecks,"Detected unreadable sstables");
  FileUtils.deleteRecursive(sstableDir.toFile());
  Path snapshotDir=sstableDir.resolve("snapshots");
  Files.createDirectories(snapshotDir);
  copyInvalidLegacySSTables(snapshotDir);
  startupChecks.verify();
  FileUtils.deleteRecursive(sstableDir.toFile());
  Path backupDir=sstableDir.resolve("backups");
  Files.createDirectories(backupDir);
  copyInvalidLegacySSTables(backupDir);
  startupChecks.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StorageProxyTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGRRExact() throws Throwable {
  testGRR(tokenRange("1","5"),tokenRange("1","5"));
  testGRR(tokenBounds("1","5"),tokenBounds("1","1"),tokenRange("1","5"));
  testGRR(tokenRange("2","6"),tokenRange("2","6"));
  testGRR(tokenBounds("2","6"),tokenBounds("2","6"));
  testGRR(tokenRange("1","6"),tokenRange("1","6"));
  testGRR(tokenBounds("1","6"),tokenBounds("1","1"),tokenRange("1","6"));
  testGRRKeys(range(endOf("1"),endOf("5")),range(endOf("1"),endOf("5")));
  testGRRKeys(range(rp("1"),endOf("5")),range(rp("1"),endOf("1")),range(endOf("1"),endOf("5")));
  testGRRKeys(bounds(startOf("1"),endOf("5")),bounds(startOf("1"),endOf("1")),range(endOf("1"),endOf("5")));
  testGRRKeys(exBounds(endOf("1"),rp("5")),exBounds(endOf("1"),rp("5")));
  testGRRKeys(exBounds(rp("1"),rp("5")),range(rp("1"),endOf("1")),exBounds(endOf("1"),rp("5")));
  testGRRKeys(exBounds(startOf("1"),endOf("5")),range(startOf("1"),endOf("1")),exBounds(endOf("1"),endOf("5")));
  testGRRKeys(incExBounds(rp("1"),rp("5")),bounds(rp("1"),endOf("1")),exBounds(endOf("1"),rp("5")));
  testGRRKeys(range(endOf("2"),endOf("6")),range(endOf("2"),endOf("6")));
  testGRRKeys(bounds(startOf("2"),endOf("6")),bounds(startOf("2"),endOf("6")));
  testGRRKeys(exBounds(rp("2"),rp("6")),exBounds(rp("2"),rp("6")));
  testGRRKeys(incExBounds(rp("2"),rp("6")),incExBounds(rp("2"),rp("6")));
  testGRRKeys(range(rp("1"),rp("6")),range(rp("1"),endOf("1")),range(endOf("1"),rp("6")));
  testGRRKeys(bounds(rp("1"),rp("6")),bounds(rp("1"),endOf("1")),range(endOf("1"),rp("6")));
  testGRRKeys(exBounds(rp("1"),rp("6")),range(rp("1"),endOf("1")),exBounds(endOf("1"),rp("6")));
  testGRRKeys(incExBounds(rp("1"),rp("6")),bounds(rp("1"),endOf("1")),exBounds(endOf("1"),rp("6")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGRRWrapped() throws Throwable {
  testGRR(tokenRange("7","0"),tokenRange("7",""),tokenRange("","0"));
  testGRR(tokenRange("5","0"),tokenRange("5","6"),tokenRange("6",""),tokenRange("","0"));
  testGRR(tokenRange("7","2"),tokenRange("7",""),tokenRange("","1"),tokenRange("1","2"));
  testGRR(tokenRange("0","0"),tokenRange("0","1"),tokenRange("1","6"),tokenRange("6",""),tokenRange("","0"));
  testGRR(tokenRange("",""),tokenRange("","1"),tokenRange("1","6"),tokenRange("6",""));
  testGRR(tokenRange("6","6"),tokenRange("6",""),tokenRange("","1"),tokenRange("1","6"));
  testGRR(tokenRange("6","1"),tokenRange("6",""),tokenRange("","1"));
  testGRR(tokenRange("5",""),tokenRange("5","6"),tokenRange("6",""));
  testGRRKeys(range(rp("7"),rp("0")),range(rp("7"),rp("")),range(rp(""),rp("0")));
  testGRRKeys(range(rp("5"),rp("0")),range(rp("5"),endOf("6")),range(endOf("6"),rp("")),range(rp(""),rp("0")));
  testGRRKeys(range(rp("7"),rp("2")),range(rp("7"),rp("")),range(rp(""),endOf("1")),range(endOf("1"),rp("2")));
  testGRRKeys(range(rp("0"),rp("0")),range(rp("0"),endOf("1")),range(endOf("1"),endOf("6")),range(endOf("6"),rp("")),range(rp(""),rp("0")));
  testGRRKeys(range(rp(""),rp("")),range(rp(""),endOf("1")),range(endOf("1"),endOf("6")),range(endOf("6"),rp("")));
  testGRRKeys(range(rp("6"),rp("6")),range(rp("6"),endOf("6")),range(endOf("6"),rp("")),range(rp(""),endOf("1")),range(endOf("1"),rp("6")));
  testGRRKeys(range(rp("6"),rp("1")),range(rp("6"),endOf("6")),range(endOf("6"),rp("")),range(rp(""),rp("1")));
  testGRRKeys(range(rp("5"),rp("")),range(rp("5"),endOf("6")),range(endOf("6"),rp("")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGRRExactBounds() throws Throwable {
  testGRR(tokenBounds("0","0"),tokenBounds("0","0"));
  testGRR(tokenBounds("",""),tokenBounds("","1"),tokenRange("1","6"),tokenRange("6",""));
  testGRRKeys(bounds(rp("0"),rp("0")),bounds(rp("0"),rp("0")));
  testGRRKeys(bounds(rp(""),rp("")),bounds(rp(""),endOf("1")),range(endOf("1"),endOf("6")),range(endOf("6"),rp("")));
  testGRRKeys(exBounds(rp(""),rp("")),range(rp(""),endOf("1")),range(endOf("1"),endOf("6")),exBounds(endOf("6"),rp("")));
  testGRRKeys(incExBounds(rp(""),rp("")),bounds(rp(""),endOf("1")),range(endOf("1"),endOf("6")),exBounds(endOf("6"),rp("")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGRR() throws Throwable {
  testGRR(tokenRange("2","5"),tokenRange("2","5"));
  testGRR(tokenBounds("2","5"),tokenBounds("2","5"));
  testGRR(tokenRange("2","7"),tokenRange("2","6"),tokenRange("6","7"));
  testGRR(tokenBounds("2","7"),tokenBounds("2","6"),tokenRange("6","7"));
  testGRR(tokenRange("","2"),tokenRange("","1"),tokenRange("1","2"));
  testGRR(tokenBounds("","2"),tokenBounds("","1"),tokenRange("1","2"));
  testGRR(tokenRange("5",""),tokenRange("5","6"),tokenRange("6",""));
  testGRR(tokenBounds("5",""),tokenBounds("5","6"),tokenRange("6",""));
  testGRR(tokenRange("0","7"),tokenRange("0","1"),tokenRange("1","6"),tokenRange("6","7"));
  testGRR(tokenBounds("0","7"),tokenBounds("0","1"),tokenRange("1","6"),tokenRange("6","7"));
  testGRRKeys(range(rp("2"),rp("5")),range(rp("2"),rp("5")));
  testGRRKeys(bounds(rp("2"),rp("5")),bounds(rp("2"),rp("5")));
  testGRRKeys(exBounds(rp("2"),rp("5")),exBounds(rp("2"),rp("5")));
  testGRRKeys(bounds(rp("2"),rp("7")),bounds(rp("2"),endOf("6")),range(endOf("6"),rp("7")));
  testGRRKeys(exBounds(rp("2"),rp("7")),range(rp("2"),endOf("6")),exBounds(endOf("6"),rp("7")));
  testGRRKeys(incExBounds(rp("2"),rp("7")),bounds(rp("2"),endOf("6")),exBounds(endOf("6"),rp("7")));
  testGRRKeys(range(rp(""),rp("2")),range(rp(""),endOf("1")),range(endOf("1"),rp("2")));
  testGRRKeys(bounds(rp(""),rp("2")),bounds(rp(""),endOf("1")),range(endOf("1"),rp("2")));
  testGRRKeys(exBounds(rp(""),rp("2")),range(rp(""),endOf("1")),exBounds(endOf("1"),rp("2")));
  testGRRKeys(incExBounds(rp(""),rp("2")),bounds(rp(""),endOf("1")),exBounds(endOf("1"),rp("2")));
  testGRRKeys(range(rp("5"),rp("")),range(rp("5"),endOf("6")),range(endOf("6"),rp("")));
  testGRRKeys(bounds(rp("5"),rp("")),bounds(rp("5"),endOf("6")),range(endOf("6"),rp("")));
  testGRRKeys(exBounds(rp("5"),rp("")),range(rp("5"),endOf("6")),exBounds(endOf("6"),rp("")));
  testGRRKeys(incExBounds(rp("5"),rp("")),bounds(rp("5"),endOf("6")),exBounds(endOf("6"),rp("")));
  testGRRKeys(range(rp("0"),rp("7")),range(rp("0"),endOf("1")),range(endOf("1"),endOf("6")),range(endOf("6"),rp("7")));
  testGRRKeys(bounds(rp("0"),rp("7")),bounds(rp("0"),endOf("1")),range(endOf("1"),endOf("6")),range(endOf("6"),rp("7")));
  testGRRKeys(exBounds(rp("0"),rp("7")),range(rp("0"),endOf("1")),range(endOf("1"),endOf("6")),exBounds(endOf("6"),rp("7")));
  testGRRKeys(incExBounds(rp("0"),rp("7")),bounds(rp("0"),endOf("1")),range(endOf("1"),endOf("6")),exBounds(endOf("6"),rp("7")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StorageServiceServerTest </h4><pre class="type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnapshotFailureHandler() throws IOException {
  assumeTrue(FBUtilities.isWindows());
  WindowsFailedSnapshotTracker.deleteOldSnapshots();
  File f=new File(System.getenv("TEMP") + File.separator + Integer.toString(new Random().nextInt()));
  f.mkdir();
  f.deleteOnExit();
  for (int i=0; i < 5; i++) {
    File subdir=new File(f,Integer.toString(i));
    subdir.mkdir();
    for (int j=0; j < 5; j++)     new File(subdir,Integer.toString(j)).createNewFile();
  }
  checkTempFilePresence(f,true);
  for (int i=0; i < 5; i++)   WindowsFailedSnapshotTracker.handleFailedSnapshot(new File(f,Integer.toString(i)));
  assert new File(WindowsFailedSnapshotTracker.TODELETEFILE).exists();
  WindowsFailedSnapshotTracker.resetForTests();
  WindowsFailedSnapshotTracker.deleteOldSnapshots();
  checkTempFilePresence(f,false);
  WindowsFailedSnapshotTracker.resetForTests();
  PrintWriter tempPrinter=new PrintWriter(new FileWriter(WindowsFailedSnapshotTracker.TODELETEFILE,true));
  tempPrinter.println(".safeDir");
  tempPrinter.close();
  File protectedDir=new File(".safeDir");
  protectedDir.mkdir();
  File protectedFile=new File(protectedDir,".safeFile");
  protectedFile.createNewFile();
  WindowsFailedSnapshotTracker.handleFailedSnapshot(protectedDir);
  WindowsFailedSnapshotTracker.deleteOldSnapshots();
  assert protectedDir.exists();
  assert protectedFile.exists();
  protectedFile.delete();
  protectedDir.delete();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateRepairRangeFrom() throws Exception {
  StorageService.instance.setPartitionerUnsafe(Murmur3Partitioner.instance);
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new LongToken(1000L),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new LongToken(2000L),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new LongToken(3000L),InetAddress.getByName("127.0.0.3"));
  metadata.updateNormalToken(new LongToken(4000L),InetAddress.getByName("127.0.0.4"));
  Collection<Range<Token>> repairRangeFrom=StorageService.instance.createRepairRangeFrom("1500","3700");
  assert repairRangeFrom.size() == 3;
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(1500L),new LongToken(2000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(2000L),new LongToken(3000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(3000L),new LongToken(3700L)));
  repairRangeFrom=StorageService.instance.createRepairRangeFrom("500","700");
  assert repairRangeFrom.size() == 1;
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(500L),new LongToken(700L)));
  repairRangeFrom=StorageService.instance.createRepairRangeFrom("500","1700");
  assert repairRangeFrom.size() == 2;
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(500L),new LongToken(1000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(1000L),new LongToken(1700L)));
  repairRangeFrom=StorageService.instance.createRepairRangeFrom("2500","2300");
  assert repairRangeFrom.size() == 5;
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(2500L),new LongToken(3000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(3000L),new LongToken(4000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(4000L),new LongToken(1000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(1000L),new LongToken(2000L)));
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(2000L),new LongToken(2300L)));
  repairRangeFrom=StorageService.instance.createRepairRangeFrom("2000","3000");
  assert repairRangeFrom.size() == 1;
  assert repairRangeFrom.contains(new Range<Token>(new LongToken(2000L),new LongToken(3000L)));
  repairRangeFrom=StorageService.instance.createRepairRangeFrom("2000","2000");
  assert repairRangeFrom.size() == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnapshotWithFlush() throws IOException {
  StorageService.instance.takeSnapshot(UUID.randomUUID().toString());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryRangesWithSimpleStrategy() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.3"));
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.simpleTransient(2));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.1"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("A")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.2"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.3"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryRangesWithVnodes() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  Multimap<InetAddress,Token> dc1=HashMultimap.create();
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("A"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("E"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("H"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("C"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("I"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("J"));
  metadata.updateNormalTokens(dc1);
  Multimap<InetAddress,Token> dc2=HashMultimap.create();
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("B"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("G"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("L"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("D"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("F"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("K"));
  metadata.updateNormalTokens(dc2);
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.1"));
  assert primaryRanges.isEmpty();
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.2"));
  assert primaryRanges.isEmpty();
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.4"));
  assert primaryRanges.size() == 4;
  assert primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("F"),new StringToken("G")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("K"),new StringToken("L")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("L"),new StringToken("A")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.5"));
  assert primaryRanges.size() == 8;
  assert primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("E"),new StringToken("F")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("J"),new StringToken("K")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("E")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("G"),new StringToken("H")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("H"),new StringToken("I")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("I"),new StringToken("J")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryRangesWithNetworkTopologyStrategyOneDCOnly() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.1"));
  assert primaryRanges.isEmpty();
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.2"));
  assert primaryRanges.isEmpty();
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.4"));
  assert primaryRanges.size() == 2;
  assert primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.5"));
  assert primaryRanges.size() == 2;
  assert primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D")));
  assert primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableSnapshot() throws IOException {
  StorageService.instance.takeTableSnapshot(SchemaKeyspace.NAME,SchemaKeyspace.KEYSPACES,UUID.randomUUID().toString());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnapshot() throws IOException {
  StorageService.instance.takeSnapshot(UUID.randomUUID().toString(),SchemaKeyspace.NAME);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithSimpleStrategy() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.3"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("replication_factor","2");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.simpleTransient(2));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("A")));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B")));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.3"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C")));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrimaryRangesWithNetworkTopologyStrategy() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC1","1");
  configOptions.put("DC2","1");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.1"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.2"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.4"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B")));
  primaryRanges=StorageService.instance.getPrimaryRangesForEndpoint(meta.name,InetAddress.getByName("127.0.0.5"));
  assert primaryRanges.size() == 1;
  assert primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.SessionInfoTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test if total numbers are collect
 */
@Test public void testTotals(){
  UUID cfId=UUID.randomUUID();
  InetAddress local=FBUtilities.getLocalAddress();
  Collection<StreamSummary> summaries=new ArrayList<>();
  for (int i=0; i < 10; i++) {
    StreamSummary summary=new StreamSummary(cfId,i,(i + 1) * 10);
    summaries.add(summary);
  }
  StreamSummary sending=new StreamSummary(cfId,10,100);
  SessionInfo info=new SessionInfo(local,0,local,summaries,Collections.singleton(sending),StreamSession.State.PREPARING);
  assert info.getTotalFilesToReceive() == 45;
  assert info.getTotalFilesToSend() == 10;
  assert info.getTotalSizeToReceive() == 550;
  assert info.getTotalSizeToSend() == 100;
  assert info.getTotalFilesReceived() == 0;
  assert info.getTotalFilesSent() == 0;
  info.updateProgress(new ProgressInfo(local,0,"test.txt",ProgressInfo.Direction.IN,50,100));
  assert info.getTotalSizeReceived() == 50;
  assert info.getTotalSizeSent() == 0;
  assert info.getTotalFilesReceived() == 0;
  assert info.getTotalFilesSent() == 0;
  info.updateProgress(new ProgressInfo(local,0,"test.txt",ProgressInfo.Direction.IN,100,100));
  assert info.getTotalSizeReceived() == 100;
  assert info.getTotalSizeSent() == 0;
  assert info.getTotalFilesReceived() == 1;
  assert info.getTotalFilesSent() == 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamingTransferTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTransferTableViaRanges() throws Exception {
  doTransferTable(false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTransferTableViaSSTables() throws Exception {
  doTransferTable(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRequestEmpty() throws Exception {
  IPartitioner p=Util.testPartitioner();
  List<Range<Token>> ranges=new ArrayList<>();
  ranges.add(new Range<>(p.getMinimumToken(),p.getToken(ByteBufferUtil.bytes("key1"))));
  ranges.add(new Range<>(p.getToken(ByteBufferUtil.bytes("key2")),p.getMinimumToken()));
  StreamResultFuture futureResult=new StreamPlan("StreamingTransferTest").requestRanges(LOCAL,LOCAL,KEYSPACE2,ranges).execute();
  UUID planId=futureResult.planId;
  StreamState result=futureResult.get();
  assert planId.equals(result.planId);
  assert result.description.equals("StreamingTransferTest");
  assert result.sessions.size() == 1;
  SessionInfo session=Iterables.get(result.sessions,0);
  assert session.peer.equals(LOCAL);
  assert session.getTotalFilesReceived() == 0;
  assert session.getTotalFilesSent() == 0;
  assert session.getTotalSizeReceived() == 0;
  assert session.getTotalSizeSent() == 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.compression.CompressedInputStreamTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompressedRead() throws Exception {
  testCompressedReadWith(new long[]{0L},false);
  testCompressedReadWith(new long[]{1L},false);
  testCompressedReadWith(new long[]{100L},false);
  testCompressedReadWith(new long[]{1L,122L,123L,124L,456L},false);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=EOFException.class) public void testTruncatedRead() throws Exception {
  testCompressedReadWith(new long[]{1L,122L,123L,124L,456L},true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.DataTypeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDataTypeSerialization(){
  DataType type=DataType.MAP;
  List<AbstractType> value=new ArrayList<>();
  value.add(LongType.instance);
  value.add(AsciiType.instance);
  Map<DataType,Object> options=Collections.singletonMap(type,(Object)value);
  for (int version=1; version < 5; version++)   testEncodeDecode(type,options,version);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestListDataTypeSerialization(){
  DataType type=DataType.LIST;
  Map<DataType,Object> options=Collections.singletonMap(type,(Object)LongType.instance);
  for (int version=1; version < 5; version++)   testEncodeDecode(type,options,version);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestSimpleDataTypeSerialization(){
  for (  DataType type : DataType.values()) {
    if (isComplexType(type))     continue;
    Map<DataType,Object> options=Collections.singletonMap(type,(Object)type.toString());
    for (int version=1; version < 5; version++)     testEncodeDecode(type,options,version);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.ProtocolErrorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalidProtocolVersion() throws Exception {
  testInvalidProtocolVersion(Server.CURRENT_VERSION + 1);
  testInvalidProtocolVersion(Server.MIN_SUPPORTED_VERSION - 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.SerDeserTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void udtSerDeserTest() throws Exception {
  udtSerDeserTest(3);
  udtSerDeserTest(4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void eventSerDeserTest() throws Exception {
  eventSerDeserTest(3);
  eventSerDeserTest(4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void collectionSerDeserTest() throws Exception {
  collectionSerDeserTest(3);
  collectionSerDeserTest(4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggerExecutorTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidRequestException.class) public void sameKeyDifferentCfColumnFamilies() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeyDifferentCfTrigger.class.getName()));
  TriggerExecutor.instance.execute(makeCf(metadata,"k1","v1",null));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidRequestException.class) public void differentKeyColumnFamilies() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",DifferentKeyTrigger.class.getName()));
  TriggerExecutor.instance.execute(makeCf(metadata,"k1","v1",null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggersTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnThriftInsert() throws Exception {
  Cassandra.Client client=new Cassandra.Client(new TBinaryProtocol(new TFramedTransportFactory().openTransport(InetAddress.getLocalHost().getHostName(),9170)));
  client.set_keyspace(ksName);
  client.insert(bytes(2),new ColumnParent(cfName),getColumnForInsert("v1",2),org.apache.cassandra.thrift.ConsistencyLevel.ONE);
  assertUpdateIsAugmented(2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnCqlInsert() throws Exception {
  String cql=String.format("INSERT INTO %s.%s (k, v1) VALUES (0, 0)",ksName,cfName);
  QueryProcessor.process(cql,ConsistencyLevel.ONE);
  assertUpdateIsAugmented(0);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnCqlBatchInsert() throws Exception {
  String cql=String.format("BEGIN BATCH " + "    INSERT INTO %s.%s (k, v1) VALUES (1, 1); " + "APPLY BATCH",ksName,cfName);
  QueryProcessor.process(cql,ConsistencyLevel.ONE);
  assertUpdateIsAugmented(1);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void onCqlUpdateWithConditionsRejectGeneratedUpdatesForDifferentTable() throws Exception {
  String cf="cf" + System.nanoTime();
  try {
    setupTableWithTrigger(cf,CrossTableTrigger.class);
    String cql=String.format("INSERT INTO %s.%s (k, v1) VALUES (8, 8) IF NOT EXISTS",ksName,cf);
    QueryProcessor.process(cql,ConsistencyLevel.ONE);
  }
  finally {
    assertUpdateNotExecuted(cf,7);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnThriftBatchUpdate() throws Exception {
  Cassandra.Client client=new Cassandra.Client(new TBinaryProtocol(new TFramedTransportFactory().openTransport(InetAddress.getLocalHost().getHostName(),9170)));
  client.set_keyspace(ksName);
  org.apache.cassandra.thrift.Mutation mutation=new org.apache.cassandra.thrift.Mutation();
  ColumnOrSuperColumn cosc=new ColumnOrSuperColumn();
  cosc.setColumn(getColumnForInsert("v1",3));
  mutation.setColumn_or_supercolumn(cosc);
  client.batch_mutate(Collections.singletonMap(bytes(3),Collections.singletonMap(cfName,Collections.singletonList(mutation))),org.apache.cassandra.thrift.ConsistencyLevel.ONE);
  assertUpdateIsAugmented(3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnThriftCASOperation() throws Exception {
  Cassandra.Client client=new Cassandra.Client(new TBinaryProtocol(new TFramedTransportFactory().openTransport(InetAddress.getLocalHost().getHostName(),9170)));
  client.set_keyspace(ksName);
  client.cas(bytes(6),cfName,Collections.<Column>emptyList(),Collections.singletonList(getColumnForInsert("v1",6)),org.apache.cassandra.thrift.ConsistencyLevel.LOCAL_SERIAL,org.apache.cassandra.thrift.ConsistencyLevel.ONE);
  assertUpdateIsAugmented(6);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void onCqlUpdateWithConditionsRejectGeneratedUpdatesForDifferentPartition() throws Exception {
  String cf="cf" + System.nanoTime();
  try {
    setupTableWithTrigger(cf,CrossPartitionTrigger.class);
    String cql=String.format("INSERT INTO %s.%s (k, v1) VALUES (7, 7) IF NOT EXISTS",ksName,cf);
    QueryProcessor.process(cql,ConsistencyLevel.ONE);
  }
  finally {
    assertUpdateNotExecuted(cf,7);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnCqlInsertWithConditions() throws Exception {
  String cql=String.format("INSERT INTO %s.%s (k, v1) VALUES (4, 4) IF NOT EXISTS",ksName,cfName);
  QueryProcessor.process(cql,ConsistencyLevel.ONE);
  assertUpdateIsAugmented(4);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void executeTriggerOnCqlBatchWithConditions() throws Exception {
  String cql=String.format("BEGIN BATCH " + "  INSERT INTO %1$s.%2$s (k, v1) VALUES (5, 5) IF NOT EXISTS; " + "  INSERT INTO %1$s.%2$s (k, v1) VALUES (5, 5); "+ "APPLY BATCH",ksName,cfName);
  QueryProcessor.process(cql,ConsistencyLevel.ONE);
  assertUpdateIsAugmented(5);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidRequestException.class) public void onThriftCASRejectGeneratedUpdatesForDifferentCF() throws Exception {
  String cf="cf" + System.nanoTime();
  try {
    setupTableWithTrigger(cf,CrossTableTrigger.class);
    Cassandra.Client client=new Cassandra.Client(new TBinaryProtocol(new TFramedTransportFactory().openTransport(InetAddress.getLocalHost().getHostName(),9170)));
    client.set_keyspace(ksName);
    client.cas(bytes(10),cf,Collections.<Column>emptyList(),Collections.singletonList(getColumnForInsert("v1",10)),org.apache.cassandra.thrift.ConsistencyLevel.LOCAL_SERIAL,org.apache.cassandra.thrift.ConsistencyLevel.ONE);
  }
  finally {
    assertUpdateNotExecuted(cf,10);
  }
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidRequestException.class) public void onThriftCASRejectGeneratedUpdatesForDifferentPartition() throws Exception {
  String cf="cf" + System.nanoTime();
  try {
    setupTableWithTrigger(cf,CrossPartitionTrigger.class);
    Cassandra.Client client=new Cassandra.Client(new TBinaryProtocol(new TFramedTransportFactory().openTransport(InetAddress.getLocalHost().getHostName(),9170)));
    client.set_keyspace(ksName);
    client.cas(bytes(9),cf,Collections.<Column>emptyList(),Collections.singletonList(getColumnForInsert("v1",9)),org.apache.cassandra.thrift.ConsistencyLevel.LOCAL_SERIAL,org.apache.cassandra.thrift.ConsistencyLevel.ONE);
  }
  finally {
    assertUpdateNotExecuted(cf,9);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BTreeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdate_UpdateFunctionReplacement(){
  for (int i=0; i < 20; i++)   checkResult(i,BTree.update(BTree.build(seq(i),noOp),CMP,seq(i),updateF));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuilding_UpdateFunctionReplacement(){
  for (int i=0; i < 20; i++)   checkResult(i,BTree.build(seq(i),updateF));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BitSetTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test serialization and de-serialization in-memory
 */
@Test public void testOffHeapSerialization() throws IOException {
  try (OffHeapBitSet bs=new OffHeapBitSet(100000)){
    populateAndReserialize(bs);
  }
 }

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test bitsets in a "real-world" environment, i.e., bloom filters
 */
@Test public void compareBitSets(){
  compareBitSets(false);
  compareBitSets(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOffHeapCompatibility() throws IOException {
  try (OpenBitSet bs=new OpenBitSet(100000)){
    populateAndReserialize(bs);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BloomFilterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFalsePositivesRandom(){
  FilterTestHelper.testFalsePositives(bfOldFormat,FilterTestHelper.randomKeys(),FilterTestHelper.randomKeys2());
  FilterTestHelper.testFalsePositives(bfInvHashes,FilterTestHelper.randomKeys(),FilterTestHelper.randomKeys2());
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void compareCachedKeyNewHashOrder(){
  try (BloomFilter bf1=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,false);BloomFilter bf2=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,false);BloomFilter bf3=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,false)){
    RandomStringGenerator gen1=new KeyGenerator.RandomStringGenerator(new Random().nextInt(),FilterTestHelper.ELEMENTS);
    BitSetTest.compare(bf1.bitset,bf2.bitset);
    BitSetTest.compare(bf1.bitset,bf3.bitset);
    while (gen1.hasNext()) {
      ByteBuffer key=gen1.next();
      FilterKey cached=FilterTestHelper.wrapCached(key);
      bf1.add(FilterTestHelper.wrap(key));
      bf2.add(cached);
      bf3.add(cached);
    }
    BitSetTest.compare(bf1.bitset,bf2.bitset);
    BitSetTest.compare(bf1.bitset,bf3.bitset);
  }
 }

</code></pre>

<br>
<pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testHugeBFSerialization() throws IOException {
  hugeBFSerialization(false);
  hugeBFSerialization(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void compareCachedKeyOldHashOrder(){
  BloomFilter bf1=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,true);
  BloomFilter bf2=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,true);
  BloomFilter bf3=(BloomFilter)FilterFactory.getFilter(FilterTestHelper.ELEMENTS / 2,FilterTestHelper.MAX_FAILURE_RATE,false,true);
  RandomStringGenerator gen1=new KeyGenerator.RandomStringGenerator(new Random().nextInt(),FilterTestHelper.ELEMENTS);
  BitSetTest.compare(bf1.bitset,bf2.bitset);
  BitSetTest.compare(bf1.bitset,bf3.bitset);
  while (gen1.hasNext()) {
    ByteBuffer key=gen1.next();
    FilterKey cached=FilterTestHelper.wrapCached(key);
    bf1.add(FilterTestHelper.wrap(key));
    bf2.add(cached);
    bf3.add(cached);
  }
  BitSetTest.compare(bf1.bitset,bf2.bitset);
  BitSetTest.compare(bf1.bitset,bf3.bitset);
}

</code></pre>

<br>
<pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testManyRandom(){
  testManyRandom(FilterTestHelper.randomKeys(),false);
  testManyRandom(FilterTestHelper.randomKeys(),true);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testOffHeapException(){
  long numKeys=((long)Integer.MAX_VALUE) * 64L + 1L;
  FilterFactory.getFilter(numKeys,0.01d,true,true).close();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOne(){
  bfOldFormat.add(FilterTestHelper.bytes("a"));
  assert bfOldFormat.isPresent(FilterTestHelper.bytes("a"));
  assert !bfOldFormat.isPresent(FilterTestHelper.bytes("b"));
  bfInvHashes.add(FilterTestHelper.bytes("a"));
  assert bfInvHashes.isPresent(FilterTestHelper.bytes("a"));
  assert !bfInvHashes.isPresent(FilterTestHelper.bytes("b"));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWords(){
  if (KeyGenerator.WordGenerator.WORDS == 0) {
    return;
  }
  IFilter bf2=FilterFactory.getFilter(KeyGenerator.WordGenerator.WORDS / 2,FilterTestHelper.MAX_FAILURE_RATE,true,false);
  int skipEven=KeyGenerator.WordGenerator.WORDS % 2 == 0 ? 0 : 2;
  FilterTestHelper.testFalsePositives(bf2,new KeyGenerator.WordGenerator(skipEven,2),new KeyGenerator.WordGenerator(1,2));
  bf2.close();
  bf2=FilterFactory.getFilter(KeyGenerator.WordGenerator.WORDS / 2,FilterTestHelper.MAX_FAILURE_RATE,true,true);
  FilterTestHelper.testFalsePositives(bf2,new KeyGenerator.WordGenerator(skipEven,2),new KeyGenerator.WordGenerator(1,2));
  bf2.close();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialize() throws IOException {
  BloomFilterTest.testSerialize(bfOldFormat,true).close();
  BloomFilterTest.testSerialize(bfInvHashes,false).close();
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testBloomLimits1(){
  int maxBuckets=BloomCalculations.probs.length - 1;
  int maxK=BloomCalculations.probs[maxBuckets].length - 1;
  BloomCalculations.computeBloomSpec(maxBuckets,BloomCalculations.probs[maxBuckets][maxK]);
  BloomCalculations.computeBloomSpec(maxBuckets,BloomCalculations.probs[maxBuckets][maxK] / 2);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFalsePositivesInt(){
  FilterTestHelper.testFalsePositives(bfOldFormat,FilterTestHelper.intKeys(),FilterTestHelper.randomKeys2());
  FilterTestHelper.testFalsePositives(bfInvHashes,FilterTestHelper.intKeys(),FilterTestHelper.randomKeys2());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.ByteBufferUtilTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClone(){
  ByteBuffer bb=ByteBufferUtil.bytes(s);
  ByteBuffer clone1=ByteBufferUtil.clone(bb);
  assert bb != clone1;
  assert bb.equals(clone1);
  assert bb.array() != clone1.array();
  bb=fromStringWithPosition(s,10,false);
  ByteBuffer clone2=ByteBufferUtil.clone(bb);
  assert bb != clone2;
  assert bb.equals(clone2);
  assert clone1.equals(clone2);
  assert bb.array() != clone2.array();
  bb=fromStringWithPosition(s,10,true);
  ByteBuffer clone3=ByteBufferUtil.clone(bb);
  assert bb != clone3;
  assert bb.equals(clone3);
  assert clone1.equals(clone3);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayCopy(){
  ByteBuffer bb=ByteBufferUtil.bytes(s);
  checkArrayCopy(bb);
  bb=fromStringWithPosition(s,10,false);
  checkArrayCopy(bb);
  bb=fromStringWithPosition(s,10,true);
  checkArrayCopy(bb);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLastIndexOf(){
  ByteBuffer bb=ByteBufferUtil.bytes(s);
  checkLastIndexOf(bb);
  bb=fromStringWithPosition(s,10,false);
  checkLastIndexOf(bb);
  bb=fromStringWithPosition(s,10,true);
  checkLastIndexOf(bb);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputStream() throws IOException {
  ByteBuffer bb=ByteBuffer.allocate(13);
  bb.putInt(255);
  bb.put((byte)-3);
  bb.putLong(42L);
  bb.clear();
  DataInputStream in=new DataInputStream(ByteBufferUtil.inputStream(bb));
  assert in.readInt() == 255;
  assert in.readByte() == (byte)-3;
  assert in.readLong() == 42L;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReadWrite() throws IOException {
  ByteBuffer bb=ByteBufferUtil.bytes(s);
  checkReadWrite(bb);
  bb=fromStringWithPosition(s,10,false);
  checkReadWrite(bb);
  bb=fromStringWithPosition(s,10,true);
  checkReadWrite(bb);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testString() throws Exception {
  assert s.equals(ByteBufferUtil.string(ByteBufferUtil.bytes(s)));
  int pos=10;
  ByteBuffer bb=fromStringWithPosition(s,10,false);
  assert s.equals(ByteBufferUtil.string(bb,10,s.length()));
  bb=fromStringWithPosition(s,10,true);
  assert s.equals(ByteBufferUtil.string(bb,10,s.length()));
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CharacterCodingException.class) public void testDecode() throws IOException {
  ByteBuffer bytes=ByteBuffer.wrap(new byte[]{(byte)0xff,(byte)0xfe});
  ByteBufferUtil.string(bytes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BytesReadTrackerTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testReadLine() throws Exception {
  DataInputStream in=new DataInputStream(new ByteArrayInputStream("1".getBytes()));
  BytesReadTracker tracker=new BytesReadTracker(in);
  try {
    tracker.readLine();
  }
  finally {
    in.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.CLibraryTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkipCache(){
  File file=FileUtils.createTempFile("testSkipCache","1");
  CLibrary.trySkipCache(file.getPath(),0,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.CassandraVersionTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInvalid(){
  assertThrows("1.0.0a");
  assertThrows("1.a.4");
  assertThrows("1.0.0-foo&");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.FBUtilitiesTest </h4><pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CharacterCodingException.class) public void testDecode() throws IOException {
  ByteBuffer bytes=ByteBuffer.wrap(new byte[]{(byte)0xff,(byte)0xfe});
  ByteBufferUtil.string(bytes,StandardCharsets.UTF_8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.FastByteOperationsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFastByteCopy(){
  byte[] bytes1=new byte[128];
  byte[] empty=new byte[128];
  rand.nextBytes(bytes1);
  testCopy(bytes1,wrap1(bytes1,true),wrap2(empty,true),PJO);
  testCopy(bytes1,wrap1(bytes1,true),wrap2(empty,false),PJO);
  testCopy(bytes1,wrap1(bytes1,false),wrap2(empty,true),PJO);
  testCopy(bytes1,wrap1(bytes1,false),wrap2(empty,false),PJO);
  testCopy(bytes1,wrap1(bytes1,true),wrap2(empty,true),UO);
  testCopy(bytes1,wrap1(bytes1,true),wrap2(empty,false),UO);
  testCopy(bytes1,wrap1(bytes1,false),wrap2(empty,true),UO);
  testCopy(bytes1,wrap1(bytes1,false),wrap2(empty,false),UO);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFastByteComparisons(){
  byte[] bytes1=new byte[128];
  for (int i=0; i < 1000; i++) {
    rand.nextBytes(bytes1);
    for (int j=0; j < 16; j++) {
      byte[] bytes2=Arrays.copyOf(bytes1,bytes1.length - j);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,true,1);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,true,-1);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,false,1);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,false,-1);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,true,128);
      testTwiddleOneByteComparisons(bytes1,bytes2,16,false,128);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.HexTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHexToBytesStringConversion(){
  String[] values=new String[]{"00","10","0100","0101","0f","ff"};
  byte[][] expected=new byte[][]{new byte[]{0x00},new byte[]{0x10},new byte[]{0x01,0x00},new byte[]{0x01,0x01},new byte[]{0x0f},new byte[]{(byte)0x000000ff}};
  for (int i=0; i < values.length; i++)   assert Arrays.equals(Hex.hexToBytes(values[i]),expected[i]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.LongBTreeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSlicingSmallRandomTrees() throws ExecutionException, InterruptedException {
  testInsertions(50,10,10,false);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchesSmallOverlappingRange() throws ExecutionException, InterruptedException {
  testInsertions(50,1,5,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndividualInsertsSmallOverlappingRange() throws ExecutionException, InterruptedException {
  testInsertions(50,1,1,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomRangeAndBatches() throws ExecutionException, InterruptedException {
  ThreadLocalRandom random=ThreadLocalRandom.current();
  int treeSize=random.nextInt(maxTreeSize / 10,maxTreeSize * 10);
  for (int i=0; i < perThreadTrees / 10; i++)   testInsertions(threads * 10,treeSize,random.nextInt(1,100) / 10f,treeSize / 100,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLargeBatchesLargeRange() throws ExecutionException, InterruptedException {
  testInsertions(perThreadTrees / 10,Math.max(maxTreeSize,5000),3,100,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBatchesMediumSparseRange() throws ExecutionException, InterruptedException {
  testInsertions(500,10,10,true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSlicingAllSmallTrees() throws ExecutionException, InterruptedException {
  Object[] cur=BTree.empty();
  TreeSet<Integer> canon=new TreeSet<>();
  for (int i=0; i < 128; i++) {
    String id=String.format("[0..%d)",canon.size());
    log("Testing " + id);
    Futures.allAsList(testAllSlices(id,cur,canon)).get();
    Object[] next=null;
    while (next == null)     next=BTree.update(cur,naturalOrder(),Arrays.asList(i),SPORADIC_ABORT);
    cur=next;
    canon.add(i);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndividualInsertsMediumSparseRange() throws ExecutionException, InterruptedException {
  testInsertions(perThreadTrees / 10,500,10,1,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.LongBitSetTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void timeit(){
  long size_to_test=Integer.MAX_VALUE / 10;
  long size_and_excess=size_to_test + 20;
  OpenBitSet obs=new OpenBitSet(size_and_excess);
  OffHeapBitSet offbs=new OffHeapBitSet(size_and_excess);
  logger.info("||Open BS set's|Open BS get's|Open BS clear's|Offheap BS set's|Offheap BS get's|Offheap BS clear's|");
  loopOnce(obs,offbs,size_to_test);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBitSetOperations(){
  long size_to_test=Integer.MAX_VALUE / 40;
  long size_and_excess=size_to_test + 20;
  OffHeapBitSet offbs=new OffHeapBitSet(size_and_excess);
  OpenBitSet obs=new OpenBitSet(size_and_excess);
  for (long i=0; i < size_to_test; i++)   populateRandom(offbs,obs,i);
  for (long i=0; i < size_to_test; i++)   compare(offbs,obs,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Just to make sure JIT doesn't come on our way
 */
@Test public void loopIt(){
  long size_to_test=Integer.MAX_VALUE / 10;
  long size_and_excess=size_to_test + 20;
  OpenBitSet obs=new OpenBitSet(size_and_excess);
  OffHeapBitSet offbs=new OffHeapBitSet(size_and_excess);
  for (int i=0; i < 10; i++)   loopOnce(obs,offbs,size_to_test);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.LongBloomFilterTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBffp(){
  bffp(false);
  bffp(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void timeit(){
  timeit(false);
  timeit(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * NB: needs to run with -mx1G
 */
@Test public void testConstrained(){
  testConstrained(false);
  testConstrained(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * NB: needs to run with -mx1G
 */
@Test public void testBigInt(){
  testBigInt(false);
  testBigInt(true);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBigRandom(){
  testBigRandom(false);
  testBigRandom(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MergeIteratorComparisonTest </h4><pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombinationInts(){
  System.out.println("testCombinationInts");
  final Random r=new Random();
  Reducer<Integer,Counted<Integer>> reducer=new Counter<Integer>();
  List<List<Integer>> lists=new NaturalListGenerator<Integer>(ITERATOR_COUNT,LIST_LENGTH){
    int next=1;
    @Override public Integer next(){
      return r.nextBoolean() ? r.nextInt(5 * LIST_LENGTH) : next++;
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLCSPartialOverlap(){
  testLCS(2,LIST_LENGTH / 100,0.5f);
  testLCS(3,LIST_LENGTH / 100,0.5f);
  testLCS(3,LIST_LENGTH / 100,0.5f,10,LIST_LENGTH);
  testLCS(4,LIST_LENGTH / 100,0.5f);
  testLCS(4,LIST_LENGTH / 100,0.5f,10,LIST_LENGTH);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitedOverlapStrings3(){
  System.out.println("testLimitedOverlapStrings3");
  Reducer<String,Counted<String>> reducer=new Counter<String>();
  List<List<String>> lists=new NaturalListGenerator<String>(ITERATOR_COUNT,LIST_LENGTH){
    int next=0;
    @Override public String next(){
      ++next;
      int list=next / LIST_LENGTH;
      int id=next % LIST_LENGTH;
      return "longish_prefix_" + (id + list * LIST_LENGTH / 3);
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomStrings(){
  System.out.println("testRandomStrings");
  final Random r=new Random();
  Reducer<String,Counted<String>> reducer=new Counter<String>();
  List<List<String>> lists=new NaturalListGenerator<String>(ITERATOR_COUNT,LIST_LENGTH){
    @Override public String next(){
      return "longish_prefix_" + r.nextInt(5 * LIST_LENGTH);
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitedOverlapStrings2(){
  System.out.println("testLimitedOverlapStrings2");
  Reducer<String,Counted<String>> reducer=new Counter<String>();
  List<List<String>> lists=new NaturalListGenerator<String>(ITERATOR_COUNT,LIST_LENGTH){
    int next=0;
    @Override public String next(){
      ++next;
      int list=next / LIST_LENGTH;
      int id=next % LIST_LENGTH;
      return "longish_prefix_" + (id + list * LIST_LENGTH / 2);
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeUuidType(){
  System.out.println("testTimeUuidType");
  final AbstractType<UUID> type=TimeUUIDType.instance;
  Reducer<ByteBuffer,Counted<ByteBuffer>> reducer=new Counter<ByteBuffer>();
  List<List<ByteBuffer>> lists=new SimpleListGenerator<ByteBuffer>(type,ITERATOR_COUNT,LIST_LENGTH){
    @Override public ByteBuffer next(){
      return type.decompose(UUIDGen.getTimeUUID());
    }
  }
.result;
  testMergeIterator(reducer,lists,type);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonOverlapInts(){
  System.out.println("testNonOverlapInts");
  Reducer<Integer,Counted<Integer>> reducer=new Counter<Integer>();
  List<List<Integer>> lists=new NaturalListGenerator<Integer>(ITERATOR_COUNT,LIST_LENGTH){
    int next=1;
    @Override public Integer next(){
      return next++;
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomUuids(){
  System.out.println("testRandomUuids");
  Reducer<UUID,Counted<UUID>> reducer=new Counter<UUID>();
  List<List<UUID>> lists=new NaturalListGenerator<UUID>(ITERATOR_COUNT,LIST_LENGTH){
    @Override public UUID next(){
      return UUID.randomUUID();
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLCSNoOverlap(){
  testLCS(2,LIST_LENGTH / 100,0f);
  testLCS(3,LIST_LENGTH / 100,0f);
  testLCS(3,LIST_LENGTH / 100,0f,10,LIST_LENGTH);
  testLCS(4,LIST_LENGTH / 100,0f);
  testLCS(4,LIST_LENGTH / 100,0f,10,LIST_LENGTH);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeUuids(){
  System.out.println("testTimeUuids");
  Reducer<UUID,Counted<UUID>> reducer=new Counter<UUID>();
  List<List<UUID>> lists=new NaturalListGenerator<UUID>(ITERATOR_COUNT,LIST_LENGTH){
    @Override public UUID next(){
      return UUIDGen.getTimeUUID();
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombinationStrings(){
  System.out.println("testCombinationStrings");
  final Random r=new Random();
  Reducer<String,Counted<String>> reducer=new Counter<String>();
  List<List<String>> lists=new NaturalListGenerator<String>(ITERATOR_COUNT,LIST_LENGTH){
    int next=1;
    public String next(){
      return "longish_prefix_" + (r.nextBoolean() ? r.nextInt(5 * LIST_LENGTH) : next++);
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUuidType(){
  System.out.println("testUuidType");
  final AbstractType<UUID> type=UUIDType.instance;
  Reducer<ByteBuffer,Counted<ByteBuffer>> reducer=new Counter<ByteBuffer>();
  List<List<ByteBuffer>> lists=new SimpleListGenerator<ByteBuffer>(type,ITERATOR_COUNT,LIST_LENGTH){
    @Override public ByteBuffer next(){
      return type.decompose(UUIDGen.getTimeUUID());
    }
  }
.result;
  testMergeIterator(reducer,lists,type);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonOverlapStrings(){
  System.out.println("testNonOverlapStrings");
  Reducer<String,Counted<String>> reducer=new Counter<String>();
  List<List<String>> lists=new NaturalListGenerator<String>(ITERATOR_COUNT,LIST_LENGTH){
    int next=1;
    @Override public String next(){
      return "longish_prefix_" + next++;
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSets(){
  System.out.println("testSets");
  final Random r=new Random();
  Reducer<KeyedSet<Integer,UUID>,KeyedSet<Integer,UUID>> reducer=new Union<Integer,UUID>();
  List<List<KeyedSet<Integer,UUID>>> lists=new NaturalListGenerator<KeyedSet<Integer,UUID>>(ITERATOR_COUNT,LIST_LENGTH){
    @Override public KeyedSet<Integer,UUID> next(){
      return new KeyedSet<>(r.nextInt(5 * LIST_LENGTH),UUIDGen.getTimeUUID());
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLCSTotalOverlap(){
  testLCS(2,LIST_LENGTH / 100,1f);
  testLCS(3,LIST_LENGTH / 100,1f);
  testLCS(3,LIST_LENGTH / 100,1f,10,LIST_LENGTH);
  testLCS(4,LIST_LENGTH / 100,1f);
  testLCS(4,LIST_LENGTH / 100,1f,10,LIST_LENGTH);
}

</code></pre>

<br>
<pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomInts(){
  System.out.println("testRandomInts");
  final Random r=new Random();
  Reducer<Integer,Counted<Integer>> reducer=new Counter<Integer>();
  List<List<Integer>> lists=new NaturalListGenerator<Integer>(ITERATOR_COUNT,LIST_LENGTH){
    @Override public Integer next(){
      return r.nextInt(5 * LIST_LENGTH);
    }
  }
.result;
  testMergeIterator(reducer,lists);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MergeIteratorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that duplicate values are concatted. 
 */
@Test public void testManyToOne() throws Exception {
  MergeIterator.Reducer<String,String> reducer=new MergeIterator.Reducer<String,String>(){
    String concatted="";
    @Override public void reduce(    int idx,    String current){
      concatted+=current;
    }
    public String getReduced(){
      String tmp=concatted;
      concatted="";
      return tmp;
    }
  }
;
  IMergeIterator<String,String> smi=MergeIterator.get(Arrays.asList(a,b,c,d),Ordering.<String>natural(),reducer);
  assert Iterators.elementsEqual(cat,smi);
  smi.close();
  assert a.closed && b.closed && c.closed&& d.closed;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreeTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHashRandom(){
  int max=1000000;
  TOKEN_SCALE=new BigInteger("" + max);
  mt=new MerkleTree(partitioner,fullRange(),RECOMMENDED_DEPTH,32);
  Random random=new Random();
  while (true) {
    if (!mt.split(tok(random.nextInt(max))))     break;
  }
  TreeRangeIterator ranges=mt.invalids();
  for (  TreeRange range : ranges)   range.addHash(new RowHash(range.right,new byte[0],0));
  assert mt.hash(new Range<>(tok(-1),tok(-1))) != null : "Could not hash tree " + mt;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Generate two trees with different splits, but containing the same keys, and
 * check that they compare equally.
 * The set of keys used in this test is: #{2,4,6,8,12,14,0}
 */
@Test public void testValidateTree(){
  TOKEN_SCALE=new BigInteger("16");
  Range<Token> full=new Range<>(tok(-1),tok(-1));
  Iterator<TreeRange> ranges;
  MerkleTree mt2=new MerkleTree(partitioner,fullRange(),RECOMMENDED_DEPTH,Integer.MAX_VALUE);
  mt.split(tok(8));
  mt.split(tok(4));
  mt.split(tok(12));
  mt.split(tok(6));
  mt.split(tok(10));
  ranges=mt.invalids();
  ranges.next().addAll(new HIterator(2,4));
  ranges.next().addAll(new HIterator(6));
  ranges.next().addAll(new HIterator(8));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(12));
  ranges.next().addAll(new HIterator(14,-1));
  mt2.split(tok(8));
  mt2.split(tok(4));
  mt2.split(tok(12));
  mt2.split(tok(2));
  mt2.split(tok(10));
  mt2.split(tok(9));
  mt2.split(tok(11));
  ranges=mt2.invalids();
  ranges.next().addAll(new HIterator(2));
  ranges.next().addAll(new HIterator(4));
  ranges.next().addAll(new HIterator(6,8));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(12));
  ranges.next().addAll(new HIterator(14,-1));
  byte[] mthash=mt.hash(full);
  byte[] mt2hash=mt2.hash(full);
  assertHashEquals("Tree hashes did not match: " + mt + " && "+ mt2,mthash,mt2hash);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialization() throws Exception {
  Range<Token> full=new Range<>(tok(-1),tok(-1));
  mt.maxsize(256);
  mt.init();
  for (  TreeRange range : mt.invalids())   range.addAll(new HIterator(range.right));
  byte[] initialhash=mt.hash(full);
  DataOutputBuffer out=new DataOutputBuffer();
  MerkleTree.serializer.serialize(mt,out,MessagingService.current_version);
  byte[] serialized=out.toByteArray();
  DataInputPlus in=new DataInputBuffer(serialized);
  MerkleTree restored=MerkleTree.serializer.deserialize(in,MessagingService.current_version);
  assertHashEquals(initialhash,restored.hash(full));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreesTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Generate two trees with different splits, but containing the same keys, and
 * check that they compare equally.
 * The set of keys used in this test is: #{2,4,6,8,12,14,0}
 */
@Test public void testValidateTree(){
  TOKEN_SCALE=new BigInteger("16");
  Range<Token> full=new Range<>(tok(-1),tok(-1));
  Iterator<TreeRange> ranges;
  MerkleTrees mts2=new MerkleTrees(partitioner);
  mts2.addMerkleTree(Integer.MAX_VALUE,fullRange());
  mts.split(tok(8));
  mts.split(tok(4));
  mts.split(tok(12));
  mts.split(tok(6));
  mts.split(tok(10));
  ranges=mts.invalids();
  ranges.next().addAll(new HIterator(2,4));
  ranges.next().addAll(new HIterator(6));
  ranges.next().addAll(new HIterator(8));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(12));
  ranges.next().addAll(new HIterator(14,-1));
  mts2.split(tok(8));
  mts2.split(tok(4));
  mts2.split(tok(12));
  mts2.split(tok(2));
  mts2.split(tok(10));
  mts2.split(tok(9));
  mts2.split(tok(11));
  ranges=mts2.invalids();
  ranges.next().addAll(new HIterator(2));
  ranges.next().addAll(new HIterator(4));
  ranges.next().addAll(new HIterator(6,8));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(new int[0]));
  ranges.next().addAll(new HIterator(12));
  ranges.next().addAll(new HIterator(14,-1));
  byte[] mthash=mts.hash(full);
  byte[] mt2hash=mts2.hash(full);
  assertHashEquals("Tree hashes did not match: " + mts + " && "+ mts2,mthash,mt2hash);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHashRandom(){
  int max=1000000;
  TOKEN_SCALE=new BigInteger("" + max);
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTree(32,fullRange());
  Random random=new Random();
  while (true) {
    if (!mts.split(tok(random.nextInt(max))))     break;
  }
  TreeRangeIterator ranges=mts.invalids();
  for (  TreeRange range : ranges)   range.addHash(new RowHash(range.right,new byte[0],0));
  assert mts.hash(new Range<>(tok(-1),tok(-1))) != null : "Could not hash tree " + mts;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NoSpamLoggerTest </h4><pre class="type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoSpamLogger() throws Exception {
  testLevel(Level.INFO);
  testLevel(Level.WARN);
  testLevel(Level.ERROR);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.OverlapIteratorTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test(){
  for (int i=0; i < 10; i++) {
    test(1000,0,1000);
    test(100000,100,1000);
    test(1000000,0,1000);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.SerializationsTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBloomFilterTable() throws Exception {
  testBloomFilterTable("test/data/bloom-filter/ka/foo/foo-atable-ka-1-Filter.db",true);
  testBloomFilterTable("test/data/bloom-filter/la/foo/la-1-big-Filter.db",false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.TopKSamplerTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * checking for exceptions from SS/HLL which are not thread safe
 */
@Test public void testMultithreadedAccess() throws Exception {
  final AtomicBoolean running=new AtomicBoolean(true);
  final CountDownLatch latch=new CountDownLatch(1);
  final TopKSampler<String> sampler=new TopKSampler<String>();
  new Thread(new Runnable(){
    public void run(){
      try {
        while (running.get()) {
          insert(sampler);
        }
      }
  finally {
        latch.countDown();
      }
    }
  }
,"inserter").start();
  try {
    for (int i=0; i < 100; i++) {
      sampler.beginSampling(i);
      sampler.finishSampling(i);
    }
    for (int i=0; i < 3; i++) {
      sampler.beginSampling(i);
      Thread.sleep(250);
      sampler.finishSampling(i);
    }
    running.set(false);
    latch.await(1,TimeUnit.SECONDS);
    waitForEmpty(1000);
    for (int i=0; i < 10; i++) {
      sampler.beginSampling(i);
      Thread.sleep(i);
      sampler.finishSampling(i);
    }
  }
  finally {
    running.set(false);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSamplerOutOfOrder() throws TimeoutException {
  TopKSampler<String> sampler=new TopKSampler<String>();
  sampler.beginSampling(10);
  insert(sampler);
  waitForEmpty(1000);
  SamplerResult single=sampler.finishSampling(10);
  single=sampler.finishSampling(10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.UUIDTests </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testToFromByteBuffer(){
  UUID a=UUIDGen.getTimeUUID();
  ByteBuffer bb=UUIDGen.toByteBuffer(a);
  UUID b=UUIDGen.getUUID(bb);
  assert a.equals(b);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void verifyType1(){
  UUID uuid=UUIDGen.getTimeUUID();
  assert uuid.version() == 1;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeUUIDType(){
  TimeUUIDType comp=TimeUUIDType.instance;
  ByteBuffer first=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes());
  ByteBuffer second=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes());
  assert comp.compare(first,second) < 0;
  assert comp.compare(second,first) > 0;
  ByteBuffer sameAsFirst=ByteBuffer.wrap(UUIDGen.decompose(UUIDGen.getUUID(first)));
  assert comp.compare(first,sameAsFirst) == 0;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUUIDTimestamp(){
  long now=System.currentTimeMillis();
  UUID uuid=UUIDGen.getTimeUUID();
  long tstamp=UUIDGen.getAdjustedTimestamp(uuid);
  assert now <= tstamp && now >= tstamp - 10 : "now = " + now + ", timestamp = "+ tstamp;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDecomposeAndRaw(){
  UUID a=UUIDGen.getTimeUUID();
  byte[] decomposed=UUIDGen.decompose(a);
  UUID b=UUIDGen.getUUID(ByteBuffer.wrap(decomposed));
  assert a.equals(b);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void verifyOrdering1(){
  UUID one=UUIDGen.getTimeUUID();
  UUID two=UUIDGen.getTimeUUID();
  assert one.timestamp() < two.timestamp();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.btree.BTreeRemovalTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchMergeWithLeft2(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,5,5,5});
  for (int i=401; i < 405; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafMergeWithRight(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4,4,4,4});
  for (int i=1; i < 5; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafMergeWithLeft1(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4,4,4,4});
  for (int i=11; i < 15; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafRotateLeft(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,5,5,5,5});
  for (int i=11; i < 15; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchLeftRotation(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{6,5,5,5,5});
  for (int i=101; i < 105; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafMergeWithLeft2(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4,4,4,4});
  for (int i=41; i < 45; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchRightRotation1(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,6,5,5,5});
  for (int i=1; i < 5; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWhenSingleKeyRootMergeWithRight(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4});
  for (int i=11; i < 15; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafRotateRight1(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,5,5,5,5});
  for (int i=1; i < 5; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWhenSingleKeyRootMergeWithLeft(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4});
  for (int i=1; i < 5; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchMergeWithRight(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,5,5,5});
  for (int i=1; i < 5; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveLastElement(){
  final Object[] btree=new Object[]{1};
  assertBTree(BTree.empty(),remove(btree,CMP,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafRotateRight2(){
  final Object[] btree=generateSampleTwoLevelsTree(new int[]{4,4,5,5,5});
  for (int i=11; i < 15; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromEmpty(){
  assertBTree(BTree.empty(),remove(BTree.empty(),CMP,1));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromRootBranch(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,5,5,5});
  for (int i=100; i < 500; i+=100)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMiddleBranch(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,5,5,5});
  for (int i=10; i < 50; i+=10)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveNonexistingElement(){
  final Object[] btree=new Object[]{1,2,3,4,null};
  assertBTree(btree,remove(btree,CMP,5));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchMergeWithLeft1(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,5,5,5});
  for (int i=101; i < 105; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromNonMinimalLeaf(){
  for (int size=5; size < 9; ++size) {
    final Object[] btree=generateSampleTwoLevelsTree(new int[]{size,4,4,4,4});
    for (int i=1; i < size + 1; ++i)     assertRemove(btree,i);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRemoveFromMinimalLeafWithBranchRightRotation2(){
  final Object[] btree=generateSampleThreeLevelsTree(new int[]{5,5,6,5,5});
  for (int i=101; i < 105; ++i)   assertRemove(btree,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.concurrent.RefCountedTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMemoryLeak(){
  Tidier tidier=new Tidier();
  Ref ref=new Ref(null,tidier);
  long initialSize=ObjectSizes.measureDeep(ref);
  for (int i=0; i < 1000; i++)   ref.ref().release();
  long finalSize=ObjectSizes.measureDeep(ref);
  if (finalSize > initialSize * 2)   throw new AssertionError();
  ref.release();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCLQBug(){
  Ref.concurrentIterables.remove(ConcurrentLinkedQueue.class);
  try {
    testConcurrentLinkedQueueImpl(true);
  }
  finally {
    Ref.concurrentIterables.add(ConcurrentLinkedQueue.class);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcurrentLinkedQueue(){
  testConcurrentLinkedQueueImpl(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.BufferPoolTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_TwoSizesTwoBuffersPostponedReturn() throws InterruptedException {
  checkMultipleThreads(40,2,false,1024,2048);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_TwoSizesOneBufferImmediateReturn() throws InterruptedException {
  checkMultipleThreads(40,1,true,1024,2048);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutOfOrderFrees(){
  final int size=4096;
  final int maxFreeSlots=BufferPool.CHUNK_SIZE / size;
  final int[] idxs=new int[maxFreeSlots];
  for (int i=0; i < maxFreeSlots; i++)   idxs[i]=i;
  doTestFrees(size,maxFreeSlots,idxs);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomFrees(){
  doTestRandomFrees(12345567878L);
  BufferPool.reset();
  doTestRandomFrees(20452249587L);
  BufferPool.reset();
  doTestRandomFrees(82457252948L);
  BufferPool.reset();
  doTestRandomFrees(98759284579L);
  BufferPool.reset();
  doTestRandomFrees(19475257244L);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_MultipleSizesMultipleBuffersImmediateReturn() throws InterruptedException {
  checkMultipleThreads(40,4,true,1024,2048,3072,4096,5120);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_MultipleSizesOneBufferPostponedReturn() throws InterruptedException {
  checkMultipleThreads(40,1,false,1024,2048,3072,4096,5120);
}

</code></pre>

<br>
<pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore public void testMultipleThreadsReleaseSameBuffer() throws InterruptedException {
  doMultipleThreadsReleaseBuffers(45,4096);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecycle(){
  requestUpToSize(RandomAccessReader.DEFAULT_BUFFER_SIZE,3 * BufferPool.CHUNK_SIZE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_MultipleSizesOneBufferImmediateReturn() throws InterruptedException {
  checkMultipleThreads(40,1,true,1024,2048,3072,4096,5120);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxMemoryExceededHeap(){
  boolean cur=BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED;
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=true;
  requestDoubleMaxMemory();
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=cur;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_TwoSizesOneBufferPostponedReturn() throws InterruptedException {
  checkMultipleThreads(40,1,false,1024,2048);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInOrderFrees(){
  final int size=4096;
  final int maxFreeSlots=BufferPool.CHUNK_SIZE / size;
  final int[] idxs=new int[maxFreeSlots];
  for (int i=0; i < maxFreeSlots; i++)   idxs[i]=maxFreeSlots - 1 - i;
  doTestFrees(size,maxFreeSlots,idxs);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_MultipleSizesMultipleBuffersPostponedReturn() throws InterruptedException {
  checkMultipleThreads(40,3,false,1024,2048,3072,4096,5120);
}

</code></pre>

<br>
<pre class="type-3 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore public void testMultipleThreadsReleaseDifferentBuffer() throws InterruptedException {
  doMultipleThreadsReleaseBuffers(45,4096,8192);
}

</code></pre>

<br>
<pre class="type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNegativeSizeRequest(){
  BufferPool.get(-1);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxMemoryExceeded_SmallerThanChunkSize(){
  BufferPool.MEMORY_USAGE_THRESHOLD=BufferPool.GlobalPool.MACRO_CHUNK_SIZE / 2;
  requestDoubleMaxMemory();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPageAligned(){
  final int size=1024;
  for (int i=size; i <= BufferPool.CHUNK_SIZE; i+=size) {
    checkPageAligned(i);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_TwoSizesTwoBuffersImmediateReturn() throws InterruptedException {
  checkMultipleThreads(40,2,true,1024,2048);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxMemoryExceeded_SameAsChunkSize(){
  BufferPool.MEMORY_USAGE_THRESHOLD=BufferPool.GlobalPool.MACRO_CHUNK_SIZE;
  requestDoubleMaxMemory();
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxMemoryExceededDirect(){
  boolean cur=BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED;
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=false;
  requestDoubleMaxMemory();
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=cur;
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuffersWithGivenSlots(){
  checkBufferWithGivenSlots(21241,(-1L << 27) ^ (1L << 40));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_SameSizePostponedReturn() throws InterruptedException {
  checkMultipleThreads(40,1,false,RandomAccessReader.DEFAULT_BUFFER_SIZE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMT_SameSizeImmediateReturn() throws InterruptedException {
  checkMultipleThreads(40,1,true,RandomAccessReader.DEFAULT_BUFFER_SIZE);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleBuffersOneChunk(){
  checkBuffers(32768,33553);
  checkBuffers(32768,32768);
  checkBuffers(48450,33172);
  checkBuffers(32768,15682,33172);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleBufferOneChunk(){
  checkBuffer(0);
  checkBuffer(1);
  checkBuffer(2);
  checkBuffer(4);
  checkBuffer(5);
  checkBuffer(8);
  checkBuffer(16);
  checkBuffer(32);
  checkBuffer(64);
  checkBuffer(65);
  checkBuffer(127);
  checkBuffer(128);
  checkBuffer(129);
  checkBuffer(255);
  checkBuffer(256);
  checkBuffer(512);
  checkBuffer(1024);
  checkBuffer(2048);
  checkBuffer(4096);
  checkBuffer(8192);
  checkBuffer(16384);
  checkBuffer(16385);
  checkBuffer(32767);
  checkBuffer(32768);
  checkBuffer(32769);
  checkBuffer(33172);
  checkBuffer(33553);
  checkBuffer(36000);
  checkBuffer(65535);
  checkBuffer(65536);
  checkBuffer(65537);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.LongBufferPoolTest </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllocate() throws InterruptedException, ExecutionException {
  testAllocate(Runtime.getRuntime().availableProcessors() * 2,TimeUnit.MINUTES.toNanos(2L),16 << 20);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
