<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchTest </h4><pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * This is just to test decodeMutations() when deserializing,
 * since Batch will never be serialized at a version 2.2.
 * @throws IOException
 */
@Test public void testSerializationNonCurrentVersion() throws IOException {
  CFMetaData cfm=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF_STANDARD).metadata;
  long now=FBUtilities.timestampMicros();
  int version=MessagingService.VERSION_22;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int i=0; i < 10; i++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),bytes(i)).clustering("name" + i).add("val","val" + i).build());
  }
  Batch batch1=Batch.createLocal(uuid,now,mutations);
  assertEquals(uuid,batch1.id);
  assertEquals(now,batch1.creationTime);
  assertEquals(mutations,batch1.decodedMutations);
  DataOutputBuffer out=new DataOutputBuffer();
  Batch.serializer.serialize(batch1,out,version);
  assertEquals(out.getLength(),Batch.serializer.serializedSize(batch1,version));
  DataInputPlus dis=new DataInputBuffer(out.getData());
  Batch batch2=Batch.serializer.deserialize(dis,version);
  assertEquals(batch1.id,batch2.id);
  assertEquals(batch1.creationTime,batch2.creationTime);
  assertEquals(batch1.decodedMutations.size(),batch2.decodedMutations.size());
  Iterator<Mutation> it1=batch1.decodedMutations.iterator();
  Iterator<Mutation> it2=batch2.decodedMutations.iterator();
  while (it1.hasNext())   assertEquals(it1.next().toString(),it2.next().toString());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSerialization() throws IOException {
  CFMetaData cfm=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF_STANDARD).metadata;
  long now=FBUtilities.timestampMicros();
  int version=MessagingService.current_version;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int i=0; i < 10; i++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),bytes(i)).clustering("name" + i).add("val","val" + i).build());
  }
  Batch batch1=Batch.createLocal(uuid,now,mutations);
  assertEquals(uuid,batch1.id);
  assertEquals(now,batch1.creationTime);
  assertEquals(mutations,batch1.decodedMutations);
  DataOutputBuffer out=new DataOutputBuffer();
  Batch.serializer.serialize(batch1,out,version);
  assertEquals(out.getLength(),Batch.serializer.serializedSize(batch1,version));
  DataInputPlus dis=new DataInputBuffer(out.getData());
  Batch batch2=Batch.serializer.deserialize(dis,version);
  assertEquals(batch1.id,batch2.id);
  assertEquals(batch1.creationTime,batch2.creationTime);
  assertEquals(batch1.decodedMutations.size(),batch2.encodedMutations.size());
  Iterator<Mutation> it1=batch1.decodedMutations.iterator();
  Iterator<ByteBuffer> it2=batch2.encodedMutations.iterator();
  while (it1.hasNext()) {
    try (DataInputBuffer in=new DataInputBuffer(it2.next().array())){
      assertEquals(it1.next().toString(),Mutation.serializer.deserialize(in,version).toString());
    }
   }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchlogEndpointFilterTest </h4><pre class="type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void shouldSelectHostFromLocal() throws UnknownHostException {
  Multimap<String,InetAddress> endpoints=ImmutableMultimap.<String,InetAddress>builder().put(LOCAL,InetAddress.getByName("0")).put(LOCAL,InetAddress.getByName("00")).put("1",InetAddress.getByName("1")).build();
  Collection<InetAddress> result=new TestEndpointFilter(LOCAL,endpoints).filter();
  assertThat(result.size(),is(2));
  assertThat(result,JUnitMatchers.hasItem(InetAddress.getByName("1")));
  assertThat(result,JUnitMatchers.hasItem(InetAddress.getByName("0")));
}

</code></pre>

<br>
<pre class="type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void shouldSelectTwoRandomHostsFromSingleOtherRack() throws UnknownHostException {
  Multimap<String,InetAddress> endpoints=ImmutableMultimap.<String,InetAddress>builder().put(LOCAL,InetAddress.getByName("0")).put(LOCAL,InetAddress.getByName("00")).put("1",InetAddress.getByName("1")).put("1",InetAddress.getByName("11")).put("1",InetAddress.getByName("111")).build();
  Collection<InetAddress> result=new TestEndpointFilter(LOCAL,endpoints).filter();
  assertThat(new HashSet<>(result).size(),is(2));
}

</code></pre>

<br>
<pre class="type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void shouldSelect2hostsFromNonLocalRacks() throws UnknownHostException {
  Multimap<String,InetAddress> endpoints=ImmutableMultimap.<String,InetAddress>builder().put(LOCAL,InetAddress.getByName("0")).put(LOCAL,InetAddress.getByName("00")).put("1",InetAddress.getByName("1")).put("1",InetAddress.getByName("11")).put("2",InetAddress.getByName("2")).put("2",InetAddress.getByName("22")).build();
  Collection<InetAddress> result=new TestEndpointFilter(LOCAL,endpoints).filter();
  assertThat(result.size(),is(2));
  assertThat(result,JUnitMatchers.hasItem(InetAddress.getByName("11")));
  assertThat(result,JUnitMatchers.hasItem(InetAddress.getByName("22")));
}

</code></pre>

<br>
<pre class="type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void shouldReturnAsIsIfNoEnoughEndpoints() throws UnknownHostException {
  Multimap<String,InetAddress> endpoints=ImmutableMultimap.<String,InetAddress>builder().put(LOCAL,InetAddress.getByName("0")).build();
  Collection<InetAddress> result=new TestEndpointFilter(LOCAL,endpoints).filter();
  assertThat(result.size(),is(1));
  assertThat(result,JUnitMatchers.hasItem(InetAddress.getByName("0")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchlogManagerTest </h4><pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveBatch(){
  long initialAllBatches=BatchlogManager.instance.countAllBatches();
  CFMetaData cfm=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD5).metadata;
  long timestamp=(System.currentTimeMillis() - DatabaseDescriptor.getWriteRpcTimeout() * 2) * 1000;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int j=0; j < 10; j++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(j)).clustering("name" + j).add("val","val" + j).build());
  }
  BatchlogManager.store(Batch.createLocal(uuid,timestamp,mutations));
  Assert.assertEquals(initialAllBatches + 1,BatchlogManager.instance.countAllBatches());
  BatchlogManager.remove(uuid);
  assertEquals(initialAllBatches,BatchlogManager.instance.countAllBatches());
  String query=String.format("SELECT count(*) FROM %s.%s where id = %s",SystemKeyspace.NAME,SystemKeyspace.BATCHES,uuid);
  UntypedResultSet result=executeInternal(query);
  assertNotNull(result);
  assertEquals(0L,result.one().getLong("count"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void testConversion() throws Exception {
  long initialAllBatches=BatchlogManager.instance.countAllBatches();
  long initialReplayedBatches=BatchlogManager.instance.getTotalBatchesReplayed();
  CFMetaData cfm=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD4);
  for (int i=0; i < 1400; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 700 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    Mutation batchMutation=LegacyBatchlogMigrator.getStoreMutation(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),TimeUnit.MILLISECONDS.toMicros(timestamp),Collections.singleton(mutation)),MessagingService.VERSION_20);
    assertTrue(LegacyBatchlogMigrator.isLegacyBatchlogMutation(batchMutation));
    LegacyBatchlogMigrator.handleLegacyMutation(batchMutation);
  }
  for (int i=1400; i < 1500; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 1450 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),Collections.singleton(mutation)));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  assertEquals(1500,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(0,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  UntypedResultSet result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy",0,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog",1500,result.one().getLong("count"));
  BatchlogManager.instance.performInitialReplay();
  assertEquals(750,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(750,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  for (int i=0; i < 1500; i++) {
    result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD4,i));
    assertNotNull(result);
    if (i < 700 || i >= 1400 && i < 1450) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue("Present at " + i,result.isEmpty());
    }
  }
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",KEYSPACE1,CF_STANDARD4));
  assertNotNull(result);
  assertEquals(750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog after initial replay",750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy after initial replay ",0,result.one().getLong("count"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncatedReplay() throws InterruptedException, ExecutionException {
  CFMetaData cf2=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD2);
  CFMetaData cf3=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD3);
  for (int i=0; i < 1000; i++) {
    Mutation mutation1=new RowUpdateBuilder(cf2,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    Mutation mutation2=new RowUpdateBuilder(cf3,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    List<Mutation> mutations=Lists.newArrayList(mutation1,mutation2);
    long timestamp=System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout();
    if (i == 500)     SystemKeyspace.saveTruncationRecord(Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2),timestamp,ReplayPosition.NONE);
    if (i >= 500)     timestamp++;
 else     timestamp--;
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),mutations));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  BatchlogManager.instance.startBatchlogReplay().get();
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD2,i));
    assertNotNull(result);
    if (i >= 500) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue(result.isEmpty());
    }
  }
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD3,i));
    assertNotNull(result);
    assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
    assertEquals("name" + i,result.one().getString("name"));
    assertEquals("val" + i,result.one().getString("val"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddBatch() throws IOException {
  long initialAllBatches=BatchlogManager.instance.countAllBatches();
  CFMetaData cfm=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD5).metadata;
  long timestamp=(System.currentTimeMillis() - DatabaseDescriptor.getWriteRpcTimeout() * 2) * 1000;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int j=0; j < 10; j++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(j)).clustering("name" + j).add("val","val" + j).build());
  }
  BatchlogManager.store(Batch.createLocal(uuid,timestamp,mutations));
  Assert.assertEquals(initialAllBatches + 1,BatchlogManager.instance.countAllBatches());
  String query=String.format("SELECT count(*) FROM %s.%s where id = %s",SystemKeyspace.NAME,SystemKeyspace.BATCHES,uuid);
  UntypedResultSet result=executeInternal(query);
  assertNotNull(result);
  assertEquals(1L,result.one().getLong("count"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cache.AutoSavingCacheTest </h4><pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializeAndLoadKeyCache() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  for (int i=0; i < 2; i++) {
    ColumnDefinition colDef=ColumnDefinition.regularDef(cfs.metadata,ByteBufferUtil.bytes("col1"),AsciiType.instance);
    RowUpdateBuilder rowBuilder=new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),"key1");
    rowBuilder.add(colDef,"val1");
    rowBuilder.build().apply();
    cfs.forceBlockingFlush();
  }
  Assert.assertEquals(2,cfs.getLiveSSTables().size());
  for (  SSTableReader sstable : cfs.getLiveSSTables())   sstable.getPosition(Util.dk("key1"),SSTableReader.Operator.EQ);
  AutoSavingCache<KeyCacheKey,RowIndexEntry> keyCache=CacheService.instance.keyCache;
  keyCache.submitWrite(keyCache.size()).get();
  keyCache.clear();
  Assert.assertEquals(0,keyCache.size());
  keyCache.loadSavedAsync().get();
  for (  SSTableReader sstable : cfs.getLiveSSTables())   Assert.assertNotNull(keyCache.get(new KeyCacheKey(cfs.metadata.ksAndCFName,sstable.descriptor,ByteBufferUtil.bytes("key1"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cache.CacheProviderTest </h4><pre class="type-7 type-4 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeys(){
  Pair<String,String> ksAndCFName=Pair.create(KEYSPACE1,CF_STANDARD1);
  byte[] b1={1,2,3,4};
  RowCacheKey key1=new RowCacheKey(ksAndCFName,ByteBuffer.wrap(b1));
  byte[] b2={1,2,3,4};
  RowCacheKey key2=new RowCacheKey(ksAndCFName,ByteBuffer.wrap(b2));
  assertEquals(key1,key2);
  assertEquals(key1.hashCode(),key2.hashCode());
  byte[] b3={1,2,3,5};
  RowCacheKey key3=new RowCacheKey(ksAndCFName,ByteBuffer.wrap(b3));
  assertNotSame(key1,key3);
  assertNotSame(key1.hashCode(),key3.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.CFMetaDataTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThriftConversion() throws Exception {
  CfDef cfDef=new CfDef().setDefault_validation_class(AsciiType.class.getCanonicalName()).setComment("Test comment").setColumn_metadata(columnDefs).setKeyspace(KEYSPACE1).setName(CF_STANDARD1);
  CFMetaData cfMetaData=ThriftConversion.fromThrift(cfDef);
  CfDef thriftCfDef=new CfDef();
  thriftCfDef.keyspace=KEYSPACE1;
  thriftCfDef.name=CF_STANDARD1;
  thriftCfDef.default_validation_class=cfDef.default_validation_class;
  thriftCfDef.comment=cfDef.comment;
  thriftCfDef.column_metadata=new ArrayList<>();
  for (  ColumnDef columnDef : columnDefs) {
    ColumnDef c=new ColumnDef();
    c.name=ByteBufferUtil.clone(columnDef.name);
    c.validation_class=columnDef.getValidation_class();
    c.index_name=columnDef.getIndex_name();
    c.index_type=columnDef.getIndex_type();
    if (columnDef.isSetIndex_options())     c.setIndex_options(columnDef.getIndex_options());
    thriftCfDef.column_metadata.add(c);
  }
  CfDef converted=ThriftConversion.toThrift(cfMetaData);
  assertEquals(thriftCfDef.keyspace,converted.keyspace);
  assertEquals(thriftCfDef.name,converted.name);
  assertEquals(thriftCfDef.default_validation_class,converted.default_validation_class);
  assertEquals(thriftCfDef.comment,converted.comment);
  assertEquals(new HashSet<>(thriftCfDef.column_metadata),new HashSet<>(converted.column_metadata));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.DatabaseDescriptorTest </h4><pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKSMetaDataSerialization() throws ConfigurationException {
  for (  String ks : Schema.instance.getNonSystemKeyspaces()) {
    KeyspaceMetadata ksm=Schema.instance.getKSMetaData(ks);
    KeyspaceMetadata ksmDupe=ThriftConversion.fromThrift(ThriftConversion.toThrift(ksm));
    assertNotNull(ksmDupe);
    assertEquals(ksm,ksmDupe);
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCFMetaDataSerialization() throws ConfigurationException, InvalidRequestException {
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    CFMetaData cfm : Schema.instance.getTablesAndViews(keyspaceName)) {
      CFMetaData cfmDupe=ThriftConversion.fromThrift(ThriftConversion.toThrift(cfm));
      assertNotNull(cfmDupe);
      assertEquals(cfm,cfmDupe);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ColumnConditionTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleBoundIsSatisfiedByValue() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.EQ);
  ColumnCondition.Bound bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,null,null));
  assertFalse(isSatisfiedBy(bound,ONE,null));
  assertFalse(isSatisfiedBy(bound,null,ONE));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.NEQ);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,null,null));
  assertTrue(isSatisfiedBy(bound,ONE,null));
  assertTrue(isSatisfiedBy(bound,null,ONE));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.LT);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.LTE);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.GT);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.GTE);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSetCollectionBoundAppliesTo() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,null,new Sets.Value(set(ONE)),Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Sets.Value(set(ONE)),Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMapCollectionBoundIsSatisfiedByValue() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  Map<ByteBuffer,ByteBuffer> placeholderMap=new TreeMap<>();
  placeholderMap.put(ONE,ONE);
  Maps.Value placeholder=new Maps.Value(placeholderMap);
  ColumnCondition condition=ColumnCondition.condition(definition,null,placeholder,Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testListCollectionBoundAppliesTo() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ColumnIdentifierTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComparisonMethod(){
  ThreadLocalRandom random=ThreadLocalRandom.current();
  byte[] commonBytes=new byte[10];
  byte[] aBytes=new byte[16];
  byte[] bBytes=new byte[16];
  for (int i=0; i < 100000; i++) {
    int commonLength=random.nextInt(0,10);
    random.nextBytes(commonBytes);
    random.nextBytes(aBytes);
    random.nextBytes(bBytes);
    System.arraycopy(commonBytes,0,aBytes,0,commonLength);
    System.arraycopy(commonBytes,0,bBytes,0,commonLength);
    int aLength=random.nextInt(commonLength,16);
    int bLength=random.nextInt(commonLength,16);
    ColumnIdentifier a=new ColumnIdentifier(ByteBuffer.wrap(aBytes,0,aLength),BytesType.instance);
    ColumnIdentifier b=new ColumnIdentifier(ByteBuffer.wrap(bBytes,0,bLength),BytesType.instance);
    Assert.assertEquals("" + i,compareResult(a.compareTo(b)),compareResult(ByteBufferUtil.compareUnsigned(a.bytes,b.bytes)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.KeyCacheCqlTest </h4><pre class="type-6 type-7 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2iKeyCachePaths() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  createIndex("CREATE INDEX some_index ON %s (col_int)");
  insertData(table,"some_index",true);
  clearCache();
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(210,requests);
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(200,hits);
  assertEquals(420,requests);
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  int beforeSize=CacheService.instance.keyCache.size();
  CacheService.instance.keyCache.clear();
  Assert.assertEquals(0,CacheService.instance.keyCache.size());
  CacheService.instance.keyCache.loadSaved();
  assertEquals(beforeSize,CacheService.instance.keyCache.size());
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  assertNull(Schema.instance.getColumnFamilyStoreIncludingIndexes(Pair.create("foo","bar")));
  assertNull(Schema.instance.getColumnFamilyStoreIncludingIndexes(Pair.create(KEYSPACE,"bar")));
  dropTable("DROP TABLE %s");
  Schema.instance.updateVersion();
  CacheService.instance.keyCache.clear();
  CacheService.instance.keyCache.loadSaved();
  assertEquals(0,CacheService.instance.keyCache.size());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2iKeyCachePathsSaveKeysForDroppedTable() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  createIndex("CREATE INDEX some_index ON %s (col_int)");
  insertData(table,"some_index",true);
  clearCache();
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(210,requests);
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(200,hits);
  assertEquals(420,requests);
  dropTable("DROP TABLE %s");
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.keyCache.clear();
  Assert.assertEquals(0,CacheService.instance.keyCache.size());
  CacheService.instance.keyCache.loadSaved();
  Iterator<KeyCacheKey> iter=CacheService.instance.keyCache.keyIterator();
  while (iter.hasNext()) {
    KeyCacheKey key=iter.next();
    Assert.assertFalse(key.ksAndCFName.left.equals("KEYSPACE"));
    Assert.assertFalse(key.ksAndCFName.right.startsWith(table));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.PreparedStatementsTest </h4><pre class="type-7 type-15 type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void prepareAndExecuteWithCustomExpressions() throws Throwable {
  session.execute(dropKsStatement);
  session.execute(createKsStatement);
  String table="custom_expr_test";
  String index="custom_index";
  session.execute(String.format("CREATE TABLE IF NOT EXISTS %s.%s (id int PRIMARY KEY, cid int, val text);",KEYSPACE,table));
  session.execute(String.format("CREATE CUSTOM INDEX %s ON %s.%s(val) USING '%s'",index,KEYSPACE,table,StubIndex.class.getName()));
  session.execute(String.format("INSERT INTO %s.%s(id, cid, val) VALUES (0, 0, 'test')",KEYSPACE,table));
  PreparedStatement prepared1=session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(%s, 'foo')",KEYSPACE,table,index));
  assertEquals(1,session.execute(prepared1.bind()).all().size());
  PreparedStatement prepared2=session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(%s, ?)",KEYSPACE,table,index));
  assertEquals(1,session.execute(prepared2.bind("foo bar baz")).all().size());
  try {
    session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(?, 'foo bar baz')",KEYSPACE,table));
    fail("Expected syntax exception, but none was thrown");
  }
 catch (  SyntaxError e) {
    assertEquals("Bind variables cannot be used for index names",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDeleteSingleColumnInViewPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND d IS NOT NULL PRIMARY KEY (d, a, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,0));
  updateView("DELETE c FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,null));
  updateView("DELETE d FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b FROM mv1");
  assertTrue(mvRows.isExhausted());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void ttlTest() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE c IS NOT NULL AND a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (c, a, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?) USING TTL 5",1,1,1,1);
  Thread.sleep(TimeUnit.SECONDS.toMillis(3));
  updateView("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,2);
  Thread.sleep(TimeUnit.SECONDS.toMillis(3));
  List<Row> results=executeNet(protocolVersion,"SELECT d FROM mv WHERE c = 2 AND a = 1 AND b = 1").all();
  Assert.assertEquals(1,results.size());
  Assert.assertTrue("There should be a null result given back due to ttl expiry",results.get(0).isNull(0));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDeleteSingleColumnInViewClustering() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND d IS NOT NULL PRIMARY KEY (a, d, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,0));
  updateView("DELETE c FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,null));
  updateView("DELETE d FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b FROM mv1");
  assertTrue(mvRows.isExhausted());
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void conflictingTimestampTest() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE c IS NOT NULL AND a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (c, a, b)");
  for (int i=0; i < 50; i++) {
    updateView("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP 1",1,1,i);
  }
  ResultSet mvRows=executeNet(protocolVersion,"SELECT c FROM mv");
  List<Row> rows=executeNet(protocolVersion,"SELECT c FROM %s").all();
  Assert.assertEquals("There should be exactly one row in base",1,rows.size());
  int expected=rows.get(0).getInt("c");
  assertRowsNet(protocolVersion,mvRows,row(expected));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.functions.TimeFctsTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeUuidToUnixTimestamp(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes(timeInMillis,0));
  ByteBuffer output=executeFunction(TimeFcts.timeUuidToUnixTimestamp,input);
  assertEquals(timeInMillis,LongType.instance.compose(output).longValue());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeUuidToTimestamp(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes(timeInMillis,0));
  ByteBuffer output=executeFunction(TimeFcts.timeUuidToTimestamp,input);
  assertEquals(dateTime.toDate(),TimestampType.instance.compose(output));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMinTimeUuid(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=TimestampType.instance.fromString("2015-05-21 11:03:02+00");
  ByteBuffer output=executeFunction(TimeFcts.minTimeuuidFct,input);
  assertEquals(UUIDGen.minTimeUUID(timeInMillis),TimeUUIDType.instance.compose(output));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeUuidToDate(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes(timeInMillis,0));
  ByteBuffer output=executeFunction(TimeFcts.timeUuidtoDate,input);
  long expectedTime=DateTimeFormat.forPattern("yyyy-MM-dd").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21").getMillis();
  assertEquals(expectedTime,SimpleDateType.instance.toTimeInMillis(output));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampToDate(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21");
  ByteBuffer input=TimestampType.instance.fromString("2015-05-21 11:03:02+00");
  ByteBuffer output=executeFunction(TimeFcts.timestampToDate,input);
  assertEquals(dateTime.getMillis(),SimpleDateType.instance.toTimeInMillis(output));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateToTimestamp(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21");
  ByteBuffer input=SimpleDateType.instance.fromString("2015-05-21");
  ByteBuffer output=executeFunction(TimeFcts.dateToTimestamp,input);
  assertEquals(dateTime.toDate(),TimestampType.instance.compose(output));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateToUnixTimestamp(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21");
  ByteBuffer input=SimpleDateType.instance.fromString("2015-05-21");
  ByteBuffer output=executeFunction(TimeFcts.dateToUnixTimestamp,input);
  assertEquals(dateTime.getMillis(),LongType.instance.compose(output).longValue());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateOf(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes(timeInMillis,0));
  ByteBuffer output=executeFunction(TimeFcts.dateOfFct,input);
  assertEquals(dateTime.toDate(),TimestampType.instance.compose(output));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampToUnixTimestamp(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  ByteBuffer input=TimestampType.instance.decompose(dateTime.toDate());
  ByteBuffer output=executeFunction(TimeFcts.timestampToUnixTimestamp,input);
  assertEquals(dateTime.getMillis(),LongType.instance.compose(output).longValue());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMaxTimeUuid(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=TimestampType.instance.fromString("2015-05-21 11:03:02+00");
  ByteBuffer output=executeFunction(TimeFcts.maxTimeuuidFct,input);
  assertEquals(UUIDGen.maxTimeUUID(timeInMillis),TimeUUIDType.instance.compose(output));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnixTimestampOfFct(){
  DateTime dateTime=DateTimeFormat.forPattern("yyyy-MM-dd hh:mm:ss").withZone(DateTimeZone.UTC).parseDateTime("2015-05-21 11:03:02");
  long timeInMillis=dateTime.getMillis();
  ByteBuffer input=ByteBuffer.wrap(UUIDGen.getTimeUUIDBytes(timeInMillis,0));
  ByteBuffer output=executeFunction(TimeFcts.unixTimestampOfFct,input);
  assertEquals(timeInMillis,LongType.instance.compose(output).longValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.restrictions.PrimaryKeyRestrictionSetTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test '(clustering_0, clustering_1) = (1, 2)' with two clustering column
 */
@Test public void testboundsAsClusteringWithMultiEqRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  Restriction eq=newMultiEq(cfMetaData,0,value1,value2);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test mixing single equal restrictions with multi-column slice restrictions
 * (e.g. clustering_0 = 1 AND (clustering_1, clustering_2) > (2, 3))
 */
@Test public void testboundsAsClusteringWithSingleEqAndSliceRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(3);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  ByteBuffer value4=ByteBufferUtil.bytes(4);
  ByteBuffer value5=ByteBufferUtil.bytes(5);
  Restriction singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction multiSlice=newMultiSlice(cfMetaData,1,Bound.START,false,value2,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiSlice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1);
  singleEq=newSingleEq(cfMetaData,0,value1);
  multiSlice=newMultiSlice(cfMetaData,1,Bound.START,false,value2,value3);
  Restriction multiSlice2=newMultiSlice(cfMetaData,1,Bound.END,false,value4);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiSlice2).mergeWith(singleEq).mergeWith(multiSlice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value1,value4);
  singleEq=newSingleEq(cfMetaData,0,value1);
  multiSlice=newMultiSlice(cfMetaData,1,Bound.START,true,value2,value3);
  multiSlice2=newMultiSlice(cfMetaData,1,Bound.END,true,value4,value5);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiSlice2).mergeWith(singleEq).mergeWith(multiSlice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value4,value5);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test slice restriction (e.g 'clustering_0 > 1') with only one clustering column
 */
@Test public void testboundsAsClusteringWithSliceRestrictionsAndOneClusteringColumn() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(1);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  Restriction slice=newSingleSlice(cfMetaData,0,Bound.START,false,value1);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newSingleSlice(cfMetaData,0,Bound.START,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newSingleSlice(cfMetaData,0,Bound.END,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1);
  slice=newSingleSlice(cfMetaData,0,Bound.END,false,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value1);
  slice=newSingleSlice(cfMetaData,0,Bound.START,false,value1);
  Restriction slice2=newSingleSlice(cfMetaData,0,Bound.END,false,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value2);
  slice=newSingleSlice(cfMetaData,0,Bound.START,true,value1);
  slice2=newSingleSlice(cfMetaData,0,Bound.END,true,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value2);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test '(clustering_0, clustering_1) IN ((1, 2), (2, 3))' with two clustering column
 */
@Test public void testboundsAsClusteringWithMultiInRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  Restriction in=newMultiIN(cfMetaData,0,asList(value1,value2),asList(value2,value3));
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(in);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2);
  assertStartBound(get(bounds,1),true,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2);
  assertEndBound(get(bounds,1),true,value2,value3);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test 'clustering_0 IN (1, 2, 3)' with only one clustering column
 */
@Test public void testboundsAsClusteringWithOneInRestrictionsAndOneClusteringColumn() throws InvalidRequestException {
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  CFMetaData cfMetaData=newCFMetaData(2);
  Restriction in=newSingleIN(cfMetaData,0,value1,value2,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(in);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(3,bounds.size());
  assertStartBound(get(bounds,0),true,value1);
  assertStartBound(get(bounds,1),true,value2);
  assertStartBound(get(bounds,2),true,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(3,bounds.size());
  assertEndBound(get(bounds,0),true,value1);
  assertEndBound(get(bounds,1),true,value2);
  assertEndBound(get(bounds,2),true,value3);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test multi-column slice restrictions (e.g '(clustering_0) > (1)') with only one clustering column
 */
@Test public void testboundsAsClusteringWithMultiSliceRestrictionsWithOneClusteringColumn() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(1);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  Restriction slice=newMultiSlice(cfMetaData,0,Bound.START,false,value1);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newMultiSlice(cfMetaData,0,Bound.START,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newMultiSlice(cfMetaData,0,Bound.END,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1);
  slice=newMultiSlice(cfMetaData,0,Bound.END,false,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value1);
  slice=newMultiSlice(cfMetaData,0,Bound.START,false,value1);
  Restriction slice2=newMultiSlice(cfMetaData,0,Bound.END,false,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value2);
  slice=newMultiSlice(cfMetaData,0,Bound.START,true,value1);
  slice2=newMultiSlice(cfMetaData,0,Bound.END,true,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value2);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test 'clustering_0 = 1' with only one clustering column
 */
@Test public void testboundsAsClusteringWithOneEqRestrictionsAndOneClusteringColumn() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(1);
  ByteBuffer clustering_0=ByteBufferUtil.bytes(1);
  Restriction eq=newSingleEq(cfMetaData,0,clustering_0);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,clustering_0);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,clustering_0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test 'clustering_1 = 1' with 2 clustering columns
 */
@Test public void testboundsAsClusteringWithOneEqRestrictionsAndTwoClusteringColumns() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer clustering_0=ByteBufferUtil.bytes(1);
  Restriction eq=newSingleEq(cfMetaData,0,clustering_0);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,clustering_0);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,clustering_0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test multi-column slice restrictions (e.g '(clustering_0, clustering_1) > (1, 2)')
 */
@Test public void testboundsAsClusteringWithMultiSliceRestrictionsWithTwoClusteringColumn() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  Restriction slice=newMultiSlice(cfMetaData,0,Bound.START,false,value1,value2);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newMultiSlice(cfMetaData,0,Bound.START,true,value1,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyEnd(get(bounds,0));
  slice=newMultiSlice(cfMetaData,0,Bound.END,true,value1,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2);
  slice=newMultiSlice(cfMetaData,0,Bound.END,false,value1,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEmptyStart(get(bounds,0));
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value1,value2);
  slice=newMultiSlice(cfMetaData,0,Bound.START,false,value1,value2);
  Restriction slice2=newMultiSlice(cfMetaData,0,Bound.END,false,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value2);
  slice=newMultiSlice(cfMetaData,0,Bound.START,true,value1,value2);
  slice2=newMultiSlice(cfMetaData,0,Bound.END,true,value2,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value2,value1);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test mixing single and multi equals restrictions (e.g. clustering_0 = 1 AND (clustering_1, clustering_2) = (2, 3))
 */
@Test public void testboundsAsClusteringWithSingleEqAndMultiEqRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(4);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  ByteBuffer value4=ByteBufferUtil.bytes(4);
  Restriction singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction multiEq=newMultiEq(cfMetaData,1,value2,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction singleEq2=newSingleEq(cfMetaData,1,value2);
  multiEq=newMultiEq(cfMetaData,2,value3,value4);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(singleEq2).mergeWith(multiEq);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
  singleEq=newSingleEq(cfMetaData,2,value3);
  multiEq=newMultiEq(cfMetaData,0,value1,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  singleEq=newSingleEq(cfMetaData,0,value1);
  singleEq2=newSingleEq(cfMetaData,3,value4);
  multiEq=newMultiEq(cfMetaData,1,value2,value3);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiEq).mergeWith(singleEq2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test 'clustering_0 = 1 AND clustering_1 IN (1, 2, 3)'
 */
@Test public void testboundsAsClusteringWithEqAndInRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  Restriction eq=newSingleEq(cfMetaData,0,value1);
  Restriction in=newSingleIN(cfMetaData,1,value1,value2,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(in);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(3,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value1);
  assertStartBound(get(bounds,1),true,value1,value2);
  assertStartBound(get(bounds,2),true,value1,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(3,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value1);
  assertEndBound(get(bounds,1),true,value1,value2);
  assertEndBound(get(bounds,2),true,value1,value3);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testboundsAsClusteringWithSeveralMultiColumnRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(4);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  ByteBuffer value4=ByteBufferUtil.bytes(4);
  ByteBuffer value5=ByteBufferUtil.bytes(5);
  Restriction multiEq=newMultiEq(cfMetaData,0,value1,value2);
  Restriction multiSlice=newMultiSlice(cfMetaData,2,Bound.START,false,value3,value4);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiEq).mergeWith(multiSlice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2);
  multiEq=newMultiEq(cfMetaData,0,value1,value2);
  Restriction multiIN=newMultiIN(cfMetaData,2,asList(value3,value4),asList(value4,value5));
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiEq).mergeWith(multiIN);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  assertStartBound(get(bounds,1),true,value1,value2,value4,value5);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
  assertEndBound(get(bounds,1),true,value1,value2,value4,value5);
  multiEq=newMultiEq(cfMetaData,0,value1,value2);
  Restriction multiEq2=newMultiEq(cfMetaData,2,value3,value4);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiEq).mergeWith(multiEq2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3,value4);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3,value4);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test equal and slice restrictions (e.g 'clustering_0 = 0 clustering_1 > 1')
 */
@Test public void testboundsAsClusteringWithEqAndSliceRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(2);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  Restriction eq=newSingleEq(cfMetaData,0,value3);
  Restriction slice=newSingleSlice(cfMetaData,1,Bound.START,false,value1);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value3,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value3);
  slice=newSingleSlice(cfMetaData,1,Bound.START,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value3,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value3);
  slice=newSingleSlice(cfMetaData,1,Bound.END,true,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value3,value1);
  slice=newSingleSlice(cfMetaData,1,Bound.END,false,value1);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value3,value1);
  slice=newSingleSlice(cfMetaData,1,Bound.START,false,value1);
  Restriction slice2=newSingleSlice(cfMetaData,1,Bound.END,false,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value3,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),false,value3,value2);
  slice=newSingleSlice(cfMetaData,1,Bound.START,true,value1);
  slice2=newSingleSlice(cfMetaData,1,Bound.END,true,value2);
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(eq).mergeWith(slice).mergeWith(slice2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value3,value1);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value3,value2);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test mixing multi equal restrictions with single-column slice restrictions
 * (e.g. clustering_0 = 1 AND (clustering_1, clustering_2) > (2, 3))
 */
@Test public void testboundsAsClusteringWithMultiEqAndSingleSliceRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(3);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  Restriction multiEq=newMultiEq(cfMetaData,0,value1,value2);
  Restriction singleSlice=newSingleSlice(cfMetaData,2,Bound.START,false,value3);
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiEq).mergeWith(singleSlice);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),false,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test clustering_0 = 1 AND (clustering_1, clustering_2) IN ((2, 3), (4, 5))
 */
@Test public void testboundsAsClusteringWithSingleEqAndMultiINRestrictions() throws InvalidRequestException {
  CFMetaData cfMetaData=newCFMetaData(4);
  ByteBuffer value1=ByteBufferUtil.bytes(1);
  ByteBuffer value2=ByteBufferUtil.bytes(2);
  ByteBuffer value3=ByteBufferUtil.bytes(3);
  ByteBuffer value4=ByteBufferUtil.bytes(4);
  ByteBuffer value5=ByteBufferUtil.bytes(5);
  Restriction singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction multiIN=newMultiIN(cfMetaData,1,asList(value2,value3),asList(value4,value5));
  PrimaryKeyRestrictions restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiIN);
  SortedSet<Slice.Bound> bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  assertStartBound(get(bounds,1),true,value1,value4,value5);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  assertEndBound(get(bounds,1),true,value1,value4,value5);
  singleEq=newSingleEq(cfMetaData,0,value1);
  multiIN=newMultiIN(cfMetaData,1,asList(value2,value3));
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(multiIN).mergeWith(singleEq);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value2,value3);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(1,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value2,value3);
  singleEq=newSingleEq(cfMetaData,0,value1);
  Restriction singleEq2=newSingleEq(cfMetaData,1,value5);
  multiIN=newMultiIN(cfMetaData,2,asList(value2,value3),asList(value4,value5));
  restrictions=new PrimaryKeyRestrictionSet(cfMetaData.comparator,false);
  restrictions=restrictions.mergeWith(singleEq).mergeWith(multiIN).mergeWith(singleEq2);
  bounds=restrictions.boundsAsClustering(Bound.START,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertStartBound(get(bounds,0),true,value1,value5,value2,value3);
  assertStartBound(get(bounds,1),true,value1,value5,value4,value5);
  bounds=restrictions.boundsAsClustering(Bound.END,QueryOptions.DEFAULT);
  assertEquals(2,bounds.size());
  assertEndBound(get(bounds,0),true,value1,value5,value2,value3);
  assertEndBound(get(bounds,1),true,value1,value5,value4,value5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFPureScriptTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJavascriptUserType() throws Throwable {
  String type=createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + type + ">)");
  String fUdt1=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ ' '+ "LANGUAGE javascript\n"+ "AS $$"+ "     udt;$$;");
  String fUdt2=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE javascript\n"+ "AS $$"+ "     udt.getString(\"txt\");$$;");
  String fUdt3=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE javascript\n"+ "AS $$"+ "     udt.getInt(\"i\");$$;");
  execute("INSERT INTO %s (key, udt) VALUES (1, {txt: 'one', i:1})");
  UntypedResultSet rows=execute("SELECT " + fUdt1 + "(udt) FROM %s WHERE key = 1");
  Assert.assertEquals(1,rows.size());
  assertRows(execute("SELECT " + fUdt2 + "(udt) FROM %s WHERE key = 1"),row("one"));
  assertRows(execute("SELECT " + fUdt3 + "(udt) FROM %s WHERE key = 1"),row(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFTest </h4><pre class="type-7 type-4 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testComplexNullValues() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, lst list<double>, st set<text>, mp map<int, boolean>," + "tup frozen<tuple<double, text, int, boolean>>, udt frozen<" + type + ">)");
  String fList=createFunction(KEYSPACE,"list<double>","CREATE FUNCTION %s( coll list<double> ) " + "CALLED ON NULL INPUT " + "RETURNS list<double> "+ "LANGUAGE java\n"+ "AS $$return coll;$$;");
  String fSet=createFunction(KEYSPACE,"set<text>","CREATE FUNCTION %s( coll set<text> ) " + "CALLED ON NULL INPUT " + "RETURNS set<text> "+ "LANGUAGE java\n"+ "AS $$return coll;$$;");
  String fMap=createFunction(KEYSPACE,"map<int, boolean>","CREATE FUNCTION %s( coll map<int, boolean> ) " + "CALLED ON NULL INPUT " + "RETURNS map<int, boolean> "+ "LANGUAGE java\n"+ "AS $$return coll;$$;");
  String fTup=createFunction(KEYSPACE,"tuple<double, text, int, boolean>","CREATE FUNCTION %s( val tuple<double, text, int, boolean> ) " + "CALLED ON NULL INPUT " + "RETURNS tuple<double, text, int, boolean> "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
  String fUdt=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( val " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java\n"+ "AS $$return val;$$;");
  List<Double> list=Arrays.asList(1d,2d,3d);
  Set<String> set=new TreeSet<>(Arrays.asList("one","three","two"));
  Map<Integer,Boolean> map=new TreeMap<>();
  map.put(1,true);
  map.put(2,false);
  map.put(3,true);
  Object t=tuple(1d,"one",42,false);
  execute("INSERT INTO %s (key, lst, st, mp, tup, udt) VALUES (1, ?, ?, ?, ?, {txt: 'one', i:1})",list,set,map,t);
  execute("INSERT INTO %s (key, lst, st, mp, tup, udt) VALUES (2, ?, ?, ?, ?, null)",null,null,null,null);
  execute("SELECT " + fList + "(lst), "+ fSet+ "(st), "+ fMap+ "(mp), "+ fTup+ "(tup), "+ fUdt+ "(udt) FROM %s WHERE key = 1");
  UntypedResultSet.Row row=execute("SELECT " + fList + "(lst) as l, "+ fSet+ "(st) as s, "+ fMap+ "(mp) as m, "+ fTup+ "(tup) as t, "+ fUdt+ "(udt) as u "+ "FROM %s WHERE key = 1").one();
  Assert.assertNotNull(row.getBytes("l"));
  Assert.assertNotNull(row.getBytes("s"));
  Assert.assertNotNull(row.getBytes("m"));
  Assert.assertNotNull(row.getBytes("t"));
  Assert.assertNotNull(row.getBytes("u"));
  row=execute("SELECT " + fList + "(lst) as l, "+ fSet+ "(st) as s, "+ fMap+ "(mp) as m, "+ fTup+ "(tup) as t, "+ fUdt+ "(udt) as u "+ "FROM %s WHERE key = 2").one();
  Assert.assertNull(row.getBytes("l"));
  Assert.assertNull(row.getBytes("s"));
  Assert.assertNull(row.getBytes("m"));
  Assert.assertNull(row.getBytes("t"));
  Assert.assertNull(row.getBytes("u"));
  for (  int version : PROTOCOL_VERSIONS) {
    Row r=executeNet(version,"SELECT " + fList + "(lst) as l, "+ fSet+ "(st) as s, "+ fMap+ "(mp) as m, "+ fTup+ "(tup) as t, "+ fUdt+ "(udt) as u "+ "FROM %s WHERE key = 1").one();
    Assert.assertNotNull(r.getBytesUnsafe("l"));
    Assert.assertNotNull(r.getBytesUnsafe("s"));
    Assert.assertNotNull(r.getBytesUnsafe("m"));
    Assert.assertNotNull(r.getBytesUnsafe("t"));
    Assert.assertNotNull(r.getBytesUnsafe("u"));
    r=executeNet(version,"SELECT " + fList + "(lst) as l, "+ fSet+ "(st) as s, "+ fMap+ "(mp) as m, "+ fTup+ "(tup) as t, "+ fUdt+ "(udt) as u "+ "FROM %s WHERE key = 2").one();
    Assert.assertNull(r.getBytesUnsafe("l"));
    Assert.assertNull(r.getBytesUnsafe("s"));
    Assert.assertNull(r.getBytesUnsafe("m"));
    Assert.assertNull(r.getBytesUnsafe("t"));
    Assert.assertNull(r.getBytesUnsafe("u"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFunctionDropOnKeyspaceDrop() throws Throwable {
  String fSin=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s ( input double ) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  FunctionName fSinName=parseFunctionName(fSin);
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fSin)).size());
  assertRows(execute("SELECT function_name, language FROM system_schema.functions WHERE keyspace_name=?",KEYSPACE_PER_TEST),row(fSinName.name,"java"));
  dropPerTestKeyspace();
  assertRows(execute("SELECT function_name, language FROM system_schema.functions WHERE keyspace_name=?",KEYSPACE_PER_TEST));
  Assert.assertEquals(0,Schema.instance.getFunctions(fSinName).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJavaUserTypeWithUse() throws Throwable {
  String type=createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + KEYSPACE + '.'+ type+ ">)");
  execute("INSERT INTO %s (key, udt) VALUES (1, {txt: 'one', i:1})");
  for (  int version : PROTOCOL_VERSIONS) {
    executeNet(version,"USE " + KEYSPACE);
    executeNet(version,"CREATE FUNCTION f_use1( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java "+ "AS $$return "+ "     udt;$$;");
    try {
      List<Row> rowsNet=executeNet(version,"SELECT f_use1(udt) FROM %s WHERE key = 1").all();
      Assert.assertEquals(1,rowsNet.size());
      UDTValue udtVal=rowsNet.get(0).getUDTValue(0);
      Assert.assertEquals("one",udtVal.getString("txt"));
      Assert.assertEquals(1,udtVal.getInt("i"));
    }
  finally {
      executeNet(version,"DROP FUNCTION f_use1");
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserTypeDrop() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + type + ">)");
  String fName=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java "+ "AS $$return "+ "     Integer.valueOf(udt.getInt(\"i\"));$$;");
  FunctionName fNameName=parseFunctionName(fName);
  Assert.assertEquals(1,Schema.instance.getFunctions(fNameName).size());
  ResultMessage.Prepared prepared=QueryProcessor.prepare(String.format("SELECT key, %s(udt) FROM %s.%s",fName,KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  assertInvalidMessage("Cannot drop user type","DROP TYPE " + type);
  execute("DROP TABLE %s");
  assertInvalidMessage("as it is still used by function","DROP TYPE " + type);
  Assert.assertNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  Assert.assertEquals(1,Schema.instance.getFunctions(fNameName).size());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFunctionDropPreparedStatement() throws Throwable {
  createTable("CREATE TABLE %s (key int PRIMARY KEY, d double)");
  String fSin=createFunction(KEYSPACE_PER_TEST,"double","CREATE FUNCTION %s ( input double ) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(Math.sin(input.doubleValue()));'");
  FunctionName fSinName=parseFunctionName(fSin);
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fSin)).size());
  ResultMessage.Prepared preparedSelect1=QueryProcessor.prepare(String.format("SELECT key, %s(d) FROM %s.%s",fSin,KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  ResultMessage.Prepared preparedSelect2=QueryProcessor.prepare(String.format("SELECT key FROM %s.%s",KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  ResultMessage.Prepared preparedInsert1=QueryProcessor.prepare(String.format("INSERT INTO %s.%s (key, d) VALUES (?, %s(?))",KEYSPACE,currentTable(),fSin),ClientState.forInternalCalls(),false);
  ResultMessage.Prepared preparedInsert2=QueryProcessor.prepare(String.format("INSERT INTO %s.%s (key, d) VALUES (?, ?)",KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedSelect1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedSelect2.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedInsert1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedInsert2.statementId));
  execute("DROP FUNCTION " + fSin + "(double);");
  Assert.assertNull(QueryProcessor.instance.getPrepared(preparedSelect1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedSelect2.statementId));
  Assert.assertNull(QueryProcessor.instance.getPrepared(preparedInsert1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedInsert2.statementId));
  execute("CREATE FUNCTION " + fSin + " ( input double ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java "+ "AS 'return Double.valueOf(Math.sin(input));'");
  Assert.assertEquals(1,Schema.instance.getFunctions(fSinName).size());
  preparedSelect1=QueryProcessor.prepare(String.format("SELECT key, %s(d) FROM %s.%s",fSin,KEYSPACE,currentTable()),ClientState.forInternalCalls(),false);
  preparedInsert1=QueryProcessor.prepare(String.format("INSERT INTO %s.%s (key, d) VALUES (?, %s(?))",KEYSPACE,currentTable(),fSin),ClientState.forInternalCalls(),false);
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedSelect1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedInsert1.statementId));
  dropPerTestKeyspace();
  Assert.assertNull(QueryProcessor.instance.getPrepared(preparedSelect1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedSelect2.statementId));
  Assert.assertNull(QueryProcessor.instance.getPrepared(preparedInsert1.statementId));
  Assert.assertNotNull(QueryProcessor.instance.getPrepared(preparedInsert2.statementId));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJavaUserType() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + type + ">)");
  String fUdt0=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java "+ "AS $$return "+ "     udt;$$;");
  String fUdt1=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java "+ "AS $$return "+ "     udt.getString(\"txt\");$$;");
  String fUdt2=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + ") "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java "+ "AS $$return "+ "     Integer.valueOf(udt.getInt(\"i\"));$$;");
  execute("INSERT INTO %s (key, udt) VALUES (1, {txt: 'one', i:1})");
  UntypedResultSet rows=execute("SELECT " + fUdt0 + "(udt) FROM %s WHERE key = 1");
  Assert.assertEquals(1,rows.size());
  assertRows(execute("SELECT " + fUdt1 + "(udt) FROM %s WHERE key = 1"),row("one"));
  assertRows(execute("SELECT " + fUdt2 + "(udt) FROM %s WHERE key = 1"),row(1));
  for (  int version : PROTOCOL_VERSIONS) {
    List<Row> rowsNet=executeNet(version,"SELECT " + fUdt0 + "(udt) FROM %s WHERE key = 1").all();
    Assert.assertEquals(1,rowsNet.size());
    UDTValue udtVal=rowsNet.get(0).getUDTValue(0);
    Assert.assertEquals("one",udtVal.getString("txt"));
    Assert.assertEquals(1,udtVal.getInt("i"));
    assertRowsNet(version,executeNet(version,"SELECT " + fUdt1 + "(udt) FROM %s WHERE key = 1"),row("one"));
    assertRowsNet(version,executeNet(version,"SELECT " + fUdt2 + "(udt) FROM %s WHERE key = 1"),row(1));
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJavaUserTypeAddFieldWithReplace() throws Throwable {
  String type=KEYSPACE + '.' + createType("CREATE TYPE %s (txt text, i int)");
  createTable("CREATE TABLE %s (key int primary key, udt frozen<" + type + ">)");
  String fName1replace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + ") "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$return udt.getString(\"txt\");$$;");
  String fName2replace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS $$return Integer.valueOf(udt.getInt(\"i\"));$$;");
  String fName3replace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java\n"+ "AS $$return Double.valueOf(udt.getDouble(\"added\"));$$;");
  String fName4replace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java\n"+ "AS $$return udt;$$;");
  String fName1noReplace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS text "+ "LANGUAGE java\n"+ "AS $$return udt.getString(\"txt\");$$;");
  String fName2noReplace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS int "+ "LANGUAGE java\n"+ "AS $$return Integer.valueOf(udt.getInt(\"i\"));$$;");
  String fName3noReplace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "CALLED ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE java\n"+ "AS $$return Double.valueOf(udt.getDouble(\"added\"));$$;");
  String fName4noReplace=createFunction(KEYSPACE,type,"CREATE FUNCTION %s( udt " + type + " ) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS "+ type+ " "+ "LANGUAGE java\n"+ "AS $$return udt;$$;");
  execute("INSERT INTO %s (key, udt) VALUES (1, {txt: 'one', i:1})");
  assertRows(execute("SELECT " + fName1replace + "(udt) FROM %s WHERE key = 1"),row("one"));
  assertRows(execute("SELECT " + fName2replace + "(udt) FROM %s WHERE key = 1"),row(1));
  execute("ALTER TYPE " + type + " ADD added double");
  execute("INSERT INTO %s (key, udt) VALUES (2, {txt: 'two', i:2, added: 2})");
  execute(String.format("CREATE OR REPLACE FUNCTION %s( udt %s ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS text "+ "LANGUAGE java\n"+ "AS $$return "+ "     udt.getString(\"txt\");$$;",fName1replace,type));
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fName1replace)).size());
  execute(String.format("CREATE OR REPLACE FUNCTION %s( udt %s ) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE java\n"+ "AS $$return "+ "     Integer.valueOf(udt.getInt(\"i\"));$$;",fName2replace,type));
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fName2replace)).size());
  execute(String.format("CREATE OR REPLACE FUNCTION %s( udt %s ) " + "CALLED ON NULL INPUT " + "RETURNS double "+ "LANGUAGE java\n"+ "AS $$return "+ "     Double.valueOf(udt.getDouble(\"added\"));$$;",fName3replace,type));
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fName3replace)).size());
  execute(String.format("CREATE OR REPLACE FUNCTION %s( udt %s ) " + "RETURNS NULL ON NULL INPUT " + "RETURNS %s "+ "LANGUAGE java\n"+ "AS $$return "+ "     udt;$$;",fName4replace,type,type));
  Assert.assertEquals(1,Schema.instance.getFunctions(parseFunctionName(fName4replace)).size());
  assertRows(execute("SELECT " + fName1replace + "(udt) FROM %s WHERE key = 2"),row("two"));
  assertRows(execute("SELECT " + fName2replace + "(udt) FROM %s WHERE key = 2"),row(2));
  assertRows(execute("SELECT " + fName3replace + "(udt) FROM %s WHERE key = 2"),row(2d));
  assertRows(execute("SELECT " + fName3replace + "(udt) FROM %s WHERE key = 1"),row(0d));
  assertRows(execute("SELECT " + fName1noReplace + "(udt) FROM %s WHERE key = 2"),row("two"));
  assertRows(execute("SELECT " + fName2noReplace + "(udt) FROM %s WHERE key = 2"),row(2));
  assertRows(execute("SELECT " + fName3noReplace + "(udt) FROM %s WHERE key = 2"),row(2d));
  assertRows(execute("SELECT " + fName3noReplace + "(udt) FROM %s WHERE key = 1"),row(0d));
  execute("DROP FUNCTION " + fName1replace);
  execute("DROP FUNCTION " + fName2replace);
  execute("DROP FUNCTION " + fName3replace);
  execute("DROP FUNCTION " + fName4replace);
  execute("DROP FUNCTION " + fName1noReplace);
  execute("DROP FUNCTION " + fName2noReplace);
  execute("DROP FUNCTION " + fName3noReplace);
  execute("DROP FUNCTION " + fName4noReplace);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.TombstonesTest </h4><pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBeyondThresholdSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
    fail("SELECT with tombstones beyond the threshold should have failed, but hasn't");
  }
 catch (  Throwable e) {
    String error="Expected exception instanceof TombstoneOverwhelmingException instead got " + System.lineSeparator() + Throwables.getStackTraceAsString(e);
    assertTrue(error,e instanceof TombstoneOverwhelmingException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.AggregationTest </h4><pre class="type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testFunctionDropPreparedStatement() throws Throwable {
  String otherKS="cqltest_foo";
  execute("CREATE KEYSPACE IF NOT EXISTS " + otherKS + " WITH replication = {'class': 'SimpleStrategy', 'replication_factor': 3};");
  try {
    execute("CREATE TABLE " + otherKS + ".jsdp (a int primary key, b int)");
    String fState=createFunction(otherKS,"int, int","CREATE FUNCTION %s(a int, b int) " + "CALLED ON NULL INPUT " + "RETURNS int "+ "LANGUAGE javascript "+ "AS 'a + b;'");
    String a=createAggregate(otherKS,"int","CREATE AGGREGATE %s(int) " + "SFUNC " + shortFunctionName(fState) + " "+ "STYPE int");
    ResultMessage.Prepared prepared=QueryProcessor.prepare("SELECT " + a + "(b) FROM "+ otherKS+ ".jsdp",ClientState.forInternalCalls(),false);
    assertNotNull(QueryProcessor.instance.getPrepared(prepared.statementId));
    execute("DROP AGGREGATE " + a + "(int)");
    assertNull(QueryProcessor.instance.getPrepared(prepared.statementId));
    execute("CREATE AGGREGATE " + a + "(int) "+ "SFUNC "+ shortFunctionName(fState)+ " "+ "STYPE int");
    prepared=QueryProcessor.prepare("SELECT " + a + "(b) FROM "+ otherKS+ ".jsdp",ClientState.forInternalCalls(),false);
    assertNotNull(QueryProcessor.instance.getPrepared(prepared.statementId));
    execute("DROP KEYSPACE " + otherKS + ";");
    assertNull(QueryProcessor.instance.getPrepared(prepared.statementId));
  }
  finally {
    execute("DROP KEYSPACE IF EXISTS " + otherKS + ";");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.AlterTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterIndexInterval() throws Throwable {
  String tableName=createTable("CREATE TABLE IF NOT EXISTS %s (id uuid, album text, artist text, data blob, PRIMARY KEY (id))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  alterTable("ALTER TABLE %s WITH min_index_interval=256 AND max_index_interval=512");
  assertEquals(256,cfs.metadata.params.minIndexInterval);
  assertEquals(512,cfs.metadata.params.maxIndexInterval);
  alterTable("ALTER TABLE %s WITH caching = {}");
  assertEquals(256,cfs.metadata.params.minIndexInterval);
  assertEquals(512,cfs.metadata.params.maxIndexInterval);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.DeleteTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deletion by 'composite prefix' (range tombstones)
 * migrated from cql_tests.py:TestCQL.range_tombstones_test()
 */
@Test public void testDeleteByCompositePrefix() throws Throwable {
  createTable("CREATE TABLE %s ( k int, c1 int, c2 int, v1 int, v2 int, PRIMARY KEY (k, c1, c2))");
  int numRows=5;
  int col1=2;
  int col2=2;
  int cpr=col1 * col2;
  for (int i=0; i < numRows; i++)   for (int j=0; j < col1; j++)   for (int k=0; k < col2; k++) {
    int n=(i * cpr) + (j * col2) + k;
    execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",i,j,k,n,n);
  }
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s where k = ?",i));
    for (int x=i * cpr; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr][0]);
      assertEquals(x,rows[x - i * cpr][1]);
    }
  }
  for (int i=0; i < numRows; i++)   execute("DELETE FROM %s WHERE k = ? AND c1 = 0",i);
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s WHERE k = ?",i));
    for (int x=i * cpr + col1; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr - col1][0]);
      assertEquals(x,rows[x - i * cpr - col1][1]);
    }
  }
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s WHERE k = ?",i));
    for (int x=i * cpr + col1; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr - col1][0]);
      assertEquals(x,rows[x - i * cpr - col1][1]);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deletions
 * migrated from cql_tests.py:TestCQL.no_range_ghost_test()
 */
@Test public void testNoRangeGhost() throws Throwable {
  createTable("CREATE TABLE %s ( k int PRIMARY KEY, v int ) ");
  for (int k=0; k < 5; k++)   execute("INSERT INTO %s (k, v) VALUES (?, 0)",k);
  Object[][] rows=getRows(execute("SELECT k FROM %s"));
  int[] ordered=sortIntRows(rows);
  for (int k=0; k < 5; k++)   assertEquals(k,ordered[k]);
  execute("DELETE FROM %s WHERE k=2");
  rows=getRows(execute("SELECT k FROM %s"));
  ordered=sortIntRows(rows);
  int idx=0;
  for (int k=0; k < 5; k++)   if (k != 2)   assertEquals(k,ordered[idx++]);
  createTable("CREATE TABLE %s ( KEY varchar PRIMARY KEY, password varchar, gender varchar, birth_year bigint)");
  execute("INSERT INTO %s (KEY, password) VALUES ('user1', 'ch@ngem3a')");
  execute("UPDATE %s SET gender = 'm', birth_year = 1980 WHERE KEY = 'user1'");
  assertRows(execute("SELECT * FROM %s WHERE KEY='user1'"),row("user1",1980L,"m","ch@ngem3a"));
  execute("TRUNCATE %s");
  assertEmpty(execute("SELECT * FROM %s"));
  assertEmpty(execute("SELECT * FROM %s WHERE KEY='user1'"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_ddl_index_test()
 */
@Test public void testDropCreateIndexIfNotExists() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (id text PRIMARY KEY, value1 blob, value2 blob)with comment = 'foo'");
  execute("use " + KEYSPACE);
  schemaChange("DROP INDEX IF EXISTS myindex");
  createIndex("CREATE INDEX IF NOT EXISTS myindex ON %s (value1)");
  assertTrue(waitForIndex(KEYSPACE,tableName,"myindex"));
  execute("CREATE INDEX IF NOT EXISTS myindex ON %s (value1)");
  execute("DROP INDEX IF EXISTS myindex");
  Object[][] rows=getRows(execute("select index_name from system.\"IndexInfo\" where table_name = ?",tableName));
  assertEquals(0,rows.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectTest </h4><pre class="type-6 type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test token ranges
 * migrated from cql_tests.py:TestCQL.token_range_test()
 */
@Test public void testTokenRange() throws Throwable {
  createTable(" CREATE TABLE %s (k int PRIMARY KEY, c int, v int)");
  int c=100;
  for (int i=0; i < c; i++)   execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",i,i,i);
  Object[][] res=getRows(execute("SELECT k FROM %s"));
  assertEquals(c,res.length);
  Object[] inOrder=new Object[res.length];
  for (int i=0; i < res.length; i++)   inOrder[i]=res[i][0];
  Long min_token=Long.MIN_VALUE;
  res=getRows(execute(String.format("SELECT k FROM %s.%s WHERE token(k) >= %d",keyspace(),currentTable(),min_token)));
  assertEquals(c,res.length);
  res=getRows(execute(String.format("SELECT k FROM %s.%s WHERE token(k) >= token(%d) AND token(k) < token(%d)",keyspace(),currentTable(),inOrder[32],inOrder[65])));
  for (int i=32; i < 65; i++)   Assert.assertEquals(inOrder[i],res[i - 32][0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CellTest </h4><pre class="type-7 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testConflictingTypeEquality(){
  boolean[] tf=new boolean[]{true,false};
  for (  boolean lhs : tf) {
    for (    boolean rhs : tf) {
      if (lhs && rhs)       continue;
      Cell a=expiring(cfm,"val","a",1,1);
      Cell b=regular(cfm,"val","a",1);
      Assert.assertNotSame(a,b);
      Assert.assertNotSame(b,a);
      a=deleted(cfm,"val",1,1);
      Assert.assertNotSame(a,b);
      Assert.assertNotSame(b,a);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComplexCellReconcile(){
  ColumnDefinition m=cfm2.getColumnDefinition(new ColumnIdentifier("m",false));
  int now1=FBUtilities.nowInSeconds();
  long ts1=now1 * 1000000;
  Cell r1m1=BufferCell.live(cfm2,m,ts1,bb(1),CellPath.create(bb(1)));
  Cell r1m2=BufferCell.live(cfm2,m,ts1,bb(2),CellPath.create(bb(2)));
  List<Cell> cells1=Lists.newArrayList(r1m1,r1m2);
  int now2=now1 + 1;
  long ts2=now2 * 1000000;
  Cell r2m2=BufferCell.live(cfm2,m,ts2,bb(1),CellPath.create(bb(2)));
  Cell r2m3=BufferCell.live(cfm2,m,ts2,bb(2),CellPath.create(bb(3)));
  Cell r2m4=BufferCell.live(cfm2,m,ts2,bb(3),CellPath.create(bb(4)));
  List<Cell> cells2=Lists.newArrayList(r2m2,r2m3,r2m4);
  RowBuilder builder=new RowBuilder();
  Cells.reconcileComplex(m,cells1.iterator(),cells2.iterator(),DeletionTime.LIVE,builder,now2 + 1);
  Assert.assertEquals(Lists.newArrayList(r1m1,r2m2,r2m3,r2m4),builder.cells);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CleanupTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCleanupWithNewToken() throws ExecutionException, InterruptedException, UnknownHostException {
  StorageService.instance.getTokenMetadata().clearUnsafe();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  fillCF(cfs,"val",LOOPS);
  assertEquals(LOOPS,Util.getAll(Util.cmd(cfs).build()).size());
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  byte[] tk1=new byte[1], tk2=new byte[1];
  tk1[0]=2;
  tk2[0]=1;
  tmd.updateNormalToken(new BytesToken(tk1),InetAddress.getByName("127.0.0.1"));
  tmd.updateNormalToken(new BytesToken(tk2),InetAddress.getByName("127.0.0.2"));
  CompactionManager.instance.performCleanup(cfs);
  assertEquals(0,Util.getAll(Util.cmd(cfs).build()).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNeedsCleanup() throws Exception {
  StorageService.instance.getTokenMetadata().clearUnsafe();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  fillCF(cfs,"val",LOOPS);
  SSTableReader ssTable=cfs.getLiveSSTables().iterator().next();
  final Token ssTableMin=ssTable.first.getToken();
  final Token ssTableMax=ssTable.last.getToken();
  final Token min=token((byte)0);
  final Token before1=token((byte)2);
  final Token before2=token((byte)5);
  final Token before3=token((byte)10);
  final Token before4=token((byte)47);
  final Token insideSsTable1=token((byte)50);
  final Token insideSsTable2=token((byte)55);
  final Token max=token((byte)127,(byte)127,(byte)127,(byte)127);
  assert (min.compareTo(ssTableMin) < 0);
  assert (before1.compareTo(ssTableMin) < 0);
  assert (before2.compareTo(ssTableMin) < 0);
  assert (before3.compareTo(ssTableMin) < 0);
  assert (before4.compareTo(ssTableMin) < 0);
  assert (ssTableMin.compareTo(insideSsTable1) < 0);
  assert (insideSsTable1.compareTo(ssTableMax) < 0);
  assert (ssTableMin.compareTo(insideSsTable2) < 0);
  assert (insideSsTable2.compareTo(ssTableMax) < 0);
  assert (ssTableMax.compareTo(max) < 0);
  List<Map.Entry<Boolean,List<Range<Token>>>> testCases=new LinkedList<Map.Entry<Boolean,List<Range<Token>>>>(){
{
      add(entry(false,Arrays.asList(range(min,max))));
      add(entry(true,Arrays.asList(range(min,insideSsTable1))));
      add(entry(true,Arrays.asList(range(insideSsTable1,max))));
      add(entry(true,Arrays.asList(range(min,ssTableMin))));
      add(entry(true,Arrays.asList(range(ssTableMax,max))));
      add(entry(true,Arrays.asList(range(min,insideSsTable1),range(insideSsTable2,max))));
      add(entry(true,Arrays.asList(range(ssTableMin,ssTableMax))));
      add(entry(false,Arrays.asList(range(before4,max))));
      add(entry(false,Arrays.asList(range(min,before1),range(before2,before3),range(before4,max))));
    }
  }
;
  for (  Map.Entry<Boolean,List<Range<Token>>> testCase : testCases) {
    assertEquals(testCase.getKey(),CompactionManager.needsCleanup(ssTable,testCase.getValue()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testuserDefinedCleanupWithNewToken() throws ExecutionException, InterruptedException, UnknownHostException {
  StorageService.instance.getTokenMetadata().clearUnsafe();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  fillCF(cfs,"val",LOOPS);
  assertEquals(LOOPS,Util.getAll(Util.cmd(cfs).build()).size());
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  byte[] tk1=new byte[1], tk2=new byte[1];
  tk1[0]=2;
  tk2[0]=1;
  tmd.updateNormalToken(new BytesToken(tk1),InetAddress.getByName("127.0.0.1"));
  tmd.updateNormalToken(new BytesToken(tk2),InetAddress.getByName("127.0.0.2"));
  for (  SSTableReader r : cfs.getLiveSSTables())   CompactionManager.instance.forceUserDefinedCleanup(r.getFilename());
  assertEquals(0,Util.getAll(Util.cmd(cfs).build()).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCleanupWithIndexes() throws IOException, ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_INDEXED1);
  fillCF(cfs,"birthdate",LOOPS);
  assertEquals(LOOPS,Util.getAll(Util.cmd(cfs).build()).size());
  ColumnDefinition cdef=cfs.metadata.getColumnDefinition(COLUMN);
  String indexName="birthdate_key_index";
  long start=System.nanoTime();
  while (!cfs.getBuiltIndexes().contains(indexName) && System.nanoTime() - start < TimeUnit.SECONDS.toNanos(10))   Thread.sleep(10);
  RowFilter cf=RowFilter.create();
  cf.add(cdef,Operator.EQ,VALUE);
  assertEquals(LOOPS,Util.getAll(Util.cmd(cfs).filterOn("birthdate",Operator.EQ,VALUE).build()).size());
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  byte[] tk1=new byte[1], tk2=new byte[1];
  tk1[0]=2;
  tk2[0]=1;
  tmd.updateNormalToken(new BytesToken(tk1),InetAddress.getByName("127.0.0.1"));
  tmd.updateNormalToken(new BytesToken(tk2),InetAddress.getByName("127.0.0.2"));
  CompactionManager.instance.performCleanup(cfs);
  assertEquals(0,Util.getAll(Util.cmd(cfs).build()).size());
  assert cfs.getLiveSSTables().isEmpty();
  assertEquals(0,Util.getAll(Util.cmd(cfs).filterOn("birthdate",Operator.EQ,VALUE).build()).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnFamilyStoreTest </h4><pre class="type-7 type-4 type-5 type-19 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearEphemeralSnapshots() throws Throwable {
  Assume.assumeTrue(!FBUtilities.isWindows());
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_INDEX1);
  cfs.clearSnapshot("");
  int numRows=1000;
  long[] colValues=new long[numRows * 2];
  for (int i=0; i < colValues.length; i+=2) {
    colValues[i]=(i % 4 == 0 ? 1L : 2L);
    colValues[i + 1]=3L;
  }
  ScrubTest.fillIndexCF(cfs,false,colValues);
  cfs.snapshot("nonEphemeralSnapshot",null,false,false);
  cfs.snapshot("ephemeralSnapshot",null,true,false);
  Map<String,Pair<Long,Long>> snapshotDetails=cfs.getSnapshotDetails();
  assertEquals(2,snapshotDetails.size());
  assertTrue(snapshotDetails.containsKey("ephemeralSnapshot"));
  assertTrue(snapshotDetails.containsKey("nonEphemeralSnapshot"));
  ColumnFamilyStore.clearEphemeralSnapshots(cfs.getDirectories());
  snapshotDetails=cfs.getSnapshotDetails();
  assertEquals(1,snapshotDetails.size());
  assertTrue(snapshotDetails.containsKey("nonEphemeralSnapshot"));
  cfs.clearSnapshot("");
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBackupAfterFlush() throws Throwable {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE2).getColumnFamilyStore(CF_STANDARD1);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key1")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key2")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  for (int version=1; version <= 2; ++version) {
    Descriptor existing=new Descriptor(cfs.getDirectories().getDirectoryForNewSSTables(),KEYSPACE2,CF_STANDARD1,version);
    Descriptor desc=new Descriptor(Directories.getBackupsDirectory(existing),KEYSPACE2,CF_STANDARD1,version);
    for (    Component c : new Component[]{Component.DATA,Component.PRIMARY_INDEX,Component.FILTER,Component.STATS})     assertTrue("Cannot find backed-up file:" + desc.filenameFor(c),new File(desc.filenameFor(c)).exists());
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeSortedQuery(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,"key1").clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  ((ClearableHistogram)cfs.metric.sstablesPerReadHistogram.cf).clear();
  Util.getAll(Util.cmd(cfs,"key1").includeRow("c1").build());
  assertEquals(1,cfs.metric.sstablesPerReadHistogram.cf.getCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubDataDirectories() throws Throwable {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  ColumnFamilyStore.scrubDataDirectories(cfs.metadata);
  new RowUpdateBuilder(cfs.metadata,2,"key").clustering("name").add("val","2").build().applyUnsafe();
  cfs.forceBlockingFlush();
  Collection<SSTableReader> ssTables=cfs.getLiveSSTables();
  assertEquals(1,ssTables.size());
  SSTableReader ssTable=ssTables.iterator().next();
  String dataFileName=ssTable.descriptor.filenameFor(Component.DATA);
  String tmpDataFileName=ssTable.descriptor.tmpFilenameFor(Component.DATA);
  new File(dataFileName).renameTo(new File(tmpDataFileName));
  ssTable.selfRef().release();
  ColumnFamilyStore.scrubDataDirectories(cfs.metadata);
  List<File> ssTableFiles=new Directories(cfs.metadata).sstableLister(Directories.OnTxnErr.THROW).listFiles();
  assertNotNull(ssTableFiles);
  assertEquals(0,ssTableFiles.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetColumnWithWrongBF(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  List<Mutation> rms=new LinkedList<>();
  rms.add(new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("Column1").add("val","asdf").build());
  Util.writeColumnFamily(rms);
  List<SSTableReader> ssTables=keyspace.getAllSSTables(SSTableSet.LIVE);
  assertEquals(1,ssTables.size());
  ssTables.get(0).forceFilterFailures();
  Util.assertEmpty(Util.cmd(cfs,"key2").build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterCacheTest </h4><pre class="type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  cfs.truncateBlocking();
  CacheService.instance.invalidateCounterCache();
  Clustering c1=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(1)).build();
  Clustering c2=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(2)).build();
  ColumnDefinition cd=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("c"));
  assertEquals(0,CacheService.instance.counterCache.size());
  assertNull(cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c2,cd,null));
  cfs.putCachedCounter(bytes(1),c1,cd,null,ClockAndCount.create(1L,1L));
  cfs.putCachedCounter(bytes(1),c2,cd,null,ClockAndCount.create(1L,2L));
  cfs.putCachedCounter(bytes(2),c1,cd,null,ClockAndCount.create(2L,1L));
  cfs.putCachedCounter(bytes(2),c2,cd,null,ClockAndCount.create(2L,2L));
  assertEquals(ClockAndCount.create(1L,1L),cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertEquals(ClockAndCount.create(1L,2L),cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertEquals(ClockAndCount.create(2L,1L),cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertEquals(ClockAndCount.create(2L,2L),cfs.getCachedCounter(bytes(2),c2,cd,null));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSaveLoad() throws ExecutionException, InterruptedException, WriteTimeoutException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  cfs.truncateBlocking();
  CacheService.instance.invalidateCounterCache();
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,0,bytes(1)).clustering(1).add("c",1L).build(),ConsistencyLevel.ONE).apply();
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,0,bytes(1)).clustering(2).add("c",2L).build(),ConsistencyLevel.ONE).apply();
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,0,bytes(2)).clustering(1).add("c",1L).build(),ConsistencyLevel.ONE).apply();
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,0,bytes(2)).clustering(2).add("c",2L).build(),ConsistencyLevel.ONE).apply();
  assertEquals(4,CacheService.instance.counterCache.size());
  CacheService.instance.counterCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.invalidateCounterCache();
  assertEquals(0,CacheService.instance.counterCache.size());
  CacheService.instance.counterCache.loadSaved();
  assertEquals(4,CacheService.instance.counterCache.size());
  Clustering c1=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(1)).build();
  Clustering c2=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(2)).build();
  ColumnDefinition cd=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("c"));
  assertEquals(ClockAndCount.create(1L,1L),cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertEquals(ClockAndCount.create(1L,2L),cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertEquals(ClockAndCount.create(1L,1L),cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertEquals(ClockAndCount.create(1L,2L),cfs.getCachedCounter(bytes(2),c2,cd,null));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCounterCacheInvalidate(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  cfs.truncateBlocking();
  CacheService.instance.invalidateCounterCache();
  Clustering c1=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(1)).build();
  Clustering c2=CBuilder.create(cfs.metadata.comparator).add(ByteBufferUtil.bytes(2)).build();
  ColumnDefinition cd=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("c"));
  assertEquals(0,CacheService.instance.counterCache.size());
  assertNull(cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c2,cd,null));
  assertNull(cfs.getCachedCounter(bytes(3),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(3),c2,cd,null));
  cfs.putCachedCounter(bytes(1),c1,cd,null,ClockAndCount.create(1L,1L));
  cfs.putCachedCounter(bytes(1),c2,cd,null,ClockAndCount.create(1L,2L));
  cfs.putCachedCounter(bytes(2),c1,cd,null,ClockAndCount.create(2L,1L));
  cfs.putCachedCounter(bytes(2),c2,cd,null,ClockAndCount.create(2L,2L));
  cfs.putCachedCounter(bytes(3),c1,cd,null,ClockAndCount.create(3L,1L));
  cfs.putCachedCounter(bytes(3),c2,cd,null,ClockAndCount.create(3L,2L));
  assertEquals(ClockAndCount.create(1L,1L),cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertEquals(ClockAndCount.create(1L,2L),cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertEquals(ClockAndCount.create(2L,1L),cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertEquals(ClockAndCount.create(2L,2L),cfs.getCachedCounter(bytes(2),c2,cd,null));
  assertEquals(ClockAndCount.create(3L,1L),cfs.getCachedCounter(bytes(3),c1,cd,null));
  assertEquals(ClockAndCount.create(3L,2L),cfs.getCachedCounter(bytes(3),c2,cd,null));
  cfs.invalidateCounterCache(Collections.singleton(new Bounds<Token>(cfs.decorateKey(bytes(1)).getToken(),cfs.decorateKey(bytes(2)).getToken())));
  assertEquals(2,CacheService.instance.counterCache.size());
  assertNull(cfs.getCachedCounter(bytes(1),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(1),c2,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c1,cd,null));
  assertNull(cfs.getCachedCounter(bytes(2),c2,cd,null));
  assertEquals(ClockAndCount.create(3L,1L),cfs.getCachedCounter(bytes(3),c1,cd,null));
  assertEquals(ClockAndCount.create(3L,2L),cfs.getCachedCounter(bytes(3),c2,cd,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterCellTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDiff(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  ByteBuffer col=ByteBufferUtil.bytes("val");
  Cell leftCell;
  Cell rightCell;
  leftCell=createLegacyCounterCell(cfs,col,2,2);
  rightCell=createLegacyCounterCell(cfs,col,2,1);
  assertEquals(CounterContext.Relationship.EQUAL,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  leftCell=createLegacyCounterCell(cfs,col,1,2);
  rightCell=createLegacyCounterCell(cfs,col,2,1);
  assertEquals(CounterContext.Relationship.DISJOINT,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  CounterId id=CounterId.generate();
  leftCell=createCounterCell(cfs,col,id,2,2);
  rightCell=createCounterCell(cfs,col,id,2,1);
  assertEquals(CounterContext.Relationship.GREATER_THAN,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  ContextState leftContext;
  ContextState rightContext;
  leftContext=ContextState.allocate(0,0,3);
  leftContext.writeRemote(CounterId.fromInt(3),3L,0L);
  leftContext.writeRemote(CounterId.fromInt(6),2L,0L);
  leftContext.writeRemote(CounterId.fromInt(9),1L,0L);
  rightContext=ContextState.wrap(ByteBufferUtil.clone(leftContext.context));
  leftCell=createCounterCellFromContext(cfs,col,leftContext,1);
  rightCell=createCounterCellFromContext(cfs,col,rightContext,1);
  assertEquals(CounterContext.Relationship.EQUAL,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  leftContext=ContextState.allocate(0,0,4);
  leftContext.writeRemote(CounterId.fromInt(3),3L,0L);
  leftContext.writeRemote(CounterId.fromInt(6),2L,0L);
  leftContext.writeRemote(CounterId.fromInt(9),1L,0L);
  leftContext.writeRemote(CounterId.fromInt(12),0L,0L);
  rightContext=ContextState.allocate(0,0,3);
  rightContext.writeRemote(CounterId.fromInt(3),3L,0L);
  rightContext.writeRemote(CounterId.fromInt(6),2L,0L);
  rightContext.writeRemote(CounterId.fromInt(9),1L,0L);
  leftCell=createCounterCellFromContext(cfs,col,leftContext,1);
  rightCell=createCounterCellFromContext(cfs,col,rightContext,1);
  assertEquals(CounterContext.Relationship.GREATER_THAN,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  assertEquals(CounterContext.Relationship.LESS_THAN,CounterContext.instance().diff(rightCell.value(),leftCell.value()));
  leftContext=ContextState.allocate(0,0,3);
  leftContext.writeRemote(CounterId.fromInt(3),1L,0L);
  leftContext.writeRemote(CounterId.fromInt(4),1L,0L);
  leftContext.writeRemote(CounterId.fromInt(9),1L,0L);
  rightContext=ContextState.allocate(0,0,3);
  rightContext.writeRemote(CounterId.fromInt(3),1L,0L);
  rightContext.writeRemote(CounterId.fromInt(6),1L,0L);
  rightContext.writeRemote(CounterId.fromInt(9),1L,0L);
  leftCell=createCounterCellFromContext(cfs,col,leftContext,1);
  rightCell=createCounterCellFromContext(cfs,col,rightContext,1);
  assertEquals(CounterContext.Relationship.DISJOINT,CounterContext.instance().diff(leftCell.value(),rightCell.value()));
  assertEquals(CounterContext.Relationship.DISJOINT,CounterContext.instance().diff(rightCell.value(),leftCell.value()));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReconcile(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  ByteBuffer col=ByteBufferUtil.bytes("val");
  Cell left;
  Cell right;
  left=createDeleted(cfs,col,2,5);
  right=createDeleted(cfs,col,2,10);
  assert Cells.reconcile(left,right,10) == right;
  right=createLegacyCounterCell(cfs,col,1,10);
  assert Cells.reconcile(left,right,10) == left;
  left=createDeleted(cfs,col,6,6);
  right=createLegacyCounterCell(cfs,col,1,5);
  assert Cells.reconcile(left,right,10) == left;
  left=createDeleted(cfs,col,1,1);
  right=createLegacyCounterCell(cfs,col,1,5);
  assert Cells.reconcile(left,right,10) == left;
  left=createDeleted(cfs,col,8,8);
  right=createLegacyCounterCell(cfs,col,1,8);
  assert Cells.reconcile(left,right,10) == left;
  left=createLegacyCounterCell(cfs,col,1,2);
  right=createLegacyCounterCell(cfs,col,3,5);
  Cell reconciled=Cells.reconcile(left,right,10);
  assertEquals(CounterContext.instance().total(reconciled.value()),4);
  assertEquals(reconciled.timestamp(),5L);
  Cell addTen=createLegacyCounterCell(cfs,col,10,4);
  reconciled=Cells.reconcile(reconciled,addTen,10);
  assertEquals(CounterContext.instance().total(reconciled.value()),14);
  assertEquals(reconciled.timestamp(),5L);
  Cell addThree=createLegacyCounterCell(cfs,col,3,7);
  reconciled=Cells.reconcile(reconciled,addThree,10);
  assertEquals(CounterContext.instance().total(reconciled.value()),17);
  assertEquals(reconciled.timestamp(),7L);
  assert reconciled.localDeletionTime() == Integer.MAX_VALUE;
  Cell deleted=createDeleted(cfs,col,8,8);
  reconciled=Cells.reconcile(reconciled,deleted,10);
  assert reconciled.localDeletionTime() == 8;
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  long delta=3L;
  Cell cell=createLegacyCounterCell(cfs,ByteBufferUtil.bytes("val"),delta,1);
  assertEquals(delta,CounterContext.instance().total(cell.value()));
  assertEquals(1,cell.value().getShort(0));
  assertEquals(0,cell.value().getShort(2));
  Assert.assertTrue(CounterId.wrap(cell.value(),4).isLocalId());
  assertEquals(1L,cell.value().getLong(4 + idLength));
  assertEquals(delta,cell.value().getLong(4 + idLength + clockLength));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterMutationTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeletes() throws WriteTimeoutException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF1);
  cfs.truncateBlocking();
  ColumnDefinition cOne=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ColumnDefinition cTwo=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val2"));
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("cc").add("val",1L).add("val2",-1L).build(),ConsistencyLevel.ONE).apply();
  Row row=Util.getOnlyRow(Util.cmd(cfs).includeRow("cc").columns("val","val2").build());
  assertEquals(1L,CounterContext.instance().total(row.getCell(cOne).value()));
  assertEquals(-1L,CounterContext.instance().total(row.getCell(cTwo).value()));
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("cc").delete(cOne).add("val2",-5L).build(),ConsistencyLevel.ONE).apply();
  row=Util.getOnlyRow(Util.cmd(cfs).includeRow("cc").columns("val","val2").build());
  assertEquals(null,row.getCell(cOne));
  assertEquals(-6L,CounterContext.instance().total(row.getCell(cTwo).value()));
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("cc").add("val",1L).build(),ConsistencyLevel.ONE).apply();
  row=Util.getOnlyRow(Util.cmd(cfs).includeRow("cc").columns("val","val2").build());
  assertEquals(null,row.getCell(cOne));
  RowUpdateBuilder.deleteRow(cfs.metadata,6,"key1","cc").applyUnsafe();
  Util.assertEmpty(Util.cmd(cfs).includeRow("cc").columns("val","val2").build());
  new CounterMutation(new RowUpdateBuilder(cfs.metadata,6,"key1").clustering("cc").add("val",1L).add("val2",1L).build(),ConsistencyLevel.ONE).apply();
  Util.assertEmpty(Util.cmd(cfs).includeRow("cc").columns("val","val2").build());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testBatch() throws WriteTimeoutException {
  ColumnFamilyStore cfsOne=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF1);
  ColumnFamilyStore cfsTwo=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF2);
  cfsOne.truncateBlocking();
  cfsTwo.truncateBlocking();
  Mutation batch=new Mutation(KEYSPACE1,Util.dk("key1"));
  batch.add(new RowUpdateBuilder(cfsOne.metadata,5,"key1").clustering("cc").add("val",1L).add("val2",-1L).build().get(cfsOne.metadata));
  batch.add(new RowUpdateBuilder(cfsTwo.metadata,5,"key1").clustering("cc").add("val",2L).add("val2",-2L).build().get(cfsTwo.metadata));
  new CounterMutation(batch,ConsistencyLevel.ONE).apply();
  ColumnDefinition c1cfs1=cfsOne.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ColumnDefinition c2cfs1=cfsOne.metadata.getColumnDefinition(ByteBufferUtil.bytes("val2"));
  Row row=Util.getOnlyRow(Util.cmd(cfsOne).includeRow("cc").columns("val","val2").build());
  assertEquals(1L,CounterContext.instance().total(row.getCell(c1cfs1).value()));
  assertEquals(-1L,CounterContext.instance().total(row.getCell(c2cfs1).value()));
  ColumnDefinition c1cfs2=cfsTwo.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  ColumnDefinition c2cfs2=cfsTwo.metadata.getColumnDefinition(ByteBufferUtil.bytes("val2"));
  row=Util.getOnlyRow(Util.cmd(cfsTwo).includeRow("cc").columns("val","val2").build());
  assertEquals(2L,CounterContext.instance().total(row.getCell(c1cfs2).value()));
  assertEquals(-2L,CounterContext.instance().total(row.getCell(c2cfs2).value()));
  CBuilder cb=CBuilder.create(cfsOne.metadata.comparator);
  cb.add("cc");
  assertEquals(ClockAndCount.create(1L,1L),cfsOne.getCachedCounter(Util.dk("key1").getKey(),cb.build(),c1cfs1,null));
  assertEquals(ClockAndCount.create(1L,-1L),cfsOne.getCachedCounter(Util.dk("key1").getKey(),cb.build(),c2cfs1,null));
  assertEquals(ClockAndCount.create(1L,2L),cfsTwo.getCachedCounter(Util.dk("key1").getKey(),cb.build(),c1cfs2,null));
  assertEquals(ClockAndCount.create(1L,-2L),cfsTwo.getCachedCounter(Util.dk("key1").getKey(),cb.build(),c2cfs2,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DirectoriesTest </h4><pre class="type-6 type-7 type-13 type-15 type-5 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiskFreeSpace(){
  DataDirectory[] dataDirectories=new DataDirectory[]{new DataDirectory(new File("/nearlyFullDir1")){
    public long getAvailableSpace(){
      return 11L;
    }
  }
,new DataDirectory(new File("/nearlyFullDir2")){
    public long getAvailableSpace(){
      return 10L;
    }
  }
,new DataDirectory(new File("/uniformDir1")){
    public long getAvailableSpace(){
      return 1000L;
    }
  }
,new DataDirectory(new File("/uniformDir2")){
    public long getAvailableSpace(){
      return 999L;
    }
  }
,new DataDirectory(new File("/veryFullDir")){
    public long getAvailableSpace(){
      return 4L;
    }
  }
};
  List<Directories.DataDirectoryCandidate> candidates=getWriteableDirectories(dataDirectories,0L);
  assertSame(dataDirectories[2],candidates.get(0).dataDirectory);
  assertSame(dataDirectories[3],candidates.get(1).dataDirectory);
  assertSame(dataDirectories[0],candidates.get(2).dataDirectory);
  assertSame(dataDirectories[1],candidates.get(3).dataDirectory);
  Map<DataDirectory,DataDirectory> testMap=new IdentityHashMap<>();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,5L);
    assertEquals(4,candidates.size());
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 4);
    if (testMap.size() == 4) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
  testMap.clear();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,11L);
    assertEquals(3,candidates.size());
    for (    Directories.DataDirectoryCandidate candidate : candidates)     assertTrue(candidate.dataDirectory.getAvailableSpace() >= 11L);
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 3);
    if (testMap.size() == 3) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testStandardDirs(){
  for (  CFMetaData cfm : CFM) {
    Directories directories=new Directories(cfm);
    assertEquals(cfDir(cfm),directories.getDirectoryForNewSSTables());
    Descriptor desc=new Descriptor(cfDir(cfm),KS,cfm.cfName,1);
    File snapshotDir=new File(cfDir(cfm),File.separator + Directories.SNAPSHOT_SUBDIR + File.separator+ "42");
    assertEquals(snapshotDir,Directories.getSnapshotDirectory(desc,"42"));
    File backupsDir=new File(cfDir(cfm),File.separator + Directories.BACKUPS_SUBDIR);
    assertEquals(backupsDir,Directories.getBackupsDirectory(desc));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecondaryIndexDirectories(){
  UUID tableID=CFMetaData.generateLegacyCfId(KS,"cf");
  CFMetaData PARENT_CFM=CFMetaData.Builder.create(KS,"cf").withId(tableID).addPartitionKey("thekey",UTF8Type.instance).addClusteringColumn("col",UTF8Type.instance).build();
  ColumnDefinition col=PARENT_CFM.getColumnDefinition(ByteBufferUtil.bytes("col"));
  IndexMetadata indexDef=IndexMetadata.fromIndexTargets(PARENT_CFM,Collections.singletonList(new IndexTarget(col.name,IndexTarget.Type.VALUES)),"idx",IndexMetadata.Kind.KEYS,Collections.emptyMap());
  PARENT_CFM.indexes(PARENT_CFM.getIndexes().with(indexDef));
  CFMetaData INDEX_CFM=CassandraIndex.indexCfsMetadata(PARENT_CFM,indexDef);
  Directories parentDirectories=new Directories(PARENT_CFM);
  Directories indexDirectories=new Directories(INDEX_CFM);
  for (  File dir : indexDirectories.getCFDirectories()) {
    assertEquals(cfDir(INDEX_CFM),dir);
  }
  Descriptor parentDesc=new Descriptor(parentDirectories.getDirectoryForNewSSTables(),KS,PARENT_CFM.cfName,0);
  Descriptor indexDesc=new Descriptor(indexDirectories.getDirectoryForNewSSTables(),KS,INDEX_CFM.cfName,0);
  File parentSnapshotDirectory=Directories.getSnapshotDirectory(parentDesc,"test");
  File indexSnapshotDirectory=Directories.getSnapshotDirectory(indexDesc,"test");
  assertEquals(parentSnapshotDirectory,indexSnapshotDirectory.getParentFile());
  parentSnapshotDirectory.mkdirs();
  assertTrue(parentDirectories.snapshotExists("test"));
  assertTrue(indexDirectories.snapshotExists("test"));
  assertEquals(parentDirectories.snapshotCreationTime("test"),indexDirectories.snapshotCreationTime("test"));
  Descriptor parentSnapshot=new Descriptor(parentSnapshotDirectory,KS,PARENT_CFM.cfName,0);
  createFile(parentSnapshot.filenameFor(Component.DATA),30);
  Descriptor indexSnapshot=new Descriptor(indexSnapshotDirectory,KS,INDEX_CFM.cfName,0);
  createFile(indexSnapshot.filenameFor(Component.DATA),40);
  assertEquals(30,parentDirectories.trueSnapshotsSize());
  assertEquals(40,indexDirectories.trueSnapshotsSize());
  Map<String,Pair<Long,Long>> parentSnapshotDetail=parentDirectories.getSnapshotDetails();
  assertTrue(parentSnapshotDetail.containsKey("test"));
  assertEquals(30L,parentSnapshotDetail.get("test").right.longValue());
  Map<String,Pair<Long,Long>> indexSnapshotDetail=indexDirectories.getSnapshotDetails();
  assertTrue(indexSnapshotDetail.containsKey("test"));
  assertEquals(40L,indexSnapshotDetail.get("test").right.longValue());
  File parentBackupDirectory=Directories.getBackupsDirectory(parentDesc);
  File indexBackupDirectory=Directories.getBackupsDirectory(indexDesc);
  assertEquals(parentBackupDirectory,indexBackupDirectory.getParentFile());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.KeyCacheTest </h4><pre class="type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKeyCacheLoad() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  ColumnFamilyStore store=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COLUMN_FAMILY2);
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY2);
  SchemaLoader.insertData(KEYSPACE1,COLUMN_FAMILY2,0,100);
  store.forceBlockingFlush();
  readData(KEYSPACE1,COLUMN_FAMILY2,0,100);
  assertKeyCacheSize(100,KEYSPACE1,COLUMN_FAMILY2);
  Map<KeyCacheKey,RowIndexEntry> savedMap=new HashMap<KeyCacheKey,RowIndexEntry>();
  for (Iterator<KeyCacheKey> iter=CacheService.instance.keyCache.keyIterator(); iter.hasNext(); ) {
    KeyCacheKey k=iter.next();
    if (k.desc.ksname.equals(KEYSPACE1) && k.desc.cfname.equals(COLUMN_FAMILY2))     savedMap.put(k,CacheService.instance.keyCache.get(k));
  }
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.invalidateKeyCache();
  assertKeyCacheSize(0,KEYSPACE1,COLUMN_FAMILY2);
  CacheService.instance.keyCache.loadSaved();
  assertKeyCacheSize(savedMap.size(),KEYSPACE1,COLUMN_FAMILY2);
  for (  Map.Entry<KeyCacheKey,RowIndexEntry> entry : savedMap.entrySet()) {
    RowIndexEntry expected=entry.getValue();
    RowIndexEntry actual=CacheService.instance.keyCache.get(entry.getKey());
    assertEquals(expected.position,actual.position);
    assertEquals(expected.columnsIndex(),actual.columnsIndex());
    if (expected.isIndexed()) {
      assertEquals(expected.deletionTime(),actual.deletionTime());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.KeyspaceTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRowSingleColumn() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  for (int i=0; i < 2; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int round=0; round < 2; round++) {
    Row row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").withLimit(1).build());
    assertEquals(ByteBufferUtil.bytes(0),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    for (int i=0; i < 2; i++) {
      row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").includeRow(i).build());
      assertEquals(ByteBufferUtil.bytes(i),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    }
    for (int i=0; i < 2; i++) {
      row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").fromIncl(i).toIncl(i).build());
      assertEquals(ByteBufferUtil.bytes(i),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    }
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLimitSSTablesComposites() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b text, c int, d int, PRIMARY KEY (a, b, c))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  cfs.disableAutoCompaction();
  for (int j=0; j < 10; j++) {
    for (int i=0; i < 10; i++)     execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)","0","a" + i,j * 10 + i,0);
    cfs.forceBlockingFlush();
  }
  ((ClearableHistogram)cfs.metric.sstablesPerReadHistogram.cf).clear();
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND (b, c) >= (?, ?) AND (b) <= (?) LIMIT 1000","0","a5",85,"a5"),row("0","a5",85,0),row("0","a5",95,0));
  assertEquals(2,cfs.metric.sstablesPerReadHistogram.cf.getSnapshot().getMax(),0.1);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSliceBloomFilterFalsePositive() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","1",1,1);
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (  String key : new String[]{"0","2"})   Util.assertEmpty(Util.cmd(cfs,key).build());
  cfs.forceBlockingFlush();
  for (  String key : new String[]{"0","2"})   Util.assertEmpty(Util.cmd(cfs,key).build());
  Collection<SSTableReader> sstables=cfs.getLiveSSTables();
  assertEquals(1,sstables.size());
  sstables.iterator().next().forceFilterFailures();
  for (  String key : new String[]{"0","2"})   Util.assertEmpty(Util.cmd(cfs,key).build());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLimitSSTables() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  cfs.disableAutoCompaction();
  for (int j=0; j < 10; j++) {
    for (int i=1000 + (j * 100); i < 1000 + ((j + 1) * 100); i++)     execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?","0",i,i,(long)i);
    cfs.forceBlockingFlush();
  }
  ((ClearableHistogram)cfs.metric.sstablesPerReadHistogram.cf).clear();
  SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",slices(cfs,null,1499,false),1000);
  int[] expectedValues=new int[500];
  for (int i=0; i < 500; i++)   expectedValues[i]=i + 1000;
  assertRowsInResult(cfs,command,expectedValues);
  assertEquals(5,cfs.metric.sstablesPerReadHistogram.cf.getSnapshot().getMax(),0.1);
  ((ClearableHistogram)cfs.metric.sstablesPerReadHistogram.cf).clear();
  command=singlePartitionSlice(cfs,"0",slices(cfs,1500,2000,false),1000);
  for (int i=0; i < 500; i++)   expectedValues[i]=i + 1500;
  assertRowsInResult(cfs,command,expectedValues);
  assertEquals(5,cfs.metric.sstablesPerReadHistogram.cf.getSnapshot().getMax(),0.1);
  ((ClearableHistogram)cfs.metric.sstablesPerReadHistogram.cf).clear();
  command=singlePartitionSlice(cfs,"0",slices(cfs,1500,2000,true),1000);
  for (int i=0; i < 500; i++)   expectedValues[i]=1999 - i;
  assertRowsInResult(cfs,command,expectedValues);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReversedWithFlushing() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b)) WITH CLUSTERING ORDER BY (b DESC)");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  cfs.forceBlockingFlush();
  for (int i=10; i < 20; i++) {
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
    PartitionColumns columns=PartitionColumns.of(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false)));
    ClusteringIndexSliceFilter filter=new ClusteringIndexSliceFilter(Slices.ALL,false);
    SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",filter,null);
    try (ReadExecutionController executionController=command.executionController();PartitionIterator iterator=command.executeInternal(executionController)){
      try (RowIterator rowIterator=iterator.next()){
        Row row=rowIterator.next();
        Cell cell=row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false)));
        assertEquals(ByteBufferUtil.bytes(i),cell.value());
      }
     }
   }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.LegacyCellNameTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testColumnSameNameAsClusteringKeyCompactStorage() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int PRIMARY KEY, v int)" + " WITH COMPACT STORAGE","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("column1"));
  assertTrue(cellName.column.isRegular());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testColumnSameNameAsPartitionKeyCompactStorage() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int PRIMARY KEY, v int)" + " WITH COMPACT STORAGE","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("k"));
  assertTrue(cellName.column.isRegular());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.MmapFileTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies that {@link sun.misc.Cleaner} works and that mmap'd files can be deleted.
 */
@Test public void testMmapFile() throws Exception {
  ObjectName bpmName=new ObjectName("java.nio:type=BufferPool,name=mapped");
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  Long mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
  Long mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
  Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
  Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
  File f1=File.createTempFile("MmapFileTest1",".bin");
  File f2=File.createTempFile("MmapFileTest2",".bin");
  File f3=File.createTempFile("MmapFileTest2",".bin");
  try {
    int size=1024 * 1024;
    try (RandomAccessFile raf=new RandomAccessFile(f1,"rw")){
      raf.setLength(size);
    }
     try (RandomAccessFile raf=new RandomAccessFile(f2,"rw")){
      raf.setLength(size);
    }
     try (RandomAccessFile raf=new RandomAccessFile(f3,"rw")){
      raf.setLength(size);
    }
     try (FileChannel channel=FileChannel.open(f1.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    try (FileChannel channel=FileChannel.open(f2.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    try (FileChannel channel=FileChannel.open(f3.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    Assert.assertTrue(f1.delete());
    Assert.assertTrue(f2.delete());
    Assert.assertTrue(f3.delete());
  }
  finally {
    Runtime.getRuntime().gc();
    f1.delete();
    f2.delete();
    f3.delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.PartitionRangeReadTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInclusiveBounds(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE2).getColumnFamilyStore(CF_STANDARD1);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key1")).clustering("cc1").add("val","asdf").build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key2")).clustering("cc2").add("val","asdf").build().applyUnsafe();
  assertEquals(2,Util.getAll(Util.cmd(cfs).fromIncl("cc1").toIncl("cc2").build()).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCassandra6778() throws CharacterCodingException {
  String cfname=CF_STANDARDINT;
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  ByteBuffer col=ByteBufferUtil.bytes("val");
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(col);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering(new BigInteger(new byte[]{1})).add("val","val1").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,"k1").clustering(new BigInteger(new byte[]{0,0,1})).add("val","val2").build().applyUnsafe();
  cfs.forceBlockingFlush();
  Row row=Util.getOnlyRow(Util.cmd(cfs,"k1").includeRow(new BigInteger(new byte[]{1})).build());
  assertTrue(row.getCell(cDef).value().equals(ByteBufferUtil.bytes("val2")));
  row=Util.getOnlyRow(Util.cmd(cfs,"k1").includeRow(new BigInteger(new byte[]{0,0,1})).build());
  assertTrue(row.getCell(cDef).value().equals(ByteBufferUtil.bytes("val2")));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeSliceInclusionExclusion() throws Throwable {
  String keyspaceName=KEYSPACE1;
  String cfName=CF_STANDARD1;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  cfs.clearUnsafe();
  for (int i=0; i < 10; ++i) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,10,String.valueOf(i));
    builder.clustering("c");
    builder.add("val",String.valueOf(i));
    builder.build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  List<FilteredPartition> partitions;
  partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("2").toKeyIncl("7").build());
  assertEquals(6,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("2")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("7")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("2").toKeyExcl("7").build());
  assertEquals(4,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("3")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("6")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("2").toKeyIncl("7").build());
  assertEquals(5,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("3")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("7")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("2").toKeyExcl("7").build());
  assertEquals(5,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("2")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("6")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.PartitionTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testColumnStatsRecordsRowDeletesCorrectly(){
  long timestamp=System.currentTimeMillis();
  int localDeletionTime=(int)(timestamp / 1000);
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_TENCOL);
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("c").add("val","val1");
  for (int i=0; i < 10; i++)   builder.add("val" + i,"val" + i);
  builder.build().applyUnsafe();
  RowUpdateBuilder.deleteRowAt(cfs.metadata,10L,localDeletionTime,"key1","c").applyUnsafe();
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,"key1").build());
  EncodingStats stats=partition.stats();
  assertEquals(localDeletionTime,stats.minLocalDeletionTime);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManyColumns() throws IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_TENCOL);
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("c").add("val","val1");
  for (int i=0; i < 10; i++)   builder.add("val" + i,"val" + i);
  PartitionUpdate update=builder.buildUpdate();
  CachedBTreePartition partition=CachedBTreePartition.create(update.unfilteredIterator(),FBUtilities.nowInSeconds());
  DataOutputBuffer bufOut=new DataOutputBuffer();
  CachedPartition.cacheSerializer.serialize(partition,bufOut);
  CachedPartition deserialized=CachedPartition.cacheSerializer.deserialize(new DataInputBuffer(bufOut.getData()));
  assertEquals(partition.columns().regulars.size(),deserialized.columns().regulars.size());
  assertTrue(deserialized.columns().regulars.getSimple(1).equals(partition.columns().regulars.getSimple(1)));
  assertTrue(deserialized.columns().regulars.getSimple(5).equals(partition.columns().regulars.getSimple(5)));
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val8"));
  assertTrue(partition.lastRow().getCell(cDef).value().equals(deserialized.lastRow().getCell(cDef).value()));
  assert deserialized.partitionKey().equals(partition.partitionKey());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void rangeTombstoneFilteringTest() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k111";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,10).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,2,key).addRangeTombstone(15,20).build().applyUnsafe();
  ImmutableBTreePartition partition;
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(11).toIncl(14).build());
  Collection<RangeTombstone> rt=rangeTombstones(partition);
  assertEquals(0,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(11).toIncl(15).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(20).toIncl(25).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(12).toIncl(25).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(25).toIncl(35).build());
  rt=rangeTombstones(partition);
  assertEquals(0,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(1).toIncl(40).build());
  rt=rangeTombstones(partition);
  assertEquals(2,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(7).toIncl(17).build());
  rt=rangeTombstones(partition);
  assertEquals(2,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(5).toIncl(20).build());
  rt=rangeTombstones(partition);
  assertEquals(2,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(5).toIncl(20).build());
  rt=rangeTombstones(partition);
  assertEquals(2,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(1).toIncl(2).build());
  rt=rangeTombstones(partition);
  assertEquals(0,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(1).toIncl(5).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(1).toIncl(10).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(5).toIncl(6).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(17).toIncl(20).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(17).toIncl(18).build());
  rt=rangeTombstones(partition);
  assertEquals(1,rt.size());
  Slices.Builder sb=new Slices.Builder(cfs.getComparator());
  sb.add(Slice.Bound.create(cfs.getComparator(),true,true,1),Slice.Bound.create(cfs.getComparator(),false,true,10));
  sb.add(Slice.Bound.create(cfs.getComparator(),true,true,16),Slice.Bound.create(cfs.getComparator(),false,true,20));
  partition=Util.getOnlyPartitionUnfiltered(SinglePartitionReadCommand.create(cfs.metadata,FBUtilities.nowInSeconds(),Util.dk(key),sb.build()));
  rt=rangeTombstones(partition);
  assertEquals(2,rt.size());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void overlappingRangeTest() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k2";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 20; i++)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,15).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,10).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,2,key).addRangeTombstone(5,8).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Partition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  int nowInSec=FBUtilities.nowInSeconds();
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  CompactionManager.instance.performMaximal(cfs,false);
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testOverwritesToDeletedColumns() throws Exception {
  Keyspace table=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(CFNAME);
  ByteBuffer key=ByteBufferUtil.bytes("k6");
  ByteBuffer indexedColumnName=ByteBufferUtil.bytes("val");
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ColumnDefinition cd=cfs.metadata.getColumnDefinition(indexedColumnName).copy();
  IndexMetadata indexDef=IndexMetadata.fromIndexTargets(cfs.metadata,Collections.singletonList(new IndexTarget(cd.name,IndexTarget.Type.VALUES)),"test_index",IndexMetadata.Kind.CUSTOM,ImmutableMap.of(IndexTarget.CUSTOM_INDEX_OPTION_NAME,StubIndex.class.getName()));
  if (!cfs.metadata.getIndexes().get("test_index").isPresent())   cfs.metadata.indexes(cfs.metadata.getIndexes().with(indexDef));
  Future<?> rebuild=cfs.indexManager.addIndex(indexDef);
  if (rebuild != null)   rebuild.get();
  StubIndex index=(StubIndex)cfs.indexManager.getIndexByName("test_index");
  index.reset();
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(0).newRow(1).add("val",1).applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(0,1).build().applyUnsafe();
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(2).newRow(1).add("val",1).applyUnsafe();
  cfs.forceBlockingFlush();
  assertEquals(1,index.rowsInserted.size());
  assertEquals(1,index.rowsUpdated.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeTombstoneCompaction() throws Exception {
  Keyspace table=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(CFNAME);
  ByteBuffer key=ByteBufferUtil.bytes("k4");
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 10; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,key).addRangeTombstone(0,7).build().applyUnsafe();
  cfs.forceBlockingFlush();
  assertEquals(2,cfs.getLiveSSTables().size());
  CompactionManager.instance.performMaximal(cfs,false);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (UnfilteredPartitionIterator scanner=sstable.getScanner()){
    try (UnfilteredRowIterator iter=scanner.next()){
      Unfiltered u1=iter.next();
      assertTrue("Expecting open marker, got " + u1.toString(cfs.metadata),u1 instanceof RangeTombstoneMarker);
      Unfiltered u2=iter.next();
      assertTrue("Expecting close marker, got " + u2.toString(cfs.metadata),u2 instanceof RangeTombstoneMarker);
      Unfiltered u3=iter.next();
      assertTrue("Expecting row, got " + u3.toString(cfs.metadata),u3 instanceof Row);
    }
   }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test7808_2() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.metadata.gcGraceSeconds(2);
  String key="7808_2";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=10; i < 20; i++)   builder.newRow(i).add("val",i);
  builder.apply();
  cfs.forceBlockingFlush();
  new Mutation(PartitionUpdate.fullPartitionDelete(cfs.metadata,Util.dk(key),0,0)).apply();
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(1).newRow(5).add("val",5).apply();
  cfs.forceBlockingFlush();
  Thread.sleep(5);
  cfs.forceMajorCompaction();
  assertEquals(1,Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void simpleQueryWithRangeTombstoneTest() throws Exception {
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k1";
  UpdateBuilder builder;
  builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(10,22).build().applyUnsafe();
  builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(2);
  for (int i=1; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,3,key).addRangeTombstone(19,27).build().applyUnsafe();
  int[] live=new int[]{4,9,11,17,28};
  int[] dead=new int[]{12,19,21,24,27};
  AbstractReadCommandBuilder.SinglePartitionBuilder cmdBuilder=Util.cmd(cfs,key);
  for (  int i : live)   cmdBuilder.includeRow(i);
  for (  int i : dead)   cmdBuilder.includeRow(i);
  Partition partition=Util.getOnlyPartitionUnfiltered(cmdBuilder.build());
  int nowInSec=FBUtilities.nowInSeconds();
  for (  int i : live)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (  int i : dead)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(7).toIncl(30).build());
  for (  int i : new int[]{7,8,9,11,13,15,17,28,29,30})   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (  int i : new int[]{10,12,14,16,18,19,20,21,22,23,24,25,26,27})   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test7810() throws ExecutionException, InterruptedException {
  Keyspace ks=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(CFNAME);
  cfs.metadata.gcGraceSeconds(2);
  String key="7810";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=10; i < 20; i++)   builder.newRow(i).add("val",i);
  builder.apply();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(10,11).build().apply();
  cfs.forceBlockingFlush();
  Thread.sleep(5);
  cfs.forceMajorCompaction();
  assertEquals(8,Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reverseQueryTest() throws Exception {
  Keyspace table=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(CFNAME);
  String key="k3";
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(0).newRow(2).add("val",2).applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(0,10).build().applyUnsafe();
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(2).newRow(1).add("val",1).applyUnsafe();
  cfs.forceBlockingFlush();
  FilteredPartition partition=Util.getOnlyPartition(Util.cmd(cfs,key).build());
  assertTrue(partition.rowCount() > 0);
  int last=i(partition.unfilteredIterator(ColumnFilter.all(cfs.metadata),Slices.ALL,true).next().clustering().get(0));
  assertEquals("Last column should be column 1 since column 2 has been deleted",1,last);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ReadCommandTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPartitionRangeAbort() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF1);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key1")).clustering("Column1").add("val",ByteBufferUtil.bytes("abcd")).build().apply();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key2")).clustering("Column1").add("val",ByteBufferUtil.bytes("abcd")).build().apply();
  ReadCommand readCommand=Util.cmd(cfs).build();
  assertEquals(2,Util.getAll(readCommand).size());
  readCommand.abort();
  assertEquals(0,Util.getAll(readCommand).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSinglePartitionSliceAbort() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF2);
  cfs.truncateBlocking();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key")).clustering("cc").add("a",ByteBufferUtil.bytes("abcd")).build().apply();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key")).clustering("dd").add("a",ByteBufferUtil.bytes("abcd")).build().apply();
  ReadCommand readCommand=Util.cmd(cfs,Util.dk("key")).build();
  List<FilteredPartition> partitions=Util.getAll(readCommand);
  assertEquals(1,partitions.size());
  assertEquals(2,partitions.get(0).rowCount());
  readCommand.abort();
  assertEquals(0,Util.getAll(readCommand).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSinglePartitionNamesAbort() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF2);
  cfs.truncateBlocking();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key")).clustering("cc").add("a",ByteBufferUtil.bytes("abcd")).build().apply();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key")).clustering("dd").add("a",ByteBufferUtil.bytes("abcd")).build().apply();
  ReadCommand readCommand=Util.cmd(cfs,Util.dk("key")).includeRow("cc").includeRow("dd").build();
  List<FilteredPartition> partitions=Util.getAll(readCommand);
  assertEquals(1,partitions.size());
  assertEquals(2,partitions.get(0).rowCount());
  readCommand.abort();
  assertEquals(0,Util.getAll(readCommand).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ReadMessageTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMakeReadMessage() throws IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_FOR_READ_TEST);
  ReadCommand rm, rm2;
  rm=Util.cmd(cfs,Util.dk("key1")).includeRow("col1","col2").build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs,Util.dk("key1")).includeRow("col1","col2").reverse().build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs).build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs).fromKeyIncl(ByteBufferUtil.bytes("key1")).toKeyIncl(ByteBufferUtil.bytes("key2")).build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs).columns("a").build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs).includeRow("col1","col2").columns("a").build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
  rm=Util.cmd(cfs).fromKeyIncl(ByteBufferUtil.bytes("key1")).includeRow("col1","col2").columns("a").build();
  rm2=serializeAndDeserializeReadMessage(rm);
  assertEquals(rm.toString(),rm2.toString());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testNoCommitLog() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_FOR_COMMIT_TEST);
  ColumnFamilyStore cfsnocommit=Keyspace.open(KEYSPACENOCOMMIT).getColumnFamilyStore(CF_FOR_COMMIT_TEST);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("row")).clustering("c").add("commit1",ByteBufferUtil.bytes("abcd")).build().apply();
  new RowUpdateBuilder(cfsnocommit.metadata,0,ByteBufferUtil.bytes("row")).clustering("c").add("commit2",ByteBufferUtil.bytes("abcd")).build().apply();
  Checker checker=new Checker(cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("commit1")),cfsnocommit.metadata.getColumnDefinition(ByteBufferUtil.bytes("commit2")));
  CommitLogTestReplayer.examineCommitLog(checker);
  assertTrue(checker.commitLogMessageFound);
  assertFalse(checker.noCommitLogMessageFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerMissingHeaderTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMissingHeader() throws IOException {
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  Keyspace keyspace2=Keyspace.open(KEYSPACE2);
  DecoratedKey dk=Util.dk("keymulti");
  UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
  for (  File file : new File(DatabaseDescriptor.getCommitLogLocation()).listFiles()) {
    if (file.getName().endsWith(".header"))     FileUtils.deleteWithConfirm(file);
  }
  CommitLog.instance.resetUnsafe(false);
  Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
  Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRecoverBlocksOnBytesOutstanding() throws Exception {
  long originalMaxOutstanding=CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES;
  CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES=1;
  CommitLogReplayer.MutationInitiator originalInitiator=CommitLogReplayer.mutationInitiator;
  CommitLogReplayer.mutationInitiator=mockInitiator;
  try {
    CommitLog.instance.resetUnsafe(true);
    Keyspace keyspace1=Keyspace.open(KEYSPACE1);
    Keyspace keyspace2=Keyspace.open(KEYSPACE2);
    UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
    UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col2").add("val","1").build());
    keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
    keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
    DecoratedKey dk=Util.dk("keymulti");
    Assert.assertTrue(Util.getAllUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).isEmpty());
    Assert.assertTrue(Util.getAllUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).isEmpty());
    final AtomicReference<Throwable> err=new AtomicReference<Throwable>();
    Thread t=new Thread(){
      @Override public void run(){
        try {
          CommitLog.instance.resetUnsafe(false);
        }
 catch (        Throwable t) {
          err.set(t);
        }
      }
    }
;
    t.start();
    Assert.assertTrue(blocked.tryAcquire(1,20,TimeUnit.SECONDS));
    Thread.sleep(100);
    Assert.assertTrue(t.isAlive());
    blocker.release(Integer.MAX_VALUE);
    t.join(20 * 1000);
    if (err.get() != null)     throw new RuntimeException(err.get());
    if (t.isAlive()) {
      Throwable toPrint=new Throwable();
      toPrint.setStackTrace(Thread.getAllStackTraces().get(t));
      toPrint.printStackTrace(System.out);
    }
    Assert.assertFalse(t.isAlive());
    Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
    Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
  }
  finally {
    CommitLogReplayer.mutationInitiator=originalInitiator;
    CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES=originalMaxOutstanding;
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecoverPITUnordered() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  CommitLog.instance.resetUnsafe(true);
  Date date=CommitLogArchiver.format.parse("2112:12:12 12:12:12");
  long timeMS=date.getTime();
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  for (int i=0; i < 10; ++i) {
    long ts;
    if (i == 9)     ts=TimeUnit.MILLISECONDS.toMicros(timeMS - 1000);
 else     ts=TimeUnit.MILLISECONDS.toMicros(timeMS + (i * 1000));
    new RowUpdateBuilder(cfs.metadata,ts,"name-" + i).clustering("cc").add("val",Integer.toString(i)).build().apply();
  }
  assertEquals(10,Util.getAll(Util.cmd(cfs).build()).size());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  CommitLog.instance.resetUnsafe(false);
  assertEquals(2,Util.getAll(Util.cmd(cfs).build()).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRecoverCounter() throws IOException {
  CommitLog.instance.resetUnsafe(true);
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace1.getColumnFamilyStore(CF_COUNTER1);
  for (int i=0; i < 10; ++i) {
    new CounterMutation(new RowUpdateBuilder(cfs.metadata,1L,0,"key").clustering("cc").add("val",CounterContext.instance().createLocal(1L)).build(),ConsistencyLevel.ALL).apply();
  }
  keyspace1.getColumnFamilyStore("Counter1").clearUnsafe();
  int replayed=CommitLog.instance.resetUnsafe(false);
  ColumnDefinition counterCol=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  Row row=Util.getOnlyRow(Util.cmd(cfs).includeRow("cc").columns("val").build());
  assertEquals(10L,CounterContext.instance().total(row.getCell(counterCol).value()));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecoverPIT() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  CommitLog.instance.resetUnsafe(true);
  Date date=CommitLogArchiver.format.parse("2112:12:12 12:12:12");
  long timeMS=date.getTime() - 5000;
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  for (int i=0; i < 10; ++i) {
    long ts=TimeUnit.MILLISECONDS.toMicros(timeMS + (i * 1000));
    new RowUpdateBuilder(cfs.metadata,ts,"name-" + i).clustering("cc").add("val",Integer.toString(i)).build().apply();
  }
  assertEquals(10,Util.getAll(Util.cmd(cfs).build()).size());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  CommitLog.instance.resetUnsafe(false);
  assertEquals(6,Util.getAll(Util.cmd(cfs).build()).size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOne() throws IOException {
  CommitLog.instance.resetUnsafe(true);
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  Keyspace keyspace2=Keyspace.open(KEYSPACE2);
  UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col2").add("val","1").build());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
  CommitLog.instance.resetUnsafe(false);
  DecoratedKey dk=Util.dk("keymulti");
  Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
  Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerTruncateTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTruncate() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("Standard1");
  new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("cc").add("val","val1").build().applyUnsafe();
  assertTrue(Util.getAll(Util.cmd(cfs).build()).size() > 0);
  cfs.truncateBlocking();
  assert 0 != CommitLog.instance.resetUnsafe(false);
  Util.assertEmptyUnfiltered(Util.cmd(cfs).build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowCacheTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRowCache() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert CacheService.instance.rowCache.size() == i + 1;
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,100,10);
  for (int i=100; i < 110; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  int keysLeft=109;
  for (int i=109; i >= 10; i--) {
    cachedStore.invalidateCachedPartition(Util.dk("key" + i));
    assert CacheService.instance.rowCache.size() == keysLeft;
    keysLeft--;
  }
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRoundTrip() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  String cf="CachedIntCF";
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(cf);
  long startRowCacheHits=cachedStore.metric.rowCacheHit.getCount();
  long startRowCacheOutOfRange=cachedStore.metric.rowCacheHitOutOfRange.getCount();
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  ByteBuffer key=ByteBufferUtil.bytes("rowcachekey");
  DecoratedKey dk=cachedStore.decorateKey(key);
  RowCacheKey rck=new RowCacheKey(cachedStore.metadata.ksAndCFName,dk);
  RowUpdateBuilder rub=new RowUpdateBuilder(cachedStore.metadata,System.currentTimeMillis(),key);
  rub.clustering(String.valueOf(0));
  rub.add("val",ByteBufferUtil.bytes("val" + 0));
  rub.build().applyUnsafe();
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(1).build());
  assertEquals(startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(1).build());
  assertEquals(++startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  assertEquals(startRowCacheOutOfRange,cachedStore.metric.rowCacheHitOutOfRange.getCount());
  CachedPartition cachedCf=(CachedPartition)CacheService.instance.rowCache.get(rck);
  assertEquals(1,cachedCf.rowCount());
  for (  Unfiltered unfiltered : Util.once(cachedCf.unfilteredIterator(ColumnFilter.selection(cachedCf.columns()),Slices.ALL,false))) {
    Row r=(Row)unfiltered;
    for (    ColumnData c : r) {
      assertEquals(((Cell)c).value(),ByteBufferUtil.bytes("val" + 0));
    }
  }
  cachedStore.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRowCacheRange(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  String cf="CachedIntCF";
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(cf);
  long startRowCacheHits=cachedStore.metric.rowCacheHit.getCount();
  long startRowCacheOutOfRange=cachedStore.metric.rowCacheHitOutOfRange.getCount();
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  ByteBuffer key=ByteBufferUtil.bytes("rowcachekey");
  DecoratedKey dk=cachedStore.decorateKey(key);
  RowCacheKey rck=new RowCacheKey(cachedStore.metadata.ksAndCFName,dk);
  String values[]=new String[200];
  for (int i=0; i < 200; i++) {
    RowUpdateBuilder rub=new RowUpdateBuilder(cachedStore.metadata,System.currentTimeMillis(),key);
    rub.clustering(String.valueOf(i));
    values[i]="val" + i;
    rub.add("val",ByteBufferUtil.bytes(values[i]));
    rub.build().applyUnsafe();
  }
  Arrays.sort(values);
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(10).build());
  assertEquals(startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(10).build());
  assertEquals(++startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  assertEquals(startRowCacheOutOfRange,cachedStore.metric.rowCacheHitOutOfRange.getCount());
  Util.getAll(Util.cmd(cachedStore,dk).fromIncl(String.valueOf(210)).toExcl(String.valueOf(215)).build());
  assertEquals(startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  assertEquals(++startRowCacheOutOfRange,cachedStore.metric.rowCacheHitOutOfRange.getCount());
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(101).build());
  assertEquals(startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  assertEquals(++startRowCacheOutOfRange,cachedStore.metric.rowCacheHitOutOfRange.getCount());
  CacheService.instance.invalidateRowCache();
  Util.getAll(Util.cmd(cachedStore,dk).withLimit(105).build());
  assertEquals(startRowCacheHits,cachedStore.metric.rowCacheHit.getCount());
  CachedPartition cachedCf=(CachedPartition)CacheService.instance.rowCache.get(rck);
  assertEquals(cachedCf.rowCount(),100);
  int i=0;
  for (  Unfiltered unfiltered : Util.once(cachedCf.unfilteredIterator(ColumnFilter.selection(cachedCf.columns()),Slices.ALL,false))) {
    Row r=(Row)unfiltered;
    assertEquals(r.clustering().get(0),ByteBufferUtil.bytes(values[i].substring(3)));
    for (    ColumnData c : r) {
      assertEquals(((Cell)c).value(),ByteBufferUtil.bytes(values[i]));
    }
    i++;
  }
  cachedStore.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInvalidateRowCache() throws Exception {
  StorageService.instance.initServer(0);
  CacheService.instance.setRowCacheCapacityInMB(1);
  rowCacheLoad(100,Integer.MAX_VALUE,1000);
  ColumnFamilyStore store=Keyspace.open(KEYSPACE_CACHED).getColumnFamilyStore(CF_CACHED);
  assertEquals(CacheService.instance.rowCache.size(),100);
  ArrayList<Bounds<Token>> subranges=getBounds(20);
  ArrayList<Bounds<Token>> boundsToInvalidate=Lists.newArrayList(subranges.get(0),subranges.get(2),subranges.get(4));
  int invalidatedKeys=store.invalidateRowCache(boundsToInvalidate);
  assertEquals(60,invalidatedKeys);
  assertEquals(CacheService.instance.rowCache.size(),40);
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSSTablesPerReadHistogramWhenRowCache(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  cachedStore.forceBlockingFlush();
  ((ClearableHistogram)cachedStore.metric.sstablesPerReadHistogram.cf).clear();
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_before=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_after=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    double belowMedian=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getValue(0.49D);
    double mean_after=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMean();
    assertEquals("SSTablePerReadHistogram should be updated even key found in row cache",count_before + 1,count_after);
    assertTrue("In half of requests we have not touched SSTables, " + "so 49 percentile (" + belowMedian + ") must be strongly less than 0.9",belowMedian < 0.9D);
    assertTrue("In half of requests we have not touched SSTables, " + "so mean value (" + mean_after + ") must be strongly less than 1, but greater than 0",mean_after < 0.999D && mean_after > 0.001D);
  }
  assertEquals("Min value of SSTablesPerRead should be zero",0,cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMin());
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowIndexEntryTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializedSize() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b text, c int, PRIMARY KEY(a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  final RowIndexEntry simple=new RowIndexEntry(123);
  DataOutputBuffer buffer=new DataOutputBuffer();
  SerializationHeader header=new SerializationHeader(true,cfs.metadata,cfs.metadata.partitionColumns(),EncodingStats.NO_STATS);
  RowIndexEntry.Serializer serializer=new RowIndexEntry.Serializer(cfs.metadata,BigFormat.latestVersion,header);
  serializer.serialize(simple,buffer);
  assertEquals(buffer.getLength(),serializer.serializedSize(simple));
  for (int i=0; i <= DatabaseDescriptor.getColumnIndexSize() / 4; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,"" + i,i);
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build());
  File tempFile=File.createTempFile("row_index_entry_test",null);
  tempFile.deleteOnExit();
  SequentialWriter writer=SequentialWriter.open(tempFile);
  ColumnIndex columnIndex=ColumnIndex.writeAndBuildIndex(partition.unfilteredIterator(),writer,header,Collections.emptySet(),BigFormat.latestVersion);
  RowIndexEntry<IndexHelper.IndexInfo> withIndex=RowIndexEntry.create(0xdeadbeef,DeletionTime.LIVE,columnIndex);
  IndexHelper.IndexInfo.Serializer indexSerializer=new IndexHelper.IndexInfo.Serializer(cfs.metadata,BigFormat.latestVersion,header);
  assertTrue(columnIndex.columnsIndex.size() >= 3);
  buffer=new DataOutputBuffer();
  serializer.serialize(withIndex,buffer);
  assertEquals(buffer.getLength(),serializer.serializedSize(withIndex));
  ByteBuffer bb=buffer.buffer();
  DataInputBuffer input=new DataInputBuffer(bb,false);
  serializationCheck(withIndex,indexSerializer,bb,input);
  buffer=new DataOutputBuffer(){
    public boolean hasPosition(){
      return false;
    }
    public long position(){
      throw new UnsupportedOperationException();
    }
  }
;
  serializer.serialize(withIndex,buffer);
  bb=buffer.buffer();
  input=new DataInputBuffer(bb,false);
  serializationCheck(withIndex,indexSerializer,bb,input);
  bb=buffer.buffer();
  input=new DataInputBuffer(bb,false);
  RowIndexEntry.Serializer.skip(input,BigFormat.latestVersion);
  Assert.assertEquals(0,bb.remaining());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowIterationTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRowIterationDeletion() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int PRIMARY KEY, b int)");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE a = ?",0L,0);
  cfs.forceBlockingFlush();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build()).isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRowIterationDeletionTime() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int PRIMARY KEY, b int)");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("INSERT INTO %s (a, b) VALUES (?, ?) USING TIMESTAMP ?",0,0,0L);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE a = ?",0L,0);
  cfs.forceBlockingFlush();
  execute("INSERT INTO %s (a, b) VALUES (?, ?) USING TIMESTAMP ?",0,0,1L);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE a = ?",1L,0);
  int localDeletionTime=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build()).partitionLevelDeletion().localDeletionTime();
  cfs.forceBlockingFlush();
  DeletionTime dt=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build()).partitionLevelDeletion();
  assertEquals(1L,dt.markedForDeleteAt());
  assertEquals(localDeletionTime,dt.localDeletionTime());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpiringColumnExpiration() throws IOException {
  int ttl=1;
  ColumnDefinition def=cfm.getColumnDefinition(new ColumnIdentifier("a",true));
  Cell cell=BufferCell.expiring(def,0,ttl,nowInSeconds,((AbstractType)def.cellValueType()).decompose("a1"));
  PartitionUpdate update=PartitionUpdate.singleRowUpdate(cfm,dk,BTreeRow.singleCellRow(cfm.comparator.make("c1"),cell));
  new Mutation(update).applyUnsafe();
  Row row=Util.getOnlyRow(Util.cmd(cfs,dk).includeRow("c1").withNowInSeconds(nowInSeconds).build());
  assertEquals("a1",ByteBufferUtil.string(row.getCell(def).value()));
  Util.assertEmpty(Util.cmd(cfs,dk).includeRow("c1").withNowInSeconds(nowInSeconds + ttl + 1).build());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeRangeTombstones() throws InterruptedException {
  PartitionUpdate update1=new PartitionUpdate(cfm,dk,cfm.partitionColumns(),1);
  writeRangeTombstone(update1,"1","11",123,123);
  writeRangeTombstone(update1,"2","22",123,123);
  writeRangeTombstone(update1,"3","31",123,123);
  writeRangeTombstone(update1,"4","41",123,123);
  PartitionUpdate update2=new PartitionUpdate(cfm,dk,cfm.partitionColumns(),1);
  writeRangeTombstone(update2,"1","11",123,123);
  writeRangeTombstone(update2,"111","112",1230,123);
  writeRangeTombstone(update2,"2","24",123,123);
  writeRangeTombstone(update2,"3","31",1230,123);
  writeRangeTombstone(update2,"4","41",123,1230);
  writeRangeTombstone(update2,"5","51",123,1230);
  try (UnfilteredRowIterator merged=UnfilteredRowIterators.merge(ImmutableList.of(update1.unfilteredIterator(),update2.unfilteredIterator()),nowInSeconds)){
    Object[][] expected=new Object[][]{{"1","11",123l,123},{"111","112",1230l,123},{"2","24",123l,123},{"3","31",1230l,123},{"4","41",123l,1230},{"5","51",123l,1230}};
    int i=0;
    while (merged.hasNext()) {
      RangeTombstoneBoundMarker openMarker=(RangeTombstoneBoundMarker)merged.next();
      Slice.Bound openBound=openMarker.clustering();
      DeletionTime openDeletion=new DeletionTime(openMarker.deletionTime().markedForDeleteAt(),openMarker.deletionTime().localDeletionTime());
      RangeTombstoneBoundMarker closeMarker=(RangeTombstoneBoundMarker)merged.next();
      Slice.Bound closeBound=closeMarker.clustering();
      DeletionTime closeDeletion=new DeletionTime(closeMarker.deletionTime().markedForDeleteAt(),closeMarker.deletionTime().localDeletionTime());
      assertEquals(openDeletion,closeDeletion);
      assertRangeTombstoneMarkers(openBound,closeBound,openDeletion,expected[i++]);
    }
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve(){
  ColumnDefinition defA=cfm.getColumnDefinition(new ColumnIdentifier("a",true));
  ColumnDefinition defB=cfm.getColumnDefinition(new ColumnIdentifier("b",true));
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSeconds);
  builder.newRow(cfm.comparator.make("c1"));
  writeSimpleCellValue(builder,cfm,defA,"a1",0);
  writeSimpleCellValue(builder,cfm,defA,"a2",1);
  writeSimpleCellValue(builder,cfm,defB,"b1",1);
  Row row=builder.build();
  PartitionUpdate update=PartitionUpdate.singleRowUpdate(cfm,dk,row);
  Unfiltered unfiltered=update.unfilteredIterator().next();
  assertTrue(unfiltered.kind() == Unfiltered.Kind.ROW);
  row=(Row)unfiltered;
  assertEquals("a2",defA.cellValueType().getString(row.getCell(defA).value()));
  assertEquals("b1",defB.cellValueType().getString(row.getCell(defB).value()));
  assertEquals(2,row.columns().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ScrubTest </h4><pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubCorruptedCounterRow() throws IOException, WriteTimeoutException {
  int numPartitions=1000;
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  cfs.clearUnsafe();
  fillCounterCF(cfs,numPartitions);
  assertOrderedAll(cfs,numPartitions);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,ByteBufferUtil.bytes("0"),ByteBufferUtil.bytes("1"));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,false,false,true)){
    scrubber.scrub();
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  IOError err) {
  }
  Scrubber.ScrubResult scrubResult;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,true,false,true)){
    scrubResult=scrubber.scrubWithResult();
  }
   assertNotNull(scrubResult);
  boolean compression=Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false"));
  if (compression) {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(numPartitions,scrubResult.badRows + scrubResult.goodRows);
    assertTrue(scrubResult.goodRows >= scrubResult.badRows * 2);
  }
 else {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(1,scrubResult.badRows);
    assertEquals(numPartitions - 1,scrubResult.goodRows);
  }
  assertEquals(1,cfs.getLiveSSTables().size());
  assertOrderedAll(cfs,scrubResult.goodRows);
}

</code></pre>

<br>
<pre class="type-7 type-15 type-4 type-19 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubCorruptedRowInSmallFile() throws IOException, WriteTimeoutException {
  assumeTrue(!Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false")));
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  cfs.clearUnsafe();
  fillCounterCF(cfs,2);
  assertOrderedAll(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,ByteBufferUtil.bytes("0"),ByteBufferUtil.bytes("1"));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,false,false,true)){
    scrubber.scrub();
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  IOError err) {
  }
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,true,false,true)){
    scrubber.scrub();
    scrubber.close();
  }
   assertEquals(1,cfs.getLiveSSTables().size());
  assertOrderedAll(cfs,1);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * For CASSANDRA-6892 too, check that for a compact table with one cluster column, we can insert whatever
 * we want as value for the clustering column, including something that would conflict with a CQL column definition.
 */
@Test public void testValidationCompactStorage() throws Exception {
  QueryProcessor.process(String.format("CREATE TABLE \"%s\".test_compact_dynamic_columns (a int, b text, c text, PRIMARY KEY (a, b)) WITH COMPACT STORAGE",KEYSPACE),ConsistencyLevel.ONE);
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("test_compact_dynamic_columns");
  QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".test_compact_dynamic_columns (a, b, c) VALUES (0, 'a', 'foo')",KEYSPACE));
  QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".test_compact_dynamic_columns (a, b, c) VALUES (0, 'b', 'bar')",KEYSPACE));
  QueryProcessor.executeInternal(String.format("INSERT INTO \"%s\".test_compact_dynamic_columns (a, b, c) VALUES (0, 'c', 'boo')",KEYSPACE));
  cfs.forceBlockingFlush();
  CompactionManager.instance.performScrub(cfs,true,true);
  UntypedResultSet rs=QueryProcessor.executeInternal(String.format("SELECT * FROM \"%s\".test_compact_dynamic_columns",KEYSPACE));
  assertEquals(3,rs.size());
  Iterator<UntypedResultSet.Row> iter=rs.iterator();
  assertEquals("foo",iter.next().getString("c"));
  assertEquals("bar",iter.next().getString("c"));
  assertEquals("boo",iter.next().getString("c"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SecondaryIndexTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexScan(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering("c").add("birthdate",1L).add("notbirthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k2").clustering("c").add("birthdate",2L).add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k3").clustering("c").add("birthdate",1L).add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k4").clustering("c").add("birthdate",3L).add("notbirthdate",2L).build().applyUnsafe();
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k3").columns("birthdate").build());
  assertEquals(2,partitions.size());
  Util.assertCellValue(2L,cfs,Util.row(partitions.get(0),"c"),"birthdate");
  Util.assertCellValue(1L,cfs,Util.row(partitions.get(1),"c"),"birthdate");
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").build());
  assertEquals(3,partitions.size());
  Row first=Util.row(partitions.get(0),"c");
  Util.assertCellValue(2L,cfs,first,"birthdate");
  Util.assertCellValue(2L,cfs,first,"notbirthdate");
  Row second=Util.row(partitions.get(1),"c");
  Util.assertCellValue(1L,cfs,second,"birthdate");
  Util.assertCellValue(2L,cfs,second,"notbirthdate");
  Row third=Util.row(partitions.get(2),"c");
  Util.assertCellValue(3L,cfs,third,"birthdate");
  Util.assertCellValue(2L,cfs,third,"notbirthdate");
  ReadCommand rc=Util.cmd(cfs).fromKeyIncl("k1").toKeyIncl("k3").columns("birthdate").filterOn("birthdate",Operator.EQ,1L).build();
  Index.Searcher searcher=cfs.indexManager.getBestIndexFor(rc).searcherFor(rc);
  try (ReadExecutionController executionController=rc.executionController();UnfilteredPartitionIterator pi=searcher.search(executionController)){
    assertTrue(pi.hasNext());
    pi.next().close();
  }
   partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("k1").toKeyIncl("k4aaa").filterOn("birthdate",Operator.GT,1L).build());
  int rowCount=0;
  for (  FilteredPartition partition : partitions) {
    for (    Row row : partition) {
      ++rowCount;
      assert ByteBufferUtil.toLong(Util.cell(cfs,row,"birthdate").value()) > 1L;
    }
  }
  assertEquals(2,rowCount);
  Util.assertEmpty(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").filterOn("notbirthdate",Operator.NEQ,2L).build());
  Util.assertEmpty(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").filterOn("birthdate",Operator.EQ,1L).filterOn("notbirthdate",Operator.NEQ,2L).build());
}

</code></pre>

<br>
<pre class="type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testCompositeIndexDeletions() throws IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  ByteBuffer bBB=ByteBufferUtil.bytes("birthdate");
  ColumnDefinition bDef=cfs.metadata.getColumnDefinition(bBB);
  ByteBuffer col=ByteBufferUtil.bytes("birthdate");
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering("c").add("birthdate",1L).build().applyUnsafe();
  assertIndexedOne(cfs,col,1L);
  RowUpdateBuilder.deleteRow(cfs.metadata,1,"k1","c").applyUnsafe();
  assertIndexedNone(cfs,col,1L);
  ReadCommand rc=Util.cmd(cfs).build();
  assertNull(cfs.indexManager.getBestIndexFor(rc));
  new RowUpdateBuilder(cfs.metadata,2,"k1").clustering("c").add("birthdate",1L).build().apply();
  ;
  assertIndexedOne(cfs,col,1L);
  RowUpdateBuilder.deleteRow(cfs.metadata,1,"k1","c").applyUnsafe();
  assertIndexedOne(cfs,col,1L);
  new RowUpdateBuilder(cfs.metadata,1,"k1").clustering("c").delete(bDef).build().applyUnsafe();
  assertIndexedOne(cfs,col,1L);
  RowUpdateBuilder.deleteRow(cfs.metadata,3,"k1","c").applyUnsafe();
  rc=Util.cmd(cfs).build();
  assertNull(cfs.indexManager.getBestIndexFor(rc));
  new RowUpdateBuilder(cfs.metadata,3,"k1").clustering("c").add("birthdate",1L).build().apply();
  ;
  rc=Util.cmd(cfs).build();
  assertNull(cfs.indexManager.getBestIndexFor(rc));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testIndexCreate() throws IOException, InterruptedException, ExecutionException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COMPOSITE_INDEX_TO_BE_ADDED);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering("c").add("birthdate",1L).build().applyUnsafe();
  String indexName="birthdate_index";
  ColumnDefinition old=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("birthdate"));
  IndexMetadata indexDef=IndexMetadata.fromIndexTargets(cfs.metadata,Collections.singletonList(new IndexTarget(old.name,IndexTarget.Type.VALUES)),indexName,IndexMetadata.Kind.COMPOSITES,Collections.EMPTY_MAP);
  cfs.metadata.indexes(cfs.metadata.getIndexes().with(indexDef));
  Future<?> future=cfs.indexManager.addIndex(indexDef);
  future.get();
  boolean flushed=false;
  ColumnFamilyStore indexCfs=cfs.indexManager.getIndex(indexDef).getBackingTable().orElseThrow(throwAssert("Index not found"));
  flushed=!indexCfs.getLiveSSTables().isEmpty();
  assertTrue(flushed);
  assertIndexedOne(cfs,ByteBufferUtil.bytes("birthdate"),1L);
  assertTrue(cfs.getBuiltIndexes().contains(indexName));
  cfs.indexManager.removeIndex(indexDef.name);
  assertFalse(cfs.getBuiltIndexes().contains(indexName));
  future=cfs.indexManager.addIndex(indexDef);
  future.get();
  assertIndexedOne(cfs,ByteBufferUtil.bytes("birthdate"),1L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SinglePartitionSliceCommandTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void staticColumnsAreFiltered() throws IOException {
  DecoratedKey key=cfm.decorateKey(ByteBufferUtil.bytes("k"));
  UntypedResultSet rows;
  QueryProcessor.executeInternal("INSERT INTO ks.tbl (k, s, i, v) VALUES ('k', 's', 0, 'v')");
  QueryProcessor.executeInternal("DELETE v FROM ks.tbl WHERE k='k' AND i=0");
  QueryProcessor.executeInternal("DELETE FROM ks.tbl WHERE k='k' AND i=0");
  rows=QueryProcessor.executeInternal("SELECT * FROM ks.tbl WHERE k='k' AND i=0");
  for (  UntypedResultSet.Row row : rows) {
    logger.debug("Current: k={}, s={}, v={}",(row.has("k") ? row.getString("k") : null),(row.has("s") ? row.getString("s") : null),(row.has("v") ? row.getString("v") : null));
  }
  assert rows.isEmpty();
  ColumnFilter columnFilter=ColumnFilter.selection(PartitionColumns.of(v));
  ByteBuffer zero=ByteBufferUtil.bytes(0);
  Slices slices=Slices.with(cfm.comparator,Slice.make(Slice.Bound.inclusiveStartOf(zero),Slice.Bound.inclusiveEndOf(zero)));
  ClusteringIndexSliceFilter sliceFilter=new ClusteringIndexSliceFilter(slices,false);
  ReadCommand cmd=new SinglePartitionReadCommand(false,MessagingService.VERSION_30,true,cfm,FBUtilities.nowInSeconds(),columnFilter,RowFilter.NONE,DataLimits.NONE,key,sliceFilter);
  DataOutputBuffer out=new DataOutputBuffer((int)ReadCommand.legacyReadCommandSerializer.serializedSize(cmd,MessagingService.VERSION_21));
  ReadCommand.legacyReadCommandSerializer.serialize(cmd,out,MessagingService.VERSION_21);
  DataInputPlus in=new DataInputBuffer(out.buffer(),true);
  cmd=ReadCommand.legacyReadCommandSerializer.deserialize(in,MessagingService.VERSION_21);
  logger.debug("ReadCommand: {}",cmd);
  UnfilteredPartitionIterator partitionIterator=cmd.executeLocally(ReadExecutionController.empty());
  ReadResponse response=ReadResponse.createDataResponse(partitionIterator,cmd);
  logger.debug("creating response: {}",response);
  partitionIterator=response.makeIterator(cmd);
  assert partitionIterator.hasNext();
  UnfilteredRowIterator partition=partitionIterator.next();
  LegacyLayout.LegacyUnfilteredPartition rowIter=LegacyLayout.fromUnfilteredRowIterator(cmd,partition);
  Assert.assertEquals(Collections.emptyList(),rowIter.cells);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.TimeSortTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeSort() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=900; i < 1000; ++i)   for (int j=0; j < 8; ++j)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",i,j * 2,0,(long)j * 2);
  validateTimeSort();
  cfs.forceBlockingFlush();
  validateTimeSort();
  DecoratedKey key=Util.dk("900");
  for (int j=0; j < 4; ++j)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,j * 2 + 1,1,(long)j * 2 + 1);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,0,2,100L);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,10,2,100L);
  UntypedResultSet results=execute("SELECT * FROM %s WHERE a = ? AND b >= ? LIMIT 1000",900,0);
  assertEquals(12,results.size());
  Iterator<UntypedResultSet.Row> iter=results.iterator();
  for (int j=0; j < 8; j++) {
    UntypedResultSet.Row row=iter.next();
    assertEquals(j,row.getInt("b"));
  }
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b IN (?, ?)",900,0,10),row(900,0,2),row(900,10,2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.TransformerTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRowExtension(){
  for (  Filter filter : Filter.values()) {
    List<Check> checks=new ArrayList<>();
    BaseRowIterator<?> iter=extendingIterator(5,filter,checks);
    for (int i=0; i < 5; i++) {
      Unfiltered u=iter.next();
      assert u instanceof Row;
      Assert.assertEquals(i,ByteBufferUtil.toInt(u.clustering().get(0)));
    }
    iter.close();
    for (    Check check : checks)     check.check();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogDescriptorTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Shouldn't happen in the real world (should only have either compression or enabledTdeOptions), but the header
 * functionality should be correct
 */
@Test public void writeAndReadHeader_WithCompressionAndEncryption() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,compression,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,enabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertEquals(compression,result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertEquals(enabledEncryption,result.getEncryptionContext());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_WithEncryptionHeader_EncryptionEnabledInYaml() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,enabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that even though enabledTdeOptions is disabled in the yaml, we can still read the commit log header as encrypted.
 */
@Test public void writeAndReadHeader_WithEncryptionHeader_EncryptionDisabledInYaml() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,previouslyEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_OnlyCompression() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,compression,neverEnabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,neverEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertEquals(compression,result.compression);
  Assert.assertFalse(result.getEncryptionContext().isEnabled());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void constructParametersString_WithCompressionAndEncryption(){
  String json=CommitLogDescriptor.constructParametersString(compression,enabledEncryption,Collections.emptyMap());
  Assert.assertTrue(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertTrue(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void constructParametersString_NoCompressionOrEncryption(){
  String json=CommitLogDescriptor.constructParametersString(null,null,Collections.emptyMap());
  Assert.assertFalse(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertFalse(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
  json=CommitLogDescriptor.constructParametersString(null,neverEnabledEncryption,Collections.emptyMap());
  Assert.assertFalse(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertFalse(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_NoCompressionOrEncryption() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,neverEnabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,neverEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertFalse(result.getEncryptionContext().isEnabled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTruncateWithoutSnapshotNonDurable() throws IOException {
  CommitLog.instance.resetUnsafe(true);
  boolean originalState=DatabaseDescriptor.getAutoSnapshot();
  try {
    DatabaseDescriptor.setAutoSnapshot(false);
    Keyspace notDurableKs=Keyspace.open(KEYSPACE2);
    Assert.assertFalse(notDurableKs.getMetadata().params.durableWrites);
    ColumnFamilyStore cfs=notDurableKs.getColumnFamilyStore("Standard1");
    new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("bytes").add("val",bytes("abcd")).build().applyUnsafe();
    assertTrue(Util.getOnlyRow(Util.cmd(cfs).columns("val").build()).cells().iterator().next().value().equals(bytes("abcd")));
    cfs.truncateBlocking();
    Util.assertEmpty(Util.cmd(cfs).columns("val").build());
  }
  finally {
    DatabaseDescriptor.setAutoSnapshot(originalState);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.SegmentReaderTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void encryptedSegmenter() throws IOException {
  EncryptionContext context=EncryptionContextGenerator.createContext(true);
  CipherFactory cipherFactory=new CipherFactory(context.getTransparentDataEncryptionOptions());
  int plainTextLength=(1 << 13) - 137;
  ByteBuffer plainTextBuffer=ByteBuffer.allocate(plainTextLength);
  random.nextBytes(plainTextBuffer.array());
  ByteBuffer compressedBuffer=EncryptionUtils.compress(plainTextBuffer,null,true,context.getCompressor());
  Cipher cipher=cipherFactory.getEncryptor(context.getTransparentDataEncryptionOptions().cipher,context.getTransparentDataEncryptionOptions().key_alias);
  File encryptedFile=File.createTempFile("encrypted-segment-",".log");
  encryptedFile.deleteOnExit();
  FileChannel channel=new RandomAccessFile(encryptedFile,"rw").getChannel();
  channel.write(ByteBufferUtil.bytes(plainTextLength));
  EncryptionUtils.encryptAndWrite(compressedBuffer,channel,true,cipher);
  channel.close();
  try (RandomAccessReader reader=RandomAccessReader.open(encryptedFile)){
    context=EncryptionContextGenerator.createContext(cipher.getIV(),true);
    EncryptedSegmenter segmenter=new EncryptedSegmenter(reader,context);
    SyncSegment syncSegment=segmenter.nextSegment(0,(int)reader.length());
    Assert.assertEquals(plainTextLength,syncSegment.endPosition - CommitLogSegment.SYNC_MARKER_SIZE);
    ByteBuffer fileBuffer=readBytes(syncSegment.input,plainTextLength);
    plainTextBuffer.position(0);
    Assert.assertEquals(plainTextBuffer,fileBuffer);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.AntiCompactionTest </h4><pre class="type-7 type-4 type-2 type-9 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldMutateRepairedAt() throws InterruptedException, IOException {
  ColumnFamilyStore store=prepareColumnFamilyStore();
  Collection<SSTableReader> sstables=getUnrepairedSSTables(store);
  assertEquals(store.getLiveSSTables().size(),sstables.size());
  Range<Token> range=new Range<Token>(new BytesToken("0".getBytes()),new BytesToken("9999".getBytes()));
  List<Range<Token>> ranges=Arrays.asList(range);
  try (LifecycleTransaction txn=store.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    CompactionManager.instance.performAnticompaction(store,ranges,refs,txn,1);
  }
   assertThat(store.getLiveSSTables().size(),is(1));
  assertThat(Iterables.get(store.getLiveSSTables(),0).isRepaired(),is(true));
  assertThat(Iterables.get(store.getLiveSSTables(),0).selfRef().globalCount(),is(1));
  assertThat(store.getTracker().getCompacting().size(),is(0));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-9 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldSkipAntiCompactionForNonIntersectingRange() throws InterruptedException, IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(CF);
  store.disableAutoCompaction();
  for (int table=0; table < 10; table++) {
    generateSStable(store,Integer.toString(table));
  }
  Collection<SSTableReader> sstables=getUnrepairedSSTables(store);
  assertEquals(store.getLiveSSTables().size(),sstables.size());
  Range<Token> range=new Range<Token>(new BytesToken("-1".getBytes()),new BytesToken("-10".getBytes()));
  List<Range<Token>> ranges=Arrays.asList(range);
  try (LifecycleTransaction txn=store.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    CompactionManager.instance.performAnticompaction(store,ranges,refs,txn,1);
  }
   assertThat(store.getLiveSSTables().size(),is(10));
  assertThat(Iterables.get(store.getLiveSSTables(),0).isRepaired(),is(false));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void antiCompactionSizeTest() throws InterruptedException, IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  cfs.disableAutoCompaction();
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  long origSize=s.bytesOnDisk();
  Range<Token> range=new Range<Token>(new BytesToken(ByteBufferUtil.bytes(0)),new BytesToken(ByteBufferUtil.bytes(500)));
  Collection<SSTableReader> sstables=cfs.getLiveSSTables();
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    CompactionManager.instance.performAnticompaction(cfs,Arrays.asList(range),refs,txn,12345);
  }
   long sum=0;
  long rows=0;
  for (  SSTableReader x : cfs.getLiveSSTables()) {
    sum+=x.bytesOnDisk();
    rows+=x.getTotalRows();
  }
  assertEquals(sum,cfs.metric.liveDiskSpaceUsed.getCount());
  assertEquals(rows,1000 * (1000 * 5));
  assertEquals(origSize,cfs.metric.liveDiskSpaceUsed.getCount(),16000000);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void antiCompactOne() throws Exception {
  ColumnFamilyStore store=prepareColumnFamilyStore();
  Collection<SSTableReader> sstables=getUnrepairedSSTables(store);
  assertEquals(store.getLiveSSTables().size(),sstables.size());
  Range<Token> range=new Range<Token>(new BytesToken("0".getBytes()),new BytesToken("4".getBytes()));
  List<Range<Token>> ranges=Arrays.asList(range);
  int repairedKeys=0;
  int nonRepairedKeys=0;
  try (LifecycleTransaction txn=store.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    if (txn == null)     throw new IllegalStateException();
    long repairedAt=1000;
    CompactionManager.instance.performAnticompaction(store,ranges,refs,txn,repairedAt);
  }
   assertEquals(2,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    try (ISSTableScanner scanner=sstable.getScanner((RateLimiter)null)){
      while (scanner.hasNext()) {
        UnfilteredRowIterator row=scanner.next();
        if (sstable.isRepaired()) {
          assertTrue(range.contains(row.partitionKey().getToken()));
          repairedKeys++;
        }
 else {
          assertFalse(range.contains(row.partitionKey().getToken()));
          nonRepairedKeys++;
        }
      }
    }
   }
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertFalse(sstable.isMarkedCompacted());
    assertEquals(1,sstable.selfRef().globalCount());
  }
  assertEquals(0,store.getTracker().getCompacting().size());
  assertEquals(repairedKeys,4);
  assertEquals(nonRepairedKeys,6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionAwareWriterTest </h4><pre class="type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSplittingSizeTieredCompactionWriter() throws Throwable {
  ColumnFamilyStore cfs=getColumnFamilyStore();
  cfs.disableAutoCompaction();
  int rowCount=10000;
  populate(rowCount);
  LifecycleTransaction txn=cfs.getTracker().tryModify(cfs.getLiveSSTables(),OperationType.COMPACTION);
  long beforeSize=txn.originals().iterator().next().onDiskLength();
  CompactionAwareWriter writer=new SplittingSizeTieredCompactionWriter(cfs,cfs.getDirectories(),txn,txn.originals(),0);
  int rows=compact(cfs,txn,writer);
  long expectedSize=beforeSize / 2;
  List<SSTableReader> sortedSSTables=new ArrayList<>(cfs.getLiveSSTables());
  Collections.sort(sortedSSTables,new Comparator<SSTableReader>(){
    @Override public int compare(    SSTableReader o1,    SSTableReader o2){
      return Longs.compare(o2.onDiskLength(),o1.onDiskLength());
    }
  }
);
  for (  SSTableReader sstable : sortedSSTables) {
    if (expectedSize > SplittingSizeTieredCompactionWriter.DEFAULT_SMALLEST_SSTABLE_BYTES)     assertEquals(expectedSize,sstable.onDiskLength(),expectedSize / 100);
    expectedSize/=2;
  }
  assertEquals(rowCount,rows);
  validateData(cfs,rowCount);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultCompactionWriter() throws Throwable {
  Keyspace ks=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=ks.getColumnFamilyStore(TABLE);
  int rowCount=1000;
  cfs.disableAutoCompaction();
  populate(rowCount);
  LifecycleTransaction txn=cfs.getTracker().tryModify(cfs.getLiveSSTables(),OperationType.COMPACTION);
  long beforeSize=txn.originals().iterator().next().onDiskLength();
  CompactionAwareWriter writer=new DefaultCompactionWriter(cfs,cfs.getDirectories(),txn,txn.originals());
  int rows=compact(cfs,txn,writer);
  assertEquals(1,cfs.getLiveSSTables().size());
  assertEquals(rowCount,rows);
  assertEquals(beforeSize,cfs.getLiveSSTables().iterator().next().onDiskLength());
  validateData(cfs,rowCount);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMaxSSTableSizeWriter() throws Throwable {
  ColumnFamilyStore cfs=getColumnFamilyStore();
  cfs.disableAutoCompaction();
  int rowCount=1000;
  populate(rowCount);
  LifecycleTransaction txn=cfs.getTracker().tryModify(cfs.getLiveSSTables(),OperationType.COMPACTION);
  long beforeSize=txn.originals().iterator().next().onDiskLength();
  int sstableSize=(int)beforeSize / 10;
  CompactionAwareWriter writer=new MaxSSTableSizeWriter(cfs,cfs.getDirectories(),txn,txn.originals(),sstableSize,0);
  int rows=compact(cfs,txn,writer);
  assertEquals(10,cfs.getLiveSSTables().size());
  assertEquals(rowCount,rows);
  validateData(cfs,rowCount);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMajorLeveledCompactionWriter() throws Throwable {
  ColumnFamilyStore cfs=getColumnFamilyStore();
  cfs.disableAutoCompaction();
  int rowCount=20000;
  int targetSSTableCount=50;
  populate(rowCount);
  LifecycleTransaction txn=cfs.getTracker().tryModify(cfs.getLiveSSTables(),OperationType.COMPACTION);
  long beforeSize=txn.originals().iterator().next().onDiskLength();
  int sstableSize=(int)beforeSize / targetSSTableCount;
  CompactionAwareWriter writer=new MajorLeveledCompactionWriter(cfs,cfs.getDirectories(),txn,txn.originals(),sstableSize);
  int rows=compact(cfs,txn,writer);
  assertEquals(targetSSTableCount,cfs.getLiveSSTables().size());
  int[] levelCounts=new int[5];
  assertEquals(rowCount,rows);
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    levelCounts[sstable.getSSTableLevel()]++;
  }
  assertEquals(0,levelCounts[0]);
  assertEquals(10,levelCounts[1]);
  assertEquals(targetSSTableCount - 10,levelCounts[2]);
  for (int i=3; i < levelCounts.length; i++)   assertEquals(0,levelCounts[i]);
  validateData(cfs,rowCount);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionControllerTest </h4><pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFullyExpiredSSTables(){
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF2);
  cfs.truncateBlocking();
  DecoratedKey key=Util.dk("k1");
  long timestamp1=FBUtilities.timestampMicros();
  long timestamp2=timestamp1 - 5;
  long timestamp3=timestamp2 - 5;
  applyDeleteMutation(cfs.metadata,key,timestamp2);
  cfs.forceBlockingFlush();
  Set<SSTableReader> compacting=Sets.newHashSet(cfs.getLiveSSTables());
  applyMutation(cfs.metadata,key,timestamp1);
  cfs.forceBlockingFlush();
  Set<SSTableReader> overlapping=Sets.difference(Sets.newHashSet(cfs.getLiveSSTables()),compacting);
  int gcBefore=(int)(System.currentTimeMillis() / 1000) + 5;
  Set<SSTableReader> expired=CompactionController.getFullyExpiredSSTables(cfs,compacting,overlapping,gcBefore);
  assertNotNull(expired);
  assertEquals(1,expired.size());
  assertEquals(compacting.iterator().next(),expired.iterator().next());
  applyMutation(cfs.metadata,key,timestamp3);
  expired=CompactionController.getFullyExpiredSSTables(cfs,compacting,overlapping,gcBefore);
  assertNotNull(expired);
  assertEquals(0,expired.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMaxPurgeableTimestamp(){
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF1);
  cfs.truncateBlocking();
  DecoratedKey key=Util.dk("k1");
  long timestamp1=FBUtilities.timestampMicros();
  long timestamp2=timestamp1 - 5;
  long timestamp3=timestamp2 - 5;
  applyMutation(cfs.metadata,key,timestamp1);
  try (CompactionController controller=new CompactionController(cfs,null,0)){
    assertEquals(timestamp1,controller.maxPurgeableTimestamp(key));
    cfs.forceBlockingFlush();
    assertEquals(Long.MAX_VALUE,controller.maxPurgeableTimestamp(key));
  }
   Set<SSTableReader> compacting=Sets.newHashSet(cfs.getLiveSSTables());
  applyMutation(cfs.metadata,key,timestamp2);
  cfs.forceBlockingFlush();
  try (CompactionController controller=new CompactionController(cfs,compacting,0)){
    assertEquals(timestamp2,controller.maxPurgeableTimestamp(key));
    applyMutation(cfs.metadata,key,timestamp3);
    assertEquals(timestamp3,controller.maxPurgeableTimestamp(key));
  }
   cfs.forceBlockingFlush();
  try (CompactionController controller=new CompactionController(cfs,null,0)){
    applyMutation(cfs.metadata,key,timestamp1);
    applyMutation(cfs.metadata,key,timestamp2);
    applyMutation(cfs.metadata,key,timestamp3);
    assertEquals(timestamp3,controller.maxPurgeableTimestamp(key));
  }
   cfs.forceBlockingFlush();
  try (CompactionController controller=new CompactionController(cfs,null,0)){
    applyMutation(cfs.metadata,key,timestamp3);
    applyMutation(cfs.metadata,key,timestamp2);
    applyMutation(cfs.metadata,key,timestamp1);
    assertEquals(timestamp3,controller.maxPurgeableTimestamp(key));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsPurgeTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionPurgeTombstonedRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  String keyspaceName=KEYSPACE1;
  String cfName="Standard1";
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key3";
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,i,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  Mutation rm=new Mutation(KEYSPACE1,dk(key));
  rm.add(PartitionUpdate.fullPartitionDelete(cfs.metadata,dk(key),4,FBUtilities.nowInSeconds()));
  rm.applyUnsafe();
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  assertFalse(partition.partitionLevelDeletion().isLive());
  cfs.forceBlockingFlush();
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).isEmpty());
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,i,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  assertEquals(10,partition.rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify that we don't drop tombstones during a minor compaction that might still be relevant
 */
@Test public void testMinTimestampPurge(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE2);
  String cfName="Standard1";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key3="key3";
  new RowUpdateBuilder(cfs.metadata,8,key3).clustering("c1").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,8,key3).clustering("c2").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  RowUpdateBuilder.deleteRow(cfs.metadata,10,key3,"c1").applyUnsafe();
  cfs.forceBlockingFlush();
  Collection<SSTableReader> sstablesIncomplete=cfs.getLiveSSTables();
  RowUpdateBuilder.deleteRow(cfs.metadata,9,key3,"c2").applyUnsafe();
  cfs.forceBlockingFlush();
  cfs.getCompactionStrategyManager().getUserDefinedTask(sstablesIncomplete,Integer.MAX_VALUE).execute(null);
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key3).build());
  assertEquals(2,partition.rowCount());
  for (  Row row : partition)   assertFalse(row.hasLiveData(FBUtilities.nowInSeconds()));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMinorCompactionPurge(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE2);
  String cfName="Standard1";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  for (int k=1; k <= 2; ++k) {
    String key="key" + k;
    for (int i=0; i < 10; i++) {
      RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
      builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
    }
    cfs.forceBlockingFlush();
    for (int i=0; i < 10; i++) {
      RowUpdateBuilder.deleteRow(cfs.metadata,1,key,String.valueOf(i)).applyUnsafe();
    }
    cfs.forceBlockingFlush();
  }
  DecoratedKey key1=Util.dk("key1");
  DecoratedKey key2=Util.dk("key2");
  cfs.forceBlockingFlush();
  Collection<SSTableReader> sstablesIncomplete=cfs.getLiveSSTables();
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,2,"key1");
  builder.clustering(String.valueOf(5)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  cfs.getCompactionStrategyManager().getUserDefinedTask(sstablesIncomplete,Integer.MAX_VALUE).execute(null);
  Util.assertEmpty(Util.cmd(cfs,key2).build());
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key1).build());
  assertEquals(1,partition.rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRowTombstoneObservedBeforePurging(){
  String keyspace="cql_keyspace";
  String table="table1";
  ColumnFamilyStore cfs=Keyspace.open(keyspace).getColumnFamilyStore(table);
  cfs.disableAutoCompaction();
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (k, v1, v2) VALUES (%d, '%s', %d)",keyspace,table,1,"foo",1));
  cfs.forceBlockingFlush();
  UntypedResultSet result=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s WHERE k = %d",keyspace,table,1));
  assertEquals(1,result.size());
  QueryProcessor.executeInternal(String.format("DELETE FROM %s.%s WHERE k = %d",keyspace,table,1));
  cfs.forceBlockingFlush();
  assertEquals(2,cfs.getLiveSSTables().size());
  result=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s WHERE k = %d",keyspace,table,1));
  assertEquals(0,result.size());
  FBUtilities.waitOnFutures(CompactionManager.instance.submitMaximal(cfs,(int)(System.currentTimeMillis() / 1000) - 10000,false));
  assertEquals(1,cfs.getLiveSSTables().size());
  result=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s WHERE k = %d",keyspace,table,1));
  assertEquals(0,result.size());
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (k, v1, v2) VALUES (%d, '%s', %d)",keyspace,table,1,"foo",1));
  cfs.forceBlockingFlush();
  assertEquals(2,cfs.getLiveSSTables().size());
  result=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s WHERE k = %d",keyspace,table,1));
  assertEquals(1,result.size());
  QueryProcessor.executeInternal(String.format("DELETE FROM %s.%s WHERE k = %d",keyspace,table,1));
  cfs.forceBlockingFlush();
  FBUtilities.waitOnFutures(CompactionManager.instance.submitMaximal(cfs,(int)(System.currentTimeMillis() / 1000) + 10000,false));
  assertEquals(0,cfs.getLiveSSTables().size());
  result=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s WHERE k = %d",keyspace,table,1));
  assertEquals(0,result.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMajorCompactionPurge(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  String cfName="Standard1";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key1";
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder.deleteRow(cfs.metadata,1,key,String.valueOf(i)).applyUnsafe();
  }
  cfs.forceBlockingFlush();
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,2,key);
  builder.clustering(String.valueOf(5)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  FBUtilities.waitOnFutures(CompactionManager.instance.submitMaximal(cfs,Integer.MAX_VALUE,false));
  cfs.invalidateCachedPartition(dk(key));
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  assertEquals(1,partition.rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCompactionPurgeCachedRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  String keyspaceName=KEYSPACE_CACHED;
  String cfName=CF_CACHED;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key3";
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  Mutation rm=new Mutation(KEYSPACE_CACHED,dk(key));
  rm.add(PartitionUpdate.fullPartitionDelete(cfs.metadata,dk(key),1,FBUtilities.nowInSeconds()));
  rm.applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"key4").clustering("c").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).isEmpty());
  cfs.forceBlockingFlush();
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  Util.assertEmpty(Util.cmd(cfs,key).build());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionPurgeOneFile() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  String cfName="Standard2";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key1";
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder.deleteRow(cfs.metadata,1,key,String.valueOf(i)).applyUnsafe();
  }
  cfs.forceBlockingFlush();
  assertEquals(String.valueOf(cfs.getLiveSSTables()),1,cfs.getLiveSSTables().size());
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  assertTrue(cfs.getLiveSSTables().isEmpty());
  Util.assertEmpty(Util.cmd(cfs,key).build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("making ranges based on the keys, not on the tokens") public void testNeedsCleanup(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("CF_STANDARD1");
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=1; i < 10; i++) {
    insertRowWithKey(i);
    insertRowWithKey(i + 100);
    insertRowWithKey(i + 200);
  }
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,209)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,210)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,200,209)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,109,200,210)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,210)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(1,9,100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,101,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,201,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,8,100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,108,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,200,208)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,0,0,9,50,51,100,109,150,199,200,209,300,301)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,0,0,9,50,51,100,103,150,199,200,209,300,301)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.DateTieredCompactionStrategyTest </h4><pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"30");
  options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"1825");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"0");
    validateOptions(options);
    fail(String.format("%s == 0 should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"1");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"0");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"-1");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"0");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepBucket(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=3;
  for (int r=0; r < numSSTables; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    new RowUpdateBuilder(cfs.metadata,r,key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstrs=new ArrayList<>(cfs.getLiveSSTables());
  List<SSTableReader> newBucket=newestBucket(Collections.singletonList(sstrs.subList(0,2)),4,32,9,10,Long.MAX_VALUE,new SizeTieredCompactionStrategyOptions());
  assertTrue("incoming bucket should not be accepted when it has below the min threshold SSTables",newBucket.isEmpty());
  newBucket=newestBucket(Collections.singletonList(sstrs.subList(0,2)),4,32,10,10,Long.MAX_VALUE,new SizeTieredCompactionStrategyOptions());
  assertFalse("non-incoming bucket should be accepted when it has at least 2 SSTables",newBucket.isEmpty());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(0).getMinTimestamp(),sstrs.get(0).getMaxTimestamp());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(1).getMinTimestamp(),sstrs.get(1).getMaxTimestamp());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(2).getMinTimestamp(),sstrs.get(2).getMaxTimestamp());
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterOldSSTables(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=3;
  for (int r=0; r < numSSTables; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    new RowUpdateBuilder(cfs.metadata,r,key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  Iterable<SSTableReader> filtered;
  List<SSTableReader> sstrs=new ArrayList<>(cfs.getLiveSSTables());
  filtered=filterOldSSTables(sstrs,0,2);
  assertEquals("when maxSSTableAge is zero, no sstables should be filtered",sstrs.size(),Iterables.size(filtered));
  filtered=filterOldSSTables(sstrs,1,2);
  assertEquals("only the newest 2 sstables should remain",2,Iterables.size(filtered));
  filtered=filterOldSSTables(sstrs,1,3);
  assertEquals("only the newest sstable should remain",1,Iterables.size(filtered));
  filtered=filterOldSSTables(sstrs,1,4);
  assertEquals("no sstables should remain when all are too old",0,Iterables.size(filtered));
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropExpiredSSTables() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  DecoratedKey key=Util.dk(String.valueOf("expired"));
  new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),1,key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
  cfs.forceBlockingFlush();
  SSTableReader expiredSSTable=cfs.getLiveSSTables().iterator().next();
  Thread.sleep(10);
  key=Util.dk(String.valueOf("nonexpired"));
  new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
  cfs.forceBlockingFlush();
  assertEquals(cfs.getLiveSSTables().size(),2);
  Map<String,String> options=new HashMap<>();
  options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"30");
  options.put(DateTieredCompactionStrategyOptions.TIMESTAMP_RESOLUTION_KEY,"MILLISECONDS");
  options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,Double.toString((1d / (24 * 60 * 60))));
  options.put(DateTieredCompactionStrategyOptions.EXPIRED_SSTABLE_CHECK_FREQUENCY_SECONDS_KEY,"0");
  DateTieredCompactionStrategy dtcs=new DateTieredCompactionStrategy(cfs,options);
  for (  SSTableReader sstable : cfs.getLiveSSTables())   dtcs.addSSTable(sstable);
  dtcs.startup();
  assertNull(dtcs.getNextBackgroundTask((int)(System.currentTimeMillis() / 1000)));
  Thread.sleep(2000);
  AbstractCompactionTask t=dtcs.getNextBackgroundTask((int)(System.currentTimeMillis() / 1000));
  assertNotNull(t);
  assertEquals(1,Iterables.size(t.transaction.originals()));
  SSTableReader sstable=t.transaction.originals().iterator().next();
  assertEquals(sstable,expiredSSTable);
  t.transaction.abort();
  cfs.truncateBlocking();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSTCSBigWindow(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.disableAutoCompaction();
  ByteBuffer bigValue=ByteBuffer.wrap(new byte[10000]);
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=40;
  long timestamp=System.currentTimeMillis();
  for (int r=0; r < numSSTables / 2; r++) {
    for (int i=0; i < 10; i++) {
      DecoratedKey key=Util.dk(String.valueOf(r));
      new RowUpdateBuilder(cfs.metadata,timestamp,key.getKey()).clustering("column").add("val",bigValue).build().applyUnsafe();
    }
    cfs.forceBlockingFlush();
  }
  for (int r=0; r < numSSTables / 2; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    new RowUpdateBuilder(cfs.metadata,timestamp,key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  Map<String,String> options=new HashMap<>();
  options.put(SizeTieredCompactionStrategyOptions.MIN_SSTABLE_SIZE_KEY,"1");
  DateTieredCompactionStrategy dtcs=new DateTieredCompactionStrategy(cfs,options);
  for (  SSTableReader sstable : cfs.getSSTables(SSTableSet.CANONICAL))   dtcs.addSSTable(sstable);
  AbstractCompactionTask task=dtcs.getNextBackgroundTask(0);
  assertEquals(20,task.transaction.originals().size());
  task.transaction.abort();
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetBuckets(){
  List<Pair<String,Long>> pairs=Lists.newArrayList(Pair.create("a",199L),Pair.create("b",299L),Pair.create("a",1L),Pair.create("b",201L));
  List<List<String>> buckets=getBuckets(pairs,100L,2,200L,Long.MAX_VALUE);
  assertEquals(2,buckets.size());
  for (  List<String> bucket : buckets) {
    assertEquals(2,bucket.size());
    assertEquals(bucket.get(0),bucket.get(1));
  }
  pairs=Lists.newArrayList(Pair.create("a",2000L),Pair.create("b",3600L),Pair.create("a",200L),Pair.create("c",3950L),Pair.create("too new",4125L),Pair.create("b",3899L),Pair.create("c",3900L));
  buckets=getBuckets(pairs,100L,3,4050L,Long.MAX_VALUE);
  assertEquals(3,buckets.size());
  for (  List<String> bucket : buckets) {
    assertEquals(2,bucket.size());
    assertEquals(bucket.get(0),bucket.get(1));
  }
  pairs=Lists.newArrayList(Pair.create("a",200L),Pair.create("a",299L),Pair.create("b",2000L),Pair.create("b",2014L),Pair.create("c",3610L),Pair.create("c",3690L),Pair.create("d",3898L),Pair.create("d",3899L),Pair.create("e",3900L),Pair.create("e",3950L),Pair.create("too new",4125L));
  buckets=getBuckets(pairs,100L,1,4050L,Long.MAX_VALUE);
  assertEquals(5,buckets.size());
  for (  List<String> bucket : buckets) {
    assertEquals(2,bucket.size());
    assertEquals(bucket.get(0),bucket.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LeveledCompactionStrategyTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompactionProgress() throws Exception {
  byte[] b=new byte[100 * 1024];
  new Random().nextBytes(b);
  ByteBuffer value=ByteBuffer.wrap(b);
  int rows=2;
  int columns=10;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  waitForLeveling(cfs);
  LeveledCompactionStrategy strategy=(LeveledCompactionStrategy)cfs.getCompactionStrategyManager().getStrategies().get(1).get(0);
  assert strategy.getLevelSize(1) > 0;
  Collection<SSTableReader> sstables=strategy.manifest.getLevel(1);
  List<ISSTableScanner> scanners=strategy.getScanners(sstables).scanners;
  assertEquals(1,scanners.size());
  ISSTableScanner scanner=scanners.get(0);
  while (scanner.hasNext())   scanner.next();
  assertEquals(scanner.getCurrentPosition(),SSTableReader.getTotalUncompressedBytes(sstables));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewRepairedSSTable() throws Exception {
  byte[] b=new byte[100 * 1024];
  new Random().nextBytes(b);
  ByteBuffer value=ByteBuffer.wrap(b);
  int rows=40;
  int columns=20;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  waitForLeveling(cfs);
  cfs.disableAutoCompaction();
  while (CompactionManager.instance.isCompacting(Arrays.asList(cfs)))   Thread.sleep(100);
  CompactionStrategyManager manager=cfs.getCompactionStrategyManager();
  List<List<AbstractCompactionStrategy>> strategies=manager.getStrategies();
  LeveledCompactionStrategy repaired=(LeveledCompactionStrategy)strategies.get(0).get(0);
  LeveledCompactionStrategy unrepaired=(LeveledCompactionStrategy)strategies.get(1).get(0);
  assertEquals(0,repaired.manifest.getLevelCount());
  assertEquals(2,unrepaired.manifest.getLevelCount());
  assertTrue(manager.getSSTableCountPerLevel()[1] > 0);
  assertTrue(manager.getSSTableCountPerLevel()[2] > 0);
  for (  SSTableReader sstable : cfs.getLiveSSTables())   assertFalse(sstable.isRepaired());
  int sstableCount=0;
  for (  List<SSTableReader> level : unrepaired.manifest.generations)   sstableCount+=level.size();
  assertEquals(sstableCount,cfs.getLiveSSTables().size());
  SSTableReader sstable1=unrepaired.manifest.generations[2].get(0);
  SSTableReader sstable2=unrepaired.manifest.generations[1].get(0);
  sstable1.descriptor.getMetadataSerializer().mutateRepairedAt(sstable1.descriptor,System.currentTimeMillis());
  sstable1.reloadSSTableMetadata();
  assertTrue(sstable1.isRepaired());
  manager.handleNotification(new SSTableRepairStatusChanged(Arrays.asList(sstable1)),this);
  int repairedSSTableCount=0;
  for (  List<SSTableReader> level : repaired.manifest.generations)   repairedSSTableCount+=level.size();
  assertEquals(1,repairedSSTableCount);
  assertTrue(repaired.manifest.generations[2].contains(sstable1));
  assertFalse(unrepaired.manifest.generations[2].contains(sstable1));
  unrepaired.removeSSTable(sstable2);
  manager.handleNotification(new SSTableAddedNotification(singleton(sstable2)),this);
  assertTrue(unrepaired.manifest.getLevel(1).contains(sstable2));
  assertFalse(repaired.manifest.getLevel(1).contains(sstable2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LongCompactionsTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStandardColumnCompactions(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("Standard1");
  cfs.clearUnsafe();
  final int ROWS_PER_SSTABLE=10;
  final int SSTABLES=cfs.metadata.params.minIndexInterval * 3 / ROWS_PER_SSTABLE;
  cfs.disableAutoCompaction();
  long maxTimestampExpected=Long.MIN_VALUE;
  Set<DecoratedKey> inserted=new HashSet<DecoratedKey>();
  for (int j=0; j < SSTABLES; j++) {
    for (int i=0; i < ROWS_PER_SSTABLE; i++) {
      DecoratedKey key=Util.dk(String.valueOf(i % 2));
      long timestamp=j * ROWS_PER_SSTABLE + i;
      maxTimestampExpected=Math.max(timestamp,maxTimestampExpected);
      UpdateBuilder.create(cfs.metadata,key).withTimestamp(timestamp).newRow(String.valueOf(i / 2)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).apply();
      inserted.add(key);
    }
    cfs.forceBlockingFlush();
    CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
    assertEquals(inserted.toString(),inserted.size(),Util.getAll(Util.cmd(cfs).build()).size());
  }
  forceCompactions(cfs);
  assertEquals(inserted.toString(),inserted.size(),Util.getAll(Util.cmd(cfs).build()).size());
  CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.SizeTieredCompactionStrategyTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepBucket() throws Exception {
  String ksname=KEYSPACE1;
  String cfname="Standard1";
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=3;
  for (int r=0; r < numSSTables; r++) {
    String key=String.valueOf(r);
    new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstrs=new ArrayList<>(cfs.getLiveSSTables());
  Pair<List<SSTableReader>,Double> bucket;
  List<SSTableReader> interestingBucket=mostInterestingBucket(Collections.singletonList(sstrs.subList(0,2)),4,32);
  assertTrue("nothing should be returned when all buckets are below the min threshold",interestingBucket.isEmpty());
  sstrs.get(0).overrideReadMeter(new RestorableMeter(100.0,100.0));
  sstrs.get(1).overrideReadMeter(new RestorableMeter(200.0,200.0));
  sstrs.get(2).overrideReadMeter(new RestorableMeter(300.0,300.0));
  long estimatedKeys=sstrs.get(0).estimatedKeys();
  bucket=trimToThresholdWithHotness(sstrs,2);
  assertEquals("one bucket should have been dropped",2,bucket.left.size());
  double expectedBucketHotness=(200.0 + 300.0) / estimatedKeys;
  assertEquals(String.format("bucket hotness (%f) should be close to %f",bucket.right,expectedBucketHotness),expectedBucketHotness,bucket.right,1.0);
}

</code></pre>

<br>
<pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_HIGH_KEY,"1.5");
  options.put(SizeTieredCompactionStrategyOptions.MIN_SSTABLE_SIZE_KEY,"10000");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"1000.0");
    validateOptions(options);
    fail("bucket_low greater than bucket_high should be rejected");
  }
 catch (  ConfigurationException e) {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetBuckets(){
  List<Pair<String,Long>> pairs=new ArrayList<Pair<String,Long>>();
  String[] strings={"a","bbbb","cccccccc","cccccccc","bbbb","a"};
  for (  String st : strings) {
    Pair<String,Long> pair=Pair.create(st,new Long(st.length()));
    pairs.add(pair);
  }
  List<List<String>> buckets=getBuckets(pairs,1.5,0.5,2);
  assertEquals(3,buckets.size());
  for (  List<String> bucket : buckets) {
    assertEquals(2,bucket.size());
    assertEquals(bucket.get(0).length(),bucket.get(1).length());
    assertEquals(bucket.get(0).charAt(0),bucket.get(1).charAt(0));
  }
  pairs.clear();
  buckets.clear();
  String[] strings2={"aaa","bbbbbbbb","aaa","bbbbbbbb","bbbbbbbb","aaa"};
  for (  String st : strings2) {
    Pair<String,Long> pair=Pair.create(st,new Long(st.length()));
    pairs.add(pair);
  }
  buckets=getBuckets(pairs,1.5,0.5,2);
  assertEquals(2,buckets.size());
  for (  List<String> bucket : buckets) {
    assertEquals(3,bucket.size());
    assertEquals(bucket.get(0).charAt(0),bucket.get(1).charAt(0));
    assertEquals(bucket.get(1).charAt(0),bucket.get(2).charAt(0));
  }
  pairs.clear();
  buckets.clear();
  String[] strings3={"aaa","bbbbbbbb","aaa","bbbbbbbb","bbbbbbbb","aaa"};
  for (  String st : strings3) {
    Pair<String,Long> pair=Pair.create(st,new Long(st.length()));
    pairs.add(pair);
  }
  buckets=getBuckets(pairs,1.5,0.5,10);
  assertEquals(1,buckets.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.TTLExpiryTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleExpire() throws InterruptedException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  long timestamp=System.currentTimeMillis();
  String key="ttl";
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col",ByteBufferUtil.EMPTY_BYTE_BUFFER).add("col7",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col3",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col311",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Thread.sleep(2000);
  assertEquals(4,cfs.getLiveSSTables().size());
  cfs.enableAutoCompaction(true);
  assertEquals(0,cfs.getLiveSSTables().size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAggressiveFullyExpired(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  String key="ttl";
  new RowUpdateBuilder(cfs.metadata,1L,1,key).add("col1",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,3L,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,2L,1,key).add("col1",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,5L,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,4L,1,key).add("col1",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,7L,1,key).add("shadow",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,6L,3,key).add("shadow",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,8L,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Set<SSTableReader> sstables=Sets.newHashSet(cfs.getLiveSSTables());
  int now=(int)(System.currentTimeMillis() / 1000);
  int gcBefore=now + 2;
  Set<SSTableReader> expired=CompactionController.getFullyExpiredSSTables(cfs,sstables,Collections.EMPTY_SET,gcBefore);
  assertEquals(2,expired.size());
  cfs.clearUnsafe();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoExpire() throws InterruptedException, IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  long timestamp=System.currentTimeMillis();
  String key="ttl";
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col",ByteBufferUtil.EMPTY_BYTE_BUFFER).add("col7",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col3",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  String noTTLKey="nottl";
  new RowUpdateBuilder(cfs.metadata,timestamp,noTTLKey).add("col311",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Thread.sleep(2000);
  assertEquals(4,cfs.getLiveSSTables().size());
  cfs.enableAutoCompaction(true);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  ISSTableScanner scanner=sstable.getScanner(ColumnFilter.all(sstable.metadata),DataRange.allData(cfs.getPartitioner()),false);
  assertTrue(scanner.hasNext());
  while (scanner.hasNext()) {
    UnfilteredRowIterator iter=scanner.next();
    assertEquals(Util.dk(noTTLKey),iter.partitionKey());
  }
  scanner.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckForExpiredSSTableBlockers() throws InterruptedException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),"test").noRowMarker().add("col1",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  SSTableReader blockingSSTable=cfs.getSSTables(SSTableSet.LIVE).iterator().next();
  for (int i=0; i < 10; i++) {
    new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),"test").noRowMarker().delete("col1").build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  Multimap<SSTableReader,SSTableReader> blockers=SSTableExpiredBlockers.checkForExpiredSSTableBlockers(cfs.getSSTables(SSTableSet.LIVE),(int)(System.currentTimeMillis() / 1000) + 100);
  assertEquals(1,blockers.keySet().size());
  assertTrue(blockers.keySet().contains(blockingSSTable));
  assertEquals(10,blockers.get(blockingSSTable).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.filter.SliceTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIntersectsSingleSlice(){
  List<AbstractType<?>> types=new ArrayList<>();
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  ClusteringComparator cc=new ClusteringComparator(types);
  ClusteringPrefix.Kind sk=ClusteringPrefix.Kind.INCL_START_BOUND;
  ClusteringPrefix.Kind ek=ClusteringPrefix.Kind.INCL_END_BOUND;
  Slice slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,1),columnNames(3,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,1,1),columnNames(3,1,1)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek,4,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertFalse(slice.intersects(cc,columnNames(0,0,0),columnNames(1,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertFalse(slice.intersects(cc,columnNames(0,0,0),columnNames(1,1,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(0,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,2,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1,2));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,2,0,0),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,2,0,0),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,3,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,3,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,2,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,2,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,2));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,2));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,1,2),makeBound(ek,1,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(2,2,1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(2)));
  slice=Slice.make(makeBound(sk),makeBound(ek,2));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,2),makeBound(ek,3));
  assertFalse(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,0,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,0,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,1,1,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDifferentMinMaxLengths(){
  List<AbstractType<?>> types=new ArrayList<>();
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  ClusteringComparator cc=new ClusteringComparator(types);
  ClusteringPrefix.Kind sk=ClusteringPrefix.Kind.INCL_START_BOUND;
  ClusteringPrefix.Kind ek=ClusteringPrefix.Kind.INCL_END_BOUND;
  Slice slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1),columnNames(1,2)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,2,3));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1,2,3),makeBound(ek,2));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,2),makeBound(ek,3,4,5));
  assertFalse(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,0,1,2));
  assertFalse(slice.intersects(cc,columnNames(1),columnNames(1,2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.HelpersTest </h4><pre class="type-7 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentityMap(){
  Integer one=new Integer(1);
  Integer two=new Integer(2);
  Integer three=new Integer(3);
  Map<Integer,Integer> identity=Helpers.identityMap(set(one,two,three));
  Assert.assertEquals(3,identity.size());
  Assert.assertSame(one,identity.get(1));
  Assert.assertSame(two,identity.get(2));
  Assert.assertSame(three,identity.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkObsolete(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  LogTransaction txnLogs=new LogTransaction(OperationType.UNKNOWN);
  Iterable<SSTableReader> readers=Lists.newArrayList(MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  List<LogTransaction.Obsoletion> obsoletions=new ArrayList<>();
  Assert.assertNull(Helpers.prepareForObsoletion(readers,txnLogs,obsoletions,null));
  assertNotNull(obsoletions);
  assertEquals(2,obsoletions.size());
  Throwable accumulate=Helpers.markObsolete(obsoletions,null);
  Assert.assertNull(accumulate);
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isMarkedCompacted());
  accumulate=Helpers.markObsolete(obsoletions,null);
  assertNotNull(accumulate);
  txnLogs.finish();
}

</code></pre>

<br>
<pre class="type-7 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetupDeletionNotification(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Iterable<SSTableReader> readers=Lists.newArrayList(MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  Throwable accumulate=Helpers.setReplaced(readers,null);
  Assert.assertNull(accumulate);
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isReplaced());
  accumulate=Helpers.setReplaced(readers,null);
  assertNotNull(accumulate);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.LifecycleTransactionTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdates(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  SSTableReader[] readers=readersArray(0,3,cfs);
  SSTableReader[] readers2=readersArray(0,4,cfs);
  SSTableReader[] readers3=readersArray(0,4,cfs);
  tracker.addInitialSSTables(copyOf(readers));
  LifecycleTransaction txn=tracker.tryModify(copyOf(readers),OperationType.UNKNOWN);
  txn.update(readers2[0],true);
  txn.obsolete(readers[1]);
  Assert.assertTrue(txn.isObsolete(readers[1]));
  Assert.assertFalse(txn.isObsolete(readers[0]));
  testBadUpdate(txn,readers2[0],true);
  testBadUpdate(txn,readers2[1],true);
  testBadUpdate(txn,readers3[0],true);
  testBadUpdate(txn,readers2[2],false);
  testBadUpdate(txn,readers2[3],true);
  testBadObsolete(txn,readers[1]);
  testBadObsolete(txn,readers2[0]);
  txn.update(readers2[3],false);
  Assert.assertEquals(3,tracker.getView().compacting.size());
  txn.checkpoint();
  Assert.assertTrue(txn.isObsolete(readers[1]));
  Assert.assertFalse(txn.isObsolete(readers[0]));
  Assert.assertEquals(4,tracker.getView().compacting.size());
  Assert.assertEquals(3,tracker.getView().sstables.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(of(readers2[0],readers[2],readers2[3]),idIn(tracker.getView().sstablesMap)));
  Assert.assertTrue(all(txn.current(),idIn(tracker.getView().sstablesMap)));
  testBadObsolete(txn,readers[1]);
  testBadObsolete(txn,readers2[2]);
  testBadObsolete(txn,readers2[3]);
  testBadUpdate(txn,readers3[1],true);
  testBadUpdate(txn,readers2[0],true);
  txn.update(readers3[0],true);
  txn.checkpoint();
  Assert.assertEquals(4,tracker.getView().compacting.size());
  Assert.assertEquals(3,tracker.getView().sstables.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(of(readers3[0],readers[2],readers2[3]),idIn(tracker.getView().sstablesMap)));
  Assert.assertTrue(all(txn.current(),idIn(tracker.getView().sstablesMap)));
  testBadObsolete(txn,readers2[0]);
  txn.obsoleteOriginals();
  txn.checkpoint();
  Assert.assertEquals(1,tracker.getView().sstables.size());
  txn.obsoleteOriginals();
  txn.checkpoint();
  Assert.assertEquals(1,tracker.getView().sstables.size());
  Assert.assertEquals(4,tracker.getView().compacting.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  List<SSTableReader> readers=readers(0,4,cfs);
  tracker.addInitialSSTables(readers);
  LifecycleTransaction txn=tracker.tryModify(readers,OperationType.UNKNOWN);
  txn.cancel(readers.get(3));
  LifecycleTransaction txn2=txn.split(readers.subList(0,1));
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertTrue(all(readers.subList(1,3),in(txn.originals())));
  Assert.assertEquals(1,txn2.originals().size());
  Assert.assertTrue(all(readers.subList(0,1),in(txn2.originals())));
  txn.update(readers(1,2,cfs).get(0),true);
  boolean failed=false;
  try {
    txn.split(readers.subList(2,3));
  }
 catch (  Throwable t) {
    failed=true;
  }
  Assert.assertTrue(failed);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCancellation(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  List<SSTableReader> readers=readers(0,3,cfs);
  tracker.addInitialSSTables(readers);
  LifecycleTransaction txn=tracker.tryModify(readers,OperationType.UNKNOWN);
  SSTableReader cancel=readers.get(0);
  SSTableReader update=readers(1,2,cfs).get(0);
  SSTableReader fresh=readers(3,4,cfs).get(0);
  SSTableReader notPresent=readers(4,5,cfs).get(0);
  txn.cancel(cancel);
  txn.update(update,true);
  txn.update(fresh,false);
  testBadCancel(txn,cancel);
  testBadCancel(txn,update);
  testBadCancel(txn,fresh);
  testBadCancel(txn,notPresent);
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertEquals(2,tracker.getView().compacting.size());
  Assert.assertTrue(all(readers.subList(1,3),idIn(tracker.getView().compacting)));
  txn.checkpoint();
  testBadCancel(txn,cancel);
  testBadCancel(txn,update);
  testBadCancel(txn,fresh);
  testBadCancel(txn,notPresent);
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertEquals(3,tracker.getView().compacting.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(concat(readers.subList(1,3),of(fresh)),idIn(tracker.getView().compacting)));
  txn.cancel(readers.get(2));
  Assert.assertEquals(1,txn.originals().size());
  Assert.assertEquals(2,tracker.getView().compacting.size());
  Assert.assertEquals(2,size(txn.current()));
  Assert.assertTrue(all(of(readers.get(1),fresh),idIn(tracker.getView().compacting)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.LogTransactionTest </h4><pre class="type-7 type-4 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies values related to public fields.
"></span><br>
@Test public void testCommitSameDesc() throws Throwable {
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  File dataFolder=new Directories(cfs.metadata).getDirectoryForNewSSTables();
  SSTableReader sstableOld1=sstable(dataFolder,cfs,0,128);
  SSTableReader sstableOld2=sstable(dataFolder,cfs,0,256);
  SSTableReader sstableNew=sstable(dataFolder,cfs,1,128);
  LogTransaction log=new LogTransaction(OperationType.COMPACTION);
  assertNotNull(log);
  log.trackNew(sstableNew);
  sstableOld1.setReplaced();
  LogTransaction.SSTableTidier tidier=log.obsoleted(sstableOld2);
  assertNotNull(tidier);
  log.finish();
  sstableOld2.markObsolete(tidier);
  sstableOld1.selfRef().release();
  sstableOld2.selfRef().release();
  assertFiles(dataFolder.getPath(),new HashSet<>(sstableNew.getAllFilePaths()));
  sstableNew.selfRef().release();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies values related to public fields.
"></span><br>
@Test public void testCommitOnlyOld() throws Throwable {
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  File dataFolder=new Directories(cfs.metadata).getDirectoryForNewSSTables();
  SSTableReader sstable=sstable(dataFolder,cfs,0,128);
  LogTransaction log=new LogTransaction(OperationType.COMPACTION);
  assertNotNull(log);
  LogTransaction.SSTableTidier tidier=log.obsoleted(sstable);
  assertNotNull(tidier);
  log.finish();
  sstable.markObsolete(tidier);
  sstable.selfRef().release();
  assertFiles(dataFolder.getPath(),new HashSet<>());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies values related to public fields.
"></span><br>
@Test public void testAbortOnlyOld() throws Throwable {
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  File dataFolder=new Directories(cfs.metadata).getDirectoryForNewSSTables();
  SSTableReader sstable=sstable(dataFolder,cfs,0,128);
  LogTransaction log=new LogTransaction(OperationType.COMPACTION);
  assertNotNull(log);
  LogTransaction.SSTableTidier tidier=log.obsoleted(sstable);
  assertNotNull(tidier);
  tidier.abort();
  log.abort();
  sstable.selfRef().release();
  assertFiles(dataFolder.getPath(),new HashSet<>(sstable.getAllFilePaths()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.TrackerTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemtableReplacement(){
  boolean backups=DatabaseDescriptor.isIncrementalBackupsEnabled();
  DatabaseDescriptor.setIncrementalBackupsEnabled(false);
  ColumnFamilyStore cfs=MockSchema.newCFS();
  MockListener listener=new MockListener(false);
  Tracker tracker=cfs.getTracker();
  tracker.subscribe(listener);
  Memtable prev1=tracker.switchMemtable(true);
  OpOrder.Group write1=cfs.keyspace.writeOrder.getCurrent();
  OpOrder.Barrier barrier1=cfs.keyspace.writeOrder.newBarrier();
  prev1.setDiscarding(barrier1,new AtomicReference<ReplayPosition>());
  barrier1.issue();
  Memtable prev2=tracker.switchMemtable(false);
  OpOrder.Group write2=cfs.keyspace.writeOrder.getCurrent();
  OpOrder.Barrier barrier2=cfs.keyspace.writeOrder.newBarrier();
  prev2.setDiscarding(barrier2,new AtomicReference<ReplayPosition>());
  barrier2.issue();
  Memtable cur=tracker.getView().getCurrentMemtable();
  OpOrder.Group writecur=cfs.keyspace.writeOrder.getCurrent();
  Assert.assertEquals(prev1,tracker.getMemtableFor(write1,ReplayPosition.NONE));
  Assert.assertEquals(prev2,tracker.getMemtableFor(write2,ReplayPosition.NONE));
  Assert.assertEquals(cur,tracker.getMemtableFor(writecur,ReplayPosition.NONE));
  Assert.assertEquals(1,listener.received.size());
  Assert.assertTrue(listener.received.get(0) instanceof MemtableRenewedNotification);
  listener.received.clear();
  tracker.markFlushing(prev2);
  Assert.assertEquals(1,tracker.getView().flushingMemtables.size());
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev2));
  tracker.markFlushing(prev1);
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev1));
  Assert.assertEquals(2,tracker.getView().flushingMemtables.size());
  tracker.replaceFlushed(prev1,null);
  Assert.assertEquals(1,tracker.getView().flushingMemtables.size());
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev2));
  SSTableReader reader=MockSchema.sstable(0,10,false,cfs);
  tracker.replaceFlushed(prev2,singleton(reader));
  Assert.assertEquals(1,tracker.getView().sstables.size());
  Assert.assertEquals(1,listener.received.size());
  Assert.assertEquals(singleton(reader),((SSTableAddedNotification)listener.received.get(0)).added);
  listener.received.clear();
  Assert.assertTrue(reader.isKeyCacheSetup());
  Assert.assertEquals(10,cfs.metric.liveDiskSpaceUsed.getCount());
  cfs=MockSchema.newCFS();
  tracker=cfs.getTracker();
  listener=new MockListener(false);
  tracker.subscribe(listener);
  prev1=tracker.switchMemtable(false);
  tracker.markFlushing(prev1);
  reader=MockSchema.sstable(0,10,true,cfs);
  cfs.invalidate(false);
  tracker.replaceFlushed(prev1,singleton(reader));
  Assert.assertEquals(0,tracker.getView().sstables.size());
  Assert.assertEquals(0,tracker.getView().flushingMemtables.size());
  Assert.assertEquals(0,cfs.metric.liveDiskSpaceUsed.getCount());
  Assert.assertEquals(3,listener.received.size());
  Assert.assertEquals(singleton(reader),((SSTableAddedNotification)listener.received.get(0)).added);
  Assert.assertTrue(listener.received.get(1) instanceof SSTableDeletingNotification);
  Assert.assertEquals(1,((SSTableListChangedNotification)listener.received.get(2)).removed.size());
  DatabaseDescriptor.setIncrementalBackupsEnabled(backups);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotifications(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  SSTableReader r1=MockSchema.sstable(0,cfs), r2=MockSchema.sstable(1,cfs);
  Tracker tracker=new Tracker(null,false);
  MockListener listener=new MockListener(false);
  tracker.subscribe(listener);
  tracker.notifyAdded(singleton(r1));
  Assert.assertEquals(singleton(r1),((SSTableAddedNotification)listener.received.get(0)).added);
  listener.received.clear();
  tracker.notifyDeleting(r1);
  Assert.assertEquals(r1,((SSTableDeletingNotification)listener.received.get(0)).deleting);
  listener.received.clear();
  Assert.assertNull(tracker.notifySSTablesChanged(singleton(r1),singleton(r2),OperationType.COMPACTION,null));
  Assert.assertEquals(singleton(r1),((SSTableListChangedNotification)listener.received.get(0)).removed);
  Assert.assertEquals(singleton(r2),((SSTableListChangedNotification)listener.received.get(0)).added);
  listener.received.clear();
  tracker.notifySSTableRepairedStatusChanged(singleton(r1));
  Assert.assertEquals(singleton(r1),((SSTableRepairStatusChanged)listener.received.get(0)).sstable);
  listener.received.clear();
  Memtable memtable=MockSchema.memtable(cfs);
  tracker.notifyRenewed(memtable);
  Assert.assertEquals(memtable,((MemtableRenewedNotification)listener.received.get(0)).renewed);
  listener.received.clear();
  tracker.unsubscribe(listener);
  MockListener failListener=new MockListener(true);
  tracker.subscribe(failListener);
  tracker.subscribe(listener);
  Assert.assertNotNull(tracker.notifyAdded(singleton(r1),null));
  Assert.assertEquals(singleton(r1),((SSTableAddedNotification)listener.received.get(0)).added);
  listener.received.clear();
  Assert.assertNotNull(tracker.notifySSTablesChanged(singleton(r1),singleton(r2),OperationType.COMPACTION,null));
  Assert.assertEquals(singleton(r1),((SSTableListChangedNotification)listener.received.get(0)).removed);
  Assert.assertEquals(singleton(r2),((SSTableListChangedNotification)listener.received.get(0)).added);
  listener.received.clear();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApply(){
  final ColumnFamilyStore cfs=MockSchema.newCFS();
  final Tracker tracker=new Tracker(null,false);
  final View resultView=ViewTest.fakeView(0,0,cfs);
  final AtomicInteger count=new AtomicInteger();
  tracker.apply(new Predicate<View>(){
    public boolean apply(    View view){
      if (count.incrementAndGet() < 3)       tracker.view.set(ViewTest.fakeView(0,0,cfs));
      return true;
    }
  }
,new Function<View,View>(){
    @Nullable public View apply(    View view){
      return resultView;
    }
  }
);
  Assert.assertEquals(3,count.get());
  Assert.assertEquals(resultView,tracker.getView());
  count.set(0);
  Assert.assertNull(tracker.apply(new Predicate<View>(){
    public boolean apply(    View view){
      count.incrementAndGet();
      return false;
    }
  }
,null));
  Assert.assertEquals(1,count.get());
  Assert.assertEquals(resultView,tracker.getView());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTryModify(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(cfs,false);
  List<SSTableReader> readers=ImmutableList.of(MockSchema.sstable(0,true,cfs),MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  tracker.addInitialSSTables(copyOf(readers));
  Assert.assertNull(tracker.tryModify(ImmutableList.of(MockSchema.sstable(0,cfs)),OperationType.COMPACTION));
  try (LifecycleTransaction txn=tracker.tryModify(readers.get(0),OperationType.COMPACTION)){
    Assert.assertNotNull(txn);
    Assert.assertNull(tracker.tryModify(readers.get(0),OperationType.COMPACTION));
    Assert.assertEquals(1,txn.originals().size());
    Assert.assertTrue(txn.originals().contains(readers.get(0)));
  }
   try (LifecycleTransaction txn=tracker.tryModify(Collections.<SSTableReader>emptyList(),OperationType.COMPACTION)){
    Assert.assertNotNull(txn);
    Assert.assertEquals(0,txn.originals().size());
  }
   readers.get(0).selfRef().release();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.ViewTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushing(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(1,0,cfs);
  View cur=initialView;
  Memtable memtable1=initialView.getCurrentMemtable();
  Memtable memtable2=MockSchema.memtable(cfs);
  cur=View.switchMemtable(memtable2).apply(cur);
  Assert.assertEquals(2,cur.liveMemtables.size());
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable2,cur.getCurrentMemtable());
  Memtable memtable3=MockSchema.memtable(cfs);
  cur=View.switchMemtable(memtable3).apply(cur);
  Assert.assertEquals(3,cur.liveMemtables.size());
  Assert.assertEquals(0,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable2,cur.liveMemtables.get(1));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  testFailure(View.replaceFlushed(memtable2,null),cur);
  cur=View.markFlushing(memtable2).apply(cur);
  Assert.assertTrue(cur.flushingMemtables.contains(memtable2));
  Assert.assertEquals(2,cur.liveMemtables.size());
  Assert.assertEquals(1,cur.flushingMemtables.size());
  Assert.assertEquals(memtable2,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  cur=View.markFlushing(memtable1).apply(cur);
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(2,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable2,cur.flushingMemtables.get(1));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  cur=View.replaceFlushed(memtable2,null).apply(cur);
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(1,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  SSTableReader sstable=MockSchema.sstable(1,cfs);
  cur=View.replaceFlushed(memtable1,singleton(sstable)).apply(cur);
  Assert.assertEquals(0,cur.flushingMemtables.size());
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  Assert.assertEquals(1,cur.sstables.size());
  Assert.assertEquals(sstable,cur.sstablesMap.get(sstable));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSSTablesInBounds(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(0,5,cfs);
  for (int i=0; i < 5; i++) {
    for (int j=i; j < 5; j++) {
      PartitionPosition min=MockSchema.readerBounds(i);
      PartitionPosition max=MockSchema.readerBounds(j);
      for (      boolean minInc : new boolean[]{true}) {
        for (        boolean maxInc : new boolean[]{true}) {
          if (i == j && !(minInc && maxInc))           continue;
          AbstractBounds<PartitionPosition> bounds=AbstractBounds.bounds(min,minInc,max,maxInc);
          List<SSTableReader> r=ImmutableList.copyOf(initialView.sstablesInBounds(SSTableSet.LIVE,bounds.left,bounds.right));
          Assert.assertEquals(String.format("%d(%s) %d(%s)",i,minInc,j,maxInc),j - i + (minInc ? 0 : -1) + (maxInc ? 1 : 0),r.size());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-14 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompaction(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(0,5,cfs);
  View cur=initialView;
  List<SSTableReader> readers=ImmutableList.copyOf(initialView.sstables);
  Assert.assertTrue(View.permitCompacting(readers).apply(cur));
  Assert.assertTrue(View.permitCompacting(ImmutableList.copyOf(concat(readers,readers))).apply(cur));
  testFailure(View.updateCompacting(emptySet(),concat(readers.subList(0,1),readers.subList(0,1))),cur);
  cur=View.updateCompacting(emptySet(),readers.subList(0,2)).apply(cur);
  Assert.assertTrue(View.permitCompacting(readers.subList(2,5)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(0,2)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(0,1)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(1,2)).apply(cur));
  Assert.assertTrue(readers.subList(2,5).containsAll(copyOf(cur.getUncompacting(readers))));
  Assert.assertEquals(3,copyOf(cur.getUncompacting(readers)).size());
  Assert.assertTrue(ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING)).containsAll(readers.subList(2,5)));
  Assert.assertEquals(3,ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING)).size());
  testFailure(View.updateCompacting(emptySet(),readers.subList(0,1)),cur);
  testFailure(View.updateCompacting(emptySet(),readers.subList(1,2)),cur);
  testFailure(View.updateCompacting(copyOf(readers.subList(0,1)),readers.subList(1,2)),cur);
  SSTableReader r0=MockSchema.sstable(0,cfs), r1=MockSchema.sstable(1,cfs), r2=MockSchema.sstable(2,cfs);
  testFailure(View.updateCompacting(emptySet(),of(r2)),cur);
  cur=View.updateLiveSet(copyOf(readers.subList(1,3)),of(r1,r2)).apply(cur);
  Assert.assertSame(readers.get(0),cur.sstablesMap.get(r0));
  Assert.assertSame(r1,cur.sstablesMap.get(r1));
  Assert.assertSame(r2,cur.sstablesMap.get(r2));
  testFailure(View.updateCompacting(emptySet(),readers.subList(2,3)),cur);
  Assert.assertSame(readers.get(1),Iterables.getFirst(Iterables.filter(cur.compacting,Predicates.equalTo(r1)),null));
  cur=View.updateCompacting(copyOf(readers.subList(0,1)),emptySet()).apply(cur);
  Assert.assertTrue(View.permitCompacting(concat(readers.subList(0,1),of(r2),readers.subList(3,5))).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(1,2)).apply(cur));
  testFailure(View.updateCompacting(emptySet(),readers.subList(1,2)),cur);
  testFailure(View.updateCompacting(copyOf(readers.subList(0,2)),emptySet()),cur);
  Assert.assertTrue(copyOf(concat(readers.subList(0,1),readers.subList(2,5))).containsAll(copyOf(cur.getUncompacting(readers))));
  Assert.assertEquals(4,copyOf(cur.getUncompacting(readers)).size());
  Set<SSTableReader> nonCompacting=ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING));
  Assert.assertTrue(nonCompacting.containsAll(readers.subList(2,5)));
  Assert.assertTrue(nonCompacting.containsAll(readers.subList(0,1)));
  Assert.assertEquals(4,nonCompacting.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.CompositeTypeTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEscapeUnescape(){
  List<AbstractType<?>> subComparators=new ArrayList<AbstractType<?>>(){
{
      ;
      add(UTF8Type.instance);
      add(UTF8Type.instance);
    }
  }
;
  CompositeType comp=CompositeType.getInstance(subComparators);
  String[][] inputs=new String[][]{new String[]{"foo","bar"},new String[]{"",""},new String[]{"foo\\","bar"},new String[]{"foo\\:","bar"},new String[]{"foo:","bar"},new String[]{"foo","b:ar"},new String[]{"foo!","b:ar"}};
  for (  String[] input : inputs) {
    CompositeType.Builder builder=new CompositeType.Builder(comp);
    for (    String part : input)     builder.add(UTF8Type.instance.fromString(part));
    ByteBuffer value=comp.fromString(comp.getString(builder.build()));
    ByteBuffer[] splitted=comp.split(value);
    for (int i=0; i < splitted.length; i++)     assertEquals(input[i],UTF8Type.instance.getString(splitted[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.DecimalTypeTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1Decompose_compose(){
  ByteBuffer bb=DecimalType.instance.decompose(low);
  String string=DecimalType.instance.compose(bb).toPlainString();
  assertEquals(LOW,string);
  bb=DecimalType.instance.decompose(null);
  assertEquals(bb,ByteBufferUtil.EMPTY_BYTE_BUFFER);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2Compare(){
  ByteBuffer lowBB=DecimalType.instance.decompose(low);
  ByteBuffer low2BB=DecimalType.instance.decompose(low);
  ByteBuffer highBB=DecimalType.instance.decompose(high);
  assertEquals(-1,DecimalType.instance.compare(lowBB,highBB));
  lowBB=DecimalType.instance.decompose(low);
  highBB=DecimalType.instance.decompose(high);
  assertEquals(1,DecimalType.instance.compare(highBB,lowBB));
  lowBB=DecimalType.instance.decompose(low);
  assertEquals(0,DecimalType.instance.compare(low2BB,lowBB));
  lowBB=DecimalType.instance.decompose(low);
  assertEquals(-1,DecimalType.instance.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,lowBB));
  lowBB=DecimalType.instance.decompose(low);
  assertEquals(1,DecimalType.instance.compare(lowBB,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertEquals(0,DecimalType.instance.compare(ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test3Sort(){
  ByteBuffer zeroBB=DecimalType.instance.decompose(zero);
  ByteBuffer minusBB=DecimalType.instance.decompose(minus);
  ByteBuffer lowBB=DecimalType.instance.decompose(low);
  ByteBuffer highBB=DecimalType.instance.decompose(high);
  ByteBuffer[] array={highBB,minusBB,lowBB,lowBB,zeroBB,minusBB};
  Arrays.sort(array,DecimalType.instance);
  for (int i=1; i < array.length; i++) {
    BigDecimal i0=DecimalType.instance.compose(array[i - 1]);
    BigDecimal i1=DecimalType.instance.compose(array[i]);
    assertTrue("#" + i,i0.compareTo(i1) <= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TimeUUIDTypeTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEquality(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=new UUID(a.getMostSignificantBits(),a.getLeastSignificantBits());
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(a)));
  timeUUIDType.validate(ByteBuffer.wrap(UUIDGen.decompose(b)));
  assertEquals(0,timeUUIDType.compare(ByteBuffer.wrap(UUIDGen.decompose(a)),ByteBuffer.wrap(UUIDGen.decompose(b))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.UUIDTypeTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeEquality(){
  UUID a=UUIDGen.getTimeUUID();
  UUID b=new UUID(a.getMostSignificantBits(),a.getLeastSignificantBits());
  assertEquals(0,uuidType.compare(bytebuffer(a),bytebuffer(b)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.RowAndDeletionMergeIteratorTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithAtMostRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNonShadowingTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,-1L,0));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWithPartitionLevelTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds - 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime),greaterThan(2,timestamp,delTime));
  int partitionDelTime=nowInSeconds + 1;
  long partitionTimestamp=toMillis(partitionDelTime);
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,new DeletionTime(partitionTimestamp,partitionDelTime),false);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithExcludingEndIncludingStartMarker(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(lessThan(2,timestamp,delTime),atLeast(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_END_INCL_START_BOUNDARY,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithAtMostAndGreaterThanRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime),greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithNoRangeTombstones(){
  Iterator<Row> rowIterator=createRowIterator();
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,Collections.emptyIterator(),false);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithIncludingEndExcludingStartMarker(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(2,timestamp,delTime),greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_EXCL_START_BOUNDARY,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithOnlyRangeTombstones(){
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(rt(1,false,3,false,timestamp,delTime),atLeast(4,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(Collections.emptyIterator(),rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,1);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_END_BOUND,3);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_START_BOUND,4);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithGreaterThanRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.RowsTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * If a row's deletion time deletes a row's liveness info, the new row should have it's
 * liveness info set to empty
 */
@Test public void mergeRowDeletionSupercedesLiveness(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,null,null,null);
  int now2=now1 + 1;
  Row.Builder updateBuilder=createBuilder(c1,now2,BB1,BB1,BB1);
  int now3=now2 + 1;
  Row.Deletion expectedDeletion=new Row.Deletion(new DeletionTime(secondToTs(now3),now3),false);
  updateBuilder.addRowDeletion(expectedDeletion);
  RowBuilder builder=new RowBuilder();
  Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now3 + 1);
  Assert.assertEquals(expectedDeletion,builder.deletionTime);
  Assert.assertEquals(LivenessInfo.EMPTY,builder.livenessInfo);
  Assert.assertEquals(Collections.emptyList(),builder.complexDeletions);
  Assert.assertEquals(Collections.emptyList(),builder.cells);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void merge(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,BB1,BB1,BB1);
  int now2=now1 + 1;
  long ts2=secondToTs(now2);
  Cell expectedVCell=BufferCell.live(kcvm,v,ts2,BB2);
  Cell expectedMCell=BufferCell.live(kcvm,m,ts2,BB2,CellPath.create(BB1));
  DeletionTime expectedComplexDeletionTime=new DeletionTime(ts2 - 1,now2);
  Row.Builder updateBuilder=createBuilder(c1,now2,null,null,null);
  updateBuilder.addCell(expectedVCell);
  updateBuilder.addComplexDeletion(m,expectedComplexDeletionTime);
  updateBuilder.addCell(expectedMCell);
  RowBuilder builder=new RowBuilder();
  long td=Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now2 + 1);
  Assert.assertEquals(c1,builder.clustering);
  Assert.assertEquals(LivenessInfo.create(kcvm,ts2,now2),builder.livenessInfo);
  Assert.assertEquals(Lists.newArrayList(Pair.create(m,new DeletionTime(ts2 - 1,now2))),builder.complexDeletions);
  Assert.assertEquals(2,builder.cells.size());
  Assert.assertEquals(Lists.newArrayList(expectedVCell,expectedMCell),Lists.newArrayList(builder.cells));
  Assert.assertEquals(ts2 - secondToTs(now1),td);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void mergeComplexDeletionSupersededByRowDeletion(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,null,null,null);
  int now2=now1 + 1;
  Row.Builder updateBuilder=createBuilder(c1,now2,null,BB1,BB1);
  int now3=now2 + 1;
  Row.Deletion expectedDeletion=new Row.Deletion(new DeletionTime(secondToTs(now3),now3),false);
  updateBuilder.addRowDeletion(expectedDeletion);
  RowBuilder builder=new RowBuilder();
  Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now3 + 1);
  Assert.assertEquals(expectedDeletion,builder.deletionTime);
  Assert.assertEquals(Collections.emptyList(),builder.complexDeletions);
  Assert.assertEquals(Collections.emptyList(),builder.cells);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.BoundsTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNonOverlappingBounds(){
  List<Bounds<Token>> bounds=new LinkedList<>();
  bounds.add(bounds(19,20));
  bounds.add(bounds(0,1));
  bounds.add(bounds(4,10));
  bounds.add(bounds(15,19));
  bounds.add(bounds(0,5));
  bounds.add(bounds(21,22));
  bounds.add(bounds(1,8));
  Set<Bounds<Token>> nonOverlappingBounds=Bounds.getNonOverlappingBounds(bounds);
  assertEquals(3,nonOverlappingBounds.size());
  assertTrue(nonOverlappingBounds.contains(bounds(0,10)));
  assertTrue(nonOverlappingBounds.contains(bounds(15,20)));
  assertTrue(nonOverlappingBounds.contains(bounds(21,22)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.RangeTest </h4><pre class="type-6 type-7 type-13 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRandomOrderedRangeContainmentChecker(){
  Random r=new Random();
  for (int j=0; j < 1000; j++) {
    int numTokens=r.nextInt(300) + 1;
    List<Range<Token>> ranges=new ArrayList<>(numTokens);
    List<Token> tokens=new ArrayList<>(2 * numTokens);
    for (int i=0; i < 2 * numTokens; i++)     tokens.add(t(r.nextLong()));
    Collections.sort(tokens);
    for (int i=0; i < tokens.size(); i++) {
      ranges.add(new Range<>(tokens.get(i),tokens.get(i + 1)));
      i++;
    }
    List<Token> tokensToTest=new ArrayList<>();
    for (int i=0; i < 10000; i++)     tokensToTest.add(t(r.nextLong()));
    tokensToTest.add(t(Long.MAX_VALUE));
    tokensToTest.add(t(Long.MIN_VALUE));
    tokensToTest.add(t(Long.MAX_VALUE - 1));
    tokensToTest.add(t(Long.MIN_VALUE + 1));
    Collections.sort(tokensToTest);
    Range.OrderedRangeContainmentChecker checker=new Range.OrderedRangeContainmentChecker(ranges);
    for (    Token t : tokensToTest) {
      if (checker.contains(t) != Range.isInRanges(t,ranges))       fail(String.format("This should never flap! If it does, it is a bug (ranges = %s, token = %s)",Joiner.on(",").join(ranges),t));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.gms.GossipDigestTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws IOException {
  InetAddress endpoint=InetAddress.getByName("127.0.0.1");
  int generation=0;
  int maxVersion=123;
  GossipDigest expected=new GossipDigest(endpoint,generation,maxVersion);
  assertEquals(endpoint,expected.getEndpoint());
  assertEquals(generation,expected.getGeneration());
  assertEquals(maxVersion,expected.getMaxVersion());
  DataOutputBuffer output=new DataOutputBuffer();
  GossipDigest.serializer.serialize(expected,output,MessagingService.current_version);
  DataInputPlus input=new DataInputBuffer(output.getData());
  GossipDigest actual=GossipDigest.serializer.deserialize(input,MessagingService.current_version);
  assertEquals(0,expected.compareTo(actual));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.gms.GossiperTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLargeGenerationJump() throws UnknownHostException, InterruptedException {
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,2);
  InetAddress remoteHostAddress=hosts.get(1);
  EndpointState initialRemoteState=Gossiper.instance.getEndpointStateForEndpoint(remoteHostAddress);
  HeartBeatState initialRemoteHeartBeat=initialRemoteState.getHeartBeatState();
  assertEquals(initialRemoteHeartBeat.getGeneration(),1);
  HeartBeatState proposedRemoteHeartBeat=new HeartBeatState(initialRemoteHeartBeat.getGeneration() + Gossiper.MAX_GENERATION_DIFFERENCE + 1);
  EndpointState proposedRemoteState=new EndpointState(proposedRemoteHeartBeat);
  Gossiper.instance.applyStateLocally(ImmutableMap.of(remoteHostAddress,proposedRemoteState));
  HeartBeatState actualRemoteHeartBeat=Gossiper.instance.getEndpointStateForEndpoint(remoteHostAddress).getHeartBeatState();
  assertEquals(proposedRemoteHeartBeat.getGeneration(),actualRemoteHeartBeat.getGeneration());
  HeartBeatState badProposedRemoteHeartBeat=new HeartBeatState((int)(System.currentTimeMillis() / 1000) + Gossiper.MAX_GENERATION_DIFFERENCE * 10);
  EndpointState badProposedRemoteState=new EndpointState(badProposedRemoteHeartBeat);
  Gossiper.instance.applyStateLocally(ImmutableMap.of(remoteHostAddress,badProposedRemoteState));
  actualRemoteHeartBeat=Gossiper.instance.getEndpointStateForEndpoint(remoteHostAddress).getHeartBeatState();
  assertEquals(proposedRemoteHeartBeat.getGeneration(),actualRemoteHeartBeat.getGeneration());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.ChecksummedDataInputTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadMethods() throws IOException {
  byte[] b=new byte[RandomAccessReader.DEFAULT_BUFFER_SIZE * 2];
  for (int i=0; i < b.length; i++)   b[i]=(byte)i;
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.write(b);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    out.writeDouble(3.3);
    out.writeFloat(2.2f);
    out.writeInt(42);
    out.writeLong(Long.MAX_VALUE);
    out.writeShort(Short.MIN_VALUE);
    out.writeUTF("utf");
    out.writeVInt(67L);
    out.writeUnsignedVInt(88L);
    out.writeBytes("abcdefghi");
    buffer=out.buffer();
  }
   CRC32 crc=new CRC32();
  FBUtilities.updateChecksum(crc,buffer);
  File file=File.createTempFile("testReadMethods","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.writeInt((int)crc.getValue());
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining() + 4,file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining() + 4);
    assertEquals(127,reader.read());
    byte[] bytes=new byte[b.length];
    reader.readFully(bytes);
    assertTrue(Arrays.equals(bytes,b));
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertEquals(3.3,reader.readDouble());
    assertEquals(2.2f,reader.readFloat());
    assertEquals(42,reader.readInt());
    assertEquals(Long.MAX_VALUE,reader.readLong());
    assertEquals(Short.MIN_VALUE,reader.readShort());
    assertEquals("utf",reader.readUTF());
    assertEquals(67L,reader.readVInt());
    assertEquals(88L,reader.readUnsignedVInt());
    assertEquals("abcdefghi",new String(ByteBufferUtil.read(reader,9).array(),StandardCharsets.UTF_8));
    assertTrue(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
    reader.checkLimit(0);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedCrc() throws IOException {
  CRC32 crc=new CRC32();
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    buffer=out.buffer();
    FBUtilities.updateChecksum(crc,buffer);
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    buffer=out.buffer();
  }
   File file=File.createTempFile("testFailedCrc","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining(),file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining());
    assertEquals(127,reader.read());
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertFalse(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResetCrc() throws IOException {
  CRC32 crc=new CRC32();
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    buffer=out.buffer();
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    int bufferPos=out.getLength();
    out.writeDouble(3.3);
    out.writeFloat(2.2f);
    out.writeInt(42);
    buffer=out.buffer();
    buffer.position(bufferPos);
    crc.reset();
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    buffer=out.buffer();
  }
   File file=File.createTempFile("testResetCrc","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining(),file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining());
    assertEquals(127,reader.read());
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertTrue(reader.checkCrc());
    reader.resetCrc();
    assertEquals(3.3,reader.readDouble());
    assertEquals(2.2f,reader.readFloat());
    assertEquals(42,reader.readInt());
    assertTrue(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintMessageTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerializer() throws IOException {
  SchemaLoader.prepareServer();
  SchemaLoader.createKeyspace(KEYSPACE,KeyspaceParams.simple(1),SchemaLoader.standardCFMD(KEYSPACE,TABLE));
  UUID hostId=UUID.randomUUID();
  long now=FBUtilities.timestampMicros();
  CFMetaData table=Schema.instance.getCFMetaData(KEYSPACE,TABLE);
  Mutation mutation=new RowUpdateBuilder(table,now,bytes("key")).clustering("column").add("val","val" + 1234).build();
  Hint hint=Hint.create(mutation,now / 1000);
  HintMessage message=new HintMessage(hostId,hint);
  int serializedSize=(int)HintMessage.serializer.serializedSize(message,MessagingService.current_version);
  DataOutputBuffer dob=new DataOutputBuffer();
  HintMessage.serializer.serialize(message,dob,MessagingService.current_version);
  assertEquals(serializedSize,dob.getLength());
  DataInputPlus di=new DataInputBuffer(dob.buffer(),true);
  HintMessage deserializedMessage=HintMessage.serializer.deserialize(di,MessagingService.current_version);
  assertEquals(hostId,deserializedMessage.hostId);
  assertHintsEqual(message.hint,deserializedMessage.hint);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerializer() throws IOException {
  long now=FBUtilities.timestampMicros();
  Mutation mutation=createMutation("testSerializer",now);
  Hint hint=Hint.create(mutation,now / 1000);
  int serializedSize=(int)Hint.serializer.serializedSize(hint,MessagingService.current_version);
  DataOutputBuffer dob=new DataOutputBuffer();
  Hint.serializer.serialize(hint,dob,MessagingService.current_version);
  assertEquals(serializedSize,dob.getLength());
  DataInputPlus di=new DataInputBuffer(dob.buffer(),true);
  Hint deserializedHint=Hint.serializer.deserialize(di,MessagingService.current_version);
  assertHintsEqual(hint,deserializedHint);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.CustomIndexTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notifyIndexersOfPartitionAndRowRemovalDuringCleanup() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k,c))");
  createIndex(String.format("CREATE CUSTOM INDEX cleanup_index ON %%s() USING '%s'",StubIndex.class.getName()));
  ColumnFamilyStore cfs=getCurrentColumnFamilyStore();
  StubIndex index=(StubIndex)cfs.indexManager.getIndexByName("cleanup_index");
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,1,1);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,2,2);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",3,3,3);
  assertEquals(4,index.rowsInserted.size());
  assertEquals(0,index.partitionDeletions.size());
  ReadCommand cmd=Util.cmd(cfs,0).build();
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator iterator=cmd.executeLocally(executionController)){
    assertTrue(iterator.hasNext());
    cfs.indexManager.deletePartition(iterator.next(),FBUtilities.nowInSeconds());
  }
   assertEquals(1,index.partitionDeletions.size());
  assertEquals(3,index.rowsDeleted.size());
  for (int i=0; i < 3; i++)   assertEquals(index.rowsDeleted.get(i).clustering(),index.rowsInserted.get(i).clustering());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.SASIIndexTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTruncate(){
  Map<String,Pair<String,Integer>> part1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key01",Pair.create("Ali",33));
      put("key02",Pair.create("Jeremy",41));
      put("key03",Pair.create("Elvera",22));
      put("key04",Pair.create("Bailey",45));
      put("key05",Pair.create("Emerson",32));
      put("key06",Pair.create("Kadin",38));
      put("key07",Pair.create("Maggie",36));
      put("key08",Pair.create("Kailey",36));
      put("key09",Pair.create("Armand",21));
      put("key10",Pair.create("Arnold",35));
    }
  }
;
  Map<String,Pair<String,Integer>> part2=new HashMap<String,Pair<String,Integer>>(){
{
      put("key11",Pair.create("Ken",38));
      put("key12",Pair.create("Penelope",43));
      put("key13",Pair.create("Wyatt",34));
      put("key14",Pair.create("Johnpaul",34));
      put("key15",Pair.create("Trycia",43));
      put("key16",Pair.create("Aida",21));
      put("key17",Pair.create("Devon",42));
    }
  }
;
  Map<String,Pair<String,Integer>> part3=new HashMap<String,Pair<String,Integer>>(){
{
      put("key18",Pair.create("Christina",20));
      put("key19",Pair.create("Rick",19));
      put("key20",Pair.create("Fannie",22));
      put("key21",Pair.create("Keegan",29));
      put("key22",Pair.create("Ignatius",36));
      put("key23",Pair.create("Ellis",26));
      put("key24",Pair.create("Annamarie",29));
      put("key25",Pair.create("Tianna",31));
      put("key26",Pair.create("Dennis",32));
    }
  }
;
  ColumnFamilyStore store=loadData(part1,1000,true);
  loadData(part2,2000,true);
  loadData(part3,3000,true);
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  Set<String> rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),16,rows.size());
  store.indexManager.truncateAllIndexesBlocking(500);
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),16,rows.size());
  store.indexManager.truncateAllIndexesBlocking(1500);
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),10,rows.size());
  store.indexManager.truncateAllIndexesBlocking(2500);
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),6,rows.size());
  store.indexManager.truncateAllIndexesBlocking(3500);
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),0,rows.size());
  Map<String,Pair<String,Integer>> part4=new HashMap<String,Pair<String,Integer>>(){
{
      put("key40",Pair.create("Tianna",31));
      put("key41",Pair.create("Dennis",32));
    }
  }
;
  loadData(part4,4000,true);
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertEquals(rows.toString(),1,rows.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrefixSSTableLookup(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer name=UTF8Type.instance.decompose("first_name_prefix");
  Mutation rm;
  rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,name,UTF8Type.instance.decompose("Pavel"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,name,UTF8Type.instance.decompose("Jordan"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,name,UTF8Type.instance.decompose("Mikhail"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,name,UTF8Type.instance.decompose("Michael"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,name,UTF8Type.instance.decompose("Johnny"),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  rm=new Mutation(KS_NAME,decoratedKey("key6"));
  update(rm,name,UTF8Type.instance.decompose("Jason"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key7"));
  update(rm,name,UTF8Type.instance.decompose("Vijay"),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("J")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key5","key6"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("j")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key5","key6"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("m")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3","key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("v")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key7"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("p")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("j")),buildExpression(name,Operator.NEQ,UTF8Type.instance.decompose("joh")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key6"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnicodeSupport(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,comment,UTF8Type.instance.decompose(" and normal ones"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,comment,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("normal")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  store.forceBlockingFlush();
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("normal")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInsertingIncorrectValuesIntoAgeIndex(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  final ByteBuffer age=UTF8Type.instance.decompose("age");
  Mutation rm=new Mutation(KS_NAME,decoratedKey(AsciiType.instance.decompose("key1")));
  update(rm,new ArrayList<Cell>(){
{
      add(buildCell(firstName,AsciiType.instance.decompose("pavel"),System.currentTimeMillis()));
      add(buildCell(age,LongType.instance.decompose(26L),System.currentTimeMillis()));
    }
  }
);
  rm.apply();
  store.forceBlockingFlush();
  Set<String> rows=getIndexed(store,10,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.GTE,Int32Type.instance.decompose(26)));
  Assert.assertEquals(0,rows.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnicodeSuffixMode(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment_suffix_split");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,comment,UTF8Type.instance.decompose(""),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,comment,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3","key4"},rows.toArray(new String[rows.size()])));
  store.forceBlockingFlush();
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3","key4"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSettingIsLiteralOption(){
  AbstractType<?> stringType=new AbstractType<String>(AbstractType.ComparisonType.CUSTOM){
    public ByteBuffer fromString(    String source) throws MarshalException {
      return UTF8Type.instance.fromString(source);
    }
    public Term fromJSONObject(    Object parsed) throws MarshalException {
      throw new UnsupportedOperationException();
    }
    public TypeSerializer<String> getSerializer(){
      return UTF8Type.instance.getSerializer();
    }
    public int compareCustom(    ByteBuffer a,    ByteBuffer b){
      return UTF8Type.instance.compare(a,b);
    }
  }
;
  ColumnDefinition columnA=ColumnDefinition.regularDef(KS_NAME,CF_NAME,"special-A",stringType);
  ColumnIndex indexA=new ColumnIndex(UTF8Type.instance,columnA,IndexMetadata.fromSchemaMetadata("special-index-A",IndexMetadata.Kind.CUSTOM,new HashMap<String,String>(){
{
      put(IndexTarget.CUSTOM_INDEX_OPTION_NAME,SASIIndex.class.getName());
    }
  }
));
  Assert.assertEquals(true,indexA.isIndexed());
  Assert.assertEquals(false,indexA.isLiteral());
  ColumnDefinition columnB=ColumnDefinition.regularDef(KS_NAME,CF_NAME,"special-B",stringType);
  ColumnIndex indexB=new ColumnIndex(UTF8Type.instance,columnB,IndexMetadata.fromSchemaMetadata("special-index-B",IndexMetadata.Kind.CUSTOM,new HashMap<String,String>(){
{
      put(IndexTarget.CUSTOM_INDEX_OPTION_NAME,SASIIndex.class.getName());
      put("is_literal","true");
    }
  }
));
  Assert.assertEquals(true,indexB.isIndexed());
  Assert.assertEquals(true,indexB.isLiteral());
  ColumnDefinition columnC=ColumnDefinition.regularDef(KS_NAME,CF_NAME,"special-C",UTF8Type.instance);
  ColumnIndex indexC=new ColumnIndex(UTF8Type.instance,columnC,IndexMetadata.fromSchemaMetadata("special-index-C",IndexMetadata.Kind.CUSTOM,new HashMap<String,String>(){
{
      put(IndexTarget.CUSTOM_INDEX_OPTION_NAME,SASIIndex.class.getName());
    }
  }
));
  Assert.assertEquals(true,indexC.isIndexed());
  Assert.assertEquals(true,indexC.isLiteral());
  ColumnDefinition columnD=ColumnDefinition.regularDef(KS_NAME,CF_NAME,"special-D",AsciiType.instance);
  ColumnIndex indexD=new ColumnIndex(UTF8Type.instance,columnD,IndexMetadata.fromSchemaMetadata("special-index-D",IndexMetadata.Kind.CUSTOM,new HashMap<String,String>(){
{
      put(IndexTarget.CUSTOM_INDEX_OPTION_NAME,SASIIndex.class.getName());
    }
  }
));
  Assert.assertEquals(true,indexD.isIndexed());
  Assert.assertEquals(true,indexD.isLiteral());
  ColumnDefinition columnE=ColumnDefinition.regularDef(KS_NAME,CF_NAME,"special-E",UTF8Type.instance);
  ColumnIndex indexE=new ColumnIndex(UTF8Type.instance,columnE,IndexMetadata.fromSchemaMetadata("special-index-E",IndexMetadata.Kind.CUSTOM,new HashMap<String,String>(){
{
      put(IndexTarget.CUSTOM_INDEX_OPTION_NAME,SASIIndex.class.getName());
      put("is_literal","false");
    }
  }
));
  Assert.assertEquals(true,indexE.isIndexed());
  Assert.assertEquals(false,indexE.isLiteral());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThatTooBigValueIsRejected(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment_suffix_split");
  for (int i=0; i < 10; i++) {
    byte[] randomBytes=new byte[ThreadLocalRandom.current().nextInt(OnDiskIndexBuilder.MAX_TERM_SIZE,5 * OnDiskIndexBuilder.MAX_TERM_SIZE)];
    ThreadLocalRandom.current().nextBytes(randomBytes);
    final ByteBuffer bigValue=UTF8Type.instance.decompose(new String(randomBytes));
    Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
    update(rm,comment,bigValue,System.currentTimeMillis());
    rm.apply();
    Set<String> rows;
    rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,bigValue.duplicate()));
    Assert.assertEquals(0,rows.size());
    store.forceBlockingFlush();
    rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,bigValue.duplicate()));
    Assert.assertEquals(0,rows.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSameKeyInMemtableAndSSTables(){
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  final ByteBuffer age=UTF8Type.instance.decompose("age");
  Map<String,Pair<String,Integer>> data1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",26));
      put("key3",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",27));
    }
  }
;
  ColumnFamilyStore store=loadData(data1,true);
  Map<String,Pair<String,Integer>> data2=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",28));
    }
  }
;
  loadData(data2,true);
  Map<String,Pair<String,Integer>> data3=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",15));
      put("key4",Pair.create("Jason",29));
    }
  }
;
  loadData(data3,false);
  Set<String> rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1","key2","key3","key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(15)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(29)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(27)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-15 type-4 type-5 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchTimeouts() throws Exception {
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  Map<String,Pair<String,Integer>> data1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",26));
      put("key3",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",27));
    }
  }
;
  ColumnFamilyStore store=loadData(data1,true);
  RowFilter filter=RowFilter.create();
  filter.add(store.metadata.getColumnDefinition(firstName),Operator.EQ,AsciiType.instance.fromString("a"));
  ReadCommand command=new PartitionRangeReadCommand(store.metadata,FBUtilities.nowInSeconds(),ColumnFilter.all(store.metadata),filter,DataLimits.NONE,DataRange.allData(store.metadata.partitioner),Optional.empty());
  try {
    new QueryPlan(store,command,0).execute(ReadExecutionController.empty());
    Assert.fail();
  }
 catch (  TimeQuotaExceededException e) {
  }
catch (  Exception e) {
    Assert.fail();
    e.printStackTrace();
  }
  Set<String> rows=getKeys(new QueryPlan(store,command,DatabaseDescriptor.getRangeRpcTimeout()).execute(ReadExecutionController.empty()));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1","key2","key3","key4"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testChinesePrefixSearch(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer fullName=UTF8Type.instance.decompose("/output/full-name/");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key6"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key7"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key8"));
  update(rm,fullName,UTF8Type.instance.decompose(" "),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose(" ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose(" ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key7"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.OnDiskIndexTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testSuperBlocks() throws Exception {
  Map<ByteBuffer,TokenTreeBuilder> terms=new HashMap<>();
  terms.put(UTF8Type.instance.decompose("1234"),keyBuilder(1L,2L));
  terms.put(UTF8Type.instance.decompose("2345"),keyBuilder(3L,4L));
  terms.put(UTF8Type.instance.decompose("3456"),keyBuilder(5L,6L));
  terms.put(UTF8Type.instance.decompose("4567"),keyBuilder(7L,8L));
  terms.put(UTF8Type.instance.decompose("5678"),keyBuilder(9L,10L));
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,Int32Type.instance,OnDiskIndexBuilder.Mode.SPARSE);
  for (  Map.Entry<ByteBuffer,TokenTreeBuilder> entry : terms.entrySet())   addAll(builder,entry.getKey(),entry.getValue());
  File index=File.createTempFile("on-disk-sa-try-superblocks",".db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,Int32Type.instance,new KeyConverter());
  OnDiskIndex.OnDiskSuperBlock superBlock=onDisk.dataLevel.getSuperBlock(0);
  Iterator<Token> iter=superBlock.iterator();
  Long lastToken=null;
  while (iter.hasNext()) {
    Token token=iter.next();
    if (lastToken != null)     Assert.assertTrue(lastToken.compareTo(token.get()) < 0);
    lastToken=token.get();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparseMode() throws Exception {
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,LongType.instance,OnDiskIndexBuilder.Mode.SPARSE);
  final long start=System.currentTimeMillis();
  final int numIterations=100000;
  for (long i=0; i < numIterations; i++)   builder.add(LongType.instance.decompose(start + i),keyAt(i),i);
  File index=File.createTempFile("on-disk-sa-sparse","db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,LongType.instance,new KeyConverter());
  ThreadLocalRandom random=ThreadLocalRandom.current();
  for (long step=start; step < (start + numIterations); step+=1000) {
    boolean lowerInclusive=random.nextBoolean();
    boolean upperInclusive=random.nextBoolean();
    long limit=random.nextLong(step,start + numIterations);
    RangeIterator<Long,Token> rows=onDisk.search(expressionFor(step,lowerInclusive,limit,upperInclusive));
    long lowerKey=step - start;
    long upperKey=lowerKey + (limit - step);
    if (!lowerInclusive)     lowerKey+=1;
    if (upperInclusive)     upperKey+=1;
    Set<DecoratedKey> actual=convert(rows);
    for (long key=lowerKey; key < upperKey; key++)     Assert.assertTrue("key" + key + " wasn't found",actual.contains(keyAt(key)));
    Assert.assertEquals((upperKey - lowerKey),actual.size());
  }
  RangeIterator<Long,Token> rows=onDisk.search(expressionFor(start,true,start + numIterations,true));
  Set<DecoratedKey> actual=convert(rows);
  Assert.assertEquals(numIterations,actual.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.TokenTreeTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildWithMultipleMapsAndIterate() throws Exception {
  final SortedMap<Long,LongSet> merged=new TreeMap<>();
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  builder.add(collidingTokensMap);
  merged.putAll(collidingTokensMap);
  for (  Map.Entry<Long,LongSet> entry : simpleTokenMap.entrySet()) {
    if (merged.containsKey(entry.getKey())) {
      LongSet mergingOffsets=entry.getValue();
      LongSet existingOffsets=merged.get(entry.getKey());
      if (mergingOffsets.equals(existingOffsets))       continue;
      Set<Long> mergeSet=new HashSet<>();
      for (      LongCursor merging : mergingOffsets)       mergeSet.add(merging.value);
      for (      LongCursor existing : existingOffsets)       mergeSet.add(existing.value);
      LongSet mergedResults=new LongOpenHashSet();
      for (      Long result : mergeSet)       mergedResults.add(result);
      merged.put(entry.getKey(),mergedResults);
    }
 else {
      merged.put(entry.getKey(),entry.getValue());
    }
  }
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=merged.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test1","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final Iterator<Token> tokenIterator=tokenTree.iterator(KEY_CONVERTER);
  final Iterator<Map.Entry<Long,LongSet>> listIterator=simpleTokenMap.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),treeNext.get());
    Assert.assertEquals(convert(listNext.getValue()),convert(treeNext));
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerializedSize() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final File treeFile=File.createTempFile("token-tree-size-test","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  Assert.assertEquals((int)reader.bytesRemaining(),builder.serializedSize());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=tokens.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeIterateAndSkip() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test2","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final RangeIterator<Long,Token> treeIterator=tokenTree.iterator(KEY_CONVERTER);
  final RangeIterator<Long,TokenWithOffsets> listIterator=new EntrySetSkippableIterator(tokens);
  long lastToken=0L;
  while (treeIterator.hasNext() && lastToken < 12) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(lastToken=treeNext.get()));
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  treeIterator.skipTo(100548L);
  listIterator.skipTo(100548L);
  while (treeIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(long)treeNext.get());
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  Assert.assertFalse("Tree iterator not completed",treeIterator.hasNext());
  Assert.assertFalse("List iterator not completed",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeAndGet() throws Exception {
  final long tokMin=0;
  final long tokMax=1000;
  final TokenTree tokenTree=generateTree(tokMin,tokMax);
  for (long i=0; i <= tokMax; i++) {
    TokenTree.OnDiskToken result=tokenTree.get(i,KEY_CONVERTER);
    Assert.assertNotNull("failed to find object for token " + i,result);
    Set<Long> found=result.getOffsets();
    Assert.assertEquals(1,found.size());
    Assert.assertEquals(i,found.toArray()[0]);
  }
  Assert.assertNull("found missing object",tokenTree.get(tokMax + 10,KEY_CONVERTER));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.plan.OperationTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSatisfiedByWithMultipleTerms(){
  final ColumnDefinition comment=getColumn(UTF8Type.instance.decompose("comment"));
  Unfiltered row=buildRow(buildCell(comment,UTF8Type.instance.decompose("software engineer is working on a project"),System.currentTimeMillis()));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(comment,Operator.EQ,UTF8Type.instance.decompose("eng is a work")));
  Operation op=builder.complete();
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(comment,Operator.EQ,UTF8Type.instance.decompose("soft works fine")));
  op=builder.complete();
  Assert.assertTrue(op.satisfiedBy(row,false));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSatisfiedBy() throws Exception {
  final ColumnDefinition timestamp=getColumn(UTF8Type.instance.decompose("timestamp"));
  final ColumnDefinition age=getColumn(UTF8Type.instance.decompose("age"));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)));
  Operation op=builder.complete();
  Unfiltered row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(6)),new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(10)));
  op=builder.complete();
  Set<Integer> exclusions=Sets.newHashSet(0,1,5,6,11);
  for (int i=0; i <= 11; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(6)));
  op=builder.complete();
  exclusions=Sets.newHashSet(0,1,2,3,4,7,8,9,10);
  for (int i=0; i <= 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(0)));
  builder.add(new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10)));
  builder.add(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(7)));
  op=builder.complete();
  exclusions=Sets.newHashSet(7);
  for (int i=0; i < 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(timestamp,Operator.GTE,LongType.instance.decompose(10L)));
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(22L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(timestamp,Operator.GT,LongType.instance.decompose(10L)));
  builder.setRight(new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(0)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10))));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(20),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(0),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(30)));
  op=builder.complete();
  Assert.assertFalse(op.satisfiedBy(null,false));
  Assert.assertFalse(op.satisfiedBy(row,false));
  long now=System.currentTimeMillis();
  row=OperationTest.buildRow(Row.Deletion.regular(new DeletionTime(now - 10,(int)(now / 1000))),buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(deletedCell(age,System.currentTimeMillis(),FBUtilities.nowInSeconds()));
  Assert.assertFalse(op.satisfiedBy(row,true));
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),false));
  }
 catch (  IllegalStateException e) {
  }
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),true));
  }
 catch (  IllegalStateException e) {
    Assert.fail("IllegalStateException should not be thrown when missing column and allowMissingColumns=true");
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSatisfiedByWithClustering(){
  ColumnDefinition location=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("location"));
  ColumnDefinition age=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("age"));
  ColumnDefinition height=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("height"));
  ColumnDefinition score=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("score"));
  Unfiltered row=buildRow(Clustering.make(UTF8Type.instance.fromString("US"),Int32Type.instance.decompose(27)),buildCell(height,Int32Type.instance.decompose(182),System.currentTimeMillis()),buildCell(score,DoubleType.instance.decompose(1.0d),System.currentTimeMillis()));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(27)));
  builder.add(new SimpleExpression(height,Operator.EQ,Int32Type.instance.decompose(182)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(28)));
  builder.add(new SimpleExpression(height,Operator.EQ,Int32Type.instance.decompose(182)));
  Assert.assertFalse(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(27)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("BY")));
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(28)));
  Assert.assertFalse(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(27)));
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  builder.add(new SimpleExpression(score,Operator.EQ,DoubleType.instance.decompose(1.0d)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  builder.add(new SimpleExpression(score,Operator.EQ,DoubleType.instance.decompose(1.0d)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAnalyze() throws Exception {
  final ColumnDefinition firstName=getColumn(UTF8Type.instance.decompose("first_name"));
  final ColumnDefinition age=getColumn(UTF8Type.instance.decompose("age"));
  final ColumnDefinition comment=getColumn(UTF8Type.instance.decompose("comment"));
  Map<Expression.Op,Expression> expressions=convert(Operation.analyzeGroup(controller,OperationType.AND,Arrays.asList(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(6)),new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(10)))));
  Expression expected=new Expression("age",Int32Type.instance){
{
      operation=Op.RANGE;
      lower=new Bound(Int32Type.instance.decompose(1),false);
      upper=new Bound(Int32Type.instance.decompose(10),true);
      exclusions.add(Int32Type.instance.decompose(5));
      exclusions.add(Int32Type.instance.decompose(6));
    }
  }
;
  Assert.assertEquals(1,expressions.size());
  Assert.assertEquals(expected,expressions.get(Expression.Op.RANGE));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(7)))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("age",Int32Type.instance){
{
      operation=Op.NOT_EQ;
      lower=new Bound(Int32Type.instance.decompose(5),true);
      upper=lower;
    }
  }
,expressions.get(Expression.Op.NOT_EQ));
  Assert.assertEquals(new Expression("age",Int32Type.instance){
{
      operation=Op.RANGE;
      lower=new Bound(Int32Type.instance.decompose(7),true);
    }
  }
,expressions.get(Expression.Op.RANGE));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(7)))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("age",Int32Type.instance){
{
      operation=Op.RANGE;
      upper=new Bound(Int32Type.instance.decompose(7),false);
    }
  }
,expressions.get(Expression.Op.RANGE));
  Assert.assertEquals(new Expression("age",Int32Type.instance){
{
      operation=Op.NOT_EQ;
      lower=new Bound(Int32Type.instance.decompose(5),true);
      upper=lower;
    }
  }
,expressions.get(Expression.Op.NOT_EQ));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.AND,Arrays.asList(new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(7)))));
  Assert.assertEquals(1,expressions.size());
  Assert.assertEquals(new Expression("age",Int32Type.instance){
{
      operation=Op.RANGE;
      lower=new Bound(Int32Type.instance.decompose(1),false);
      upper=new Bound(Int32Type.instance.decompose(7),false);
    }
  }
,expressions.get(Expression.Op.RANGE));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),new SimpleExpression(firstName,Operator.NEQ,UTF8Type.instance.decompose("b")))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("first_name",UTF8Type.instance){
{
      operation=Op.NOT_EQ;
      lower=new Bound(UTF8Type.instance.decompose("b"),true);
      upper=lower;
    }
  }
,expressions.get(Expression.Op.NOT_EQ));
  Assert.assertEquals(new Expression("first_name",UTF8Type.instance){
{
      operation=Op.EQ;
      lower=upper=new Bound(UTF8Type.instance.decompose("a"),true);
    }
  }
,expressions.get(Expression.Op.EQ));
  ListMultimap<ColumnDefinition,Expression> e=Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(comment,Operator.EQ,UTF8Type.instance.decompose("soft eng")),new SimpleExpression(comment,Operator.NEQ,UTF8Type.instance.decompose("likes do"))));
  List<Expression> expectedExpressions=new ArrayList<Expression>(2){
{
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.EQ;
          lower=new Bound(UTF8Type.instance.decompose("soft"),true);
          upper=lower;
        }
      }
);
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.EQ;
          lower=new Bound(UTF8Type.instance.decompose("eng"),true);
          upper=lower;
        }
      }
);
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(UTF8Type.instance.decompose("likes"),true);
          upper=lower;
        }
      }
);
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(UTF8Type.instance.decompose("do"),true);
          upper=lower;
        }
      }
);
    }
  }
;
  Assert.assertEquals(expectedExpressions,e.get(comment));
  e=Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(comment,Operator.NEQ,UTF8Type.instance.decompose("likes do")),new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("j"))));
  expectedExpressions=new ArrayList<Expression>(2){
{
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(UTF8Type.instance.decompose("likes"),true);
          upper=lower;
        }
      }
);
      add(new Expression("comment",UTF8Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(UTF8Type.instance.decompose("do"),true);
          upper=lower;
        }
      }
);
    }
  }
;
  Assert.assertEquals(expectedExpressions,e.get(comment));
  e=Operation.analyzeGroup(controller,OperationType.OR,Arrays.asList(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(27)),new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("j")),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(25))));
  expectedExpressions=new ArrayList<Expression>(2){
{
      add(new Expression("age",Int32Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(Int32Type.instance.decompose(27),true);
          upper=lower;
        }
      }
);
      add(new Expression("age",Int32Type.instance){
{
          operation=Op.NOT_EQ;
          lower=new Bound(Int32Type.instance.decompose(25),true);
          upper=lower;
        }
      }
);
    }
  }
;
  Assert.assertEquals(expectedExpressions,e.get(age));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAnalyzeNotIndexedButDefinedColumn() throws Exception {
  final ColumnDefinition firstName=getColumn(UTF8Type.instance.decompose("first_name"));
  final ColumnDefinition height=getColumn(UTF8Type.instance.decompose("height"));
  Map<Expression.Op,Expression> expressions;
  expressions=convert(Operation.analyzeGroup(controller,OperationType.AND,Arrays.asList(new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),new SimpleExpression(height,Operator.NEQ,Int32Type.instance.decompose(5)))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("height",Int32Type.instance){
{
      operation=Op.NOT_EQ;
      lower=new Bound(Int32Type.instance.decompose(5),true);
      upper=lower;
    }
  }
,expressions.get(Expression.Op.NOT_EQ));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.AND,Arrays.asList(new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),new SimpleExpression(height,Operator.GT,Int32Type.instance.decompose(0)),new SimpleExpression(height,Operator.NEQ,Int32Type.instance.decompose(5)))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("height",Int32Type.instance){
{
      operation=Op.RANGE;
      lower=new Bound(Int32Type.instance.decompose(0),false);
      exclusions.add(Int32Type.instance.decompose(5));
    }
  }
,expressions.get(Expression.Op.RANGE));
  expressions=convert(Operation.analyzeGroup(controller,OperationType.AND,Arrays.asList(new SimpleExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),new SimpleExpression(height,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(0)),new SimpleExpression(height,Operator.LT,Int32Type.instance.decompose(10)))));
  Assert.assertEquals(2,expressions.size());
  Assert.assertEquals(new Expression("height",Int32Type.instance){
{
      operation=Op.RANGE;
      lower=new Bound(Int32Type.instance.decompose(0),true);
      upper=new Bound(Int32Type.instance.decompose(10),false);
      exclusions.add(Int32Type.instance.decompose(5));
    }
  }
,expressions.get(Expression.Op.RANGE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.MappedBufferTest </h4><pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSequentialIterationWithPadding() throws Exception {
  long numValues=1000;
  int maxPageBits=6;
  int[] paddings=new int[]{0,3,5,7,9,11,13};
  for (int numPageBits=3; numPageBits <= maxPageBits; numPageBits++) {
    for (int typeSize=2; typeSize <= 8; typeSize*=2) {
      for (      int padding : paddings) {
        try (MappedBuffer buffer=createTestFile(numValues,typeSize,numPageBits,padding)){
          long offset=0;
          for (long j=0; j < numValues; j++) {
switch (typeSize) {
case 2:
              Assert.assertEquals(j,buffer.getShort(offset));
            break;
case 4:
          Assert.assertEquals(j,buffer.getInt(offset));
        break;
case 8:
      Assert.assertEquals(j,buffer.getLong(offset));
    break;
default :
  throw new AssertionError();
}
offset+=typeSize + padding;
}
}
 }
}
}
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSequentialIteration() throws IOException {
  long numValues=1000;
  for (int typeSize=2; typeSize <= 8; typeSize*=2) {
    try (MappedBuffer buffer=createTestFile(numValues,typeSize,16,0)){
      for (int j=0; j < numValues; j++) {
        Assert.assertEquals(j * typeSize,buffer.position());
switch (typeSize) {
case 2:
          Assert.assertEquals(j,buffer.getShort());
        break;
case 4:
      Assert.assertEquals(j,buffer.getInt());
    break;
case 8:
  Assert.assertEquals(j,buffer.getLong());
break;
default :
throw new AssertionError();
}
}
}
 }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompareToPage() throws IOException {
  long numValues=100;
  int typeSize=8;
  try (MappedBuffer buffer=createTestFile(numValues)){
    for (long i=0; i < numValues * typeSize; i+=typeSize) {
      long value=i / typeSize;
      Assert.assertEquals(0,buffer.comparePageTo(i,typeSize,LongType.instance,LongType.instance.decompose(value)));
    }
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDuplicate() throws Exception {
  long numLongs=10;
  final MappedBuffer buffer1=createTestFile(numLongs);
  Assert.assertEquals(0,buffer1.getLong());
  Assert.assertEquals(1,buffer1.getLong());
  final MappedBuffer buffer2=buffer1.duplicate();
  Assert.assertEquals(2,buffer1.getLong());
  Assert.assertEquals(2,buffer2.getLong());
  buffer2.position(0);
  Assert.assertEquals(3,buffer1.getLong());
  Assert.assertEquals(0,buffer2.getLong());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPageRegion() throws Exception {
  ThreadLocalRandom random=ThreadLocalRandom.current();
  int numLongs=1000;
  int byteSize=8;
  int capacity=numLongs * byteSize;
  try (MappedBuffer buffer=createTestFile(numLongs)){
    for (int i=0; i < 1000; i++) {
      int offset=random.nextInt(0,1000 * byteSize - byteSize) & ~(byteSize - 1);
      int length=Math.min(capacity,random.nextInt(byteSize,capacity - offset) & ~(byteSize - 1));
      ByteBuffer region=buffer.getPageRegion(offset,length);
      for (int j=offset; j < (offset + length); j+=8)       Assert.assertEquals(j / 8,region.getLong(j));
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicWriteThenRead() throws Exception {
  long numLongs=10000;
  final MappedBuffer buffer=createTestFile(numLongs);
  Assert.assertEquals(0,buffer.position());
  for (long i=0; i < numLongs; i++) {
    Assert.assertEquals(i * 8,buffer.position());
    Assert.assertEquals(i,buffer.getLong());
  }
  buffer.position(0);
  for (long i=0; i < numLongs; i++) {
    Assert.assertEquals(i,buffer.getLong(i * 8));
    Assert.assertEquals(0,buffer.position());
  }
  for (long i=0; i < Math.min(Integer.MAX_VALUE,numLongs); i++)   Assert.assertEquals(i,buffer.getInt((i * 8) + 4));
  for (long i=0; i < Math.min(Short.MAX_VALUE,numLongs); i++) {
    Assert.assertEquals(i,buffer.getShort((i * 8) + 6));
  }
  for (long i=0; i < 128; i++)   Assert.assertEquals(i,buffer.get((i * 8) + 7));
  buffer.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOpenWithoutPageBits() throws IOException {
  File tmp=File.createTempFile("mapped-buffer","tmp");
  tmp.deleteOnExit();
  RandomAccessFile file=new RandomAccessFile(tmp,"rw");
  long numValues=1000;
  for (long i=0; i < numValues; i++)   file.writeLong(i);
  file.getFD().sync();
  try (MappedBuffer buffer=new MappedBuffer(new ChannelProxy(tmp.getAbsolutePath(),file.getChannel()))){
    Assert.assertEquals(numValues * 8,buffer.limit());
    Assert.assertEquals(numValues * 8,buffer.capacity());
    for (long i=0; i < numValues; i++) {
      Assert.assertEquals(i * 8,buffer.position());
      Assert.assertEquals(i,buffer.getLong());
    }
  }
  finally {
    FileUtils.closeQuietly(file);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.RangeUnionIteratorTest </h4><pre class="type-6 type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSequences(){
  ThreadLocalRandom random=ThreadLocalRandom.current();
  long[][] values=new long[random.nextInt(1,20)][];
  int numTests=random.nextInt(10,20);
  for (int tests=0; tests < numTests; tests++) {
    RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
    int totalCount=0;
    for (int i=0; i < values.length; i++) {
      long[] part=new long[random.nextInt(1,500)];
      for (int j=0; j < part.length; j++)       part[j]=random.nextLong();
      Arrays.sort(part);
      values[i]=part;
      builder.add(new LongIterator(part));
      totalCount+=part.length;
    }
    long[] totalOrdering=new long[totalCount];
    int index=0;
    for (    long[] part : values) {
      for (      long value : part)       totalOrdering[index++]=value;
    }
    Arrays.sort(totalOrdering);
    int count=0;
    RangeIterator<Long,Token> tokens=builder.build();
    Assert.assertNotNull(tokens);
    while (tokens.hasNext())     Assert.assertEquals(totalOrdering[count++],(long)tokens.next().get());
    Assert.assertEquals(totalCount,count);
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuilder(){
  RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
  Assert.assertNull(builder.getMinimum());
  Assert.assertNull(builder.getMaximum());
  Assert.assertEquals(0L,builder.getTokenCount());
  Assert.assertEquals(0L,builder.rangeCount());
  builder.add(new LongIterator(new long[]{1L,2L,3L}));
  builder.add(new LongIterator(new long[]{4L,5L,6L}));
  builder.add(new LongIterator(new long[]{7L,8L,9L}));
  Assert.assertEquals(1L,(long)builder.getMinimum());
  Assert.assertEquals(9L,(long)builder.getMaximum());
  Assert.assertEquals(9L,builder.getTokenCount());
  Assert.assertEquals(3L,builder.rangeCount());
  Assert.assertFalse(builder.statistics.isDisjoint());
  Assert.assertEquals(1L,(long)builder.ranges.poll().getMinimum());
  Assert.assertEquals(4L,(long)builder.ranges.poll().getMinimum());
  Assert.assertEquals(7L,(long)builder.ranges.poll().getMinimum());
  RangeIterator<Long,Token> tokens=RangeUnionIterator.build(new ArrayList<RangeIterator<Long,Token>>(){
{
      add(new LongIterator(new long[]{1L,2L,4L}));
      add(new LongIterator(new long[]{3L,5L,6L}));
    }
  }
);
  Assert.assertEquals(convert(1L,2L,3L,4L,5L,6L),convert(tokens));
  FileUtils.closeQuietly(tokens);
  RangeIterator emptyTokens=RangeUnionIterator.builder().build();
  Assert.assertNull(emptyTokens);
  builder=RangeUnionIterator.builder();
  Assert.assertEquals(0L,builder.add((RangeIterator<Long,Token>)null).rangeCount());
  Assert.assertEquals(0L,builder.add((List<RangeIterator<Long,Token>>)null).getTokenCount());
  Assert.assertEquals(0L,builder.add(new LongIterator(new long[]{})).rangeCount());
  RangeIterator<Long,Token> single=new LongIterator(new long[]{1L,2L,3L});
  RangeIterator<Long,Token> range=RangeIntersectionIterator.<Long,Token>builder().add(single).build();
  Assert.assertEquals(range,single);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressedRandomAccessReaderTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test6791() throws IOException, ConfigurationException {
  File f=File.createTempFile("compressed6791_","3");
  String filename=f.getAbsolutePath();
  try (ChannelProxy channel=new ChannelProxy(f)){
    MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance));
    try (CompressedSequentialWriter writer=new CompressedSequentialWriter(f,filename + ".metadata",CompressionParams.snappy(32),sstableMetadataCollector)){
      for (int i=0; i < 20; i++)       writer.write("x".getBytes());
      FileMark mark=writer.mark();
      for (int i=0; i < 40; ++i)       writer.write("y".getBytes());
      writer.resetAndTruncate(mark);
      for (int i=0; i < 20; i++)       writer.write("x".getBytes());
      writer.finish();
    }
     try (RandomAccessReader reader=new CompressedRandomAccessReader.Builder(channel,new CompressionMetadata(filename + ".metadata",f.length(),ChecksumType.CRC32)).build()){
      String res=reader.readLine();
      assertEquals(res,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
      assertEquals(40,res.length());
    }
   }
  finally {
    if (f.exists())     assertTrue(f.delete());
    File metadata=new File(filename + ".metadata");
    if (metadata.exists())     metadata.delete();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-14 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataCorruptionDetection() throws IOException {
  String CONTENT="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vitae.";
  File file=new File("testDataCorruptionDetection");
  file.deleteOnExit();
  File metadata=new File(file.getPath() + ".meta");
  metadata.deleteOnExit();
  assertTrue(file.createNewFile());
  assertTrue(metadata.createNewFile());
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(file,metadata.getPath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(CONTENT.getBytes());
    writer.finish();
  }
   try (ChannelProxy channel=new ChannelProxy(file)){
    CompressionMetadata meta=new CompressionMetadata(metadata.getPath(),file.length(),ChecksumType.CRC32);
    CompressionMetadata.Chunk chunk=meta.chunkFor(0);
    try (RandomAccessReader reader=new CompressedRandomAccessReader.Builder(channel,meta).build()){
      assertEquals(CONTENT,reader.readLine());
      Random random=new Random();
      RandomAccessFile checksumModifier=null;
      try {
        checksumModifier=new RandomAccessFile(file,"rw");
        byte[] checksum=new byte[4];
        checksumModifier.seek(chunk.length);
        checksumModifier.read(checksum);
        checksumModifier.seek(chunk.length);
        for (int i=0; i < checksum.length; i++) {
          checksumModifier.write(random.nextInt());
          SyncUtil.sync(checksumModifier);
          try (final RandomAccessReader r=new CompressedRandomAccessReader.Builder(channel,meta).build()){
            Throwable exception=null;
            try {
              r.readLine();
            }
 catch (            Throwable t) {
              exception=t;
            }
            assertNotNull(exception);
            assertSame(exception.getClass(),CorruptSSTableException.class);
            assertSame(exception.getCause().getClass(),CorruptBlockException.class);
          }
         }
        updateChecksum(checksumModifier,chunk.length,checksum);
        try (RandomAccessReader cr=new CompressedRandomAccessReader.Builder(channel,meta).build()){
          assertEquals(CONTENT,cr.readLine());
        }
       }
  finally {
        if (checksumModifier != null)         checksumModifier.close();
      }
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.CQLSSTableWriterClientTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriterInClientMode() throws IOException, InvalidRequestException {
  final String TABLE1="table1";
  final String TABLE2="table2";
  String schema="CREATE TABLE client_test.%s (" + "  k int PRIMARY KEY," + "  v1 text,"+ "  v2 int"+ ")";
  String insert="INSERT INTO client_test.%s (k, v1, v2) VALUES (?, ?, ?)";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(this.testDirectory).forTable(String.format(schema,TABLE1)).using(String.format(insert,TABLE1)).build();
  CQLSSTableWriter writer2=CQLSSTableWriter.builder().inDirectory(this.testDirectory).forTable(String.format(schema,TABLE2)).using(String.format(insert,TABLE2)).build();
  writer.addRow(0,"A",0);
  writer2.addRow(0,"A",0);
  writer.addRow(1,"B",1);
  writer2.addRow(1,"B",1);
  writer.close();
  writer2.close();
  FilenameFilter filter=new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      return name.endsWith("-Data.db");
    }
  }
;
  File[] dataFiles=this.testDirectory.listFiles(filter);
  assertEquals(2,dataFiles.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.CQLSSTableWriterTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnsortedWriter() throws Exception {
  try (AutoCloseable switcher=Util.switchPartitioner(ByteOrderedPartitioner.instance)){
    String KS="cql_keyspace";
    String TABLE="table1";
    File tempdir=Files.createTempDir();
    File dataDir=new File(tempdir.getAbsolutePath() + File.separator + KS+ File.separator+ TABLE);
    assert dataDir.mkdirs();
    String schema="CREATE TABLE cql_keyspace.table1 (" + "  k int PRIMARY KEY," + "  v1 text,"+ "  v2 int"+ ")";
    String insert="INSERT INTO cql_keyspace.table1 (k, v1, v2) VALUES (?, ?, ?)";
    CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(schema).using(insert).build();
    writer.addRow(0,"test1",24);
    writer.addRow(1,"test2",44);
    writer.addRow(2,"test3",42);
    writer.addRow(ImmutableMap.<String,Object>of("k",3,"v2",12));
    writer.close();
    SSTableLoader loader=new SSTableLoader(dataDir,new SSTableLoader.Client(){
      private String keyspace;
      public void init(      String keyspace){
        this.keyspace=keyspace;
        for (        Range<Token> range : StorageService.instance.getLocalRanges("cql_keyspace"))         addRangeForEndpoint(range,FBUtilities.getBroadcastAddress());
      }
      public CFMetaData getTableMetadata(      String cfName){
        return Schema.instance.getCFMetaData(keyspace,cfName);
      }
    }
,new OutputHandler.SystemOutput(false,false));
    loader.stream().get();
    UntypedResultSet rs=QueryProcessor.executeInternal("SELECT * FROM cql_keyspace.table1;");
    assertEquals(4,rs.size());
    Iterator<UntypedResultSet.Row> iter=rs.iterator();
    UntypedResultSet.Row row;
    row=iter.next();
    assertEquals(0,row.getInt("k"));
    assertEquals("test1",row.getString("v1"));
    assertEquals(24,row.getInt("v2"));
    row=iter.next();
    assertEquals(1,row.getInt("k"));
    assertEquals("test2",row.getString("v1"));
    assertEquals(44,row.getInt("v2"));
    row=iter.next();
    assertEquals(2,row.getInt("k"));
    assertEquals("test3",row.getString("v1"));
    assertEquals(42,row.getInt("v2"));
    row=iter.next();
    assertEquals(3,row.getInt("k"));
    assertEquals(null,row.getBytes("v1"));
    assertEquals(12,row.getInt("v2"));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.IndexSummaryManagerTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testRedistributeSummaries() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  int numSSTables=4;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  int minSamplingLevel=(BASE_SAMPLING_LEVEL * cfs.metadata.params.minIndexInterval) / cfs.metadata.params.maxIndexInterval;
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  long singleSummaryOffHeapSpace=sstables.get(0).getIndexSummaryOffHeapSize();
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * numSSTables));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL,sstable.getIndexSummarySamplingLevel());
  assertEquals(singleSummaryOffHeapSpace * numSSTables,totalOffHeapSize(sstables));
  validateData(cfs,numRows);
  assert sstables.size() == 4;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 2)));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 2,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 4)));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 4,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 2) + 4));
  }
   assert sstables.size() == 4;
  for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 2,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * numSSTables));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables.get(0).overrideReadMeter(new RestorableMeter(50.0,50.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(50.0,50.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(1).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  double lowerRate=50.0 * (DOWNSAMPLE_THESHOLD + (DOWNSAMPLE_THESHOLD * 0.10));
  double higherRate=50.0 * (UPSAMPLE_THRESHOLD - (UPSAMPLE_THRESHOLD * 0.10));
  sstables.get(0).overrideReadMeter(new RestorableMeter(lowerRate,lowerRate));
  sstables.get(1).overrideReadMeter(new RestorableMeter(higherRate,higherRate));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(1).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables=resetSummaries(cfs,sstables,singleSummaryOffHeapSpace);
  sstables.get(0).overrideReadMeter(new RestorableMeter(1.0,1.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(2.0,2.0));
  sstables.get(2).overrideReadMeter(new RestorableMeter(1000.0,1000.0));
  sstables.get(3).overrideReadMeter(new RestorableMeter(1000.0,1000.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3) + 50);
  }
   Collections.sort(sstables,hotnessComparator);
  if (sstables.get(0).getIndexSummarySamplingLevel() == minSamplingLevel)   assertEquals(BASE_SAMPLING_LEVEL,sstables.get(1).getIndexSummarySamplingLevel());
 else   assertEquals(BASE_SAMPLING_LEVEL,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables.get(0).overrideReadMeter(new RestorableMeter(0.0,0.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(0.0,0.0));
  sstables.get(2).overrideReadMeter(new RestorableMeter(92,92));
  sstables.get(3).overrideReadMeter(new RestorableMeter(128.0,128.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(long)(singleSummaryOffHeapSpace + (singleSummaryOffHeapSpace * (92.0 / BASE_SAMPLING_LEVEL))));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(1,sstables.get(0).getIndexSummarySize());
  assertEquals(1,sstables.get(0).getIndexSummarySize());
  assertTrue(sstables.get(2).getIndexSummarySamplingLevel() > minSamplingLevel);
  assertTrue(sstables.get(2).getIndexSummarySamplingLevel() < BASE_SAMPLING_LEVEL);
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),10);
  }
   for (  SSTableReader sstable : sstables)   assertEquals(1,sstable.getIndexSummarySize());
  validateData(cfs,numRows);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJMXFunctions() throws IOException {
  IndexSummaryManager manager=IndexSummaryManager.instance;
  manager.setResizeIntervalInMinutes(-1);
  assertNull(manager.getTimeToNextResize(TimeUnit.MINUTES));
  manager.setResizeIntervalInMinutes(10);
  assertEquals(10,manager.getResizeIntervalInMinutes());
  assertEquals(10,manager.getTimeToNextResize(TimeUnit.MINUTES),1);
  manager.setResizeIntervalInMinutes(15);
  assertEquals(15,manager.getResizeIntervalInMinutes());
  assertEquals(15,manager.getTimeToNextResize(TimeUnit.MINUTES),2);
  assertTrue(manager.getMemoryPoolCapacityInMB() >= 0);
  manager.setMemoryPoolCapacityInMB(10);
  assertEquals(10,manager.getMemoryPoolCapacityInMB());
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=2;
  int numRows=10;
  for (int sstable=0; sstable < numSSTables; sstable++) {
    for (int row=0; row < numRows; row++) {
      String key=String.format("%3d",row);
      new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
    }
    cfs.forceBlockingFlush();
  }
  assertTrue(manager.getAverageIndexInterval() >= cfs.metadata.params.minIndexInterval);
  Map<String,Integer> intervals=manager.getIndexIntervals();
  for (  Map.Entry<String,Integer> entry : intervals.entrySet())   if (entry.getKey().contains(CF_STANDARDLOWiINTERVAL))   assertEquals(cfs.metadata.params.minIndexInterval,entry.getValue(),0.001);
  manager.setMemoryPoolCapacityInMB(0);
  manager.redistributeSummaries();
  assertTrue(manager.getAverageIndexInterval() > cfs.metadata.params.minIndexInterval);
  intervals=manager.getIndexIntervals();
  for (  Map.Entry<String,Integer> entry : intervals.entrySet()) {
    if (entry.getKey().contains(CF_STANDARDLOWiINTERVAL))     assertTrue(entry.getValue() >= cfs.metadata.params.minIndexInterval);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChangeMaxIndexInterval() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  int numSSTables=1;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),10);
  }
   sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   assertEquals(cfs.metadata.params.maxIndexInterval,sstable.getEffectiveIndexInterval(),0.01);
  cfs.metadata.maxIndexInterval(cfs.metadata.params.maxIndexInterval / 2);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),1);
  }
   sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables) {
    assertEquals(cfs.metadata.params.maxIndexInterval,sstable.getEffectiveIndexInterval(),0.01);
    assertEquals(numRows / cfs.metadata.params.maxIndexInterval,sstable.getIndexSummarySize());
  }
  cfs.metadata.maxIndexInterval(cfs.metadata.params.maxIndexInterval * 2);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),1);
  }
   for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    assertEquals(cfs.metadata.params.maxIndexInterval,sstable.getEffectiveIndexInterval(),0.01);
    assertEquals(numRows / cfs.metadata.params.maxIndexInterval,sstable.getIndexSummarySize());
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRebuildAtSamplingLevel() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numRows=256;
  for (int row=0; row < numRows; row++) {
    String key=String.format("%3d",row);
    new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  SSTableReader original=sstables.get(0);
  SSTableReader sstable=original;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    for (int samplingLevel=1; samplingLevel < BASE_SAMPLING_LEVEL; samplingLevel++) {
      sstable=sstable.cloneWithNewSummarySamplingLevel(cfs,samplingLevel);
      assertEquals(samplingLevel,sstable.getIndexSummarySamplingLevel());
      int expectedSize=(numRows * samplingLevel) / (sstable.metadata.params.minIndexInterval * BASE_SAMPLING_LEVEL);
      assertEquals(expectedSize,sstable.getIndexSummarySize(),1);
      txn.update(sstable,true);
      txn.checkpoint();
    }
    txn.finish();
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCancelIndex() throws Exception {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  final ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  final int numSSTables=4;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  final List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  final long singleSummaryOffHeapSpace=sstables.get(0).getIndexSummaryOffHeapSize();
  final AtomicReference<CompactionInterruptedException> exception=new AtomicReference<>();
  Thread t=new Thread(new Runnable(){
    public void run(){
      try {
        try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
          redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),singleSummaryOffHeapSpace);
        }
       }
 catch (      CompactionInterruptedException ex) {
        exception.set(ex);
      }
catch (      IOException ignored) {
      }
    }
  }
);
  t.start();
  while (CompactionManager.instance.getActiveCompactions() == 0 && t.isAlive())   Thread.sleep(1);
  CompactionManager.instance.stopCompaction("INDEX_SUMMARY");
  t.join();
  assertNotNull("Expected compaction interrupted exception",exception.get());
  assertTrue("Expected no active compactions",CompactionMetrics.getCompactions().isEmpty());
  Set<SSTableReader> beforeRedistributionSSTables=new HashSet<>(sstables);
  Set<SSTableReader> afterCancelSSTables=new HashSet<>(cfs.getLiveSSTables());
  Set<SSTableReader> disjoint=Sets.symmetricDifference(beforeRedistributionSSTables,afterCancelSSTables);
  assertTrue(String.format("Mismatched files before and after cancelling redistribution: %s",Joiner.on(",").join(disjoint)),disjoint.isEmpty());
  validateData(cfs,numRows);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChangeMinIndexInterval() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  int numSSTables=1;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  for (  SSTableReader sstable : sstables)   assertEquals(cfs.metadata.params.minIndexInterval,sstable.getEffectiveIndexInterval(),0.001);
  cfs.metadata.minIndexInterval(originalMinIndexInterval * 2);
  IndexSummaryManager.instance.redistributeSummaries();
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    assertEquals(cfs.metadata.params.minIndexInterval,sstable.getEffectiveIndexInterval(),0.001);
    assertEquals(numRows / cfs.metadata.params.minIndexInterval,sstable.getIndexSummarySize());
  }
  cfs.metadata.minIndexInterval(originalMinIndexInterval);
  IndexSummaryManager.instance.redistributeSummaries();
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    assertEquals(cfs.metadata.params.minIndexInterval,sstable.getEffectiveIndexInterval(),0.001);
    assertEquals(numRows / cfs.metadata.params.minIndexInterval,sstable.getIndexSummarySize());
  }
  cfs.metadata.minIndexInterval(originalMinIndexInterval / 2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  long summarySpace=sstable.getIndexSummaryOffHeapSize();
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),summarySpace);
  }
   sstable=cfs.getLiveSSTables().iterator().next();
  assertEquals(originalMinIndexInterval,sstable.getEffectiveIndexInterval(),0.001);
  assertEquals(numRows / originalMinIndexInterval,sstable.getIndexSummarySize());
  double previousInterval=sstable.getEffectiveIndexInterval();
  int previousSize=sstable.getIndexSummarySize();
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(long)Math.ceil(summarySpace * 1.5));
  }
   sstable=cfs.getLiveSSTables().iterator().next();
  assertEquals(previousSize * 1.5,(double)sstable.getIndexSummarySize(),1);
  assertEquals(previousInterval * (1.0 / 1.5),sstable.getEffectiveIndexInterval(),0.001);
  cfs.metadata.minIndexInterval(originalMinIndexInterval);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(long)Math.ceil(summarySpace / 2.0));
  }
   sstable=cfs.getLiveSSTables().iterator().next();
  assertEquals(originalMinIndexInterval * 2,sstable.getEffectiveIndexInterval(),0.001);
  assertEquals(numRows / (originalMinIndexInterval * 2),sstable.getIndexSummarySize());
  cfs.metadata.minIndexInterval(originalMinIndexInterval * 4);
  cfs.metadata.maxIndexInterval(originalMinIndexInterval * 4);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),10);
  }
   sstable=cfs.getLiveSSTables().iterator().next();
  assertEquals(cfs.metadata.params.minIndexInterval,sstable.getEffectiveIndexInterval(),0.001);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.IndexSummaryTest </h4><pre class="type-6 type-7 type-13 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDownsample(){
  final int NUM_KEYS=4096;
  final int INDEX_INTERVAL=128;
  final int ORIGINAL_NUM_ENTRIES=NUM_KEYS / INDEX_INTERVAL;
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(NUM_KEYS,INDEX_INTERVAL);
  List<DecoratedKey> keys=random.left;
  IndexSummary original=random.right;
  for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++)   assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(original.getKey(i)));
  List<Integer> samplePattern=Downsampling.getSamplingPattern(BASE_SAMPLING_LEVEL);
  int downsamplingRound=1;
  for (int samplingLevel=BASE_SAMPLING_LEVEL - 1; samplingLevel >= 1; samplingLevel--) {
    try (IndexSummary downsampled=downsample(original,samplingLevel,128,partitioner)){
      assertEquals(entriesAtSamplingLevel(samplingLevel,original.getMaxNumberOfEntries()),downsampled.size());
      int sampledCount=0;
      List<Integer> skipStartPoints=samplePattern.subList(0,downsamplingRound);
      for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++) {
        if (!shouldSkip(i,skipStartPoints)) {
          assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(downsampled.getKey(sampledCount)));
          sampledCount++;
        }
      }
      testPosition(original,downsampled,keys);
      downsamplingRound++;
    }
   }
  IndexSummary previous=original;
  downsamplingRound=1;
  for (int downsampleLevel=BASE_SAMPLING_LEVEL - 1; downsampleLevel >= 1; downsampleLevel--) {
    IndexSummary downsampled=downsample(previous,downsampleLevel,128,partitioner);
    if (previous != original)     previous.close();
    assertEquals(entriesAtSamplingLevel(downsampleLevel,original.getMaxNumberOfEntries()),downsampled.size());
    int sampledCount=0;
    List<Integer> skipStartPoints=samplePattern.subList(0,downsamplingRound);
    for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++) {
      if (!shouldSkip(i,skipStartPoints)) {
        assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(downsampled.getKey(sampledCount)));
        sampledCount++;
      }
    }
    testPosition(original,downsampled,keys);
    previous=downsampled;
    downsamplingRound++;
  }
  previous.close();
  original.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddEmptyKey() throws Exception {
  IPartitioner p=new RandomPartitioner();
  try (IndexSummaryBuilder builder=new IndexSummaryBuilder(1,1,BASE_SAMPLING_LEVEL)){
    builder.maybeAddEntry(p.decorateKey(ByteBufferUtil.EMPTY_BYTE_BUFFER),0);
    IndexSummary summary=builder.build(p);
    assertEquals(1,summary.size());
    assertEquals(0,summary.getPosition(0));
    assertArrayEquals(new byte[0],summary.getKey(0));
    DataOutputBuffer dos=new DataOutputBuffer();
    IndexSummary.serializer.serialize(summary,dos,false);
    DataInputStream dis=new DataInputStream(new ByteArrayInputStream(dos.toByteArray()));
    IndexSummary loaded=IndexSummary.serializer.deserialize(dis,p,false,1,1);
    assertEquals(1,loaded.size());
    assertEquals(summary.getPosition(0),loaded.getPosition(0));
    assertArrayEquals(summary.getKey(0),summary.getKey(0));
    summary.close();
    loaded.close();
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization() throws IOException {
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(100,1);
  DataOutputBuffer dos=new DataOutputBuffer();
  IndexSummary.serializer.serialize(random.right,dos,false);
  dos.writeUTF("JUNK");
  dos.writeUTF("JUNK");
  FileUtils.closeQuietly(dos);
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(dos.toByteArray()));
  IndexSummary is=IndexSummary.serializer.deserialize(dis,partitioner,false,1,1);
  for (int i=0; i < 100; i++)   assertEquals(i,is.binarySearch(random.left.get(i)));
  assertEquals(dis.readUTF(),"JUNK");
  assertEquals(dis.readUTF(),"JUNK");
  is.close();
  FileUtils.closeQuietly(dis);
  random.right.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableLoaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadingIncompleteSSTable() throws Exception {
  File dataDir=new File(tmpdir.getAbsolutePath() + File.separator + KEYSPACE1+ File.separator+ CF_STANDARD2);
  assert dataDir.mkdirs();
  assertTrue(dataDir.listFiles().length == 0);
  String schema="CREATE TABLE %s.%s (key ascii, name ascii, val ascii, val1 ascii, PRIMARY KEY (key, name))";
  String query="INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(String.format(schema,KEYSPACE1,CF_STANDARD2)).using(String.format(query,KEYSPACE1,CF_STANDARD2)).withBufferSizeInMB(1).build();
  int NB_PARTITIONS=5000;
  for (int i=0; i < NB_PARTITIONS; i++) {
    for (int j=0; j < 100; j++)     writer.addRow(String.format("key%d",i),String.format("col%d",j),"100");
  }
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2);
  cfs.forceBlockingFlush();
  assertTrue(dataDir.listFiles().length > 0);
  final CountDownLatch latch=new CountDownLatch(2);
  SSTableLoader loader=new SSTableLoader(dataDir,new TestClient(),new OutputHandler.SystemOutput(false,false));
  loader.stream(Collections.emptySet(),completionStreamListener(latch)).get();
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).build());
  assertTrue(partitions.size() > 0 && partitions.size() < NB_PARTITIONS);
  writer.close();
  loader=new SSTableLoader(dataDir,new TestClient(),new OutputHandler.SystemOutput(false,false));
  loader.stream(Collections.emptySet(),completionStreamListener(latch)).get();
  partitions=Util.getAll(Util.cmd(Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2)).build());
  assertEquals(NB_PARTITIONS,partitions.size());
  latch.await();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoadingSSTable() throws Exception {
  File dataDir=new File(tmpdir.getAbsolutePath() + File.separator + KEYSPACE1+ File.separator+ CF_STANDARD1);
  assert dataDir.mkdirs();
  CFMetaData cfmeta=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD1);
  String schema="CREATE TABLE %s.%s (key ascii, name ascii, val ascii, val1 ascii, PRIMARY KEY (key, name))";
  String query="INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)";
  try (CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(String.format(schema,KEYSPACE1,CF_STANDARD1)).using(String.format(query,KEYSPACE1,CF_STANDARD1)).build()){
    writer.addRow("key1","col1","100");
  }
   ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD1);
  cfs.forceBlockingFlush();
  final CountDownLatch latch=new CountDownLatch(1);
  SSTableLoader loader=new SSTableLoader(dataDir,new TestClient(),new OutputHandler.SystemOutput(false,false));
  loader.stream(Collections.emptySet(),completionStreamListener(latch)).get();
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).build());
  assertEquals(1,partitions.size());
  assertEquals("key1",AsciiType.instance.getString(partitions.get(0).partitionKey().getKey()));
  assertEquals(ByteBufferUtil.bytes("100"),partitions.get(0).getRow(Clustering.make(ByteBufferUtil.bytes("col1"))).getCell(cfmeta.getColumnDefinition(ByteBufferUtil.bytes("val"))).value());
  latch.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableMetadataTest </h4><pre class="type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTrackMaxDeletionTime(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  long timestamp=System.currentTimeMillis();
  for (int i=0; i < 10; i++) {
    DecoratedKey key=Util.dk(Integer.toString(i));
    for (int j=0; j < 10; j++)     new RowUpdateBuilder(store.metadata,timestamp,10 + j,Integer.toString(i)).clustering(Integer.toString(j)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  new RowUpdateBuilder(store.metadata,timestamp,10000,"longttl").clustering("col").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  int ttltimestamp=(int)(System.currentTimeMillis() / 1000);
  int firstDelTime=0;
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    firstDelTime=sstable.getSSTableMetadata().maxLocalDeletionTime;
    assertEquals(ttltimestamp + 10000,firstDelTime,10);
  }
  new RowUpdateBuilder(store.metadata,timestamp,20000,"longttl2").clustering("col").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  ttltimestamp=(int)(System.currentTimeMillis() / 1000);
  store.forceBlockingFlush();
  assertEquals(2,store.getLiveSSTables().size());
  List<SSTableReader> sstables=new ArrayList<>(store.getLiveSSTables());
  if (sstables.get(0).getSSTableMetadata().maxLocalDeletionTime < sstables.get(1).getSSTableMetadata().maxLocalDeletionTime) {
    assertEquals(sstables.get(0).getSSTableMetadata().maxLocalDeletionTime,firstDelTime);
    assertEquals(sstables.get(1).getSSTableMetadata().maxLocalDeletionTime,ttltimestamp + 20000,10);
  }
 else {
    assertEquals(sstables.get(1).getSSTableMetadata().maxLocalDeletionTime,firstDelTime);
    assertEquals(sstables.get(0).getSSTableMetadata().maxLocalDeletionTime,ttltimestamp + 20000,10);
  }
  Util.compact(store,store.getLiveSSTables());
  assertEquals(1,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertEquals(sstable.getSSTableMetadata().maxLocalDeletionTime,ttltimestamp + 20000,10);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void trackMaxMinColNames() throws CharacterCodingException, ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard3");
  for (int j=0; j < 8; j++) {
    String key="row" + j;
    for (int i=100; i < 150; i++) {
      new RowUpdateBuilder(store.metadata,System.currentTimeMillis(),key).clustering(j + "col" + i).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
    }
  }
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().minClusteringValues.get(0)),"0col100");
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().maxClusteringValues.get(0)),"7col149");
  }
  String key="row2";
  for (int i=101; i < 299; i++) {
    new RowUpdateBuilder(store.metadata,System.currentTimeMillis(),key).clustering(9 + "col" + i).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  store.forceMajorCompaction();
  assertEquals(1,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().minClusteringValues.get(0)),"0col100");
    assertEquals(ByteBufferUtil.string(sstable.getSSTableMetadata().maxClusteringValues.get(0)),"9col298");
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * 1. create a row with columns with ttls, 5x100 and 1x1000
 * 2. flush, verify (maxLocalDeletionTime = time+1000)
 * 3. delete column with ttl=1000
 * 4. flush, verify the new sstable (maxLocalDeletionTime = ~now)
 * 5. compact
 * 6. verify resulting sstable has maxLocalDeletionTime = time + 100.
 * @throws ExecutionException
 * @throws InterruptedException
 */
@Test public void testWithDeletes() throws ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard2");
  long timestamp=System.currentTimeMillis();
  DecoratedKey key=Util.dk("deletetest");
  for (int i=0; i < 5; i++)   new RowUpdateBuilder(store.metadata,timestamp,100,"deletetest").clustering("deletecolumn" + i).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(store.metadata,timestamp,1000,"deletetest").clustering("todelete").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  int ttltimestamp=(int)(System.currentTimeMillis() / 1000);
  int firstMaxDelTime=0;
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    firstMaxDelTime=sstable.getSSTableMetadata().maxLocalDeletionTime;
    assertEquals(ttltimestamp + 1000,firstMaxDelTime,10);
  }
  RowUpdateBuilder.deleteRow(store.metadata,timestamp + 1,"deletetest","todelete").applyUnsafe();
  store.forceBlockingFlush();
  assertEquals(2,store.getLiveSSTables().size());
  boolean foundDelete=false;
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    if (sstable.getSSTableMetadata().maxLocalDeletionTime != firstMaxDelTime) {
      assertEquals(sstable.getSSTableMetadata().maxLocalDeletionTime,ttltimestamp,10);
      foundDelete=true;
    }
  }
  assertTrue(foundDelete);
  Util.compact(store,store.getLiveSSTables());
  assertEquals(1,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertEquals(ttltimestamp + 100,sstable.getSSTableMetadata().maxLocalDeletionTime,10);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMaxMinComposites() throws CharacterCodingException, ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("StandardComposite2");
  for (int i=0; i < 10; i++) {
    new RowUpdateBuilder(cfs.metadata,0,"k").clustering("a" + (9 - i),getBytes(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  for (int i=0; i < 10; i++) {
    new RowUpdateBuilder(cfs.metadata,0,"k2").clustering("b" + (9 - i),getBytes(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  cfs.forceMajorCompaction();
  assertEquals(cfs.getLiveSSTables().size(),1);
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    assertEquals("b9",ByteBufferUtil.string(sstable.getSSTableMetadata().maxClusteringValues.get(0)));
    assertEquals(9,ByteBufferUtil.toInt(sstable.getSSTableMetadata().maxClusteringValues.get(1)));
    assertEquals("a0",ByteBufferUtil.string(sstable.getSSTableMetadata().minClusteringValues.get(0)));
    assertEquals(0,ByteBufferUtil.toInt(sstable.getSSTableMetadata().minClusteringValues.get(1)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableReaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexSummaryReplacement() throws IOException, ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  final ColumnFamilyStore store=keyspace.getColumnFamilyStore("StandardLowIndexInterval");
  CompactionManager.instance.disableAutoCompaction();
  final int NUM_PARTITIONS=512;
  for (int j=0; j < NUM_PARTITIONS; j++) {
    new RowUpdateBuilder(store.metadata,j,String.format("%3d",j)).clustering("0").add("val",String.format("%3d",j)).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  Collection<SSTableReader> sstables=store.getLiveSSTables();
  assert sstables.size() == 1;
  final SSTableReader sstable=sstables.iterator().next();
  ThreadPoolExecutor executor=new ScheduledThreadPoolExecutor(5);
  List<Future> futures=new ArrayList<>(NUM_PARTITIONS * 2);
  for (int i=0; i < NUM_PARTITIONS; i++) {
    final ByteBuffer key=ByteBufferUtil.bytes(String.format("%3d",i));
    final int index=i;
    futures.add(executor.submit(new Runnable(){
      public void run(){
        Row row=Util.getOnlyRowUnfiltered(Util.cmd(store,key).build());
        assertEquals(0,ByteBufferUtil.compare(String.format("%3d",index).getBytes(),row.cells().iterator().next().value()));
      }
    }
));
    futures.add(executor.submit(new Runnable(){
      public void run(){
        Iterable<DecoratedKey> results=store.keySamples(new Range<>(sstable.getPartitioner().getMinimumToken(),sstable.getPartitioner().getToken(key)));
        assertTrue(results.iterator().hasNext());
      }
    }
));
  }
  SSTableReader replacement;
  try (LifecycleTransaction txn=store.getTracker().tryModify(Arrays.asList(sstable),OperationType.UNKNOWN)){
    replacement=sstable.cloneWithNewSummarySamplingLevel(store,1);
    txn.update(replacement,true);
    txn.finish();
  }
   for (  Future future : futures)   future.get();
  assertEquals(sstable.estimatedKeys(),replacement.estimatedKeys(),1);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadRateTracking(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  partitioner=store.getPartitioner();
  for (int j=0; j < 10; j++) {
    new RowUpdateBuilder(store.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  assertEquals(0,sstable.getReadMeter().count());
  DecoratedKey key=sstable.decorateKey(ByteBufferUtil.bytes("4"));
  Util.getAll(Util.cmd(store,key).build());
  assertEquals(1,sstable.getReadMeter().count());
  Util.getAll(Util.cmd(store,key).includeRow("0").build());
  assertEquals(2,sstable.getReadMeter().count());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testOpeningSSTable() throws Exception {
  String ks=KEYSPACE1;
  String cf="Standard1";
  Keyspace keyspace=Keyspace.open(ks);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(cf);
  store.clearUnsafe();
  store.disableAutoCompaction();
  DecoratedKey firstKey=null, lastKey=null;
  long timestamp=System.currentTimeMillis();
  for (int i=0; i < store.metadata.params.minIndexInterval; i++) {
    DecoratedKey key=Util.dk(String.valueOf(i));
    if (firstKey == null)     firstKey=key;
    if (lastKey == null)     lastKey=key;
    if (store.metadata.getKeyValidator().compare(lastKey.getKey(),key.getKey()) < 0)     lastKey=key;
    new RowUpdateBuilder(store.metadata,timestamp,key.getKey()).clustering("col").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  Descriptor desc=sstable.descriptor;
  SSTableReader target=SSTableReader.open(desc);
  Assert.assertEquals(target.getIndexSummarySize(),1);
  Assert.assertArrayEquals(ByteBufferUtil.getArray(firstKey.getKey()),target.getIndexSummaryKey(0));
  assert target.first.equals(firstKey);
  assert target.last.equals(lastKey);
  target.selfRef().release();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableRewriterTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * emulates anticompaction - writing from one source sstable to two new sstables
 * @throws IOException
 */
@Test public void testTwoWriters() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,false);SSTableRewriter writer2=new SSTableRewriter(txn,1000,false,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    writer2.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      if (writer.currentWriter().getFilePointer() < 15000000)       writer.append(ci.next());
 else       writer2.append(ci.next());
    }
    for (int i=0; i < 5000; i++)     assertFalse(Util.getOnlyPartition(Util.cmd(cfs,ByteBufferUtil.bytes(i)).build()).isEmpty());
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFilesAndSizes() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  long startStorageMetricsLoad=StorageMetrics.load.getCount();
  long sBytesOnDisk=s.bytesOnDisk();
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 25000000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
        assertEquals(s.bytesOnDisk(),cfs.metric.liveDiskSpaceUsed.getCount());
        assertEquals(s.bytesOnDisk(),cfs.metric.totalDiskSpaceUsed.getCount());
      }
    }
    sstables=rewriter.finish();
  }
   LifecycleTransaction.waitForDeletions();
  long sum=0;
  for (  SSTableReader x : cfs.getLiveSSTables())   sum+=x.bytesOnDisk();
  assertEquals(sum,cfs.metric.liveDiskSpaceUsed.getCount());
  assertEquals(startStorageMetricsLoad - sBytesOnDisk + sum,StorageMetrics.load.getCount());
  assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertEquals(sum,cfs.metric.totalDiskSpaceUsed.getCount());
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void basicTest() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  for (int j=0; j < 100; j++) {
    new RowUpdateBuilder(cfs.metadata,j,String.valueOf(j)).clustering("0").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().apply();
  }
  cfs.forceBlockingFlush();
  Set<SSTableReader> sstables=new HashSet<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  assertEquals(sstables.iterator().next().bytesOnDisk(),cfs.metric.liveDiskSpaceUsed.getCount());
  int nowInSec=FBUtilities.nowInSeconds();
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      writer.append(ci.next());
    }
    writer.finish();
  }
   LifecycleTransaction.waitForDeletions();
  validateCFS(cfs);
  int filecounts=assertFileCounts(sstables.iterator().next().descriptor.directory.list());
  assertEquals(1,filecounts);
  truncate(cfs);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void basicTest2() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=new HashSet<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      writer.append(ci.next());
    }
    writer.finish();
  }
   LifecycleTransaction.waitForDeletions();
  validateCFS(cfs);
  int filecounts=assertFileCounts(sstables.iterator().next().descriptor.directory.list());
  assertEquals(1,filecounts);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPositionsTest() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=new HashSet<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  boolean checked=false;
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      UnfilteredRowIterator row=ci.next();
      writer.append(row);
      if (!checked && writer.currentWriter().getFilePointer() > 1500000) {
        checked=true;
        for (        SSTableReader sstable : cfs.getLiveSSTables()) {
          if (sstable.openReason == SSTableReader.OpenReason.EARLY) {
            SSTableReader c=txn.current(sstables.iterator().next());
            Collection<Range<Token>> r=Arrays.asList(new Range<>(cfs.getPartitioner().getMinimumToken(),cfs.getPartitioner().getMinimumToken()));
            List<Pair<Long,Long>> tmplinkPositions=sstable.getPositionsForRanges(r);
            List<Pair<Long,Long>> compactingPositions=c.getPositionsForRanges(r);
            assertEquals(1,tmplinkPositions.size());
            assertEquals(1,compactingPositions.size());
            assertEquals(0,tmplinkPositions.get(0).left.longValue());
            assertEquals(tmplinkPositions.get(0).right.longValue(),compactingPositions.get(0).left.longValue());
            assertEquals(c.uncompressedLength(),compactingPositions.get(0).right.longValue());
          }
        }
      }
    }
    assertTrue(checked);
    writer.finish();
  }
   LifecycleTransaction.waitForDeletions();
  validateCFS(cfs);
  int filecounts=assertFileCounts(sstables.iterator().next().descriptor.directory.list());
  assertEquals(1,filecounts);
  truncate(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_dont_clean_readers() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 25000000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
      }
    }
    sstables=rewriter.finish();
  }
   assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCanonicalView() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  boolean checked=false;
  try (ISSTableScanner scanner=sstables.iterator().next().getScanner();CompactionController controller=new CompactionController(cfs,sstables,0);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      writer.append(ci.next());
      if (!checked && writer.currentWriter().getFilePointer() > 15000000) {
        checked=true;
        ColumnFamilyStore.ViewFragment viewFragment=cfs.select(View.select(SSTableSet.CANONICAL));
        assertEquals(1,viewFragment.sstables.size());
        SSTableReader sstable=viewFragment.sstables.get(0);
        assertEquals(s.descriptor,sstable.descriptor);
        assertTrue("Found early opened SSTable in canonical view: " + sstable.getFilename(),sstable.openReason != SSTableReader.OpenReason.EARLY);
      }
    }
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSmallFiles() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  cfs.disableAutoCompaction();
  SSTableReader s=writeFile(cfs,400);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,1000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 2500000) {
        assertEquals(files,cfs.getLiveSSTables().size());
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
      }
    }
    sstables=rewriter.finish();
  }
   assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableScannerTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleDataRange() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(TABLE);
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=2; i < 10; i++)   insertRowWithKey(store.metadata,i);
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  ISSTableScanner scanner=sstable.getScanner(null);
  for (int i=2; i < 10; i++)   assertEquals(toKey(i),new String(scanner.next().partitionKey().getKey().array()));
  scanner.close();
  assertScanMatches(sstable,3,6,3,6);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,2,9,2,9);
  assertScanMatches(sstable,3,9,3,9);
  assertScanMatches(sstable,1,8,2,8);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,2,2,2,2);
  assertScanMatches(sstable,5,5,5,5);
  assertScanMatches(sstable,9,9,9,9);
  assertScanEmpty(sstable,0,1);
  assertScanEmpty(sstable,10,11);
  assertScanMatches(sstable,5,3,2,3,5,9);
  assertScanMatches(sstable,5,2,2,2,5,9);
  assertScanMatches(sstable,5,1,5,9);
  assertScanMatches(sstable,5,Integer.MIN_VALUE,5,9);
  assertScanMatches(sstable,9,8,2,8,9,9);
  assertScanMatches(sstable,9,3,2,3,9,9);
  assertScanMatches(sstable,9,2,2,2,9,9);
  assertScanMatches(sstable,9,1,9,9);
  assertScanMatches(sstable,9,Integer.MIN_VALUE,9,9);
  assertScanMatches(sstable,8,3,2,3,8,9);
  assertScanMatches(sstable,8,2,2,2,8,9);
  assertScanMatches(sstable,8,1,8,9);
  assertScanMatches(sstable,8,Integer.MIN_VALUE,8,9);
  assertScanMatches(sstable,10,9,2,9);
  assertScanMatches(sstable,10,5,2,5);
  assertScanMatches(sstable,10,2,2,2);
  assertScanEmpty(sstable,10,1);
  assertScanEmpty(sstable,10,Integer.MIN_VALUE);
  assertScanMatches(sstable,11,10,2,9);
  assertScanMatches(sstable,11,9,2,9);
  assertScanMatches(sstable,11,5,2,5);
  assertScanMatches(sstable,11,2,2,2);
  assertScanEmpty(sstable,11,1);
  assertScanEmpty(sstable,11,Integer.MIN_VALUE);
  assertScanMatches(sstable,3,1,3,9);
  assertScanMatches(sstable,3,Integer.MIN_VALUE,3,9);
  assertScanMatches(sstable,2,1,2,9);
  assertScanMatches(sstable,2,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,0,2,9);
  assertScanMatches(sstable,1,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,-1,2,9);
  assertScanMatches(sstable,1,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,0,2,9);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleKeyMultipleRanges() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(TABLE);
  store.clearUnsafe();
  store.disableAutoCompaction();
  insertRowWithKey(store.metadata,205);
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  ISSTableScanner fullScanner=sstable.getScanner(null);
  assertScanContainsRanges(fullScanner,205,205);
  ISSTableScanner scanner=sstable.getScanner(makeRanges(101,109,201,209),null);
  assertScanContainsRanges(scanner,205,205);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleRanges() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(TABLE);
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=0; i < 3; i++)   for (int j=2; j < 10; j++)   insertRowWithKey(store.metadata,i * 100 + j);
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  ISSTableScanner fullScanner=sstable.getScanner(null);
  assertScanContainsRanges(fullScanner,2,9,102,109,202,209);
  ISSTableScanner scanner=sstable.getScanner(makeRanges(1,9,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(101,109,201,209),null);
  assertScanContainsRanges(scanner,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,9,201,209),null);
  assertScanContainsRanges(scanner,2,9,202,209);
  scanner=sstable.getScanner(makeRanges(1,9,101,109),null);
  assertScanContainsRanges(scanner,2,9,102,109);
  scanner=sstable.getScanner(makeRanges(1,5,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,5,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,20,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,5,6,205,206,209),null);
  assertScanContainsRanges(scanner,2,5,7,9,102,109,202,205,207,209);
  scanner=sstable.getScanner(makeRanges(0,1,2,20,101,109,150,159,201,209,1000,1001),null);
  assertScanContainsRanges(scanner,3,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(201,209,1,20,201,209,101,109,1000,1001,150,159),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(0,1,150,159,250,259),null);
  assertFalse(scanner.hasNext());
  scanner=sstable.getScanner(new ArrayList<Range<Token>>(),null);
  assertFalse(scanner.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableWriterTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAbortTxnWithClosedWriterShouldRemoveSSTable() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  File dir=cfs.getDirectories().getDirectoryForNewSSTables();
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.STREAM);
  try (SSTableWriter writer=getWriter(cfs,dir,txn)){
    for (int i=0; i < 10000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    assertFileCounts(dir.list());
    for (int i=10000; i < 20000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    SSTableReader sstable=writer.finish(true);
    int datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,1);
    sstable.selfRef().release();
    if (!FBUtilities.isWindows()) {
      LifecycleTransaction.waitForDeletions();
      assertFileCounts(dir.list());
    }
    txn.abort();
    LifecycleTransaction.waitForDeletions();
    datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,0);
    validateCFS(cfs);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTxnWithOpenEarlyShouldRemoveSSTable() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  File dir=cfs.getDirectories().getDirectoryForNewSSTables();
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.WRITE);
  try (SSTableWriter writer=getWriter(cfs,dir,txn)){
    for (int i=0; i < 10000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    SSTableReader s=writer.setMaxDataAge(1000).openEarly();
    assert s != null;
    assertFileCounts(dir.list());
    for (int i=10000; i < 20000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    SSTableReader s2=writer.setMaxDataAge(1000).openEarly();
    assertTrue(s.last.compareTo(s2.last) < 0);
    assertFileCounts(dir.list());
    s.selfRef().release();
    s2.selfRef().release();
    int datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,1);
    if (!FBUtilities.isWindows()) {
      LifecycleTransaction.waitForDeletions();
      assertFileCounts(dir.list());
    }
    writer.abort();
    txn.abort();
    LifecycleTransaction.waitForDeletions();
    datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,0);
    validateCFS(cfs);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAbortTxnWithClosedAndOpenWriterShouldRemoveAllSSTables() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  File dir=cfs.getDirectories().getDirectoryForNewSSTables();
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.STREAM);
  SSTableWriter writer1=getWriter(cfs,dir,txn);
  SSTableWriter writer2=getWriter(cfs,dir,txn);
  try {
    for (int i=0; i < 10000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer1.append(builder.build().unfilteredIterator());
    }
    assertFileCounts(dir.list());
    for (int i=10000; i < 20000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer2.append(builder.build().unfilteredIterator());
    }
    SSTableReader sstable=writer1.finish(true);
    txn.update(sstable,false);
    assertFileCounts(dir.list());
    int datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,2);
    if (!FBUtilities.isWindows()) {
      LifecycleTransaction.waitForDeletions();
      assertFileCounts(dir.list());
    }
    txn.abort();
    LifecycleTransaction.waitForDeletions();
    datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,0);
    validateCFS(cfs);
  }
  finally {
    writer1.close();
    writer2.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.format.SSTableFlushObserverTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushObserver(){
  CFMetaData cfm=CFMetaData.Builder.create(KS_NAME,CF_NAME).addPartitionKey("id",UTF8Type.instance).addRegularColumn("first_name",UTF8Type.instance).addRegularColumn("age",Int32Type.instance).addRegularColumn("height",LongType.instance).build();
  LifecycleTransaction transaction=LifecycleTransaction.offline(OperationType.COMPACTION);
  FlushObserver observer=new FlushObserver();
  String sstableDirectory=DatabaseDescriptor.getAllDataFileLocations()[0];
  File directory=new File(sstableDirectory + File.pathSeparator + KS_NAME+ File.pathSeparator+ CF_NAME);
  directory.deleteOnExit();
  if (!directory.exists() && !directory.mkdirs())   throw new FSWriteError(new IOException("failed to create tmp directory"),directory.getAbsolutePath());
  SSTableFormat.Type sstableFormat=DatabaseDescriptor.getSSTableFormat();
  BigTableWriter writer=new BigTableWriter(new Descriptor(sstableFormat.info.getLatestVersion().version,directory,KS_NAME,CF_NAME,0,sstableFormat),10L,0L,cfm,new MetadataCollector(cfm.comparator).sstableLevel(0),new SerializationHeader(true,cfm,cfm.partitionColumns(),EncodingStats.NO_STATS),Collections.singletonList(observer),transaction);
  SSTableReader reader=null;
  Multimap<ByteBuffer,Cell> expected=ArrayListMultimap.create();
  try {
    final long now=System.currentTimeMillis();
    ByteBuffer key=UTF8Type.instance.fromString("key1");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("jack")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(27)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(183L))));
    writer.append(new RowIterator(cfm,key.duplicate(),Collections.singletonList(buildRow(expected.get(key)))));
    key=UTF8Type.instance.fromString("key2");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("jim")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(30)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(180L))));
    writer.append(new RowIterator(cfm,key,Collections.singletonList(buildRow(expected.get(key)))));
    key=UTF8Type.instance.fromString("key3");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("ken")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(30)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(178L))));
    writer.append(new RowIterator(cfm,key,Collections.singletonList(buildRow(expected.get(key)))));
    reader=writer.finish(true);
  }
  finally {
    FileUtils.closeQuietly(writer);
  }
  Assert.assertTrue(observer.isComplete);
  Assert.assertEquals(expected.size(),observer.rows.size());
  for (  Pair<ByteBuffer,Long> e : observer.rows.keySet()) {
    ByteBuffer key=e.left;
    Long indexPosition=e.right;
    try (FileDataInput index=reader.ifile.createReader(indexPosition)){
      ByteBuffer indexKey=ByteBufferUtil.readWithShortLength(index);
      Assert.assertEquals(0,UTF8Type.instance.compare(key,indexKey));
    }
 catch (    IOException ex) {
      throw new FSReadError(ex,reader.getIndexFilename());
    }
    Assert.assertEquals(expected.get(key),observer.rows.get(e));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.metadata.MetadataSerializerTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSerialization() throws IOException {
  CFMetaData cfm=SchemaLoader.standardCFMD("ks1","cf1");
  ReplayPosition rp=new ReplayPosition(11L,12);
  MetadataCollector collector=new MetadataCollector(cfm.comparator).replayPosition(rp);
  String partitioner=RandomPartitioner.class.getCanonicalName();
  double bfFpChance=0.1;
  Map<MetadataType,MetadataComponent> originalMetadata=collector.finalizeMetadata(partitioner,bfFpChance,0,SerializationHeader.make(cfm,Collections.EMPTY_LIST));
  MetadataSerializer serializer=new MetadataSerializer();
  File statsFile=File.createTempFile(Component.STATS.name,null);
  try (DataOutputStreamPlus out=new BufferedDataOutputStreamPlus(new FileOutputStream(statsFile))){
    serializer.serialize(originalMetadata,out,BigFormat.latestVersion);
  }
   Descriptor desc=new Descriptor(statsFile.getParentFile(),"","",0);
  try (RandomAccessReader in=RandomAccessReader.open(statsFile)){
    Map<MetadataType,MetadataComponent> deserialized=serializer.deserialize(desc,in,EnumSet.allOf(MetadataType.class));
    for (    MetadataType type : MetadataType.values()) {
      assertEquals(originalMetadata.get(type),deserialized.get(type));
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedDataOutputStreamTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriteUTFBigChar() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput dataOut=new DataOutputStream(baos);
  StringBuilder sb=new StringBuilder(65535);
  for (int ii=0; ii < 1 << 15; ii++) {
    String s=sb.toString();
    UnbufferedDataOutputStreamPlus.writeUTF(s,dataOut);
    DataInput dataIn=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    assertEquals(s,dataIn.readUTF());
    baos.reset();
    if (ii == (1 << 15) - 1)     sb.append("a");
 else     sb.append(twoByte);
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriteUTF() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput dataOut=new DataOutputStream(baos);
  StringBuilder sb=new StringBuilder(65535);
  for (int ii=0; ii < 1 << 16; ii++) {
    String s=sb.toString();
    UnbufferedDataOutputStreamPlus.writeUTF(s,dataOut);
    DataInput dataIn=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    assertEquals(s,dataIn.readUTF());
    baos.reset();
    sb.append("a");
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnsignedVInt() throws Exception {
  setUp();
  long testValues[]=new long[]{0,1,UnsignedLong.MAX_VALUE.longValue(),UnsignedLong.MAX_VALUE.longValue() - 1,UnsignedLong.MAX_VALUE.longValue() + 1,UnsignedInteger.MAX_VALUE.longValue(),UnsignedInteger.MAX_VALUE.longValue() - 1,UnsignedInteger.MAX_VALUE.longValue() + 1,UnsignedBytes.MAX_VALUE,UnsignedBytes.MAX_VALUE - 1,UnsignedBytes.MAX_VALUE + 1,65536,65536 - 1,65536 + 1};
  testValues=enrich(testValues);
  int expectedSize=0;
  for (  long v : testValues) {
    expectedSize+=VIntCoding.computeUnsignedVIntSize(v);
    ndosp.writeUnsignedVInt(v);
  }
  ndosp.flush();
  DataInputBuffer in=new DataInputBuffer(generated.toByteArray());
  assertEquals(expectedSize,generated.toByteArray().length);
  for (  long v : testValues)   assertEquals(v,in.readUnsignedVInt());
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVInt() throws Exception {
  setUp();
  long testValues[]=new long[]{0,1,-1,Long.MIN_VALUE,Long.MIN_VALUE + 1,Long.MAX_VALUE,Long.MAX_VALUE - 1,Integer.MIN_VALUE,Integer.MIN_VALUE + 1,Integer.MAX_VALUE,Integer.MAX_VALUE - 1,Short.MIN_VALUE,Short.MIN_VALUE + 1,Short.MAX_VALUE,Short.MAX_VALUE - 1,Byte.MIN_VALUE,Byte.MIN_VALUE + 1,Byte.MAX_VALUE,Byte.MAX_VALUE - 1};
  testValues=enrich(testValues);
  int expectedSize=0;
  for (  long v : testValues) {
    expectedSize+=VIntCoding.computeVIntSize(v);
    ndosp.writeVInt(v);
  }
  ndosp.flush();
  DataInputBuffer in=new DataInputBuffer(generated.toByteArray());
  assertEquals(expectedSize,generated.toByteArray().length);
  for (  long v : testValues) {
    assertEquals(v,in.readVInt());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedRandomAccessFileTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetFilePointer() throws IOException {
  final SequentialWriter w=createTempFile("brafGetFilePointer");
  assertEquals(w.position(),0);
  w.write(generateByteArray(20));
  assertEquals(w.position(),20);
  w.sync();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader r=RandomAccessReader.open(channel);
  r.seek(0);
  r.skipBytes(15);
  assertEquals(r.getFilePointer(),15);
  r.read();
  assertEquals(r.getFilePointer(),16);
  r.read(new byte[4]);
  assertEquals(r.getFilePointer(),20);
  w.finish();
  r.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAndWrite() throws Exception {
  SequentialWriter w=createTempFile("braf");
  ChannelProxy channel=new ChannelProxy(w.getPath());
  byte[] data="Hello".getBytes();
  w.write(data);
  assertEquals(data.length,w.length());
  assertEquals(data.length,w.position());
  w.sync();
  RandomAccessReader r=RandomAccessReader.open(channel);
  byte[] buffer=new byte[data.length];
  assertEquals(data.length,r.read(buffer));
  assertTrue(Arrays.equals(buffer,data));
  assertEquals(r.read(),-1);
  assert r.bytesRemaining() == 0 && r.isEOF();
  r.close();
  byte[] bigData=new byte[RandomAccessReader.DEFAULT_BUFFER_SIZE + 10];
  for (int i=0; i < bigData.length; i++)   bigData[i]='d';
  long initialPosition=w.position();
  w.write(bigData);
  assertEquals(w.position(),initialPosition + bigData.length);
  assertEquals(w.length(),initialPosition + bigData.length);
  w.sync();
  r=RandomAccessReader.open(channel);
  r.seek(initialPosition);
  data=new byte[bigData.length];
  long sizeRead=0;
  for (int i=0; i < data.length; i++) {
    data[i]=(byte)r.read();
    sizeRead++;
  }
  assertEquals(sizeRead,data.length);
  assertEquals(r.getFilePointer(),initialPosition + data.length);
  assertEquals(r.length(),initialPosition + bigData.length);
  assertTrue(Arrays.equals(bigData,data));
  assertTrue(r.bytesRemaining() == 0 && r.isEOF());
  r.seek(0);
  ByteBuffer fileContent=ByteBufferUtil.read(r,(int)w.length());
  assertEquals(fileContent.limit(),w.length());
  assert ByteBufferUtil.string(fileContent).equals("Hello" + new String(bigData));
  data=new byte[bigData.length];
  r.seek(initialPosition);
  r.readFully(data);
  assert r.bytesRemaining() == 0 && r.isEOF();
  assertTrue(Arrays.equals(bigData,data));
  data=new byte[10];
  assertEquals(r.read(),-1);
  assertEquals(r.read(data),-1);
  assertEquals(r.read(data,0,data.length),-1);
  r.seek(0);
  data=new byte[20];
  assertEquals(15,r.read(data,0,15));
  assertTrue(new String(data).contains("Hellodddddddddd"));
  for (int i=16; i < data.length; i++) {
    assert data[i] == 0;
  }
  w.finish();
  r.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkAndReset() throws IOException {
  SequentialWriter w=createTempFile("brafTestMark");
  w.write(new byte[30]);
  w.finish();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader file=RandomAccessReader.open(channel);
  file.seek(10);
  FileMark mark=file.mark();
  file.seek(file.length());
  assertTrue(file.isEOF());
  file.reset();
  assertEquals(file.bytesRemaining(),20);
  file.seek(file.length());
  assertTrue(file.isEOF());
  file.reset(mark);
  assertEquals(file.bytesRemaining(),20);
  file.seek(file.length());
  assertEquals(file.bytesPastMark(),20);
  assertEquals(file.bytesPastMark(mark),20);
  file.reset(mark);
  assertEquals(file.bytesPastMark(),0);
  file.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBytesRemaining() throws IOException {
  SequentialWriter w=createTempFile("brafBytesRemaining");
  int toWrite=RandomAccessReader.DEFAULT_BUFFER_SIZE + 10;
  w.write(generateByteArray(toWrite));
  w.sync();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader r=RandomAccessReader.open(channel);
  assertEquals(r.bytesRemaining(),toWrite);
  for (int i=1; i <= r.length(); i++) {
    r.read();
    assertEquals(r.bytesRemaining(),r.length() - i);
  }
  r.seek(0);
  r.skipBytes(10);
  assertEquals(r.bytesRemaining(),r.length() - 10);
  w.finish();
  r.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipBytes() throws IOException {
  SequentialWriter w=createTempFile("brafSkipBytes");
  w.write(generateByteArray(RandomAccessReader.DEFAULT_BUFFER_SIZE * 2));
  w.finish();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader file=RandomAccessReader.open(channel);
  file.seek(0);
  assertEquals(file.skipBytes(10),10);
  assertEquals(file.bytesRemaining(),file.length() - 10);
  int initialPosition=(int)file.getFilePointer();
  assertEquals(file.skipBytes((int)file.length() + 10),file.length() - initialPosition);
  assertEquals(file.getFilePointer(),file.length());
  assert file.bytesRemaining() == 0 && file.isEOF();
  file.seek(0);
  assertEquals(file.skipBytes(-1000),0);
  assertEquals(file.getFilePointer(),0);
  assertEquals(file.bytesRemaining(),file.length());
  file.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLength() throws IOException {
  File tmpFile=File.createTempFile("lengthtest","bin");
  SequentialWriter w=SequentialWriter.open(tmpFile);
  assertEquals(0,w.length());
  byte[] lessThenBuffer=generateByteArray(RandomAccessReader.DEFAULT_BUFFER_SIZE / 2);
  w.write(lessThenBuffer);
  assertEquals(lessThenBuffer.length,w.length());
  w.sync();
  assertEquals(lessThenBuffer.length,w.length());
  byte[] biggerThenBuffer=generateByteArray(RandomAccessReader.DEFAULT_BUFFER_SIZE * 2);
  w.write(biggerThenBuffer);
  assertEquals(biggerThenBuffer.length + lessThenBuffer.length,w.length());
  w.finish();
  try (ChannelProxy channel=new ChannelProxy(tmpFile);RandomAccessReader r=RandomAccessReader.open(channel)){
    assertEquals(lessThenBuffer.length + biggerThenBuffer.length,r.length());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.ChecksummedRandomAccessReaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void seek() throws IOException {
  final File data=File.createTempFile("testSeek","data");
  final File crc=File.createTempFile("testSeek","crc");
  final byte[] dataBytes=new byte[70 * 1024];
  ThreadLocalRandom.current().nextBytes(dataBytes);
  SequentialWriter writer=ChecksummedSequentialWriter.open(data,crc);
  writer.write(dataBytes);
  writer.finish();
  assert data.exists();
  RandomAccessReader reader=new ChecksummedRandomAccessReader.Builder(data,crc).build();
  final int seekPosition=66000;
  reader.seek(seekPosition);
  byte[] b=new byte[dataBytes.length - seekPosition];
  reader.readFully(b);
  byte[] expected=Arrays.copyOfRange(dataBytes,seekPosition,dataBytes.length);
  assertArrayEquals(expected,b);
  assertTrue(reader.isEOF());
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.DataOutputTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDataOutputBufferMaxSizeFake() throws IOException {
  try (DataOutputBufferSpy write=new DataOutputBufferSpy()){
    boolean threw=false;
    try {
      while (true)       write.publicFlush();
    }
 catch (    RuntimeException e) {
      if (e.getClass() == RuntimeException.class)       threw=true;
    }
    Assert.assertTrue(threw);
    Assert.assertTrue(write.sizes.peekLast() >= DataOutputBuffer.MAX_ARRAY_SIZE);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.FileUtilsTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncate() throws IOException {
  File file=FileUtils.createTempFile("testTruncate","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  Files.write(file.toPath(),expected.getBytes());
  assertTrue(file.exists());
  byte[] b=Files.readAllBytes(file.toPath());
  assertEquals(expected,new String(b,Charset.forName("UTF-8")));
  FileUtils.truncate(file.getAbsolutePath(),10);
  b=Files.readAllBytes(file.toPath());
  assertEquals("The quick ",new String(b,Charset.forName("UTF-8")));
  FileUtils.truncate(file.getAbsolutePath(),0);
  b=Files.readAllBytes(file.toPath());
  assertEquals(0,b.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MmappedRegionsTest </h4><pre class="type-7 type-4 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test(expected=AssertionError.class) public void testCopyCannotExtend() throws Exception {
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  MmappedRegions snapshot;
  ChannelProxy channelCopy;
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSnapshotCannotExtend",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(buffer.capacity() / 2);
    snapshot=regions.sharedCopy();
    channelCopy=channel.sharedCopy();
  }
   try {
    snapshot.extend(buffer.capacity());
  }
  finally {
    assertNull(snapshot.close(null));
    assertNull(channelCopy.close(null));
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopy() throws Exception {
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  MmappedRegions snapshot;
  ChannelProxy channelCopy;
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSnapshot",buffer));MmappedRegions regions=MmappedRegions.map(channel,buffer.capacity() / 4)){
    regions.extend(buffer.capacity() / 2);
    regions.extend(3 * buffer.capacity() / 4);
    regions.extend(buffer.capacity());
    snapshot=regions.sharedCopy();
    channelCopy=channel.sharedCopy();
  }
   assertFalse(snapshot.isCleanedUp());
  final int SIZE=buffer.capacity() / 4;
  for (int i=0; i < buffer.capacity(); i++) {
    MmappedRegions.Region region=snapshot.floor(i);
    assertNotNull(region);
    assertEquals(SIZE * (i / SIZE),region.bottom());
    assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    assertNotNull(region.buffer.duplicate().getInt());
  }
  assertNull(snapshot.close(null));
  assertNull(channelCopy.close(null));
  assertTrue(snapshot.isCleanedUp());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSmallSegmentSize() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(4096);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSmallSegmentSize",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(1024);
    regions.extend(2048);
    regions.extend(4096);
    final int SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(SIZE * (i / SIZE),region.bottom());
      assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap3() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap3",buffer));MmappedRegions regions=MmappedRegions.map(channel,null)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllocRegions() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(MmappedRegions.MAX_SEGMENT_SIZE * MmappedRegions.REGION_ALLOC_SIZE * 3);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testAllocRegions",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(buffer.capacity());
    final int SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(SIZE * (i / SIZE),region.bottom());
      assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmpty() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testEmpty",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    assertTrue(regions.isEmpty());
    assertTrue(regions.isValid(channel));
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapForCompressionMetadata() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  File f=File.createTempFile("testMapForCompressionMetadata","1");
  f.deleteOnExit();
  File cf=File.createTempFile(f.getName() + ".metadata","1");
  cf.deleteOnExit();
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(f,cf.getAbsolutePath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(buffer);
    writer.finish();
  }
   CompressionMetadata metadata=new CompressionMetadata(cf.getAbsolutePath(),f.length(),ChecksumType.CRC32);
  try (ChannelProxy channel=new ChannelProxy(f);MmappedRegions regions=MmappedRegions.map(channel,metadata)){
    assertFalse(regions.isEmpty());
    int i=0;
    while (i < buffer.capacity()) {
      CompressionMetadata.Chunk chunk=metadata.chunkFor(i);
      MmappedRegions.Region region=regions.floor(chunk.offset);
      assertNotNull(region);
      ByteBuffer compressedChunk=region.buffer.duplicate();
      assertNotNull(compressedChunk);
      assertEquals(chunk.length + 4,compressedChunk.capacity());
      assertEquals(chunk.offset,region.bottom());
      assertEquals(chunk.offset + chunk.length + 4,region.top());
      i+=metadata.chunkLength();
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
    metadata.close();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtendOutOfOrder() throws Exception {
  ByteBuffer buffer=allocateBuffer(4096);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testExtendOutOfOrder",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(4096);
    regions.extend(1024);
    regions.extend(2048);
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(0,region.bottom());
      assertEquals(4096,region.top());
    }
  }
 }

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap1() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap1",buffer));MmappedRegions regions=MmappedRegions.map(channel,0)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoSegments() throws Exception {
  ByteBuffer buffer=allocateBuffer(2048);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testTwoSegments",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(1024);
    for (int i=0; i < 1024; i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(0,region.bottom());
      assertEquals(1024,region.top());
    }
    regions.extend(2048);
    for (int i=0; i < 2048; i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      if (i < 1024) {
        assertEquals(0,region.bottom());
        assertEquals(1024,region.top());
      }
 else {
        assertEquals(1024,region.bottom());
        assertEquals(2048,region.top());
      }
    }
  }
 }

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap2() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap2",buffer));MmappedRegions regions=MmappedRegions.map(channel,-1L)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.NIODataInputStreamTest </h4><pre class="type-6 type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntSmallBuffer() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    ByteBuffer buf=ByteBuffer.allocate(Math.max(1,ii));
    long value=0;
    if (ii > 0)     value=(1L << 7 * ii) - 1;
    BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
    out.writeUnsignedVInt(value);
    buf.position(0);
    RebufferingInputStream in=new DataInputBuffer(buf,false);
    assertEquals(value,in.readUnsignedVInt());
    boolean threw=false;
    try {
      in.readUnsignedVInt();
    }
 catch (    EOFException e) {
      threw=true;
    }
    assertTrue(threw);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void testReadUTF() throws Exception {
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream daos=new DataOutputStream(baos);
  String simple="foobar42";
  assertEquals(2,BufferedDataOutputStreamTest.twoByte.getBytes(Charsets.UTF_8).length);
  assertEquals(3,BufferedDataOutputStreamTest.threeByte.getBytes(Charsets.UTF_8).length);
  assertEquals(4,BufferedDataOutputStreamTest.fourByte.getBytes(Charsets.UTF_8).length);
  daos.writeUTF(simple);
  daos.writeUTF(BufferedDataOutputStreamTest.twoByte);
  daos.writeUTF(BufferedDataOutputStreamTest.threeByte);
  daos.writeUTF(BufferedDataOutputStreamTest.fourByte);
  NIODataInputStream is=new NIODataInputStream(wrap(baos.toByteArray()),4096);
  assertEquals(simple,is.readUTF());
  assertEquals(BufferedDataOutputStreamTest.twoByte,is.readUTF());
  assertEquals(BufferedDataOutputStreamTest.threeByte,is.readUTF());
  assertEquals(BufferedDataOutputStreamTest.fourByte,is.readUTF());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("resource") @Test public void testReadUnsignedVInt() throws Exception {
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStreamPlus daos=new WrappedDataOutputStreamPlus(baos);
  long values[]=new long[]{0,1,UnsignedLong.MAX_VALUE.longValue(),UnsignedLong.MAX_VALUE.longValue() - 1,UnsignedLong.MAX_VALUE.longValue() + 1,UnsignedInteger.MAX_VALUE.longValue(),UnsignedInteger.MAX_VALUE.longValue() - 1,UnsignedInteger.MAX_VALUE.longValue() + 1,UnsignedBytes.MAX_VALUE,UnsignedBytes.MAX_VALUE - 1,UnsignedBytes.MAX_VALUE + 1,65536,65536 - 1,65536 + 1};
  values=BufferedDataOutputStreamTest.enrich(values);
  for (  long v : values)   daos.writeUnsignedVInt(v);
  daos.flush();
  NIODataInputStream is=new NIODataInputStream(wrap(baos.toByteArray()),9);
  for (  long v : values)   assertEquals(v,is.readUnsignedVInt());
  boolean threw=false;
  try {
    is.readUnsignedVInt();
  }
 catch (  EOFException e) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void testAvailable() throws Exception {
  init();
  DummyChannel dc=new DummyChannel();
  dc.slices.clear();
  dc.slices.offer(ByteBuffer.allocate(8190));
  NIODataInputStream is=new NIODataInputStream(dc,4096);
  assertEquals(0,is.available());
  is.read();
  assertEquals(4095,is.available());
  is.read(new byte[4095]);
  assertEquals(0,is.available());
  is.read(new byte[10]);
  assertEquals(8190 - 10 - 4096,is.available());
  File f=File.createTempFile("foo","bar");
  RandomAccessFile fos=new RandomAccessFile(f,"rw");
  fos.write(new byte[10]);
  fos.seek(0);
  is=new NIODataInputStream(fos.getChannel(),9);
  int remaining=10;
  assertEquals(10,is.available());
  while (remaining > 0) {
    is.read();
    remaining--;
    assertEquals(remaining,is.available());
  }
  assertEquals(0,is.available());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("resource") @Test public void testReadVInt() throws Exception {
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStreamPlus daos=new WrappedDataOutputStreamPlus(baos);
  long values[]=new long[]{0,1,-1,Long.MIN_VALUE,Long.MIN_VALUE + 1,Long.MAX_VALUE,Long.MAX_VALUE - 1,Integer.MIN_VALUE,Integer.MIN_VALUE + 1,Integer.MAX_VALUE,Integer.MAX_VALUE - 1,Short.MIN_VALUE,Short.MIN_VALUE + 1,Short.MAX_VALUE,Short.MAX_VALUE - 1,Byte.MIN_VALUE,Byte.MIN_VALUE + 1,Byte.MAX_VALUE,Byte.MAX_VALUE - 1};
  values=BufferedDataOutputStreamTest.enrich(values);
  for (  long v : values)   daos.writeVInt(v);
  daos.flush();
  NIODataInputStream is=new NIODataInputStream(wrap(baos.toByteArray()),9);
  for (  long v : values)   assertEquals(v,is.readVInt());
  boolean threw=false;
  try {
    is.readVInt();
  }
 catch (  EOFException e) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.RandomAccessReaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadBytes() throws IOException {
  File f=File.createTempFile("testReadBytes","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  try (SequentialWriter writer=SequentialWriter.open(f)){
    writer.write(expected.getBytes());
    writer.finish();
  }
   assert f.exists();
  try (ChannelProxy channel=new ChannelProxy(f);RandomAccessReader reader=new RandomAccessReader.Builder(channel).build()){
    assertEquals(f.getAbsolutePath(),reader.getPath());
    assertEquals(expected.length(),reader.length());
    ByteBuffer b=ByteBufferUtil.read(reader,expected.length());
    assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    assertTrue(reader.isEOF());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReset() throws IOException {
  File f=File.createTempFile("testMark","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  final int numIterations=10;
  try (SequentialWriter writer=SequentialWriter.open(f)){
    for (int i=0; i < numIterations; i++)     writer.write(expected.getBytes());
    writer.finish();
  }
   assert f.exists();
  try (ChannelProxy channel=new ChannelProxy(f);RandomAccessReader reader=new RandomAccessReader.Builder(channel).build()){
    assertEquals(expected.length() * numIterations,reader.length());
    ByteBuffer b=ByteBufferUtil.read(reader,expected.length());
    assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    assertFalse(reader.isEOF());
    assertEquals((numIterations - 1) * expected.length(),reader.bytesRemaining());
    FileMark mark=reader.mark();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark(mark));
    reader.reset(mark);
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    reader.reset();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.DynamicEndpointSnitchTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSnitch() throws InterruptedException, IOException, ConfigurationException {
  StorageService.instance.unsafeInitialize();
  SimpleSnitch ss=new SimpleSnitch();
  DynamicEndpointSnitch dsnitch=new DynamicEndpointSnitch(ss,String.valueOf(ss.hashCode()));
  InetAddress self=FBUtilities.getBroadcastAddress();
  InetAddress host1=InetAddress.getByName("127.0.0.2");
  InetAddress host2=InetAddress.getByName("127.0.0.3");
  InetAddress host3=InetAddress.getByName("127.0.0.4");
  List<InetAddress> hosts=Arrays.asList(host1,host2,host3);
  setScores(dsnitch,1,hosts,10,10,10);
  List<InetAddress> order=Arrays.asList(host1,host2,host3);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
  setScores(dsnitch,1,hosts,20,10,10);
  order=Arrays.asList(host2,host3,host1);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
  setScores(dsnitch,2,hosts,15,20,10);
  order=Arrays.asList(host3,host1,host2);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
  setScores(dsnitch,3,hosts,10,10,30);
  order=Arrays.asList(host1,host2,host3);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
  setScores(dsnitch,5,hosts,10,10,10);
  order=Arrays.asList(host1,host2,host3);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
  setScores(dsnitch,20,hosts,10,70,20);
  order=Arrays.asList(host1,host3,host2);
  assertEquals(order,dsnitch.getSortedListByProximity(self,Arrays.asList(host1,host2,host3)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.EC2SnitchTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEc2MRSnitch() throws UnknownHostException {
  InetAddress me=InetAddress.getByName("127.0.0.2");
  InetAddress com_ip=InetAddress.getByName("127.0.0.3");
  OutboundTcpConnectionPool pool=MessagingService.instance().getConnectionPool(me);
  Assert.assertEquals(me,pool.endPoint());
  pool.reset(com_ip);
  Assert.assertEquals(com_ip,pool.endPoint());
  MessagingService.instance().destroyConnectionPool(me);
  pool=MessagingService.instance().getConnectionPool(me);
  Assert.assertEquals(com_ip,pool.endPoint());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.OldNetworkTopologyStrategyTest </h4><pre class="type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMoveBeforePreviousNeighbor() throws UnknownHostException {
  int movingNodeIdx=1;
  int movingNodeIdxAfterMove=7;
  BigIntegerToken newToken=new BigIntegerToken("158873535527910577765226390751398592512");
  BigIntegerToken[] tokens=initTokens();
  BigIntegerToken[] tokensAfterMove=initTokensAfterMove(tokens,movingNodeIdx,newToken);
  Pair<Set<Range<Token>>,Set<Range<Token>>> ranges=calculateStreamAndFetchRanges(tokens,tokensAfterMove,movingNodeIdx);
  Range<Token>[] toStream=ranges.left.toArray(new Range[0]);
  Range<Token>[] toFetch=ranges.right.toArray(new Range[0]);
  Arrays.sort(toStream);
  Arrays.sort(toFetch);
  Range<Token>[] toStreamExpected=new Range[2];
  toStreamExpected[0]=new Range<Token>(getToken(movingNodeIdx,tokensAfterMove),getToken(movingNodeIdx - 1,tokensAfterMove));
  toStreamExpected[1]=new Range<Token>(getToken(movingNodeIdx - 1,tokens),getToken(movingNodeIdx,tokens));
  Arrays.sort(toStreamExpected);
  Range<Token>[] toFetchExpected=new Range[1];
  toFetchExpected[0]=new Range<Token>(getToken(movingNodeIdxAfterMove - 1,tokens),getToken(movingNodeIdxAfterMove,tokens));
  Arrays.sort(toFetchExpected);
  System.out.println("toStream : " + Arrays.toString(toStream));
  System.out.println("toFetch : " + Arrays.toString(toFetch));
  System.out.println("toStreamExpected : " + Arrays.toString(toStreamExpected));
  System.out.println("toFetchExpected : " + Arrays.toString(toFetchExpected));
  assertEquals(Arrays.equals(toStream,toStreamExpected),true);
  assertEquals(Arrays.equals(toFetch,toFetchExpected),true);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * test basic methods to move a node. For sure, it's not the best place, but it's easy to test
 * @throws java.net.UnknownHostException
 */
@Test public void testMoveLeft() throws UnknownHostException {
  int movingNodeIdx=1;
  BigIntegerToken newToken=new BigIntegerToken("21267647932558653966460912964485513216");
  BigIntegerToken[] tokens=initTokens();
  BigIntegerToken[] tokensAfterMove=initTokensAfterMove(tokens,movingNodeIdx,newToken);
  Pair<Set<Range<Token>>,Set<Range<Token>>> ranges=calculateStreamAndFetchRanges(tokens,tokensAfterMove,movingNodeIdx);
  assertEquals(ranges.left.iterator().next().left,tokensAfterMove[movingNodeIdx]);
  assertEquals(ranges.left.iterator().next().right,tokens[movingNodeIdx]);
  assertEquals("No data should be fetched",ranges.right.size(),0);
}

</code></pre>

<br>
<pre class="type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMoveAfterNextNeighbors() throws UnknownHostException {
  int movingNodeIdx=1;
  int movingNodeIdxAfterMove=2;
  BigIntegerToken newToken=new BigIntegerToken("52535295865117307932921825928971026432");
  BigIntegerToken[] tokens=initTokens();
  BigIntegerToken[] tokensAfterMove=initTokensAfterMove(tokens,movingNodeIdx,newToken);
  Pair<Set<Range<Token>>,Set<Range<Token>>> ranges=calculateStreamAndFetchRanges(tokens,tokensAfterMove,movingNodeIdx);
  Range<Token>[] toStream=ranges.left.toArray(new Range[0]);
  Range<Token>[] toFetch=ranges.right.toArray(new Range[0]);
  Arrays.sort(toStream);
  Arrays.sort(toFetch);
  Range<Token>[] toStreamExpected=new Range[1];
  toStreamExpected[0]=new Range<Token>(getToken(movingNodeIdx - 2,tokens),getToken(movingNodeIdx - 1,tokens));
  Arrays.sort(toStreamExpected);
  Range<Token>[] toFetchExpected=new Range[2];
  toFetchExpected[0]=new Range<Token>(getToken(movingNodeIdxAfterMove - 1,tokens),getToken(movingNodeIdxAfterMove,tokens));
  toFetchExpected[1]=new Range<Token>(getToken(movingNodeIdxAfterMove,tokensAfterMove),getToken(movingNodeIdx,tokensAfterMove));
  Arrays.sort(toFetchExpected);
  assertEquals(Arrays.equals(toStream,toStreamExpected),true);
  assertEquals(Arrays.equals(toFetch,toFetchExpected),true);
}

</code></pre>

<br>
<pre class="type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMoveMiddleOfRing() throws UnknownHostException {
  int movingNodeIdx=1;
  int movingNodeIdxAfterMove=4;
  BigIntegerToken newToken=new BigIntegerToken("90070591730234615865843651857942052864");
  BigIntegerToken[] tokens=initTokens();
  BigIntegerToken[] tokensAfterMove=initTokensAfterMove(tokens,movingNodeIdx,newToken);
  Pair<Set<Range<Token>>,Set<Range<Token>>> ranges=calculateStreamAndFetchRanges(tokens,tokensAfterMove,movingNodeIdx);
  Range<Token>[] toStream=ranges.left.toArray(new Range[0]);
  Range<Token>[] toFetch=ranges.right.toArray(new Range[0]);
  Arrays.sort(toStream);
  Arrays.sort(toFetch);
  Range<Token>[] toStreamExpected=new Range[2];
  toStreamExpected[0]=new Range<Token>(getToken(movingNodeIdx - 2,tokens),getToken(movingNodeIdx - 1,tokens));
  toStreamExpected[1]=new Range<Token>(getToken(movingNodeIdx - 1,tokens),getToken(movingNodeIdx,tokens));
  Arrays.sort(toStreamExpected);
  Range<Token>[] toFetchExpected=new Range[2];
  toFetchExpected[0]=new Range<Token>(getToken(movingNodeIdxAfterMove - 1,tokens),getToken(movingNodeIdxAfterMove,tokens));
  toFetchExpected[1]=new Range<Token>(getToken(movingNodeIdxAfterMove,tokensAfterMove),getToken(movingNodeIdx,tokensAfterMove));
  Arrays.sort(toFetchExpected);
  assertEquals(Arrays.equals(toStream,toStreamExpected),true);
  assertEquals(Arrays.equals(toFetch,toFetchExpected),true);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMoveRight() throws UnknownHostException {
  int movingNodeIdx=1;
  BigIntegerToken newToken=new BigIntegerToken("35267647932558653966460912964485513216");
  BigIntegerToken[] tokens=initTokens();
  BigIntegerToken[] tokensAfterMove=initTokensAfterMove(tokens,movingNodeIdx,newToken);
  Pair<Set<Range<Token>>,Set<Range<Token>>> ranges=calculateStreamAndFetchRanges(tokens,tokensAfterMove,movingNodeIdx);
  assertEquals("No data should be streamed",ranges.left.size(),0);
  assertEquals(ranges.right.iterator().next().left,tokens[movingNodeIdx]);
  assertEquals(ranges.right.iterator().next().right,tokensAfterMove[movingNodeIdx]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.SimpleStrategyTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetEndpointsDuringBootstrap() throws UnknownHostException {
  final int RING_SIZE=10;
  TokenMetadata tmd=new TokenMetadata();
  TokenMetadata oldTmd=StorageServiceAccessor.setTokenMetadata(tmd);
  Token[] endpointTokens=new Token[RING_SIZE];
  Token[] keyTokens=new Token[RING_SIZE];
  for (int i=0; i < RING_SIZE; i++) {
    endpointTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i));
    keyTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i + RING_SIZE));
  }
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  for (int i=0; i < endpointTokens.length; i++) {
    InetAddress ep=InetAddress.getByName("127.0.0." + String.valueOf(i + 1));
    tmd.updateNormalToken(endpointTokens[i],ep);
    hosts.add(ep);
  }
  Token bsToken=new BigIntegerToken(String.valueOf(210));
  InetAddress bootstrapEndpoint=InetAddress.getByName("127.0.0.11");
  tmd.addBootstrapToken(bsToken,bootstrapEndpoint);
  AbstractReplicationStrategy strategy=null;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    PendingRangeCalculatorService.calculatePendingRanges(strategy,keyspaceName);
    int replicationFactor=strategy.getReplicationFactor();
    for (int i=0; i < keyTokens.length; i++) {
      Collection<InetAddress> endpoints=tmd.getWriteEndpoints(keyTokens[i],keyspaceName,strategy.getNaturalEndpoints(keyTokens[i]));
      assertTrue(endpoints.size() >= replicationFactor);
      for (int j=0; j < replicationFactor; j++) {
        assertTrue(endpoints.contains(hosts.get((i + j + 1) % hosts.size())));
      }
      if (i < RING_SIZE - replicationFactor)       assertFalse(endpoints.contains(bootstrapEndpoint));
 else       assertTrue(endpoints.contains(bootstrapEndpoint));
    }
  }
  StorageServiceAccessor.setTokenMetadata(oldTmd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.LocalSyncTaskTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDifference() throws Throwable {
  Range<Token> range=new Range<>(partirioner.getMinimumToken(),partirioner.getRandomToken());
  UUID parentRepairSession=UUID.randomUUID();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("Standard1");
  ActiveRepairService.instance.registerParentRepairSession(parentRepairSession,Arrays.asList(cfs),Arrays.asList(range),false,System.currentTimeMillis(),false);
  RepairJobDesc desc=new RepairJobDesc(parentRepairSession,UUID.randomUUID(),KEYSPACE1,"Standard1",Arrays.asList(range));
  MerkleTrees tree1=createInitialTree(desc);
  MerkleTrees tree2=createInitialTree(desc);
  Token token=partirioner.midpoint(range.left,range.right);
  tree1.invalidate(token);
  MerkleTree.TreeRange changed=tree1.get(token);
  changed.hash("non-empty hash!".getBytes());
  Set<Range<Token>> interesting=new HashSet<>();
  interesting.add(changed);
  TreeResponse r1=new TreeResponse(InetAddress.getByName("127.0.0.1"),tree1);
  TreeResponse r2=new TreeResponse(InetAddress.getByName("127.0.0.2"),tree2);
  LocalSyncTask task=new LocalSyncTask(desc,r1,r2,ActiveRepairService.UNREPAIRED_SSTABLE);
  task.run();
  assertEquals("Wrong differing ranges",interesting.size(),task.getCurrentStat().numberOfDifferences);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * When there is no difference between two, LocalSyncTask should return stats with 0 difference.
 */
@Test public void testNoDifference() throws Throwable {
  final InetAddress ep1=InetAddress.getByName("127.0.0.1");
  final InetAddress ep2=InetAddress.getByName("127.0.0.1");
  Range<Token> range=new Range<>(partirioner.getMinimumToken(),partirioner.getRandomToken());
  RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),KEYSPACE1,"Standard1",Arrays.asList(range));
  MerkleTrees tree1=createInitialTree(desc);
  MerkleTrees tree2=createInitialTree(desc);
  TreeResponse r1=new TreeResponse(ep1,tree1);
  TreeResponse r2=new TreeResponse(ep2,tree2);
  LocalSyncTask task=new LocalSyncTask(desc,r1,r2,ActiveRepairService.UNREPAIRED_SSTABLE);
  task.run();
  assertEquals(0,task.get().numberOfDifferences);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.ValidatorTest </h4><pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidatorFailed() throws Throwable {
  Range<Token> range=new Range<>(partitioner.getMinimumToken(),partitioner.getRandomToken());
  final RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),keyspace,columnFamily,Arrays.asList(range));
  final SimpleCondition lock=new SimpleCondition();
  MessagingService.instance().addMessageSink(new IMessageSink(){
    public boolean allowOutgoingMessage(    MessageOut message,    int id,    InetAddress to){
      try {
        if (message.verb == MessagingService.Verb.REPAIR_MESSAGE) {
          RepairMessage m=(RepairMessage)message.payload;
          assertEquals(RepairMessage.Type.VALIDATION_COMPLETE,m.messageType);
          assertEquals(desc,m.desc);
          assertFalse(((ValidationComplete)m).success());
          assertNull(((ValidationComplete)m).trees);
        }
      }
  finally {
        lock.signalAll();
      }
      return false;
    }
    public boolean allowIncomingMessage(    MessageIn message,    int id){
      return false;
    }
  }
);
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  Validator validator=new Validator(desc,remote,0);
  validator.fail();
  if (!lock.isSignaled())   lock.await();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidatorComplete() throws Throwable {
  Range<Token> range=new Range<>(partitioner.getMinimumToken(),partitioner.getRandomToken());
  final RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),keyspace,columnFamily,Arrays.asList(range));
  final SimpleCondition lock=new SimpleCondition();
  MessagingService.instance().addMessageSink(new IMessageSink(){
    public boolean allowOutgoingMessage(    MessageOut message,    int id,    InetAddress to){
      try {
        if (message.verb == MessagingService.Verb.REPAIR_MESSAGE) {
          RepairMessage m=(RepairMessage)message.payload;
          assertEquals(RepairMessage.Type.VALIDATION_COMPLETE,m.messageType);
          assertEquals(desc,m.desc);
          assertTrue(((ValidationComplete)m).success());
          assertNotNull(((ValidationComplete)m).trees);
        }
      }
  finally {
        lock.signalAll();
      }
      return false;
    }
    public boolean allowIncomingMessage(    MessageIn message,    int id){
      return false;
    }
  }
);
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  ColumnFamilyStore cfs=Keyspace.open(keyspace).getColumnFamilyStore(columnFamily);
  Validator validator=new Validator(desc,remote,0);
  MerkleTrees tree=new MerkleTrees(partitioner);
  tree.addMerkleTrees((int)Math.pow(2,15),validator.desc.ranges);
  validator.prepare(cfs,tree);
  assertTrue(tree.size() > 1);
  Token mid=partitioner.midpoint(range.left,range.right);
  validator.add(EmptyIterators.unfilteredRow(cfs.metadata,new BufferDecoratedKey(mid,ByteBufferUtil.bytes("inconceivable!")),false));
  validator.complete();
  Token min=tree.partitioner().getMinimumToken();
  assertNotNull(tree.hash(new Range<>(min,min)));
  if (!lock.isSignaled())   lock.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.messages.RepairOptionTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseOptions(){
  IPartitioner partitioner=Murmur3Partitioner.instance;
  Token.TokenFactory tokenFactory=partitioner.getTokenFactory();
  RepairOption option=RepairOption.parse(new HashMap<String,String>(),partitioner);
  if (FBUtilities.isWindows() && (DatabaseDescriptor.getDiskAccessMode() != Config.DiskAccessMode.standard || DatabaseDescriptor.getIndexAccessMode() != Config.DiskAccessMode.standard))   assertTrue(option.getParallelism() == RepairParallelism.PARALLEL);
 else   assertTrue(option.getParallelism() == RepairParallelism.SEQUENTIAL);
  assertFalse(option.isPrimaryRange());
  assertFalse(option.isIncremental());
  Map<String,String> options=new HashMap<>();
  options.put(RepairOption.PARALLELISM_KEY,"parallel");
  options.put(RepairOption.PRIMARY_RANGE_KEY,"false");
  options.put(RepairOption.INCREMENTAL_KEY,"false");
  options.put(RepairOption.RANGES_KEY,"0:10,11:20,21:30");
  options.put(RepairOption.COLUMNFAMILIES_KEY,"cf1,cf2,cf3");
  options.put(RepairOption.DATACENTERS_KEY,"dc1,dc2,dc3");
  options.put(RepairOption.HOSTS_KEY,"127.0.0.1,127.0.0.2,127.0.0.3");
  option=RepairOption.parse(options,partitioner);
  assertTrue(option.getParallelism() == RepairParallelism.PARALLEL);
  assertFalse(option.isPrimaryRange());
  assertFalse(option.isIncremental());
  Set<Range<Token>> expectedRanges=new HashSet<>(3);
  expectedRanges.add(new Range<>(tokenFactory.fromString("0"),tokenFactory.fromString("10")));
  expectedRanges.add(new Range<>(tokenFactory.fromString("11"),tokenFactory.fromString("20")));
  expectedRanges.add(new Range<>(tokenFactory.fromString("21"),tokenFactory.fromString("30")));
  assertEquals(expectedRanges,option.getRanges());
  Set<String> expectedCFs=new HashSet<>(3);
  expectedCFs.add("cf1");
  expectedCFs.add("cf2");
  expectedCFs.add("cf3");
  assertEquals(expectedCFs,option.getColumnFamilies());
  Set<String> expectedDCs=new HashSet<>(3);
  expectedDCs.add("dc1");
  expectedDCs.add("dc2");
  expectedDCs.add("dc3");
  assertEquals(expectedDCs,option.getDataCenters());
  Set<String> expectedHosts=new HashSet<>(3);
  expectedHosts.add("127.0.0.1");
  expectedHosts.add("127.0.0.2");
  expectedHosts.add("127.0.0.3");
  assertEquals(expectedHosts,option.getHosts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.DefsTest </h4><pre class="type-7 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies values related to public fields.
"></span><br>
@Test public void dropKSUnflushed() throws ConfigurationException {
  final KeyspaceMetadata ks=Schema.instance.getKSMetaData(KEYSPACE3);
  assertNotNull(ks);
  final CFMetaData cfm=ks.tables.getNullable(TABLE1);
  assertNotNull(cfm);
  for (int i=0; i < 100; i++)   QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)",KEYSPACE3,TABLE1),"dropKs","col" + i,"anyvalue");
  MigrationManager.announceKeyspaceDrop(ks.name);
  assertNull(Schema.instance.getKSMetaData(ks.name));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testDropIndex() throws ConfigurationException {
  SchemaKeyspace.makeCreateKeyspaceMutation(Schema.instance.getKSMetaData(KEYSPACE6),FBUtilities.timestampMicros()).applyUnsafe();
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE6).getColumnFamilyStore(TABLE1i);
  String indexName="birthdate_key_index";
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, c1, birthdate, notbirthdate) VALUES (?, ?, ?, ?)",KEYSPACE6,TABLE1i),"key0","col0",1L,1L);
  cfs.forceBlockingFlush();
  ColumnFamilyStore indexCfs=cfs.indexManager.getIndexByName(indexName).getBackingTable().orElseThrow(throwAssert("Cannot access index cfs"));
  Descriptor desc=indexCfs.getLiveSSTables().iterator().next().descriptor;
  CFMetaData meta=cfs.metadata.copy();
  IndexMetadata existing=cfs.metadata.getIndexes().get(indexName).orElseThrow(throwAssert("Index not found"));
  meta.indexes(meta.getIndexes().without(existing.name));
  MigrationManager.announceColumnFamilyUpdate(meta,false);
  assertTrue(cfs.indexManager.listIndexes().isEmpty());
  LifecycleTransaction.waitForDeletions();
  assertFalse(new File(desc.filenameFor(Component.DATA)).exists());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNewTable() throws ConfigurationException {
  final String ksName=KEYSPACE1;
  final String tableName="anewtable";
  KeyspaceMetadata original=Schema.instance.getKSMetaData(ksName);
  CFMetaData cfm=addTestTable(original.name,tableName,"A New Table");
  assertFalse(Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).isPresent());
  MigrationManager.announceNewColumnFamily(cfm);
  assertTrue(Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).isPresent());
  assertEquals(cfm,Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).get());
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, col, val) VALUES (?, ?, ?)",ksName,tableName),"key0","col0","val0");
  ColumnFamilyStore cfs=Keyspace.open(ksName).getColumnFamilyStore(tableName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s",ksName,tableName));
  assertRows(rows,row("key0","col0","val0"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropKS() throws ConfigurationException {
  final KeyspaceMetadata ks=Schema.instance.getKSMetaData(KEYSPACE1);
  assertNotNull(ks);
  final CFMetaData cfm=ks.tables.getNullable(TABLE2);
  assertNotNull(cfm);
  for (int i=0; i < 100; i++)   QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)",KEYSPACE1,TABLE2),"dropKs","col" + i,"anyvalue");
  ColumnFamilyStore cfs=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  assertTrue(!cfs.getDirectories().sstableLister(Directories.OnTxnErr.THROW).list().isEmpty());
  MigrationManager.announceKeyspaceDrop(ks.name);
  assertNull(Schema.instance.getKSMetaData(ks.name));
  boolean success=true;
  try {
    QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)",KEYSPACE1,TABLE2),"dropKs","col0","anyvalue");
  }
 catch (  Throwable th) {
    success=false;
  }
  assertFalse("This mutation should have failed since the KS no longer exists.",success);
  boolean threw=false;
  try {
    Keyspace.open(ks.name);
  }
 catch (  Throwable th) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNewKS() throws ConfigurationException {
  CFMetaData cfm=addTestTable("newkeyspace1","newstandard1","A new cf for a new ks");
  KeyspaceMetadata newKs=KeyspaceMetadata.create(cfm.ksName,KeyspaceParams.simple(5),Tables.of(cfm));
  MigrationManager.announceNewKeyspace(newKs);
  assertNotNull(Schema.instance.getKSMetaData(cfm.ksName));
  assertEquals(Schema.instance.getKSMetaData(cfm.ksName),newKs);
  QueryProcessor.executeInternal("INSERT INTO newkeyspace1.newstandard1 (key, col, val) VALUES (?, ?, ?)","key0","col0","val0");
  ColumnFamilyStore store=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfName);
  assertNotNull(store);
  store.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal("SELECT * FROM newkeyspace1.newstandard1");
  assertRows(rows,row("key0","col0","val0"));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createEmptyKsAddNewCf() throws ConfigurationException {
  assertNull(Schema.instance.getKSMetaData(EMPTY_KEYSPACE));
  KeyspaceMetadata newKs=KeyspaceMetadata.create(EMPTY_KEYSPACE,KeyspaceParams.simple(5));
  MigrationManager.announceNewKeyspace(newKs);
  assertNotNull(Schema.instance.getKSMetaData(EMPTY_KEYSPACE));
  String tableName="added_later";
  CFMetaData newCf=addTestTable(EMPTY_KEYSPACE,tableName,"A new CF to add to an empty KS");
  assertFalse(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).isPresent());
  MigrationManager.announceNewColumnFamily(newCf);
  assertTrue(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).isPresent());
  assertEquals(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).get(),newCf);
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, col, val) VALUES (?, ?, ?)",EMPTY_KEYSPACE,tableName),"key0","col0","val0");
  ColumnFamilyStore cfs=Keyspace.open(newKs.name).getColumnFamilyStore(newCf.cfName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s",EMPTY_KEYSPACE,tableName));
  assertRows(rows,row("key0","col0","val0"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCFMetaDataApply() throws ConfigurationException {
  CFMetaData cfm=CFMetaData.Builder.create(KEYSPACE1,"TestApplyCFM_CF").addPartitionKey("keys",BytesType.instance).addClusteringColumn("col",BytesType.instance).build();
  for (int i=0; i < 5; i++) {
    ByteBuffer name=ByteBuffer.wrap(new byte[]{(byte)i});
    cfm.addColumnDefinition(ColumnDefinition.regularDef(cfm,name,BytesType.instance));
  }
  cfm.comment("No comment").readRepairChance(0.5).gcGraceSeconds(100000).compaction(CompactionParams.scts(ImmutableMap.of("min_threshold","500","max_threshold","500")));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
  CFMetaData cfNew=cfm.copy();
  ColumnDefinition addIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{5}),BytesType.instance);
  cfNew.addColumnDefinition(addIndexDef);
  ColumnDefinition removeIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{0}),BytesType.instance);
  assertTrue(cfNew.removeColumnDefinition(removeIndexDef));
  cfm.apply(cfNew);
  for (int i=1; i < cfm.allColumns().size(); i++)   assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{1})));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{0})));
  assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateKeyspace() throws ConfigurationException {
  CFMetaData cf=addTestTable("UpdatedKeyspace","AddedStandard1","A new cf for a new ks");
  KeyspaceMetadata oldKs=KeyspaceMetadata.create(cf.ksName,KeyspaceParams.simple(5),Tables.of(cf));
  MigrationManager.announceNewKeyspace(oldKs);
  assertNotNull(Schema.instance.getKSMetaData(cf.ksName));
  assertEquals(Schema.instance.getKSMetaData(cf.ksName),oldKs);
  KeyspaceMetadata newBadKs2=KeyspaceMetadata.create(cf.ksName + "trash",KeyspaceParams.simple(4));
  try {
    MigrationManager.announceKeyspaceUpdate(newBadKs2);
    throw new AssertionError("Should not have been able to update a KS with an invalid KS name.");
  }
 catch (  ConfigurationException ex) {
  }
  Map<String,String> replicationMap=new HashMap<>();
  replicationMap.put(ReplicationParams.CLASS,OldNetworkTopologyStrategy.class.getName());
  replicationMap.put("replication_factor","1");
  KeyspaceMetadata newKs=KeyspaceMetadata.create(cf.ksName,KeyspaceParams.create(true,replicationMap));
  MigrationManager.announceKeyspaceUpdate(newKs);
  KeyspaceMetadata newFetchedKs=Schema.instance.getKSMetaData(newKs.name);
  assertEquals(newFetchedKs.params.replication.klass,newKs.params.replication.klass);
  assertFalse(newFetchedKs.params.replication.klass.equals(oldKs.params.replication.klass));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.SchemaKeyspaceTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThriftConversion() throws Exception {
  CfDef cfDef=new CfDef().setDefault_validation_class(AsciiType.class.getCanonicalName()).setComment("Test comment").setColumn_metadata(columnDefs).setKeyspace(KEYSPACE1).setName(CF_STANDARD1);
  CFMetaData cfMetaData=ThriftConversion.fromThrift(cfDef);
  CfDef thriftCfDef=new CfDef();
  thriftCfDef.keyspace=KEYSPACE1;
  thriftCfDef.name=CF_STANDARD1;
  thriftCfDef.default_validation_class=cfDef.default_validation_class;
  thriftCfDef.comment=cfDef.comment;
  thriftCfDef.column_metadata=new ArrayList<>();
  for (  ColumnDef columnDef : columnDefs) {
    ColumnDef c=new ColumnDef();
    c.name=ByteBufferUtil.clone(columnDef.name);
    c.validation_class=columnDef.getValidation_class();
    c.index_name=columnDef.getIndex_name();
    c.index_type=IndexType.KEYS;
    thriftCfDef.column_metadata.add(c);
  }
  CfDef converted=ThriftConversion.toThrift(cfMetaData);
  assertEquals(thriftCfDef.keyspace,converted.keyspace);
  assertEquals(thriftCfDef.name,converted.name);
  assertEquals(thriftCfDef.default_validation_class,converted.default_validation_class);
  assertEquals(thriftCfDef.comment,converted.comment);
  assertEquals(new HashSet<>(thriftCfDef.column_metadata),new HashSet<>(converted.column_metadata));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtensions() throws IOException {
  String keyspace="SandBox";
  createTable(keyspace,"CREATE TABLE test (a text primary key, b int, c int)");
  CFMetaData metadata=Schema.instance.getCFMetaData(keyspace,"test");
  assertTrue("extensions should be empty",metadata.params.extensions.isEmpty());
  ImmutableMap<String,ByteBuffer> extensions=ImmutableMap.of("From ... with Love",ByteBuffer.wrap(new byte[]{0,0,7}));
  CFMetaData copy=metadata.copy().extensions(extensions);
  updateTable(keyspace,metadata,copy);
  metadata=Schema.instance.getCFMetaData(keyspace,"test");
  assertEquals(extensions,metadata.params.extensions);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.security.CipherFactoryTest </h4><pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void roundTrip() throws IOException, BadPaddingException, IllegalBlockSizeException {
  Cipher encryptor=cipherFactory.getEncryptor(encryptionOptions.cipher,encryptionOptions.key_alias);
  byte[] original=ULYSSEUS.getBytes(Charsets.UTF_8);
  byte[] encrypted=encryptor.doFinal(original);
  Cipher decryptor=cipherFactory.getDecryptor(encryptionOptions.cipher,encryptionOptions.key_alias,encryptor.getIV());
  byte[] decrypted=decryptor.doFinal(encrypted);
  Assert.assertEquals(ULYSSEUS,new String(decrypted,Charsets.UTF_8));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.security.EncryptionUtilsTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void compress() throws IOException {
  byte[] buf=new byte[(1 << 13) - 13];
  random.nextBytes(buf);
  ByteBuffer compressedBuffer=EncryptionUtils.compress(ByteBuffer.wrap(buf),ByteBuffer.allocate(0),true,compressor);
  ByteBuffer uncompressedBuffer=EncryptionUtils.uncompress(compressedBuffer,ByteBuffer.allocate(0),true,compressor);
  Assert.assertArrayEquals(buf,uncompressedBuffer.array());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void fullRoundTrip() throws IOException, BadPaddingException, ShortBufferException, IllegalBlockSizeException {
  byte[] buf=new byte[(1 << 12) - 7];
  random.nextBytes(buf);
  ByteBuffer compressedBuffer=EncryptionUtils.compress(ByteBuffer.wrap(buf),ByteBuffer.allocate(0),true,compressor);
  CipherFactory cipherFactory=new CipherFactory(tdeOptions);
  Cipher encryptor=cipherFactory.getEncryptor(tdeOptions.cipher,tdeOptions.key_alias);
  File f=File.createTempFile("commitlog-enc-utils-",".tmp");
  f.deleteOnExit();
  FileChannel channel=new RandomAccessFile(f,"rw").getChannel();
  EncryptionUtils.encryptAndWrite(compressedBuffer,channel,true,encryptor);
  Cipher decryptor=cipherFactory.getDecryptor(tdeOptions.cipher,tdeOptions.key_alias,encryptor.getIV());
  ByteBuffer decryptedBuffer=EncryptionUtils.decrypt(RandomAccessReader.open(f),ByteBuffer.allocate(0),true,decryptor);
  ByteBuffer uncompressedBuffer=EncryptionUtils.uncompress(decryptedBuffer,ByteBuffer.allocate(0),true,compressor);
  Assert.assertArrayEquals(buf,uncompressedBuffer.array());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.ActiveRepairServiceTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNeighborsTimesTwoInLocalDC() throws Throwable {
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  addTokens(2 * Keyspace.open(KEYSPACE5).getReplicationStrategy().getReplicationFactor());
  AbstractReplicationStrategy ars=Keyspace.open(KEYSPACE5).getReplicationStrategy();
  Set<InetAddress> expected=new HashSet<>();
  for (  Range<Token> replicaRange : ars.getAddressRanges().get(FBUtilities.getBroadcastAddress())) {
    expected.addAll(ars.getRangeAddresses(tmd.cloneOnlyTokenMap()).get(replicaRange));
  }
  expected.remove(FBUtilities.getBroadcastAddress());
  TokenMetadata.Topology topology=tmd.cloneOnlyTokenMap().getTopology();
  HashSet<InetAddress> localEndpoints=Sets.newHashSet(topology.getDatacenterEndpoints().get(DatabaseDescriptor.getLocalDataCenter()));
  expected=Sets.intersection(expected,localEndpoints);
  Collection<Range<Token>> ranges=StorageService.instance.getLocalRanges(KEYSPACE5);
  Set<InetAddress> neighbors=new HashSet<>();
  for (  Range<Token> range : ranges) {
    neighbors.addAll(ActiveRepairService.getNeighbors(KEYSPACE5,range,Arrays.asList(DatabaseDescriptor.getLocalDataCenter()),null));
  }
  assertEquals(expected,neighbors);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNeighborsPlusOneInLocalDC() throws Throwable {
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  Set<InetAddress> expected=addTokens(1 + Keyspace.open(KEYSPACE5).getReplicationStrategy().getReplicationFactor());
  expected.remove(FBUtilities.getBroadcastAddress());
  TokenMetadata.Topology topology=tmd.cloneOnlyTokenMap().getTopology();
  HashSet<InetAddress> localEndpoints=Sets.newHashSet(topology.getDatacenterEndpoints().get(DatabaseDescriptor.getLocalDataCenter()));
  expected=Sets.intersection(expected,localEndpoints);
  Collection<Range<Token>> ranges=StorageService.instance.getLocalRanges(KEYSPACE5);
  Set<InetAddress> neighbors=new HashSet<>();
  for (  Range<Token> range : ranges) {
    neighbors.addAll(ActiveRepairService.getNeighbors(KEYSPACE5,range,Arrays.asList(DatabaseDescriptor.getLocalDataCenter()),null));
  }
  assertEquals(expected,neighbors);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNeighborsPlusOne() throws Throwable {
  Set<InetAddress> expected=addTokens(1 + Keyspace.open(KEYSPACE5).getReplicationStrategy().getReplicationFactor());
  expected.remove(FBUtilities.getBroadcastAddress());
  Collection<Range<Token>> ranges=StorageService.instance.getLocalRanges(KEYSPACE5);
  Set<InetAddress> neighbors=new HashSet<>();
  for (  Range<Token> range : ranges) {
    neighbors.addAll(ActiveRepairService.getNeighbors(KEYSPACE5,range,null,null));
  }
  assertEquals(expected,neighbors);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNeighborsTimesTwoInSpecifiedHosts() throws Throwable {
  TokenMetadata tmd=StorageService.instance.getTokenMetadata();
  addTokens(2 * Keyspace.open(KEYSPACE5).getReplicationStrategy().getReplicationFactor());
  AbstractReplicationStrategy ars=Keyspace.open(KEYSPACE5).getReplicationStrategy();
  List<InetAddress> expected=new ArrayList<>();
  for (  Range<Token> replicaRange : ars.getAddressRanges().get(FBUtilities.getBroadcastAddress())) {
    expected.addAll(ars.getRangeAddresses(tmd.cloneOnlyTokenMap()).get(replicaRange));
  }
  expected.remove(FBUtilities.getBroadcastAddress());
  Collection<String> hosts=Arrays.asList(FBUtilities.getBroadcastAddress().getCanonicalHostName(),expected.get(0).getCanonicalHostName());
  assertEquals(expected.get(0),ActiveRepairService.getNeighbors(KEYSPACE5,StorageService.instance.getLocalRanges(KEYSPACE5).iterator().next(),null,hosts).iterator().next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.DataResolverTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveDeletedCollection(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  builder.addComplexDeletion(m,new DeletionTime(ts[0] - 1,nowInSec));
  builder.addCell(mapCell(0,0,ts[0]));
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[1] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  try (PartitionIterator data=resolver.resolve()){
    assertFalse(data.hasNext());
  }
   MessageOut<Mutation> msg;
  msg=getSentMessage(peer1);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Collections.emptySet(),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
  Assert.assertNull(messageRecorder.sent.get(peer2));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveNewCollectionOverwritingDeleted(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  builder.addComplexDeletion(m,new DeletionTime(ts[0] - 1,nowInSec));
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[1] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  Cell expectedCell=mapCell(1,1,ts[1]);
  builder.addCell(expectedCell);
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  try (PartitionIterator data=resolver.resolve();RowIterator rows=Iterators.getOnlyElement(data)){
    Row row=Iterators.getOnlyElement(rows);
    assertColumns(row,"m");
    ComplexColumnData cd=row.getComplexColumnData(m);
    assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  }
   MessageOut<Mutation> msg;
  msg=getSentMessage(peer1);
  Row row=Iterators.getOnlyElement(msg.payload.getPartitionUpdate(cfm2.cfId).iterator());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
  Assert.assertNull(messageRecorder.sent.get(peer2));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveNewCollection(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[0] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  Cell expectedCell=mapCell(0,0,ts[0]);
  builder.addCell(expectedCell);
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.emptyUpdate(cfm2,dk))));
  try (PartitionIterator data=resolver.resolve();RowIterator rows=Iterators.getOnlyElement(data)){
    Row row=Iterators.getOnlyElement(rows);
    assertColumns(row,"m");
    ComplexColumnData cd=row.getComplexColumnData(m);
    assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  }
   Assert.assertNull(messageRecorder.sent.get(peer1));
  MessageOut<Mutation> msg;
  msg=getSentMessage(peer2);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Sets.newHashSet(expectedCell),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveComplexDelete(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  builder.addComplexDeletion(m,new DeletionTime(ts[0] - 1,nowInSec));
  builder.addCell(mapCell(0,0,ts[0]));
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[1] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  Cell expectedCell=mapCell(1,1,ts[1]);
  builder.addCell(expectedCell);
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  try (PartitionIterator data=resolver.resolve();RowIterator rows=Iterators.getOnlyElement(data)){
    Row row=Iterators.getOnlyElement(rows);
    assertColumns(row,"m");
    Assert.assertNull(row.getCell(m,CellPath.create(bb(0))));
    Assert.assertNotNull(row.getCell(m,CellPath.create(bb(1))));
  }
   MessageOut<Mutation> msg;
  msg=getSentMessage(peer1);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
  Assert.assertNull(messageRecorder.sent.get(peer2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.LeaveAndBootstrapTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test pending ranges and write endpoints when multiple nodes are on the move
 * simultaneously
 */
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] LEAVING=new int[]{6,8,9};
  for (  int leaving : LEAVING)   ss.onChange(hosts.get(leaving),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(leaving))));
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  Collection<InetAddress> endpoints=null;
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("LeaveAndBootstrapTestKeyspace" + i,getStrategy("LeaveAndBootstrapTestKeyspace" + i,tmd));
  }
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(KEYSPACE1,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.1.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.put(KEYSPACE4,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.1","127.0.0.2","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(7,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
  ss.onChange(hosts.get(LEAVING[0]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[0])),Gossiper.computeExpireTime()));
  ss.onChange(hosts.get(LEAVING[2]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[2])),Gossiper.computeExpireTime()));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(5))));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("15")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("25")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.2","127.0.0.7"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether write endpoints is correct when the node is leaving. Uses
 * StorageService.onChange and does not manipulate token metadata directly.
 */
@Test public void newTestWriteEndpointsDuringLeave() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=6;
  final int LEAVING_NODE=3;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  Map<Token,List<InetAddress>> expectedEndpoints=new HashMap<Token,List<InetAddress>>();
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    Token token : keyTokens) {
      List<InetAddress> endpoints=new ArrayList<InetAddress>();
      Iterator<Token> tokenIter=TokenMetadata.ringIterator(tmd.sortedTokens(),token,false);
      while (tokenIter.hasNext()) {
        endpoints.add(tmd.getEndpoint(tokenIter.next()));
      }
      expectedEndpoints.put(token,endpoints);
    }
  }
  ss.onChange(hosts.get(LEAVING_NODE),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(LEAVING_NODE))));
  assertTrue(tmd.isLeaving(hosts.get(LEAVING_NODE)));
  Thread.sleep(100);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  AbstractReplicationStrategy strategy;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    for (    Token token : keyTokens) {
      int replicationFactor=strategy.getReplicationFactor();
      HashSet<InetAddress> actual=new HashSet<InetAddress>(tmd.getWriteEndpoints(token,keyspaceName,strategy.calculateNaturalEndpoints(token,tmd.cloneOnlyTokenMap())));
      HashSet<InetAddress> expected=new HashSet<InetAddress>();
      for (int i=0; i < replicationFactor; i++) {
        expected.add(expectedEndpoints.get(token).get(i));
      }
      if (expected.contains(hosts.get(LEAVING_NODE)))       expected.add(expectedEndpoints.get(token).get(replicationFactor));
      assertEquals("mismatched endpoint sets",expected,actual);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the system.peers table is not updated after a node has been removed. (See CASSANDRA-6053)
 */
@Test public void testStateChangeOnRemovedNode() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  Util.createInitialRing(ss,partitioner,endpointTokens,new ArrayList<Token>(),hosts,new ArrayList<UUID>(),2);
  InetAddress toRemove=hosts.get(1);
  SystemKeyspace.updatePeerInfo(toRemove,"data_center","dc42");
  SystemKeyspace.updatePeerInfo(toRemove,"rack","rack42");
  assertEquals("rack42",SystemKeyspace.loadDcRackInfo().get(toRemove).get("rack"));
  Gossiper.instance.injectApplicationState(toRemove,ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(1)),Gossiper.computeExpireTime()));
  assertTrue(Gossiper.instance.isDeadState(Gossiper.instance.getEndpointStateForEndpoint(hosts.get(1))));
  ss.onChange(hosts.get(1),ApplicationState.RACK,valueFactory.rack("rack9999"));
  assertEquals("rack42",SystemKeyspace.loadDcRackInfo().get(toRemove).get("rack"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.MoveTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void newTestWriteEndpointsDuringMove() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  final int MOVING_NODE=3;
  TokenMetadata tmd=ss.getTokenMetadata();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  Map<Token,List<InetAddress>> expectedEndpoints=new HashMap<Token,List<InetAddress>>();
  for (  Token token : keyTokens) {
    List<InetAddress> endpoints=new ArrayList<InetAddress>();
    Iterator<Token> tokenIter=TokenMetadata.ringIterator(tmd.sortedTokens(),token,false);
    while (tokenIter.hasNext()) {
      endpoints.add(tmd.getEndpoint(tokenIter.next()));
    }
    expectedEndpoints.put(token,endpoints);
  }
  Token newToken=positionToken(MOVING_NODE);
  ss.onChange(hosts.get(MOVING_NODE),ApplicationState.STATUS,valueFactory.moving(newToken));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  assertTrue(tmd.isMoving(hosts.get(MOVING_NODE)));
  AbstractReplicationStrategy strategy;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    if (strategy instanceof NetworkTopologyStrategy)     continue;
    int numMoved=0;
    for (    Token token : keyTokens) {
      int replicationFactor=strategy.getReplicationFactor();
      HashSet<InetAddress> actual=new HashSet<InetAddress>(tmd.getWriteEndpoints(token,keyspaceName,strategy.calculateNaturalEndpoints(token,tmd.cloneOnlyTokenMap())));
      HashSet<InetAddress> expected=new HashSet<InetAddress>();
      for (int i=0; i < replicationFactor; i++) {
        expected.add(expectedEndpoints.get(token).get(i));
      }
      if (expected.size() == actual.size()) {
        assertEquals("mismatched endpoint sets",expected,actual);
      }
 else {
        expected.add(hosts.get(MOVING_NODE));
        assertEquals("mismatched endpoint sets",expected,actual);
        numMoved++;
      }
    }
    assertEquals("mismatched number of moved token",1,numMoved);
  }
  ss.onChange(hosts.get(MOVING_NODE),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newToken)));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] MOVING=new int[]{6,8,9};
  Map<Integer,Token> newTokens=new HashMap<Integer,Token>();
  for (  int movingIndex : MOVING) {
    Token newToken=positionToken(movingIndex);
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.moving(newToken));
    newTokens.put(movingIndex,newToken);
  }
  Collection<InetAddress> endpoints;
  tmd=tmd.cloneAfterAllSettled();
  ss.setTokenMetadataUnsafe(tmd);
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("MoveTestKeyspace" + i,getStrategy("MoveTestKeyspace" + i,tmd));
  }
  Multimap<InetAddress,Range<Token>> keyspace1ranges=keyspaceStrategyMap.get(Simple_RF1_KeyspaceName).getAddressRanges();
  Collection<Range<Token>> ranges1=keyspace1ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(1,collectionSize(ranges1));
  assertEquals(generateRange(97,0),ranges1.iterator().next());
  Collection<Range<Token>> ranges2=keyspace1ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(1,collectionSize(ranges2));
  assertEquals(generateRange(0,10),ranges2.iterator().next());
  Collection<Range<Token>> ranges3=keyspace1ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(1,collectionSize(ranges3));
  assertEquals(generateRange(10,20),ranges3.iterator().next());
  Collection<Range<Token>> ranges4=keyspace1ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(1,collectionSize(ranges4));
  assertEquals(generateRange(20,30),ranges4.iterator().next());
  Collection<Range<Token>> ranges5=keyspace1ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(1,collectionSize(ranges5));
  assertEquals(generateRange(30,40),ranges5.iterator().next());
  Collection<Range<Token>> ranges6=keyspace1ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(1,collectionSize(ranges6));
  assertEquals(generateRange(40,50),ranges6.iterator().next());
  Collection<Range<Token>> ranges7=keyspace1ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(1,collectionSize(ranges7));
  assertEquals(generateRange(50,67),ranges7.iterator().next());
  Collection<Range<Token>> ranges8=keyspace1ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(1,collectionSize(ranges8));
  assertEquals(generateRange(67,70),ranges8.iterator().next());
  Collection<Range<Token>> ranges9=keyspace1ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(1,collectionSize(ranges9));
  assertEquals(generateRange(70,87),ranges9.iterator().next());
  Collection<Range<Token>> ranges10=keyspace1ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(1,collectionSize(ranges10));
  assertEquals(generateRange(87,97),ranges10.iterator().next());
  Multimap<InetAddress,Range<Token>> keyspace3ranges=keyspaceStrategyMap.get(KEYSPACE3).getAddressRanges();
  ranges1=keyspace3ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),5);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,50,67,87,97,67,70)));
  ranges2=keyspace3ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),5);
  assertTrue(ranges2.equals(generateRanges(97,0,70,87,87,97,0,10,67,70)));
  ranges3=keyspace3ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),5);
  assertTrue(ranges3.equals(generateRanges(97,0,70,87,87,97,0,10,10,20)));
  ranges4=keyspace3ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),5);
  assertTrue(ranges4.equals(generateRanges(97,0,20,30,87,97,0,10,10,20)));
  ranges5=keyspace3ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),5);
  assertTrue(ranges5.equals(generateRanges(97,0,30,40,20,30,0,10,10,20)));
  ranges6=keyspace3ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),5);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30,0,10,10,20)));
  ranges7=keyspace3ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),5);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67,20,30,10,20)));
  ranges8=keyspace3ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),5);
  assertTrue(ranges8.equals(generateRanges(40,50,30,40,50,67,20,30,67,70)));
  ranges9=keyspace3ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),5);
  assertTrue(ranges9.equals(generateRanges(40,50,70,87,30,40,50,67,67,70)));
  ranges10=keyspace3ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),5);
  assertTrue(ranges10.equals(generateRanges(40,50,70,87,50,67,87,97,67,70)));
  Multimap<InetAddress,Range<Token>> keyspace4ranges=keyspaceStrategyMap.get(Simple_RF3_KeyspaceName).getAddressRanges();
  ranges1=keyspace4ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),3);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,87,97)));
  ranges2=keyspace4ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),3);
  assertTrue(ranges2.equals(generateRanges(97,0,87,97,0,10)));
  ranges3=keyspace4ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),3);
  assertTrue(ranges3.equals(generateRanges(97,0,0,10,10,20)));
  ranges4=keyspace4ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),3);
  assertTrue(ranges4.equals(generateRanges(20,30,0,10,10,20)));
  ranges5=keyspace4ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),3);
  assertTrue(ranges5.equals(generateRanges(30,40,20,30,10,20)));
  ranges6=keyspace4ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),3);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30)));
  ranges7=keyspace4ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),3);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67)));
  ranges8=keyspace4ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),3);
  assertTrue(ranges8.equals(generateRanges(40,50,50,67,67,70)));
  ranges9=keyspace4ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),3);
  assertTrue(ranges9.equals(generateRanges(70,87,50,67,67,70)));
  ranges10=keyspace4ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),3);
  assertTrue(ranges10.equals(generateRanges(70,87,87,97,67,70)));
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(Simple_RF1_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.put(Simple_RF3_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2"));
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (    Token token : keyTokens) {
      endpoints=tmd.getWriteEndpoints(token,keyspaceName,strategy.getNaturalEndpoints(token));
      assertEquals(expectedEndpoints.get(keyspaceName).get(token).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(token).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
  }
  for (  Integer movingIndex : MOVING) {
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newTokens.get(movingIndex))));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StorageServiceServerTest </h4><pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithVnodes() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  Multimap<InetAddress,Token> dc1=HashMultimap.create();
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("A"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("E"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("H"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("C"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("I"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("J"));
  metadata.updateNormalTokens(dc1);
  Multimap<InetAddress,Token> dc2=HashMultimap.create();
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("B"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("G"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("L"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("D"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("F"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("K"));
  metadata.updateNormalTokens(dc2);
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC1","1");
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertEquals(8,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("J"),new StringToken("K"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("K"),new StringToken("L"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("L"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("E"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("E"),new StringToken("F"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("F"),new StringToken("G"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("G"),new StringToken("H"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertEquals(4,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("H"),new StringToken("I"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("I"),new StringToken("J"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertEquals(4,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("F"),new StringToken("G"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("K"),new StringToken("L"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("L"),new StringToken("A"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertTrue(primaryRanges.size() == 8);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("E"),new StringToken("F"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("J"),new StringToken("K"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("E"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("G"),new StringToken("H"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("H"),new StringToken("I"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("I"),new StringToken("J"))));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithNetworkTopologyStrategy() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC1","1");
  configOptions.put("DC2","1");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithNetworkTopologyStrategyOneDCOnly() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertTrue(primaryRanges.isEmpty());
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertTrue(primaryRanges.isEmpty());
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertTrue(primaryRanges.size() == 2);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertTrue(primaryRanges.size() == 2);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamTransferTaskTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScheduleTimeout() throws Exception {
  String ks=KEYSPACE1;
  String cf="Standard1";
  InetAddress peer=FBUtilities.getBroadcastAddress();
  StreamSession session=new StreamSession(peer,peer,null,0,true,false);
  ColumnFamilyStore cfs=Keyspace.open(ks).getColumnFamilyStore(cf);
  for (int i=0; i < 2; i++) {
    SchemaLoader.insertData(ks,cf,i,1);
    cfs.forceBlockingFlush();
  }
  StreamTransferTask task=new StreamTransferTask(session,cfs.metadata.cfId);
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    List<Range<Token>> ranges=new ArrayList<>();
    ranges.add(new Range<>(sstable.first.getToken(),sstable.last.getToken()));
    task.addTransferFile(sstable.selfRef(),1,sstable.getPositionsForRanges(ranges),0);
  }
  assertEquals(2,task.getTotalNumberOfFiles());
  Future f=task.scheduleTimeout(0,0,TimeUnit.NANOSECONDS);
  f.get();
  f=task.scheduleTimeout(1,10,TimeUnit.MILLISECONDS);
  task.complete(1);
  try {
    f.get();
    Assert.assertTrue(false);
  }
 catch (  CancellationException ex) {
  }
  assertEquals(StreamSession.State.WAIT_COMPLETE,session.state());
  assertNull(task.scheduleTimeout(1,1,TimeUnit.SECONDS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamingTransferTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to make sure RangeTombstones at column index boundary transferred correctly.
 */
@Test public void testTransferRangeTombstones() throws Exception {
  String ks=KEYSPACE1;
  String cfname="StandardInteger1";
  Keyspace keyspace=Keyspace.open(ks);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  ClusteringComparator comparator=cfs.getComparator();
  String key="key1";
  RowUpdateBuilder updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros(),key);
  updates.clustering(1).add("val",ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize() - 64])).build().apply();
  updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros(),key);
  updates.clustering(6).add("val",ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize()])).build().apply();
  updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros() + 1,key);
  updates.addRangeTombstone(Slice.make(comparator.make(5),comparator.make(7))).build().apply();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  cfs.clearUnsafe();
  transferSSTables(sstable);
  assertEquals(1,cfs.getLiveSSTables().size());
  Row r=Util.getOnlyRow(Util.cmd(cfs).build());
  Assert.assertFalse(r.isEmpty());
  Assert.assertTrue(1 == Int32Type.instance.compose(r.clustering().get(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.SerDeserTest </h4><pre class="type-7 type-14 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void preparedMetadataSerializationTest(){
  List<ColumnSpecification> columnNames=new ArrayList<>();
  for (int i=0; i < 3; i++)   columnNames.add(new ColumnSpecification("ks","cf",new ColumnIdentifier("col" + i,false),Int32Type.instance));
  ResultSet.PreparedMetadata meta=new ResultSet.PreparedMetadata(columnNames,new Short[]{2,1});
  ByteBuf buf=Unpooled.buffer(meta.codec.encodedSize(meta,Server.VERSION_4));
  meta.codec.encode(meta,buf,Server.VERSION_4);
  ResultSet.PreparedMetadata decodedMeta=meta.codec.decode(buf,Server.VERSION_4);
  assertEquals(meta,decodedMeta);
  buf=Unpooled.buffer(meta.codec.encodedSize(meta,Server.VERSION_3));
  meta.codec.encode(meta,buf,Server.VERSION_3);
  decodedMeta=meta.codec.decode(buf,Server.VERSION_3);
  assertNotSame(meta,decodedMeta);
  ResultSet.PreparedMetadata metaWithoutIndexes=new ResultSet.PreparedMetadata(columnNames,null);
  buf=Unpooled.buffer(metaWithoutIndexes.codec.encodedSize(metaWithoutIndexes,Server.VERSION_4));
  metaWithoutIndexes.codec.encode(metaWithoutIndexes,buf,Server.VERSION_4);
  ResultSet.PreparedMetadata decodedMetaWithoutIndexes=metaWithoutIndexes.codec.decode(buf,Server.VERSION_4);
  assertEquals(decodedMeta,decodedMetaWithoutIndexes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggerExecutorTest </h4><pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sameKeySameCfPartialRowMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeySameCfPartialTrigger.class.getName()));
  PartitionUpdate cf1=makeCf(metadata,"k1","k1v1",null);
  PartitionUpdate cf2=makeCf(metadata,"k2","k2v1",null);
  Mutation rm1=new Mutation("ks1",cf1.partitionKey()).add(cf1);
  Mutation rm2=new Mutation("ks1",cf2.partitionKey()).add(cf2);
  List<? extends IMutation> tmutations=new ArrayList<>(TriggerExecutor.instance.execute(Arrays.asList(rm1,rm2)));
  assertEquals(2,tmutations.size());
  Collections.sort(tmutations,new RmComparator());
  List<PartitionUpdate> mutatedCFs=new ArrayList<>(tmutations.get(0).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  Row row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k1v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
  mutatedCFs=new ArrayList<>(tmutations.get(1).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k2v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sameKeySameCfColumnFamilies() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeySameCfTrigger.class.getName()));
  PartitionUpdate mutated=TriggerExecutor.instance.execute(makeCf(metadata,"k1","v1",null));
  RowIterator rowIterator=UnfilteredRowIterators.filter(mutated.unfilteredIterator(),FBUtilities.nowInSeconds());
  Iterator<Cell> cells=rowIterator.next().cells().iterator();
  assertEquals(bytes("trigger"),cells.next().value());
  assertTrue(!rowIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sameKeyDifferentKsRowMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeyDifferentKsTrigger.class.getName()));
  PartitionUpdate cf1=makeCf(metadata,"k1","k1v1",null);
  PartitionUpdate cf2=makeCf(metadata,"k2","k2v1",null);
  Mutation rm1=new Mutation("ks1",cf1.partitionKey()).add(cf1);
  Mutation rm2=new Mutation("ks1",cf2.partitionKey()).add(cf2);
  List<? extends IMutation> tmutations=new ArrayList<>(TriggerExecutor.instance.execute(Arrays.asList(rm1,rm2)));
  assertEquals(4,tmutations.size());
  Collections.sort(tmutations,new RmComparator());
  List<PartitionUpdate> mutatedCFs=new ArrayList<>(tmutations.get(0).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  Row row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k1v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
  mutatedCFs=new ArrayList<>(tmutations.get(1).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k2v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
  mutatedCFs=new ArrayList<>(tmutations.get(2).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c1"))));
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
  mutatedCFs=new ArrayList<>(tmutations.get(3).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c1"))));
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
}

</code></pre>

<br>
<pre class="type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void noTriggerMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",NoOpTrigger.class.getName()));
  Mutation rm=new Mutation(makeCf(metadata,"k1","v1",null));
  assertNull(TriggerExecutor.instance.execute(Collections.singletonList(rm)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sameKeySameCfRowMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeySameCfTrigger.class.getName()));
  PartitionUpdate cf1=makeCf(metadata,"k1","k1v1",null);
  PartitionUpdate cf2=makeCf(metadata,"k2","k2v1",null);
  Mutation rm1=new Mutation("ks1",cf1.partitionKey()).add(cf1);
  Mutation rm2=new Mutation("ks1",cf2.partitionKey()).add(cf2);
  List<? extends IMutation> tmutations=new ArrayList<>(TriggerExecutor.instance.execute(Arrays.asList(rm1,rm2)));
  assertEquals(2,tmutations.size());
  Collections.sort(tmutations,new RmComparator());
  List<PartitionUpdate> mutatedCFs=new ArrayList<>(tmutations.get(0).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  Row row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k1v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
  mutatedCFs=new ArrayList<>(tmutations.get(1).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("k2v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sameKeyDifferentCfRowMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeyDifferentCfTrigger.class.getName()));
  PartitionUpdate cf1=makeCf(metadata,"k1","k1v1",null);
  PartitionUpdate cf2=makeCf(metadata,"k2","k2v1",null);
  Mutation rm1=new Mutation("ks1",cf1.partitionKey()).add(cf1);
  Mutation rm2=new Mutation("ks1",cf2.partitionKey()).add(cf2);
  List<? extends IMutation> tmutations=new ArrayList<>(TriggerExecutor.instance.execute(Arrays.asList(rm1,rm2)));
  assertEquals(2,tmutations.size());
  Collections.sort(tmutations,new RmComparator());
  List<PartitionUpdate> mutatedCFs=new ArrayList<>(tmutations.get(0).getPartitionUpdates());
  assertEquals(2,mutatedCFs.size());
  for (  PartitionUpdate update : mutatedCFs) {
    if (update.metadata().cfName.equals("cf1")) {
      Row row=update.iterator().next();
      assertEquals(bytes("k1v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
      assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
    }
 else {
      Row row=update.iterator().next();
      assertNull(row.getCell(metadata.getColumnDefinition(bytes("c1"))));
      assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
    }
  }
  mutatedCFs=new ArrayList<>(tmutations.get(1).getPartitionUpdates());
  assertEquals(2,mutatedCFs.size());
  for (  PartitionUpdate update : mutatedCFs) {
    if (update.metadata().cfName.equals("cf1")) {
      Row row=update.iterator().next();
      assertEquals(bytes("k2v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
      assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
    }
 else {
      Row row=update.iterator().next();
      assertNull(row.getCell(metadata.getColumnDefinition(bytes("c1"))));
      assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void differentKeyRowMutations() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",DifferentKeyTrigger.class.getName()));
  PartitionUpdate cf1=makeCf(metadata,"k1","v1",null);
  Mutation rm=new Mutation("ks1",cf1.partitionKey()).add(cf1);
  List<? extends IMutation> tmutations=new ArrayList<>(TriggerExecutor.instance.execute(Arrays.asList(rm)));
  assertEquals(2,tmutations.size());
  Collections.sort(tmutations,new RmComparator());
  assertEquals(bytes("k1"),tmutations.get(0).key().getKey());
  assertEquals(bytes("otherKey"),tmutations.get(1).key().getKey());
  List<PartitionUpdate> mutatedCFs=new ArrayList<>(tmutations.get(0).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  Row row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("v1"),row.getCell(metadata.getColumnDefinition(bytes("c1"))).value());
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c2"))));
  mutatedCFs=new ArrayList<>(tmutations.get(1).getPartitionUpdates());
  assertEquals(1,mutatedCFs.size());
  row=mutatedCFs.get(0).iterator().next();
  assertEquals(bytes("trigger"),row.getCell(metadata.getColumnDefinition(bytes("c2"))).value());
  assertNull(row.getCell(metadata.getColumnDefinition(bytes("c1"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggersSchemaTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTriggerToCf() throws Exception {
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName).copy();
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  cfm2.triggers(cfm2.getTriggers().with(td));
  MigrationManager.announceColumnFamilyUpdate(cfm2,false);
  CFMetaData cfm3=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm3.getTriggers().isEmpty());
  assertEquals(1,cfm3.getTriggers().size());
  assertEquals(td,cfm3.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNewCfWithTriggerToKs() throws Exception {
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  cfm1.triggers(cfm1.getTriggers().with(td));
  MigrationManager.announceNewColumnFamily(cfm1);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm2.getTriggers().isEmpty());
  assertEquals(1,cfm2.getTriggers().size());
  assertEquals(td,cfm2.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void removeTriggerFromCf() throws Exception {
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  cfm1.triggers(cfm1.getTriggers().with(td));
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName).copy();
  cfm2.triggers(cfm2.getTriggers().without(triggerName));
  MigrationManager.announceColumnFamilyUpdate(cfm2,false);
  CFMetaData cfm3=Schema.instance.getCFMetaData(ksName,cfName).copy();
  assertTrue(cfm3.getTriggers().isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void newKsContainsCfWithTrigger() throws Exception {
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  cfm1.triggers(cfm1.getTriggers().with(td));
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm2.getTriggers().isEmpty());
  assertEquals(1,cfm2.getTriggers().size());
  assertEquals(td,cfm2.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BTreeTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that the apply method of the <code>UpdateFunction</code> is only called once with each key update.
 * (see CASSANDRA-8018).
 */
@Test public void testUpdate_UpdateFunctionCallBack(){
  Object[] btree=new Object[1];
  CallsMonitor monitor=new CallsMonitor();
  btree=BTree.update(btree,CMP,Arrays.asList(1),monitor);
  assertArrayEquals(new Object[]{1},btree);
  assertEquals(1,monitor.getNumberOfCalls(1));
  monitor.clear();
  btree=BTree.update(btree,CMP,Arrays.asList(2),monitor);
  assertArrayEquals(new Object[]{1,2,null},btree);
  assertEquals(1,monitor.getNumberOfCalls(2));
  monitor.clear();
  btree=BTree.update(btree,CMP,Arrays.asList(1),monitor);
  assertArrayEquals(new Object[]{1,2,null},btree);
  assertEquals(1,monitor.getNumberOfCalls(1));
  monitor.clear();
  btree=BTree.update(btree,CMP,Arrays.asList(3,4),monitor);
  assertArrayEquals(new Object[]{1,2,3,4,null},btree);
  assertEquals(1,monitor.getNumberOfCalls(3));
  assertEquals(1,monitor.getNumberOfCalls(4));
  monitor.clear();
  btree=BTree.update(btree,CMP,Arrays.asList(2,5),monitor);
  assertArrayEquals(new Object[]{3,new Object[]{1,2,null},new Object[]{4,5,null},new int[]{2,5}},btree);
  assertEquals(1,monitor.getNumberOfCalls(2));
  assertEquals(1,monitor.getNumberOfCalls(5));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearOnAbort(){
  Object[] btree=BTree.build(seq(2),noOp);
  Object[] copy=Arrays.copyOf(btree,btree.length);
  BTree.update(btree,CMP,seq(94),new AbortAfterX(90));
  assertArrayEquals(copy,btree);
  btree=BTree.update(btree,CMP,seq(94),noOp);
  assertTrue(BTree.isWellFormed(btree,CMP));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that the apply method of the <code>UpdateFunction</code> is only called once per value with each build call.
 */
@Test public void testBuilding_UpdateFunctionCallBack(){
  CallsMonitor monitor=new CallsMonitor();
  Object[] btree=BTree.build(Arrays.asList(1),monitor);
  assertArrayEquals(new Object[]{1},btree);
  assertEquals(1,monitor.getNumberOfCalls(1));
  monitor.clear();
  btree=BTree.build(Arrays.asList(1,2),monitor);
  assertArrayEquals(new Object[]{1,2,null},btree);
  assertEquals(1,monitor.getNumberOfCalls(1));
  assertEquals(1,monitor.getNumberOfCalls(2));
  monitor.clear();
  btree=BTree.build(Arrays.asList(1,2,3),monitor);
  assertArrayEquals(new Object[]{1,2,3},btree);
  assertEquals(1,monitor.getNumberOfCalls(1));
  assertEquals(1,monitor.getNumberOfCalls(2));
  assertEquals(1,monitor.getNumberOfCalls(3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.ByteBufferUtilTest </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetArray(){
  byte[] t=s.getBytes();
  ByteBuffer bb=ByteBufferUtil.bytes(s);
  assertArrayEquals(t,ByteBufferUtil.getArray(bb));
  bb=fromStringWithPosition(s,10,false);
  assertArrayEquals(t,ByteBufferUtil.getArray(bb));
  bb=fromStringWithPosition(s,10,true);
  assertArrayEquals(t,ByteBufferUtil.getArray(bb));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntBytesConversions(){
  int[] ints=new int[]{-20,-127,-128,0,1,127,128,65534,65535,-65534,-65535};
  for (  int i : ints) {
    ByteBuffer ba=ByteBufferUtil.bytes(i);
    int actual=ByteBufferUtil.toInt(ba);
    assertEquals(i,actual);
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHexBytesConversion(){
  for (int i=Byte.MIN_VALUE; i <= Byte.MAX_VALUE; i++) {
    ByteBuffer bb=ByteBuffer.allocate(1);
    bb.put((byte)i);
    bb.clear();
    String s=ByteBufferUtil.bytesToHex(bb);
    ByteBuffer bb2=ByteBufferUtil.hexToBytes(s);
    assertEquals(bb,bb2);
  }
  ByteBuffer bb=ByteBuffer.allocate(4);
  for (int i=0; i < 4; i++) {
    bb.put((byte)i);
  }
  bb.position(1);
  bb.limit(3);
  assertEquals(2,bb.remaining());
  String s=ByteBufferUtil.bytesToHex(bb);
  ByteBuffer bb2=ByteBufferUtil.hexToBytes(s);
  assertEquals(bb,bb2);
  assertEquals("0102",s);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BytesReadTrackerTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesRead() throws Exception {
  byte[] testData;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  try {
    out.writeBoolean(true);
    out.writeByte(0x1);
    out.writeChar('a');
    out.writeShort(1);
    out.writeInt(1);
    out.writeLong(1L);
    out.writeFloat(1.0f);
    out.writeDouble(1.0d);
    out.writeUTF("abc");
    testData=baos.toByteArray();
  }
  finally {
    out.close();
  }
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(testData));
  BytesReadTracker tracker=new BytesReadTracker(in);
  try {
    boolean bool=tracker.readBoolean();
    assertTrue(bool);
    assertEquals(1,tracker.getBytesRead());
    byte b=tracker.readByte();
    assertEquals(b,0x1);
    assertEquals(2,tracker.getBytesRead());
    char c=tracker.readChar();
    assertEquals('a',c);
    assertEquals(4,tracker.getBytesRead());
    short s=tracker.readShort();
    assertEquals(1,s);
    assertEquals((short)6,tracker.getBytesRead());
    int i=tracker.readInt();
    assertEquals(1,i);
    assertEquals(10,tracker.getBytesRead());
    long l=tracker.readLong();
    assertEquals(1L,l);
    assertEquals(18,tracker.getBytesRead());
    float f=tracker.readFloat();
    assertEquals(1.0f,f,0);
    assertEquals(22,tracker.getBytesRead());
    double d=tracker.readDouble();
    assertEquals(1.0d,d,0);
    assertEquals(30,tracker.getBytesRead());
    String str=tracker.readUTF();
    assertEquals("abc",str);
    assertEquals(35,tracker.getBytesRead());
    assertEquals(testData.length,tracker.getBytesRead());
  }
  finally {
    in.close();
  }
  tracker.reset(0);
  assertEquals(0,tracker.getBytesRead());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipBytesAndReadFully() throws Exception {
  String testStr="1234567890";
  byte[] testData=testStr.getBytes();
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(testData));
  BytesReadTracker tracker=new BytesReadTracker(in);
  try {
    byte[] out=new byte[5];
    tracker.readFully(out,0,5);
    assertEquals("12345",new String(out));
    assertEquals(5,tracker.getBytesRead());
    tracker.skipBytes(2);
    assertEquals(7,tracker.getBytesRead());
    out=new byte[3];
    tracker.readFully(out);
    assertEquals("890",new String(out));
    assertEquals(10,tracker.getBytesRead());
    assertEquals(testData.length,tracker.getBytesRead());
  }
  finally {
    in.close();
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnsignedRead() throws Exception {
  byte[] testData;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  try {
    out.writeByte(0x1);
    out.writeShort(1);
    testData=baos.toByteArray();
  }
  finally {
    out.close();
  }
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(testData));
  BytesReadTracker tracker=new BytesReadTracker(in);
  try {
    int b=tracker.readUnsignedByte();
    assertEquals(b,1);
    assertEquals(1,tracker.getBytesRead());
    int s=tracker.readUnsignedShort();
    assertEquals(1,s);
    assertEquals(3,tracker.getBytesRead());
    assertEquals(testData.length,tracker.getBytesRead());
  }
  finally {
    in.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.HexTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHexBytesConversion(){
  for (int i=Byte.MIN_VALUE; i <= Byte.MAX_VALUE; i++) {
    byte[] b=new byte[]{(byte)i};
    String s=Hex.bytesToHex(b);
    byte[] c=Hex.hexToBytes(s);
    assertArrayEquals(b,c);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.IntervalTreeTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSearch() throws Exception {
  List<Interval<Integer,Void>> intervals=new ArrayList<Interval<Integer,Void>>();
  intervals.add(Interval.<Integer,Void>create(-300,-200));
  intervals.add(Interval.<Integer,Void>create(-3,-2));
  intervals.add(Interval.<Integer,Void>create(1,2));
  intervals.add(Interval.<Integer,Void>create(3,6));
  intervals.add(Interval.<Integer,Void>create(2,4));
  intervals.add(Interval.<Integer,Void>create(5,7));
  intervals.add(Interval.<Integer,Void>create(1,3));
  intervals.add(Interval.<Integer,Void>create(4,6));
  intervals.add(Interval.<Integer,Void>create(8,9));
  intervals.add(Interval.<Integer,Void>create(15,20));
  intervals.add(Interval.<Integer,Void>create(40,50));
  intervals.add(Interval.<Integer,Void>create(49,60));
  IntervalTree<Integer,Void,Interval<Integer,Void>> it=IntervalTree.build(intervals);
  assertEquals(3,it.search(Interval.<Integer,Void>create(4,4)).size());
  assertEquals(4,it.search(Interval.<Integer,Void>create(4,5)).size());
  assertEquals(7,it.search(Interval.<Integer,Void>create(-1,10)).size());
  assertEquals(0,it.search(Interval.<Integer,Void>create(-1,-1)).size());
  assertEquals(5,it.search(Interval.<Integer,Void>create(1,4)).size());
  assertEquals(2,it.search(Interval.<Integer,Void>create(0,1)).size());
  assertEquals(0,it.search(Interval.<Integer,Void>create(10,12)).size());
  List<Interval<Integer,Void>> intervals2=new ArrayList<Interval<Integer,Void>>();
  intervals2.add(Interval.<Integer,Void>create(1880,1971));
  intervals2.add(Interval.<Integer,Void>create(1874,1951));
  intervals2.add(Interval.<Integer,Void>create(1843,1907));
  intervals2.add(Interval.<Integer,Void>create(1779,1828));
  intervals2.add(Interval.<Integer,Void>create(1756,1828));
  intervals2.add(Interval.<Integer,Void>create(1585,1672));
  IntervalTree<Integer,Void,Interval<Integer,Void>> it2=IntervalTree.build(intervals2);
  assertEquals(0,it2.search(Interval.<Integer,Void>create(1829,1842)).size());
  List<Void> intersection1=it2.search(Interval.<Integer,Void>create(1907,1907));
  assertEquals(3,intersection1.size());
  intersection1=it2.search(Interval.<Integer,Void>create(1780,1790));
  assertEquals(2,intersection1.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.LongBTreeTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * TEST MUTATION 
 */
@Test public void testOversizedMiddleInsert(){
  TreeSet<Integer> canon=new TreeSet<>();
  for (int i=0; i < 10000000; i++)   canon.add(i);
  Object[] btree=BTree.build(Arrays.asList(Integer.MIN_VALUE,Integer.MAX_VALUE),UpdateFunction.noOp());
  btree=BTree.update(btree,naturalOrder(),canon,UpdateFunction.<Integer>noOp());
  canon.add(Integer.MIN_VALUE);
  canon.add(Integer.MAX_VALUE);
  assertTrue(BTree.isWellFormed(btree,naturalOrder()));
  testEqual("Oversize",BTree.iterator(btree),canon.iterator());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreeTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifference(){
  int maxsize=16;
  mt.maxsize(maxsize);
  MerkleTree mt2=new MerkleTree(partitioner,fullRange(),RECOMMENDED_DEPTH,maxsize);
  mt.init();
  mt2.init();
  for (  TreeRange range : mt.invalids())   range.addAll(new HIterator(range.right));
  for (  TreeRange range : mt2.invalids())   range.addAll(new HIterator(range.right));
  TreeRange leftmost=null;
  TreeRange middle=null;
  mt.maxsize(maxsize + 2);
  Iterator<TreeRange> ranges=mt.invalids();
  leftmost=ranges.next();
  mt.split(leftmost.right);
  middle=mt.get(leftmost.right);
  middle.hash("arbitrary!".getBytes());
  mt.get(partitioner.midpoint(leftmost.left,leftmost.right)).hash("even more arbitrary!".getBytes());
  List<TreeRange> diffs=MerkleTree.difference(mt,mt2);
  assertEquals(diffs + " contains wrong number of differences:",1,diffs.size());
  assertTrue(diffs.contains(new Range<>(leftmost.left,middle.right)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreesTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization() throws Exception {
  Range<Token> first=new Range<>(tok(3),tok(4));
  Collection<Range<Token>> ranges=new ArrayList<>();
  ranges.add(first);
  ranges.add(new Range<Token>(tok(5),tok(2)));
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTrees(256,ranges);
  mts.init();
  for (  TreeRange range : mts.invalids())   range.addAll(new HIterator(range.right));
  byte[] initialhash=mts.hash(first);
  long serializedSize=MerkleTrees.serializer.serializedSize(mts,MessagingService.current_version);
  DataOutputBuffer out=new DataOutputBuffer();
  MerkleTrees.serializer.serialize(mts,out,MessagingService.current_version);
  byte[] serialized=out.toByteArray();
  assertEquals(serializedSize,serialized.length);
  DataInputBuffer in=new DataInputBuffer(serialized);
  MerkleTrees restored=MerkleTrees.serializer.deserialize(in,MessagingService.current_version);
  assertHashEquals(initialhash,restored.hash(first));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifference(){
  int maxsize=16;
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTree(32,fullRange());
  MerkleTrees mts2=new MerkleTrees(partitioner);
  mts2.addMerkleTree(32,fullRange());
  mts.init();
  mts2.init();
  for (  TreeRange range : mts.invalids())   range.addAll(new HIterator(range.right));
  for (  TreeRange range : mts2.invalids())   range.addAll(new HIterator(range.right));
  TreeRange leftmost=null;
  TreeRange middle=null;
  mts.maxsize(fullRange(),maxsize + 2);
  Iterator<TreeRange> ranges=mts.invalids();
  leftmost=ranges.next();
  mts.split(leftmost.right);
  middle=mts.get(leftmost.right);
  middle.hash("arbitrary!".getBytes());
  mts.get(partitioner.midpoint(leftmost.left,leftmost.right)).hash("even more arbitrary!".getBytes());
  List<Range<Token>> diffs=MerkleTrees.difference(mts,mts2);
  assertEquals(diffs + " contains wrong number of differences:",1,diffs.size());
  assertTrue(diffs.contains(new Range<>(leftmost.left,middle.right)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NanoTimeToCurrentTimeMillisTest </h4><pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testTimestampOrdering() throws Exception {
  long nowNanos=System.nanoTime();
  long now=System.currentTimeMillis();
  long lastConverted=0;
  for (long ii=0; ii < 10000000; ii++) {
    now=Math.max(now,System.currentTimeMillis());
    if (ii % 10000 == 0) {
      NanoTimeToCurrentTimeMillis.updateNow();
      Thread.sleep(1);
    }
    nowNanos=Math.max(nowNanos,System.nanoTime());
    long convertedNow=NanoTimeToCurrentTimeMillis.convert(nowNanos);
    int maxDiff=FBUtilities.isWindows() ? 15 : 1;
    assertTrue("convertedNow = " + convertedNow + " lastConverted = "+ lastConverted+ " in iteration "+ ii,convertedNow >= (lastConverted - maxDiff));
    maxDiff=FBUtilities.isWindows() ? 25 : 2;
    assertTrue("now = " + now + " convertedNow = "+ convertedNow+ " in iteration "+ ii,(maxDiff - 2) <= convertedNow);
    lastConverted=convertedNow;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NoSpamLoggerTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoggedResult() throws Exception {
  now=5;
  assertTrue(NoSpamLogger.log(mock,Level.INFO,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.INFO);
  now=10;
  assertTrue(NoSpamLogger.log(mock,Level.WARN,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.WARN);
  now=15;
  assertTrue(NoSpamLogger.log(mock,Level.ERROR,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.ERROR);
  now=20;
  NoSpamLogger logger=NoSpamLogger.getLogger(mock,5,TimeUnit.NANOSECONDS);
  assertTrue(logger.info(statement,param));
  checkMock(Level.INFO);
  now=25;
  assertTrue(logger.warn(statement,param));
  checkMock(Level.WARN);
  now=30;
  assertTrue(logger.error(statement,param));
  checkMock(Level.ERROR);
  NoSpamLogger.NoSpamLogStatement nospamStatement=logger.getStatement(statement);
  now=35;
  assertTrue(nospamStatement.info(param));
  checkMock(Level.INFO);
  now=40;
  assertTrue(nospamStatement.warn(param));
  checkMock(Level.WARN);
  now=45;
  assertTrue(nospamStatement.error(param));
  checkMock(Level.ERROR);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNoSpamLoggerDirect() throws Exception {
  now=5;
  NoSpamLogger logger=NoSpamLogger.getLogger(mock,5,TimeUnit.NANOSECONDS);
  assertTrue(logger.info(statement,param));
  assertFalse(logger.info(statement,param));
  assertFalse(logger.warn(statement,param));
  assertFalse(logger.error(statement,param));
  assertLoggedSizes(1,0,0);
  NoSpamLogStatement statement=logger.getStatement("swizzle2{}",10,TimeUnit.NANOSECONDS);
  assertFalse(statement.warn(param));
  assertLoggedSizes(1,0,0);
  now=10;
  assertTrue(statement.warn(param));
  assertLoggedSizes(1,1,0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNoSpamLoggerStatementDirect() throws Exception {
  NoSpamLogger.NoSpamLogStatement nospam=NoSpamLogger.getStatement(mock,statement,5,TimeUnit.NANOSECONDS);
  now=5;
  assertTrue(nospam.info(statement,param));
  assertFalse(nospam.info(statement,param));
  assertFalse(nospam.warn(statement,param));
  assertFalse(nospam.error(statement,param));
  assertLoggedSizes(1,0,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.SerializationsTest </h4><pre class="type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testBloomFilterReadMURMUR3pre30() throws IOException {
  if (EXECUTE_WRITES)   testBloomFilterWrite(true,false);
  try (DataInputStream in=getInput("2.1","utils.BloomFilter.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    Assert.assertNotNull(filter);
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomFilterRead1000() throws IOException {
  if (EXECUTE_WRITES) {
    testBloomFilterWrite1000(true,false);
    testBloomFilterWrite1000(true,true);
  }
  try (DataInputStream in=getInput("3.0","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,true)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   int falsePositive=0;
  int falseNegative=0;
  try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (!present)       falseNegative++;
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (present)       falsePositive++;
    }
  }
   Assert.assertEquals(1000,falseNegative);
  Assert.assertEquals(0,falsePositive);
}

</code></pre>

<br>
<pre class="type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testBloomFilterReadMURMUR3() throws IOException {
  if (EXECUTE_WRITES)   testBloomFilterWrite(true,true);
  try (DataInputStream in=getInput("3.0","utils.BloomFilter.bin");IFilter filter=FilterFactory.deserialize(in,true,true)){
    Assert.assertNotNull(filter);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.StreamingHistogramTest </h4><pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFunction() throws Exception {
  StreamingHistogram hist=new StreamingHistogram(5);
  long[] samples=new long[]{23,19,10,16,36,2,9,32,30,45};
  for (int i=0; i < 7; i++) {
    hist.update(samples[i]);
  }
  Map<Double,Long> expected1=new LinkedHashMap<Double,Long>(5);
  expected1.put(2.0,1L);
  expected1.put(9.5,2L);
  expected1.put(17.5,2L);
  expected1.put(23.0,1L);
  expected1.put(36.0,1L);
  Iterator<Map.Entry<Double,Long>> expectedItr=expected1.entrySet().iterator();
  for (  Map.Entry<Double,Long> actual : hist.getAsMap().entrySet()) {
    Map.Entry<Double,Long> entry=expectedItr.next();
    assertEquals(entry.getKey(),actual.getKey(),0.01);
    assertEquals(entry.getValue(),actual.getValue());
  }
  StreamingHistogram hist2=new StreamingHistogram(3);
  for (int i=7; i < samples.length; i++) {
    hist2.update(samples[i]);
  }
  hist.merge(hist2);
  Map<Double,Long> expected2=new LinkedHashMap<Double,Long>(5);
  expected2.put(2.0,1L);
  expected2.put(9.5,2L);
  expected2.put(19.33,3L);
  expected2.put(32.67,3L);
  expected2.put(45.0,1L);
  expectedItr=expected2.entrySet().iterator();
  for (  Map.Entry<Double,Long> actual : hist.getAsMap().entrySet()) {
    Map.Entry<Double,Long> entry=expectedItr.next();
    assertEquals(entry.getKey(),actual.getKey(),0.01);
    assertEquals(entry.getValue(),actual.getValue());
  }
  assertEquals(3.28,hist.sum(15),0.01);
  assertEquals(10.0,hist.sum(50),0.01);
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerDe() throws Exception {
  StreamingHistogram hist=new StreamingHistogram(5);
  long[] samples=new long[]{23,19,10,16,36,2,9};
  for (int i=0; i < samples.length; i++) {
    hist.update(samples[i]);
  }
  DataOutputBuffer out=new DataOutputBuffer();
  StreamingHistogram.serializer.serialize(hist,out);
  byte[] bytes=out.toByteArray();
  StreamingHistogram deserialized=StreamingHistogram.serializer.deserialize(new DataInputBuffer(bytes));
  Map<Double,Long> expected1=new LinkedHashMap<Double,Long>(5);
  expected1.put(2.0,1L);
  expected1.put(9.5,2L);
  expected1.put(17.5,2L);
  expected1.put(23.0,1L);
  expected1.put(36.0,1L);
  Iterator<Map.Entry<Double,Long>> expectedItr=expected1.entrySet().iterator();
  for (  Map.Entry<Double,Long> actual : deserialized.getAsMap().entrySet()) {
    Map.Entry<Double,Long> entry=expectedItr.next();
    assertEquals(entry.getKey(),actual.getKey(),0.01);
    assertEquals(entry.getValue(),actual.getValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.btree.BTreeRemovalTest </h4><pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveFromRootWhichIsALeaf(){
  for (int size=1; size < 9; ++size) {
    final Object[] btree=new Object[(size & 1) == 1 ? size : size + 1];
    for (int i=0; i < size; ++i)     btree[i]=i + 1;
    for (int i=0; i < size; ++i) {
      final Object[] result=remove(btree,CMP,i + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      for (int j=0; j < i; ++j)       assertEquals("size " + size + "elem "+ j,btree[j],result[j]);
      for (int j=i; j < size - 1; ++j)       assertEquals("size " + size + "elem "+ j,btree[j + 1],result[j]);
      for (int j=size - 1; j < result.length; ++j)       assertNull("size " + size + "elem "+ j,result[j]);
    }
{
      final Object[] result=remove(btree,CMP,0);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
{
      final Object[] result=remove(btree,CMP,size + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void randomizedTest(){
  Random rand=new Random(2);
  SortedSet<Integer> data=new TreeSet<>();
  for (int i=0; i < 1000; ++i)   data.add(rand.nextInt());
  Object[] btree=BTree.build(data,UpdateFunction.<Integer>noOp());
  assertTrue(BTree.isWellFormed(btree,CMP));
  assertTrue(Iterables.elementsEqual(data,BTree.iterable(btree)));
  while (btree != BTree.empty()) {
    int idx=rand.nextInt(BTree.size(btree));
    Integer val=BTree.findByIndex(btree,idx);
    assertTrue(data.remove(val));
    btree=assertRemove(btree,val);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.BufferPoolTest </h4><pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifferentSizes() throws InterruptedException {
  final int size1=1024;
  final int size2=2048;
  ByteBuffer buffer1=BufferPool.get(size1);
  assertNotNull(buffer1);
  assertEquals(size1,buffer1.capacity());
  ByteBuffer buffer2=BufferPool.get(size2);
  assertNotNull(buffer2);
  assertEquals(size2,buffer2.capacity());
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  assertEquals(BufferPool.GlobalPool.MACRO_CHUNK_SIZE,BufferPool.sizeInBytes());
  BufferPool.put(buffer1);
  BufferPool.put(buffer2);
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(BufferPool.GlobalPool.MACRO_CHUNK_SIZE,BufferPool.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactIfOutOfCapacity(){
  final int size=4096;
  final int numBuffersInChunk=BufferPool.GlobalPool.MACRO_CHUNK_SIZE / size;
  List<ByteBuffer> buffers=new ArrayList<>(numBuffersInChunk);
  Set<Long> addresses=new HashSet<>(numBuffersInChunk);
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    buffers.add(buffer);
    addresses.add(MemoryUtil.getAddress(buffer));
  }
  for (int i=numBuffersInChunk - 1; i >= 0; i--)   BufferPool.put(buffers.get(i));
  buffers.clear();
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    assertNotNull(buffer);
    assertEquals(size,buffer.capacity());
    addresses.remove(MemoryUtil.getAddress(buffer));
    buffers.add(buffer);
  }
  assertTrue(addresses.isEmpty());
  for (  ByteBuffer buffer : buffers)   BufferPool.put(buffer);
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBigRequest(){
  final int size=BufferPool.CHUNK_SIZE + 1;
  ByteBuffer buffer=BufferPool.get(size);
  assertNotNull(buffer);
  assertEquals(size,buffer.capacity());
  BufferPool.put(buffer);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifferentSizeBuffersOnOneChunk(){
  int[] sizes=new int[]{5,1024,4096,8,16000,78,512,256,63,55,89,90,255,32,2048,128};
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=BufferPool.currentChunk().roundUp(buffer.capacity());
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  Random rnd=new Random();
  rnd.setSeed(298347529L);
  while (!buffers.isEmpty()) {
    int index=rnd.nextInt(buffers.size());
    ByteBuffer buffer=buffers.remove(index);
    BufferPool.put(buffer);
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChunkExhausted(){
  final int size=BufferPool.CHUNK_SIZE / 64;
  int[] sizes=new int[128];
  Arrays.fill(sizes,size);
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=buffer.capacity();
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  for (int i=0; i < sizes.length; i++) {
    BufferPool.put(buffers.get(i));
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPut() throws InterruptedException {
  final int size=RandomAccessReader.DEFAULT_BUFFER_SIZE;
  ByteBuffer buffer=BufferPool.get(size);
  assertNotNull(buffer);
  assertEquals(size,buffer.capacity());
  assertEquals(true,buffer.isDirect());
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  assertEquals(BufferPool.GlobalPool.MACRO_CHUNK_SIZE,BufferPool.sizeInBytes());
  BufferPool.put(buffer);
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(BufferPool.GlobalPool.MACRO_CHUNK_SIZE,BufferPool.sizeInBytes());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.NativeAllocatorTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBookKeeping() throws ExecutionException, InterruptedException {
{
    final ScheduledExecutorService exec=Executors.newScheduledThreadPool(2);
    final OpOrder order=new OpOrder();
    final OpOrder.Group group=order.start();
    final CountDownLatch canClean=new CountDownLatch(1);
    final CountDownLatch isClean=new CountDownLatch(1);
    final AtomicReference<NativeAllocator> allocatorRef=new AtomicReference<>();
    final AtomicReference<OpOrder.Barrier> barrier=new AtomicReference<>();
    final NativeAllocator allocator=new NativeAllocator(new NativePool(1,100,0.75f,new Runnable(){
      public void run(){
        try {
          canClean.await();
        }
 catch (        InterruptedException e) {
          throw new AssertionError();
        }
        if (isClean.getCount() > 0) {
          allocatorRef.get().offHeap().released(80);
          isClean.countDown();
        }
      }
    }
));
    allocatorRef.set(allocator);
    final Runnable markBlocking=new Runnable(){
      public void run(){
        barrier.set(order.newBarrier());
        barrier.get().issue();
        barrier.get().markBlocking();
      }
    }
;
    final Runnable run=new Runnable(){
      public void run(){
        allocator.allocate(10,group);
        Assert.assertEquals(10,allocator.offHeap().owns());
        allocator.offHeap().adjust(-10,group);
        Assert.assertEquals(0,allocator.offHeap().owns());
        allocator.offHeap().adjust(10,group);
        Assert.assertEquals(10,allocator.offHeap().owns());
        boolean success=false;
        try {
          allocator.offHeap().allocate(-10,group);
        }
 catch (        AssertionError e) {
          success=true;
        }
        Assert.assertTrue(success);
        Uninterruptibles.sleepUninterruptibly(10L,TimeUnit.MILLISECONDS);
        Assert.assertEquals(1,isClean.getCount());
        allocator.allocate(70,group);
        Assert.assertEquals(80,allocator.offHeap().owns());
        canClean.countDown();
        try {
          isClean.await(10L,TimeUnit.MILLISECONDS);
        }
 catch (        InterruptedException e) {
          throw new AssertionError();
        }
        Assert.assertEquals(0,isClean.getCount());
        Assert.assertEquals(0,allocator.offHeap().owns());
        exec.schedule(markBlocking,10L,TimeUnit.MILLISECONDS);
        allocator.allocate(110,group);
        Assert.assertNotNull(barrier.get());
        Assert.assertEquals(110,allocator.offHeap().owns());
      }
    }
;
    exec.submit(run).get();
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
