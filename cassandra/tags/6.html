<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchTest </h4><pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * This is just to test decodeMutations() when deserializing,
 * since Batch will never be serialized at a version 2.2.
 * @throws IOException
 */
@Test public void testSerializationNonCurrentVersion() throws IOException {
  CFMetaData cfm=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF_STANDARD).metadata;
  long now=FBUtilities.timestampMicros();
  int version=MessagingService.VERSION_22;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int i=0; i < 10; i++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),bytes(i)).clustering("name" + i).add("val","val" + i).build());
  }
  Batch batch1=Batch.createLocal(uuid,now,mutations);
  assertEquals(uuid,batch1.id);
  assertEquals(now,batch1.creationTime);
  assertEquals(mutations,batch1.decodedMutations);
  DataOutputBuffer out=new DataOutputBuffer();
  Batch.serializer.serialize(batch1,out,version);
  assertEquals(out.getLength(),Batch.serializer.serializedSize(batch1,version));
  DataInputPlus dis=new DataInputBuffer(out.getData());
  Batch batch2=Batch.serializer.deserialize(dis,version);
  assertEquals(batch1.id,batch2.id);
  assertEquals(batch1.creationTime,batch2.creationTime);
  assertEquals(batch1.decodedMutations.size(),batch2.decodedMutations.size());
  Iterator<Mutation> it1=batch1.decodedMutations.iterator();
  Iterator<Mutation> it2=batch2.decodedMutations.iterator();
  while (it1.hasNext())   assertEquals(it1.next().toString(),it2.next().toString());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSerialization() throws IOException {
  CFMetaData cfm=Keyspace.open(KEYSPACE).getColumnFamilyStore(CF_STANDARD).metadata;
  long now=FBUtilities.timestampMicros();
  int version=MessagingService.current_version;
  UUID uuid=UUIDGen.getTimeUUID();
  List<Mutation> mutations=new ArrayList<>(10);
  for (int i=0; i < 10; i++) {
    mutations.add(new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),bytes(i)).clustering("name" + i).add("val","val" + i).build());
  }
  Batch batch1=Batch.createLocal(uuid,now,mutations);
  assertEquals(uuid,batch1.id);
  assertEquals(now,batch1.creationTime);
  assertEquals(mutations,batch1.decodedMutations);
  DataOutputBuffer out=new DataOutputBuffer();
  Batch.serializer.serialize(batch1,out,version);
  assertEquals(out.getLength(),Batch.serializer.serializedSize(batch1,version));
  DataInputPlus dis=new DataInputBuffer(out.getData());
  Batch batch2=Batch.serializer.deserialize(dis,version);
  assertEquals(batch1.id,batch2.id);
  assertEquals(batch1.creationTime,batch2.creationTime);
  assertEquals(batch1.decodedMutations.size(),batch2.encodedMutations.size());
  Iterator<Mutation> it1=batch1.decodedMutations.iterator();
  Iterator<ByteBuffer> it2=batch2.encodedMutations.iterator();
  while (it1.hasNext()) {
    try (DataInputBuffer in=new DataInputBuffer(it2.next().array())){
      assertEquals(it1.next().toString(),Mutation.serializer.deserialize(in,version).toString());
    }
   }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchlogManagerTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void testConversion() throws Exception {
  long initialAllBatches=BatchlogManager.instance.countAllBatches();
  long initialReplayedBatches=BatchlogManager.instance.getTotalBatchesReplayed();
  CFMetaData cfm=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD4);
  for (int i=0; i < 1400; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 700 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    Mutation batchMutation=LegacyBatchlogMigrator.getStoreMutation(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),TimeUnit.MILLISECONDS.toMicros(timestamp),Collections.singleton(mutation)),MessagingService.VERSION_20);
    assertTrue(LegacyBatchlogMigrator.isLegacyBatchlogMutation(batchMutation));
    LegacyBatchlogMigrator.handleLegacyMutation(batchMutation);
  }
  for (int i=1400; i < 1500; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 1450 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),Collections.singleton(mutation)));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  assertEquals(1500,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(0,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  UntypedResultSet result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy",0,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog",1500,result.one().getLong("count"));
  BatchlogManager.instance.performInitialReplay();
  assertEquals(750,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(750,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  for (int i=0; i < 1500; i++) {
    result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD4,i));
    assertNotNull(result);
    if (i < 700 || i >= 1400 && i < 1450) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue("Present at " + i,result.isEmpty());
    }
  }
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",KEYSPACE1,CF_STANDARD4));
  assertNotNull(result);
  assertEquals(750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog after initial replay",750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy after initial replay ",0,result.one().getLong("count"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncatedReplay() throws InterruptedException, ExecutionException {
  CFMetaData cf2=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD2);
  CFMetaData cf3=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD3);
  for (int i=0; i < 1000; i++) {
    Mutation mutation1=new RowUpdateBuilder(cf2,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    Mutation mutation2=new RowUpdateBuilder(cf3,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    List<Mutation> mutations=Lists.newArrayList(mutation1,mutation2);
    long timestamp=System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout();
    if (i == 500)     SystemKeyspace.saveTruncationRecord(Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2),timestamp,ReplayPosition.NONE);
    if (i >= 500)     timestamp++;
 else     timestamp--;
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),mutations));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  BatchlogManager.instance.startBatchlogReplay().get();
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD2,i));
    assertNotNull(result);
    if (i >= 500) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue(result.isEmpty());
    }
  }
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD3,i));
    assertNotNull(result);
    assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
    assertEquals("name" + i,result.one().getString("name"));
    assertEquals("val" + i,result.one().getString("val"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ColumnIdentifierTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComparisonMethod(){
  ThreadLocalRandom random=ThreadLocalRandom.current();
  byte[] commonBytes=new byte[10];
  byte[] aBytes=new byte[16];
  byte[] bBytes=new byte[16];
  for (int i=0; i < 100000; i++) {
    int commonLength=random.nextInt(0,10);
    random.nextBytes(commonBytes);
    random.nextBytes(aBytes);
    random.nextBytes(bBytes);
    System.arraycopy(commonBytes,0,aBytes,0,commonLength);
    System.arraycopy(commonBytes,0,bBytes,0,commonLength);
    int aLength=random.nextInt(commonLength,16);
    int bLength=random.nextInt(commonLength,16);
    ColumnIdentifier a=new ColumnIdentifier(ByteBuffer.wrap(aBytes,0,aLength),BytesType.instance);
    ColumnIdentifier b=new ColumnIdentifier(ByteBuffer.wrap(bBytes,0,bLength),BytesType.instance);
    Assert.assertEquals("" + i,compareResult(a.compareTo(b)),compareResult(ByteBufferUtil.compareUnsigned(a.bytes,b.bytes)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.DeleteTest </h4><pre class="type-6 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void lostDeletesTest(){
  Session session=sessionNet();
  for (int i=0; i < 500; i++) {
    session.execute(pstmtI.bind(1,1,"inhB","valB"));
    ResultSetFuture[] futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertNotNull(futures[2].getUninterruptibly().one());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
    session.execute(pstmtU.bind("inhBu","valBu",1,1));
    futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertNotNull(futures[2].getUninterruptibly().one());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
    session.execute(pstmtD.bind(1,1));
    futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[2].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.KeyCacheCqlTest </h4><pre class="type-6 type-7 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2iKeyCachePaths() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  createIndex("CREATE INDEX some_index ON %s (col_int)");
  insertData(table,"some_index",true);
  clearCache();
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(210,requests);
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(200,hits);
  assertEquals(420,requests);
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  int beforeSize=CacheService.instance.keyCache.size();
  CacheService.instance.keyCache.clear();
  Assert.assertEquals(0,CacheService.instance.keyCache.size());
  CacheService.instance.keyCache.loadSaved();
  assertEquals(beforeSize,CacheService.instance.keyCache.size());
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  assertNull(Schema.instance.getColumnFamilyStoreIncludingIndexes(Pair.create("foo","bar")));
  assertNull(Schema.instance.getColumnFamilyStoreIncludingIndexes(Pair.create(KEYSPACE,"bar")));
  dropTable("DROP TABLE %s");
  Schema.instance.updateVersion();
  CacheService.instance.keyCache.clear();
  CacheService.instance.keyCache.loadSaved();
  assertEquals(0,CacheService.instance.keyCache.size());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2iKeyCachePathsSaveKeysForDroppedTable() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  createIndex("CREATE INDEX some_index ON %s (col_int)");
  insertData(table,"some_index",true);
  clearCache();
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(210,requests);
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(200,hits);
  assertEquals(420,requests);
  dropTable("DROP TABLE %s");
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.keyCache.clear();
  Assert.assertEquals(0,CacheService.instance.keyCache.size());
  CacheService.instance.keyCache.loadSaved();
  Iterator<KeyCacheKey> iter=CacheService.instance.keyCache.keyIterator();
  while (iter.hasNext()) {
    KeyCacheKey key=iter.next();
    Assert.assertFalse(key.ksAndCFName.left.equals("KEYSPACE"));
    Assert.assertFalse(key.ksAndCFName.right.startsWith(table));
  }
}

</code></pre>

<br>
<pre class="type-6 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testKeyCacheClustered() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  insertData(table,null,true);
  clearCache();
  for (int i=0; i < 10; i++) {
    assertEquals(50,execute("SELECT col_text FROM %s WHERE part_key_a = ? AND part_key_b = ?",i,Integer.toOctalString(i)).size());
  }
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(10,requests);
  for (int i=0; i < 10; i++) {
    assertEquals(50,execute("SELECT col_text FROM %s WHERE part_key_a = ? AND part_key_b = ?",i,Integer.toOctalString(i)).size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(10,hits);
  assertEquals(10 + 10,requests);
  for (int i=0; i < 10; i++) {
    for (int c=0; c < 10; c++) {
      assertRows(execute("SELECT col_text, col_long FROM %s WHERE part_key_a = ? AND part_key_b = ? and clust_key_a = ?",i,Integer.toOctalString(i),c),new Object[]{String.valueOf(i) + '-' + String.valueOf(c),(long)c});
    }
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(10 + 100,hits);
  assertEquals(20 + 100,requests);
  for (int i=0; i < 100; i++) {
    for (int c=0; c < 50; c++) {
      assertRows(execute("SELECT col_text, col_long FROM %s WHERE part_key_a = ? AND part_key_b = ? and clust_key_a = ?",i,Integer.toOctalString(i),c),new Object[]{String.valueOf(i) + '-' + String.valueOf(c),(long)c});
    }
  }
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(110 + 4910,hits);
  assertEquals(120 + 5500,requests);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.SerializationMirrorTest </h4><pre class="type-6 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testManyClusterings() throws Throwable {
  StringBuilder table=new StringBuilder("CREATE TABLE %s (a TEXT");
  StringBuilder cols=new StringBuilder();
  StringBuilder args=new StringBuilder("?");
  List vals=new ArrayList<>();
  vals.add("a");
  for (int i=0; i < 40; i++) {
    table.append(", c").append(i).append(" text");
    cols.append(", c").append(i);
    if (ThreadLocalRandom.current().nextBoolean())     vals.add(Integer.toString(i));
 else     vals.add("");
    args.append(",?");
  }
  args.append(",?");
  vals.add("value");
  table.append(", v text, PRIMARY KEY ((a)").append(cols).append("))");
  createTable(table.toString());
  execute("INSERT INTO %s (a" + cols + ", v) VALUES ("+ args+ ")",vals.toArray());
  flush();
  UntypedResultSet.Row row=execute("SELECT * FROM %s").one();
  for (int i=0; i < row.getColumns().size(); i++)   Assert.assertEquals(vals.get(i),row.getString(i == 0 ? "a" : i < 41 ? "c" + (i - 1) : "v"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFTest </h4><pre class="type-6 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAmokUDF() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  long udfWarnTimeout=DatabaseDescriptor.getUserDefinedFunctionWarnTimeout();
  long udfFailTimeout=DatabaseDescriptor.getUserDefinedFunctionFailTimeout();
  int maxTries=5;
  for (int i=1; i <= maxTries; i++) {
    try {
      DatabaseDescriptor.setUserDefinedFunctionWarnTimeout(10);
      DatabaseDescriptor.setUserDefinedFunctionFailTimeout(250);
      DatabaseDescriptor.setUserFunctionTimeoutPolicy(Config.UserFunctionTimeoutPolicy.ignore);
      ClientWarn.instance.captureWarnings();
      String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'long t=System.currentTimeMillis()+110; while (t>System.currentTimeMillis()) { }; return 0d;'");
      execute("SELECT " + fName + "(dval) FROM %s WHERE key=1");
      List<String> warnings=ClientWarn.instance.getWarnings();
      Assert.assertNotNull(warnings);
      Assert.assertFalse(warnings.isEmpty());
      ClientWarn.instance.resetWarnings();
      fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'long t=System.currentTimeMillis()+500; while (t>System.currentTimeMillis()) { }; return 0d;';");
      assertInvalidMessage("ran longer than 250ms","SELECT " + fName + "(dval) FROM %s WHERE key=1");
      fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVASCRIPT\n"+ "AS 'var t=java.lang.System.currentTimeMillis()+500; while (t>java.lang.System.currentTimeMillis()) { }; 0;';");
      assertInvalidMessage("ran longer than 250ms","SELECT " + fName + "(dval) FROM %s WHERE key=1");
      return;
    }
 catch (    Error|RuntimeException e) {
      if (i == maxTries)       throw e;
    }
 finally {
      DatabaseDescriptor.setUserDefinedFunctionWarnTimeout(udfWarnTimeout);
      DatabaseDescriptor.setUserDefinedFunctionFailTimeout(udfFailTimeout);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.DeleteTest </h4><pre class="type-6 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deletion by 'composite prefix' (range tombstones) with compaction
 * migrated from cql_tests.py:TestCQL.range_tombstones_compaction_test()
 */
@Test public void testDeleteByCompositePrefixWithCompaction() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v1 text, PRIMARY KEY (k, c1, c2))");
  for (int c1=0; c1 < 4; c1++)   for (int c2=0; c2 < 2; c2++)   execute("INSERT INTO %s (k, c1, c2, v1) VALUES (0, ?, ?, ?)",c1,c2,String.format("%d%d",c1,c2));
  flush();
  execute("DELETE FROM %s WHERE k = 0 AND c1 = 1");
  flush();
  compact();
  Object[][] rows=getRows(execute("SELECT v1 FROM %s WHERE k = 0"));
  int idx=0;
  for (int c1=0; c1 < 4; c1++)   for (int c2=0; c2 < 2; c2++)   if (c1 != 1)   assertEquals(String.format("%d%d",c1,c2),rows[idx++][0]);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deletion by 'composite prefix' (range tombstones)
 * migrated from cql_tests.py:TestCQL.range_tombstones_test()
 */
@Test public void testDeleteByCompositePrefix() throws Throwable {
  createTable("CREATE TABLE %s ( k int, c1 int, c2 int, v1 int, v2 int, PRIMARY KEY (k, c1, c2))");
  int numRows=5;
  int col1=2;
  int col2=2;
  int cpr=col1 * col2;
  for (int i=0; i < numRows; i++)   for (int j=0; j < col1; j++)   for (int k=0; k < col2; k++) {
    int n=(i * cpr) + (j * col2) + k;
    execute("INSERT INTO %s (k, c1, c2, v1, v2) VALUES (?, ?, ?, ?, ?)",i,j,k,n,n);
  }
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s where k = ?",i));
    for (int x=i * cpr; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr][0]);
      assertEquals(x,rows[x - i * cpr][1]);
    }
  }
  for (int i=0; i < numRows; i++)   execute("DELETE FROM %s WHERE k = ? AND c1 = 0",i);
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s WHERE k = ?",i));
    for (int x=i * cpr + col1; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr - col1][0]);
      assertEquals(x,rows[x - i * cpr - col1][1]);
    }
  }
  for (int i=0; i < numRows; i++) {
    Object[][] rows=getRows(execute("SELECT v1, v2 FROM %s WHERE k = ?",i));
    for (int x=i * cpr + col1; x < (i + 1) * cpr; x++) {
      assertEquals(x,rows[x - i * cpr - col1][0]);
      assertEquals(x,rows[x - i * cpr - col1][1]);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deletions
 * migrated from cql_tests.py:TestCQL.no_range_ghost_test()
 */
@Test public void testNoRangeGhost() throws Throwable {
  createTable("CREATE TABLE %s ( k int PRIMARY KEY, v int ) ");
  for (int k=0; k < 5; k++)   execute("INSERT INTO %s (k, v) VALUES (?, 0)",k);
  Object[][] rows=getRows(execute("SELECT k FROM %s"));
  int[] ordered=sortIntRows(rows);
  for (int k=0; k < 5; k++)   assertEquals(k,ordered[k]);
  execute("DELETE FROM %s WHERE k=2");
  rows=getRows(execute("SELECT k FROM %s"));
  ordered=sortIntRows(rows);
  int idx=0;
  for (int k=0; k < 5; k++)   if (k != 2)   assertEquals(k,ordered[idx++]);
  createTable("CREATE TABLE %s ( KEY varchar PRIMARY KEY, password varchar, gender varchar, birth_year bigint)");
  execute("INSERT INTO %s (KEY, password) VALUES ('user1', 'ch@ngem3a')");
  execute("UPDATE %s SET gender = 'm', birth_year = 1980 WHERE KEY = 'user1'");
  assertRows(execute("SELECT * FROM %s WHERE KEY='user1'"),row("user1",1980L,"m","ch@ngem3a"));
  execute("TRUNCATE %s");
  assertEmpty(execute("SELECT * FROM %s"));
  assertEmpty(execute("SELECT * FROM %s WHERE KEY='user1'"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectTest </h4><pre class="type-6 type-7 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test token ranges
 * migrated from cql_tests.py:TestCQL.token_range_test()
 */
@Test public void testTokenRange() throws Throwable {
  createTable(" CREATE TABLE %s (k int PRIMARY KEY, c int, v int)");
  int c=100;
  for (int i=0; i < c; i++)   execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",i,i,i);
  Object[][] res=getRows(execute("SELECT k FROM %s"));
  assertEquals(c,res.length);
  Object[] inOrder=new Object[res.length];
  for (int i=0; i < res.length; i++)   inOrder[i]=res[i][0];
  Long min_token=Long.MIN_VALUE;
  res=getRows(execute(String.format("SELECT k FROM %s.%s WHERE token(k) >= %d",keyspace(),currentTable(),min_token)));
  assertEquals(c,res.length);
  res=getRows(execute(String.format("SELECT k FROM %s.%s WHERE token(k) >= token(%d) AND token(k) < token(%d)",keyspace(),currentTable(),inOrder[32],inOrder[65])));
  for (int i=32; i < 65; i++)   Assert.assertEquals(inOrder[i],res[i - 32][0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnFamilyStoreTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBackupAfterFlush() throws Throwable {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE2).getColumnFamilyStore(CF_STANDARD1);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key1")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key2")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  for (int version=1; version <= 2; ++version) {
    Descriptor existing=new Descriptor(cfs.getDirectories().getDirectoryForNewSSTables(),KEYSPACE2,CF_STANDARD1,version);
    Descriptor desc=new Descriptor(Directories.getBackupsDirectory(existing),KEYSPACE2,CF_STANDARD1,version);
    for (    Component c : new Component[]{Component.DATA,Component.PRIMARY_INDEX,Component.FILTER,Component.STATS})     assertTrue("Cannot find backed-up file:" + desc.filenameFor(c),new File(desc.filenameFor(c)).exists());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DirectoriesTest </h4><pre class="type-6 type-7 type-13 type-15 type-5 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiskFreeSpace(){
  DataDirectory[] dataDirectories=new DataDirectory[]{new DataDirectory(new File("/nearlyFullDir1")){
    public long getAvailableSpace(){
      return 11L;
    }
  }
,new DataDirectory(new File("/nearlyFullDir2")){
    public long getAvailableSpace(){
      return 10L;
    }
  }
,new DataDirectory(new File("/uniformDir1")){
    public long getAvailableSpace(){
      return 1000L;
    }
  }
,new DataDirectory(new File("/uniformDir2")){
    public long getAvailableSpace(){
      return 999L;
    }
  }
,new DataDirectory(new File("/veryFullDir")){
    public long getAvailableSpace(){
      return 4L;
    }
  }
};
  List<Directories.DataDirectoryCandidate> candidates=getWriteableDirectories(dataDirectories,0L);
  assertSame(dataDirectories[2],candidates.get(0).dataDirectory);
  assertSame(dataDirectories[3],candidates.get(1).dataDirectory);
  assertSame(dataDirectories[0],candidates.get(2).dataDirectory);
  assertSame(dataDirectories[1],candidates.get(3).dataDirectory);
  Map<DataDirectory,DataDirectory> testMap=new IdentityHashMap<>();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,5L);
    assertEquals(4,candidates.size());
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 4);
    if (testMap.size() == 4) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
  testMap.clear();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,11L);
    assertEquals(3,candidates.size());
    for (    Directories.DataDirectoryCandidate candidate : candidates)     assertTrue(candidate.dataDirectory.getAvailableSpace() >= 11L);
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 3);
    if (testMap.size() == 3) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.KeyspaceTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRowSingleColumn() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b))");
  for (int i=0; i < 2; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int round=0; round < 2; round++) {
    Row row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").withLimit(1).build());
    assertEquals(ByteBufferUtil.bytes(0),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    for (int i=0; i < 2; i++) {
      row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").includeRow(i).build());
      assertEquals(ByteBufferUtil.bytes(i),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    }
    for (int i=0; i < 2; i++) {
      row=Util.getOnlyRow(Util.cmd(cfs,"0").columns("c").fromIncl(i).toIncl(i).build());
      assertEquals(ByteBufferUtil.bytes(i),row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false))).value());
    }
    if (round == 0)     cfs.forceBlockingFlush();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReversedWithFlushing() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a text, b int, c int, PRIMARY KEY (a, b)) WITH CLUSTERING ORDER BY (b DESC)");
  final ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=0; i < 10; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
  cfs.forceBlockingFlush();
  for (int i=10; i < 20; i++) {
    execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)","0",i,i);
    PartitionColumns columns=PartitionColumns.of(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false)));
    ClusteringIndexSliceFilter filter=new ClusteringIndexSliceFilter(Slices.ALL,false);
    SinglePartitionReadCommand command=singlePartitionSlice(cfs,"0",filter,null);
    try (ReadExecutionController executionController=command.executionController();PartitionIterator iterator=command.executeInternal(executionController)){
      try (RowIterator rowIterator=iterator.next()){
        Row row=rowIterator.next();
        Cell cell=row.getCell(cfs.metadata.getColumnDefinition(new ColumnIdentifier("c",false)));
        assertEquals(ByteBufferUtil.bytes(i),cell.value());
      }
     }
   }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void overlappingRangeTest() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k2";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 20; i++)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,15).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,10).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,2,key).addRangeTombstone(5,8).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Partition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  int nowInSec=FBUtilities.nowInSeconds();
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  CompactionManager.instance.performMaximal(cfs,false);
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RepairedDataTombstonesTest </h4><pre class="type-6 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readTestPartitionTombstones() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=0; i < 10; i++) {
    execute("delete from %s where id=?",i);
  }
  flush();
  SSTableReader repairedSSTable=getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next();
  repair(getCurrentColumnFamilyStore(),repairedSSTable);
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("delete from %s where id=?",i);
  }
  flush();
  Thread.sleep(1000);
  ReadCommand cmd=Util.cmd(getCurrentColumnFamilyStore()).build();
  int partitionsFound=0;
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator iterator=cmd.executeLocally(executionController)){
    while (iterator.hasNext()) {
      partitionsFound++;
      UnfilteredRowIterator rowIter=iterator.next();
      int val=ByteBufferUtil.toInt(rowIter.partitionKey().getKey());
      assertTrue("val=" + val,val >= 10 && val < 20);
    }
  }
   assertEquals(10,partitionsFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowCacheTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRowCache() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert CacheService.instance.rowCache.size() == i + 1;
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,100,10);
  for (int i=100; i < 110; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  int keysLeft=109;
  for (int i=109; i >= 10; i--) {
    cachedStore.invalidateCachedPartition(Util.dk("key" + i));
    assert CacheService.instance.rowCache.size() == keysLeft;
    keysLeft--;
  }
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSSTablesPerReadHistogramWhenRowCache(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  cachedStore.forceBlockingFlush();
  ((ClearableHistogram)cachedStore.metric.sstablesPerReadHistogram.cf).clear();
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_before=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_after=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    double belowMedian=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getValue(0.49D);
    double mean_after=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMean();
    assertEquals("SSTablePerReadHistogram should be updated even key found in row cache",count_before + 1,count_after);
    assertTrue("In half of requests we have not touched SSTables, " + "so 49 percentile (" + belowMedian + ") must be strongly less than 0.9",belowMedian < 0.9D);
    assertTrue("In half of requests we have not touched SSTables, " + "so mean value (" + mean_after + ") must be strongly less than 1, but greater than 0",mean_after < 0.999D && mean_after > 0.001D);
  }
  assertEquals("Min value of SSTablesPerRead should be zero",0,cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMin());
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeRangeTombstones() throws InterruptedException {
  PartitionUpdate update1=new PartitionUpdate(cfm,dk,cfm.partitionColumns(),1);
  writeRangeTombstone(update1,"1","11",123,123);
  writeRangeTombstone(update1,"2","22",123,123);
  writeRangeTombstone(update1,"3","31",123,123);
  writeRangeTombstone(update1,"4","41",123,123);
  PartitionUpdate update2=new PartitionUpdate(cfm,dk,cfm.partitionColumns(),1);
  writeRangeTombstone(update2,"1","11",123,123);
  writeRangeTombstone(update2,"111","112",1230,123);
  writeRangeTombstone(update2,"2","24",123,123);
  writeRangeTombstone(update2,"3","31",1230,123);
  writeRangeTombstone(update2,"4","41",123,1230);
  writeRangeTombstone(update2,"5","51",123,1230);
  try (UnfilteredRowIterator merged=UnfilteredRowIterators.merge(ImmutableList.of(update1.unfilteredIterator(),update2.unfilteredIterator()),nowInSeconds)){
    Object[][] expected=new Object[][]{{"1","11",123l,123},{"111","112",1230l,123},{"2","24",123l,123},{"3","31",1230l,123},{"4","41",123l,1230},{"5","51",123l,1230}};
    int i=0;
    while (merged.hasNext()) {
      RangeTombstoneBoundMarker openMarker=(RangeTombstoneBoundMarker)merged.next();
      Slice.Bound openBound=openMarker.clustering();
      DeletionTime openDeletion=new DeletionTime(openMarker.deletionTime().markedForDeleteAt(),openMarker.deletionTime().localDeletionTime());
      RangeTombstoneBoundMarker closeMarker=(RangeTombstoneBoundMarker)merged.next();
      Slice.Bound closeBound=closeMarker.clustering();
      DeletionTime closeDeletion=new DeletionTime(closeMarker.deletionTime().markedForDeleteAt(),closeMarker.deletionTime().localDeletionTime());
      assertEquals(openDeletion,closeDeletion);
      assertRangeTombstoneMarkers(openBound,closeBound,openDeletion,expected[i++]);
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.TimeSortTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeSort() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY (a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  for (int i=900; i < 1000; ++i)   for (int j=0; j < 8; ++j)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",i,j * 2,0,(long)j * 2);
  validateTimeSort();
  cfs.forceBlockingFlush();
  validateTimeSort();
  DecoratedKey key=Util.dk("900");
  for (int j=0; j < 4; ++j)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,j * 2 + 1,1,(long)j * 2 + 1);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,0,2,100L);
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP ?",900,10,2,100L);
  UntypedResultSet results=execute("SELECT * FROM %s WHERE a = ? AND b >= ? LIMIT 1000",900,0);
  assertEquals(12,results.size());
  Iterator<UntypedResultSet.Row> iter=results.iterator();
  for (int j=0; j < 8; j++) {
    UntypedResultSet.Row row=iter.next();
    assertEquals(j,row.getInt("b"));
  }
  assertRows(execute("SELECT * FROM %s WHERE a = ? AND b IN (?, ?)",900,0,10),row(900,0,2),row(900,10,2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.TransformerTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRowExtension(){
  for (  Filter filter : Filter.values()) {
    List<Check> checks=new ArrayList<>();
    BaseRowIterator<?> iter=extendingIterator(5,filter,checks);
    for (int i=0; i < 5; i++) {
      Unfiltered u=iter.next();
      assert u instanceof Row;
      Assert.assertEquals(i,ByteBufferUtil.toInt(u.clustering().get(0)));
    }
    iter.close();
    for (    Check check : checks)     check.check();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.AntiCompactionTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void antiCompactOne() throws Exception {
  ColumnFamilyStore store=prepareColumnFamilyStore();
  Collection<SSTableReader> sstables=getUnrepairedSSTables(store);
  assertEquals(store.getLiveSSTables().size(),sstables.size());
  Range<Token> range=new Range<Token>(new BytesToken("0".getBytes()),new BytesToken("4".getBytes()));
  List<Range<Token>> ranges=Arrays.asList(range);
  int repairedKeys=0;
  int nonRepairedKeys=0;
  try (LifecycleTransaction txn=store.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    if (txn == null)     throw new IllegalStateException();
    long repairedAt=1000;
    CompactionManager.instance.performAnticompaction(store,ranges,refs,txn,repairedAt);
  }
   assertEquals(2,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    try (ISSTableScanner scanner=sstable.getScanner((RateLimiter)null)){
      while (scanner.hasNext()) {
        UnfilteredRowIterator row=scanner.next();
        if (sstable.isRepaired()) {
          assertTrue(range.contains(row.partitionKey().getToken()));
          repairedKeys++;
        }
 else {
          assertFalse(range.contains(row.partitionKey().getToken()));
          nonRepairedKeys++;
        }
      }
    }
   }
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertFalse(sstable.isMarkedCompacted());
    assertEquals(1,sstable.selfRef().globalCount());
  }
  assertEquals(0,store.getTracker().getCompacting().size());
  assertEquals(repairedKeys,4);
  assertEquals(nonRepairedKeys,6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionAwareWriterTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMajorLeveledCompactionWriter() throws Throwable {
  ColumnFamilyStore cfs=getColumnFamilyStore();
  cfs.disableAutoCompaction();
  int rowCount=20000;
  int targetSSTableCount=50;
  populate(rowCount);
  LifecycleTransaction txn=cfs.getTracker().tryModify(cfs.getLiveSSTables(),OperationType.COMPACTION);
  long beforeSize=txn.originals().iterator().next().onDiskLength();
  int sstableSize=(int)beforeSize / targetSSTableCount;
  CompactionAwareWriter writer=new MajorLeveledCompactionWriter(cfs,cfs.getDirectories(),txn,txn.originals(),sstableSize);
  int rows=compact(cfs,txn,writer);
  assertEquals(targetSSTableCount,cfs.getLiveSSTables().size());
  int[] levelCounts=new int[5];
  assertEquals(rowCount,rows);
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    levelCounts[sstable.getSSTableLevel()]++;
  }
  assertEquals(0,levelCounts[0]);
  assertEquals(10,levelCounts[1]);
  assertEquals(targetSSTableCount - 10,levelCounts[2]);
  for (int i=3; i < levelCounts.length; i++)   assertEquals(0,levelCounts[i]);
  validateData(cfs,rowCount);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LongCompactionsTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStandardColumnCompactions(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("Standard1");
  cfs.clearUnsafe();
  final int ROWS_PER_SSTABLE=10;
  final int SSTABLES=cfs.metadata.params.minIndexInterval * 3 / ROWS_PER_SSTABLE;
  cfs.disableAutoCompaction();
  long maxTimestampExpected=Long.MIN_VALUE;
  Set<DecoratedKey> inserted=new HashSet<DecoratedKey>();
  for (int j=0; j < SSTABLES; j++) {
    for (int i=0; i < ROWS_PER_SSTABLE; i++) {
      DecoratedKey key=Util.dk(String.valueOf(i % 2));
      long timestamp=j * ROWS_PER_SSTABLE + i;
      maxTimestampExpected=Math.max(timestamp,maxTimestampExpected);
      UpdateBuilder.create(cfs.metadata,key).withTimestamp(timestamp).newRow(String.valueOf(i / 2)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).apply();
      inserted.add(key);
    }
    cfs.forceBlockingFlush();
    CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
    assertEquals(inserted.toString(),inserted.size(),Util.getAll(Util.cmd(cfs).build()).size());
  }
  forceCompactions(cfs);
  assertEquals(inserted.toString(),inserted.size(),Util.getAll(Util.cmd(cfs).build()).size());
  CompactionsTest.assertMaxTimestamp(cfs,maxTimestampExpected);
  cfs.truncateBlocking();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.TTLExpiryTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoExpire() throws InterruptedException, IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  long timestamp=System.currentTimeMillis();
  String key="ttl";
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col",ByteBufferUtil.EMPTY_BYTE_BUFFER).add("col7",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col3",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  String noTTLKey="nottl";
  new RowUpdateBuilder(cfs.metadata,timestamp,noTTLKey).add("col311",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Thread.sleep(2000);
  assertEquals(4,cfs.getLiveSSTables().size());
  cfs.enableAutoCompaction(true);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  ISSTableScanner scanner=sstable.getScanner(ColumnFilter.all(sstable.metadata),DataRange.allData(cfs.getPartitioner()),false);
  assertTrue(scanner.hasNext());
  while (scanner.hasNext()) {
    UnfilteredRowIterator iter=scanner.next();
    assertEquals(Util.dk(noTTLKey),iter.partitionKey());
  }
  scanner.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.ViewTest </h4><pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSSTablesInBounds(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(0,5,cfs);
  for (int i=0; i < 5; i++) {
    for (int j=i; j < 5; j++) {
      PartitionPosition min=MockSchema.readerBounds(i);
      PartitionPosition max=MockSchema.readerBounds(j);
      for (      boolean minInc : new boolean[]{true}) {
        for (        boolean maxInc : new boolean[]{true}) {
          if (i == j && !(minInc && maxInc))           continue;
          AbstractBounds<PartitionPosition> bounds=AbstractBounds.bounds(min,minInc,max,maxInc);
          List<SSTableReader> r=ImmutableList.copyOf(initialView.sstablesInBounds(SSTableSet.LIVE,bounds.left,bounds.right));
          Assert.assertEquals(String.format("%d(%s) %d(%s)",i,minInc,j,maxInc),j - i + (minInc ? 0 : -1) + (maxInc ? 1 : 0),r.size());
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.CollectionTypeTest </h4><pre class="type-6 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListComparison(){
  ListType<String> lt=ListType.getInstance(UTF8Type.instance,true);
  ByteBuffer[] lists=new ByteBuffer[]{ByteBufferUtil.EMPTY_BYTE_BUFFER,lt.decompose(ImmutableList.<String>of()),lt.decompose(ImmutableList.of("aa")),lt.decompose(ImmutableList.of("bb")),lt.decompose(ImmutableList.of("bb","cc")),lt.decompose(ImmutableList.of("bb","dd"))};
  for (int i=0; i < lists.length; i++)   assertEquals(lt.compare(lists[i],lists[i]),0);
  for (int i=0; i < lists.length - 1; i++) {
    for (int j=i + 1; j < lists.length; j++) {
      assertEquals(String.format("compare(lists[%d], lists[%d])",i,j),-1,lt.compare(lists[i],lists[j]));
      assertEquals(String.format("compare(lists[%d], lists[%d])",j,i),1,lt.compare(lists[j],lists[i]));
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetComparison(){
  SetType<String> st=SetType.getInstance(UTF8Type.instance,true);
  ByteBuffer[] sets=new ByteBuffer[]{ByteBufferUtil.EMPTY_BYTE_BUFFER,st.decompose(ImmutableSet.<String>of()),st.decompose(ImmutableSet.of("aa")),st.decompose(ImmutableSet.of("bb")),st.decompose(ImmutableSet.of("bb","cc")),st.decompose(ImmutableSet.of("bb","dd"))};
  for (int i=0; i < sets.length; i++)   assertEquals(st.compare(sets[i],sets[i]),0);
  for (int i=0; i < sets.length - 1; i++) {
    for (int j=i + 1; j < sets.length; j++) {
      assertEquals(String.format("compare(sets[%d], sets[%d])",i,j),-1,st.compare(sets[i],sets[j]));
      assertEquals(String.format("compare(sets[%d], sets[%d])",j,i),1,st.compare(sets[j],sets[i]));
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapComparison(){
  MapType<String,String> mt=MapType.getInstance(UTF8Type.instance,UTF8Type.instance,true);
  ByteBuffer[] maps=new ByteBuffer[]{ByteBufferUtil.EMPTY_BYTE_BUFFER,mt.decompose(ImmutableMap.<String,String>of()),mt.decompose(ImmutableMap.of("aa","val1")),mt.decompose(ImmutableMap.of("aa","val2")),mt.decompose(ImmutableMap.of("bb","val1")),mt.decompose(ImmutableMap.of("bb","val1","cc","val3")),mt.decompose(ImmutableMap.of("bb","val1","dd","val3")),mt.decompose(ImmutableMap.of("bb","val1","dd","val4"))};
  for (int i=0; i < maps.length; i++)   assertEquals(mt.compare(maps[i],maps[i]),0);
  for (int i=0; i < maps.length - 1; i++) {
    for (int j=i + 1; j < maps.length; j++) {
      assertEquals(String.format("compare(maps[%d], maps[%d])",i,j),mt.compare(maps[i],maps[j]),-1);
      assertEquals(String.format("compare(maps[%d], maps[%d])",j,i),mt.compare(maps[j],maps[i]),1);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.CompositeTypeTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEscapeUnescape(){
  List<AbstractType<?>> subComparators=new ArrayList<AbstractType<?>>(){
{
      ;
      add(UTF8Type.instance);
      add(UTF8Type.instance);
    }
  }
;
  CompositeType comp=CompositeType.getInstance(subComparators);
  String[][] inputs=new String[][]{new String[]{"foo","bar"},new String[]{"",""},new String[]{"foo\\","bar"},new String[]{"foo\\:","bar"},new String[]{"foo:","bar"},new String[]{"foo","b:ar"},new String[]{"foo!","b:ar"}};
  for (  String[] input : inputs) {
    CompositeType.Builder builder=new CompositeType.Builder(comp);
    for (    String part : input)     builder.add(UTF8Type.instance.fromString(part));
    ByteBuffer value=comp.fromString(comp.getString(builder.build()));
    ByteBuffer[] splitted=comp.split(value);
    for (int i=0; i < splitted.length; i++)     assertEquals(input[i],UTF8Type.instance.getString(splitted[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.DecimalTypeTest </h4><pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test3Sort(){
  ByteBuffer zeroBB=DecimalType.instance.decompose(zero);
  ByteBuffer minusBB=DecimalType.instance.decompose(minus);
  ByteBuffer lowBB=DecimalType.instance.decompose(low);
  ByteBuffer highBB=DecimalType.instance.decompose(high);
  ByteBuffer[] array={highBB,minusBB,lowBB,lowBB,zeroBB,minusBB};
  Arrays.sort(array,DecimalType.instance);
  for (int i=1; i < array.length; i++) {
    BigDecimal i0=DecimalType.instance.compose(array[i - 1]);
    BigDecimal i1=DecimalType.instance.compose(array[i]);
    assertTrue("#" + i,i0.compareTo(i1) <= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.IntegerTypeTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSortingSpecialExtendedVersion(){
  Random rng=new Random(-9078270684023566599L);
  ByteBuffer[] data=new ByteBuffer[10000];
  for (int i=0; i < data.length; i++) {
    data[i]=ByteBuffer.allocate(rng.nextInt(32) + 1);
    rng.nextBytes(data[i].array());
  }
  Arrays.sort(data,comparator);
  for (int i=1; i < data.length; i++) {
    BigInteger i0=new BigInteger(data[i - 1].array());
    BigInteger i1=new BigInteger(data[i].array());
    assertTrue("#" + i,i0.compareTo(i1) <= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.RangeTest </h4><pre class="type-6 type-7 type-13 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRandomOrderedRangeContainmentChecker(){
  Random r=new Random();
  for (int j=0; j < 1000; j++) {
    int numTokens=r.nextInt(300) + 1;
    List<Range<Token>> ranges=new ArrayList<>(numTokens);
    List<Token> tokens=new ArrayList<>(2 * numTokens);
    for (int i=0; i < 2 * numTokens; i++)     tokens.add(t(r.nextLong()));
    Collections.sort(tokens);
    for (int i=0; i < tokens.size(); i++) {
      ranges.add(new Range<>(tokens.get(i),tokens.get(i + 1)));
      i++;
    }
    List<Token> tokensToTest=new ArrayList<>();
    for (int i=0; i < 10000; i++)     tokensToTest.add(t(r.nextLong()));
    tokensToTest.add(t(Long.MAX_VALUE));
    tokensToTest.add(t(Long.MIN_VALUE));
    tokensToTest.add(t(Long.MAX_VALUE - 1));
    tokensToTest.add(t(Long.MIN_VALUE + 1));
    Collections.sort(tokensToTest);
    Range.OrderedRangeContainmentChecker checker=new Range.OrderedRangeContainmentChecker(ranges);
    for (    Token t : tokensToTest) {
      if (checker.contains(t) != Range.isInRanges(t,ranges))       fail(String.format("This should never flap! If it does, it is a bug (ranges = %s, token = %s)",Joiner.on(",").join(ranges),t));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.CustomIndexTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notifyIndexersOfPartitionAndRowRemovalDuringCleanup() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k,c))");
  createIndex(String.format("CREATE CUSTOM INDEX cleanup_index ON %%s() USING '%s'",StubIndex.class.getName()));
  ColumnFamilyStore cfs=getCurrentColumnFamilyStore();
  StubIndex index=(StubIndex)cfs.indexManager.getIndexByName("cleanup_index");
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,1,1);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,2,2);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",3,3,3);
  assertEquals(4,index.rowsInserted.size());
  assertEquals(0,index.partitionDeletions.size());
  ReadCommand cmd=Util.cmd(cfs,0).build();
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator iterator=cmd.executeLocally(executionController)){
    assertTrue(iterator.hasNext());
    cfs.indexManager.deletePartition(iterator.next(),FBUtilities.nowInSeconds());
  }
   assertEquals(1,index.partitionDeletions.size());
  assertEquals(3,index.rowsDeleted.size());
  for (int i=0; i < 3; i++)   assertEquals(index.rowsDeleted.get(i).clustering(),index.rowsInserted.get(i).clustering());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.SASIIndexTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThatTooBigValueIsRejected(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment_suffix_split");
  for (int i=0; i < 10; i++) {
    byte[] randomBytes=new byte[ThreadLocalRandom.current().nextInt(OnDiskIndexBuilder.MAX_TERM_SIZE,5 * OnDiskIndexBuilder.MAX_TERM_SIZE)];
    ThreadLocalRandom.current().nextBytes(randomBytes);
    final ByteBuffer bigValue=UTF8Type.instance.decompose(new String(randomBytes));
    Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
    update(rm,comment,bigValue,System.currentTimeMillis());
    rm.apply();
    Set<String> rows;
    rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,bigValue.duplicate()));
    Assert.assertEquals(0,rows.size());
    store.forceBlockingFlush();
    rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,bigValue.duplicate()));
    Assert.assertEquals(0,rows.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.OnDiskIndexTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testSuperBlocks() throws Exception {
  Map<ByteBuffer,TokenTreeBuilder> terms=new HashMap<>();
  terms.put(UTF8Type.instance.decompose("1234"),keyBuilder(1L,2L));
  terms.put(UTF8Type.instance.decompose("2345"),keyBuilder(3L,4L));
  terms.put(UTF8Type.instance.decompose("3456"),keyBuilder(5L,6L));
  terms.put(UTF8Type.instance.decompose("4567"),keyBuilder(7L,8L));
  terms.put(UTF8Type.instance.decompose("5678"),keyBuilder(9L,10L));
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,Int32Type.instance,OnDiskIndexBuilder.Mode.SPARSE);
  for (  Map.Entry<ByteBuffer,TokenTreeBuilder> entry : terms.entrySet())   addAll(builder,entry.getKey(),entry.getValue());
  File index=File.createTempFile("on-disk-sa-try-superblocks",".db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,Int32Type.instance,new KeyConverter());
  OnDiskIndex.OnDiskSuperBlock superBlock=onDisk.dataLevel.getSuperBlock(0);
  Iterator<Token> iter=superBlock.iterator();
  Long lastToken=null;
  while (iter.hasNext()) {
    Token token=iter.next();
    if (lastToken != null)     Assert.assertTrue(lastToken.compareTo(token.get()) < 0);
    lastToken=token.get();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparseMode() throws Exception {
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,LongType.instance,OnDiskIndexBuilder.Mode.SPARSE);
  final long start=System.currentTimeMillis();
  final int numIterations=100000;
  for (long i=0; i < numIterations; i++)   builder.add(LongType.instance.decompose(start + i),keyAt(i),i);
  File index=File.createTempFile("on-disk-sa-sparse","db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,LongType.instance,new KeyConverter());
  ThreadLocalRandom random=ThreadLocalRandom.current();
  for (long step=start; step < (start + numIterations); step+=1000) {
    boolean lowerInclusive=random.nextBoolean();
    boolean upperInclusive=random.nextBoolean();
    long limit=random.nextLong(step,start + numIterations);
    RangeIterator<Long,Token> rows=onDisk.search(expressionFor(step,lowerInclusive,limit,upperInclusive));
    long lowerKey=step - start;
    long upperKey=lowerKey + (limit - step);
    if (!lowerInclusive)     lowerKey+=1;
    if (upperInclusive)     upperKey+=1;
    Set<DecoratedKey> actual=convert(rows);
    for (long key=lowerKey; key < upperKey; key++)     Assert.assertTrue("key" + key + " wasn't found",actual.contains(keyAt(key)));
    Assert.assertEquals((upperKey - lowerKey),actual.size());
  }
  RangeIterator<Long,Token> rows=onDisk.search(expressionFor(start,true,start + numIterations,true));
  Set<DecoratedKey> actual=convert(rows);
  Assert.assertEquals(numIterations,actual.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.TokenTreeTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildWithMultipleMapsAndIterate() throws Exception {
  final SortedMap<Long,LongSet> merged=new TreeMap<>();
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  builder.add(collidingTokensMap);
  merged.putAll(collidingTokensMap);
  for (  Map.Entry<Long,LongSet> entry : simpleTokenMap.entrySet()) {
    if (merged.containsKey(entry.getKey())) {
      LongSet mergingOffsets=entry.getValue();
      LongSet existingOffsets=merged.get(entry.getKey());
      if (mergingOffsets.equals(existingOffsets))       continue;
      Set<Long> mergeSet=new HashSet<>();
      for (      LongCursor merging : mergingOffsets)       mergeSet.add(merging.value);
      for (      LongCursor existing : existingOffsets)       mergeSet.add(existing.value);
      LongSet mergedResults=new LongOpenHashSet();
      for (      Long result : mergeSet)       mergedResults.add(result);
      merged.put(entry.getKey(),mergedResults);
    }
 else {
      merged.put(entry.getKey(),entry.getValue());
    }
  }
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=merged.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test1","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final Iterator<Token> tokenIterator=tokenTree.iterator(KEY_CONVERTER);
  final Iterator<Map.Entry<Long,LongSet>> listIterator=simpleTokenMap.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),treeNext.get());
    Assert.assertEquals(convert(listNext.getValue()),convert(treeNext));
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=tokens.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeIterateAndSkip() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test2","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final RangeIterator<Long,Token> treeIterator=tokenTree.iterator(KEY_CONVERTER);
  final RangeIterator<Long,TokenWithOffsets> listIterator=new EntrySetSkippableIterator(tokens);
  long lastToken=0L;
  while (treeIterator.hasNext() && lastToken < 12) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(lastToken=treeNext.get()));
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  treeIterator.skipTo(100548L);
  listIterator.skipTo(100548L);
  while (treeIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(long)treeNext.get());
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  Assert.assertFalse("Tree iterator not completed",treeIterator.hasNext());
  Assert.assertFalse("List iterator not completed",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<pre class="type-6 type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenMerge() throws Exception {
  final long min=0, max=1000;
  TokenTree treeA=generateTree(min,max);
  TokenTree treeB=generateTree(min,max);
  RangeIterator<Long,Token> a=treeA.iterator(new KeyConverter());
  RangeIterator<Long,Token> b=treeB.iterator(new KeyConverter());
  long count=min;
  while (a.hasNext() && b.hasNext()) {
    final Token tokenA=a.next();
    final Token tokenB=b.next();
    tokenA.merge(tokenB);
    tokenA.merge(new TokenWithOffsets(tokenA.get(),convert(count + 1)));
    tokenA.merge(new TokenWithOffsets(tokenA.get(),convert(count)));
    try {
      tokenA.merge(new TokenWithOffsets(tokenA.get() + 1,convert(count)));
      Assert.fail();
    }
 catch (    IllegalArgumentException e) {
    }
    final Set<Long> offsets=new TreeSet<>();
    for (    DecoratedKey key : tokenA)     offsets.add(LongType.instance.compose(key.getKey()));
    Set<Long> expected=new TreeSet<>();
{
      expected.add(count);
      expected.add(count + 1);
    }
    Assert.assertEquals(expected,offsets);
    count++;
  }
  Assert.assertEquals(max,count - 1);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeAndGet() throws Exception {
  final long tokMin=0;
  final long tokMax=1000;
  final TokenTree tokenTree=generateTree(tokMin,tokMax);
  for (long i=0; i <= tokMax; i++) {
    TokenTree.OnDiskToken result=tokenTree.get(i,KEY_CONVERTER);
    Assert.assertNotNull("failed to find object for token " + i,result);
    Set<Long> found=result.getOffsets();
    Assert.assertEquals(1,found.size());
    Assert.assertEquals(i,found.toArray()[0]);
  }
  Assert.assertNull("found missing object",tokenTree.get(tokMax + 10,KEY_CONVERTER));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.plan.OperationTest </h4><pre class="type-6 type-7 type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSatisfiedBy() throws Exception {
  final ColumnDefinition timestamp=getColumn(UTF8Type.instance.decompose("timestamp"));
  final ColumnDefinition age=getColumn(UTF8Type.instance.decompose("age"));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)));
  Operation op=builder.complete();
  Unfiltered row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(6)),new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(10)));
  op=builder.complete();
  Set<Integer> exclusions=Sets.newHashSet(0,1,5,6,11);
  for (int i=0; i <= 11; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(6)));
  op=builder.complete();
  exclusions=Sets.newHashSet(0,1,2,3,4,7,8,9,10);
  for (int i=0; i <= 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(0)));
  builder.add(new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10)));
  builder.add(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(7)));
  op=builder.complete();
  exclusions=Sets.newHashSet(7);
  for (int i=0; i < 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(timestamp,Operator.GTE,LongType.instance.decompose(10L)));
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(22L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(timestamp,Operator.GT,LongType.instance.decompose(10L)));
  builder.setRight(new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(0)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10))));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(20),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(0),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(30)));
  op=builder.complete();
  Assert.assertFalse(op.satisfiedBy(null,false));
  Assert.assertFalse(op.satisfiedBy(row,false));
  long now=System.currentTimeMillis();
  row=OperationTest.buildRow(Row.Deletion.regular(new DeletionTime(now - 10,(int)(now / 1000))),buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(deletedCell(age,System.currentTimeMillis(),FBUtilities.nowInSeconds()));
  Assert.assertFalse(op.satisfiedBy(row,true));
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),false));
  }
 catch (  IllegalStateException e) {
  }
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),true));
  }
 catch (  IllegalStateException e) {
    Assert.fail("IllegalStateException should not be thrown when missing column and allowMissingColumns=true");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.MappedBufferTest </h4><pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSequentialIterationWithPadding() throws Exception {
  long numValues=1000;
  int maxPageBits=6;
  int[] paddings=new int[]{0,3,5,7,9,11,13};
  for (int numPageBits=3; numPageBits <= maxPageBits; numPageBits++) {
    for (int typeSize=2; typeSize <= 8; typeSize*=2) {
      for (      int padding : paddings) {
        try (MappedBuffer buffer=createTestFile(numValues,typeSize,numPageBits,padding)){
          long offset=0;
          for (long j=0; j < numValues; j++) {
switch (typeSize) {
case 2:
              Assert.assertEquals(j,buffer.getShort(offset));
            break;
case 4:
          Assert.assertEquals(j,buffer.getInt(offset));
        break;
case 8:
      Assert.assertEquals(j,buffer.getLong(offset));
    break;
default :
  throw new AssertionError();
}
offset+=typeSize + padding;
}
}
 }
}
}
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSequentialIteration() throws IOException {
  long numValues=1000;
  for (int typeSize=2; typeSize <= 8; typeSize*=2) {
    try (MappedBuffer buffer=createTestFile(numValues,typeSize,16,0)){
      for (int j=0; j < numValues; j++) {
        Assert.assertEquals(j * typeSize,buffer.position());
switch (typeSize) {
case 2:
          Assert.assertEquals(j,buffer.getShort());
        break;
case 4:
      Assert.assertEquals(j,buffer.getInt());
    break;
case 8:
  Assert.assertEquals(j,buffer.getLong());
break;
default :
throw new AssertionError();
}
}
}
 }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompareToPage() throws IOException {
  long numValues=100;
  int typeSize=8;
  try (MappedBuffer buffer=createTestFile(numValues)){
    for (long i=0; i < numValues * typeSize; i+=typeSize) {
      long value=i / typeSize;
      Assert.assertEquals(0,buffer.comparePageTo(i,typeSize,LongType.instance,LongType.instance.decompose(value)));
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPageRegion() throws Exception {
  ThreadLocalRandom random=ThreadLocalRandom.current();
  int numLongs=1000;
  int byteSize=8;
  int capacity=numLongs * byteSize;
  try (MappedBuffer buffer=createTestFile(numLongs)){
    for (int i=0; i < 1000; i++) {
      int offset=random.nextInt(0,1000 * byteSize - byteSize) & ~(byteSize - 1);
      int length=Math.min(capacity,random.nextInt(byteSize,capacity - offset) & ~(byteSize - 1));
      ByteBuffer region=buffer.getPageRegion(offset,length);
      for (int j=offset; j < (offset + length); j+=8)       Assert.assertEquals(j / 8,region.getLong(j));
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicWriteThenRead() throws Exception {
  long numLongs=10000;
  final MappedBuffer buffer=createTestFile(numLongs);
  Assert.assertEquals(0,buffer.position());
  for (long i=0; i < numLongs; i++) {
    Assert.assertEquals(i * 8,buffer.position());
    Assert.assertEquals(i,buffer.getLong());
  }
  buffer.position(0);
  for (long i=0; i < numLongs; i++) {
    Assert.assertEquals(i,buffer.getLong(i * 8));
    Assert.assertEquals(0,buffer.position());
  }
  for (long i=0; i < Math.min(Integer.MAX_VALUE,numLongs); i++)   Assert.assertEquals(i,buffer.getInt((i * 8) + 4));
  for (long i=0; i < Math.min(Short.MAX_VALUE,numLongs); i++) {
    Assert.assertEquals(i,buffer.getShort((i * 8) + 6));
  }
  for (long i=0; i < 128; i++)   Assert.assertEquals(i,buffer.get((i * 8) + 7));
  buffer.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOpenWithoutPageBits() throws IOException {
  File tmp=File.createTempFile("mapped-buffer","tmp");
  tmp.deleteOnExit();
  RandomAccessFile file=new RandomAccessFile(tmp,"rw");
  long numValues=1000;
  for (long i=0; i < numValues; i++)   file.writeLong(i);
  file.getFD().sync();
  try (MappedBuffer buffer=new MappedBuffer(new ChannelProxy(tmp.getAbsolutePath(),file.getChannel()))){
    Assert.assertEquals(numValues * 8,buffer.limit());
    Assert.assertEquals(numValues * 8,buffer.capacity());
    for (long i=0; i < numValues; i++) {
      Assert.assertEquals(i * 8,buffer.position());
      Assert.assertEquals(i,buffer.getLong());
    }
  }
  finally {
    FileUtils.closeQuietly(file);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.RangeUnionIteratorTest </h4><pre class="type-6 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeIterator(){
  LongIterator tokens=new LongIterator(new long[]{0L,1L,2L,3L});
  Assert.assertEquals(0L,(long)tokens.getMinimum());
  Assert.assertEquals(3L,(long)tokens.getMaximum());
  for (int i=0; i <= 3; i++) {
    Assert.assertTrue(tokens.hasNext());
    Assert.assertEquals(i,(long)tokens.getCurrent());
    Assert.assertEquals(i,(long)tokens.next().get());
  }
  tokens=new LongIterator(new long[]{0L,1L,3L,5L});
  Assert.assertEquals(3L,(long)tokens.skipTo(2L).get());
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(3L,(long)tokens.getCurrent());
  Assert.assertEquals(3L,(long)tokens.next().get());
  Assert.assertEquals(5L,(long)tokens.skipTo(5L).get());
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(5L,(long)tokens.getCurrent());
  Assert.assertEquals(5L,(long)tokens.next().get());
  LongIterator empty=new LongIterator(new long[0]);
  Assert.assertNull(empty.skipTo(3L));
  Assert.assertFalse(empty.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSequences(){
  ThreadLocalRandom random=ThreadLocalRandom.current();
  long[][] values=new long[random.nextInt(1,20)][];
  int numTests=random.nextInt(10,20);
  for (int tests=0; tests < numTests; tests++) {
    RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
    int totalCount=0;
    for (int i=0; i < values.length; i++) {
      long[] part=new long[random.nextInt(1,500)];
      for (int j=0; j < part.length; j++)       part[j]=random.nextLong();
      Arrays.sort(part);
      values[i]=part;
      builder.add(new LongIterator(part));
      totalCount+=part.length;
    }
    long[] totalOrdering=new long[totalCount];
    int index=0;
    for (    long[] part : values) {
      for (      long value : part)       totalOrdering[index++]=value;
    }
    Arrays.sort(totalOrdering);
    int count=0;
    RangeIterator<Long,Token> tokens=builder.build();
    Assert.assertNotNull(tokens);
    while (tokens.hasNext())     Assert.assertEquals(totalOrdering[count++],(long)tokens.next().get());
    Assert.assertEquals(totalCount,count);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMinMaxAndCount(){
  RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
  builder.add(new LongIterator(new long[]{1L,2L,3L}));
  builder.add(new LongIterator(new long[]{4L,5L,6L}));
  builder.add(new LongIterator(new long[]{7L,8L,9L}));
  Assert.assertEquals(9L,(long)builder.getMaximum());
  Assert.assertEquals(9L,builder.getTokenCount());
  RangeIterator<Long,Token> tokens=builder.build();
  Assert.assertNotNull(tokens);
  Assert.assertEquals(1L,(long)tokens.getMinimum());
  Assert.assertEquals(9L,(long)tokens.getMaximum());
  Assert.assertEquals(9L,tokens.getCount());
  for (long i=1; i < 10; i++) {
    Assert.assertTrue(tokens.hasNext());
    Assert.assertEquals(i,(long)tokens.next().get());
  }
  Assert.assertFalse(tokens.hasNext());
  Assert.assertEquals(1L,(long)tokens.getMinimum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressedRandomAccessReaderTest </h4><pre class="type-6 type-7 type-4 type-5 type-14 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataCorruptionDetection() throws IOException {
  String CONTENT="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vitae.";
  File file=new File("testDataCorruptionDetection");
  file.deleteOnExit();
  File metadata=new File(file.getPath() + ".meta");
  metadata.deleteOnExit();
  assertTrue(file.createNewFile());
  assertTrue(metadata.createNewFile());
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(file,metadata.getPath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(CONTENT.getBytes());
    writer.finish();
  }
   try (ChannelProxy channel=new ChannelProxy(file)){
    CompressionMetadata meta=new CompressionMetadata(metadata.getPath(),file.length(),ChecksumType.CRC32);
    CompressionMetadata.Chunk chunk=meta.chunkFor(0);
    try (RandomAccessReader reader=new CompressedRandomAccessReader.Builder(channel,meta).build()){
      assertEquals(CONTENT,reader.readLine());
      Random random=new Random();
      RandomAccessFile checksumModifier=null;
      try {
        checksumModifier=new RandomAccessFile(file,"rw");
        byte[] checksum=new byte[4];
        checksumModifier.seek(chunk.length);
        checksumModifier.read(checksum);
        checksumModifier.seek(chunk.length);
        for (int i=0; i < checksum.length; i++) {
          checksumModifier.write(random.nextInt());
          SyncUtil.sync(checksumModifier);
          try (final RandomAccessReader r=new CompressedRandomAccessReader.Builder(channel,meta).build()){
            Throwable exception=null;
            try {
              r.readLine();
            }
 catch (            Throwable t) {
              exception=t;
            }
            assertNotNull(exception);
            assertSame(exception.getClass(),CorruptSSTableException.class);
            assertSame(exception.getCause().getClass(),CorruptBlockException.class);
          }
         }
        updateChecksum(checksumModifier,chunk.length,checksum);
        try (RandomAccessReader cr=new CompressedRandomAccessReader.Builder(channel,meta).build()){
          assertEquals(CONTENT,cr.readLine());
        }
       }
  finally {
        if (checksumModifier != null)         checksumModifier.close();
      }
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.IndexSummaryManagerTest </h4><pre class="type-6 type-7 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRebuildAtSamplingLevel() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numRows=256;
  for (int row=0; row < numRows; row++) {
    String key=String.format("%3d",row);
    new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  SSTableReader original=sstables.get(0);
  SSTableReader sstable=original;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(asList(sstable),OperationType.UNKNOWN)){
    for (int samplingLevel=1; samplingLevel < BASE_SAMPLING_LEVEL; samplingLevel++) {
      sstable=sstable.cloneWithNewSummarySamplingLevel(cfs,samplingLevel);
      assertEquals(samplingLevel,sstable.getIndexSummarySamplingLevel());
      int expectedSize=(numRows * samplingLevel) / (sstable.metadata.params.minIndexInterval * BASE_SAMPLING_LEVEL);
      assertEquals(expectedSize,sstable.getIndexSummarySize(),1);
      txn.update(sstable,true);
      txn.checkpoint();
    }
    txn.finish();
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.IndexSummaryTest </h4><pre class="type-6 type-7 type-13 type-4 type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDownsample(){
  final int NUM_KEYS=4096;
  final int INDEX_INTERVAL=128;
  final int ORIGINAL_NUM_ENTRIES=NUM_KEYS / INDEX_INTERVAL;
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(NUM_KEYS,INDEX_INTERVAL);
  List<DecoratedKey> keys=random.left;
  IndexSummary original=random.right;
  for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++)   assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(original.getKey(i)));
  List<Integer> samplePattern=Downsampling.getSamplingPattern(BASE_SAMPLING_LEVEL);
  int downsamplingRound=1;
  for (int samplingLevel=BASE_SAMPLING_LEVEL - 1; samplingLevel >= 1; samplingLevel--) {
    try (IndexSummary downsampled=downsample(original,samplingLevel,128,partitioner)){
      assertEquals(entriesAtSamplingLevel(samplingLevel,original.getMaxNumberOfEntries()),downsampled.size());
      int sampledCount=0;
      List<Integer> skipStartPoints=samplePattern.subList(0,downsamplingRound);
      for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++) {
        if (!shouldSkip(i,skipStartPoints)) {
          assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(downsampled.getKey(sampledCount)));
          sampledCount++;
        }
      }
      testPosition(original,downsampled,keys);
      downsamplingRound++;
    }
   }
  IndexSummary previous=original;
  downsamplingRound=1;
  for (int downsampleLevel=BASE_SAMPLING_LEVEL - 1; downsampleLevel >= 1; downsampleLevel--) {
    IndexSummary downsampled=downsample(previous,downsampleLevel,128,partitioner);
    if (previous != original)     previous.close();
    assertEquals(entriesAtSamplingLevel(downsampleLevel,original.getMaxNumberOfEntries()),downsampled.size());
    int sampledCount=0;
    List<Integer> skipStartPoints=samplePattern.subList(0,downsamplingRound);
    for (int i=0; i < ORIGINAL_NUM_ENTRIES; i++) {
      if (!shouldSkip(i,skipStartPoints)) {
        assertEquals(keys.get(i * INDEX_INTERVAL).getKey(),ByteBuffer.wrap(downsampled.getKey(sampledCount)));
        sampledCount++;
      }
    }
    testPosition(original,downsampled,keys);
    previous=downsampled;
    downsamplingRound++;
  }
  previous.close();
  original.close();
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinarySearch(){
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(100,1);
  for (int i=0; i < 100; i++)   assertEquals(i,random.right.binarySearch(random.left.get(i)));
  random.right.close();
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPosition(){
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(100,2);
  for (int i=0; i < 50; i++)   assertEquals(i * 2,random.right.getPosition(i));
  random.right.close();
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOriginalIndexLookup(){
  for (int i=BASE_SAMPLING_LEVEL; i >= 1; i--)   assertEquals(i,Downsampling.getOriginalIndexes(i).size());
  ArrayList<Integer> full=new ArrayList<>();
  for (int i=0; i < BASE_SAMPLING_LEVEL; i++)   full.add(i);
  assertEquals(full,Downsampling.getOriginalIndexes(BASE_SAMPLING_LEVEL));
  assertEquals(full.subList(0,full.size() - 1),Downsampling.getOriginalIndexes(BASE_SAMPLING_LEVEL - 1));
  assertEquals(128,BASE_SAMPLING_LEVEL);
  assertEquals(Arrays.asList(0,32,64,96),Downsampling.getOriginalIndexes(4));
  assertEquals(Arrays.asList(0,64),Downsampling.getOriginalIndexes(2));
  assertEquals(Arrays.asList(0),Downsampling.getOriginalIndexes(1));
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetKey(){
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(100,1);
  for (int i=0; i < 100; i++)   assertEquals(random.left.get(i).getKey(),ByteBuffer.wrap(random.right.getKey(i)));
  random.right.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization() throws IOException {
  Pair<List<DecoratedKey>,IndexSummary> random=generateRandomIndex(100,1);
  DataOutputBuffer dos=new DataOutputBuffer();
  IndexSummary.serializer.serialize(random.right,dos,false);
  dos.writeUTF("JUNK");
  dos.writeUTF("JUNK");
  FileUtils.closeQuietly(dos);
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(dos.toByteArray()));
  IndexSummary is=IndexSummary.serializer.deserialize(dis,partitioner,false,1,1);
  for (int i=0; i < 100; i++)   assertEquals(i,is.binarySearch(random.left.get(i)));
  assertEquals(dis.readUTF(),"JUNK");
  assertEquals(dis.readUTF(),"JUNK");
  is.close();
  FileUtils.closeQuietly(dis);
  random.right.close();
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNumberOfSkippedEntriesAfterIndex(){
  int indexInterval=128;
  for (int i=0; i < BASE_SAMPLING_LEVEL; i++)   assertEquals(indexInterval,Downsampling.getEffectiveIndexIntervalAfterIndex(i,BASE_SAMPLING_LEVEL,indexInterval));
  for (int i=0; i < BASE_SAMPLING_LEVEL - 2; i++)   assertEquals(indexInterval,Downsampling.getEffectiveIndexIntervalAfterIndex(i,BASE_SAMPLING_LEVEL - 1,indexInterval));
  assertEquals(indexInterval * 2,Downsampling.getEffectiveIndexIntervalAfterIndex(BASE_SAMPLING_LEVEL - 2,BASE_SAMPLING_LEVEL - 1,indexInterval));
  assertEquals(128,BASE_SAMPLING_LEVEL);
  assertEquals(64 * indexInterval,Downsampling.getEffectiveIndexIntervalAfterIndex(0,2,indexInterval));
  assertEquals(64 * indexInterval,Downsampling.getEffectiveIndexIntervalAfterIndex(1,2,indexInterval));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableRewriterTest </h4><pre class="type-6 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_abort() throws Exception {
  testNumberOfFiles_abort(new RewriterTest(){
    public void run(    ISSTableScanner scanner,    CompactionController controller,    SSTableReader sstable,    ColumnFamilyStore cfs,    SSTableRewriter rewriter,    LifecycleTransaction txn){
      try (CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
        int files=1;
        while (ci.hasNext()) {
          rewriter.append(ci.next());
          if (rewriter.currentWriter().getFilePointer() > 25000000) {
            rewriter.switchWriter(getWriter(cfs,sstable.descriptor.directory,txn));
            files++;
            assertEquals(cfs.getLiveSSTables().size(),files);
          }
        }
        rewriter.abort();
      }
     }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * emulates anticompaction - writing from one source sstable to two new sstables
 * @throws IOException
 */
@Test public void testTwoWriters() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,false);SSTableRewriter writer2=new SSTableRewriter(txn,1000,false,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    writer2.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      if (writer.currentWriter().getFilePointer() < 15000000)       writer.append(ci.next());
 else       writer2.append(ci.next());
    }
    for (int i=0; i < 5000; i++)     assertFalse(Util.getOnlyPartition(Util.cmd(cfs,ByteBufferUtil.bytes(i)).build()).isEmpty());
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_truncate() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  cfs.disableAutoCompaction();
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 25000000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
      }
    }
    sstables=rewriter.finish();
  }
   LifecycleTransaction.waitForDeletions();
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFilesAndSizes() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  long startStorageMetricsLoad=StorageMetrics.load.getCount();
  long sBytesOnDisk=s.bytesOnDisk();
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 25000000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
        assertEquals(s.bytesOnDisk(),cfs.metric.liveDiskSpaceUsed.getCount());
        assertEquals(s.bytesOnDisk(),cfs.metric.totalDiskSpaceUsed.getCount());
      }
    }
    sstables=rewriter.finish();
  }
   LifecycleTransaction.waitForDeletions();
  long sum=0;
  for (  SSTableReader x : cfs.getLiveSSTables())   sum+=x.bytesOnDisk();
  assertEquals(sum,cfs.metric.liveDiskSpaceUsed.getCount());
  assertEquals(startStorageMetricsLoad - sBytesOnDisk + sum,StorageMetrics.load.getCount());
  assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertEquals(sum,cfs.metric.totalDiskSpaceUsed.getCount());
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPositionsTest() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=new HashSet<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  boolean checked=false;
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      UnfilteredRowIterator row=ci.next();
      writer.append(row);
      if (!checked && writer.currentWriter().getFilePointer() > 1500000) {
        checked=true;
        for (        SSTableReader sstable : cfs.getLiveSSTables()) {
          if (sstable.openReason == SSTableReader.OpenReason.EARLY) {
            SSTableReader c=txn.current(sstables.iterator().next());
            Collection<Range<Token>> r=Arrays.asList(new Range<>(cfs.getPartitioner().getMinimumToken(),cfs.getPartitioner().getMinimumToken()));
            List<Pair<Long,Long>> tmplinkPositions=sstable.getPositionsForRanges(r);
            List<Pair<Long,Long>> compactingPositions=c.getPositionsForRanges(r);
            assertEquals(1,tmplinkPositions.size());
            assertEquals(1,compactingPositions.size());
            assertEquals(0,tmplinkPositions.get(0).left.longValue());
            assertEquals(tmplinkPositions.get(0).right.longValue(),compactingPositions.get(0).left.longValue());
            assertEquals(c.uncompressedLength(),compactingPositions.get(0).right.longValue());
          }
        }
      }
    }
    assertTrue(checked);
    writer.finish();
  }
   LifecycleTransaction.waitForDeletions();
  validateCFS(cfs);
  int filecounts=assertFileCounts(sstables.iterator().next().descriptor.directory.list());
  assertEquals(1,filecounts);
  truncate(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_finish_empty_new_writer() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getFilePointer() > 2500000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
      }
      if (files == 3) {
        rewriter.finish();
        break;
      }
    }
  }
   LifecycleTransaction.waitForDeletions();
  assertEquals(files - 1,cfs.getLiveSSTables().size());
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_abort3() throws Exception {
  testNumberOfFiles_abort(new RewriterTest(){
    public void run(    ISSTableScanner scanner,    CompactionController controller,    SSTableReader sstable,    ColumnFamilyStore cfs,    SSTableRewriter rewriter,    LifecycleTransaction txn){
      try (CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
        int files=1;
        while (ci.hasNext()) {
          rewriter.append(ci.next());
          if (files == 1 && rewriter.currentWriter().getFilePointer() > 10000000) {
            rewriter.switchWriter(getWriter(cfs,sstable.descriptor.directory,txn));
            files++;
            assertEquals(cfs.getLiveSSTables().size(),files);
          }
        }
        rewriter.abort();
      }
     }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_dont_clean_readers() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 25000000) {
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
        assertEquals(cfs.getLiveSSTables().size(),files);
      }
    }
    sstables=rewriter.finish();
  }
   assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumberOfFiles_abort2() throws Exception {
  testNumberOfFiles_abort(new RewriterTest(){
    public void run(    ISSTableScanner scanner,    CompactionController controller,    SSTableReader sstable,    ColumnFamilyStore cfs,    SSTableRewriter rewriter,    LifecycleTransaction txn){
      try (CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
        int files=1;
        while (ci.hasNext()) {
          rewriter.append(ci.next());
          if (rewriter.currentWriter().getFilePointer() > 25000000) {
            rewriter.switchWriter(getWriter(cfs,sstable.descriptor.directory,txn));
            files++;
            assertEquals(cfs.getLiveSSTables().size(),files);
          }
          if (files == 3) {
            rewriter.abort();
            break;
          }
        }
      }
     }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCanonicalView() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  boolean checked=false;
  try (ISSTableScanner scanner=sstables.iterator().next().getScanner();CompactionController controller=new CompactionController(cfs,sstables,0);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      writer.append(ci.next());
      if (!checked && writer.currentWriter().getFilePointer() > 15000000) {
        checked=true;
        ColumnFamilyStore.ViewFragment viewFragment=cfs.select(View.select(SSTableSet.CANONICAL));
        assertEquals(1,viewFragment.sstables.size());
        SSTableReader sstable=viewFragment.sstables.get(0);
        assertEquals(s.descriptor,sstable.descriptor);
        assertTrue("Found early opened SSTable in canonical view: " + sstable.getFilename(),sstable.openReason != SSTableReader.OpenReason.EARLY);
      }
    }
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSmallFiles() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  cfs.disableAutoCompaction();
  SSTableReader s=writeFile(cfs,400);
  cfs.addSSTable(s);
  Set<SSTableReader> compacting=Sets.newHashSet(s);
  List<SSTableReader> sstables;
  int files=1;
  try (ISSTableScanner scanner=s.getScanner();CompactionController controller=new CompactionController(cfs,compacting,0);LifecycleTransaction txn=cfs.getTracker().tryModify(compacting,OperationType.UNKNOWN);SSTableRewriter rewriter=new SSTableRewriter(txn,1000,false,1000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
    while (ci.hasNext()) {
      rewriter.append(ci.next());
      if (rewriter.currentWriter().getOnDiskFilePointer() > 2500000) {
        assertEquals(files,cfs.getLiveSSTables().size());
        rewriter.switchWriter(getWriter(cfs,s.descriptor.directory,txn));
        files++;
      }
    }
    sstables=rewriter.finish();
  }
   assertEquals(files,sstables.size());
  assertEquals(files,cfs.getLiveSSTables().size());
  LifecycleTransaction.waitForDeletions();
  assertFileCounts(s.descriptor.directory.list());
  validateCFS(cfs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableScannerTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleDataRange() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(TABLE);
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=2; i < 10; i++)   insertRowWithKey(store.metadata,i);
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  ISSTableScanner scanner=sstable.getScanner(null);
  for (int i=2; i < 10; i++)   assertEquals(toKey(i),new String(scanner.next().partitionKey().getKey().array()));
  scanner.close();
  assertScanMatches(sstable,3,6,3,6);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,2,9,2,9);
  assertScanMatches(sstable,3,9,3,9);
  assertScanMatches(sstable,1,8,2,8);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,1,9,2,9);
  assertScanMatches(sstable,2,2,2,2);
  assertScanMatches(sstable,5,5,5,5);
  assertScanMatches(sstable,9,9,9,9);
  assertScanEmpty(sstable,0,1);
  assertScanEmpty(sstable,10,11);
  assertScanMatches(sstable,5,3,2,3,5,9);
  assertScanMatches(sstable,5,2,2,2,5,9);
  assertScanMatches(sstable,5,1,5,9);
  assertScanMatches(sstable,5,Integer.MIN_VALUE,5,9);
  assertScanMatches(sstable,9,8,2,8,9,9);
  assertScanMatches(sstable,9,3,2,3,9,9);
  assertScanMatches(sstable,9,2,2,2,9,9);
  assertScanMatches(sstable,9,1,9,9);
  assertScanMatches(sstable,9,Integer.MIN_VALUE,9,9);
  assertScanMatches(sstable,8,3,2,3,8,9);
  assertScanMatches(sstable,8,2,2,2,8,9);
  assertScanMatches(sstable,8,1,8,9);
  assertScanMatches(sstable,8,Integer.MIN_VALUE,8,9);
  assertScanMatches(sstable,10,9,2,9);
  assertScanMatches(sstable,10,5,2,5);
  assertScanMatches(sstable,10,2,2,2);
  assertScanEmpty(sstable,10,1);
  assertScanEmpty(sstable,10,Integer.MIN_VALUE);
  assertScanMatches(sstable,11,10,2,9);
  assertScanMatches(sstable,11,9,2,9);
  assertScanMatches(sstable,11,5,2,5);
  assertScanMatches(sstable,11,2,2,2);
  assertScanEmpty(sstable,11,1);
  assertScanEmpty(sstable,11,Integer.MIN_VALUE);
  assertScanMatches(sstable,3,1,3,9);
  assertScanMatches(sstable,3,Integer.MIN_VALUE,3,9);
  assertScanMatches(sstable,2,1,2,9);
  assertScanMatches(sstable,2,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,0,2,9);
  assertScanMatches(sstable,1,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,-1,2,9);
  assertScanMatches(sstable,1,Integer.MIN_VALUE,2,9);
  assertScanMatches(sstable,1,0,2,9);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedDataOutputStreamTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriteUTFBigChar() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput dataOut=new DataOutputStream(baos);
  StringBuilder sb=new StringBuilder(65535);
  for (int ii=0; ii < 1 << 15; ii++) {
    String s=sb.toString();
    UnbufferedDataOutputStreamPlus.writeUTF(s,dataOut);
    DataInput dataIn=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    assertEquals(s,dataIn.readUTF());
    baos.reset();
    if (ii == (1 << 15) - 1)     sb.append("a");
 else     sb.append(twoByte);
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriteUTF() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput dataOut=new DataOutputStream(baos);
  StringBuilder sb=new StringBuilder(65535);
  for (int ii=0; ii < 1 << 16; ii++) {
    String s=sb.toString();
    UnbufferedDataOutputStreamPlus.writeUTF(s,dataOut);
    DataInput dataIn=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    assertEquals(s,dataIn.readUTF());
    baos.reset();
    sb.append("a");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedRandomAccessFileTest </h4><pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBytesRemaining() throws IOException {
  SequentialWriter w=createTempFile("brafBytesRemaining");
  int toWrite=RandomAccessReader.DEFAULT_BUFFER_SIZE + 10;
  w.write(generateByteArray(toWrite));
  w.sync();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader r=RandomAccessReader.open(channel);
  assertEquals(r.bytesRemaining(),toWrite);
  for (int i=1; i <= r.length(); i++) {
    r.read();
    assertEquals(r.bytesRemaining(),r.length() - i);
  }
  r.seek(0);
  r.skipBytes(10);
  assertEquals(r.bytesRemaining(),r.length() - 10);
  w.finish();
  r.close();
  channel.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MmappedRegionsTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopy() throws Exception {
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  MmappedRegions snapshot;
  ChannelProxy channelCopy;
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSnapshot",buffer));MmappedRegions regions=MmappedRegions.map(channel,buffer.capacity() / 4)){
    regions.extend(buffer.capacity() / 2);
    regions.extend(3 * buffer.capacity() / 4);
    regions.extend(buffer.capacity());
    snapshot=regions.sharedCopy();
    channelCopy=channel.sharedCopy();
  }
   assertFalse(snapshot.isCleanedUp());
  final int SIZE=buffer.capacity() / 4;
  for (int i=0; i < buffer.capacity(); i++) {
    MmappedRegions.Region region=snapshot.floor(i);
    assertNotNull(region);
    assertEquals(SIZE * (i / SIZE),region.bottom());
    assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    assertNotNull(region.buffer.duplicate().getInt());
  }
  assertNull(snapshot.close(null));
  assertNull(channelCopy.close(null));
  assertTrue(snapshot.isCleanedUp());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSmallSegmentSize() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(4096);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSmallSegmentSize",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(1024);
    regions.extend(2048);
    regions.extend(4096);
    final int SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(SIZE * (i / SIZE),region.bottom());
      assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllocRegions() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(MmappedRegions.MAX_SEGMENT_SIZE * MmappedRegions.REGION_ALLOC_SIZE * 3);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testAllocRegions",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(buffer.capacity());
    final int SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(SIZE * (i / SIZE),region.bottom());
      assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapForCompressionMetadata() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  File f=File.createTempFile("testMapForCompressionMetadata","1");
  f.deleteOnExit();
  File cf=File.createTempFile(f.getName() + ".metadata","1");
  cf.deleteOnExit();
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(f,cf.getAbsolutePath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(buffer);
    writer.finish();
  }
   CompressionMetadata metadata=new CompressionMetadata(cf.getAbsolutePath(),f.length(),ChecksumType.CRC32);
  try (ChannelProxy channel=new ChannelProxy(f);MmappedRegions regions=MmappedRegions.map(channel,metadata)){
    assertFalse(regions.isEmpty());
    int i=0;
    while (i < buffer.capacity()) {
      CompressionMetadata.Chunk chunk=metadata.chunkFor(i);
      MmappedRegions.Region region=regions.floor(chunk.offset);
      assertNotNull(region);
      ByteBuffer compressedChunk=region.buffer.duplicate();
      assertNotNull(compressedChunk);
      assertEquals(chunk.length + 4,compressedChunk.capacity());
      assertEquals(chunk.offset,region.bottom());
      assertEquals(chunk.offset + chunk.length + 4,region.top());
      i+=metadata.chunkLength();
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
    metadata.close();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtendOutOfOrder() throws Exception {
  ByteBuffer buffer=allocateBuffer(4096);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testExtendOutOfOrder",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(4096);
    regions.extend(1024);
    regions.extend(2048);
    for (int i=0; i < buffer.capacity(); i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(0,region.bottom());
      assertEquals(4096,region.top());
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoSegments() throws Exception {
  ByteBuffer buffer=allocateBuffer(2048);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testTwoSegments",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    regions.extend(1024);
    for (int i=0; i < 1024; i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      assertEquals(0,region.bottom());
      assertEquals(1024,region.top());
    }
    regions.extend(2048);
    for (int i=0; i < 2048; i++) {
      MmappedRegions.Region region=regions.floor(i);
      assertNotNull(region);
      if (i < 1024) {
        assertEquals(0,region.bottom());
        assertEquals(1024,region.top());
      }
 else {
        assertEquals(1024,region.bottom());
        assertEquals(2048,region.top());
      }
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.NIODataInputStreamTest </h4><pre class="type-6 type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntSmallBuffer() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    ByteBuffer buf=ByteBuffer.allocate(Math.max(1,ii));
    long value=0;
    if (ii > 0)     value=(1L << 7 * ii) - 1;
    BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
    out.writeUnsignedVInt(value);
    buf.position(0);
    RebufferingInputStream in=new DataInputBuffer(buf,false);
    assertEquals(value,in.readUnsignedVInt());
    boolean threw=false;
    try {
      in.readUnsignedVInt();
    }
 catch (    EOFException e) {
      threw=true;
    }
    assertTrue(threw);
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("resource") @Test public void testAvailable() throws Exception {
  init();
  DummyChannel dc=new DummyChannel();
  dc.slices.clear();
  dc.slices.offer(ByteBuffer.allocate(8190));
  NIODataInputStream is=new NIODataInputStream(dc,4096);
  assertEquals(0,is.available());
  is.read();
  assertEquals(4095,is.available());
  is.read(new byte[4095]);
  assertEquals(0,is.available());
  is.read(new byte[10]);
  assertEquals(8190 - 10 - 4096,is.available());
  File f=File.createTempFile("foo","bar");
  RandomAccessFile fos=new RandomAccessFile(f,"rw");
  fos.write(new byte[10]);
  fos.seek(0);
  is=new NIODataInputStream(fos.getChannel(),9);
  int remaining=10;
  assertEquals(10,is.available());
  while (remaining > 0) {
    is.read();
    remaining--;
    assertEquals(remaining,is.available());
  }
  assertEquals(0,is.available());
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntTruncationEOF() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    ByteBuffer buf=ByteBuffer.allocate(Math.max(1,ii));
    long value=0;
    if (ii > 0)     value=(1L << 7 * ii) - 1;
    BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
    out.writeUnsignedVInt(value);
    buf.position(0);
    ByteBuffer truncated=ByteBuffer.allocate(buf.capacity() - 1);
    buf.limit(buf.limit() - 1);
    truncated.put(buf);
    truncated.flip();
    RebufferingInputStream in=new DataInputBuffer(truncated,false);
    boolean threw=false;
    try {
      in.readUnsignedVInt();
    }
 catch (    EOFException e) {
      threw=true;
    }
    assertTrue(threw);
  }
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntRemainingBytes() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    for (int zz=0; zz < 10; zz++) {
      if (zz + ii > 10)       continue;
      ByteBuffer buf=ByteBuffer.allocate(10);
      buf.position(ii);
      long value=0;
      if (ii > 0)       value=(1L << 7 * zz) - 1;
      BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
      out.writeUnsignedVInt(value);
      buf.position(ii);
      RebufferingInputStream in=new DataInputBuffer(buf,false);
      assertEquals(value,in.readUnsignedVInt());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.RandomAccessReaderTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReset() throws IOException {
  File f=File.createTempFile("testMark","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  final int numIterations=10;
  try (SequentialWriter writer=SequentialWriter.open(f)){
    for (int i=0; i < numIterations; i++)     writer.write(expected.getBytes());
    writer.finish();
  }
   assert f.exists();
  try (ChannelProxy channel=new ChannelProxy(f);RandomAccessReader reader=new RandomAccessReader.Builder(channel).build()){
    assertEquals(expected.length() * numIterations,reader.length());
    ByteBuffer b=ByteBufferUtil.read(reader,expected.length());
    assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    assertFalse(reader.isEOF());
    assertEquals((numIterations - 1) * expected.length(),reader.bytesRemaining());
    FileMark mark=reader.mark();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark(mark));
    reader.reset(mark);
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    reader.reset();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.SimpleStrategyTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetEndpointsDuringBootstrap() throws UnknownHostException {
  final int RING_SIZE=10;
  TokenMetadata tmd=new TokenMetadata();
  TokenMetadata oldTmd=StorageServiceAccessor.setTokenMetadata(tmd);
  Token[] endpointTokens=new Token[RING_SIZE];
  Token[] keyTokens=new Token[RING_SIZE];
  for (int i=0; i < RING_SIZE; i++) {
    endpointTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i));
    keyTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i + RING_SIZE));
  }
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  for (int i=0; i < endpointTokens.length; i++) {
    InetAddress ep=InetAddress.getByName("127.0.0." + String.valueOf(i + 1));
    tmd.updateNormalToken(endpointTokens[i],ep);
    hosts.add(ep);
  }
  Token bsToken=new BigIntegerToken(String.valueOf(210));
  InetAddress bootstrapEndpoint=InetAddress.getByName("127.0.0.11");
  tmd.addBootstrapToken(bsToken,bootstrapEndpoint);
  AbstractReplicationStrategy strategy=null;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    PendingRangeCalculatorService.calculatePendingRanges(strategy,keyspaceName);
    int replicationFactor=strategy.getReplicationFactor();
    for (int i=0; i < keyTokens.length; i++) {
      Collection<InetAddress> endpoints=tmd.getWriteEndpoints(keyTokens[i],keyspaceName,strategy.getNaturalEndpoints(keyTokens[i]));
      assertTrue(endpoints.size() >= replicationFactor);
      for (int j=0; j < replicationFactor; j++) {
        assertTrue(endpoints.contains(hosts.get((i + j + 1) % hosts.size())));
      }
      if (i < RING_SIZE - replicationFactor)       assertFalse(endpoints.contains(bootstrapEndpoint));
 else       assertTrue(endpoints.contains(bootstrapEndpoint));
    }
  }
  StorageServiceAccessor.setTokenMetadata(oldTmd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.metrics.LatencyMetricsTest </h4><pre class="type-6 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
/** 
 * Test bitsets in a "real-world" environment, i.e., bloom filters
 */
@Test public void testGetRecentLatency(){
  final LatencyMetrics l=new LatencyMetrics("test","test");
  Runnable r=new Runnable(){
    public void run(){
      for (int i=0; i < 10000; i++) {
        l.addNano(1000);
      }
    }
  }
;
  new Thread(r).start();
  for (int i=0; i < 10000; i++) {
    Double recent=l.latency.getOneMinuteRate();
    assertFalse(recent.equals(Double.POSITIVE_INFINITY));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.DefsTest </h4><pre class="type-6 type-7 type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCFMetaDataApply() throws ConfigurationException {
  CFMetaData cfm=CFMetaData.Builder.create(KEYSPACE1,"TestApplyCFM_CF").addPartitionKey("keys",BytesType.instance).addClusteringColumn("col",BytesType.instance).build();
  for (int i=0; i < 5; i++) {
    ByteBuffer name=ByteBuffer.wrap(new byte[]{(byte)i});
    cfm.addColumnDefinition(ColumnDefinition.regularDef(cfm,name,BytesType.instance));
  }
  cfm.comment("No comment").readRepairChance(0.5).gcGraceSeconds(100000).compaction(CompactionParams.scts(ImmutableMap.of("min_threshold","500","max_threshold","500")));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
  CFMetaData cfNew=cfm.copy();
  ColumnDefinition addIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{5}),BytesType.instance);
  cfNew.addColumnDefinition(addIndexDef);
  ColumnDefinition removeIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{0}),BytesType.instance);
  assertTrue(cfNew.removeColumnDefinition(removeIndexDef));
  cfm.apply(cfNew);
  for (int i=1; i < cfm.allColumns().size(); i++)   assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{1})));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{0})));
  assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.LeaveAndBootstrapTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test pending ranges and write endpoints when multiple nodes are on the move
 * simultaneously
 */
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] LEAVING=new int[]{6,8,9};
  for (  int leaving : LEAVING)   ss.onChange(hosts.get(leaving),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(leaving))));
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  Collection<InetAddress> endpoints=null;
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("LeaveAndBootstrapTestKeyspace" + i,getStrategy("LeaveAndBootstrapTestKeyspace" + i,tmd));
  }
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(KEYSPACE1,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.1.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.put(KEYSPACE4,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.1","127.0.0.2","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(7,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
  ss.onChange(hosts.get(LEAVING[0]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[0])),Gossiper.computeExpireTime()));
  ss.onChange(hosts.get(LEAVING[2]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[2])),Gossiper.computeExpireTime()));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(5))));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("15")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("25")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.2","127.0.0.7"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.MoveTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] MOVING=new int[]{6,8,9};
  Map<Integer,Token> newTokens=new HashMap<Integer,Token>();
  for (  int movingIndex : MOVING) {
    Token newToken=positionToken(movingIndex);
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.moving(newToken));
    newTokens.put(movingIndex,newToken);
  }
  Collection<InetAddress> endpoints;
  tmd=tmd.cloneAfterAllSettled();
  ss.setTokenMetadataUnsafe(tmd);
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("MoveTestKeyspace" + i,getStrategy("MoveTestKeyspace" + i,tmd));
  }
  Multimap<InetAddress,Range<Token>> keyspace1ranges=keyspaceStrategyMap.get(Simple_RF1_KeyspaceName).getAddressRanges();
  Collection<Range<Token>> ranges1=keyspace1ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(1,collectionSize(ranges1));
  assertEquals(generateRange(97,0),ranges1.iterator().next());
  Collection<Range<Token>> ranges2=keyspace1ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(1,collectionSize(ranges2));
  assertEquals(generateRange(0,10),ranges2.iterator().next());
  Collection<Range<Token>> ranges3=keyspace1ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(1,collectionSize(ranges3));
  assertEquals(generateRange(10,20),ranges3.iterator().next());
  Collection<Range<Token>> ranges4=keyspace1ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(1,collectionSize(ranges4));
  assertEquals(generateRange(20,30),ranges4.iterator().next());
  Collection<Range<Token>> ranges5=keyspace1ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(1,collectionSize(ranges5));
  assertEquals(generateRange(30,40),ranges5.iterator().next());
  Collection<Range<Token>> ranges6=keyspace1ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(1,collectionSize(ranges6));
  assertEquals(generateRange(40,50),ranges6.iterator().next());
  Collection<Range<Token>> ranges7=keyspace1ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(1,collectionSize(ranges7));
  assertEquals(generateRange(50,67),ranges7.iterator().next());
  Collection<Range<Token>> ranges8=keyspace1ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(1,collectionSize(ranges8));
  assertEquals(generateRange(67,70),ranges8.iterator().next());
  Collection<Range<Token>> ranges9=keyspace1ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(1,collectionSize(ranges9));
  assertEquals(generateRange(70,87),ranges9.iterator().next());
  Collection<Range<Token>> ranges10=keyspace1ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(1,collectionSize(ranges10));
  assertEquals(generateRange(87,97),ranges10.iterator().next());
  Multimap<InetAddress,Range<Token>> keyspace3ranges=keyspaceStrategyMap.get(KEYSPACE3).getAddressRanges();
  ranges1=keyspace3ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),5);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,50,67,87,97,67,70)));
  ranges2=keyspace3ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),5);
  assertTrue(ranges2.equals(generateRanges(97,0,70,87,87,97,0,10,67,70)));
  ranges3=keyspace3ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),5);
  assertTrue(ranges3.equals(generateRanges(97,0,70,87,87,97,0,10,10,20)));
  ranges4=keyspace3ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),5);
  assertTrue(ranges4.equals(generateRanges(97,0,20,30,87,97,0,10,10,20)));
  ranges5=keyspace3ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),5);
  assertTrue(ranges5.equals(generateRanges(97,0,30,40,20,30,0,10,10,20)));
  ranges6=keyspace3ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),5);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30,0,10,10,20)));
  ranges7=keyspace3ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),5);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67,20,30,10,20)));
  ranges8=keyspace3ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),5);
  assertTrue(ranges8.equals(generateRanges(40,50,30,40,50,67,20,30,67,70)));
  ranges9=keyspace3ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),5);
  assertTrue(ranges9.equals(generateRanges(40,50,70,87,30,40,50,67,67,70)));
  ranges10=keyspace3ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),5);
  assertTrue(ranges10.equals(generateRanges(40,50,70,87,50,67,87,97,67,70)));
  Multimap<InetAddress,Range<Token>> keyspace4ranges=keyspaceStrategyMap.get(Simple_RF3_KeyspaceName).getAddressRanges();
  ranges1=keyspace4ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),3);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,87,97)));
  ranges2=keyspace4ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),3);
  assertTrue(ranges2.equals(generateRanges(97,0,87,97,0,10)));
  ranges3=keyspace4ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),3);
  assertTrue(ranges3.equals(generateRanges(97,0,0,10,10,20)));
  ranges4=keyspace4ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),3);
  assertTrue(ranges4.equals(generateRanges(20,30,0,10,10,20)));
  ranges5=keyspace4ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),3);
  assertTrue(ranges5.equals(generateRanges(30,40,20,30,10,20)));
  ranges6=keyspace4ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),3);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30)));
  ranges7=keyspace4ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),3);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67)));
  ranges8=keyspace4ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),3);
  assertTrue(ranges8.equals(generateRanges(40,50,50,67,67,70)));
  ranges9=keyspace4ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),3);
  assertTrue(ranges9.equals(generateRanges(70,87,50,67,67,70)));
  ranges10=keyspace4ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),3);
  assertTrue(ranges10.equals(generateRanges(70,87,87,97,67,70)));
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(Simple_RF1_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.put(Simple_RF3_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2"));
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (    Token token : keyTokens) {
      endpoints=tmd.getWriteEndpoints(token,keyspaceName,strategy.getNaturalEndpoints(token));
      assertEquals(expectedEndpoints.get(keyspaceName).get(token).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(token).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
  }
  for (  Integer movingIndex : MOVING) {
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newTokens.get(movingIndex))));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BloomFilterTest </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMurmur3FilterHash(){
  IPartitioner partitioner=new Murmur3Partitioner();
  Iterator<ByteBuffer> gen=new KeyGenerator.RandomStringGenerator(new Random().nextInt(),FilterTestHelper.ELEMENTS);
  long[] expected=new long[2];
  long[] actual=new long[2];
  while (gen.hasNext()) {
    expected[0]=1;
    expected[1]=2;
    actual[0]=3;
    actual[1]=4;
    ByteBuffer key=gen.next();
    FilterKey expectedKey=FilterTestHelper.wrap(key);
    FilterKey actualKey=partitioner.decorateKey(key);
    actualKey.filterHash(actual);
    expectedKey.filterHash(expected);
    Assert.assertArrayEquals(expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.ByteBufferUtilTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHexBytesConversion(){
  for (int i=Byte.MIN_VALUE; i <= Byte.MAX_VALUE; i++) {
    ByteBuffer bb=ByteBuffer.allocate(1);
    bb.put((byte)i);
    bb.clear();
    String s=ByteBufferUtil.bytesToHex(bb);
    ByteBuffer bb2=ByteBufferUtil.hexToBytes(s);
    assertEquals(bb,bb2);
  }
  ByteBuffer bb=ByteBuffer.allocate(4);
  for (int i=0; i < 4; i++) {
    bb.put((byte)i);
  }
  bb.position(1);
  bb.limit(3);
  assertEquals(2,bb.remaining());
  String s=ByteBufferUtil.bytesToHex(bb);
  ByteBuffer bb2=ByteBufferUtil.hexToBytes(s);
  assertEquals(bb,bb2);
  assertEquals("0102",s);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.HexTest </h4><pre class="type-6 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHexBytesConversion(){
  for (int i=Byte.MIN_VALUE; i <= Byte.MAX_VALUE; i++) {
    byte[] b=new byte[]{(byte)i};
    String s=Hex.bytesToHex(b);
    byte[] c=Hex.hexToBytes(s);
    assertArrayEquals(b,c);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NanoTimeToCurrentTimeMillisTest </h4><pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testTimestampOrdering() throws Exception {
  long nowNanos=System.nanoTime();
  long now=System.currentTimeMillis();
  long lastConverted=0;
  for (long ii=0; ii < 10000000; ii++) {
    now=Math.max(now,System.currentTimeMillis());
    if (ii % 10000 == 0) {
      NanoTimeToCurrentTimeMillis.updateNow();
      Thread.sleep(1);
    }
    nowNanos=Math.max(nowNanos,System.nanoTime());
    long convertedNow=NanoTimeToCurrentTimeMillis.convert(nowNanos);
    int maxDiff=FBUtilities.isWindows() ? 15 : 1;
    assertTrue("convertedNow = " + convertedNow + " lastConverted = "+ lastConverted+ " in iteration "+ ii,convertedNow >= (lastConverted - maxDiff));
    maxDiff=FBUtilities.isWindows() ? 25 : 2;
    assertTrue("now = " + now + " convertedNow = "+ convertedNow+ " in iteration "+ ii,(maxDiff - 2) <= convertedNow);
    lastConverted=convertedNow;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.SerializationsTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomFilterRead1000() throws IOException {
  if (EXECUTE_WRITES) {
    testBloomFilterWrite1000(true,false);
    testBloomFilterWrite1000(true,true);
  }
  try (DataInputStream in=getInput("3.0","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,true)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   int falsePositive=0;
  int falseNegative=0;
  try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (!present)       falseNegative++;
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (present)       falsePositive++;
    }
  }
   Assert.assertEquals(1000,falseNegative);
  Assert.assertEquals(0,falsePositive);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.btree.BTreeRemovalTest </h4><pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveFromRootWhichIsALeaf(){
  for (int size=1; size < 9; ++size) {
    final Object[] btree=new Object[(size & 1) == 1 ? size : size + 1];
    for (int i=0; i < size; ++i)     btree[i]=i + 1;
    for (int i=0; i < size; ++i) {
      final Object[] result=remove(btree,CMP,i + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      for (int j=0; j < i; ++j)       assertEquals("size " + size + "elem "+ j,btree[j],result[j]);
      for (int j=i; j < size - 1; ++j)       assertEquals("size " + size + "elem "+ j,btree[j + 1],result[j]);
      for (int j=size - 1; j < result.length; ++j)       assertNull("size " + size + "elem "+ j,result[j]);
    }
{
      final Object[] result=remove(btree,CMP,0);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
{
      final Object[] result=remove(btree,CMP,size + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void randomizedTest(){
  Random rand=new Random(2);
  SortedSet<Integer> data=new TreeSet<>();
  for (int i=0; i < 1000; ++i)   data.add(rand.nextInt());
  Object[] btree=BTree.build(data,UpdateFunction.<Integer>noOp());
  assertTrue(BTree.isWellFormed(btree,CMP));
  assertTrue(Iterables.elementsEqual(data,BTree.iterable(btree)));
  while (btree != BTree.empty()) {
    int idx=rand.nextInt(BTree.size(btree));
    Integer val=BTree.findByIndex(btree,idx);
    assertTrue(data.remove(val));
    btree=assertRemove(btree,val);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.BufferPoolTest </h4><pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactIfOutOfCapacity(){
  final int size=4096;
  final int numBuffersInChunk=BufferPool.GlobalPool.MACRO_CHUNK_SIZE / size;
  List<ByteBuffer> buffers=new ArrayList<>(numBuffersInChunk);
  Set<Long> addresses=new HashSet<>(numBuffersInChunk);
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    buffers.add(buffer);
    addresses.add(MemoryUtil.getAddress(buffer));
  }
  for (int i=numBuffersInChunk - 1; i >= 0; i--)   BufferPool.put(buffers.get(i));
  buffers.clear();
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    assertNotNull(buffer);
    assertEquals(size,buffer.capacity());
    addresses.remove(MemoryUtil.getAddress(buffer));
    buffers.add(buffer);
  }
  assertTrue(addresses.isEmpty());
  for (  ByteBuffer buffer : buffers)   BufferPool.put(buffer);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifferentSizeBuffersOnOneChunk(){
  int[] sizes=new int[]{5,1024,4096,8,16000,78,512,256,63,55,89,90,255,32,2048,128};
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=BufferPool.currentChunk().roundUp(buffer.capacity());
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  Random rnd=new Random();
  rnd.setSeed(298347529L);
  while (!buffers.isEmpty()) {
    int index=rnd.nextInt(buffers.size());
    ByteBuffer buffer=buffers.remove(index);
    BufferPool.put(buffer);
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChunkExhausted(){
  final int size=BufferPool.CHUNK_SIZE / 64;
  int[] sizes=new int[128];
  Arrays.fill(sizes,size);
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=buffer.capacity();
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  for (int i=0; i < sizes.length; i++) {
    BufferPool.put(buffers.get(i));
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.vint.VIntCodingTest </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadExtraBytesCount(){
  for (int i=1; i < 8; i++)   Assert.assertEquals(i,VIntCoding.numberOfExtraBytesToRead((byte)((0xFF << (8 - i)) & 0xFF)));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
