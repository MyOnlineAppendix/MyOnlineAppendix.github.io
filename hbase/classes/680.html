<h3 style="margin:0px">Class: org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandler (25 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(22)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(22)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIncrement() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testIncrement".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(Bytes.toBytes(1L))));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  List<TColumnIncrement> incrementColumns=new ArrayList<TColumnIncrement>();
  incrementColumns.add(new TColumnIncrement(wrap(familyAname),wrap(qualifierAname)));
  TIncrement increment=new TIncrement(wrap(rowName),incrementColumns);
  handler.increment(table,increment);
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  assertEquals(1,result.getColumnValuesSize());
  TColumnValue columnValue=result.getColumnValues().get(0);
  assertArrayEquals(Bytes.toBytes(2L),columnValue.getValue());
}

</code></pre>

<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithFilter() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScanWithFilter" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithFilter".getBytes());
  scan.setStopRow("testScanWithFilter\uffff".getBytes());
  scan.setFilterString(wrap(("KeyOnlyFilter()").getBytes()));
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScanWithFilter" + i).getBytes(),results.get(i).getRow());
    assertEquals(0,results.get(i).getColumnValues().get(0).getValue().length);
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithBatchSize() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  for (int i=0; i < 100; i++) {
    String colNum=pad(i,(byte)3);
    TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(("col" + colNum).getBytes()),wrap(("val" + colNum).getBytes()));
    columnValues.add(columnValue);
  }
  TPut put=new TPut(wrap(("testScanWithBatchSize").getBytes()),columnValues);
  handler.put(table,put);
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithBatchSize".getBytes());
  scan.setStopRow("testScanWithBatchSize\uffff".getBytes());
  scan.setBatchSize(10);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=null;
  for (int i=0; i < 10; i++) {
    results=handler.getScannerRows(scanId,1);
    assertEquals(1,results.size());
    List<TColumnValue> cols=results.get(0).getColumnValues();
    assertEquals(10,cols.size());
    for (int y=0; y < 10; y++) {
      int colNum=y + (10 * i);
      String colNumPad=pad(colNum,(byte)3);
      assertArrayEquals(("col" + colNumPad).getBytes(),cols.get(y).getQualifier());
    }
  }
  results=handler.getScannerRows(scanId,1);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,1);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAllTimestamps() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testDeleteAllTimestamps".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValueA.setTimestamp(System.currentTimeMillis() - 10);
  columnValues.add(columnValueA);
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  columnValueA.setTimestamp(System.currentTimeMillis());
  handler.put(table,put);
  TGet get=new TGet(wrap(rowName));
  get.setMaxVersions(2);
  TResult result=handler.get(table,get);
  assertEquals(2,result.getColumnValuesSize());
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<TColumn>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumn.setQualifier(qualifierAname);
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  delete.setDeleteType(TDeleteType.DELETE_COLUMNS);
  handler.deleteSingle(table,delete);
  get=new TGet(wrap(rowName));
  result=handler.get(table,get);
  assertNull(result.getRow());
  assertEquals(0,result.getColumnValuesSize());
}

</code></pre>

<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetScannerResults() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 20; i++) {
    TPut put=new TPut(wrap(("testGetScannerResults" + pad(i,(byte)2)).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testGetScannerResults".getBytes());
  scan.setStopRow("testGetScannerResults05".getBytes());
  List<TResult> results=handler.getScannerResults(table,scan,5);
  assertEquals(5,results.size());
  for (int i=0; i < 5; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan.setStopRow("testGetScannerResults10".getBytes());
  results=handler.getScannerResults(table,scan,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan.setStopRow("testGetScannerResults20".getBytes());
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan=new TScan();
  scan.setColumns(columns);
  scan.setReversed(true);
  scan.setStartRow("testGetScannerResults20".getBytes());
  scan.setStopRow("testGetScannerResults".getBytes());
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(19 - i,(byte)2)).getBytes(),results.get(i).getRow());
  }
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Put valueA to a row, make sure put has happened, then create a mutation object to put valueB
 * and delete ValueA, then check that the row value is only valueB.
 * @throws Exception
 */
@Test public void testMutateRow() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testMutateRow".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValuesA.add(columnValueA);
  TPut putA=new TPut(wrap(rowName),columnValuesA);
  putA.setColumnValues(columnValuesA);
  handler.put(table,putA);
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  List<TColumnValue> returnedColumnValues=result.getColumnValues();
  List<TColumnValue> expectedColumnValues=new ArrayList<TColumnValue>();
  expectedColumnValues.add(columnValueA);
  assertTColumnValuesEqual(expectedColumnValues,returnedColumnValues);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(wrap(familyAname),wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(wrap(rowName),columnValuesB);
  putB.setColumnValues(columnValuesB);
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<TColumn>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumn.setQualifier(qualifierAname);
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  List<TMutation> mutations=new ArrayList<TMutation>();
  TMutation mutationA=TMutation.put(putB);
  mutations.add(mutationA);
  TMutation mutationB=TMutation.deleteSingle(delete);
  mutations.add(mutationB);
  TRowMutations tRowMutations=new TRowMutations(wrap(rowName),mutations);
  handler.mutateRow(table,tRowMutations);
  result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  returnedColumnValues=result.getColumnValues();
  expectedColumnValues=new ArrayList<TColumnValue>();
  expectedColumnValues.add(columnValueB);
  assertTColumnValuesEqual(expectedColumnValues,returnedColumnValues);
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Create TPut, TDelete , TIncrement objects, set durability then call ThriftUtility
 * functions to get Put , Delete and Increment respectively. Use getDurability to make sure
 * the returned objects have the appropriate durability setting.
 * @throws Exception
 */
@Test public void testDurability() throws Exception {
  byte[] rowName="testDurability".getBytes();
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  List<TColumnIncrement> incrementColumns=new ArrayList<TColumnIncrement>();
  incrementColumns.add(new TColumnIncrement(wrap(familyAname),wrap(qualifierAname)));
  TDelete tDelete=new TDelete(wrap(rowName));
  tDelete.setDurability(TDurability.SKIP_WAL);
  Delete delete=deleteFromThrift(tDelete);
  assertEquals(delete.getDurability(),Durability.SKIP_WAL);
  tDelete.setDurability(TDurability.ASYNC_WAL);
  delete=deleteFromThrift(tDelete);
  assertEquals(delete.getDurability(),Durability.ASYNC_WAL);
  tDelete.setDurability(TDurability.SYNC_WAL);
  delete=deleteFromThrift(tDelete);
  assertEquals(delete.getDurability(),Durability.SYNC_WAL);
  tDelete.setDurability(TDurability.FSYNC_WAL);
  delete=deleteFromThrift(tDelete);
  assertEquals(delete.getDurability(),Durability.FSYNC_WAL);
  TPut tPut=new TPut(wrap(rowName),columnValues);
  tPut.setDurability(TDurability.SKIP_WAL);
  Put put=putFromThrift(tPut);
  assertEquals(put.getDurability(),Durability.SKIP_WAL);
  tPut.setDurability(TDurability.ASYNC_WAL);
  put=putFromThrift(tPut);
  assertEquals(put.getDurability(),Durability.ASYNC_WAL);
  tPut.setDurability(TDurability.SYNC_WAL);
  put=putFromThrift(tPut);
  assertEquals(put.getDurability(),Durability.SYNC_WAL);
  tPut.setDurability(TDurability.FSYNC_WAL);
  put=putFromThrift(tPut);
  assertEquals(put.getDurability(),Durability.FSYNC_WAL);
  TIncrement tIncrement=new TIncrement(wrap(rowName),incrementColumns);
  tIncrement.setDurability(TDurability.SKIP_WAL);
  Increment increment=incrementFromThrift(tIncrement);
  assertEquals(increment.getDurability(),Durability.SKIP_WAL);
  tIncrement.setDurability(TDurability.ASYNC_WAL);
  increment=incrementFromThrift(tIncrement);
  assertEquals(increment.getDurability(),Durability.ASYNC_WAL);
  tIncrement.setDurability(TDurability.SYNC_WAL);
  increment=incrementFromThrift(tIncrement);
  assertEquals(increment.getDurability(),Durability.SYNC_WAL);
  tIncrement.setDurability(TDurability.FSYNC_WAL);
  increment=incrementFromThrift(tIncrement);
  assertEquals(increment.getDurability(),Durability.FSYNC_WAL);
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndMutate() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  ByteBuffer row=wrap("row".getBytes());
  ByteBuffer family=wrap(familyAname);
  ByteBuffer qualifier=wrap(qualifierAname);
  ByteBuffer value=wrap(valueAname);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(family,wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(row,columnValuesB);
  putB.setColumnValues(columnValuesB);
  TRowMutations tRowMutations=new TRowMutations(row,Arrays.<TMutation>asList(TMutation.put(putB)));
  TResult result=handler.get(table,new TGet(row));
  assertEquals(0,result.getColumnValuesSize());
  assertFalse("Expected condition to not pass",handler.checkAndMutate(table,row,family,qualifier,TCompareOp.EQUAL,value,tRowMutations));
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(family,qualifier,value);
  columnValuesA.add(columnValueA);
  handler.put(table,new TPut(row,columnValuesA));
  result=handler.get(table,new TGet(row));
  assertEquals(1,result.getColumnValuesSize());
  assertTColumnValueEqual(columnValueA,result.getColumnValues().get(0));
  assertTrue("Expected condition to pass",handler.checkAndMutate(table,row,family,qualifier,TCompareOp.EQUAL,value,tRowMutations));
  result=handler.get(table,new TGet(row));
  assertEquals(2,result.getColumnValuesSize());
  assertTColumnValueEqual(columnValueA,result.getColumnValues().get(0));
  assertTColumnValueEqual(columnValueB,result.getColumnValues().get(1));
}

</code></pre>

<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testExists() throws TIOError, TException {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testExists".getBytes();
  ByteBuffer table=wrap(tableAname);
  TGet get=new TGet(wrap(rowName));
  assertFalse(handler.exists(table,get));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  assertTrue(handler.exists(table,get));
}

</code></pre>

<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMetrics() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  ThriftMetrics metrics=getMetrics(conf);
  ThriftHBaseServiceHandler hbaseHandler=createHandler();
  THBaseService.Iface handler=ThriftHBaseServiceHandler.newInstance(hbaseHandler,metrics);
  byte[] rowName="testMetrics".getBytes();
  ByteBuffer table=wrap(tableAname);
  TGet get=new TGet(wrap(rowName));
  assertFalse(handler.exists(table,get));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  assertTrue(handler.exists(table,get));
  metricsHelper.assertCounter("put_num_ops",1,metrics.getSource());
  metricsHelper.assertCounter("exists_num_ops",2,metrics.getSource());
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteMultiple() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  byte[] rowName1="testDeleteMultiple1".getBytes();
  byte[] rowName2="testDeleteMultiple2".getBytes();
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  List<TPut> puts=new ArrayList<TPut>();
  puts.add(new TPut(wrap(rowName1),columnValues));
  puts.add(new TPut(wrap(rowName2),columnValues));
  handler.putMultiple(table,puts);
  List<TDelete> deletes=new ArrayList<TDelete>();
  deletes.add(new TDelete(wrap(rowName1)));
  deletes.add(new TDelete(wrap(rowName2)));
  List<TDelete> deleteResults=handler.deleteMultiple(table,deletes);
  assertEquals(0,deleteResults.size());
  assertFalse(handler.exists(table,new TGet(wrap(rowName1))));
  assertFalse(handler.exists(table,new TGet(wrap(rowName2))));
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAttribute() throws Exception {
  byte[] rowName="testAttribute".getBytes();
  byte[] attributeKey="attribute1".getBytes();
  byte[] attributeValue="value1".getBytes();
  Map<ByteBuffer,ByteBuffer> attributes=new HashMap<ByteBuffer,ByteBuffer>();
  attributes.put(wrap(attributeKey),wrap(attributeValue));
  TGet tGet=new TGet(wrap(rowName));
  tGet.setAttributes(attributes);
  Get get=getFromThrift(tGet);
  assertArrayEquals(get.getAttribute("attribute1"),attributeValue);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  TPut tPut=new TPut(wrap(rowName),columnValues);
  tPut.setAttributes(attributes);
  Put put=putFromThrift(tPut);
  assertArrayEquals(put.getAttribute("attribute1"),attributeValue);
  TScan tScan=new TScan();
  tScan.setAttributes(attributes);
  Scan scan=scanFromThrift(tScan);
  assertArrayEquals(scan.getAttribute("attribute1"),attributeValue);
  List<TColumnIncrement> incrementColumns=new ArrayList<TColumnIncrement>();
  incrementColumns.add(new TColumnIncrement(wrap(familyAname),wrap(qualifierAname)));
  TIncrement tIncrement=new TIncrement(wrap(rowName),incrementColumns);
  tIncrement.setAttributes(attributes);
  Increment increment=incrementFromThrift(tIncrement);
  assertArrayEquals(increment.getAttribute("attribute1"),attributeValue);
  TDelete tDelete=new TDelete(wrap(rowName));
  tDelete.setAttributes(attributes);
  Delete delete=deleteFromThrift(tDelete);
  assertArrayEquals(delete.getAttribute("attribute1"),attributeValue);
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDelete() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testDelete".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  TColumnValue columnValueB=new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname));
  columnValues.add(columnValueA);
  columnValues.add(columnValueB);
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<TColumn>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumn.setQualifier(qualifierAname);
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  handler.deleteSingle(table,delete);
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  List<TColumnValue> returnedColumnValues=result.getColumnValues();
  List<TColumnValue> expectedColumnValues=new ArrayList<TColumnValue>();
  expectedColumnValues.add(columnValueB);
  assertTColumnValuesEqual(expectedColumnValues,returnedColumnValues);
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * check that checkAndPut fails if the cell does not exist, then put in the cell, then check
 * that the checkAndPut succeeds.
 * @throws Exception
 */
@Test public void testCheckAndPut() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testCheckAndPut".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValuesA.add(columnValueA);
  TPut putA=new TPut(wrap(rowName),columnValuesA);
  putA.setColumnValues(columnValuesA);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(wrap(rowName),columnValuesB);
  putB.setColumnValues(columnValuesB);
  assertFalse(handler.checkAndPut(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),putB));
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertEquals(0,result.getColumnValuesSize());
  handler.put(table,putA);
  assertTrue(handler.checkAndPut(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),putB));
  result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  List<TColumnValue> returnedColumnValues=result.getColumnValues();
  List<TColumnValue> expectedColumnValues=new ArrayList<TColumnValue>();
  expectedColumnValues.add(columnValueA);
  expectedColumnValues.add(columnValueB);
  assertTColumnValuesEqual(expectedColumnValues,returnedColumnValues);
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPutGet() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testPutGet".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  List<TColumnValue> returnedColumnValues=result.getColumnValues();
  assertTColumnValuesEqual(columnValues,returnedColumnValues);
}

</code></pre>

<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutTTL() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testPutTTL".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(Bytes.toBytes(1L))));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  Map<ByteBuffer,ByteBuffer> attributes=new HashMap<>();
  long ttlTimeMs=2000L;
  attributes.put(wrap(Bytes.toBytes("_ttl")),wrap(Bytes.toBytes(ttlTimeMs)));
  put.setAttributes(attributes);
  handler.put(table,put);
  TGet getOne=new TGet(wrap(rowName));
  TResult resultOne=handler.get(table,getOne);
  assertArrayEquals(rowName,resultOne.getRow());
  assertEquals(1,resultOne.getColumnValuesSize());
  Thread.sleep(ttlTimeMs * 15);
  TGet getTwo=new TGet(wrap(rowName));
  TResult resultTwo=handler.get(table,getTwo);
  assertNull(resultTwo.getRow());
  assertEquals(0,resultTwo.getColumnValuesSize());
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * check that checkAndDelete fails if the cell does not exist, then put in the cell, then
 * check that the checkAndDelete succeeds.
 * @throws Exception
 */
@Test public void testCheckAndDelete() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testCheckAndDelete".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValuesA.add(columnValueA);
  TPut putA=new TPut(wrap(rowName),columnValuesA);
  putA.setColumnValues(columnValuesA);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(wrap(rowName),columnValuesB);
  putB.setColumnValues(columnValuesB);
  handler.put(table,putB);
  TDelete delete=new TDelete(wrap(rowName));
  assertFalse(handler.checkAndDelete(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),delete));
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  assertTColumnValuesEqual(columnValuesB,result.getColumnValues());
  handler.put(table,putA);
  assertTrue(handler.checkAndDelete(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),delete));
  result=handler.get(table,get);
  assertFalse(result.isSetRow());
  assertEquals(0,result.getColumnValuesSize());
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void afterClass() throws Exception {
  UTIL.shutdownMiniCluster();
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeleteSingleTimestamp() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testDeleteSingleTimestamp".getBytes();
  ByteBuffer table=wrap(tableAname);
  long timestamp1=System.currentTimeMillis() - 10;
  long timestamp2=System.currentTimeMillis();
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValueA.setTimestamp(timestamp1);
  columnValues.add(columnValueA);
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  columnValueA.setTimestamp(timestamp2);
  handler.put(table,put);
  TGet get=new TGet(wrap(rowName));
  get.setMaxVersions(2);
  TResult result=handler.get(table,get);
  assertEquals(2,result.getColumnValuesSize());
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<TColumn>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumn.setQualifier(qualifierAname);
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  delete.setDeleteType(TDeleteType.DELETE_COLUMN);
  handler.deleteSingle(table,delete);
  get=new TGet(wrap(rowName));
  result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  assertEquals(1,result.getColumnValuesSize());
  assertEquals(timestamp1,result.getColumnValues().get(0).getTimestamp());
}

</code></pre>

<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScan".getBytes());
  scan.setStopRow("testScan\uffff".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScan" + i).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<pre class="type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Is an empty test case
"></span><br>
@Before public void setup() throws Exception {
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPutGetMultiple() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  byte[] rowName1="testPutGetMultiple1".getBytes();
  byte[] rowName2="testPutGetMultiple2".getBytes();
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  List<TPut> puts=new ArrayList<TPut>();
  puts.add(new TPut(wrap(rowName1),columnValues));
  puts.add(new TPut(wrap(rowName2),columnValues));
  handler.putMultiple(table,puts);
  List<TGet> gets=new ArrayList<TGet>();
  gets.add(new TGet(wrap(rowName1)));
  gets.add(new TGet(wrap(rowName2)));
  List<TResult> results=handler.getMultiple(table,gets);
  assertEquals(2,results.size());
  assertArrayEquals(rowName1,results.get(0).getRow());
  assertTColumnValuesEqual(columnValues,results.get(0).getColumnValues());
  assertArrayEquals(rowName2,results.get(1).getRow());
  assertTColumnValuesEqual(columnValues,results.get(1).getColumnValues());
}

</code></pre>

<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReverseScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testReverseScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  scan.setReversed(true);
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testReverseScan\uffff".getBytes());
  scan.setStopRow("testReverseScan".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testReverseScan" + (9 - i)).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAppend() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testAppend".getBytes();
  ByteBuffer table=wrap(tableAname);
  byte[] v1=Bytes.toBytes("42");
  byte[] v2=Bytes.toBytes("23");
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(v1)));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  List<TColumnValue> appendColumns=new ArrayList<TColumnValue>();
  appendColumns.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(v2)));
  TAppend append=new TAppend(wrap(rowName),appendColumns);
  handler.append(table,append);
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  assertEquals(1,result.getColumnValuesSize());
  TColumnValue columnValue=result.getColumnValues().get(0);
  assertArrayEquals(Bytes.add(v1,v2),columnValue.getValue());
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterRegistration() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  conf.set("hbase.thrift.filters","MyFilter:filterclass");
  ThriftServer.registerFilters(conf);
  Map<String,String> registeredFilters=ParseFilter.getAllFilters();
  assertEquals("filterclass",registeredFilters.get("MyFilter"));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
