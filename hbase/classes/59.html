<h3 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAdmin1 (30 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(5)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(2)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  this.admin=TEST_UTIL.getHBaseAdmin();
}

</code></pre>

<pre class="type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=300000) public void testTableAvailableWithRandomSplitKeys() throws Exception {
  TableName tableName=TableName.valueOf("testTableAvailableWithRandomSplitKeys");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor("col"));
  byte[][] splitKeys=new byte[1][];
  splitKeys=new byte[][]{new byte[]{1,1,1},new byte[]{2,2,2}};
  admin.createTable(desc);
  boolean tableAvailable=admin.isTableAvailable(tableName,splitKeys);
  assertFalse("Table should be created with 1 row in META",tableAvailable);
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void tearDown() throws Exception {
  for (  HTableDescriptor htd : this.admin.listTables()) {
    TEST_UTIL.deleteTable(htd.getTableName());
  }
}

</code></pre>

<pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify schema modification takes.
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=300000) public void testOnlineChangeTableSchema() throws IOException, InterruptedException {
  final TableName tableName=TableName.valueOf("changeTableSchemaOnline");
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",true);
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  HTableDescriptor htd=this.admin.getTableDescriptor(tableName);
  HTableDescriptor copy=new HTableDescriptor(htd);
  assertTrue(htd.equals(copy));
  long newFlushSize=htd.getMemStoreFlushSize() / 2;
  if (newFlushSize <= 0) {
    newFlushSize=HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE / 2;
  }
  copy.setMemStoreFlushSize(newFlushSize);
  final String key="anyoldkey";
  assertTrue(htd.getValue(key) == null);
  copy.setValue(key,key);
  boolean expectedException=false;
  try {
    admin.modifyTable(tableName,copy);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  HTableDescriptor modifiedHtd=this.admin.getTableDescriptor(tableName);
  assertFalse(htd.equals(modifiedHtd));
  assertTrue(copy.equals(modifiedHtd));
  assertEquals(newFlushSize,modifiedHtd.getMemStoreFlushSize());
  assertEquals(key,modifiedHtd.getValue(key));
  int countOfFamilies=modifiedHtd.getFamilies().size();
  assertTrue(countOfFamilies > 0);
  HColumnDescriptor hcd=modifiedHtd.getFamilies().iterator().next();
  int maxversions=hcd.getMaxVersions();
  final int newMaxVersions=maxversions + 1;
  hcd.setMaxVersions(newMaxVersions);
  final byte[] hcdName=hcd.getName();
  expectedException=false;
  try {
    this.admin.modifyColumnFamily(tableName,hcd);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  HColumnDescriptor modifiedHcd=modifiedHtd.getFamily(hcdName);
  assertEquals(newMaxVersions,modifiedHcd.getMaxVersions());
  assertFalse(this.admin.isTableDisabled(tableName));
  final String xtracolName="xtracol";
  HColumnDescriptor xtracol=new HColumnDescriptor(xtracolName);
  xtracol.setValue(xtracolName,xtracolName);
  expectedException=false;
  try {
    this.admin.addColumnFamily(tableName,xtracol);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  hcd=modifiedHtd.getFamily(xtracol.getName());
  assertTrue(hcd != null);
  assertTrue(hcd.getValue(xtracolName).equals(xtracolName));
  this.admin.deleteColumnFamily(tableName,xtracol.getName());
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  hcd=modifiedHtd.getFamily(xtracol.getName());
  assertTrue(hcd == null);
  this.admin.disableTable(tableName);
  this.admin.deleteTable(tableName);
  this.admin.listTables();
  assertFalse(this.admin.tableExists(tableName));
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test(timeout=300000) public void testCreateTableWithOnlyEmptyStartRow() throws IOException {
  byte[] tableName=Bytes.toBytes("testCreateTableWithOnlyEmptyStartRow");
  byte[][] splitKeys=new byte[1][];
  splitKeys[0]=HConstants.EMPTY_BYTE_ARRAY;
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(tableName));
  desc.addFamily(new HColumnDescriptor("col"));
  try {
    admin.createTable(desc,splitKeys);
    fail("Test case should fail as empty split key is passed.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testEnableDisableAddColumnDeleteColumn() throws Exception {
  TableName tableName=TableName.valueOf("testEnableDisableAddColumnDeleteColumn");
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  while (!this.admin.isTableEnabled(TableName.valueOf("testEnableDisableAddColumnDeleteColumn"))) {
    Thread.sleep(10);
  }
  this.admin.disableTable(tableName);
  try {
    TEST_UTIL.getConnection().getTable(tableName);
  }
 catch (  org.apache.hadoop.hbase.DoNotRetryIOException e) {
  }
  this.admin.addColumnFamily(tableName,new HColumnDescriptor("col2"));
  this.admin.enableTable(tableName);
  try {
    this.admin.deleteColumnFamily(tableName,Bytes.toBytes("col2"));
  }
 catch (  TableNotDisabledException e) {
    LOG.info(e);
  }
  this.admin.disableTable(tableName);
  this.admin.deleteTable(tableName);
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCompactionTimestamps() throws Exception {
  HColumnDescriptor fam1=new HColumnDescriptor("fam1");
  TableName tableName=TableName.valueOf("testCompactionTimestampsTable");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(fam1);
  this.admin.createTable(htd);
  Table table=TEST_UTIL.getConnection().getTable(htd.getTableName());
  long ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(Bytes.toBytes("fam1"),Bytes.toBytes("fam1"),Bytes.toBytes("fam1"));
  table.put(p);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  byte[] regionName;
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regionName=l.getAllRegionLocations().get(0).getRegionInfo().getRegionName();
  }
   long ts1=this.admin.getLastMajorCompactionTimestampForRegion(regionName);
  assertEquals(ts,ts1);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(Bytes.toBytes("fam1"),Bytes.toBytes("fam1"),Bytes.toBytes("fam1"));
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(ts1,ts);
  TEST_UTIL.compact(tableName,true);
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertTrue(ts > ts1);
  ts1=this.admin.getLastMajorCompactionTimestampForRegion(regionName);
  assertEquals(ts,ts1);
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(ts,ts1);
  table.close();
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test(timeout=300000) public void testHColumnValidName(){
  boolean exceptionThrown;
  try {
    new HColumnDescriptor("\\test\\abc");
  }
 catch (  IllegalArgumentException iae) {
    exceptionThrown=true;
    assertTrue(exceptionThrown);
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests forcing split from client and having scanners successfully ride over split.
 * @throws Exception
 * @throws IOException
 */
@Test(timeout=400000) public void testForceSplit() throws Exception {
  byte[][] familyNames=new byte[][]{Bytes.toBytes("cf")};
  int[] rowCounts=new int[]{6000};
  int numVersions=HColumnDescriptor.DEFAULT_VERSIONS;
  int blockSize=256;
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  byte[] splitKey=Bytes.toBytes(3500);
  splitTest(splitKey,familyNames,rowCounts,numVersions,blockSize);
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test(timeout=300000) public void testDeleteEditUnknownColumnFamilyAndOrTable() throws IOException {
  final TableName nonexistentTable=TableName.valueOf("nonexistent");
  final byte[] nonexistentColumn=Bytes.toBytes("nonexistent");
  HColumnDescriptor nonexistentHcd=new HColumnDescriptor(nonexistentColumn);
  Exception exception=null;
  try {
    this.admin.addColumnFamily(nonexistentTable,nonexistentHcd);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.deleteTable(nonexistentTable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.deleteColumnFamily(nonexistentTable,nonexistentColumn);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.disableTable(nonexistentTable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.enableTable(nonexistentTable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.modifyColumnFamily(nonexistentTable,nonexistentHcd);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    HTableDescriptor htd=new HTableDescriptor(nonexistentTable);
    htd.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
    this.admin.modifyTable(htd.getTableName(),htd);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  final TableName tableName=TableName.valueOf("testDeleteEditUnknownColumnFamilyAndOrTable" + System.currentTimeMillis());
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor("cf"));
  this.admin.createTable(htd);
  try {
    exception=null;
    try {
      this.admin.deleteColumnFamily(htd.getTableName(),nonexistentHcd.getName());
    }
 catch (    IOException e) {
      exception=e;
    }
    assertTrue("found=" + exception.getClass().getName(),exception instanceof InvalidFamilyOperationException);
    exception=null;
    try {
      this.admin.modifyColumnFamily(htd.getTableName(),nonexistentHcd);
    }
 catch (    IOException e) {
      exception=e;
    }
    assertTrue("found=" + exception.getClass().getName(),exception instanceof InvalidFamilyOperationException);
  }
  finally {
    this.admin.disableTable(tableName);
    this.admin.deleteTable(tableName);
  }
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test retain assignment on enableTable.
 * @throws IOException
 */
@Test(timeout=300000) public void testEnableTableRetainAssignment() throws IOException {
  final TableName tableName=TableName.valueOf("testEnableTableAssignment");
  byte[][] splitKeys={new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{4,4,4},new byte[]{5,5,5},new byte[]{6,6,6},new byte[]{7,7,7},new byte[]{8,8,8},new byte[]{9,9,9}};
  int expectedRegions=splitKeys.length + 1;
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,splitKeys);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    List<HRegionLocation> regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    admin.disableTable(tableName);
    admin.enableTable(tableName);
    List<HRegionLocation> regions2=l.getAllRegionLocations();
    assertEquals(regions.size(),regions2.size());
    assertTrue(regions2.containsAll(regions));
  }
 }

</code></pre>

<pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTable() throws IOException {
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TableName tableName=TableName.valueOf("testCreateTable");
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  assertTrue("Table must be enabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(tableName,TableState.State.ENABLED));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(tableName));
}

</code></pre>

<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=300000) public void testGetTableDescriptor() throws IOException {
  HColumnDescriptor fam1=new HColumnDescriptor("fam1");
  HColumnDescriptor fam2=new HColumnDescriptor("fam2");
  HColumnDescriptor fam3=new HColumnDescriptor("fam3");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("myTestTable"));
  htd.addFamily(fam1);
  htd.addFamily(fam2);
  htd.addFamily(fam3);
  this.admin.createTable(htd);
  Table table=TEST_UTIL.getConnection().getTable(htd.getTableName());
  HTableDescriptor confirmedHtd=table.getTableDescriptor();
  assertEquals(htd.compareTo(confirmedHtd),0);
  MetaTableAccessor.fullScanMetaAndPrint(TEST_UTIL.getConnection());
  table.close();
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSplitAndMergeWithReplicaTable() throws Exception {
  TableName tableName=TableName.valueOf("testSplitAndMergeWithReplicaTable");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.setRegionReplication(3);
  byte[] cf="f".getBytes();
  HColumnDescriptor hcd=new HColumnDescriptor(cf);
  desc.addFamily(hcd);
  byte[][] splitRows=new byte[2][];
  splitRows[0]=new byte[]{(byte)'4'};
  splitRows[1]=new byte[]{(byte)'7'};
  TEST_UTIL.getHBaseAdmin().createTable(desc,splitRows);
  List<HRegion> oldRegions;
  do {
    oldRegions=TEST_UTIL.getHBaseCluster().getRegions(tableName);
    Thread.sleep(10);
  }
 while (oldRegions.size() != 9);
  Table ht=TEST_UTIL.getConnection().getTable(tableName);
  List<Put> puts=new ArrayList<Put>();
  byte[] qualifier="c".getBytes();
  Put put=new Put(new byte[]{(byte)'1'});
  put.addColumn(cf,qualifier,"100".getBytes());
  puts.add(put);
  put=new Put(new byte[]{(byte)'6'});
  put.addColumn(cf,qualifier,"100".getBytes());
  puts.add(put);
  put=new Put(new byte[]{(byte)'8'});
  put.addColumn(cf,qualifier,"100".getBytes());
  puts.add(put);
  ht.put(puts);
  ht.close();
  List<Pair<HRegionInfo,ServerName>> regions=MetaTableAccessor.getTableRegionsAndLocations(TEST_UTIL.getConnection(),tableName);
  boolean gotException=false;
  try {
    TEST_UTIL.getHBaseAdmin().splitRegion(regions.get(1).getFirst().getRegionName());
  }
 catch (  IllegalArgumentException ex) {
    gotException=true;
  }
  assertTrue(gotException);
  gotException=false;
  try {
    TEST_UTIL.getHBaseAdmin().split(regions.get(1).getSecond(),regions.get(1).getFirst(),new byte[]{(byte)'1'});
  }
 catch (  IOException ex) {
    gotException=true;
  }
  assertTrue(gotException);
  gotException=false;
  try {
    TEST_UTIL.getHBaseAdmin().mergeRegions(regions.get(1).getFirst().getEncodedNameAsBytes(),regions.get(2).getFirst().getEncodedNameAsBytes(),true);
  }
 catch (  IllegalArgumentException m) {
    gotException=true;
  }
  assertTrue(gotException);
  try {
    DispatchMergingRegionsRequest request=RequestConverter.buildDispatchMergingRegionsRequest(regions.get(1).getFirst().getEncodedNameAsBytes(),regions.get(2).getFirst().getEncodedNameAsBytes(),true);
    TEST_UTIL.getHBaseAdmin().getConnection().getMaster().dispatchMergingRegions(null,request);
  }
 catch (  ServiceException m) {
    Throwable t=m.getCause();
    do {
      if (t instanceof MergeRegionException) {
        gotException=true;
        break;
      }
      t=t.getCause();
    }
 while (t != null);
  }
  assertTrue(gotException);
  gotException=false;
  if (!regions.get(2).getSecond().equals(regions.get(1).getSecond())) {
    moveRegionAndWait(regions.get(2).getFirst(),regions.get(1).getSecond());
  }
  try {
    AdminService.BlockingInterface admin=TEST_UTIL.getHBaseAdmin().getConnection().getAdmin(regions.get(1).getSecond());
    ProtobufUtil.mergeRegions(admin,regions.get(1).getFirst(),regions.get(2).getFirst(),true,null);
  }
 catch (  MergeRegionException mm) {
    gotException=true;
  }
  assertTrue(gotException);
}

</code></pre>

<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testDisableAndEnableTable() throws IOException {
  final byte[] row=Bytes.toBytes("row");
  final byte[] qualifier=Bytes.toBytes("qualifier");
  final byte[] value=Bytes.toBytes("value");
  final TableName table=TableName.valueOf("testDisableAndEnableTable");
  Table ht=TEST_UTIL.createTable(table,HConstants.CATALOG_FAMILY);
  Put put=new Put(row);
  put.addColumn(HConstants.CATALOG_FAMILY,qualifier,value);
  ht.put(put);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  ht.get(get);
  this.admin.disableTable(ht.getName());
  assertTrue("Table must be disabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),TableState.State.DISABLED));
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table));
  get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  boolean ok=false;
  try {
    ht.get(get);
  }
 catch (  TableNotEnabledException e) {
    ok=true;
  }
  ok=false;
  Scan scan=new Scan();
  try {
    ResultScanner scanner=ht.getScanner(scan);
    Result res=null;
    do {
      res=scanner.next();
    }
 while (res != null);
  }
 catch (  TableNotEnabledException e) {
    ok=true;
  }
  assertTrue(ok);
  this.admin.enableTable(table);
  assertTrue("Table must be enabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),TableState.State.ENABLED));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table));
  try {
    ht.get(get);
  }
 catch (  RetriesExhaustedException e) {
    ok=false;
  }
  assertTrue(ok);
  ht.close();
}

</code></pre>

<pre class="type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=300000) public void testHFileReplication() throws Exception {
  TableName name=TableName.valueOf("testHFileReplication");
  String fn1="rep1";
  HColumnDescriptor hcd1=new HColumnDescriptor(fn1);
  hcd1.setDFSReplication((short)1);
  String fn="defaultRep";
  HColumnDescriptor hcd=new HColumnDescriptor(fn);
  HTableDescriptor htd=new HTableDescriptor(name);
  htd.addFamily(hcd);
  htd.addFamily(hcd1);
  Table table=TEST_UTIL.createTable(htd,null);
  TEST_UTIL.waitTableAvailable(name);
  Put p=new Put(Bytes.toBytes("defaultRep_rk"));
  byte[] q1=Bytes.toBytes("q1");
  byte[] v1=Bytes.toBytes("v1");
  p.addColumn(Bytes.toBytes(fn),q1,v1);
  List<Put> puts=new ArrayList<Put>(2);
  puts.add(p);
  p=new Put(Bytes.toBytes("rep1_rk"));
  p.addColumn(Bytes.toBytes(fn1),q1,v1);
  puts.add(p);
  try {
    table.put(puts);
    admin.flush(name);
    List<HRegion> regions=TEST_UTIL.getMiniHBaseCluster().getRegions(name);
    for (    HRegion r : regions) {
      Store store=r.getStore(Bytes.toBytes(fn));
      for (      StoreFile sf : store.getStorefiles()) {
        assertTrue(sf.toString().contains(fn));
        assertTrue("Column family " + fn + " should have 3 copies",FSUtils.getDefaultReplication(TEST_UTIL.getTestFileSystem(),sf.getPath()) == (sf.getFileInfo().getFileStatus().getReplication()));
      }
      store=r.getStore(Bytes.toBytes(fn1));
      for (      StoreFile sf : store.getStorefiles()) {
        assertTrue(sf.toString().contains(fn1));
        assertTrue("Column family " + fn1 + " should have only 1 copy",1 == sf.getFileInfo().getFileStatus().getReplication());
      }
    }
  }
  finally {
    if (admin.isTableEnabled(name)) {
      this.admin.disableTable(name);
      this.admin.deleteTable(name);
    }
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Multi-family scenario. Tests forcing split from client and
 * having scanners successfully ride over split.
 * @throws Exception
 * @throws IOException
 */
@Test(timeout=800000) public void testForceSplitMultiFamily() throws Exception {
  int numVersions=HColumnDescriptor.DEFAULT_VERSIONS;
  int blockSize=256;
  byte[][] familyNames=new byte[][]{Bytes.toBytes("cf1"),Bytes.toBytes("cf2")};
  int[] rowCounts=new int[]{6000,1};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{1,6000};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{6000,300};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{300,6000};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
}

</code></pre>

<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=120000) public void testTableExist() throws IOException {
  final TableName table=TableName.valueOf("testTableExist");
  boolean exist;
  exist=this.admin.tableExists(table);
  assertEquals(false,exist);
  TEST_UTIL.createTable(table,HConstants.CATALOG_FAMILY);
  exist=this.admin.tableExists(table);
  assertEquals(true,exist);
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test(timeout=300000) public void testDeleteLastColumnFamily() throws Exception {
  TableName tableName=TableName.valueOf("testDeleteLastColumnFamily");
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  while (!this.admin.isTableEnabled(TableName.valueOf("testDeleteLastColumnFamily"))) {
    Thread.sleep(10);
  }
  try {
    this.admin.deleteColumnFamily(tableName,HConstants.CATALOG_FAMILY);
    fail("Should have failed to delete the only column family of a table");
  }
 catch (  InvalidFamilyOperationException ex) {
  }
  this.admin.disableTable(tableName);
  try {
    this.admin.deleteColumnFamily(tableName,HConstants.CATALOG_FAMILY);
    fail("Should have failed to delete the only column family of a table");
  }
 catch (  InvalidFamilyOperationException ex) {
  }
  this.admin.deleteTable(tableName);
}

</code></pre>

<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTableNumberOfRegions() throws IOException, InterruptedException {
  TableName tableName=TableName.valueOf("testCreateTableNumberOfRegions");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc);
  List<HRegionLocation> regions;
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 1 region",1,regions.size());
  }
   TableName TABLE_2=TableName.valueOf(tableName.getNameAsString() + "_2");
  desc=new HTableDescriptor(TABLE_2);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,new byte[][]{new byte[]{42}});
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_2)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 2 region",2,regions.size());
  }
   TableName TABLE_3=TableName.valueOf(tableName.getNameAsString() + "_3");
  desc=new HTableDescriptor(TABLE_3);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,"a".getBytes(),"z".getBytes(),3);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_3)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 3 region",3,regions.size());
  }
   TableName TABLE_4=TableName.valueOf(tableName.getNameAsString() + "_4");
  desc=new HTableDescriptor(TABLE_4);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  try {
    admin.createTable(desc,"a".getBytes(),"z".getBytes(),2);
    fail("Should not be able to create a table with only 2 regions using this API.");
  }
 catch (  IllegalArgumentException eae) {
  }
  TableName TABLE_5=TableName.valueOf(tableName.getNameAsString() + "_5");
  desc=new HTableDescriptor(TABLE_5);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,new byte[]{1},new byte[]{127},16);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_5)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have 16 region",16,regions.size());
  }
 }

</code></pre>

<pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testShouldFailOnlineSchemaUpdateIfOnlineSchemaIsNotEnabled() throws Exception {
  final TableName tableName=TableName.valueOf("changeTableSchemaOnlineFailure");
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",false);
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  HTableDescriptor htd=this.admin.getTableDescriptor(tableName);
  HTableDescriptor copy=new HTableDescriptor(htd);
  assertTrue(htd.equals(copy));
  long newFlushSize=htd.getMemStoreFlushSize() / 2;
  if (newFlushSize <= 0) {
    newFlushSize=HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE / 2;
  }
  copy.setMemStoreFlushSize(newFlushSize);
  final String key="anyoldkey";
  assertTrue(htd.getValue(key) == null);
  copy.setValue(key,key);
  boolean expectedException=false;
  try {
    admin.modifyTable(tableName,copy);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertTrue("Online schema update should not happen.",expectedException);
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",true);
}

</code></pre>

<pre class="type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
"></span><br>
@Test(expected=IllegalArgumentException.class,timeout=300000) public void testInvalidHColumnDescriptor() throws IOException {
  new HColumnDescriptor("/cfamily/name");
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test(timeout=300000) public void testSplitFlushCompactUnknownTable() throws InterruptedException {
  final TableName unknowntable=TableName.valueOf("fubar");
  Exception exception=null;
  try {
    this.admin.compact(unknowntable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.flush(unknowntable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
  exception=null;
  try {
    this.admin.split(unknowntable);
  }
 catch (  IOException e) {
    exception=e;
  }
  assertTrue(exception instanceof TableNotFoundException);
}

</code></pre>

<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testDisableAndEnableTables() throws IOException {
  final byte[] row=Bytes.toBytes("row");
  final byte[] qualifier=Bytes.toBytes("qualifier");
  final byte[] value=Bytes.toBytes("value");
  final TableName table1=TableName.valueOf("testDisableAndEnableTable1");
  final TableName table2=TableName.valueOf("testDisableAndEnableTable2");
  Table ht1=TEST_UTIL.createTable(table1,HConstants.CATALOG_FAMILY);
  Table ht2=TEST_UTIL.createTable(table2,HConstants.CATALOG_FAMILY);
  Put put=new Put(row);
  put.addColumn(HConstants.CATALOG_FAMILY,qualifier,value);
  ht1.put(put);
  ht2.put(put);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  ht1.get(get);
  ht2.get(get);
  this.admin.disableTables("testDisableAndEnableTable.*");
  get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  boolean ok=false;
  try {
    ht1.get(get);
    ht2.get(get);
  }
 catch (  org.apache.hadoop.hbase.DoNotRetryIOException e) {
    ok=true;
  }
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table1));
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table2));
  assertTrue(ok);
  this.admin.enableTables("testDisableAndEnableTable.*");
  try {
    ht1.get(get);
  }
 catch (  IOException e) {
    ok=false;
  }
  try {
    ht2.get(get);
  }
 catch (  IOException e) {
    ok=false;
  }
  assertTrue(ok);
  ht1.close();
  ht2.close();
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table1));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table2));
}

</code></pre>

<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeRegions() throws Exception {
  TableName tableName=TableName.valueOf("testMergeWithFullRegionName");
  HColumnDescriptor cd=new HColumnDescriptor("d");
  HTableDescriptor td=new HTableDescriptor(tableName);
  td.addFamily(cd);
  byte[][] splitRows=new byte[2][];
  splitRows[0]=new byte[]{(byte)'3'};
  splitRows[1]=new byte[]{(byte)'6'};
  try {
    TEST_UTIL.createTable(td,splitRows);
    TEST_UTIL.waitTableAvailable(tableName);
    List<HRegionInfo> tableRegions;
    HRegionInfo regionA;
    HRegionInfo regionB;
    tableRegions=admin.getTableRegions(tableName);
    assertEquals(3,admin.getTableRegions(tableName).size());
    regionA=tableRegions.get(0);
    regionB=tableRegions.get(1);
    admin.mergeRegions(regionA.getRegionName(),regionB.getRegionName(),false);
    Thread.sleep(1000);
    assertEquals(2,admin.getTableRegions(tableName).size());
    tableRegions=admin.getTableRegions(tableName);
    regionA=tableRegions.get(0);
    regionB=tableRegions.get(1);
    admin.mergeRegions(regionA.getEncodedNameAsBytes(),regionB.getEncodedNameAsBytes(),false);
    Thread.sleep(1000);
    assertEquals(1,admin.getTableRegions(tableName).size());
  }
  finally {
    this.admin.disableTable(tableName);
    this.admin.deleteTable(tableName);
  }
}

</code></pre>

<pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTableWithRegions() throws IOException, InterruptedException {
  TableName tableName=TableName.valueOf("testCreateTableWithRegions");
  byte[][] splitKeys={new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{4,4,4},new byte[]{5,5,5},new byte[]{6,6,6},new byte[]{7,7,7},new byte[]{8,8,8},new byte[]{9,9,9}};
  int expectedRegions=splitKeys.length + 1;
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,splitKeys);
  boolean tableAvailable=admin.isTableAvailable(tableName,splitKeys);
  assertTrue("Table should be created with splitKyes + 1 rows in META",tableAvailable);
  List<HRegionLocation> regions;
  Iterator<HRegionLocation> hris;
  HRegionInfo hri;
  ClusterConnection conn=(ClusterConnection)TEST_UTIL.getConnection();
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    hris=regions.iterator();
    hri=hris.next().getRegionInfo();
    assertTrue(hri.getStartKey() == null || hri.getStartKey().length == 0);
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[0]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[0]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[1]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[1]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[2]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[2]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[3]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[3]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[4]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[4]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[5]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[5]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[6]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[6]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[7]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[7]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[8]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[8]));
    assertTrue(hri.getEndKey() == null || hri.getEndKey().length == 0);
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   byte[] startKey={1,1,1,1,1,1,1,1,1,1};
  byte[] endKey={9,9,9,9,9,9,9,9,9,9};
  expectedRegions=10;
  TableName TABLE_2=TableName.valueOf(tableName.getNameAsString() + "_2");
  desc=new HTableDescriptor(TABLE_2);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(desc,startKey,endKey,expectedRegions);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_2)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    hris=regions.iterator();
    hri=hris.next().getRegionInfo();
    assertTrue(hri.getStartKey() == null || hri.getStartKey().length == 0);
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{1,1,1,1,1,1,1,1,1,1}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{1,1,1,1,1,1,1,1,1,1}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{2,2,2,2,2,2,2,2,2,2}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{2,2,2,2,2,2,2,2,2,2}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{3,3,3,3,3,3,3,3,3,3}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{3,3,3,3,3,3,3,3,3,3}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{4,4,4,4,4,4,4,4,4,4}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{4,4,4,4,4,4,4,4,4,4}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{5,5,5,5,5,5,5,5,5,5}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{5,5,5,5,5,5,5,5,5,5}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{6,6,6,6,6,6,6,6,6,6}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{6,6,6,6,6,6,6,6,6,6}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{7,7,7,7,7,7,7,7,7,7}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{7,7,7,7,7,7,7,7,7,7}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{8,8,8,8,8,8,8,8,8,8}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{8,8,8,8,8,8,8,8,8,8}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{9,9,9,9,9,9,9,9,9,9}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{9,9,9,9,9,9,9,9,9,9}));
    assertTrue(hri.getEndKey() == null || hri.getEndKey().length == 0);
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   startKey=new byte[]{0,0,0,0,0,0};
  endKey=new byte[]{1,0,0,0,0,0};
  expectedRegions=5;
  TableName TABLE_3=TableName.valueOf(tableName.getNameAsString() + "_3");
  desc=new HTableDescriptor(TABLE_3);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(desc,startKey,endKey,expectedRegions);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_3)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   splitKeys=new byte[][]{new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{2,2,2}};
  TableName TABLE_4=TableName.valueOf(tableName.getNameAsString() + "_4");
  desc=new HTableDescriptor(TABLE_4);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  try {
    admin.createTable(desc,splitKeys);
    assertTrue("Should not be able to create this table because of " + "duplicate split keys",false);
  }
 catch (  IllegalArgumentException iae) {
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testTruncateTable() throws IOException {
  testTruncateTable(TableName.valueOf("testTruncateTable"),false);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testTruncateTablePreservingSplits() throws IOException {
  testTruncateTable(TableName.valueOf("testTruncateTablePreservingSplits"),true);
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test(timeout=300000) public void testCreateTableWithEmptyRowInTheSplitKeys() throws IOException {
  byte[] tableName=Bytes.toBytes("testCreateTableWithEmptyRowInTheSplitKeys");
  byte[][] splitKeys=new byte[3][];
  splitKeys[0]="region1".getBytes();
  splitKeys[1]=HConstants.EMPTY_BYTE_ARRAY;
  splitKeys[2]="region2".getBytes();
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(tableName));
  desc.addFamily(new HColumnDescriptor("col"));
  try {
    admin.createTable(desc,splitKeys);
    fail("Test case should fail as empty split key is passed.");
  }
 catch (  IllegalArgumentException e) {
    LOG.info("Expected ",e);
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
