<h3 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles (23 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(16)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithNoneToNone() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.NONE,DataBlockEncoding.NONE);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testNonHfileFolder() throws Exception {
  testNonHfileFolder("testNonHfileFolder",false);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that have
 * different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testSimpleHFileSplit() throws Exception {
  runTest("testHFileSplit",BloomType.NONE,new byte[][]{Bytes.toBytes("aaa"),Bytes.toBytes("fff"),Bytes.toBytes("jjj"),Bytes.toBytes("ppp"),Bytes.toBytes("uuu"),Bytes.toBytes("zzz")},new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("lll")},new byte[][]{Bytes.toBytes("mmm"),Bytes.toBytes("zzz")}});
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test loading into a column family that has a ROWCOL bloom filter.
 */
@Test(timeout=120000) public void testRegionCrossingRowColBloom() throws Exception {
  runTest("testRegionCrossingLoadRowColBloom",BloomType.ROWCOL,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<pre class="type-4 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=120000) public void testInferBoundaries(){
  TreeMap<byte[],Integer> map=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  String first;
  String last;
  first="a";
  last="e";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="r";
  last="s";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="o";
  last="p";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="g";
  last="k";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="v";
  last="x";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="c";
  last="i";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="m";
  last="q";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="s";
  last="t";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="u";
  last="w";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  byte[][] keysArray=LoadIncrementalHFiles.inferBoundaries(map);
  byte[][] compare=new byte[3][];
  compare[0]="m".getBytes();
  compare[1]="r".getBytes();
  compare[2]="u".getBytes();
  assertEquals(keysArray.length,3);
  for (int row=0; row < keysArray.length; row++) {
    assertArrayEquals(keysArray[row],compare[row]);
  }
}

</code></pre>

<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testLoadTooMayHFiles() throws Exception {
  Path dir=util.getDataTestDirOnTestFS("testLoadTooMayHFiles");
  FileSystem fs=util.getTestFileSystem();
  dir=dir.makeQualified(fs);
  Path familyDir=new Path(dir,Bytes.toString(FAMILY));
  byte[] from=Bytes.toBytes("begin");
  byte[] to=Bytes.toBytes("end");
  for (int i=0; i <= MAX_FILES_PER_REGION_PER_FAMILY; i++) {
    HFileTestUtil.createHFile(util.getConfiguration(),fs,new Path(familyDir,"hfile_" + i),FAMILY,QUALIFIER,from,to,1000);
  }
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(util.getConfiguration());
  String[] args={dir.toString(),"mytable_testLoadTooMayHFiles"};
  try {
    loader.run(args);
    fail("Bulk loading too many files should fail");
  }
 catch (  IOException ie) {
    assertTrue(ie.getMessage().contains("Trying to load more than " + MAX_FILES_PER_REGION_PER_FAMILY + " hfiles"));
  }
}

</code></pre>

<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TableNotFoundException.class) public void testWithoutAnExistingTableAndCreateTableSetToNo() throws Exception {
  Configuration conf=util.getConfiguration();
  conf.set(LoadIncrementalHFiles.CREATE_TABLE_CONF_KEY,"no");
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(conf);
  String[] args={"directory","nonExistingTable"};
  loader.run(args);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithEncodedToNone() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.DIFF,DataBlockEncoding.NONE);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test loading into a column family that has a ROW bloom filter.
 */
@Test(timeout=60000) public void testRegionCrossingRowBloom() throws Exception {
  runTest("testRegionCrossingLoadRowBloom",BloomType.ROW,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitALot() throws Exception {
  runTest("testSplitALot",BloomType.NONE,new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("bbb"),Bytes.toBytes("ccc"),Bytes.toBytes("ddd"),Bytes.toBytes("eee"),Bytes.toBytes("fff"),Bytes.toBytes("ggg"),Bytes.toBytes("hhh"),Bytes.toBytes("iii"),Bytes.toBytes("lll"),Bytes.toBytes("mmm"),Bytes.toBytes("nnn"),Bytes.toBytes("ooo"),Bytes.toBytes("ppp"),Bytes.toBytes("qqq"),Bytes.toBytes("rrr"),Bytes.toBytes("sss"),Bytes.toBytes("ttt"),Bytes.toBytes("uuu"),Bytes.toBytes("vvv"),Bytes.toBytes("zzz")},new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("zzz")}});
}

</code></pre>

<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test loading into a column family that does not exist.
 */
@Test(timeout=60000) public void testNonexistentColumnFamilyLoad() throws Exception {
  String testName="testNonexistentColumnFamilyLoad";
  byte[][][] hFileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("aaa"),Bytes.toBytes("ccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("ooo")}};
  final byte[] TABLE=Bytes.toBytes("mytable_" + testName);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(TABLE));
  HColumnDescriptor family=new HColumnDescriptor(Bytes.toBytes(new String(FAMILY).toUpperCase()));
  htd.addFamily(family);
  try {
    runTest(testName,htd,BloomType.NONE,true,SPLIT_KEYS,hFileRanges);
    assertTrue("Loading into table with non-existent family should have failed",false);
  }
 catch (  Exception e) {
    assertTrue("IOException expected",e instanceof IOException);
    String errMsg=e.getMessage();
    assertTrue("Incorrect exception message, expected message: [" + EXPECTED_MSG_FOR_NON_EXISTING_FAMILY + "], current message: ["+ errMsg+ "]",errMsg.contains(EXPECTED_MSG_FOR_NON_EXISTING_FAMILY));
  }
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=120000) public void testSplitStoreFile() throws IOException {
  Path dir=util.getDataTestDirOnTestFS("testSplitHFile");
  FileSystem fs=util.getTestFileSystem();
  Path testIn=new Path(dir,"testhfile");
  HColumnDescriptor familyDesc=new HColumnDescriptor(FAMILY);
  HFileTestUtil.createHFile(util.getConfiguration(),fs,testIn,FAMILY,QUALIFIER,Bytes.toBytes("aaa"),Bytes.toBytes("zzz"),1000);
  Path bottomOut=new Path(dir,"bottom.out");
  Path topOut=new Path(dir,"top.out");
  LoadIncrementalHFiles.splitStoreFile(util.getConfiguration(),testIn,familyDesc,Bytes.toBytes("ggg"),bottomOut,topOut);
  int rowCount=verifyHFile(bottomOut);
  rowCount+=verifyHFile(topOut);
  assertEquals(1000,rowCount);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * have a ROWCOL bloom filter and a different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testRegionCrossingHFileSplitRowColBloom() throws Exception {
  testRegionCrossingHFileSplit(BloomType.ROWCOL);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * have a ROW bloom filter and a different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testRegionCrossingHFileSplitRowBloom() throws Exception {
  testRegionCrossingHFileSplit(BloomType.ROW);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads
 * HFiles that cross the boundaries of those regions
 */
@Test(timeout=120000) public void testRegionCrossingLoad() throws Exception {
  runTest("testRegionCrossingLoad",BloomType.NONE,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that tags survive through a bulk load that needs to split hfiles.
 * This test depends on the "hbase.client.rpc.codec" =  KeyValueCodecWithTags so that the client
 * can get tags in the responses.
 */
@Test(timeout=60000) public void testTagsSurviveBulkLoadSplit() throws Exception {
  Path dir=util.getDataTestDirOnTestFS(tn.getMethodName());
  FileSystem fs=util.getTestFileSystem();
  dir=dir.makeQualified(fs);
  Path familyDir=new Path(dir,Bytes.toString(FAMILY));
  byte[][] tableSplitKeys=new byte[][]{Bytes.toBytes("aaa"),Bytes.toBytes("fff"),Bytes.toBytes("jjj"),Bytes.toBytes("ppp"),Bytes.toBytes("uuu"),Bytes.toBytes("zzz")};
  byte[] from=Bytes.toBytes("ddd");
  byte[] to=Bytes.toBytes("ooo");
  HFileTestUtil.createHFileWithTags(util.getConfiguration(),fs,new Path(familyDir,tn.getMethodName() + "_hfile"),FAMILY,QUALIFIER,from,to,1000);
  int expectedRows=1000;
  TableName tableName=TableName.valueOf(tn.getMethodName());
  HTableDescriptor htd=buildHTD(tableName,BloomType.NONE);
  util.getAdmin().createTable(htd,tableSplitKeys);
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(util.getConfiguration());
  String[] args={dir.toString(),tableName.toString()};
  loader.run(args);
  Table table=util.getConnection().getTable(tableName);
  try {
    assertEquals(expectedRows,util.countRows(table));
    HFileTestUtil.verifyTags(table);
  }
  finally {
    table.close();
  }
  util.deleteTable(tableName);
}

</code></pre>

<pre class="type-4 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=120000) public void testTableWithCFNameStartWithUnderScore() throws Exception {
  Path dir=util.getDataTestDirOnTestFS("cfNameStartWithUnderScore");
  FileSystem fs=util.getTestFileSystem();
  dir=dir.makeQualified(fs.getUri(),fs.getWorkingDirectory());
  String family="_cf";
  Path familyDir=new Path(dir,family);
  byte[] from=Bytes.toBytes("begin");
  byte[] to=Bytes.toBytes("end");
  Configuration conf=util.getConfiguration();
  String tableName="mytable_cfNameStartWithUnderScore";
  Table table=util.createTable(TableName.valueOf(tableName),family);
  HFileTestUtil.createHFile(conf,fs,new Path(familyDir,"hfile"),Bytes.toBytes(family),QUALIFIER,from,to,1000);
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(conf);
  String[] args={dir.toString(),tableName};
  try {
    loader.run(args);
    assertEquals(1000,util.countRows(table));
  }
  finally {
    if (null != table) {
      table.close();
    }
  }
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  util.shutdownMiniCluster();
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithNoneToEncoded() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.NONE,DataBlockEncoding.DIFF);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * and have different region boundaries than the table pre-split.
 */
@Test(timeout=60000) public void testRegionCrossingHFileSplit() throws Exception {
  testRegionCrossingHFileSplit(BloomType.NONE);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads
 * HFiles that fit snugly inside those regions
 */
@Test(timeout=120000) public void testSimpleLoad() throws Exception {
  runTest("testSimpleLoad",BloomType.NONE,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("cccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("ooo")}});
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testNonHfileFolderWithUnmatchedFamilyName() throws Exception {
  testNonHfileFolder("testNonHfileFolderWithUnmatchedFamilyName",true);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithEncodedToEncoded() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.DIFF,DataBlockEncoding.DIFF);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
