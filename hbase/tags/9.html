<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestLazyCfLoading </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadersAndWriters() throws Exception {
  Configuration conf=util.getConfiguration();
  String timeoutKey=String.format(TIMEOUT_KEY,this.getClass().getSimpleName());
  long maxRuntime=conf.getLong(timeoutKey,DEFAULT_TIMEOUT_MINUTES);
  long serverCount=util.getHBaseClusterInterface().getClusterStatus().getServersSize();
  long keysToWrite=serverCount * KEYS_TO_WRITE_PER_SERVER;
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(TABLE_NAME);
  MultiThreadedWriter writer=new MultiThreadedWriter(dataGen,conf,TABLE_NAME);
  writer.setMultiPut(true);
  LOG.info("Starting writer; the number of keys to write is " + keysToWrite);
  writer.start(1,keysToWrite,WRITER_THREADS);
  long now=EnvironmentEdgeManager.currentTime();
  long timeLimit=now + (maxRuntime * 60000);
  boolean isWriterDone=false;
  while (now < timeLimit && !isWriterDone) {
    LOG.info("Starting the scan; wrote approximately " + dataGen.getTotalNumberOfKeys() + " keys");
    isWriterDone=writer.isDone();
    if (isWriterDone) {
      LOG.info("Scanning full result, writer is done");
    }
    Scan scan=new Scan();
    for (    byte[] cf : dataGen.getColumnFamilies()) {
      scan.addFamily(cf);
    }
    scan.setFilter(dataGen.getScanFilter());
    scan.setLoadColumnFamiliesOnDemand(true);
    long onesGennedBeforeScan=dataGen.getExpectedNumberOfKeys();
    long startTs=EnvironmentEdgeManager.currentTime();
    ResultScanner results=table.getScanner(scan);
    long resultCount=0;
    Result result=null;
    while ((result=results.next()) != null) {
      boolean isOk=writer.verifyResultAgainstDataGenerator(result,true,true);
      Assert.assertTrue("Failed to verify [" + Bytes.toString(result.getRow()) + "]",isOk);
      ++resultCount;
    }
    long timeTaken=EnvironmentEdgeManager.currentTime() - startTs;
    long onesGennedAfterScan=dataGen.getExpectedNumberOfKeys();
    Assert.assertTrue("Read " + resultCount + " keys when at most "+ onesGennedAfterScan+ " were generated ",onesGennedAfterScan >= resultCount);
    if (isWriterDone) {
      Assert.assertTrue("Read " + resultCount + " keys; the writer is done and "+ onesGennedAfterScan+ " keys were generated",onesGennedAfterScan == resultCount);
    }
 else     if (onesGennedBeforeScan * 0.9 > resultCount) {
      LOG.warn("Read way too few keys (" + resultCount + "/"+ onesGennedBeforeScan+ ") - there might be a problem, or the writer might just be slow");
    }
    LOG.info("Scan took " + timeTaken + "ms");
    if (!isWriterDone) {
      Thread.sleep(WAIT_BETWEEN_SCANS_MS);
      now=EnvironmentEdgeManager.currentTime();
    }
  }
  Assert.assertEquals("There are write failures",0,writer.getNumWriteFailures());
  Assert.assertTrue("Writer is not done",isWriterDone);
  connection.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHBaseTestingUtility </h4><pre class="type-9 type-10 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniZooKeeperWithMultipleClientPorts() throws Exception {
  int defaultClientPort=8888;
  int i, j;
  HBaseTestingUtility hbt=new HBaseTestingUtility();
  int[] clientPortList1={1111,1112,1113};
  MiniZooKeeperCluster cluster1=hbt.startMiniZKCluster(clientPortList1.length,clientPortList1);
  try {
    List<Integer> clientPortListInCluster=cluster1.getClientPortList();
    for (i=0; i < clientPortListInCluster.size(); i++) {
      assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList1[i]);
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList2={2222,2223};
  MiniZooKeeperCluster cluster2=hbt.startMiniZKCluster(clientPortList2.length + 2,clientPortList2);
  try {
    List<Integer> clientPortListInCluster=cluster2.getClientPortList();
    for (i=0, j=0; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList2.length) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList2[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j++;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList3={3333,-3334,3335,0};
  MiniZooKeeperCluster cluster3=hbt.startMiniZKCluster(clientPortList3.length + 1,clientPortList3);
  try {
    List<Integer> clientPortListInCluster=cluster3.getClientPortList();
    for (i=0, j=0; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList3.length && clientPortList3[i] > 0) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList3[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j++;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList4={-4444,defaultClientPort + 2,4446,defaultClientPort};
  MiniZooKeeperCluster cluster4=hbt.startMiniZKCluster(clientPortList4.length + 1,clientPortList4);
  try {
    List<Integer> clientPortListInCluster=cluster4.getClientPortList();
    for (i=0, j=1; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList4.length && clientPortList4[i] > 0) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList4[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j+=2;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  int[] clientPortList5={5555,5556,5556};
  try {
    MiniZooKeeperCluster cluster5=hbt.startMiniZKCluster(clientPortList5.length,clientPortList5);
    assertTrue(cluster5.getClientPort() == -1);
  }
 catch (  Exception e) {
  }
 finally {
    hbt.shutdownMiniZKCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMultiVersions </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Port of old TestScanMultipleVersions test here so can better utilize the
 * spun up cluster running more than just a single test.  Keep old tests
 * crazyness.
 * <p>Tests five cases of scans and timestamps.
 * @throws Exception
 */
@Test public void testScanMultipleVersions() throws Exception {
  final TableName tableName=TableName.valueOf("testScanMultipleVersions");
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  final byte[][] rows=new byte[][]{Bytes.toBytes("row_0200"),Bytes.toBytes("row_0800")};
  final byte[][] splitRows=new byte[][]{Bytes.toBytes("row_0500")};
  final long[] timestamp=new long[]{100L,1000L};
  this.admin.createTable(desc,splitRows);
  Table table=UTIL.getConnection().getTable(tableName);
  Pair<byte[][],byte[][]> keys=UTIL.getConnection().getRegionLocator(tableName).getStartEndKeys();
  assertEquals(2,keys.getFirst().length);
  byte[][] startKeys=keys.getFirst();
  byte[][] endKeys=keys.getSecond();
  for (int i=0; i < startKeys.length; i++) {
    if (i == 0) {
      assertTrue(Bytes.equals(HConstants.EMPTY_START_ROW,startKeys[i]));
      assertTrue(Bytes.equals(endKeys[i],splitRows[0]));
    }
 else     if (i == 1) {
      assertTrue(Bytes.equals(splitRows[0],startKeys[i]));
      assertTrue(Bytes.equals(endKeys[i],HConstants.EMPTY_END_ROW));
    }
  }
  List<Put> puts=new ArrayList<>();
  for (int i=0; i < startKeys.length; i++) {
    for (int j=0; j < timestamp.length; j++) {
      Put put=new Put(rows[i],timestamp[j]);
      put.addColumn(HConstants.CATALOG_FAMILY,null,timestamp[j],Bytes.toBytes(timestamp[j]));
      puts.add(put);
    }
  }
  table.put(puts);
  for (int i=0; i < rows.length; i++) {
    for (int j=0; j < timestamp.length; j++) {
      Get get=new Get(rows[i]);
      get.addFamily(HConstants.CATALOG_FAMILY);
      get.setTimeStamp(timestamp[j]);
      Result result=table.get(get);
      int cellCount=0;
      for (      @SuppressWarnings("unused") Cell kv : result.listCells()) {
        cellCount++;
      }
      assertTrue(cellCount == 1);
    }
  }
  int count=0;
  Scan scan=new Scan();
  scan.addFamily(HConstants.CATALOG_FAMILY);
  ResultScanner s=table.getScanner(scan);
  try {
    for (Result rr=null; (rr=s.next()) != null; ) {
      System.out.println(rr.toString());
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeRange(1000L,Long.MAX_VALUE);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeStamp(1000L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeRange(100L,1000L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeStamp(100L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.backup.TestHFileArchiving </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test HFileArchiver.resolveAndArchive() race condition HBASE-7643
 */
@Test public void testCleaningRace() throws Exception {
  final long TEST_TIME=20 * 1000;
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  Configuration conf=UTIL.getMiniHBaseCluster().getMaster().getConfiguration();
  Path rootDir=UTIL.getDataTestDirOnTestFS("testCleaningRace");
  FileSystem fs=UTIL.getTestFileSystem();
  Path archiveDir=new Path(rootDir,HConstants.HFILE_ARCHIVE_DIRECTORY);
  Path regionDir=new Path(FSUtils.getTableDir(new Path("./"),TableName.valueOf("table")),"abcdef");
  Path familyDir=new Path(regionDir,"cf");
  Path sourceRegionDir=new Path(rootDir,regionDir);
  fs.mkdirs(sourceRegionDir);
  Stoppable stoppable=new StoppableImplementation();
  HFileCleaner cleaner=new HFileCleaner(1,stoppable,conf,fs,archiveDir);
  try {
    choreService.scheduleChore(cleaner);
    long startTime=System.currentTimeMillis();
    for (long fid=0; (System.currentTimeMillis() - startTime) < TEST_TIME; ++fid) {
      Path file=new Path(familyDir,String.valueOf(fid));
      Path sourceFile=new Path(rootDir,file);
      Path archiveFile=new Path(archiveDir,file);
      fs.createNewFile(sourceFile);
      try {
        HFileArchiver.archiveRegion(fs,rootDir,sourceRegionDir.getParent(),sourceRegionDir);
        LOG.debug("hfile=" + fid + " should be in the archive");
        assertTrue(fs.exists(archiveFile));
        assertFalse(fs.exists(sourceFile));
      }
 catch (      IOException e) {
        LOG.debug("hfile=" + fid + " should be in the source location");
        assertFalse(fs.exists(archiveFile));
        assertTrue(fs.exists(sourceFile));
        fs.delete(sourceFile,false);
      }
    }
  }
  finally {
    stoppable.stop("test end");
    cleaner.cancel(true);
    choreService.shutdown();
    fs.delete(rootDir,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAsyncProcess </h4><pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReplicaAllCallsFailForOneRegion() throws Exception {
  MyAsyncProcessWithReplicas ap=createReplicaAp(500,1000,0,0);
  ap.addFailures(hri1,hri1r1,hri1r2,hri2r1);
  List<Get> rows=makeTimelineGets(DUMMY_BYTES_1,DUMMY_BYTES_2);
  AsyncRequestFuture ars=ap.submitAll(DUMMY_TABLE,rows,null,new Object[2]);
  verifyReplicaResult(ars,RR.FAILED,RR.FALSE);
  Assert.assertEquals(3,ars.getErrors().getNumExceptions());
  for (int i=0; i < ars.getErrors().getNumExceptions(); ++i) {
    Assert.assertArrayEquals(DUMMY_BYTES_1,ars.getErrors().getRow(i).getRow());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestBlockEvictionFromClient </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiGets() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(2);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testMultiGets");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    MultiGetThread[] getThreads=initiateMultiGet(table);
    Thread.sleep(200);
    int refCount;
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean foundNonZeroBlock=false;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        foundNonZeroBlock=true;
      }
    }
    assertTrue("Should have found nonzero ref count block",foundNonZeroBlock);
    CustomInnerRegionObserver.getCdl().get().countDown();
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    MultiGetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    iterateBlockCache(cache,iterator);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockEvictionAfterHBASE13082WithCompactionAndFlush() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    compactionLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testBlockEvictionAfterHBASE13082WithCompactionAndFlush");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserverWrapper.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    region.flush(true);
    int refCount=0;
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    byte[] data2=Bytes.add(data,data);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    System.out.println("Flushing cache");
    region.flush(true);
    Iterator<CachedBlock> iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    ScanThread[] scanThreads=initiateScan(table,false);
    Thread.sleep(100);
    iterator=cache.iterator();
    boolean usedBlocksFound=false;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    data2=Bytes.add(data,data);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    System.out.println("Flushing cache");
    region.flush(true);
    assertTrue("Blocks with non zero ref count should be found ",usedBlocksFound);
    usedBlocksFound=false;
    System.out.println("Compacting");
    assertEquals(3,store.getStorefilesCount());
    store.triggerMajorCompaction();
    region.compact(true);
    waitForStoreFileCount(store,1,10000);
    assertEquals(1,store.getStorefilesCount());
    iterator=cache.iterator();
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue("Blocks with non zero ref count should be found ",usedBlocksFound);
    compactionLatch.countDown();
    latch.countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    Result r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetsWithMultiColumnsAndExplicitTracker() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testGetsWithMultiColumnsAndExplicitTracker");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(FAMILY,Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    GetThread[] getThreads=initiateGet(table,true,false);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(10,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithMultipleColumnFamilies() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testScanWithMultipleColumnFamilies");
    byte[][] fams=new byte[10][];
    fams[0]=FAMILY;
    for (int i=1; i < 10; i++) {
      fams[i]=(Bytes.toBytes("testFamily" + i));
    }
    table=TEST_UTIL.createTable(tableName,fams,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(Bytes.toBytes("testFamily" + i),Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    ScanThread[] scanThreads=initiateScan(table,true);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(12,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    checkForBlockEviction(cache,true,false,false);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetWithMultipleColumnFamilies() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testGetWithMultipleColumnFamilies");
    byte[][] fams=new byte[10][];
    fams[0]=FAMILY;
    for (int i=1; i < 10; i++) {
      fams[i]=(Bytes.toBytes("testFamily" + i));
    }
    table=TEST_UTIL.createTable(tableName,fams,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(Bytes.toBytes("testFamily" + i),Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    GetThread[] getThreads=initiateGet(table,true,true);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(3,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithException() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    exceptionLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testScanWithException");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserverWrapper.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    insertData(table);
    System.out.println("Flushing cache");
    region.flush(true);
    CustomInnerRegionObserver.throwException.set(true);
    ScanThread[] scanThreads=initiateScan(table,false);
    Thread.sleep(100);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue(usedBlocksFound);
    exceptionLatch.countDown();
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    iterator=cache.iterator();
    usedBlocksFound=false;
    refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue(usedBlocksFound);
    Thread.sleep(5100);
    iterator=cache.iterator();
    refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      assertEquals(0,refCount);
    }
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientExponentialBackoff </h4><pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Make sure that we get results in the order that we expect - backoff for a load of 1 should
 * less than backoff for 10, which should be less than that for 50.
 */
@Test public void testResultOrdering(){
  Configuration conf=new Configuration(false);
  conf.setLong(ExponentialClientBackoffPolicy.MAX_BACKOFF_KEY,Integer.MAX_VALUE);
  ExponentialClientBackoffPolicy backoff=new ExponentialClientBackoffPolicy(conf);
  ServerStatistics stats=new ServerStatistics();
  long previous=backoff.getBackoffTime(server,regionname,stats);
  for (int i=1; i <= 100; i++) {
    update(stats,i);
    long next=backoff.getBackoffTime(server,regionname,stats);
    assertTrue("Previous backoff time" + previous + " >= "+ next+ ", the next backoff time for "+ "load "+ i,previous < next);
    previous=next;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientSmallReversedScanner </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextPresent() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  @SuppressWarnings("unchecked") RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1})};
        }
 else {
          results=new Result[0];
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenAnswer(createTrueThenFalseAnswer());
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    Queue<Result> results=csrs.cache;
    Iterator<Result> iter=results.iterator();
    assertEquals(3,results.size());
    for (int i=3; i >= 1 && iter.hasNext(); i--) {
      Result result=iter.next();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextFewerRecords() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1})};
        }
 else {
          throw new RuntimeException("Should not fetch a third batch from the server");
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    Queue<Result> results=csrs.cache;
    Iterator<Result> iter=results.iterator();
    assertEquals(2,results.size());
    for (int i=3; i >= 2 && iter.hasNext(); i--) {
      Result result=iter.next();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    results.clear();
    csrs.loadCache();
    assertEquals(1,results.size());
    Result result=results.peek();
    assertEquals("row1",new String(result.getRow(),StandardCharsets.UTF_8));
    assertEquals(1,result.getMap().size());
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientSmallScanner </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextFewerRecords() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3})};
        }
 else {
          throw new RuntimeException("Should not fetch a third batch from the server");
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    Queue<Result> results=css.cache;
    assertEquals(2,results.size());
    for (int i=1; i <= 2; i++) {
      Result result=results.poll();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    results.clear();
    css.loadCache();
    assertEquals(1,results.size());
    Result result=results.peek();
    assertEquals("row3",new String(result.getRow(),StandardCharsets.UTF_8));
    assertEquals(1,result.getMap().size());
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextPresent() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  @SuppressWarnings("unchecked") RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3})};
        }
 else {
          results=new Result[0];
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenAnswer(createTrueThenFalseAnswer());
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    Queue<Result> results=css.cache;
    assertEquals(3,results.size());
    for (int i=1; i <= 3; i++) {
      Result result=results.poll();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFromClientSide </h4><pre class="type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testGetStartEndKeysWithRegionReplicas() throws IOException {
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testGetStartEndKeys"));
  HColumnDescriptor fam=new HColumnDescriptor(FAMILY);
  htd.addFamily(fam);
  byte[][] KEYS=HBaseTestingUtility.KEYS_FOR_HBA_CREATE_TABLE;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(htd,KEYS);
  List<HRegionInfo> regions=admin.getTableRegions(htd.getTableName());
  HRegionLocator locator=(HRegionLocator)admin.getConnection().getRegionLocator(htd.getTableName());
  for (int regionReplication=1; regionReplication < 4; regionReplication++) {
    List<RegionLocations> regionLocations=new ArrayList<RegionLocations>();
    for (    HRegionInfo region : regions) {
      HRegionLocation[] arr=new HRegionLocation[regionReplication];
      for (int i=0; i < arr.length; i++) {
        arr[i]=new HRegionLocation(RegionReplicaUtil.getRegionInfoForReplica(region,i),null);
      }
      regionLocations.add(new RegionLocations(arr));
    }
    Pair<byte[][],byte[][]> startEndKeys=locator.getStartEndKeys(regionLocations);
    assertEquals(KEYS.length + 1,startEndKeys.getFirst().length);
    for (int i=0; i < KEYS.length + 1; i++) {
      byte[] startKey=i == 0 ? HConstants.EMPTY_START_ROW : KEYS[i - 1];
      byte[] endKey=i == KEYS.length ? HConstants.EMPTY_END_ROW : KEYS[i];
      assertArrayEquals(startKey,startEndKeys.getFirst()[i]);
      assertArrayEquals(endKey,startEndKeys.getSecond()[i]);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientPoolRoundRobin() throws IOException {
  final TableName tableName=TableName.valueOf("testClientPoolRoundRobin");
  int poolSize=3;
  int numVersions=poolSize * 2;
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.HBASE_CLIENT_IPC_POOL_TYPE,"round-robin");
  conf.setInt(HConstants.HBASE_CLIENT_IPC_POOL_SIZE,poolSize);
  Table table=TEST_UTIL.createTable(tableName,new byte[][]{FAMILY},Integer.MAX_VALUE);
  final long ts=EnvironmentEdgeManager.currentTime();
  Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions();
  for (int versions=1; versions <= numVersions; versions++) {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,ts + versions,VALUE);
    table.put(put);
    Result result=table.get(get);
    NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
    assertEquals("The number of versions of '" + FAMILY + ":"+ QUALIFIER+ " did not match "+ versions,versions,navigableMap.size());
    for (    Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
      assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * HBASE-867
 * If millions of columns in a column family, hbase scanner won't come up
 * Test will create numRows rows, each with numColsPerRow columns
 * (1 version each), and attempt to scan them all.
 * To test at scale, up numColsPerRow to the millions
 * (have not gotten that to work running as junit though)
 */
@Test public void testJiraTest867() throws Exception {
  int numRows=10;
  int numColsPerRow=2000;
  TableName TABLE=TableName.valueOf("testJiraTest867");
  byte[][] ROWS=makeN(ROW,numRows);
  byte[][] QUALIFIERS=makeN(QUALIFIER,numColsPerRow);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  for (int i=0; i < numRows; i++) {
    Put put=new Put(ROWS[i]);
    put.setDurability(Durability.SKIP_WAL);
    for (int j=0; j < numColsPerRow; j++) {
      put.addColumn(FAMILY,QUALIFIERS[j],QUALIFIERS[j]);
    }
    assertTrue("Put expected to contain " + numColsPerRow + " columns but "+ "only contains "+ put.size(),put.size() == numColsPerRow);
    ht.put(put);
  }
  Get get=new Get(ROWS[numRows - 1]);
  Result result=ht.get(get);
  assertNumKeys(result,numColsPerRow);
  Cell[] keys=result.rawCells();
  for (int i=0; i < result.size(); i++) {
    assertKey(keys[i],ROWS[numRows - 1],FAMILY,QUALIFIERS[i],QUALIFIERS[i]);
  }
  Scan scan=new Scan();
  ResultScanner scanner=ht.getScanner(scan);
  int rowCount=0;
  while ((result=scanner.next()) != null) {
    assertNumKeys(result,numColsPerRow);
    Cell[] kvs=result.rawCells();
    for (int i=0; i < numColsPerRow; i++) {
      assertKey(kvs[i],ROWS[rowCount],FAMILY,QUALIFIERS[i],QUALIFIERS[i]);
    }
    rowCount++;
  }
  scanner.close();
  assertTrue("Expected to scan " + numRows + " rows but actually scanned "+ rowCount+ " rows",rowCount == numRows);
  TEST_UTIL.flush();
  get=new Get(ROWS[numRows - 1]);
  result=ht.get(get);
  assertNumKeys(result,numColsPerRow);
  keys=result.rawCells();
  for (int i=0; i < result.size(); i++) {
    assertKey(keys[i],ROWS[numRows - 1],FAMILY,QUALIFIERS[i],QUALIFIERS[i]);
  }
  scan=new Scan();
  scanner=ht.getScanner(scan);
  rowCount=0;
  while ((result=scanner.next()) != null) {
    assertNumKeys(result,numColsPerRow);
    Cell[] kvs=result.rawCells();
    for (int i=0; i < numColsPerRow; i++) {
      assertKey(kvs[i],ROWS[rowCount],FAMILY,QUALIFIERS[i],QUALIFIERS[i]);
    }
    rowCount++;
  }
  scanner.close();
  assertTrue("Expected to scan " + numRows + " rows but actually scanned "+ rowCount+ " rows",rowCount == numRows);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Flakey: HBASE-8989") @Test public void testClientPoolThreadLocal() throws IOException {
  final TableName tableName=TableName.valueOf("testClientPoolThreadLocal");
  int poolSize=Integer.MAX_VALUE;
  int numVersions=3;
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.HBASE_CLIENT_IPC_POOL_TYPE,"thread-local");
  conf.setInt(HConstants.HBASE_CLIENT_IPC_POOL_SIZE,poolSize);
  final Table table=TEST_UTIL.createTable(tableName,new byte[][]{FAMILY},3);
  final long ts=EnvironmentEdgeManager.currentTime();
  final Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions();
  for (int versions=1; versions <= numVersions; versions++) {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,ts + versions,VALUE);
    table.put(put);
    Result result=table.get(get);
    NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
    assertEquals("The number of versions of '" + FAMILY + ":"+ QUALIFIER+ " did not match "+ versions+ "; "+ put.toString()+ ", "+ get.toString(),versions,navigableMap.size());
    for (    Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
      assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
    }
  }
  final Object waitLock=new Object();
  ExecutorService executorService=Executors.newFixedThreadPool(numVersions);
  final AtomicReference<AssertionError> error=new AtomicReference<AssertionError>(null);
  for (int versions=numVersions; versions < numVersions * 2; versions++) {
    final int versionsCopy=versions;
    executorService.submit(new Callable<Void>(){
      @Override public Void call(){
        try {
          Put put=new Put(ROW);
          put.addColumn(FAMILY,QUALIFIER,ts + versionsCopy,VALUE);
          table.put(put);
          Result result=table.get(get);
          NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
          assertEquals("The number of versions of '" + Bytes.toString(FAMILY) + ":"+ Bytes.toString(QUALIFIER)+ " did not match "+ versionsCopy,versionsCopy,navigableMap.size());
          for (          Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
            assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
          }
synchronized (waitLock) {
            waitLock.wait();
          }
        }
 catch (        Exception e) {
        }
catch (        AssertionError e) {
          error.set(e);
          LOG.error(e);
        }
        return null;
      }
    }
);
  }
synchronized (waitLock) {
    waitLock.notifyAll();
  }
  executorService.shutdownNow();
  assertNull(error.get());
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * test for HBASE-737
 * @throws IOException
 */
@Test public void testHBase737() throws IOException {
  final byte[] FAM1=Bytes.toBytes("fam1");
  final byte[] FAM2=Bytes.toBytes("fam2");
  Table table=TEST_UTIL.createTable(TableName.valueOf("testHBase737"),new byte[][]{FAM1,FAM2});
  Put put=new Put(ROW);
  put.addColumn(FAM1,Bytes.toBytes("letters"),Bytes.toBytes("abcdefg"));
  table.put(put);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException i) {
  }
  put=new Put(ROW);
  put.addColumn(FAM1,Bytes.toBytes("numbers"),Bytes.toBytes("123456"));
  table.put(put);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException i) {
  }
  put=new Put(ROW);
  put.addColumn(FAM2,Bytes.toBytes("letters"),Bytes.toBytes("hijklmnop"));
  table.put(put);
  long times[]=new long[3];
  Scan scan=new Scan();
  scan.addFamily(FAM1);
  scan.addFamily(FAM2);
  ResultScanner s=table.getScanner(scan);
  try {
    int index=0;
    Result r=null;
    while ((r=s.next()) != null) {
      for (      Cell key : r.rawCells()) {
        times[index++]=key.getTimestamp();
      }
    }
  }
  finally {
    s.close();
  }
  for (int i=0; i < times.length - 1; i++) {
    for (int j=i + 1; j < times.length; j++) {
      assertTrue(times[j] > times[i]);
    }
  }
  TEST_UTIL.flush();
  for (int i=0; i < times.length; i++) {
    times[i]=0;
  }
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException i) {
  }
  scan=new Scan();
  scan.addFamily(FAM1);
  scan.addFamily(FAM2);
  s=table.getScanner(scan);
  try {
    int index=0;
    Result r=null;
    while ((r=s.next()) != null) {
      for (      Cell key : r.rawCells()) {
        times[index++]=key.getTimestamp();
      }
    }
  }
  finally {
    s.close();
  }
  for (int i=0; i < times.length - 1; i++) {
    for (int j=i + 1; j < times.length; j++) {
      assertTrue(times[j] > times[i]);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletes() throws Exception {
  TableName TABLE=TableName.valueOf("testDeletes");
  byte[][] ROWS=makeNAscii(ROW,6);
  byte[][] FAMILIES=makeNAscii(FAMILY,3);
  byte[][] VALUES=makeN(VALUE,5);
  long[] ts={1000,2000,3000,4000,5000};
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES,3);
  Put put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[1],VALUES[1]);
  ht.put(put);
  Delete delete=new Delete(ROW);
  delete.addFamily(FAMILIES[0],ts[0]);
  ht.delete(delete);
  Get get=new Get(ROW);
  get.addFamily(FAMILIES[0]);
  get.setMaxVersions(Integer.MAX_VALUE);
  Result result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1]},new byte[][]{VALUES[1]},0,0);
  Scan scan=new Scan(ROW);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1]},new byte[][]{VALUES[1]},0,0);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[3],VALUES[3]);
  put.addColumn(FAMILIES[0],null,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],null,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],null,ts[3],VALUES[3]);
  ht.put(put);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],QUALIFIER);
  ht.delete(delete);
  get=new Get(ROW);
  get.addColumn(FAMILIES[0],QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  scan=new Scan(ROW);
  scan.addColumn(FAMILIES[0],QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],null);
  ht.delete(delete);
  delete=new Delete(ROW);
  delete.addColumns(FAMILIES[0],null);
  ht.delete(delete);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  ht.put(put);
  get=new Get(ROW);
  get.addFamily(FAMILIES[0]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  scan=new Scan(ROW);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[1]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[2]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  get=new Get(ROWS[2]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 4 key but received " + result.size() + ": "+ result,result.size() == 4);
  delete=new Delete(ROWS[0]);
  delete.addFamily(FAMILIES[2]);
  ht.delete(delete);
  delete=new Delete(ROWS[1]);
  delete.addColumns(FAMILIES[1],QUALIFIER);
  ht.delete(delete);
  delete=new Delete(ROWS[2]);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[2],QUALIFIER);
  ht.delete(delete);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertNResult(result,ROWS[0],FAMILIES[1],QUALIFIER,new long[]{ts[0],ts[1]},new byte[][]{VALUES[0],VALUES[1]},0,1);
  scan=new Scan(ROWS[0]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertNResult(result,ROWS[0],FAMILIES[1],QUALIFIER,new long[]{ts[0],ts[1]},new byte[][]{VALUES[0],VALUES[1]},0,1);
  get=new Get(ROWS[1]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  scan=new Scan(ROWS[1]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  get=new Get(ROWS[2]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertEquals(1,result.size());
  assertNResult(result,ROWS[2],FAMILIES[2],QUALIFIER,new long[]{ts[2]},new byte[][]{VALUES[2]},0,0);
  scan=new Scan(ROWS[2]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertEquals(1,result.size());
  assertNResult(result,ROWS[2],FAMILIES[2],QUALIFIER,new long[]{ts[2]},new byte[][]{VALUES[2]},0,0);
  delete=new Delete(ROWS[3]);
  delete.addFamily(FAMILIES[1]);
  ht.delete(delete);
  put=new Put(ROWS[3]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[0]);
  ht.put(put);
  put=new Put(ROWS[4]);
  put.addColumn(FAMILIES[1],QUALIFIER,VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[2]);
  ht.put(put);
  get=new Get(ROWS[3]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 1 key but received " + result.size(),result.size() == 1);
  get=new Get(ROWS[4]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  scan=new Scan(ROWS[3]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  ResultScanner scanner=ht.getScanner(scan);
  result=scanner.next();
  assertTrue("Expected 1 key but received " + result.size(),result.size() == 1);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[3]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[0]));
  result=scanner.next();
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[1]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[1]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[1]),VALUES[2]));
  scanner.close();
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    put=new Put(bytes);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(FAMILIES[0],QUALIFIER,bytes);
    ht.put(put);
  }
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    get=new Get(bytes);
    get.addFamily(FAMILIES[0]);
    result=ht.get(get);
    assertTrue(result.size() == 1);
  }
  ArrayList<Delete> deletes=new ArrayList<Delete>();
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    delete=new Delete(bytes);
    delete.addFamily(FAMILIES[0]);
    deletes.add(delete);
  }
  ht.delete(deletes);
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    get=new Get(bytes);
    get.addFamily(FAMILIES[0]);
    result=ht.get(get);
    assertTrue(result.size() == 0);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testListTables() throws IOException, InterruptedException {
  TableName t1=TableName.valueOf("testListTables1");
  TableName t2=TableName.valueOf("testListTables2");
  TableName t3=TableName.valueOf("testListTables3");
  TableName[] tables=new TableName[]{t1,t2,t3};
  for (int i=0; i < tables.length; i++) {
    TEST_UTIL.createTable(tables[i],FAMILY);
  }
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor[] ts=admin.listTables();
  HashSet<HTableDescriptor> result=new HashSet<HTableDescriptor>(ts.length);
  Collections.addAll(result,ts);
  int size=result.size();
  assertTrue(size >= tables.length);
  for (int i=0; i < tables.length && i < size; i++) {
    boolean found=false;
    for (int j=0; j < ts.length; j++) {
      if (ts[j].getTableName().equals(tables[i])) {
        found=true;
        break;
      }
    }
    assertTrue("Not found: " + tables[i],found);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFromClientSideNoCodec </h4><pre class="type-9 type-10 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBasics() throws IOException {
  final TableName t=TableName.valueOf("testBasics");
  final byte[][] fs=new byte[][]{Bytes.toBytes("cf1"),Bytes.toBytes("cf2"),Bytes.toBytes("cf3")};
  Table ht=TEST_UTIL.createTable(t,fs);
  final byte[] row=Bytes.toBytes("row");
  Put p=new Put(row);
  for (  byte[] f : fs) {
    p.addColumn(f,f,f);
  }
  ht.put(p);
  Result r=ht.get(new Get(row));
  int i=0;
  for (CellScanner cellScanner=r.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    byte[] f=fs[i++];
    assertTrue(Bytes.toString(f),Bytes.equals(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength(),f,0,f.length));
  }
  if (ht instanceof HTableInterface) {
    HTableInterface hti=(HTableInterface)ht;
    byte[] f=fs[0];
    Get get=new Get(row);
    get.addFamily(f);
    r=ht.get(get);
    assertTrue(r.toString(),r.containsColumn(f,f));
  }
  ResultScanner scanner=ht.getScanner(new Scan());
  int count=0;
  while ((r=scanner.next()) != null) {
    assertTrue(r.listCells().size() == 3);
    count++;
  }
  assertTrue(count == 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestHTableMultiplexer </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHTableMultiplexer() throws Exception {
  TableName TABLE_1=TableName.valueOf("testHTableMultiplexer_1");
  TableName TABLE_2=TableName.valueOf("testHTableMultiplexer_2");
  final int NUM_REGIONS=10;
  final int VERSION=3;
  List<Put> failedPuts;
  boolean success;
  HTableMultiplexer multiplexer=new HTableMultiplexer(TEST_UTIL.getConfiguration(),PER_REGIONSERVER_QUEUE_SIZE);
  Table htable1=TEST_UTIL.createTable(TABLE_1,new byte[][]{FAMILY},VERSION,Bytes.toBytes("aaaaa"),Bytes.toBytes("zzzzz"),NUM_REGIONS);
  Table htable2=TEST_UTIL.createTable(TABLE_2,new byte[][]{FAMILY},VERSION,Bytes.toBytes("aaaaa"),Bytes.toBytes("zzzzz"),NUM_REGIONS);
  TEST_UTIL.waitUntilAllRegionsAssigned(TABLE_1);
  TEST_UTIL.waitUntilAllRegionsAssigned(TABLE_2);
  try (RegionLocator rl=TEST_UTIL.getConnection().getRegionLocator(TABLE_1)){
    byte[][] startRows=rl.getStartKeys();
    byte[][] endRows=rl.getEndKeys();
    for (int i=0; i < NUM_REGIONS; i++) {
      byte[] row=startRows[i];
      if (row == null || row.length <= 0)       continue;
      Put put=new Put(row).addColumn(FAMILY,QUALIFIER,VALUE1);
      success=multiplexer.put(TABLE_1,put);
      assertTrue("multiplexer.put returns",success);
      put=new Put(row).addColumn(FAMILY,QUALIFIER,VALUE1);
      success=multiplexer.put(TABLE_2,put);
      assertTrue("multiplexer.put failed",success);
      LOG.info("Put for " + Bytes.toStringBinary(startRows[i]) + " @ iteration "+ (i + 1));
      checkExistence(htable1,startRows[i],FAMILY,QUALIFIER);
      checkExistence(htable2,startRows[i],FAMILY,QUALIFIER);
    }
    List<Put> multiput=new ArrayList<Put>();
    for (int i=0; i < NUM_REGIONS; i++) {
      byte[] row=endRows[i];
      if (row == null || row.length <= 0)       continue;
      Put put=new Put(row);
      put.addColumn(FAMILY,QUALIFIER,VALUE2);
      multiput.add(put);
    }
    failedPuts=multiplexer.put(TABLE_1,multiput);
    assertTrue(failedPuts == null);
    for (int i=0; i < NUM_REGIONS; i++) {
      byte[] row=endRows[i];
      if (row == null || row.length <= 0)       continue;
      Get get=new Get(row);
      get.addColumn(FAMILY,QUALIFIER);
      Result r;
      int nbTry=0;
      do {
        assertTrue(nbTry++ < 50);
        Thread.sleep(100);
        r=htable1.get(get);
      }
 while (r == null || r.getValue(FAMILY,QUALIFIER) == null || Bytes.compareTo(VALUE2,r.getValue(FAMILY,QUALIFIER)) != 0);
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMetaWithReplicas </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testZookeeperNodesForReplicas() throws Exception {
  ZooKeeperWatcher zkw=TEST_UTIL.getZooKeeperWatcher();
  Configuration conf=TEST_UTIL.getConfiguration();
  String baseZNode=conf.get(HConstants.ZOOKEEPER_ZNODE_PARENT,HConstants.DEFAULT_ZOOKEEPER_ZNODE_PARENT);
  String primaryMetaZnode=ZKUtil.joinZNode(baseZNode,conf.get("zookeeper.znode.metaserver","meta-region-server"));
  byte[] data=ZKUtil.getData(zkw,primaryMetaZnode);
  ServerName.parseFrom(data);
  for (int i=1; i < 3; i++) {
    String secZnode=ZKUtil.joinZNode(baseZNode,conf.get("zookeeper.znode.metaserver","meta-region-server") + "-" + i);
    String str=zkw.getZNodeForReplica(i);
    assertTrue(str.equals(secZnode));
    data=ZKUtil.getData(zkw,secZnode);
    ServerName.parseFrom(data);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMultiParallel </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testBatchWithGet() throws Exception {
  LOG.info("test=testBatchWithGet");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  table.batch(puts,null);
  List<Row> gets=new ArrayList<Row>();
  for (  byte[] k : KEYS) {
    Get get=new Get(k);
    get.addColumn(BYTES_FAMILY,QUALIFIER);
    gets.add(get);
  }
  Result[] multiRes=new Result[gets.size()];
  table.batch(gets,multiRes);
  List<Result> singleRes=new ArrayList<Result>();
  for (  Row get : gets) {
    singleRes.add(table.get((Get)get));
  }
  Assert.assertEquals(singleRes.size(),multiRes.length);
  for (int i=0; i < singleRes.size(); i++) {
    Assert.assertTrue(singleRes.get(i).containsColumn(BYTES_FAMILY,QUALIFIER));
    Cell[] singleKvs=singleRes.get(i).rawCells();
    Cell[] multiKvs=multiRes[i].rawCells();
    for (int j=0; j < singleKvs.length; j++) {
      Assert.assertEquals(singleKvs[j],multiKvs[j]);
      Assert.assertEquals(0,Bytes.compareTo(CellUtil.cloneValue(singleKvs[j]),CellUtil.cloneValue(multiKvs[j])));
    }
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestPutDeleteEtcCellIteration </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementIteration() throws IOException {
  Increment increment=new Increment(ROW);
  for (int i=0; i < COUNT; i++) {
    byte[] bytes=Bytes.toBytes(i);
    increment.addColumn(bytes,bytes,i);
  }
  int index=0;
  for (CellScanner cellScanner=increment.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    int value=index;
    byte[] bytes=Bytes.toBytes(index++);
    KeyValue kv=(KeyValue)cell;
    assertTrue(Bytes.equals(CellUtil.cloneFamily(kv),bytes));
    long a=Bytes.toLong(CellUtil.cloneValue(kv));
    assertEquals(value,a);
  }
  assertEquals(COUNT,index);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendIteration() throws IOException {
  Append a=new Append(ROW);
  for (int i=0; i < COUNT; i++) {
    byte[] bytes=Bytes.toBytes(i);
    a.add(bytes,bytes,bytes);
  }
  int index=0;
  for (CellScanner cellScanner=a.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    byte[] bytes=Bytes.toBytes(index++);
    KeyValue kv=(KeyValue)cell;
    assertTrue(Bytes.equals(CellUtil.cloneFamily(kv),bytes));
    assertTrue(Bytes.equals(CellUtil.cloneValue(kv),bytes));
  }
  assertEquals(COUNT,index);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestReplicaWithCluster </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=30000) public void testBulkLoad() throws IOException {
  LOG.debug("Creating test table");
  HTableDescriptor hdt=HTU.createTableDescriptor("testBulkLoad");
  hdt.setRegionReplication(NB_SERVERS);
  hdt.addCoprocessor(SlowMeCopro.class.getName());
  Table table=HTU.createTable(hdt,new byte[][]{f},null);
  LOG.debug("Creating test data");
  Path dir=HTU.getDataTestDirOnTestFS("testBulkLoad");
  final int numRows=10;
  final byte[] qual=Bytes.toBytes("qual");
  final byte[] val=Bytes.toBytes("val");
  final List<Pair<byte[],String>> famPaths=new ArrayList<Pair<byte[],String>>();
  for (  HColumnDescriptor col : hdt.getColumnFamilies()) {
    Path hfile=new Path(dir,col.getNameAsString());
    TestHRegionServerBulkLoad.createHFile(HTU.getTestFileSystem(),hfile,col.getName(),qual,val,numRows);
    famPaths.add(new Pair<byte[],String>(col.getName(),hfile.toString()));
  }
  LOG.debug("Loading test data");
  @SuppressWarnings("deprecation") final HConnection conn=HTU.getHBaseAdmin().getConnection();
  RegionServerCallable<Void> callable=new RegionServerCallable<Void>(conn,hdt.getTableName(),TestHRegionServerBulkLoad.rowkey(0)){
    @Override public Void call(    int timeout) throws Exception {
      LOG.debug("Going to connect to server " + getLocation() + " for row "+ Bytes.toStringBinary(getRow()));
      byte[] regionName=getLocation().getRegionInfo().getRegionName();
      BulkLoadHFileRequest request=RequestConverter.buildBulkLoadHFileRequest(famPaths,regionName,true);
      getStub().bulkLoadHFile(null,request);
      return null;
    }
  }
;
  RpcRetryingCallerFactory factory=new RpcRetryingCallerFactory(HTU.getConfiguration());
  RpcRetryingCaller<Void> caller=factory.<Void>newCaller();
  caller.callWithRetries(callable,10000);
  LOG.debug("Verifying data load");
  for (int i=0; i < numRows; i++) {
    byte[] row=TestHRegionServerBulkLoad.rowkey(i);
    Get g=new Get(row);
    Result r=table.get(g);
    Assert.assertFalse(r.isStale());
  }
  LOG.debug("Verifying replica queries");
  try {
    SlowMeCopro.cdl.set(new CountDownLatch(1));
    for (int i=0; i < numRows; i++) {
      byte[] row=TestHRegionServerBulkLoad.rowkey(i);
      Get g=new Get(row);
      g.setConsistency(Consistency.TIMELINE);
      Result r=table.get(g);
      Assert.assertTrue(r.isStale());
    }
    SlowMeCopro.cdl.get().countDown();
  }
  finally {
    SlowMeCopro.cdl.get().countDown();
    SlowMeCopro.sleepTime.set(0);
  }
  HTU.getHBaseAdmin().disableTable(hdt.getTableName());
  HTU.deleteTable(hdt.getTableName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestScannersFromClientSide </h4><pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Test from client side for scan while the region is reopened
 * on the same region server.
 * @throws Exception
 */
@Test public void testScanOnReopenedRegion() throws Exception {
  TableName TABLE=TableName.valueOf("testScanOnReopenedRegion");
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,2);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  Put put;
  Scan scan;
  Result result;
  ResultScanner scanner;
  boolean toLog=false;
  List<Cell> kvListExp;
  put=new Put(ROW);
  for (int i=0; i < QUALIFIERS.length; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILY,QUALIFIERS[i],i,VALUE);
    put.add(kv);
  }
  ht.put(put);
  scan=new Scan(ROW);
  scanner=ht.getScanner(scan);
  HRegionLocation loc;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(TABLE)){
    loc=locator.getRegionLocation(ROW);
  }
   HRegionInfo hri=loc.getRegionInfo();
  MiniHBaseCluster cluster=TEST_UTIL.getMiniHBaseCluster();
  byte[] regionName=hri.getRegionName();
  int i=cluster.getServerWith(regionName);
  HRegionServer rs=cluster.getRegionServer(i);
  ProtobufUtil.closeRegion(rs.getRSRpcServices(),rs.getServerName(),regionName);
  long startTime=EnvironmentEdgeManager.currentTime();
  long timeOut=300000;
  while (true) {
    if (rs.getOnlineRegion(regionName) == null) {
      break;
    }
    assertTrue("Timed out in closing the testing region",EnvironmentEdgeManager.currentTime() < startTime + timeOut);
    Thread.sleep(500);
  }
  HMaster master=cluster.getMaster();
  RegionStates states=master.getAssignmentManager().getRegionStates();
  states.regionOffline(hri);
  states.updateRegionState(hri,State.OPENING);
  ProtobufUtil.openRegion(rs.getRSRpcServices(),rs.getServerName(),hri);
  startTime=EnvironmentEdgeManager.currentTime();
  while (true) {
    if (rs.getOnlineRegion(regionName) != null) {
      break;
    }
    assertTrue("Timed out in open the testing region",EnvironmentEdgeManager.currentTime() < startTime + timeOut);
    Thread.sleep(500);
  }
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[0],0,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[1],1,VALUE));
  result=scanner.next();
  verifyResult(result,kvListExp,toLog,"Testing scan on re-opened region");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestTimestampsFilter </h4><pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test from client side for TimestampsFilter.
 * The TimestampsFilter provides the ability to request cells (KeyValues)
 * whose timestamp/version is in the specified list of timestamps/version.
 * @throws Exception
 */
@Test public void testTimestampsFilter() throws Exception {
  byte[] TABLE=Bytes.toBytes("testTimestampsFilter");
  byte[] FAMILY=Bytes.toBytes("event_log");
  byte[][] FAMILIES=new byte[][]{FAMILY};
  Cell kvs[];
  Table ht=TEST_UTIL.createTable(TableName.valueOf(TABLE),FAMILIES,Integer.MAX_VALUE);
  for (int rowIdx=0; rowIdx < 5; rowIdx++) {
    for (int colIdx=0; colIdx < 5; colIdx++) {
      putNVersions(ht,FAMILY,rowIdx,colIdx,201,300);
      putNVersions(ht,FAMILY,rowIdx,colIdx,1,100);
    }
  }
  verifyInsertedValues(ht,FAMILY);
  TEST_UTIL.flush();
  verifyInsertedValues(ht,FAMILY);
  for (int rowIdx=0; rowIdx < 5; rowIdx++) {
    for (int colIdx=0; colIdx < 5; colIdx++) {
      putNVersions(ht,FAMILY,rowIdx,colIdx,301,400);
      putNVersions(ht,FAMILY,rowIdx,colIdx,101,200);
    }
  }
  for (int rowIdx=0; rowIdx < 5; rowIdx++) {
    for (int colIdx=0; colIdx < 5; colIdx++) {
      kvs=getNVersions(ht,FAMILY,rowIdx,colIdx,Arrays.asList(505L,5L,105L,305L,205L));
      assertEquals(4,kvs.length);
      checkOneCell(kvs[0],FAMILY,rowIdx,colIdx,305);
      checkOneCell(kvs[1],FAMILY,rowIdx,colIdx,205);
      checkOneCell(kvs[2],FAMILY,rowIdx,colIdx,105);
      checkOneCell(kvs[3],FAMILY,rowIdx,colIdx,5);
    }
  }
  kvs=getNVersions(ht,FAMILY,2,2,new ArrayList<Long>());
  assertEquals(0,kvs == null ? 0 : kvs.length);
  Result[] results=scanNVersions(ht,FAMILY,0,4,Arrays.asList(6L,106L,306L));
  assertEquals("# of rows returned from scan",5,results.length);
  for (int rowIdx=0; rowIdx < 5; rowIdx++) {
    kvs=results[rowIdx].rawCells();
    assertEquals("Number of KeyValues in result for row:" + rowIdx,3 * 5,kvs.length);
    for (int colIdx=0; colIdx < 5; colIdx++) {
      int offset=colIdx * 3;
      checkOneCell(kvs[offset + 0],FAMILY,rowIdx,colIdx,306);
      checkOneCell(kvs[offset + 1],FAMILY,rowIdx,colIdx,106);
      checkOneCell(kvs[offset + 2],FAMILY,rowIdx,colIdx,6);
    }
  }
  ht.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.column.TestColumnBuilder </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * methods 
 */
@Test public void testReaderRoundTrip() throws IOException {
  for (int i=0; i < sortedUniqueColumns.size(); ++i) {
    ByteRange column=sortedUniqueColumns.get(i);
    builder.addSorted(column);
  }
  List<byte[]> builderOutputArrays=builder.getArrays();
  for (int i=0; i < builderOutputArrays.size(); ++i) {
    byte[] inputArray=sortedUniqueColumns.get(i).deepCopyToNewArray();
    byte[] outputArray=builderOutputArrays.get(i);
    boolean same=Bytes.equals(inputArray,outputArray);
    Assert.assertTrue(same);
  }
  Assert.assertEquals(sortedUniqueColumns.size(),builderOutputArrays.size());
  writer=new ColumnSectionWriter(blockMeta,builder,ColumnNodeType.QUALIFIER);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  writer.compile().writeBytes(baos);
  bytes=baos.toByteArray();
  buffer=new byte[blockMeta.getMaxQualifierLength()];
  reader=new ColumnReader(buffer,ColumnNodeType.QUALIFIER);
  reader.initOnBlock(blockMeta,new SingleByteBuff(ByteBuffer.wrap(bytes)));
  List<TokenizerNode> builderNodes=Lists.newArrayList();
  builder.appendNodes(builderNodes,true,true);
  int i=0;
  for (  TokenizerNode builderNode : builderNodes) {
    if (!builderNode.hasOccurrences()) {
      continue;
    }
    Assert.assertEquals(1,builderNode.getNumOccurrences());
    int position=builderNode.getOutputArrayOffset();
    byte[] output=reader.populateBuffer(position).copyBufferToNewArray();
    boolean same=Bytes.equals(sortedUniqueColumns.get(i).deepCopyToNewArray(),output);
    Assert.assertTrue(same);
    ++i;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.row.TestPrefixTreeSearcher </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSeekMisses() throws IOException {
  CellSearcher searcher=null;
  List<Integer> rowStartIndexes=rows.getRowStartIndexes();
  try {
    searcher=DecoderFactory.checkOut(block,true);
    for (    boolean beforeVsAfterOnMiss : new boolean[]{true,false}) {
      for (int i=0; i < rows.getInputs().size(); ++i) {
        KeyValue kv=rows.getInputs().get(i);
        Cell inputNextRow=CellUtil.createFirstOnNextRow(kv);
        CellScannerPosition position=beforeVsAfterOnMiss ? searcher.positionAtOrBefore(inputNextRow) : searcher.positionAtOrAfter(inputNextRow);
        boolean isFirstInRow=rowStartIndexes.contains(i);
        if (isFirstInRow) {
          int rowIndex=rowStartIndexes.indexOf(i);
          if (rowIndex < rowStartIndexes.size() - 1) {
            if (beforeVsAfterOnMiss) {
              Assert.assertEquals(CellScannerPosition.BEFORE,position);
            }
 else {
              Assert.assertEquals(CellScannerPosition.AFTER,position);
            }
            int expectedInputIndex=beforeVsAfterOnMiss ? rowStartIndexes.get(rowIndex + 1) - 1 : rowStartIndexes.get(rowIndex + 1);
            Assert.assertEquals(rows.getInputs().get(expectedInputIndex),searcher.current());
          }
        }
        KeyValue inputPreviousKv=KeyValueUtil.previousKey(kv);
        boolean hit=searcher.positionAt(inputPreviousKv);
        Assert.assertFalse(hit);
        position=searcher.positionAtOrAfter(inputPreviousKv);
        if (CollectionUtils.isLastIndex(rows.getInputs(),i)) {
          Assert.assertTrue(CellScannerPosition.AFTER_LAST == position);
        }
 else {
          Assert.assertTrue(CellScannerPosition.AFTER == position);
          Assert.assertEquals(rows.getInputs().get(i + 1),searcher.current());
        }
      }
    }
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScanBackwards() throws IOException {
  CellSearcher searcher=null;
  try {
    searcher=DecoderFactory.checkOut(block,true);
    searcher.positionAfterLastCell();
    int i=-1;
    while (searcher.previous()) {
      ++i;
      int oppositeIndex=rows.getInputs().size() - i - 1;
      KeyValue inputKv=rows.getInputs().get(oppositeIndex);
      KeyValue outputKv=KeyValueUtil.copyToNewKeyValue(searcher.current());
      Assert.assertEquals(inputKv,outputKv);
    }
    Assert.assertEquals(rows.getInputs().size(),i + 1);
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanForwards() throws IOException {
  CellSearcher searcher=null;
  try {
    searcher=DecoderFactory.checkOut(block,true);
    int i=-1;
    while (searcher.advance()) {
      ++i;
      KeyValue inputCell=rows.getInputs().get(i);
      Cell outputCell=searcher.current();
      Assert.assertEquals(inputCell,outputCell);
      Assert.assertEquals(outputCell,inputCell);
      Assert.assertTrue(CellUtil.equals(inputCell,outputCell));
    }
    Assert.assertEquals(rows.getInputs().size(),i + 1);
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.timestamp.TestTimestampEncoder </h4><pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReaderRoundTrip(){
  for (int i=0; i < timestamps.getOutputs().size(); ++i) {
    long input=timestamps.getOutputs().get(i);
    long output=decoder.getLong(i);
    Assert.assertEquals(input,output);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompressorRoundTrip(){
  long[] outputs=encoder.getSortedUniqueTimestamps();
  for (int i=0; i < timestamps.getOutputs().size(); ++i) {
    long input=timestamps.getOutputs().get(i);
    long output=outputs[i];
    Assert.assertEquals(input,output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestCoprocessorInterface </h4><pre class="type-4 type-9 type-11 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSharedData() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  byte[][] families={fam1,fam2,fam3};
  Configuration hc=initSplit();
  Region region=initHRegion(tableName,name.getMethodName(),hc,new Class<?>[]{},families);
  for (int i=0; i < 3; i++) {
    HBaseTestCase.addContent(region,fam3);
    region.flush(true);
  }
  region.compact(false);
  byte[] splitRow=((HRegion)region).checkSplit();
  assertNotNull(splitRow);
  Region[] regions=split(region,splitRow);
  for (int i=0; i < regions.length; i++) {
    regions[i]=reopenRegion(regions[i],CoprocessorImpl.class,CoprocessorII.class);
  }
  Coprocessor c=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  Coprocessor c2=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
  Object o=((CoprocessorImpl)c).getSharedData().get("test1");
  Object o2=((CoprocessorII)c2).getSharedData().get("test2");
  assertNotNull(o);
  assertNotNull(o2);
  assertFalse(((CoprocessorImpl)c).getSharedData() == ((CoprocessorII)c2).getSharedData());
  for (int i=1; i < regions.length; i++) {
    c=regions[i].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
    c2=regions[i].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
    assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
    assertTrue(((CoprocessorII)c2).getSharedData().get("test2") == o2);
  }
  for (int i=0; i < regions.length; i++) {
    try {
      byte[] r=regions[i].getRegionInfo().getStartKey();
      if (r == null || r.length <= 0) {
        r=new byte[]{0};
      }
      Get g=new Get(r);
      regions[i].get(g);
      fail();
    }
 catch (    org.apache.hadoop.hbase.DoNotRetryIOException xc) {
    }
    assertNull(regions[i].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName()));
  }
  c=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
  c=c2=null;
  System.gc();
  region=reopenRegion(regions[0],CoprocessorImpl.class,CoprocessorII.class);
  c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
  c2=region.getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
  Object o3=((CoprocessorII)c2).getSharedData().get("test2");
  assertFalse(o3 == o2);
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoprocessorInterface() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  byte[][] families={fam1,fam2,fam3};
  Configuration hc=initSplit();
  Region region=initHRegion(tableName,name.getMethodName(),hc,new Class<?>[]{CoprocessorImpl.class},families);
  for (int i=0; i < 3; i++) {
    HBaseTestCase.addContent(region,fam3);
    region.flush(true);
  }
  region.compact(false);
  byte[] splitRow=((HRegion)region).checkSplit();
  assertNotNull(splitRow);
  Region[] regions=split(region,splitRow);
  for (int i=0; i < regions.length; i++) {
    regions[i]=reopenRegion(regions[i],CoprocessorImpl.class);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
  Coprocessor c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  Scan s=new Scan();
  RegionScanner scanner=regions[0].getCoprocessorHost().postScannerOpen(s,regions[0].getScanner(s));
  assertTrue(scanner instanceof CustomScanner);
  scanner.next(new ArrayList<Cell>());
  assertTrue("Coprocessor not started",((CoprocessorImpl)c).wasStarted());
  assertTrue("Coprocessor not stopped",((CoprocessorImpl)c).wasStopped());
  assertTrue(((CoprocessorImpl)c).wasOpened());
  assertTrue(((CoprocessorImpl)c).wasClosed());
  assertTrue(((CoprocessorImpl)c).wasFlushed());
  assertTrue(((CoprocessorImpl)c).wasCompacted());
  assertTrue(((CoprocessorImpl)c).wasSplit());
  for (int i=0; i < regions.length; i++) {
    HBaseTestingUtility.closeRegionAndWAL(regions[i]);
    c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
    assertTrue("Coprocessor not started",((CoprocessorImpl)c).wasStarted());
    assertTrue("Coprocessor not stopped",((CoprocessorImpl)c).wasStopped());
    assertTrue(((CoprocessorImpl)c).wasOpened());
    assertTrue(((CoprocessorImpl)c).wasClosed());
    assertTrue(((CoprocessorImpl)c).wasCompacted());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithAbort </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testExceptionFromCoprocessorWhenCreatingTable() throws IOException {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  BuggyMasterObserver cp=(BuggyMasterObserver)host.findCoprocessor(BuggyMasterObserver.class.getName());
  assertFalse("No table created yet",cp.wasCreateTableCalled());
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(UTIL.getConfiguration(),"unittest",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal ZK error: " + why,e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  MasterTracker masterTracker=new MasterTracker(zkw,"/hbase/master",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal ZK master tracker error, why=",e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  masterTracker.start();
  zkw.registerListener(masterTracker);
  assertTrue(HMaster.getLoadedCoprocessors().contains(TestMasterCoprocessorExceptionWithAbort.BuggyMasterObserver.class.getName()));
  CreateTableThread createTableThread=new CreateTableThread(UTIL);
  createTableThread.start();
  for (int i=0; i < 30; i++) {
    if (masterTracker.masterZKNodeWasDeleted == true) {
      break;
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      fail("InterruptedException while waiting for master zk node to " + "be deleted.");
    }
  }
  assertTrue("Master aborted on coprocessor exception, as expected.",masterTracker.masterZKNodeWasDeleted);
  createTableThread.interrupt();
  try {
    createTableThread.join(1000);
  }
 catch (  InterruptedException e) {
    assertTrue("Ignoring InterruptedException while waiting for " + " createTableThread.join().",true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionObserverInterface </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests overriding compaction handling via coprocessor hooks
 * @throws Exception
 */
@Test(timeout=300000) public void testCompactionOverride() throws Exception {
  TableName compactTable=TableName.valueOf("TestCompactionOverride");
  Admin admin=util.getHBaseAdmin();
  if (admin.tableExists(compactTable)) {
    admin.disableTable(compactTable);
    admin.deleteTable(compactTable);
  }
  HTableDescriptor htd=new HTableDescriptor(compactTable);
  htd.addFamily(new HColumnDescriptor(A));
  htd.addCoprocessor(EvenOnlyCompactor.class.getName());
  admin.createTable(htd);
  Table table=util.getConnection().getTable(compactTable);
  for (long i=1; i <= 10; i++) {
    byte[] iBytes=Bytes.toBytes(i);
    Put put=new Put(iBytes);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(A,A,iBytes);
    table.put(put);
  }
  HRegion firstRegion=cluster.getRegions(compactTable).get(0);
  Coprocessor cp=firstRegion.getCoprocessorHost().findCoprocessor(EvenOnlyCompactor.class.getName());
  assertNotNull("EvenOnlyCompactor coprocessor should be loaded",cp);
  EvenOnlyCompactor compactor=(EvenOnlyCompactor)cp;
  long ts=System.currentTimeMillis();
  admin.flush(compactTable);
  for (int i=0; i < 10; i++) {
    if (compactor.lastFlush >= ts) {
      break;
    }
    Thread.sleep(1000);
  }
  assertTrue("Flush didn't complete",compactor.lastFlush >= ts);
  LOG.debug("Flush complete");
  ts=compactor.lastFlush;
  admin.majorCompact(compactTable);
  for (int i=0; i < 30; i++) {
    if (compactor.lastCompaction >= ts) {
      break;
    }
    Thread.sleep(1000);
  }
  LOG.debug("Last compaction was at " + compactor.lastCompaction);
  assertTrue("Compaction didn't complete",compactor.lastCompaction >= ts);
  ResultScanner scanner=table.getScanner(new Scan());
  try {
    for (long i=2; i <= 10; i+=2) {
      Result r=scanner.next();
      assertNotNull(r);
      assertFalse(r.isEmpty());
      byte[] iBytes=Bytes.toBytes(i);
      assertArrayEquals("Row should be " + i,r.getRow(),iBytes);
      assertArrayEquals("Value should be " + i,r.getValue(A,A),iBytes);
    }
  }
  finally {
    scanner.close();
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testExceptionFromCoprocessorDuringPut() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,2);
  conf.set(CoprocessorHost.REGION_COPROCESSOR_CONF_KEY,BuggyRegionObserver.class.getName());
  conf.setBoolean(CoprocessorHost.ABORT_ON_ERROR_KEY,true);
  TEST_UTIL.startMiniCluster(2);
  try {
    final byte[] TEST_FAMILY=Bytes.toBytes("aaa");
    Table table=TEST_UTIL.createMultiRegionTable(TABLE_NAME,TEST_FAMILY);
    TEST_UTIL.waitUntilAllRegionsAssigned(TABLE_NAME);
    final HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TABLE_NAME);
    try {
      final byte[] ROW=Bytes.toBytes("aaa");
      Put put=new Put(ROW);
      put.addColumn(TEST_FAMILY,ROW,ROW);
      table.put(put);
    }
 catch (    IOException e) {
    }
    boolean aborted=false;
    for (int i=0; i < 10; i++) {
      aborted=regionServer.isAborted();
      if (aborted) {
        break;
      }
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
        fail("InterruptedException while waiting for regionserver " + "zk node to be deleted.");
      }
    }
    Assert.assertTrue("The region server should have aborted",aborted);
    table.close();
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithRemove </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testExceptionFromCoprocessorDuringPut() throws IOException, InterruptedException {
  TableName TEST_TABLE=TableName.valueOf("observed_table");
  byte[] TEST_FAMILY=Bytes.toBytes("aaa");
  Table table=TEST_UTIL.createMultiRegionTable(TEST_TABLE,TEST_FAMILY);
  TEST_UTIL.waitUntilAllRegionsAssigned(TEST_TABLE);
  HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TEST_TABLE);
  boolean threwIOE=false;
  try {
    final byte[] ROW=Bytes.toBytes("aaa");
    Put put=new Put(ROW);
    put.addColumn(TEST_FAMILY,ROW,ROW);
    table.put(put);
    table.put(put);
  }
 catch (  IOException e) {
    threwIOE=true;
  }
 finally {
    assertTrue("The regionserver should have thrown an exception",threwIOE);
  }
  for (int i=0; i < 10; i++) {
    assertFalse(regionServer.isAborted());
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      fail("InterruptedException while waiting for regionserver " + "zk node to be deleted.");
    }
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilter </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterListWithPrefixFilter() throws IOException {
  byte[] family=Bytes.toBytes("f1");
  byte[] qualifier=Bytes.toBytes("q1");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("TestFilter"));
  htd.addFamily(new HColumnDescriptor(family));
  HRegionInfo info=new HRegionInfo(htd.getTableName(),null,null,false);
  Region testRegion=HBaseTestingUtility.createRegionAndWAL(info,TEST_UTIL.getDataTestDir(),TEST_UTIL.getConfiguration(),htd);
  for (int i=0; i < 5; i++) {
    Put p=new Put(Bytes.toBytes((char)('a' + i) + "row"));
    p.setDurability(Durability.SKIP_WAL);
    p.addColumn(family,qualifier,Bytes.toBytes(String.valueOf(111 + i)));
    testRegion.put(p);
  }
  testRegion.flush(true);
  PrefixFilter pf=new PrefixFilter(new byte[]{'b'});
  SingleColumnValueFilter scvf=new SingleColumnValueFilter(family,qualifier,CompareOp.EQUAL,Bytes.toBytes("113"));
  FilterList filterList=new FilterList(Operator.MUST_PASS_ONE,pf,scvf);
  Scan s1=new Scan();
  s1.setFilter(filterList);
  InternalScanner scanner=testRegion.getScanner(s1);
  List<Cell> results=new ArrayList<Cell>();
  int resultCount=0;
  while (scanner.next(results)) {
    resultCount++;
    byte[] row=CellUtil.cloneRow(results.get(0));
    LOG.debug("Found row: " + Bytes.toStringBinary(row));
    assertTrue(Bytes.equals(row,Bytes.toBytes("brow")) || Bytes.equals(row,Bytes.toBytes("crow")));
    results.clear();
  }
  assertEquals(2,resultCount);
  scanner.close();
  WAL wal=((HRegion)testRegion).getWAL();
  ((HRegion)testRegion).close();
  wal.close();
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Tests the the {@link WhileMatchFilter} works in combination with a{@link Filter} that uses the {@link Filter#filterKeyValue(Cell)} method.
 * See HBASE-2258.
 * @throws Exception
 */
@Test public void testWhileMatchFilterWithFilterKeyValue() throws Exception {
  Scan s=new Scan();
  WhileMatchFilter filter=new WhileMatchFilter(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,Bytes.toBytes("foo")));
  s.setFilter(filter);
  InternalScanner scanner=this.region.getScanner(s);
  while (true) {
    ArrayList<Cell> values=new ArrayList<Cell>();
    boolean isMoreResults=scanner.next(values);
    assertTrue("The WhileMatchFilter should now filter all remaining",filter.filterAllRemaining());
    if (!isMoreResults) {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the the {@link WhileMatchFilter} works in combination with a{@link Filter} that uses the{@link Filter#filterRow()} method.
 * See HBASE-2258.
 * @throws Exception
 */
@Test public void testWhileMatchFilterWithFilterRow() throws Exception {
  final int pageSize=4;
  Scan s=new Scan();
  WhileMatchFilter filter=new WhileMatchFilter(new PageFilter(pageSize));
  s.setFilter(filter);
  InternalScanner scanner=this.region.getScanner(s);
  int scannerCounter=0;
  while (true) {
    boolean isMoreResults=scanner.next(new ArrayList<Cell>());
    scannerCounter++;
    if (scannerCounter >= pageSize) {
      assertTrue("The WhileMatchFilter should now filter all remaining",filter.filterAllRemaining());
    }
    if (!isMoreResults) {
      break;
    }
  }
  assertEquals("The page filter returned more rows than expected",pageSize,scannerCounter);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * Tests the the {@link WhileMatchFilter} works in combination with a{@link Filter} that uses the{@link Filter#filterRowKey(Cell)} method.
 * See HBASE-2258.
 * @throws Exception
 */
@Test public void testWhileMatchFilterWithFilterRowKey() throws Exception {
  Scan s=new Scan();
  String prefix="testRowOne";
  WhileMatchFilter filter=new WhileMatchFilter(new PrefixFilter(Bytes.toBytes(prefix)));
  s.setFilter(filter);
  InternalScanner scanner=this.region.getScanner(s);
  while (true) {
    ArrayList<Cell> values=new ArrayList<Cell>();
    boolean isMoreResults=scanner.next(values);
    if (!isMoreResults || !Bytes.toString(CellUtil.cloneRow(values.get(0))).startsWith(prefix)) {
      assertTrue("The WhileMatchFilter should now filter all remaining",filter.filterAllRemaining());
    }
    if (!isMoreResults) {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestLongComparator </h4><pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimple(){
  for (int i=1; i < values.length; i++) {
    for (int j=0; j < i; j++) {
      LongComparator cp=new LongComparator(values[i]);
      assertEquals(1,cp.compareTo(Bytes.toBytes(values[j])));
      ByteBuffer data_bb=ByteBuffer.wrap(Bytes.toBytes(values[j]));
      assertEquals(1,cp.compareTo(data_bb,0,data_bb.capacity()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.fs.TestBlockReorder </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the hook works within HBase, including when there are multiple blocks.
 */
@Test() public void testHBaseCluster() throws Exception {
  byte[] sb="sb".getBytes();
  htu.startMiniZKCluster();
  MiniHBaseCluster hbm=htu.startMiniHBaseCluster(1,1);
  hbm.waitForActiveAndReadyMaster();
  HRegionServer targetRs=hbm.getMaster();
  String host4=targetRs.getServerName().getHostname();
  LOG.info("Starting a new datanode with the name=" + host4);
  cluster.startDataNodes(conf,1,true,null,new String[]{"/r4"},new String[]{host4},null);
  cluster.waitClusterUp();
  final int repCount=3;
  conf=targetRs.getConfiguration();
  HFileSystem rfs=(HFileSystem)targetRs.getFileSystem();
  Table h=htu.createTable(TableName.valueOf("table"),sb);
  String rootDir=new Path(FSUtils.getRootDir(conf) + "/" + HConstants.HREGION_LOGDIR_NAME+ "/"+ targetRs.getServerName().toString()).toUri().getPath();
  DistributedFileSystem mdfs=(DistributedFileSystem)hbm.getMaster().getMasterFileSystem().getFileSystem();
  int nbTest=0;
  while (nbTest < 10) {
    final List<Region> regions=targetRs.getOnlineRegions(h.getName());
    final CountDownLatch latch=new CountDownLatch(regions.size());
    final WALActionsListener listener=new WALActionsListener.Base(){
      @Override public void postLogRoll(      final Path oldPath,      final Path newPath) throws IOException {
        latch.countDown();
      }
    }
;
    for (    Region region : regions) {
      ((HRegion)region).getWAL().registerWALActionsListener(listener);
    }
    htu.getHBaseAdmin().rollWALWriter(targetRs.getServerName());
    try {
      latch.await();
    }
 catch (    InterruptedException exception) {
      LOG.warn("Interrupted while waiting for the wal of '" + targetRs + "' to roll. If later "+ "tests fail, it's probably because we should still be waiting.");
      Thread.currentThread().interrupt();
    }
    for (    Region region : regions) {
      ((HRegion)region).getWAL().unregisterWALActionsListener(listener);
    }
    Thread.sleep(100);
    Put p=new Put(sb);
    p.addColumn(sb,sb,sb);
    h.put(p);
    DirectoryListing dl=dfs.getClient().listPaths(rootDir,HdfsFileStatus.EMPTY_NAME);
    HdfsFileStatus[] hfs=dl.getPartialListing();
    Assert.assertTrue(hfs.length >= 1);
    for (    HdfsFileStatus hf : hfs) {
      try {
        LOG.info("Log file found: " + hf.getLocalName() + " in "+ rootDir);
        String logFile=rootDir + "/" + hf.getLocalName();
        FileStatus fsLog=rfs.getFileStatus(new Path(logFile));
        LOG.info("Checking log file: " + logFile);
        BlockLocation[] bls=rfs.getFileBlockLocations(fsLog,0,1);
        if (bls.length > 0) {
          BlockLocation bl=bls[0];
          LOG.info(bl.getHosts().length + " replicas for block 0 in " + logFile+ " ");
          for (int i=0; i < bl.getHosts().length - 1; i++) {
            LOG.info(bl.getHosts()[i] + "    " + logFile);
            Assert.assertNotSame(bl.getHosts()[i],host4);
          }
          String last=bl.getHosts()[bl.getHosts().length - 1];
          LOG.info(last + "    " + logFile);
          if (host4.equals(last)) {
            nbTest++;
            LOG.info(logFile + " is on the new datanode and is ok");
            if (bl.getHosts().length == 3) {
              testFromDFS(dfs,logFile,repCount,host4);
              testFromDFS(mdfs,logFile,repCount,host4);
            }
          }
        }
      }
 catch (      FileNotFoundException exception) {
        LOG.debug("Failed to find log file '" + hf.getLocalName() + "'; it probably was "+ "archived out from under us so we'll ignore and retry. If this test hangs "+ "indefinitely you should treat this failure as a symptom.",exception);
      }
catch (      RemoteException exception) {
        if (exception.unwrapRemoteException() instanceof FileNotFoundException) {
          LOG.debug("Failed to find log file '" + hf.getLocalName() + "'; it probably was "+ "archived out from under us so we'll ignore and retry. If this test hangs "+ "indefinitely you should treat this failure as a symptom.",exception);
        }
 else {
          throw exception;
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the reorder algo works as we expect.
 */
@Test public void testBlockLocation() throws Exception {
  htu.startMiniZKCluster();
  MiniHBaseCluster hbm=htu.startMiniHBaseCluster(1,1);
  conf=hbm.getConfiguration();
  final String fileName="/helloWorld";
  Path p=new Path(fileName);
  final int repCount=3;
  Assert.assertTrue((short)cluster.getDataNodes().size() >= repCount);
  FSDataOutputStream fop=dfs.create(p,(short)repCount);
  final double toWrite=875.5613;
  fop.writeDouble(toWrite);
  fop.close();
  for (int i=0; i < 10; i++) {
    LocatedBlocks l;
    final long max=System.currentTimeMillis() + 10000;
    do {
      l=getNamenode(dfs.getClient()).getBlockLocations(fileName,0,1);
      Assert.assertNotNull(l.getLocatedBlocks());
      Assert.assertEquals(l.getLocatedBlocks().size(),1);
      Assert.assertTrue("Expecting " + repCount + " , got "+ l.get(0).getLocations().length,System.currentTimeMillis() < max);
    }
 while (l.get(0).getLocations().length != repCount);
    Object originalList[]=l.getLocatedBlocks().toArray();
    HFileSystem.ReorderWALBlocks lrb=new HFileSystem.ReorderWALBlocks();
    lrb.reorderBlocks(conf,l,fileName);
    Assert.assertArrayEquals(originalList,l.getLocatedBlocks().toArray());
    Assert.assertNotNull(conf.get(HConstants.HBASE_DIR));
    Assert.assertFalse(conf.get(HConstants.HBASE_DIR).isEmpty());
    String pseudoLogFile=conf.get(HConstants.HBASE_DIR) + "/" + HConstants.HREGION_LOGDIR_NAME+ "/"+ host1+ ",6977,6576"+ "/mylogfile";
    Assert.assertNotNull("log= " + pseudoLogFile,DefaultWALProvider.getServerNameFromWALDirectoryName(dfs.getConf(),pseudoLogFile));
    lrb.reorderBlocks(conf,l,pseudoLogFile);
    Assert.assertEquals(host1,l.get(0).getLocations()[2].getHostName());
    lrb.reorderBlocks(conf,l,pseudoLogFile);
    Assert.assertEquals(host1,l.get(0).getLocations()[2].getHostName());
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that we're can add a hook, and that this hook works when we try to read the file in HDFS.
 */
@Test public void testBlockLocationReorder() throws Exception {
  Path p=new Path("hello");
  Assert.assertTrue((short)cluster.getDataNodes().size() > 1);
  final int repCount=2;
  FSDataOutputStream fop=dfs.create(p,(short)repCount);
  final double toWrite=875.5613;
  fop.writeDouble(toWrite);
  fop.close();
  long start=System.currentTimeMillis();
  FSDataInputStream fin=dfs.open(p);
  Assert.assertTrue(toWrite == fin.readDouble());
  long end=System.currentTimeMillis();
  LOG.info("readtime= " + (end - start));
  fin.close();
  Assert.assertTrue((end - start) < 30 * 1000);
  FileStatus f=dfs.getFileStatus(p);
  BlockLocation[] lbs;
  do {
    lbs=dfs.getFileBlockLocations(f,0,1);
  }
 while (lbs.length != 1 && lbs[0].getLength() != repCount);
  final String name=lbs[0].getNames()[0];
  Assert.assertTrue(name.indexOf(':') > 0);
  String portS=name.substring(name.indexOf(':') + 1);
  final int port=Integer.parseInt(portS);
  LOG.info("port= " + port);
  int ipcPort=-1;
  boolean ok=false;
  final String lookup=lbs[0].getHosts()[0];
  StringBuilder sb=new StringBuilder();
  for (  DataNode dn : cluster.getDataNodes()) {
    final String dnName=getHostName(dn);
    sb.append(dnName).append(' ');
    if (lookup.equals(dnName)) {
      ok=true;
      LOG.info("killing datanode " + name + " / "+ lookup);
      ipcPort=dn.ipcServer.getListenerAddress().getPort();
      dn.shutdown();
      LOG.info("killed datanode " + name + " / "+ lookup);
      break;
    }
  }
  Assert.assertTrue("didn't find the server to kill, was looking for " + lookup + " found "+ sb,ok);
  LOG.info("ipc port= " + ipcPort);
  Assert.assertTrue(HFileSystem.addLocationsOrderInterceptor(conf,new HFileSystem.ReorderBlocks(){
    @Override public void reorderBlocks(    Configuration c,    LocatedBlocks lbs,    String src){
      for (      LocatedBlock lb : lbs.getLocatedBlocks()) {
        if (lb.getLocations().length > 1) {
          DatanodeInfo[] infos=lb.getLocations();
          if (infos[0].getHostName().equals(lookup)) {
            LOG.info("HFileSystem bad host, inverting");
            DatanodeInfo tmp=infos[0];
            infos[0]=infos[1];
            infos[1]=tmp;
          }
        }
      }
    }
  }
));
  final int retries=10;
  ServerSocket ss=null;
  ServerSocket ssI;
  try {
    ss=new ServerSocket(port);
    ssI=new ServerSocket(ipcPort);
  }
 catch (  BindException be) {
    LOG.warn("Got bind exception trying to set up socket on " + port + " or "+ ipcPort+ ", this means that the datanode has not closed the socket or"+ " someone else took it. It may happen, skipping this test for this time.",be);
    if (ss != null) {
      ss.close();
    }
    return;
  }
  for (int i=0; i < retries; i++) {
    start=System.currentTimeMillis();
    fin=dfs.open(p);
    Assert.assertTrue(toWrite == fin.readDouble());
    fin.close();
    end=System.currentTimeMillis();
    LOG.info("HFileSystem readtime= " + (end - start));
    Assert.assertFalse("We took too much time to read",(end - start) > 60000);
  }
  ss.close();
  ssI.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestGlobalFilter </h4><pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testServletFilter() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,RecordingFilter.Initializer.class.getName());
  HttpServer http=createTestServer(conf);
  http.start();
  final String fsckURL="/fsck";
  final String stacksURL="/stacks";
  final String ajspURL="/a.jsp";
  final String listPathsURL="/listPaths";
  final String dataURL="/data";
  final String streamFile="/streamFile";
  final String rootURL="/";
  final String allURL="/*";
  final String outURL="/static/a.out";
  final String logURL="/logs/a.log";
  final String[] urls={fsckURL,stacksURL,ajspURL,listPathsURL,dataURL,streamFile,rootURL,allURL,outURL,logURL};
  final String prefix="http://" + NetUtils.getHostPortString(http.getConnectorAddress(0));
  try {
    for (int i=0; i < urls.length; i++) {
      access(prefix + urls[i]);
    }
  }
  finally {
    http.stop();
  }
  LOG.info("RECORDS = " + RECORDS);
  for (int i=0; i < urls.length; i++) {
    assertTrue(RECORDS.remove(urls[i]));
  }
  assertTrue(RECORDS.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestPathFilter </h4><pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testPathSpecFilters() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,RecordingFilter.Initializer.class.getName());
  String[] pathSpecs={"/path","/path/*"};
  HttpServer http=createTestServer(conf,pathSpecs);
  http.start();
  final String baseURL="/path";
  final String baseSlashURL="/path/";
  final String addedURL="/path/nodes";
  final String addedSlashURL="/path/nodes/";
  final String longURL="/path/nodes/foo/job";
  final String rootURL="/";
  final String allURL="/*";
  final String[] filteredUrls={baseURL,baseSlashURL,addedURL,addedSlashURL,longURL};
  final String[] notFilteredUrls={rootURL,allURL};
  final String prefix="http://" + NetUtils.getHostPortString(http.getConnectorAddress(0));
  try {
    for (int i=0; i < filteredUrls.length; i++) {
      access(prefix + filteredUrls[i]);
    }
    for (int i=0; i < notFilteredUrls.length; i++) {
      access(prefix + notFilteredUrls[i]);
    }
  }
  finally {
    http.stop();
  }
  LOG.info("RECORDS = " + RECORDS);
  for (int i=0; i < filteredUrls.length; i++) {
    assertTrue(RECORDS.remove(filteredUrls[i]));
  }
  assertTrue(RECORDS.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestServletFilter </h4><pre class="type-9 type-10 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testServletFilter() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,SimpleFilter.Initializer.class.getName());
  HttpServer http=createTestServer(conf);
  http.start();
  final String fsckURL="/fsck";
  final String stacksURL="/stacks";
  final String ajspURL="/a.jsp";
  final String logURL="/logs/a.log";
  final String hadooplogoURL="/static/hadoop-logo.jpg";
  final String[] urls={fsckURL,stacksURL,ajspURL,logURL,hadooplogoURL};
  final Random ran=new Random();
  final int[] sequence=new int[50];
  for (int i=0; i < sequence.length; i++) {
    sequence[i]=ran.nextInt(urls.length);
  }
  final String prefix="http://" + NetUtils.getHostPortString(http.getConnectorAddress(0));
  try {
    for (int i=0; i < sequence.length; i++) {
      access(prefix + urls[sequence[i]]);
      if (sequence[i] == 0) {
        assertEquals(null,uri);
      }
 else {
        assertEquals(urls[sequence[i]],uri);
        uri=null;
      }
    }
  }
  finally {
    http.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.conf.TestConfServlet </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteXml() throws Exception {
  StringWriter sw=new StringWriter();
  ConfServlet.writeResponse(getTestConf(),sw,"xml");
  String xml=sw.toString();
  DocumentBuilderFactory docBuilderFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder builder=docBuilderFactory.newDocumentBuilder();
  Document doc=builder.parse(new InputSource(new StringReader(xml)));
  NodeList nameNodes=doc.getElementsByTagName("name");
  boolean foundSetting=false;
  for (int i=0; i < nameNodes.getLength(); i++) {
    Node nameNode=nameNodes.item(i);
    String key=nameNode.getTextContent();
    System.err.println("xml key: " + key);
    if (TEST_KEY.equals(key)) {
      foundSetting=true;
      Element propertyElem=(Element)nameNode.getParentNode();
      String val=propertyElem.getElementsByTagName("value").item(0).getTextContent();
      assertEquals(TEST_VAL,val);
    }
  }
  assertTrue(foundSetting);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.TestKeyStoreKeyProvider </h4><pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testKeyStoreKeyProviderWithPassword() throws Exception {
  KeyProvider provider=new KeyStoreKeyProvider();
  provider.init("jceks://" + storeFile.toURI().getPath() + "?password="+ PASSWORD);
  Key key=provider.getKey(ALIAS);
  assertNotNull(key);
  byte[] keyBytes=key.getEncoded();
  assertEquals(keyBytes.length,KEY.length);
  for (int i=0; i < KEY.length; i++) {
    assertEquals(keyBytes[i],KEY[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testKeyStoreKeyProviderWithPasswordFile() throws Exception {
  KeyProvider provider=new KeyStoreKeyProvider();
  provider.init("jceks://" + storeFile.toURI().getPath() + "?passwordFile="+ URLEncoder.encode(passwordFile.getAbsolutePath(),"UTF-8"));
  Key key=provider.getKey(ALIAS);
  assertNotNull(key);
  byte[] keyBytes=key.getEncoded();
  assertEquals(keyBytes.length,KEY.length);
  for (int i=0; i < KEY.length; i++) {
    assertEquals(keyBytes[i],KEY[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestBufferedDataBlockEncoder </h4><pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEnsureSpaceForKey(){
  BufferedDataBlockEncoder.SeekerState state=new BufferedDataBlockEncoder.SeekerState(new ObjectIntPair<ByteBuffer>(),false);
  for (int i=1; i <= 65536; ++i) {
    state.keyLength=i;
    state.ensureSpaceForKey();
    state.keyBuffer[state.keyLength - 1]=(byte)((i - 1) % 0xff);
    for (int j=0; j < i - 1; ++j) {
      assertEquals((byte)(j % 0xff),state.keyBuffer[j]);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestDataBlockEncoders </h4><pre class="type-4 type-9 type-10 type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNextOnSample() throws IOException {
  List<KeyValue> sampleKv=generator.generateTestKeyValues(NUMBER_OF_KV,includesTags);
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    if (this.useOffheapData && encoding == DataBlockEncoding.PREFIX_TREE)     continue;
    if (encoding.getEncoder() == null) {
      continue;
    }
    DataBlockEncoder encoder=encoding.getEncoder();
    ByteBuffer encodedBuffer=encodeKeyValues(encoding,sampleKv,getEncodingContext(Compression.Algorithm.NONE,encoding),this.useOffheapData);
    HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTags).withCompression(Compression.Algorithm.NONE).build();
    DataBlockEncoder.EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
    seeker.setCurrentBuffer(new SingleByteBuff(encodedBuffer));
    int i=0;
    do {
      KeyValue expectedKeyValue=sampleKv.get(i);
      Cell cell=seeker.getCell();
      if (CellComparator.COMPARATOR.compareKeyIgnoresMvcc(expectedKeyValue,cell) != 0) {
        int commonPrefix=CellUtil.findCommonPrefixInFlatKey(expectedKeyValue,cell,false,true);
        fail(String.format("next() produces wrong results " + "encoder: %s i: %d commonPrefix: %d" + "\n expected %s\n actual      %s",encoder.toString(),i,commonPrefix,Bytes.toStringBinary(expectedKeyValue.getBuffer(),expectedKeyValue.getKeyOffset(),expectedKeyValue.getKeyLength()),CellUtil.toString(cell,false)));
      }
      i++;
    }
 while (seeker.next());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestPrefixTree </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHBASE11728() throws Exception {
  Put put=new Put(Bytes.toBytes("a-b-0-0"));
  put.addColumn(fam,qual1,Bytes.toBytes("c1-value"));
  region.put(put);
  put=new Put(row1_bytes);
  put.addColumn(fam,qual1,Bytes.toBytes("c1-value"));
  region.put(put);
  put=new Put(row2_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value"));
  region.put(put);
  put=new Put(row3_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value-2"));
  region.put(put);
  put=new Put(row4_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value-3"));
  region.put(put);
  region.flush(true);
  String[] rows=new String[3];
  rows[0]=row1;
  rows[1]=row2;
  rows[2]=row3;
  byte[][] val=new byte[3][];
  val[0]=Bytes.toBytes("c1-value");
  val[1]=Bytes.toBytes("c2-value");
  val[2]=Bytes.toBytes("c2-value-2");
  Scan scan=new Scan();
  scan.setStartRow(row1_bytes);
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  RegionScanner scanner=region.getScanner(scan);
  List<Cell> cells=new ArrayList<Cell>();
  for (int i=0; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
      assertEquals(Bytes.toString(val[i]),Bytes.toString(cellScanner.current().getValueArray(),cellScanner.current().getValueOffset(),cellScanner.current().getValueLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(row1_bytes);
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  for (int i=1; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(Bytes.toBytes("a-b-A-1-"));
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  for (int i=1; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(Bytes.toBytes("a-b-A-1-140239"));
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  assertFalse(scanner.next(cells));
  assertFalse(cells.isEmpty());
  scanner.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestPrefixTreeEncoding </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithRandomData() throws Exception {
  PrefixTreeCodec encoder=new PrefixTreeCodec();
  ByteArrayOutputStream baosInMemory=new ByteArrayOutputStream();
  DataOutputStream userDataStream=new DataOutputStream(baosInMemory);
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(false).withIncludesTags(includesTag).withCompression(Algorithm.NONE).build();
  HFileBlockEncodingContext blkEncodingCtx=new HFileBlockDefaultEncodingContext(DataBlockEncoding.PREFIX_TREE,new byte[0],meta);
  generateRandomTestData(kvset,numBatchesWritten++,includesTag,encoder,blkEncodingCtx,userDataStream);
  EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  byte[] onDiskBytes=baosInMemory.toByteArray();
  ByteBuffer readBuffer=ByteBuffer.wrap(onDiskBytes,DataBlockEncoding.ID_SIZE,onDiskBytes.length - DataBlockEncoding.ID_SIZE);
  seeker.setCurrentBuffer(new SingleByteBuff(readBuffer));
  Cell previousKV=null;
  do {
    Cell currentKV=seeker.getCell();
    System.out.println(currentKV);
    if (previousKV != null && CellComparator.COMPARATOR.compare(currentKV,previousKV) < 0) {
      dumpInputKVSet();
      fail("Current kv " + currentKV + " is smaller than previous keyvalue "+ previousKV);
    }
    if (!includesTag) {
      assertFalse(currentKV.getTagsLength() > 0);
    }
 else {
      Assert.assertTrue(currentKV.getTagsLength() > 0);
    }
    previousKV=currentKV;
  }
 while (seeker.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestChecksum </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test all checksum types by writing and reading back blocks.
 */
@Test public void testAllChecksumTypes() throws IOException {
  List<ChecksumType> cktypes=new ArrayList<>(Arrays.asList(ChecksumType.values()));
  for (Iterator<ChecksumType> itr=cktypes.iterator(); itr.hasNext(); ) {
    ChecksumType cktype=itr.next();
    Path path=new Path(TEST_UTIL.getDataTestDir(),"checksum" + cktype.getName());
    FSDataOutputStream os=fs.create(path);
    HFileContext meta=new HFileContextBuilder().withChecksumType(cktype).build();
    HFileBlock.Writer hbw=new HFileBlock.Writer(null,meta);
    DataOutputStream dos=hbw.startWriting(BlockType.DATA);
    for (int i=0; i < 1000; ++i)     dos.writeInt(i);
    hbw.writeHeaderAndData(os);
    int totalSize=hbw.getOnDiskSizeWithHeader();
    os.close();
    assertEquals(true,hfs.useHBaseChecksum());
    FSDataInputStreamWrapper is=new FSDataInputStreamWrapper(fs,path);
    meta=new HFileContextBuilder().withHBaseCheckSum(true).build();
    HFileBlock.FSReader hbr=new HFileBlock.FSReaderImpl(is,totalSize,(HFileSystem)fs,path,meta);
    HFileBlock b=hbr.readBlockData(0,-1,-1,false);
    ByteBuff data=b.getBufferWithoutHeader();
    for (int i=0; i < 1000; i++) {
      assertEquals(i,data.getInt());
    }
    boolean exception_thrown=false;
    try {
      data.getInt();
    }
 catch (    BufferUnderflowException e) {
      exception_thrown=true;
    }
    assertTrue(exception_thrown);
    assertEquals(0,HFile.getChecksumFailuresCount());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockCompatibility </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test encoding/decoding data blocks.
 * @throws IOException a bug or a problem with temporary files.
 */
@Test public void testDataBlockEncoding() throws IOException {
  if (includesTag) {
    TEST_UTIL.getConfiguration().setInt("hfile.format.version",3);
  }
  final int numBlocks=5;
  for (  Compression.Algorithm algo : COMPRESSION_ALGORITHMS) {
    for (    boolean pread : new boolean[]{false,true}) {
      for (      DataBlockEncoding encoding : DataBlockEncoding.values()) {
        LOG.info("testDataBlockEncoding algo " + algo + " pread = "+ pread+ " encoding "+ encoding);
        Path path=new Path(TEST_UTIL.getDataTestDir(),"blocks_v2_" + algo + "_"+ encoding.toString());
        FSDataOutputStream os=fs.create(path);
        HFileDataBlockEncoder dataBlockEncoder=(encoding != DataBlockEncoding.NONE) ? new HFileDataBlockEncoderImpl(encoding) : NoOpDataBlockEncoder.INSTANCE;
        TestHFileBlockCompatibility.Writer hbw=new TestHFileBlockCompatibility.Writer(algo,dataBlockEncoder,includesMemstoreTS,includesTag);
        long totalSize=0;
        final List<Integer> encodedSizes=new ArrayList<Integer>();
        final List<ByteBuffer> encodedBlocks=new ArrayList<ByteBuffer>();
        for (int blockId=0; blockId < numBlocks; ++blockId) {
          hbw.startWriting(BlockType.DATA);
          TestHFileBlock.writeTestKeyValues(hbw,blockId,pread,includesTag);
          hbw.writeHeaderAndData(os);
          int headerLen=HConstants.HFILEBLOCK_HEADER_SIZE_NO_CHECKSUM;
          byte[] encodedResultWithHeader=hbw.getUncompressedDataWithHeader();
          final int encodedSize=encodedResultWithHeader.length - headerLen;
          if (encoding != DataBlockEncoding.NONE) {
            headerLen+=DataBlockEncoding.ID_SIZE;
          }
          byte[] encodedDataSection=new byte[encodedResultWithHeader.length - headerLen];
          System.arraycopy(encodedResultWithHeader,headerLen,encodedDataSection,0,encodedDataSection.length);
          final ByteBuffer encodedBuf=ByteBuffer.wrap(encodedDataSection);
          encodedSizes.add(encodedSize);
          encodedBlocks.add(encodedBuf);
          totalSize+=hbw.getOnDiskSizeWithHeader();
        }
        os.close();
        FSDataInputStream is=fs.open(path);
        HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTag).withCompression(algo).build();
        HFileBlock.FSReaderImpl hbr=new HFileBlock.FSReaderImpl(new FSDataInputStreamWrapper(is),totalSize,fs,path,meta);
        hbr.setDataBlockEncoder(dataBlockEncoder);
        hbr.setIncludesMemstoreTS(includesMemstoreTS);
        HFileBlock b;
        int pos=0;
        for (int blockId=0; blockId < numBlocks; ++blockId) {
          b=hbr.readBlockData(pos,-1,-1,pread);
          b.sanityCheck();
          if (meta.isCompressedOrEncrypted()) {
            assertFalse(b.isUnpacked());
            b=b.unpack(meta,hbr);
          }
          pos+=b.getOnDiskSizeWithHeader();
          assertEquals((int)encodedSizes.get(blockId),b.getUncompressedSizeWithoutHeader());
          ByteBuff actualBuffer=b.getBufferWithoutHeader();
          if (encoding != DataBlockEncoding.NONE) {
            assertEquals(0,actualBuffer.get(0));
            assertEquals(encoding.getId(),actualBuffer.get(1));
            actualBuffer.position(2);
            actualBuffer=actualBuffer.slice();
          }
          ByteBuffer expectedBuffer=encodedBlocks.get(blockId);
          expectedBuffer.rewind();
          TestHFileBlock.assertBuffersEqual(new SingleByteBuff(expectedBuffer),actualBuffer,algo,encoding,pread);
        }
        is.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockIndex </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testing block index through the HFile writer/reader APIs. Allows to test
 * setting index block size through configuration, intermediate-level index
 * blocks, and caching index blocks on write.
 * @throws IOException
 */
@Test public void testHFileWriterAndReader() throws IOException {
  Path hfilePath=new Path(TEST_UTIL.getDataTestDir(),"hfile_for_block_index");
  CacheConfig cacheConf=new CacheConfig(conf);
  BlockCache blockCache=cacheConf.getBlockCache();
  for (int testI=0; testI < INDEX_CHUNK_SIZES.length; ++testI) {
    int indexBlockSize=INDEX_CHUNK_SIZES[testI];
    int expectedNumLevels=EXPECTED_NUM_LEVELS[testI];
    LOG.info("Index block size: " + indexBlockSize + ", compression: "+ compr);
    blockCache.evictBlocksByHfileName(hfilePath.getName());
    conf.setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,indexBlockSize);
    Set<String> keyStrSet=new HashSet<String>();
    byte[][] keys=new byte[NUM_KV][];
    byte[][] values=new byte[NUM_KV][];
{
      HFileContext meta=new HFileContextBuilder().withBlockSize(SMALL_BLOCK_SIZE).withCompression(compr).build();
      HFile.Writer writer=HFile.getWriterFactory(conf,cacheConf).withPath(fs,hfilePath).withFileContext(meta).create();
      Random rand=new Random(19231737);
      byte[] family=Bytes.toBytes("f");
      byte[] qualifier=Bytes.toBytes("q");
      for (int i=0; i < NUM_KV; ++i) {
        byte[] row=RandomKeyValueUtil.randomOrderedKey(rand,i);
        KeyValue kv=new KeyValue(row,family,qualifier,EnvironmentEdgeManager.currentTime(),RandomKeyValueUtil.randomValue(rand));
        byte[] k=kv.getKey();
        writer.append(kv);
        keys[i]=k;
        values[i]=CellUtil.cloneValue(kv);
        keyStrSet.add(Bytes.toStringBinary(k));
        if (i > 0) {
          assertTrue((CellComparator.COMPARATOR.compare(kv,keys[i - 1],0,keys[i - 1].length)) > 0);
        }
      }
      writer.close();
    }
    HFile.Reader reader=HFile.createReader(fs,hfilePath,cacheConf,conf);
    assertEquals(expectedNumLevels,reader.getTrailer().getNumDataIndexLevels());
    assertTrue(Bytes.equals(keys[0],((KeyValue)reader.getFirstKey()).getKey()));
    assertTrue(Bytes.equals(keys[NUM_KV - 1],((KeyValue)reader.getLastKey()).getKey()));
    LOG.info("Last key: " + Bytes.toStringBinary(keys[NUM_KV - 1]));
    for (    boolean pread : new boolean[]{false,true}) {
      HFileScanner scanner=reader.getScanner(true,pread);
      for (int i=0; i < NUM_KV; ++i) {
        checkSeekTo(keys,scanner,i);
        checkKeyValue("i=" + i,keys[i],values[i],ByteBuffer.wrap(((KeyValue)scanner.getKey()).getKey()),scanner.getValue());
      }
      assertTrue(scanner.seekTo());
      for (int i=NUM_KV - 1; i >= 0; --i) {
        checkSeekTo(keys,scanner,i);
        checkKeyValue("i=" + i,keys[i],values[i],ByteBuffer.wrap(((KeyValue)scanner.getKey()).getKey()),scanner.getValue());
      }
    }
    HFile.Reader reader2=reader;
    HFileBlock.FSReader fsReader=reader2.getUncachedBlockReader();
    HFileBlock.BlockIterator iter=fsReader.blockRange(0,reader.getTrailer().getLoadOnOpenDataOffset());
    HFileBlock block;
    List<byte[]> blockKeys=new ArrayList<byte[]>();
    while ((block=iter.nextBlock()) != null) {
      if (block.getBlockType() != BlockType.LEAF_INDEX)       return;
      ByteBuff b=block.getBufferReadOnly();
      int n=b.getIntAfterPosition(0);
      int entriesOffset=Bytes.SIZEOF_INT * (n + 2);
      for (int i=0; i < n; ++i) {
        int keyRelOffset=b.getIntAfterPosition(Bytes.SIZEOF_INT * (i + 1));
        int nextKeyRelOffset=b.getIntAfterPosition(Bytes.SIZEOF_INT * (i + 2));
        int keyLen=nextKeyRelOffset - keyRelOffset;
        int keyOffset=b.arrayOffset() + entriesOffset + keyRelOffset+ HFileBlockIndex.SECONDARY_INDEX_ENTRY_OVERHEAD;
        byte[] blockKey=Arrays.copyOfRange(b.array(),keyOffset,keyOffset + keyLen);
        String blockKeyStr=Bytes.toString(blockKey);
        blockKeys.add(blockKey);
        assertTrue("Invalid block key from leaf-level block: " + blockKeyStr,keyStrSet.contains(blockKeyStr));
      }
    }
    assertEquals(Bytes.toStringBinary(blockKeys.get((blockKeys.size() - 1) / 2)),reader.midkey());
    assertEquals(UNCOMPRESSED_INDEX_SIZES[testI],reader.getTrailer().getUncompressedDataIndexSize());
    reader.close();
    reader2.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecondaryIndexBinarySearch() throws IOException {
  int numTotalKeys=99;
  assertTrue(numTotalKeys % 2 == 1);
  int numSearchedKeys=(numTotalKeys - 1) / 2;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  dos.writeInt(numSearchedKeys);
  int curAllEntriesSize=0;
  int numEntriesAdded=0;
  int secondaryIndexEntries[]=new int[numTotalKeys];
  for (int i=0; i < numTotalKeys; ++i) {
    byte[] k=RandomKeyValueUtil.randomOrderedKey(rand,i * 2);
    KeyValue cell=new KeyValue(k,Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("val"));
    keys.add(cell.getKey());
    String msgPrefix="Key #" + i + " ("+ Bytes.toStringBinary(k)+ "): ";
    StringBuilder padding=new StringBuilder();
    while (msgPrefix.length() + padding.length() < 70)     padding.append(' ');
    msgPrefix+=padding;
    if (i % 2 == 1) {
      dos.writeInt(curAllEntriesSize);
      secondaryIndexEntries[i]=curAllEntriesSize;
      LOG.info(msgPrefix + "secondary index entry #" + ((i - 1) / 2)+ ", offset "+ curAllEntriesSize);
      curAllEntriesSize+=cell.getKey().length + HFileBlockIndex.SECONDARY_INDEX_ENTRY_OVERHEAD;
      ++numEntriesAdded;
    }
 else {
      secondaryIndexEntries[i]=-1;
      LOG.info(msgPrefix + "not in the searched array");
    }
  }
  for (int i=0; i < keys.size() - 1; ++i)   assertTrue(CellComparator.COMPARATOR.compare(new KeyValue.KeyOnlyKeyValue(keys.get(i),0,keys.get(i).length),new KeyValue.KeyOnlyKeyValue(keys.get(i + 1),0,keys.get(i + 1).length)) < 0);
  dos.writeInt(curAllEntriesSize);
  assertEquals(numSearchedKeys,numEntriesAdded);
  int secondaryIndexOffset=dos.size();
  assertEquals(Bytes.SIZEOF_INT * (numSearchedKeys + 2),secondaryIndexOffset);
  for (int i=1; i <= numTotalKeys - 1; i+=2) {
    assertEquals(dos.size(),secondaryIndexOffset + secondaryIndexEntries[i]);
    long dummyFileOffset=getDummyFileOffset(i);
    int dummyOnDiskSize=getDummyOnDiskSize(i);
    LOG.debug("Storing file offset=" + dummyFileOffset + " and onDiskSize="+ dummyOnDiskSize+ " at offset "+ dos.size());
    dos.writeLong(dummyFileOffset);
    dos.writeInt(dummyOnDiskSize);
    LOG.debug("Stored key " + ((i - 1) / 2) + " at offset "+ dos.size());
    dos.write(keys.get(i));
  }
  dos.writeInt(curAllEntriesSize);
  ByteBuffer nonRootIndex=ByteBuffer.wrap(baos.toByteArray());
  for (int i=0; i < numTotalKeys; ++i) {
    byte[] searchKey=keys.get(i);
    byte[] arrayHoldingKey=new byte[searchKey.length + searchKey.length / 2];
    System.arraycopy(searchKey,0,arrayHoldingKey,searchKey.length / 2,searchKey.length);
    KeyValue.KeyOnlyKeyValue cell=new KeyValue.KeyOnlyKeyValue(arrayHoldingKey,searchKey.length / 2,searchKey.length);
    int searchResult=BlockIndexReader.binarySearchNonRootIndex(cell,new MultiByteBuff(nonRootIndex),CellComparator.COMPARATOR);
    String lookupFailureMsg="Failed to look up key #" + i + " ("+ Bytes.toStringBinary(searchKey)+ ")";
    int expectedResult;
    int referenceItem;
    if (i % 2 == 1) {
      expectedResult=(i - 1) / 2;
      referenceItem=i;
    }
 else {
      expectedResult=i / 2 - 1;
      referenceItem=i - 1;
    }
    assertEquals(lookupFailureMsg,expectedResult,searchResult);
    boolean locateBlockResult=(BlockIndexReader.locateNonRootIndexEntry(new MultiByteBuff(nonRootIndex),cell,CellComparator.COMPARATOR) != -1);
    if (i == 0) {
      assertFalse(locateBlockResult);
    }
 else {
      assertTrue(locateBlockResult);
      String errorMsg="i=" + i + ", position="+ nonRootIndex.position();
      assertEquals(errorMsg,getDummyFileOffset(referenceItem),nonRootIndex.getLong());
      assertEquals(errorMsg,getDummyOnDiskSize(referenceItem),nonRootIndex.getInt());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlockIndexChunk() throws IOException {
  BlockIndexChunk c=new BlockIndexChunk();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  int N=1000;
  int[] numSubEntriesAt=new int[N];
  int numSubEntries=0;
  for (int i=0; i < N; ++i) {
    baos.reset();
    DataOutputStream dos=new DataOutputStream(baos);
    c.writeNonRoot(dos);
    assertEquals(c.getNonRootSize(),dos.size());
    baos.reset();
    dos=new DataOutputStream(baos);
    c.writeRoot(dos);
    assertEquals(c.getRootSize(),dos.size());
    byte[] k=RandomKeyValueUtil.randomOrderedKey(rand,i);
    numSubEntries+=rand.nextInt(5) + 1;
    keys.add(k);
    c.add(k,getDummyFileOffset(i),getDummyOnDiskSize(i),numSubEntries);
  }
  for (int i=0; i < N; ++i) {
    for (int j=i == 0 ? 0 : numSubEntriesAt[i - 1]; j < numSubEntriesAt[i]; ++j) {
      assertEquals(i,c.getEntryBySubEntry(j));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileEncryption </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=6000000) public void testHFileEncryption() throws Exception {
  RedundantKVGenerator generator=new RedundantKVGenerator();
  List<KeyValue> testKvs=generator.generateTestKeyValues(1000);
  Configuration conf=TEST_UTIL.getConfiguration();
  CacheConfig cacheConf=new CacheConfig(conf);
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    for (    Compression.Algorithm compression : TestHFileBlock.COMPRESSION_ALGORITHMS) {
      HFileContext fileContext=new HFileContextBuilder().withBlockSize(4096).withEncryptionContext(cryptoContext).withCompression(compression).withDataBlockEncoding(encoding).build();
      LOG.info("Writing with " + fileContext);
      Path path=new Path(TEST_UTIL.getDataTestDir(),UUID.randomUUID().toString() + ".hfile");
      FSDataOutputStream out=fs.create(path);
      HFile.Writer writer=HFile.getWriterFactory(conf,cacheConf).withOutputStream(out).withFileContext(fileContext).create();
      try {
        for (        KeyValue kv : testKvs) {
          writer.append(kv);
        }
      }
  finally {
        writer.close();
        out.close();
      }
      LOG.info("Reading with " + fileContext);
      int i=0;
      HFileScanner scanner=null;
      HFile.Reader reader=HFile.createReader(fs,path,cacheConf,conf);
      try {
        reader.loadFileInfo();
        FixedFileTrailer trailer=reader.getTrailer();
        assertNotNull(trailer.getEncryptionKey());
        scanner=reader.getScanner(false,false);
        assertTrue("Initial seekTo failed",scanner.seekTo());
        do {
          Cell kv=scanner.getCell();
          assertTrue("Read back an unexpected or invalid KV",testKvs.contains(KeyValueUtil.ensureKeyValue(kv)));
          i++;
        }
 while (scanner.next());
      }
  finally {
        reader.close();
        scanner.close();
      }
      assertEquals("Did not read back as many KVs as written",i,testKvs.size());
      LOG.info("Random seeking with " + fileContext);
      reader=HFile.createReader(fs,path,cacheConf,conf);
      try {
        scanner=reader.getScanner(false,true);
        assertTrue("Initial seekTo failed",scanner.seekTo());
        for (i=0; i < 100; i++) {
          KeyValue kv=testKvs.get(RNG.nextInt(testKvs.size()));
          assertEquals("Unable to find KV as expected: " + kv,scanner.seekTo(kv),0);
        }
      }
  finally {
        scanner.close();
        reader.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestLruBlockCache </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBackgroundEvictionThread() throws Exception {
  long maxSize=100000;
  int numBlocks=9;
  long blockSize=calculateBlockSizeDefault(maxSize,numBlocks);
  assertTrue("calculateBlockSize appears broken.",blockSize * numBlocks <= maxSize);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize);
  EvictionThread evictionThread=cache.getEvictionThread();
  assertTrue(evictionThread != null);
  CachedItem[] blocks=generateFixedBlocks(numBlocks + 1,blockSize,"block");
  while (!evictionThread.isEnteringRun()) {
    Thread.sleep(1);
  }
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.cacheKey,block);
  }
  int n=0;
  while (cache.getStats().getEvictionCount() == 0) {
    Thread.sleep(200);
    assertTrue("Eviction never happened.",n++ < 20);
  }
  n=0;
  for (long prevCnt=0, curCnt=cache.getBlockCount(); prevCnt != curCnt; prevCnt=curCnt, curCnt=cache.getBlockCount()) {
    Thread.sleep(200);
    assertTrue("Cache never stabilized.",n++ < 20);
  }
  long evictionCount=cache.getStats().getEvictionCount();
  assertTrue(evictionCount >= 1);
  System.out.println("Background Evictions run: " + evictionCount);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheEvictionSimple() throws Exception {
  long maxSize=100000;
  long blockSize=calculateBlockSizeDefault(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false);
  CachedItem[] blocks=generateFixedBlocks(10,blockSize,"block");
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
  }
  assertEquals(1,cache.getStats().getEvictionCount());
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.heapSize() < maxSize);
  assertTrue(cache.heapSize() < (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(blocks[0].cacheKey,true,false,true) == null);
  for (int i=1; i < blocks.length; i++) {
    assertEquals(cache.getBlock(blocks[i].cacheKey,true,false,true),blocks[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheEvictionTwoPriorities() throws Exception {
  long maxSize=100000;
  long blockSize=calculateBlockSizeDefault(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false);
  CachedItem[] singleBlocks=generateFixedBlocks(5,10000,"single");
  CachedItem[] multiBlocks=generateFixedBlocks(5,10000,"multi");
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : multiBlocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
    assertEquals(cache.getBlock(block.cacheKey,true,false,true),block);
  }
  for (  CachedItem block : singleBlocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.heapSize();
  }
  assertEquals(cache.getStats().getEvictionCount(),1);
  assertEquals(cache.getStats().getEvictedCount(),2);
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.heapSize() <= maxSize);
  assertTrue(cache.heapSize() <= (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(singleBlocks[0].cacheKey,true,false,true) == null);
  assertTrue(cache.getBlock(multiBlocks[0].cacheKey,true,false,true) == null);
  for (int i=1; i < 4; i++) {
    assertEquals(cache.getBlock(singleBlocks[i].cacheKey,true,false,true),singleBlocks[i]);
    assertEquals(cache.getBlock(multiBlocks[i].cacheKey,true,false,true),multiBlocks[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResizeBlockCache() throws Exception {
  long maxSize=300000;
  long blockSize=calculateBlockSize(maxSize,31);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false,(int)Math.ceil(1.2 * maxSize / blockSize),LruBlockCache.DEFAULT_LOAD_FACTOR,LruBlockCache.DEFAULT_CONCURRENCY_LEVEL,0.98f,0.99f,0.33f,0.33f,0.34f,false,16 * 1024 * 1024);
  CachedItem[] singleBlocks=generateFixedBlocks(10,blockSize,"single");
  CachedItem[] multiBlocks=generateFixedBlocks(10,blockSize,"multi");
  CachedItem[] memoryBlocks=generateFixedBlocks(10,blockSize,"memory");
  for (int i=0; i < 10; i++) {
    cache.cacheBlock(singleBlocks[i].cacheKey,singleBlocks[i]);
    cache.cacheBlock(multiBlocks[i].cacheKey,multiBlocks[i]);
    cache.getBlock(multiBlocks[i].cacheKey,true,false,true);
    cache.cacheBlock(memoryBlocks[i].cacheKey,memoryBlocks[i],true,false);
  }
  assertEquals(0,cache.getStats().getEvictionCount());
  cache.setMaxSize((long)(maxSize * 0.5f));
  assertEquals(1,cache.getStats().getEvictionCount());
  assertEquals(15,cache.getStats().getEvictedCount());
  for (int i=0; i < 5; i++) {
    assertEquals(null,cache.getBlock(singleBlocks[i].cacheKey,true,false,true));
    assertEquals(null,cache.getBlock(multiBlocks[i].cacheKey,true,false,true));
    assertEquals(null,cache.getBlock(memoryBlocks[i].cacheKey,true,false,true));
  }
  for (int i=5; i < 10; i++) {
    assertEquals(singleBlocks[i],cache.getBlock(singleBlocks[i].cacheKey,true,false,true));
    assertEquals(multiBlocks[i],cache.getBlock(multiBlocks[i].cacheKey,true,false,true));
    assertEquals(memoryBlocks[i],cache.getBlock(memoryBlocks[i].cacheKey,true,false,true));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestScannerFromBucketCache </h4><pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testBasicScanWithLRUCache() throws IOException {
  setUp(false,false);
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("lrucache");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,conf,test_util,fam1);
  try {
    List<Cell> expected=insertData(row1,qf1,qf2,fam1,ts1,ts2,ts3,false);
    List<Cell> actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
    actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicScanWithOffheapBucketCacheWithMBB() throws IOException {
  setUp(true,true);
  byte[] row1=Bytes.toBytes("row1offheap");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("famoffheap");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,conf,test_util,fam1);
  try {
    List<Cell> expected=insertData(row1,qf1,qf2,fam1,ts1,ts2,ts3,true);
    List<Cell> actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
    Thread.sleep(500);
    Scan scan=new Scan(row1);
    scan.addFamily(fam1);
    scan.setMaxVersions(10);
    actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan,false);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      if (i != 5) {
        assertTrue(actual.get(i) instanceof OffheapKeyValue);
      }
      assertTrue(actual.get(i) instanceof ShareableMemory);
    }
  }
 catch (  InterruptedException e) {
  }
 finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testBasicScanWithOffheapBucketCache() throws IOException {
  setUp(true,true);
  byte[] row1=Bytes.toBytes("row1offheap");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("famoffheap");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,conf,test_util,fam1);
  try {
    List<Cell> expected=insertData(row1,qf1,qf2,fam1,ts1,ts2,ts3,false);
    List<Cell> actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
    Thread.sleep(500);
    actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(actual.get(i) instanceof OffheapKeyValue);
      assertTrue(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
 catch (  InterruptedException e) {
  }
 finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testBasicScanWithOnheapBucketCache() throws IOException {
  setUp(false,true);
  byte[] row1=Bytes.toBytes("row1onheap");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("famonheap");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,conf,test_util,fam1);
  try {
    List<Cell> expected=insertData(row1,qf1,qf2,fam1,ts1,ts2,ts3,false);
    List<Cell> actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
    actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertTrue(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestScannerSelectionUsingTTL </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScannerSelection() throws IOException {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setBoolean("hbase.store.delete.expired.storefile",false);
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY_BYTES).setMaxVersions(Integer.MAX_VALUE).setTimeToLive(TTL_SECONDS);
  HTableDescriptor htd=new HTableDescriptor(TABLE);
  htd.addFamily(hcd);
  HRegionInfo info=new HRegionInfo(TABLE);
  Region region=HBaseTestingUtility.createRegionAndWAL(info,TEST_UTIL.getDataTestDir(info.getEncodedName()),conf,htd);
  long ts=EnvironmentEdgeManager.currentTime();
  long version=0;
  for (int iFile=0; iFile < totalNumFiles; ++iFile) {
    if (iFile == NUM_EXPIRED_FILES) {
      Threads.sleepWithoutInterrupt(TTL_MS);
      version+=TTL_MS;
    }
    for (int iRow=0; iRow < NUM_ROWS; ++iRow) {
      Put put=new Put(Bytes.toBytes("row" + iRow));
      for (int iCol=0; iCol < NUM_COLS_PER_ROW; ++iCol) {
        put.addColumn(FAMILY_BYTES,Bytes.toBytes("col" + iCol),ts + version,Bytes.toBytes("value" + iFile + "_"+ iRow+ "_"+ iCol));
      }
      region.put(put);
    }
    region.flush(true);
    version++;
  }
  Scan scan=new Scan();
  scan.setMaxVersions(Integer.MAX_VALUE);
  CacheConfig cacheConf=new CacheConfig(conf);
  LruBlockCache cache=(LruBlockCache)cacheConf.getBlockCache();
  cache.clearCache();
  InternalScanner scanner=region.getScanner(scan);
  List<Cell> results=new ArrayList<Cell>();
  final int expectedKVsPerRow=numFreshFiles * NUM_COLS_PER_ROW;
  int numReturnedRows=0;
  LOG.info("Scanning the entire table");
  while (scanner.next(results) || results.size() > 0) {
    assertEquals(expectedKVsPerRow,results.size());
    ++numReturnedRows;
    results.clear();
  }
  assertEquals(NUM_ROWS,numReturnedRows);
  Set<String> accessedFiles=cache.getCachedFileNamesForTest();
  LOG.debug("Files accessed during scan: " + accessedFiles);
  if (explicitCompaction) {
    HStore store=(HStore)region.getStore(FAMILY_BYTES);
    store.compactRecentForTestingAssumingDefaultPolicy(totalNumFiles);
  }
 else {
    region.compact(false);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestSeekBeforeWithInlineBlocks </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Scanner.seekBefore() could fail because when seeking to a previous HFile data block, it needs 
 * to know the size of that data block, which it calculates using current data block offset and 
 * the previous data block offset.  This fails to work when there are leaf-level index blocks in 
 * the scannable section of the HFile, i.e. starting in HFileV2.  This test will try seekBefore() 
 * on a flat (single-level) and multi-level (2,3) HFile and confirm this bug is now fixed.  This
 * bug also happens for inline Bloom blocks for the same reasons.
 */
@Test public void testMultiIndexLevelRandomHFileWithBlooms() throws IOException {
  conf=TEST_UTIL.getConfiguration();
  for (int hfileVersion=HFile.MIN_FORMAT_VERSION_WITH_TAGS; hfileVersion <= HFile.MAX_FORMAT_VERSION; hfileVersion++) {
    conf.setInt(HFile.FORMAT_VERSION_KEY,hfileVersion);
    fs=HFileSystem.get(conf);
    for (    BloomType bloomType : BloomType.values()) {
      for (int testI=0; testI < INDEX_CHUNK_SIZES.length; testI++) {
        int indexBlockSize=INDEX_CHUNK_SIZES[testI];
        int expectedNumLevels=EXPECTED_NUM_LEVELS[testI];
        LOG.info(String.format("Testing HFileVersion: %s, BloomType: %s, Index Levels: %s",hfileVersion,bloomType,expectedNumLevels));
        conf.setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,indexBlockSize);
        conf.setInt(BloomFilterFactory.IO_STOREFILE_BLOOM_BLOCK_SIZE,BLOOM_BLOCK_SIZE);
        Cell[] cells=new Cell[NUM_KV];
        Path hfilePath=new Path(TEST_UTIL.getDataTestDir(),String.format("testMultiIndexLevelRandomHFileWithBlooms-%s-%s-%s",hfileVersion,bloomType,testI));
        conf.setFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,0.0f);
        CacheConfig cacheConf=new CacheConfig(conf);
{
          HFileContext meta=new HFileContextBuilder().withBlockSize(DATA_BLOCK_SIZE).build();
          StoreFile.Writer storeFileWriter=new StoreFile.WriterBuilder(conf,cacheConf,fs).withFilePath(hfilePath).withFileContext(meta).withBloomType(bloomType).build();
          for (int i=0; i < NUM_KV; i++) {
            byte[] row=RandomKeyValueUtil.randomOrderedKey(RAND,i);
            byte[] qual=RandomKeyValueUtil.randomRowOrQualifier(RAND);
            byte[] value=RandomKeyValueUtil.randomValue(RAND);
            KeyValue kv=new KeyValue(row,FAM,qual,value);
            storeFileWriter.append(kv);
            cells[i]=kv;
          }
          storeFileWriter.close();
        }
        HFile.Reader reader=HFile.createReader(fs,hfilePath,cacheConf,conf);
        assertEquals(expectedNumLevels,reader.getTrailer().getNumDataIndexLevels());
        for (        boolean pread : new boolean[]{false,true}) {
          HFileScanner scanner=reader.getScanner(true,pread);
          checkNoSeekBefore(cells,scanner,0);
          for (int i=1; i < NUM_KV; i++) {
            checkSeekBefore(cells,scanner,i);
            checkCell(cells[i - 1],scanner.getCell());
          }
          assertTrue(scanner.seekTo());
          for (int i=NUM_KV - 1; i >= 1; i--) {
            checkSeekBefore(cells,scanner,i);
            checkCell(cells[i - 1],scanner.getCell());
          }
          checkNoSeekBefore(cells,scanner,0);
          scanner.close();
        }
        reader.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestByteBufferIOEngine </h4><pre class="type-9 type-8 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testByteBufferIOEngine() throws Exception {
  int capacity=32 * 1024 * 1024;
  int testNum=100;
  int maxBlockSize=64 * 1024;
  ByteBufferIOEngine ioEngine=new ByteBufferIOEngine(capacity,false);
  int testOffsetAtStartNum=testNum / 10;
  int testOffsetAtEndNum=testNum / 10;
  for (int i=0; i < testNum; i++) {
    byte val=(byte)(Math.random() * 255);
    int blockSize=(int)(Math.random() * maxBlockSize);
    if (blockSize == 0) {
      blockSize=1;
    }
    byte[] byteArray=new byte[blockSize];
    for (int j=0; j < byteArray.length; ++j) {
      byteArray[j]=val;
    }
    ByteBuffer srcBuffer=ByteBuffer.wrap(byteArray);
    int offset=0;
    if (testOffsetAtStartNum > 0) {
      testOffsetAtStartNum--;
      offset=0;
    }
 else     if (testOffsetAtEndNum > 0) {
      testOffsetAtEndNum--;
      offset=capacity - blockSize;
    }
 else {
      offset=(int)(Math.random() * (capacity - maxBlockSize));
    }
    ioEngine.write(srcBuffer,offset);
    BufferGrabbingDeserializer deserializer=new BufferGrabbingDeserializer();
    ioEngine.read(offset,blockSize,deserializer);
    ByteBuff dstBuffer=deserializer.buf;
    for (int j=0; j < byteArray.length; ++j) {
      assertTrue(byteArray[j] == dstBuffer.get(j));
    }
  }
  assert testOffsetAtStartNum == 0;
  assert testOffsetAtEndNum == 0;
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testByteBufferIOEngineWithMBB() throws Exception {
  int capacity=32 * 1024 * 1024;
  int testNum=100;
  int maxBlockSize=64 * 1024;
  ByteBufferIOEngine ioEngine=new ByteBufferIOEngine(capacity,false);
  int testOffsetAtStartNum=testNum / 10;
  int testOffsetAtEndNum=testNum / 10;
  for (int i=0; i < testNum; i++) {
    byte val=(byte)(Math.random() * 255);
    int blockSize=(int)(Math.random() * maxBlockSize);
    if (blockSize == 0) {
      blockSize=1;
    }
    byte[] byteArray=new byte[blockSize];
    for (int j=0; j < byteArray.length; ++j) {
      byteArray[j]=val;
    }
    ByteBuffer srcBuffer=ByteBuffer.wrap(byteArray);
    int offset=0;
    if (testOffsetAtStartNum > 0) {
      testOffsetAtStartNum--;
      offset=0;
    }
 else     if (testOffsetAtEndNum > 0) {
      testOffsetAtEndNum--;
      offset=capacity - blockSize;
    }
 else {
      offset=(int)(Math.random() * (capacity - maxBlockSize));
    }
    ioEngine.write(srcBuffer,offset);
    BufferGrabbingDeserializer deserializer=new BufferGrabbingDeserializer();
    ioEngine.read(offset,blockSize,deserializer);
    ByteBuff dstBuffer=deserializer.buf;
    for (int j=0; j < byteArray.length; ++j) {
      assertTrue(srcBuffer.get(j) == dstBuffer.get(j));
    }
  }
  assert testOffsetAtStartNum == 0;
  assert testOffsetAtEndNum == 0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestFileIOEngine </h4><pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFileIOEngine() throws IOException {
  int size=2 * 1024 * 1024;
  String filePath="testFileIOEngine";
  try {
    FileIOEngine fileIOEngine=new FileIOEngine(filePath,size);
    for (int i=0; i < 50; i++) {
      int len=(int)Math.floor(Math.random() * 100);
      long offset=(long)Math.floor(Math.random() * size % (size - len));
      byte[] data1=new byte[len];
      for (int j=0; j < data1.length; ++j) {
        data1[j]=(byte)(Math.random() * 255);
      }
      fileIOEngine.write(ByteBuffer.wrap(data1),offset);
      BufferGrabbingDeserializer deserializer=new BufferGrabbingDeserializer();
      fileIOEngine.read(offset,len,deserializer);
      ByteBuff data2=deserializer.getDeserializedByteBuff();
      for (int j=0; j < data1.length; ++j) {
        assertTrue(data1[j] == data2.get(j));
      }
    }
  }
  finally {
    File file=new File(filePath);
    if (file.exists()) {
      file.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.util.TestLRUDictionary </h4><pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void TestLRUPolicy(){
  for (int i=0; i < Short.MAX_VALUE; i++) {
    testee.findEntry((BigInteger.valueOf(i)).toByteArray(),0,(BigInteger.valueOf(i)).toByteArray().length);
  }
  assertTrue(testee.findEntry(BigInteger.ZERO.toByteArray(),0,BigInteger.ZERO.toByteArray().length) != -1);
  assertTrue(testee.findEntry(BigInteger.valueOf(Integer.MAX_VALUE).toByteArray(),0,BigInteger.valueOf(Integer.MAX_VALUE).toByteArray().length) == -1);
  assertTrue(testee.findEntry(BigInteger.valueOf(Integer.MAX_VALUE).toByteArray(),0,BigInteger.valueOf(Integer.MAX_VALUE).toByteArray().length) != -1);
  assertTrue(testee.findEntry(BigInteger.ZERO.toByteArray(),0,BigInteger.ZERO.toByteArray().length) != -1);
  for (int i=1; i < Short.MAX_VALUE; i++) {
    assertTrue(testee.findEntry(BigInteger.valueOf(i).toByteArray(),0,BigInteger.valueOf(i).toByteArray().length) == -1);
  }
  for (int i=0; i < Short.MAX_VALUE; i++) {
    assertTrue(testee.findEntry(BigInteger.valueOf(i).toByteArray(),0,BigInteger.valueOf(i).toByteArray().length) != -1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.AbstractTestIPC </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * It is hard to verify the compression is actually happening under the wraps. Hope that if
 * unsupported, we'll get an exception out of some time (meantime, have to trace it manually to
 * confirm that compression is happening down in the client and server).
 * @throws IOException
 * @throws InterruptedException
 * @throws SecurityException
 * @throws NoSuchMethodException
 */
@Test public void testCompressCellBlock() throws IOException, InterruptedException, SecurityException, NoSuchMethodException, ServiceException {
  Configuration conf=new Configuration(HBaseConfiguration.create());
  conf.set("hbase.client.rpc.compressor",GzipCodec.class.getCanonicalName());
  List<Cell> cells=new ArrayList<Cell>();
  int count=3;
  for (int i=0; i < count; i++) {
    cells.add(CELL);
  }
  AbstractRpcClient client=createRpcClient(conf);
  TestRpcServer rpcServer=new TestRpcServer();
  try {
    rpcServer.start();
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    PayloadCarryingRpcController pcrc=new PayloadCarryingRpcController(CellUtil.createCellScanner(cells));
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    Pair<Message,CellScanner> r=client.call(pcrc,md,param,md.getOutputType().toProto(),User.getCurrent(),address,new MetricsConnection.CallStats());
    int index=0;
    while (r.getSecond().advance()) {
      assertTrue(CELL.equals(r.getSecond().current()));
      index++;
    }
    assertEquals(count,index);
  }
  finally {
    client.close();
    rpcServer.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestPayloadCarryingRpcController </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListOfCellScannerables() throws IOException {
  List<CellScannable> cells=new ArrayList<CellScannable>();
  final int count=10;
  for (int i=0; i < count; i++) {
    cells.add(createCell(i));
  }
  PayloadCarryingRpcController controller=new PayloadCarryingRpcController(cells);
  CellScanner cellScanner=controller.cellScanner();
  int index=0;
  for (; cellScanner.advance(); index++) {
    Cell cell=cellScanner.current();
    byte[] indexBytes=Bytes.toBytes(index);
    assertTrue("" + index,Bytes.equals(indexBytes,0,indexBytes.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
  }
  assertEquals(count,index);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestSimpleRpcScheduler </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScanQueues() throws Exception {
  Configuration schedConf=HBaseConfiguration.create();
  schedConf.setFloat(SimpleRpcScheduler.CALL_QUEUE_HANDLER_FACTOR_CONF_KEY,1.0f);
  schedConf.setFloat(SimpleRpcScheduler.CALL_QUEUE_READ_SHARE_CONF_KEY,0.7f);
  schedConf.setFloat(SimpleRpcScheduler.CALL_QUEUE_SCAN_SHARE_CONF_KEY,0.5f);
  PriorityFunction priority=mock(PriorityFunction.class);
  when(priority.getPriority(any(RequestHeader.class),any(Message.class),any(User.class))).thenReturn(HConstants.NORMAL_QOS);
  RpcScheduler scheduler=new SimpleRpcScheduler(schedConf,3,1,1,priority,HConstants.QOS_THRESHOLD);
  try {
    scheduler.start();
    CallRunner putCallTask=mock(CallRunner.class);
    RpcServer.Call putCall=mock(RpcServer.Call.class);
    putCall.param=RequestConverter.buildMutateRequest(Bytes.toBytes("abc"),new Put(Bytes.toBytes("row")));
    RequestHeader putHead=RequestHeader.newBuilder().setMethodName("mutate").build();
    when(putCallTask.getCall()).thenReturn(putCall);
    when(putCall.getHeader()).thenReturn(putHead);
    CallRunner getCallTask=mock(CallRunner.class);
    RpcServer.Call getCall=mock(RpcServer.Call.class);
    RequestHeader getHead=RequestHeader.newBuilder().setMethodName("get").build();
    when(getCallTask.getCall()).thenReturn(getCall);
    when(getCall.getHeader()).thenReturn(getHead);
    CallRunner scanCallTask=mock(CallRunner.class);
    RpcServer.Call scanCall=mock(RpcServer.Call.class);
    scanCall.param=ScanRequest.newBuilder().setScannerId(1).build();
    RequestHeader scanHead=RequestHeader.newBuilder().setMethodName("scan").build();
    when(scanCallTask.getCall()).thenReturn(scanCall);
    when(scanCall.getHeader()).thenReturn(scanHead);
    ArrayList<Integer> work=new ArrayList<Integer>();
    doAnswerTaskExecution(putCallTask,work,1,1000);
    doAnswerTaskExecution(getCallTask,work,2,1000);
    doAnswerTaskExecution(scanCallTask,work,3,1000);
    scheduler.dispatch(putCallTask);
    scheduler.dispatch(putCallTask);
    scheduler.dispatch(putCallTask);
    scheduler.dispatch(getCallTask);
    scheduler.dispatch(getCallTask);
    scheduler.dispatch(getCallTask);
    scheduler.dispatch(scanCallTask);
    scheduler.dispatch(scanCallTask);
    scheduler.dispatch(scanCallTask);
    while (work.size() < 6) {
      Threads.sleepWithoutInterrupt(100);
    }
    for (int i=0; i < work.size() - 2; i+=3) {
      assertNotEquals(work.get(i + 0),work.get(i + 1));
      assertNotEquals(work.get(i + 0),work.get(i + 2));
      assertNotEquals(work.get(i + 1),work.get(i + 2));
    }
  }
  finally {
    scheduler.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat2 </h4><pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureBloomType(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyBloomTypeMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyBloomTypeMap() throws IOException {
  for (int numCfs=0; numCfs <= 2; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,BloomType> familyToBloomType=getMockColumnFamiliesForBloomType(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForBloomType(table,familyToBloomType);
    HFileOutputFormat2.configureBloomType(table.getTableDescriptor(),conf);
    Map<byte[],BloomType> retrievedFamilyToBloomTypeMap=HFileOutputFormat2.createFamilyBloomTypeMap(conf);
    for (    Entry<String,BloomType> entry : familyToBloomType.entrySet()) {
      assertEquals("BloomType configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToBloomTypeMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureCompression(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyCompressionMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyCompressionMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,Compression.Algorithm> familyToCompression=getMockColumnFamiliesForCompression(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForCompression(table,familyToCompression);
    HFileOutputFormat2.configureCompression(conf,table.getTableDescriptor());
    Map<byte[],Algorithm> retrievedFamilyToCompressionMap=HFileOutputFormat2.createFamilyCompressionMap(conf);
    for (    Entry<String,Algorithm> entry : familyToCompression.entrySet()) {
      assertEquals("Compression configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToCompressionMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureDataBlockEncoding(HTableDescriptor,Configuration)}and {@link HFileOutputFormat2#createFamilyDataBlockEncodingMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyDataBlockEncodingMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,DataBlockEncoding> familyToDataBlockEncoding=getMockColumnFamiliesForDataBlockEncoding(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForDataBlockEncoding(table,familyToDataBlockEncoding);
    HTableDescriptor tableDescriptor=table.getTableDescriptor();
    HFileOutputFormat2.configureDataBlockEncoding(tableDescriptor,conf);
    Map<byte[],DataBlockEncoding> retrievedFamilyToDataBlockEncodingMap=HFileOutputFormat2.createFamilyDataBlockEncodingMap(conf);
    for (    Entry<String,DataBlockEncoding> entry : familyToDataBlockEncoding.entrySet()) {
      assertEquals("DataBlockEncoding configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToDataBlockEncodingMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureBlockSize(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyBlockSizeMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyBlockSizeMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,Integer> familyToBlockSize=getMockColumnFamiliesForBlockSize(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForBlockSize(table,familyToBlockSize);
    HFileOutputFormat2.configureBlockSize(table.getTableDescriptor(),conf);
    Map<byte[],Integer> retrievedFamilyToBlockSizeMap=HFileOutputFormat2.createFamilyBlockSizeMap(conf);
    for (    Entry<String,Integer> entry : familyToBlockSize.entrySet()) {
      assertEquals("BlockSize configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToBlockSizeMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestHashTable </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashTable() throws Exception {
  final TableName tableName=TableName.valueOf("testHashTable");
  final byte[] family=Bytes.toBytes("family");
  final byte[] column1=Bytes.toBytes("c1");
  final byte[] column2=Bytes.toBytes("c2");
  final byte[] column3=Bytes.toBytes("c3");
  int numRows=100;
  int numRegions=10;
  int numHashFiles=3;
  byte[][] splitRows=new byte[numRegions - 1][];
  for (int i=1; i < numRegions; i++) {
    splitRows[i - 1]=Bytes.toBytes(numRows * i / numRegions);
  }
  long timestamp=1430764183454L;
  Table t1=TEST_UTIL.createTable(tableName,family,splitRows);
  for (int i=0; i < numRows; i++) {
    Put p=new Put(Bytes.toBytes(i),timestamp);
    p.addColumn(family,column1,column1);
    p.addColumn(family,column2,column2);
    p.addColumn(family,column3,column3);
    t1.put(p);
  }
  t1.close();
  HashTable hashTable=new HashTable(TEST_UTIL.getConfiguration());
  Path testDir=TEST_UTIL.getDataTestDirOnTestFS(tableName.getNameAsString());
  long batchSize=300;
  int code=hashTable.run(new String[]{"--batchsize=" + batchSize,"--numhashfiles=" + numHashFiles,"--scanbatch=2",tableName.getNameAsString(),testDir.toString()});
  assertEquals("test job failed",0,code);
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  HashTable.TableHash tableHash=HashTable.TableHash.read(fs.getConf(),testDir);
  assertEquals(tableName.getNameAsString(),tableHash.tableName);
  assertEquals(batchSize,tableHash.batchSize);
  assertEquals(numHashFiles,tableHash.numHashFiles);
  assertEquals(numHashFiles - 1,tableHash.partitions.size());
  for (  ImmutableBytesWritable bytes : tableHash.partitions) {
    LOG.debug("partition: " + Bytes.toInt(bytes.get()));
  }
  ImmutableMap<Integer,ImmutableBytesWritable> expectedHashes=ImmutableMap.<Integer,ImmutableBytesWritable>builder().put(-1,new ImmutableBytesWritable(Bytes.fromHex("714cb10a9e3b5569852980edd8c6ca2f"))).put(5,new ImmutableBytesWritable(Bytes.fromHex("28d961d9252ce8f8d44a07b38d3e1d96"))).put(10,new ImmutableBytesWritable(Bytes.fromHex("f6bbc4a224d8fd929b783a92599eaffa"))).put(15,new ImmutableBytesWritable(Bytes.fromHex("522deb5d97f73a414ecc11457be46881"))).put(20,new ImmutableBytesWritable(Bytes.fromHex("b026f2611aaa46f7110116d807545352"))).put(25,new ImmutableBytesWritable(Bytes.fromHex("39ffc1a3094aa12a2e90ffd9cef2ce93"))).put(30,new ImmutableBytesWritable(Bytes.fromHex("f6b4d75727ce9a30ac29e4f08f601666"))).put(35,new ImmutableBytesWritable(Bytes.fromHex("422e2d2f1eb79a8f02171a705a42c090"))).put(40,new ImmutableBytesWritable(Bytes.fromHex("559ad61c900fffefea0a15abf8a97bc3"))).put(45,new ImmutableBytesWritable(Bytes.fromHex("23019084513eca41cee436b2a29611cb"))).put(50,new ImmutableBytesWritable(Bytes.fromHex("b40467d222ddb4949b142fe145ee9edc"))).put(55,new ImmutableBytesWritable(Bytes.fromHex("372bf89fcd8ca4b7ab3c1add9d07f7e4"))).put(60,new ImmutableBytesWritable(Bytes.fromHex("69ae0585e6255de27dce974e332b8f8b"))).put(65,new ImmutableBytesWritable(Bytes.fromHex("8029610044297aad0abdbecd485d8e59"))).put(70,new ImmutableBytesWritable(Bytes.fromHex("de5f784f7f78987b6e57ecfd81c8646f"))).put(75,new ImmutableBytesWritable(Bytes.fromHex("1cd757cc4e1715c8c3b1c24447a1ec56"))).put(80,new ImmutableBytesWritable(Bytes.fromHex("f9a53aacfeb6142b08066615e7038095"))).put(85,new ImmutableBytesWritable(Bytes.fromHex("89b872b7e639df32d3276b33928c0c91"))).put(90,new ImmutableBytesWritable(Bytes.fromHex("45eeac0646d46a474ea0484175faed38"))).put(95,new ImmutableBytesWritable(Bytes.fromHex("f57c447e32a08f4bf1abb2892839ac56"))).build();
  Map<Integer,ImmutableBytesWritable> actualHashes=new HashMap<Integer,ImmutableBytesWritable>();
  Path dataDir=new Path(testDir,HashTable.HASH_DATA_DIR);
  for (int i=0; i < numHashFiles; i++) {
    Path hashPath=new Path(dataDir,HashTable.TableHash.getDataFileName(i));
    MapFile.Reader reader=new MapFile.Reader(hashPath,fs.getConf());
    ImmutableBytesWritable key=new ImmutableBytesWritable();
    ImmutableBytesWritable hash=new ImmutableBytesWritable();
    while (reader.next(key,hash)) {
      String keyString=Bytes.toHex(key.get(),key.getOffset(),key.getLength());
      LOG.debug("Key: " + (keyString.isEmpty() ? "-1" : Integer.parseInt(keyString,16)) + " Hash: "+ Bytes.toHex(hash.get(),hash.getOffset(),hash.getLength()));
      int intKey=-1;
      if (key.getLength() > 0) {
        intKey=Bytes.toInt(key.get(),key.getOffset(),key.getLength());
      }
      if (actualHashes.containsKey(intKey)) {
        Assert.fail("duplicate key in data files: " + intKey);
      }
      actualHashes.put(intKey,new ImmutableBytesWritable(hash.copyBytes()));
    }
    reader.close();
  }
  FileStatus[] files=fs.listStatus(testDir);
  for (  FileStatus file : files) {
    LOG.debug("Output file: " + file.getPath());
  }
  files=fs.listStatus(dataDir);
  for (  FileStatus file : files) {
    LOG.debug("Data file: " + file.getPath());
  }
  if (!expectedHashes.equals(actualHashes)) {
    LOG.error("Diff: " + Maps.difference(expectedHashes,actualHashes));
  }
  Assert.assertEquals(expectedHashes,actualHashes);
  TEST_UTIL.deleteTable(tableName);
  TEST_UTIL.cleanupDataTestDirOnTestFS();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles </h4><pre class="type-4 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=120000) public void testInferBoundaries(){
  TreeMap<byte[],Integer> map=new TreeMap<byte[],Integer>(Bytes.BYTES_COMPARATOR);
  String first;
  String last;
  first="a";
  last="e";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="r";
  last="s";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="o";
  last="p";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="g";
  last="k";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="v";
  last="x";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="c";
  last="i";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="m";
  last="q";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="s";
  last="t";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  first="u";
  last="w";
  addStartEndKeysForTest(map,first.getBytes(),last.getBytes());
  byte[][] keysArray=LoadIncrementalHFiles.inferBoundaries(map);
  byte[][] compare=new byte[3][];
  compare[0]="m".getBytes();
  compare[1]="r".getBytes();
  compare[2]="u".getBytes();
  assertEquals(keysArray.length,3);
  for (int row=0; row < keysArray.length; row++) {
    assertArrayEquals(keysArray[row],compare[row]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestAssignmentManagerOnCluster </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disabled region is ignored by SSH
 */
@Test(timeout=60000) public void testAssignDisabledRegionBySSH() throws Exception {
  TableName table=TableName.valueOf("testAssignDisabledRegionBySSH");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  MyMaster master;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    master=(MyMaster)cluster.getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName metaServer=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    ServerName oldServerName=null;
    while (true) {
      assertTrue(am.waitForAssignment(hri));
      RegionState state=regionStates.getRegionState(hri);
      oldServerName=state.getServerName();
      if (!ServerName.isSameHostnameAndPort(oldServerName,metaServer)) {
        MyRegionServer.abortedServer=oldServerName;
        break;
      }
      int i=cluster.getServerWithMeta();
      HRegionServer rs=cluster.getRegionServer(i == 0 ? 1 : 0);
      oldServerName=rs.getServerName();
      master.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(oldServerName.getServerName()));
    }
    assertTrue(regionStates.isRegionOnline(hri));
    assertEquals(oldServerName,regionStates.getRegionServerOfRegion(hri));
    master.disableTable(hri.getTable(),HConstants.NO_NONCE,HConstants.NO_NONCE);
    cluster.killRegionServer(oldServerName);
    cluster.waitForRegionServerToStop(oldServerName,-1);
    ServerManager serverManager=master.getServerManager();
    while (!serverManager.isServerDead(oldServerName) || serverManager.getDeadServers().areDeadServersInProgress()) {
      Thread.sleep(100);
    }
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    assertTrue(regionStates.isRegionOffline(hri));
  }
  finally {
    MyRegionServer.abortedServer=null;
    TEST_UTIL.deleteTable(table);
    cluster.startRegionServer();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests offlining a region
 */
@Test(timeout=60000) public void testOfflineRegion() throws Exception {
  TableName table=TableName.valueOf("testOfflineRegion");
  try {
    HRegionInfo hri=createTableAndGetOneRegion(table);
    RegionStates regionStates=TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates();
    ServerName serverName=regionStates.getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
    admin.offline(hri.getRegionName());
    long timeoutTime=System.currentTimeMillis() + 800;
    while (true) {
      if (regionStates.getRegionByStateOfTable(table).get(RegionState.State.OFFLINE).contains(hri))       break;
      long now=System.currentTimeMillis();
      if (now > timeoutTime) {
        fail("Failed to offline the region in time");
        break;
      }
      Thread.sleep(10);
    }
    RegionState regionState=regionStates.getRegionState(hri);
    assertTrue(regionState.isOffline());
  }
  finally {
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test force unassign/assign a region hosted on a dead server
 */
@Test(timeout=60000) public void testAssignRacingWithSSH() throws Exception {
  TableName table=TableName.valueOf("testAssignRacingWithSSH");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  MyMaster master=null;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    master=(MyMaster)cluster.getMaster();
    master.assignRegion(hri);
    master.enableSSH(false);
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName metaServer=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    while (true) {
      assertTrue(am.waitForAssignment(hri));
      RegionState state=regionStates.getRegionState(hri);
      ServerName oldServerName=state.getServerName();
      if (!ServerName.isSameHostnameAndPort(oldServerName,metaServer)) {
        cluster.killRegionServer(oldServerName);
        cluster.waitForRegionServerToStop(oldServerName,-1);
        break;
      }
      int i=cluster.getServerWithMeta();
      HRegionServer rs=cluster.getRegionServer(i == 0 ? 1 : 0);
      oldServerName=rs.getServerName();
      master.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(oldServerName.getServerName()));
    }
    am.assign(hri,true);
    RegionState state=regionStates.getRegionState(hri);
    assertTrue(state.isFailedClose());
    am.unassign(hri);
    state=regionStates.getRegionState(hri);
    assertTrue(state.isFailedClose());
    master.enableSSH(true);
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,6000);
  }
  finally {
    if (master != null) {
      master.enableSSH(true);
    }
    TEST_UTIL.deleteTable(table);
    cluster.startRegionServer();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests moving a region
 */
@Test(timeout=50000) public void testMoveRegion() throws Exception {
  TableName table=TableName.valueOf("testMoveRegion");
  try {
    HRegionInfo hri=createTableAndGetOneRegion(table);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    RegionStates regionStates=master.getAssignmentManager().getRegionStates();
    ServerName serverName=regionStates.getRegionServerOfRegion(hri);
    ServerManager serverManager=master.getServerManager();
    ServerName destServerName=null;
    List<JVMClusterUtil.RegionServerThread> regionServers=TEST_UTIL.getHBaseCluster().getLiveRegionServerThreads();
    for (    JVMClusterUtil.RegionServerThread regionServer : regionServers) {
      HRegionServer destServer=regionServer.getRegionServer();
      destServerName=destServer.getServerName();
      if (!destServerName.equals(serverName) && serverManager.isServerOnline(destServerName)) {
        break;
      }
    }
    assertTrue(destServerName != null && !destServerName.equals(serverName));
    TEST_UTIL.getHBaseAdmin().move(hri.getEncodedNameAsBytes(),Bytes.toBytes(destServerName.getServerName()));
    long timeoutTime=System.currentTimeMillis() + 30000;
    while (true) {
      ServerName sn=regionStates.getRegionServerOfRegion(hri);
      if (sn != null && sn.equals(destServerName)) {
        TEST_UTIL.assertRegionOnServer(hri,sn,200);
        break;
      }
      long now=System.currentTimeMillis();
      if (now > timeoutTime) {
        fail("Failed to move the region in time: " + regionStates.getRegionState(hri));
      }
      regionStates.waitForUpdate(50);
    }
  }
  finally {
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests region close racing with open
 */
@Test(timeout=60000) public void testOpenCloseRacing() throws Exception {
  TableName table=TableName.valueOf("testOpenCloseRacing");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    meta.close();
    MyRegionObserver.postOpenEnabled.set(true);
    MyRegionObserver.postOpenCalled=false;
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    long end=EnvironmentEdgeManager.currentTime() + 20000;
    while (!MyRegionObserver.postOpenCalled) {
      assertFalse("Timed out waiting for postOpen to be called",EnvironmentEdgeManager.currentTime() > end);
      Thread.sleep(300);
    }
    AssignmentManager am=master.getAssignmentManager();
    am.unassign(hri);
    RegionState state=am.getRegionStates().getRegionState(hri);
    ServerName oldServerName=state.getServerName();
    assertTrue(state.isOpening() && oldServerName != null);
    MyRegionObserver.postOpenEnabled.set(false);
    ServerName destServerName=null;
    int numRS=TEST_UTIL.getHBaseCluster().getLiveRegionServerThreads().size();
    for (int i=0; i < numRS; i++) {
      HRegionServer destServer=TEST_UTIL.getHBaseCluster().getRegionServer(i);
      if (!destServer.getServerName().equals(oldServerName)) {
        destServerName=destServer.getServerName();
        break;
      }
    }
    assertNotNull(destServerName);
    assertFalse("Region should be assigned on a new region server",oldServerName.equals(destServerName));
    List<HRegionInfo> regions=new ArrayList<HRegionInfo>();
    regions.add(hri);
    am.assign(destServerName,regions);
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,6000);
  }
  finally {
    MyRegionObserver.postOpenEnabled.set(false);
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test offlined region is assigned by SSH
 */
@Test(timeout=60000) public void testAssignOfflinedRegionBySSH() throws Exception {
  TableName table=TableName.valueOf("testAssignOfflinedRegionBySSH");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  MyMaster master=null;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    master=(MyMaster)cluster.getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName metaServer=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    ServerName oldServerName=null;
    while (true) {
      assertTrue(am.waitForAssignment(hri));
      RegionState state=regionStates.getRegionState(hri);
      oldServerName=state.getServerName();
      if (!ServerName.isSameHostnameAndPort(oldServerName,metaServer)) {
        MyRegionServer.abortedServer=oldServerName;
        break;
      }
      int i=cluster.getServerWithMeta();
      HRegionServer rs=cluster.getRegionServer(i == 0 ? 1 : 0);
      oldServerName=rs.getServerName();
      master.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(oldServerName.getServerName()));
    }
    assertTrue(regionStates.isRegionOnline(hri));
    assertEquals(oldServerName,regionStates.getRegionServerOfRegion(hri));
    cluster.killRegionServer(oldServerName);
    cluster.waitForRegionServerToStop(oldServerName,-1);
    ServerManager serverManager=master.getServerManager();
    while (!serverManager.isServerDead(oldServerName) || serverManager.getDeadServers().areDeadServersInProgress()) {
      Thread.sleep(100);
    }
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,200);
  }
  finally {
    MyRegionServer.abortedServer=null;
    TEST_UTIL.deleteTable(table);
    cluster.startRegionServer();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestClusterStatusPublisher </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxSend(){
  ClusterStatusPublisher csp=new ClusterStatusPublisher(){
    @Override protected List<Pair<ServerName,Long>> getDeadServers(    long since){
      List<Pair<ServerName,Long>> res=new ArrayList<Pair<ServerName,Long>>();
switch ((int)EnvironmentEdgeManager.currentTime()) {
case 2:
        res.add(new Pair<ServerName,Long>(ServerName.valueOf("hn",10,10),1L));
      break;
case 1000:
    break;
}
return res;
}
}
;
mee.setValue(2);
for (int i=0; i < ClusterStatusPublisher.NB_SEND; i++) {
Assert.assertEquals("i=" + i,1,csp.generateDeadServersListToSend().size());
}
mee.setValue(1000);
Assert.assertTrue(csp.generateDeadServersListToSend().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestHMasterRPCException </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRPCException() throws IOException, InterruptedException, KeeperException {
  ServerName sm=master.getServerName();
  boolean fakeZNodeDelete=false;
  for (int i=0; i < 20; i++) {
    try {
      BlockingRpcChannel channel=rpcClient.createBlockingRpcChannel(sm,User.getCurrent(),0);
      MasterProtos.MasterService.BlockingInterface stub=MasterProtos.MasterService.newBlockingStub(channel);
      assertTrue(stub.isMasterRunning(null,IsMasterRunningRequest.getDefaultInstance()).getIsMasterRunning());
      return;
    }
 catch (    ServiceException ex) {
      IOException ie=ProtobufUtil.getRemoteException(ex);
      assertTrue(ie.getMessage().startsWith("org.apache.hadoop.hbase.ipc.ServerNotRunningYetException: Server is not running yet"));
      LOG.info("Expected exception: ",ie);
      if (!fakeZNodeDelete) {
        testUtil.getZooKeeperWatcher().getRecoverableZooKeeper().delete(testUtil.getZooKeeperWatcher().getMasterAddressZNode(),-1);
        fakeZNodeDelete=true;
      }
    }
    Thread.sleep(1000);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterFailover </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test of master failover.
 * <p>
 * Starts with three masters.  Kills a backup master.  Then kills the active
 * master.  Ensures the final master becomes active and we can still contact
 * the cluster.
 * @throws Exception
 */
@Test(timeout=240000) public void testSimpleMasterFailover() throws Exception {
  final int NUM_MASTERS=3;
  final int NUM_RS=3;
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  List<MasterThread> masterThreads=cluster.getMasterThreads();
  for (  MasterThread mt : masterThreads) {
    assertTrue(mt.isAlive());
  }
  int numActive=0;
  int activeIndex=-1;
  ServerName activeName=null;
  HMaster active=null;
  for (int i=0; i < masterThreads.size(); i++) {
    if (masterThreads.get(i).getMaster().isActiveMaster()) {
      numActive++;
      activeIndex=i;
      active=masterThreads.get(activeIndex).getMaster();
      activeName=active.getServerName();
    }
  }
  assertEquals(1,numActive);
  assertEquals(NUM_MASTERS,masterThreads.size());
  LOG.info("Active master " + activeName);
  assertNotNull(active);
  ClusterStatus status=active.getClusterStatus();
  assertTrue(status.getMaster().equals(activeName));
  assertEquals(2,status.getBackupMastersSize());
  assertEquals(2,status.getBackupMasters().size());
  int backupIndex=(activeIndex == 0 ? 1 : activeIndex - 1);
  HMaster master=cluster.getMaster(backupIndex);
  LOG.debug("\n\nStopping a backup master: " + master.getServerName() + "\n");
  cluster.stopMaster(backupIndex,false);
  cluster.waitOnMaster(backupIndex);
  for (int i=0; i < masterThreads.size(); i++) {
    if (masterThreads.get(i).getMaster().isActiveMaster()) {
      assertTrue(activeName.equals(masterThreads.get(i).getMaster().getServerName()));
      activeIndex=i;
      active=masterThreads.get(activeIndex).getMaster();
    }
  }
  assertEquals(1,numActive);
  assertEquals(2,masterThreads.size());
  int rsCount=masterThreads.get(activeIndex).getMaster().getClusterStatus().getServersSize();
  LOG.info("Active master " + active.getServerName() + " managing "+ rsCount+ " regions servers");
  assertEquals(4,rsCount);
  assertNotNull(active);
  status=active.getClusterStatus();
  assertTrue(status.getMaster().equals(activeName));
  assertEquals(1,status.getBackupMastersSize());
  assertEquals(1,status.getBackupMasters().size());
  LOG.debug("\n\nStopping the active master " + active.getServerName() + "\n");
  cluster.stopMaster(activeIndex,false);
  cluster.waitOnMaster(activeIndex);
  assertTrue(cluster.waitForActiveAndReadyMaster());
  LOG.debug("\n\nVerifying backup master is now active\n");
  assertEquals(1,masterThreads.size());
  active=masterThreads.get(0).getMaster();
  assertNotNull(active);
  status=active.getClusterStatus();
  ServerName mastername=status.getMaster();
  assertTrue(mastername.equals(active.getServerName()));
  assertTrue(active.isActiveMaster());
  assertEquals(0,status.getBackupMastersSize());
  assertEquals(0,status.getBackupMasters().size());
  int rss=status.getServersSize();
  LOG.info("Active master " + mastername.getServerName() + " managing "+ rss+ " region servers");
  assertEquals(4,rss);
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestRestartCluster </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests retaining assignments on a cluster restart
 */
@Test(timeout=300000) public void testRetainAssignmentOnRestart() throws Exception {
  UTIL.startMiniCluster(2);
  while (!UTIL.getMiniHBaseCluster().getMaster().isInitialized()) {
    Threads.sleep(1);
  }
  UTIL.getMiniHBaseCluster().getMaster().getMasterRpcServices().synchronousBalanceSwitch(false);
  LOG.info("\n\nCreating tables");
  for (  TableName TABLE : TABLES) {
    UTIL.createTable(TABLE,FAMILY);
  }
  for (  TableName TABLE : TABLES) {
    UTIL.waitTableEnabled(TABLE);
  }
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  UTIL.waitUntilNoRegionsInTransition(120000);
  SnapshotOfRegionAssignmentFromMeta snapshot=new SnapshotOfRegionAssignmentFromMeta(master.getConnection());
  snapshot.initialize();
  Map<HRegionInfo,ServerName> regionToRegionServerMap=snapshot.getRegionToRegionServerMap();
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  List<JVMClusterUtil.RegionServerThread> threads=cluster.getLiveRegionServerThreads();
  assertEquals(2,threads.size());
  int[] rsPorts=new int[3];
  for (int i=0; i < 2; i++) {
    rsPorts[i]=threads.get(i).getRegionServer().getServerName().getPort();
  }
  rsPorts[2]=cluster.getMaster().getServerName().getPort();
  for (  ServerName serverName : regionToRegionServerMap.values()) {
    boolean found=false;
    for (int k=0; k < 3 && !found; k++) {
      found=serverName.getPort() == rsPorts[k];
    }
    assertTrue(found);
  }
  LOG.info("\n\nShutting down HBase cluster");
  cluster.shutdown();
  cluster.waitUntilShutDown();
  LOG.info("\n\nSleeping a bit");
  Thread.sleep(2000);
  LOG.info("\n\nStarting cluster the second time with the same ports");
  try {
    cluster.getConf().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,4);
    master=cluster.startMaster().getMaster();
    for (int i=0; i < 3; i++) {
      cluster.getConf().setInt(HConstants.REGIONSERVER_PORT,rsPorts[i]);
      cluster.startRegionServer();
    }
  }
  finally {
    cluster.getConf().setInt(HConstants.REGIONSERVER_PORT,0);
    cluster.getConf().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,2);
  }
  List<ServerName> localServers=master.getServerManager().getOnlineServersList();
  assertEquals(4,localServers.size());
  for (int i=0; i < 3; i++) {
    boolean found=false;
    for (    ServerName serverName : localServers) {
      if (serverName.getPort() == rsPorts[i]) {
        found=true;
        break;
      }
    }
    assertTrue(found);
  }
  RegionStates regionStates=master.getAssignmentManager().getRegionStates();
  int expectedRegions=regionToRegionServerMap.size() + 1;
  while (!master.isInitialized() || regionStates.getRegionAssignments().size() != expectedRegions) {
    Threads.sleep(100);
  }
  snapshot=new SnapshotOfRegionAssignmentFromMeta(master.getConnection());
  snapshot.initialize();
  Map<HRegionInfo,ServerName> newRegionToRegionServerMap=snapshot.getRegionToRegionServerMap();
  assertEquals(regionToRegionServerMap.size(),newRegionToRegionServerMap.size());
  for (  Map.Entry<HRegionInfo,ServerName> entry : newRegionToRegionServerMap.entrySet()) {
    if (TableName.NAMESPACE_TABLE_NAME.equals(entry.getKey().getTable()))     continue;
    ServerName oldServer=regionToRegionServerMap.get(entry.getKey());
    ServerName currentServer=entry.getValue();
    assertEquals(oldServer.getHostAndPort(),currentServer.getHostAndPort());
    assertNotEquals(oldServer.getStartcode(),currentServer.getStartcode());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestTableLockManager </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=600000) public void testTableReadLock() throws Exception {
  prepareMiniCluster();
  LoadTestTool loadTool=new LoadTestTool();
  loadTool.setConf(TEST_UTIL.getConfiguration());
  int numKeys=10000;
  final TableName tableName=TableName.valueOf("testTableReadLock");
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  final byte[] family=Bytes.toBytes("test_cf");
  desc.addFamily(new HColumnDescriptor(family));
  admin.createTable(desc);
  int ret=loadTool.run(new String[]{"-tn",tableName.getNameAsString(),"-write",String.format("%d:%d:%d",1,10,10),"-num_keys",String.valueOf(numKeys),"-skip_init"});
  if (0 != ret) {
    String errorMsg="Load failed with error code " + ret;
    LOG.error(errorMsg);
    fail(errorMsg);
  }
  int familyValues=admin.getTableDescriptor(tableName).getFamily(family).getValues().size();
  StoppableImplementation stopper=new StoppableImplementation();
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  ScheduledChore alterThread=new ScheduledChore("Alter Chore",stopper,10000){
    @Override protected void chore(){
      Random random=new Random();
      try {
        HTableDescriptor htd=admin.getTableDescriptor(tableName);
        String val=String.valueOf(random.nextInt());
        htd.getFamily(family).setValue(val,val);
        desc.getFamily(family).setValue(val,val);
        admin.modifyTable(tableName,htd);
      }
 catch (      Exception ex) {
        LOG.warn("Caught exception",ex);
        fail(ex.getMessage());
      }
    }
  }
;
  ScheduledChore splitThread=new ScheduledChore("Split thread",stopper,5000){
    @Override public void chore(){
      try {
        HRegion region=TEST_UTIL.getSplittableRegion(tableName,-1);
        if (region != null) {
          byte[] regionName=region.getRegionInfo().getRegionName();
          admin.flushRegion(regionName);
          admin.compactRegion(regionName);
          admin.splitRegion(regionName);
        }
 else {
          LOG.warn("Could not find suitable region for the table.  Possibly the " + "region got closed and the attempts got over before " + "the region could have got reassigned.");
        }
      }
 catch (      NotServingRegionException nsre) {
        LOG.warn("Caught exception",nsre);
      }
catch (      Exception ex) {
        LOG.warn("Caught exception",ex);
        fail(ex.getMessage());
      }
    }
  }
;
  choreService.scheduleChore(alterThread);
  choreService.scheduleChore(splitThread);
  TEST_UTIL.waitTableEnabled(tableName);
  while (true) {
    List<HRegionInfo> regions=admin.getTableRegions(tableName);
    LOG.info(String.format("Table #regions: %d regions: %s:",regions.size(),regions));
    assertEquals(admin.getTableDescriptor(tableName),desc);
    for (    HRegion region : TEST_UTIL.getMiniHBaseCluster().getRegions(tableName)) {
      HTableDescriptor regionTableDesc=region.getTableDesc();
      assertEquals(desc,regionTableDesc);
    }
    if (regions.size() >= 5) {
      break;
    }
    Threads.sleep(1000);
  }
  stopper.stop("test finished");
  int newFamilyValues=admin.getTableDescriptor(tableName).getFamily(family).getValues().size();
  LOG.info(String.format("Altered the table %d times",newFamilyValues - familyValues));
  assertTrue(newFamilyValues > familyValues);
  ret=loadTool.run(new String[]{"-tn",tableName.getNameAsString(),"-read","100:10","-num_keys",String.valueOf(numKeys),"-skip_init"});
  if (0 != ret) {
    String errorMsg="Verify failed with error code " + ret;
    LOG.error(errorMsg);
    fail(errorMsg);
  }
  admin.close();
  choreService.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestRegionLocationFinder </h4><pre class="type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInternalGetTopBlockLocation() throws Exception {
  for (int i=0; i < ServerNum; i++) {
    HRegionServer server=cluster.getRegionServer(i);
    for (    Region region : server.getOnlineRegions(tableName)) {
      HDFSBlocksDistribution blocksDistribution1=region.getHDFSBlocksDistribution();
      HDFSBlocksDistribution blocksDistribution2=finder.getBlockDistribution(region.getRegionInfo());
      assertEquals(blocksDistribution1.getUniqueBlocksTotalWeight(),blocksDistribution2.getUniqueBlocksTotalWeight());
      if (blocksDistribution1.getUniqueBlocksTotalWeight() != 0) {
        assertEquals(blocksDistribution1.getTopHosts().get(0),blocksDistribution2.getTopHosts().get(0));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetTopBlockLocations() throws Exception {
  for (int i=0; i < ServerNum; i++) {
    HRegionServer server=cluster.getRegionServer(i);
    for (    Region region : server.getOnlineRegions(tableName)) {
      List<ServerName> servers=finder.getTopBlockLocations(region.getRegionInfo());
      if (region.getHDFSBlocksDistribution().getUniqueBlocksTotalWeight() == 0) {
        continue;
      }
      List<String> topHosts=region.getHDFSBlocksDistribution().getTopHosts();
      if (!topHosts.contains(server.getServerName().getHostname())) {
        continue;
      }
      for (int j=0; j < ServerNum; j++) {
        ServerName serverName=cluster.getRegionServer(j).getServerName();
        assertTrue(servers.contains(serverName));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapHostNameToServerName() throws Exception {
  List<String> topHosts=new ArrayList<String>();
  for (int i=0; i < ServerNum; i++) {
    HRegionServer server=cluster.getRegionServer(i);
    String serverHost=server.getServerName().getHostname();
    if (!topHosts.contains(serverHost)) {
      topHosts.add(serverHost);
    }
  }
  List<ServerName> servers=finder.mapHostNameToServerName(topHosts);
  assertEquals(1,topHosts.size());
  for (int i=0; i < ServerNum; i++) {
    ServerName server=cluster.getRegionServer(i).getServerName();
    assertTrue(servers.contains(server));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeepRegionLoad() throws Exception {
  ServerName sn=ServerName.valueOf("test:8080",100);
  int numClusterStatusToAdd=20000;
  for (int i=0; i < numClusterStatusToAdd; i++) {
    ServerLoad sl=mock(ServerLoad.class);
    RegionLoad rl=mock(RegionLoad.class);
    when(rl.getStores()).thenReturn(i);
    Map<byte[],RegionLoad> regionLoadMap=new TreeMap<byte[],RegionLoad>(Bytes.BYTES_COMPARATOR);
    regionLoadMap.put(Bytes.toBytes(REGION_KEY),rl);
    when(sl.getRegionsLoad()).thenReturn(regionLoadMap);
    ClusterStatus clusterStatus=mock(ClusterStatus.class);
    when(clusterStatus.getServers()).thenReturn(Arrays.asList(sn));
    when(clusterStatus.getLoad(sn)).thenReturn(sl);
    loadBalancer.setClusterStatus(clusterStatus);
  }
  assertTrue(loadBalancer.loads.get(REGION_KEY) != null);
  assertTrue(loadBalancer.loads.get(REGION_KEY).size() == 15);
  Queue<RegionLoad> loads=loadBalancer.loads.get(REGION_KEY);
  int i=0;
  while (loads.size() > 0) {
    RegionLoad rl=loads.remove();
    assertEquals(i + (numClusterStatusToAdd - 15),rl.getStores());
    i++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.handler.TestTableDeleteFamilyHandler </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteColumnFamilyTwice() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor beforehtd=admin.getTableDescriptor(TABLENAME);
  String cfToDelete="cf1";
  FileSystem fs=TEST_UTIL.getDFSCluster().getFileSystem();
  assertTrue(admin.isTableAvailable(TABLENAME));
  HColumnDescriptor[] families=beforehtd.getColumnFamilies();
  Boolean foundCF=false;
  int i;
  for (i=0; i < families.length; i++) {
    if (families[i].getNameAsString().equals(cfToDelete)) {
      foundCF=true;
      break;
    }
  }
  assertTrue(foundCF);
  Path tableDir=FSUtils.getTableDir(TEST_UTIL.getDefaultRootDirPath(),TABLENAME);
  assertTrue(fs.exists(tableDir));
  FileStatus[] fileStatus=fs.listStatus(tableDir);
  foundCF=false;
  for (i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (p.getName().contains(HConstants.RECOVERED_EDITS_DIR)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true && cf[j].getPath().getName().equals(cfToDelete)) {
          foundCF=true;
          break;
        }
      }
    }
    if (foundCF) {
      break;
    }
  }
  assertTrue(foundCF);
  if (admin.isTableEnabled(TABLENAME)) {
    admin.disableTable(TABLENAME);
  }
  admin.deleteColumnFamily(TABLENAME,Bytes.toBytes(cfToDelete));
  fileStatus=fs.listStatus(tableDir);
  for (i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (WALSplitter.isSequenceIdFile(p)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true) {
          assertFalse(cf[j].getPath().getName().equals(cfToDelete));
        }
      }
    }
  }
  try {
    admin.deleteColumnFamily(TABLENAME,Bytes.toBytes(cfToDelete));
    Assert.fail("Delete a non-exist column family should fail");
  }
 catch (  InvalidFamilyOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteColumnFamilyWithMultipleRegions() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor beforehtd=admin.getTableDescriptor(TABLENAME);
  FileSystem fs=TEST_UTIL.getDFSCluster().getFileSystem();
  assertTrue(admin.isTableAvailable(TABLENAME));
  assertEquals(3,beforehtd.getColumnFamilies().length);
  HColumnDescriptor[] families=beforehtd.getColumnFamilies();
  for (int i=0; i < families.length; i++) {
    assertTrue(families[i].getNameAsString().equals("cf" + (i + 1)));
  }
  Path tableDir=FSUtils.getTableDir(TEST_UTIL.getDefaultRootDirPath(),TABLENAME);
  assertTrue(fs.exists(tableDir));
  FileStatus[] fileStatus=fs.listStatus(tableDir);
  for (int i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (p.getName().contains(HConstants.RECOVERED_EDITS_DIR)) {
            return false;
          }
          return true;
        }
      }
);
      int k=1;
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true && cf[j].getPath().getName().startsWith(".") == false) {
          assertEquals(cf[j].getPath().getName(),"cf" + k);
          k++;
        }
      }
    }
  }
  admin.disableTable(TABLENAME);
  admin.deleteColumnFamily(TABLENAME,Bytes.toBytes("cf2"));
  HTableDescriptor afterhtd=admin.getTableDescriptor(TABLENAME);
  assertEquals(2,afterhtd.getColumnFamilies().length);
  HColumnDescriptor[] newFamilies=afterhtd.getColumnFamilies();
  assertTrue(newFamilies[0].getNameAsString().equals("cf1"));
  assertTrue(newFamilies[1].getNameAsString().equals("cf3"));
  fileStatus=fs.listStatus(tableDir);
  for (int i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (WALSplitter.isSequenceIdFile(p)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true) {
          assertFalse(cf[j].getPath().getName().equals("cf2"));
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestMasterProcedureEvents </h4><pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMasterInitializedEvent() throws Exception {
  TableName tableName=TableName.valueOf("testMasterInitializedEvent");
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  ProcedureExecutor<MasterProcedureEnv> procExec=master.getMasterProcedureExecutor();
  MasterProcedureScheduler procSched=procExec.getEnvironment().getProcedureQueue();
  HRegionInfo hri=new HRegionInfo(tableName);
  HTableDescriptor htd=new HTableDescriptor(tableName);
  HColumnDescriptor hcd=new HColumnDescriptor("f");
  htd.addFamily(hcd);
  while (!master.isInitialized())   Thread.sleep(250);
  master.setInitialized(false);
  CreateTableProcedure proc=new CreateTableProcedure(procExec.getEnvironment(),htd,new HRegionInfo[]{hri});
  long pollCalls=procSched.getPollCalls();
  long nullPollCalls=procSched.getNullPollCalls();
  long procId=procExec.submitProcedure(proc,HConstants.NO_NONCE,HConstants.NO_NONCE);
  for (int i=0; i < 10; ++i) {
    Thread.sleep(100);
    assertEquals(pollCalls + 1,procSched.getPollCalls());
    assertEquals(nullPollCalls,procSched.getNullPollCalls());
  }
  master.setInitialized(true);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  assertEquals(pollCalls + 2,procSched.getPollCalls());
  assertEquals(nullPollCalls,procSched.getNullPollCalls());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerCrashProcedureEvent() throws Exception {
  TableName tableName=TableName.valueOf("testServerCrashProcedureEventTb");
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  ProcedureExecutor<MasterProcedureEnv> procExec=master.getMasterProcedureExecutor();
  MasterProcedureScheduler procSched=procExec.getEnvironment().getProcedureQueue();
  while (!master.isServerCrashProcessingEnabled() || !master.isInitialized() || master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(25);
  }
  UTIL.createTable(tableName,HBaseTestingUtility.COLUMNS[0]);
  try (Table t=UTIL.getConnection().getTable(tableName)){
    UTIL.loadTable(t,HBaseTestingUtility.COLUMNS[0]);
  }
   master.setServerCrashProcessingEnabled(false);
  long pollCalls=procSched.getPollCalls();
  long nullPollCalls=procSched.getNullPollCalls();
  HRegionServer hrs=getServerWithRegions();
  boolean carryingMeta=master.getAssignmentManager().isCarryingMeta(hrs.getServerName());
  UTIL.getHBaseCluster().killRegionServer(hrs.getServerName());
  hrs.join();
  while (!master.getServerManager().isServerDead(hrs.getServerName()))   Thread.sleep(10);
  master.getServerManager().moveFromOnelineToDeadServers(hrs.getServerName());
  long procId=procExec.submitProcedure(new ServerCrashProcedure(hrs.getServerName(),true,carryingMeta));
  for (int i=0; i < 10; ++i) {
    Thread.sleep(100);
    assertEquals(pollCalls + 1,procSched.getPollCalls());
    assertEquals(nullPollCalls,procSched.getNullPollCalls());
  }
  master.setServerCrashProcessingEnabled(true);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  LOG.debug("server crash processing poll calls: " + procSched.getPollCalls());
  assertTrue(procSched.getPollCalls() >= (pollCalls + 2));
  assertEquals(nullPollCalls,procSched.getNullPollCalls());
  UTIL.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestMasterProcedureScheduler </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the table queue is not deletable until every procedure
 * in-progress is completed (this is a special case for read-locks).
 */
@Test public void testCreateDeleteTableOperationsWithReadLock() throws Exception {
  final TableName tableName=TableName.valueOf("testtb");
  final int nitems=2;
  for (int i=1; i <= nitems; ++i) {
    queue.addBack(new TestTableProcedure(i,tableName,TableProcedureInterface.TableOperationType.READ));
  }
  assertFalse(queue.markTableAsDeleted(tableName));
  Procedure[] procs=new Procedure[nitems];
  for (int i=0; i < nitems; ++i) {
    Procedure proc=procs[i]=queue.poll();
    assertEquals(i + 1,proc.getProcId());
    assertTrue(queue.tryAcquireTableSharedLock(proc,tableName));
    assertFalse(queue.markTableAsDeleted(tableName));
  }
  for (int i=0; i < nitems; ++i) {
    assertFalse(queue.markTableAsDeleted(tableName));
    queue.releaseTableSharedLock(procs[i],tableName);
  }
  assertEquals(0,queue.size());
  assertTrue(queue.markTableAsDeleted(tableName));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify simple create/insert/fetch/delete of the table queue.
 */
@Test public void testSimpleTableOpsQueues() throws Exception {
  final int NUM_TABLES=10;
  final int NUM_ITEMS=10;
  int count=0;
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("test-%04d",i));
    for (int j=1; j <= NUM_ITEMS; ++j) {
      queue.addBack(new TestTableProcedure(i * 1000 + j,tableName,TableProcedureInterface.TableOperationType.EDIT));
      assertEquals(++count,queue.size());
    }
  }
  assertEquals(NUM_TABLES * NUM_ITEMS,queue.size());
  for (int j=1; j <= NUM_ITEMS; ++j) {
    for (int i=1; i <= NUM_TABLES; ++i) {
      Procedure proc=queue.poll();
      assertTrue(proc != null);
      TableName tableName=((TestTableProcedure)proc).getTableName();
      queue.tryAcquireTableExclusiveLock(proc,tableName);
      queue.releaseTableExclusiveLock(proc,tableName);
      queue.completionCleanup(proc);
      assertEquals(--count,queue.size());
      assertEquals(i * 1000 + j,proc.getProcId());
    }
  }
  assertEquals(0,queue.size());
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("test-%04d",i));
    assertTrue(queue.markTableAsDeleted(tableName));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that "write" operations for a single table are serialized,
 * but different tables can be executed in parallel.
 */
@Test(timeout=90000) public void testConcurrentWriteOps() throws Exception {
  final TestTableProcSet procSet=new TestTableProcSet(queue);
  final int NUM_ITEMS=10;
  final int NUM_TABLES=4;
  final AtomicInteger opsCount=new AtomicInteger(0);
  for (int i=0; i < NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("testtb-%04d",i));
    for (int j=1; j < NUM_ITEMS; ++j) {
      procSet.addBack(new TestTableProcedure(i * 100 + j,tableName,TableProcedureInterface.TableOperationType.EDIT));
      opsCount.incrementAndGet();
    }
  }
  assertEquals(opsCount.get(),queue.size());
  final Thread[] threads=new Thread[NUM_TABLES * 2];
  final HashSet<TableName> concurrentTables=new HashSet<TableName>();
  final ArrayList<String> failures=new ArrayList<String>();
  final AtomicInteger concurrentCount=new AtomicInteger(0);
  for (int i=0; i < threads.length; ++i) {
    threads[i]=new Thread(){
      @Override public void run(){
        while (opsCount.get() > 0) {
          try {
            Procedure proc=procSet.acquire();
            if (proc == null) {
              queue.signalAll();
              if (opsCount.get() > 0) {
                continue;
              }
              break;
            }
            TableName tableId=procSet.getTableName(proc);
synchronized (concurrentTables) {
              assertTrue("unexpected concurrency on " + tableId,concurrentTables.add(tableId));
            }
            assertTrue(opsCount.decrementAndGet() >= 0);
            try {
              long procId=proc.getProcId();
              int concurrent=concurrentCount.incrementAndGet();
              assertTrue("inc-concurrent=" + concurrent + " 1 <= concurrent <= "+ NUM_TABLES,concurrent >= 1 && concurrent <= NUM_TABLES);
              LOG.debug("[S] tableId=" + tableId + " procId="+ procId+ " concurrent="+ concurrent);
              Thread.sleep(2000);
              concurrent=concurrentCount.decrementAndGet();
              LOG.debug("[E] tableId=" + tableId + " procId="+ procId+ " concurrent="+ concurrent);
              assertTrue("dec-concurrent=" + concurrent,concurrent < NUM_TABLES);
            }
  finally {
synchronized (concurrentTables) {
                assertTrue(concurrentTables.remove(tableId));
              }
              procSet.release(proc);
            }
          }
 catch (          Throwable e) {
            LOG.error("Failed " + e.getMessage(),e);
synchronized (failures) {
              failures.add(e.getMessage());
            }
          }
 finally {
            queue.signalAll();
          }
        }
      }
    }
;
    threads[i].start();
  }
  for (int i=0; i < threads.length; ++i) {
    threads[i].join();
  }
  assertTrue(failures.toString(),failures.isEmpty());
  assertEquals(0,opsCount.get());
  assertEquals(0,queue.size());
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName table=TableName.valueOf(String.format("testtb-%04d",i));
    assertTrue("queue should be deleted, table=" + table,queue.markTableAsDeleted(table));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS </h4><pre class="type-9 type-11 type-7 type-8 type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000,expected=RuntimeException.class) public void testWalAbortOnLowReplication() throws Exception {
  initConfig(UTIL.getConfiguration());
  setup();
  try {
    assertEquals(3,UTIL.getDFSCluster().getDataNodes().size());
    LOG.info("Stop DataNode");
    UTIL.getDFSCluster().stopDataNode(0);
    assertEquals(2,UTIL.getDFSCluster().getDataNodes().size());
    store.insert(new TestProcedure(1,-1),null);
    for (long i=2; store.isRunning(); ++i) {
      assertEquals(2,UTIL.getDFSCluster().getDataNodes().size());
      store.insert(new TestProcedure(i,-1),null);
      Thread.sleep(100);
    }
    assertFalse(store.isRunning());
    fail("The store.insert() should throw an exeption");
  }
  finally {
    tearDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestYieldProcedures </h4><pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYieldEachExecutionStep() throws Exception {
  final int NUM_STATES=3;
  TestStateMachineProcedure[] procs=new TestStateMachineProcedure[3];
  for (int i=0; i < procs.length; ++i) {
    procs[i]=new TestStateMachineProcedure(true,false);
    procExecutor.submitProcedure(procs[i]);
  }
  ProcedureTestingUtility.waitNoProcedureRunning(procExecutor);
  long prevTimestamp=0;
  for (int execStep=0; execStep < NUM_STATES; ++execStep) {
    for (int i=0; i < procs.length; ++i) {
      assertEquals(NUM_STATES * 2,procs[i].getExecutionInfo().size());
      TestStateMachineProcedure.ExecutionInfo info=procs[i].getExecutionInfo().get(execStep);
      LOG.info("i=" + i + " execStep="+ execStep+ " timestamp="+ info.getTimestamp());
      assertEquals(false,info.isRollback());
      assertEquals(execStep,info.getStep().ordinal());
      assertEquals(prevTimestamp + 1,info.getTimestamp());
      prevTimestamp++;
    }
  }
  int count=NUM_STATES;
  for (int execStep=NUM_STATES - 1; execStep >= 0; --execStep) {
    for (int i=0; i < procs.length; ++i) {
      assertEquals(NUM_STATES * 2,procs[i].getExecutionInfo().size());
      TestStateMachineProcedure.ExecutionInfo info=procs[i].getExecutionInfo().get(count);
      LOG.info("i=" + i + " execStep="+ execStep+ " timestamp="+ info.getTimestamp());
      assertEquals(true,info.isRollback());
      assertEquals(execStep,info.getStep().ordinal());
      assertEquals(prevTimestamp + 1,info.getTimestamp());
      prevTimestamp++;
    }
    count++;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYieldOnInterrupt() throws Exception {
  final int NUM_STATES=3;
  int count=0;
  TestStateMachineProcedure proc=new TestStateMachineProcedure(true,true);
  ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  assertEquals(NUM_STATES * 4,proc.getExecutionInfo().size());
  for (int i=0; i < NUM_STATES; ++i) {
    TestStateMachineProcedure.ExecutionInfo info=proc.getExecutionInfo().get(count++);
    assertEquals(false,info.isRollback());
    assertEquals(i,info.getStep().ordinal());
    info=proc.getExecutionInfo().get(count++);
    assertEquals(false,info.isRollback());
    assertEquals(i,info.getStep().ordinal());
  }
  for (int i=NUM_STATES - 1; i >= 0; --i) {
    TestStateMachineProcedure.ExecutionInfo info=proc.getExecutionInfo().get(count++);
    assertEquals(true,info.isRollback());
    assertEquals(i,info.getStep().ordinal());
    info=proc.getExecutionInfo().get(count++);
    assertEquals(true,info.isRollback());
    assertEquals(i,info.getStep().ordinal());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.store.TestProcedureStoreTracker </h4><pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testLoad(){
  final int MAX_PROCS=1000;
  final ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  for (int numProcs=1; numProcs < MAX_PROCS; ++numProcs) {
    for (int start=1; start <= numProcs; ++start) {
      assertTrue(tracker.isEmpty());
      LOG.debug("loading " + numProcs + " procs from start="+ start);
      for (int i=start; i <= numProcs; ++i) {
        tracker.setDeleted(i,false);
      }
      for (int i=1; i < start; ++i) {
        tracker.setDeleted(i,false);
      }
      tracker.reset();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTracking(){
  long[][] procIds=new long[][]{{4,7},{1024,1027},{8192,8194}};
  long[][] checkIds=new long[][]{{2,8},{1023,1025},{8193,8191}};
  ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  for (int i=0; i < procIds.length; ++i) {
    long[] seq=procIds[i];
    tracker.insert(seq[0]);
    tracker.insert(seq[1]);
  }
  for (int i=0; i < procIds.length; ++i) {
    long[] check=checkIds[i];
    long[] seq=procIds[i];
    assertTrue(tracker.isTracking(seq[0],seq[1]));
    assertTrue(tracker.isTracking(check[0],check[1]));
    tracker.delete(seq[0]);
    tracker.delete(seq[1]);
    assertFalse(tracker.isTracking(seq[0],seq[1]));
    assertFalse(tracker.isTracking(check[0],check[1]));
  }
  assertTrue(tracker.isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDelete(){
  final ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  long[] procIds=new long[]{65,1,193};
  for (int i=0; i < procIds.length; ++i) {
    tracker.insert(procIds[i]);
    tracker.dump();
  }
  for (int i=0; i < (64 * 4); ++i) {
    boolean hasProc=false;
    for (int j=0; j < procIds.length; ++j) {
      if (procIds[j] == i) {
        hasProc=true;
        break;
      }
    }
    if (hasProc) {
      assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(i));
    }
 else {
      assertEquals("procId=" + i,ProcedureStoreTracker.DeleteState.YES,tracker.isDeleted(i));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testRandLoad(){
  final int NPROCEDURES=2500;
  final int NRUNS=5000;
  final ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  Random rand=new Random(1);
  for (int i=0; i < NRUNS; ++i) {
    assertTrue(tracker.isEmpty());
    int count=0;
    while (count < NPROCEDURES) {
      long procId=rand.nextLong();
      if (procId < 1)       continue;
      tracker.setDeleted(procId,i % 2 == 0);
      count++;
    }
    tracker.reset();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSeqInsertAndDelete(){
  ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  assertTrue(tracker.isEmpty());
  final int MIN_PROC=1;
  final int MAX_PROC=1 << 10;
  for (int i=MIN_PROC; i < MAX_PROC; ++i) {
    tracker.insert(i);
    for (int j=MIN_PROC; j <= i; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(j));
    }
    for (int j=i + 1; j < MAX_PROC; ++j) {
      assertTrue(tracker.isDeleted(j) != ProcedureStoreTracker.DeleteState.NO);
    }
  }
  for (int i=MIN_PROC; i < MAX_PROC; ++i) {
    tracker.delete(i);
    for (int j=MIN_PROC; j <= i; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.YES,tracker.isDeleted(j));
    }
    for (int j=i + 1; j < MAX_PROC; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(j));
    }
  }
  assertTrue(tracker.isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBasicCRUD(){
  ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  assertTrue(tracker.isEmpty());
  long[] procs=new long[]{1,2,3,4,5,6};
  tracker.insert(procs[0]);
  tracker.insert(procs[1],new long[]{procs[2],procs[3],procs[4]});
  assertFalse(tracker.isEmpty());
  assertTrue(tracker.isUpdated());
  tracker.resetUpdates();
  assertFalse(tracker.isUpdated());
  for (int i=0; i < 4; ++i) {
    tracker.update(procs[i]);
    assertFalse(tracker.isEmpty());
    assertFalse(tracker.isUpdated());
  }
  tracker.update(procs[4]);
  assertFalse(tracker.isEmpty());
  assertTrue(tracker.isUpdated());
  tracker.update(procs[5]);
  assertFalse(tracker.isEmpty());
  assertTrue(tracker.isUpdated());
  for (int i=0; i < 5; ++i) {
    tracker.delete(procs[i]);
    assertFalse(tracker.isEmpty());
    assertTrue(tracker.isUpdated());
  }
  tracker.delete(procs[5]);
  assertTrue(tracker.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.util.TestTimeoutBlockingQueue </h4><pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOrder(){
  TimeoutBlockingQueue<TestObject> queue=new TimeoutBlockingQueue<TestObject>(8,new TestObjectTimeoutRetriever());
  long[] timeouts=new long[]{500,200,700,300,600,600,200,800,500};
  for (int i=0; i < timeouts.length; ++i) {
    for (int j=0; j <= i; ++j) {
      queue.add(new TestObject(j,timeouts[j]));
      queue.dump();
    }
    long prev=0;
    for (int j=0; j <= i; ++j) {
      TestObject obj=queue.poll();
      assertTrue(obj.getTimeout() >= prev);
      prev=obj.getTimeout();
      queue.dump();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeoutBlockingQueue(){
  TimeoutBlockingQueue<TestObject> queue;
  int[][] testArray=new int[][]{{200,400,600},{200,400,100},{200,400,300}};
  for (int i=0; i < testArray.length; ++i) {
    int[] sortedArray=Arrays.copyOf(testArray[i],testArray[i].length);
    Arrays.sort(sortedArray);
    queue=new TimeoutBlockingQueue<TestObject>(2,new TestObjectTimeoutRetriever());
    for (int j=0; j < testArray[i].length; ++j) {
      queue.add(new TestObject(j,testArray[i][j]));
      queue.dump();
    }
    for (int j=0; !queue.isEmpty(); ++j) {
      assertEquals(sortedArray[j],queue.poll().getTimeout());
    }
    queue=new TimeoutBlockingQueue<TestObject>(2,new TestObjectTimeoutRetriever());
    queue.add(new TestObject(0,50));
    assertEquals(50,queue.poll().getTimeout());
    for (int j=0; j < testArray[i].length; ++j) {
      queue.add(new TestObject(j,testArray[i][j]));
      queue.dump();
    }
    for (int j=0; !queue.isEmpty(); ++j) {
      assertEquals(sortedArray[j],queue.poll().getTimeout());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestRateLimiter </h4><pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLimiterBySmallerRate() throws InterruptedException {
  RateLimiter limiter=new FixedIntervalRateLimiter();
  limiter.set(10,TimeUnit.SECONDS);
  int count=0;
  while ((count++) < 10) {
    limiter.setNextRefillTime(limiter.getNextRefillTime() - 500);
    for (int i=0; i < 3; i++) {
      assertEquals(true,limiter.canExecute());
      limiter.consume();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestAtomicOperation </h4><pre class="type-9 type-10 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test multi-threaded row mutations.
 */
@Test public void testRowMutationMultiThreads() throws IOException {
  LOG.info("Starting test testRowMutationMultiThreads");
  initHRegion(tableName,name.getMethodName(),fam1);
  int numThreads=10;
  int opsPerThread=250;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  AtomicLong timeStamps=new AtomicLong(0);
  AtomicInteger failures=new AtomicInteger(0);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,timeStamps,failures){
      @Override public void run(){
        boolean op=true;
        for (int i=0; i < numOps; i++) {
          try {
            if (i % 10 == 0) {
synchronized (region) {
                LOG.debug("flushing");
                region.flush(true);
                if (i % 100 == 0) {
                  region.compact(false);
                }
              }
            }
            long ts=timeStamps.incrementAndGet();
            RowMutations rm=new RowMutations(row);
            if (op) {
              Put p=new Put(row,ts);
              p.addColumn(fam1,qual1,value1);
              p.setDurability(Durability.ASYNC_WAL);
              rm.add(p);
              Delete d=new Delete(row);
              d.addColumns(fam1,qual2,ts);
              d.setDurability(Durability.ASYNC_WAL);
              rm.add(d);
            }
 else {
              Delete d=new Delete(row);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              rm.add(d);
              Put p=new Put(row,ts);
              p.addColumn(fam1,qual2,value2);
              p.setDurability(Durability.ASYNC_WAL);
              rm.add(p);
            }
            region.mutateRow(rm);
            op^=true;
            Get g=new Get(row);
            Result r=region.get(g);
            if (r.size() != 1) {
              LOG.debug(r);
              failures.incrementAndGet();
              fail();
            }
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendMultiThreads() throws IOException {
  LOG.info("Starting test testAppendMultiThreads");
  initHRegion(tableName,name.getMethodName(),new int[]{1,3},fam1,fam2);
  int numThreads=100;
  int opsPerThread=100;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  final byte[] val=new byte[]{1};
  AtomicInteger failures=new AtomicInteger(0);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,null,failures){
      @Override public void run(){
        for (int i=0; i < numOps; i++) {
          try {
            Append a=new Append(row);
            a.add(fam1,qual1,val);
            a.add(fam1,qual2,val);
            a.add(fam2,qual3,val);
            a.setDurability(Durability.ASYNC_WAL);
            region.append(a,HConstants.NO_NONCE,HConstants.NO_NONCE);
            Get g=new Get(row);
            Result result=region.get(g);
            assertEquals(result.getValue(fam1,qual1).length,result.getValue(fam1,qual2).length);
            assertEquals(result.getValue(fam1,qual1).length,result.getValue(fam2,qual3).length);
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
  Get g=new Get(row);
  Result result=region.get(g);
  assertEquals(result.getValue(fam1,qual1).length,10000);
  assertEquals(result.getValue(fam1,qual2).length,10000);
  assertEquals(result.getValue(fam2,qual3).length,10000);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test multi-threaded region mutations.
 */
@Test public void testMultiRowMutationMultiThreads() throws IOException {
  LOG.info("Starting test testMultiRowMutationMultiThreads");
  initHRegion(tableName,name.getMethodName(),fam1);
  int numThreads=10;
  int opsPerThread=250;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  AtomicLong timeStamps=new AtomicLong(0);
  AtomicInteger failures=new AtomicInteger(0);
  final List<byte[]> rowsToLock=Arrays.asList(row,row2);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,timeStamps,failures){
      @Override public void run(){
        boolean op=true;
        for (int i=0; i < numOps; i++) {
          try {
            if (i % 10 == 0) {
synchronized (region) {
                LOG.debug("flushing");
                region.flush(true);
                if (i % 100 == 0) {
                  region.compact(false);
                }
              }
            }
            long ts=timeStamps.incrementAndGet();
            List<Mutation> mrm=new ArrayList<Mutation>();
            if (op) {
              Put p=new Put(row2,ts);
              p.addColumn(fam1,qual1,value1);
              p.setDurability(Durability.ASYNC_WAL);
              mrm.add(p);
              Delete d=new Delete(row);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              mrm.add(d);
            }
 else {
              Delete d=new Delete(row2);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              mrm.add(d);
              Put p=new Put(row,ts);
              p.setDurability(Durability.ASYNC_WAL);
              p.addColumn(fam1,qual1,value2);
              mrm.add(p);
            }
            region.mutateRowsWithLocks(mrm,rowsToLock,HConstants.NO_NONCE,HConstants.NO_NONCE);
            op^=true;
            Scan s=new Scan(row);
            RegionScanner rs=region.getScanner(s);
            List<Cell> r=new ArrayList<Cell>();
            while (rs.next(r))             ;
            rs.close();
            if (r.size() != 1) {
              LOG.debug(r);
              failures.incrementAndGet();
              fail();
            }
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestColumnSeeking </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testReseeking() throws IOException {
  String family="Family";
  byte[] familyBytes=Bytes.toBytes("Family");
  TableName table=TableName.valueOf(name.getMethodName());
  HTableDescriptor htd=new HTableDescriptor(table);
  HColumnDescriptor hcd=new HColumnDescriptor(family);
  hcd.setMaxVersions(3);
  htd.addFamily(hcd);
  HRegionInfo info=new HRegionInfo(table,null,null,false);
  Region region=TEST_UTIL.createLocalHRegion(info,htd);
  List<String> rows=generateRandomWords(10,"row");
  List<String> allColumns=generateRandomWords(100,"column");
  long maxTimestamp=2;
  double selectPercent=0.5;
  int numberOfTests=5;
  double flushPercentage=0.2;
  double minorPercentage=0.2;
  double majorPercentage=0.2;
  double putPercentage=0.2;
  HashMap<String,KeyValue> allKVMap=new HashMap<String,KeyValue>();
  HashMap<String,KeyValue>[] kvMaps=new HashMap[numberOfTests];
  ArrayList<String>[] columnLists=new ArrayList[numberOfTests];
  String valueString="Value";
  for (int i=0; i < numberOfTests; i++) {
    kvMaps[i]=new HashMap<String,KeyValue>();
    columnLists[i]=new ArrayList<String>();
    for (    String column : allColumns) {
      if (Math.random() < selectPercent) {
        columnLists[i].add(column);
      }
    }
  }
  for (  String row : rows) {
    Put p=new Put(Bytes.toBytes(row));
    p.setDurability(Durability.SKIP_WAL);
    for (    String column : allColumns) {
      for (long timestamp=1; timestamp <= maxTimestamp; timestamp++) {
        KeyValue kv=KeyValueTestUtil.create(row,family,column,timestamp,valueString);
        if (Math.random() < putPercentage) {
          p.add(kv);
          allKVMap.put(kv.getKeyString(),kv);
          for (int i=0; i < numberOfTests; i++) {
            if (columnLists[i].contains(column)) {
              kvMaps[i].put(kv.getKeyString(),kv);
            }
          }
        }
      }
    }
    region.put(p);
    if (Math.random() < flushPercentage) {
      LOG.info("Flushing... ");
      region.flush(true);
    }
    if (Math.random() < minorPercentage) {
      LOG.info("Minor compacting... ");
      region.compact(false);
    }
    if (Math.random() < majorPercentage) {
      LOG.info("Major compacting... ");
      region.compact(true);
    }
  }
  for (int i=0; i < numberOfTests + 1; i++) {
    Collection<KeyValue> kvSet;
    Scan scan=new Scan();
    scan.setMaxVersions();
    if (i < numberOfTests) {
      if (columnLists[i].size() == 0)       continue;
      kvSet=kvMaps[i].values();
      for (      String column : columnLists[i]) {
        scan.addColumn(familyBytes,Bytes.toBytes(column));
      }
      LOG.info("ExplicitColumns scanner");
      LOG.info("Columns: " + columnLists[i].size() + "  Keys: "+ kvSet.size());
    }
 else {
      kvSet=allKVMap.values();
      LOG.info("Wildcard scanner");
      LOG.info("Columns: " + allColumns.size() + "  Keys: "+ kvSet.size());
    }
    InternalScanner scanner=region.getScanner(scan);
    List<Cell> results=new ArrayList<Cell>();
    while (scanner.next(results))     ;
    assertEquals(kvSet.size(),results.size());
    assertTrue(KeyValueTestUtil.containsIgnoreMvccVersion(results,kvSet));
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testDuplicateVersions() throws IOException {
  String family="Family";
  byte[] familyBytes=Bytes.toBytes("Family");
  TableName table=TableName.valueOf(name.getMethodName());
  HColumnDescriptor hcd=new HColumnDescriptor(familyBytes).setMaxVersions(1000);
  hcd.setMaxVersions(3);
  HTableDescriptor htd=new HTableDescriptor(table);
  htd.addFamily(hcd);
  HRegionInfo info=new HRegionInfo(table,null,null,false);
  Region region=TEST_UTIL.createLocalHRegion(info,htd);
  try {
    List<String> rows=generateRandomWords(10,"row");
    List<String> allColumns=generateRandomWords(10,"column");
    List<String> values=generateRandomWords(100,"value");
    long maxTimestamp=2;
    double selectPercent=0.5;
    int numberOfTests=5;
    double flushPercentage=0.2;
    double minorPercentage=0.2;
    double majorPercentage=0.2;
    double putPercentage=0.2;
    HashMap<String,KeyValue> allKVMap=new HashMap<String,KeyValue>();
    HashMap<String,KeyValue>[] kvMaps=new HashMap[numberOfTests];
    ArrayList<String>[] columnLists=new ArrayList[numberOfTests];
    for (int i=0; i < numberOfTests; i++) {
      kvMaps[i]=new HashMap<String,KeyValue>();
      columnLists[i]=new ArrayList<String>();
      for (      String column : allColumns) {
        if (Math.random() < selectPercent) {
          columnLists[i].add(column);
        }
      }
    }
    for (    String value : values) {
      for (      String row : rows) {
        Put p=new Put(Bytes.toBytes(row));
        p.setDurability(Durability.SKIP_WAL);
        for (        String column : allColumns) {
          for (long timestamp=1; timestamp <= maxTimestamp; timestamp++) {
            KeyValue kv=KeyValueTestUtil.create(row,family,column,timestamp,value);
            if (Math.random() < putPercentage) {
              p.add(kv);
              allKVMap.put(kv.getKeyString(),kv);
              for (int i=0; i < numberOfTests; i++) {
                if (columnLists[i].contains(column)) {
                  kvMaps[i].put(kv.getKeyString(),kv);
                }
              }
            }
          }
        }
        region.put(p);
        if (Math.random() < flushPercentage) {
          LOG.info("Flushing... ");
          region.flush(true);
        }
        if (Math.random() < minorPercentage) {
          LOG.info("Minor compacting... ");
          region.compact(false);
        }
        if (Math.random() < majorPercentage) {
          LOG.info("Major compacting... ");
          region.compact(true);
        }
      }
    }
    for (int i=0; i < numberOfTests + 1; i++) {
      Collection<KeyValue> kvSet;
      Scan scan=new Scan();
      scan.setMaxVersions();
      if (i < numberOfTests) {
        if (columnLists[i].size() == 0)         continue;
        kvSet=kvMaps[i].values();
        for (        String column : columnLists[i]) {
          scan.addColumn(familyBytes,Bytes.toBytes(column));
        }
        LOG.info("ExplicitColumns scanner");
        LOG.info("Columns: " + columnLists[i].size() + "  Keys: "+ kvSet.size());
      }
 else {
        kvSet=allKVMap.values();
        LOG.info("Wildcard scanner");
        LOG.info("Columns: " + allColumns.size() + "  Keys: "+ kvSet.size());
      }
      InternalScanner scanner=region.getScanner(scan);
      List<Cell> results=new ArrayList<Cell>();
      while (scanner.next(results))       ;
      assertEquals(kvSet.size(),results.size());
      assertTrue(KeyValueTestUtil.containsIgnoreMvccVersion(results,kvSet));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHMobStore </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Getting MOB data from files
 * @throws IOException
 */
@Test public void testGetFromFiles() throws IOException {
  final Configuration conf=TEST_UTIL.getConfiguration();
  init(name.getMethodName(),conf,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(3);
  Scan scan=new Scan(get);
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Assert.assertEquals(expected.get(i),results.get(i));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Getting the reference data from files
 * @throws IOException
 */
@Test public void testGetReferencesFromFiles() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  init(name.getMethodName(),conf,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(3);
  Scan scan=new Scan(get);
  scan.setAttribute(MobConstants.MOB_SCAN_RAW,Bytes.toBytes(Boolean.TRUE));
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Cell cell=results.get(i);
    Assert.assertTrue(MobUtils.isMobReferenceCell(cell));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Getting data from memstore and files
 * @throws IOException
 */
@Test public void testGetFromMemStoreAndFiles() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  init(name.getMethodName(),conf,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  Scan scan=new Scan(get);
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Assert.assertEquals(expected.get(i),results.get(i));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Getting data from memstore
 * @throws IOException
 */
@Test public void testGetFromMemStore() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  init(name.getMethodName(),conf,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  Scan scan=new Scan(get);
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Assert.assertEquals(expected.get(i),results.get(i));
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMOBStoreEncryption() throws Exception {
  final Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.CRYPTO_KEYPROVIDER_CONF_KEY,KeyProviderForTesting.class.getName());
  conf.set(HConstants.CRYPTO_MASTERKEY_NAME_CONF_KEY,"hbase");
  SecureRandom rng=new SecureRandom();
  byte[] keyBytes=new byte[AES.KEY_LENGTH];
  rng.nextBytes(keyBytes);
  String algorithm=conf.get(HConstants.CRYPTO_KEY_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  Key cfKey=new SecretKeySpec(keyBytes,algorithm);
  HColumnDescriptor hcd=new HColumnDescriptor(family);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(100);
  hcd.setMaxVersions(4);
  hcd.setEncryptionType(algorithm);
  hcd.setEncryptionKey(EncryptionUtil.wrapKey(conf,conf.get(HConstants.CRYPTO_MASTERKEY_NAME_CONF_KEY,User.getCurrent().getShortName()),cfKey));
  init(name.getMethodName(),conf,hcd,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  this.store.add(new KeyValue(row,family,qf3,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf4,1,value));
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(2);
  Collection<StoreFile> storefiles=this.store.getStorefiles();
  checkMobHFileEncrytption(storefiles);
  Scan scan=new Scan(get);
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Assert.assertEquals(expected.get(i),results.get(i));
  }
  this.store.triggerMajorCompaction();
  CompactionContext requestCompaction=this.store.requestCompaction(1,null);
  this.store.compact(requestCompaction,NoLimitThroughputController.INSTANCE);
  Assert.assertEquals(1,this.store.getStorefiles().size());
  checkMobHFileEncrytption(this.store.getStorefiles());
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Getting data from memstore and files
 * @throws IOException
 */
@Test public void testMobCellSizeThreshold() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  HColumnDescriptor hcd;
  hcd=new HColumnDescriptor(family);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(100);
  hcd.setMaxVersions(4);
  init(name.getMethodName(),conf,hcd,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(3);
  Scan scan=new Scan(get);
  scan.setAttribute(MobConstants.MOB_SCAN_RAW,Bytes.toBytes(Boolean.TRUE));
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Cell cell=results.get(i);
    Assert.assertFalse(MobUtils.isMobReferenceCell(cell));
    Assert.assertEquals(expected.get(i),results.get(i));
    Assert.assertEquals(100,store.getFamily().getMobThreshold());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegion </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_ExplicitColumns_FromFilesOnly_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    region.flush(true);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addColumn(fam1,qf1);
    scan.addColumn(fam1,qf2);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Writes very wide records and scans for the latest every time.. Flushes and
 * compacts the region every now and then to keep things realistic.
 * @throws IOExceptionby flush / scan / compaction
 * @throws InterruptedExceptionwhen joining threads
 */
@Test public void testWritesWhileScanning() throws IOException, InterruptedException {
  int testCount=100;
  int numRows=1;
  int numFamilies=10;
  int numQualifiers=100;
  int flushInterval=7;
  int compactInterval=5 * flushInterval;
  byte[][] families=new byte[numFamilies][];
  for (int i=0; i < numFamilies; i++) {
    families[i]=Bytes.toBytes("family" + i);
  }
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++) {
    qualifiers[i]=Bytes.toBytes("qual" + i);
  }
  String method="testWritesWhileScanning";
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    PutThread putThread=new PutThread(numRows,families,qualifiers);
    putThread.start();
    putThread.waitForFirstPut();
    FlushThread flushThread=new FlushThread();
    flushThread.start();
    Scan scan=new Scan(Bytes.toBytes("row0"),Bytes.toBytes("row1"));
    int expectedCount=numFamilies * numQualifiers;
    List<Cell> res=new ArrayList<Cell>();
    long prevTimestamp=0L;
    for (int i=0; i < testCount; i++) {
      if (i != 0 && i % compactInterval == 0) {
        region.compact(true);
      }
      if (i != 0 && i % flushInterval == 0) {
        flushThread.flush();
      }
      boolean previousEmpty=res.isEmpty();
      res.clear();
      InternalScanner scanner=region.getScanner(scan);
      while (scanner.next(res))       ;
      if (!res.isEmpty() || !previousEmpty || i > compactInterval) {
        assertEquals("i=" + i,expectedCount,res.size());
        long timestamp=res.get(0).getTimestamp();
        assertTrue("Timestamps were broke: " + timestamp + " prev: "+ prevTimestamp,timestamp >= prevTimestamp);
        prevTimestamp=timestamp;
      }
    }
    putThread.done();
    region.flush(true);
    putThread.join();
    putThread.checkNoError();
    flushThread.done();
    flushThread.join();
    flushThread.checkNoError();
  }
  finally {
    try {
      HBaseTestingUtility.closeRegionAndWAL(this.region);
    }
 catch (    DroppedSnapshotException dse) {
    }
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckAndPut_ThatPutWasWritten() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] fam2=Bytes.toBytes("fam2");
  byte[] qf1=Bytes.toBytes("qualifier");
  byte[] val1=Bytes.toBytes("value1");
  byte[] val2=Bytes.toBytes("value2");
  byte[][] families={fam1,fam2};
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=new Put(row1);
    put.addColumn(fam1,qf1,val1);
    region.put(put);
    long ts=System.currentTimeMillis();
    KeyValue kv=new KeyValue(row1,fam2,qf1,ts,KeyValue.Type.Put,val2);
    put=new Put(row1);
    put.add(kv);
    boolean res=region.checkAndMutate(row1,fam1,qf1,CompareOp.EQUAL,new BinaryComparator(val1),put,true);
    assertEquals(true,res);
    Get get=new Get(row1);
    get.addColumn(fam2,qf1);
    Cell[] actual=region.get(get).rawCells();
    Cell[] expected={kv};
    assertEquals(expected.length,actual.length);
    for (int i=0; i < actual.length; i++) {
      assertEquals(expected[i],actual[i]);
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet_Basic() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] col1=Bytes.toBytes("col1");
  byte[] col2=Bytes.toBytes("col2");
  byte[] col3=Bytes.toBytes("col3");
  byte[] col4=Bytes.toBytes("col4");
  byte[] col5=Bytes.toBytes("col5");
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    Put put=new Put(row1);
    put.addColumn(fam1,col1,null);
    put.addColumn(fam1,col2,null);
    put.addColumn(fam1,col3,null);
    put.addColumn(fam1,col4,null);
    put.addColumn(fam1,col5,null);
    region.put(put);
    Get get=new Get(row1);
    get.addColumn(fam1,col2);
    get.addColumn(fam1,col4);
    KeyValue kv1=new KeyValue(row1,fam1,col2);
    KeyValue kv2=new KeyValue(row1,fam1,col4);
    KeyValue[] expected={kv1,kv2};
    Result res=region.get(get);
    assertEquals(expected.length,res.size());
    for (int i=0; i < res.size(); i++) {
      assertTrue(CellUtil.matchingRow(expected[i],res.rawCells()[i]));
      assertTrue(CellUtil.matchingFamily(expected[i],res.rawCells()[i]));
      assertTrue(CellUtil.matchingQualifier(expected[i],res.rawCells()[i]));
    }
    Get g=new Get(row1);
    final int count=2;
    g.setFilter(new ColumnCountGetFilter(count));
    res=region.get(g);
    assertEquals(count,res.size());
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_ExplicitColumns_FromMemStoreAndFiles_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  long ts4=ts1 + 3;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    KeyValue kv14=new KeyValue(row1,fam1,qf1,ts4,KeyValue.Type.Put,null);
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv24=new KeyValue(row1,fam1,qf2,ts4,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(row1);
    put.add(kv14);
    put.add(kv24);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv23);
    put.add(kv13);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv22);
    put.add(kv12);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv21);
    put.add(kv11);
    region.put(put);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv14);
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv24);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addColumn(fam1,qf1);
    scan.addColumn(fam1,qf2);
    int versions=3;
    scan.setMaxVersions(versions);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Writes very wide records and gets the latest row every time.. Flushes and
 * compacts the region aggressivly to catch issues.
 * @throws IOExceptionby flush / scan / compaction
 * @throws InterruptedExceptionwhen joining threads
 */
@Test public void testWritesWhileGetting() throws Exception {
  int testCount=50;
  int numRows=1;
  int numFamilies=10;
  int numQualifiers=100;
  int compactInterval=100;
  byte[][] families=new byte[numFamilies][];
  for (int i=0; i < numFamilies; i++) {
    families[i]=Bytes.toBytes("family" + i);
  }
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++) {
    qualifiers[i]=Bytes.toBytes("qual" + i);
  }
  String method="testWritesWhileGetting";
  Configuration conf=HBaseConfiguration.create(CONF);
  conf.setInt("hbase.hstore.compaction.min",1);
  conf.setInt("hbase.hstore.compaction.max",1000);
  this.region=initHRegion(tableName,method,conf,families);
  PutThread putThread=null;
  MultithreadedTestUtil.TestContext ctx=new MultithreadedTestUtil.TestContext(conf);
  try {
    putThread=new PutThread(numRows,families,qualifiers);
    putThread.start();
    putThread.waitForFirstPut();
    ctx.addThread(new RepeatingTestThread(ctx){
      private int flushesSinceCompact=0;
      private final int maxFlushesSinceCompact=20;
      @Override public void doAnAction() throws Exception {
        if (region.flush(true).isCompactionNeeded()) {
          ++flushesSinceCompact;
        }
        if (flushesSinceCompact == maxFlushesSinceCompact) {
          region.compact(false);
          flushesSinceCompact=0;
        }
      }
    }
);
    ctx.startThreads();
    Get get=new Get(Bytes.toBytes("row0"));
    Result result=null;
    int expectedCount=numFamilies * numQualifiers;
    long prevTimestamp=0L;
    for (int i=0; i < testCount; i++) {
      LOG.info("testWritesWhileGetting verify turn " + i);
      boolean previousEmpty=result == null || result.isEmpty();
      result=region.get(get);
      if (!result.isEmpty() || !previousEmpty || i > compactInterval) {
        assertEquals("i=" + i,expectedCount,result.size());
        long timestamp=0;
        for (        Cell kv : result.rawCells()) {
          if (CellUtil.matchingFamily(kv,families[0]) && CellUtil.matchingQualifier(kv,qualifiers[0])) {
            timestamp=kv.getTimestamp();
          }
        }
        assertTrue(timestamp >= prevTimestamp);
        prevTimestamp=timestamp;
        Cell previousKV=null;
        for (        Cell kv : result.rawCells()) {
          byte[] thisValue=CellUtil.cloneValue(kv);
          if (previousKV != null) {
            if (Bytes.compareTo(CellUtil.cloneValue(previousKV),thisValue) != 0) {
              LOG.warn("These two KV should have the same value." + " Previous KV:" + previousKV + "(memStoreTS:"+ previousKV.getSequenceId()+ ")"+ ", New KV: "+ kv+ "(memStoreTS:"+ kv.getSequenceId()+ ")");
              assertEquals(0,Bytes.compareTo(CellUtil.cloneValue(previousKV),thisValue));
            }
          }
          previousKV=kv;
        }
      }
    }
  }
  finally {
    if (putThread != null)     putThread.done();
    region.flush(true);
    if (putThread != null) {
      putThread.join();
      putThread.checkNoError();
    }
    ctx.stop();
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchPut_whileNoRowLocksHeld() throws IOException {
  byte[] cf=Bytes.toBytes(COLUMN_FAMILY);
  byte[] qual=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("val");
  this.region=initHRegion(TableName.valueOf(getName()),getName(),CONF,cf);
  MetricsWALSource source=CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
  try {
    long syncs=metricsAssertHelper.getCounter("syncTimeNumOps",source);
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs,source);
    LOG.info("First a batch put with all valid puts");
    final Put[] puts=new Put[10];
    for (int i=0; i < 10; i++) {
      puts[i]=new Put(Bytes.toBytes("row_" + i));
      puts[i].addColumn(cf,qual,val);
    }
    OperationStatus[] codes=this.region.batchMutate(puts);
    assertEquals(10,codes.length);
    for (int i=0; i < 10; i++) {
      assertEquals(OperationStatusCode.SUCCESS,codes[i].getOperationStatusCode());
    }
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs + 1,source);
    LOG.info("Next a batch put with one invalid family");
    puts[5].addColumn(Bytes.toBytes("BAD_CF"),qual,val);
    codes=this.region.batchMutate(puts);
    assertEquals(10,codes.length);
    for (int i=0; i < 10; i++) {
      assertEquals((i == 5) ? OperationStatusCode.BAD_FAMILY : OperationStatusCode.SUCCESS,codes[i].getOperationStatusCode());
    }
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs + 2,source);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that we get the expected flush results back
 * @throws IOException
 */
@Test public void testFlushResult() throws IOException {
  String method=name.getMethodName();
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  this.region=initHRegion(tableName,method,family);
  HRegion.FlushResult fr=region.flush(true);
  assertFalse(fr.isFlushSucceeded());
  assertFalse(fr.isCompactionNeeded());
  for (int i=0; i < 2; i++) {
    Put put=new Put(tableName.toBytes()).addColumn(family,family,tableName.toBytes());
    region.put(put);
    fr=region.flush(true);
    assertTrue(fr.isFlushSucceeded());
    assertFalse(fr.isCompactionNeeded());
  }
  for (int i=0; i < 2; i++) {
    Put put=new Put(tableName.toBytes()).addColumn(family,family,tableName.toBytes());
    region.put(put);
    fr=region.flush(true);
    assertTrue(fr.isFlushSucceeded());
    assertTrue(fr.isCompactionNeeded());
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * HBASE-5416
 * Test case when scan limits amount of KVs returned on each next() call.
 */
@Test public void testScanner_JoinedScannersWithLimits() throws IOException {
  final byte[] cf_first=Bytes.toBytes("first");
  final byte[] cf_second=Bytes.toBytes("second");
  this.region=initHRegion(tableName,getName(),CONF,cf_first,cf_second);
  try {
    final byte[] col_a=Bytes.toBytes("a");
    final byte[] col_b=Bytes.toBytes("b");
    Put put;
    for (int i=0; i < 10; i++) {
      put=new Put(Bytes.toBytes("r" + Integer.toString(i)));
      put.addColumn(cf_first,col_a,Bytes.toBytes(i));
      if (i < 5) {
        put.addColumn(cf_first,col_b,Bytes.toBytes(i));
        put.addColumn(cf_second,col_a,Bytes.toBytes(i));
        put.addColumn(cf_second,col_b,Bytes.toBytes(i));
      }
      region.put(put);
    }
    Scan scan=new Scan();
    scan.setLoadColumnFamiliesOnDemand(true);
    Filter bogusFilter=new FilterBase(){
      @Override public ReturnCode filterKeyValue(      Cell ignored) throws IOException {
        return ReturnCode.INCLUDE;
      }
      @Override public boolean isFamilyEssential(      byte[] name){
        return Bytes.equals(name,cf_first);
      }
    }
;
    scan.setFilter(bogusFilter);
    InternalScanner s=region.getScanner(scan);
    List<Cell> results=new ArrayList<Cell>();
    int index=0;
    ScannerContext scannerContext=ScannerContext.newBuilder().setBatchLimit(3).build();
    while (true) {
      boolean more=s.next(results,scannerContext);
      if ((index >> 1) < 5) {
        if (index % 2 == 0)         assertEquals(results.size(),3);
 else         assertEquals(results.size(),1);
      }
 else       assertEquals(results.size(),1);
      results.clear();
      index++;
      if (!more)       break;
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_Wildcard_FromFilesOnly_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    region.flush(true);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addFamily(fam1);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchPutWithTsSlop() throws Exception {
  TableName b=TableName.valueOf(getName());
  byte[] cf=Bytes.toBytes(COLUMN_FAMILY);
  byte[] qual=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("val");
  CONF.setInt("hbase.hregion.keyvalue.timestamp.slop.millisecs",1000);
  this.region=initHRegion(b,getName(),CONF,cf);
  try {
    MetricsWALSource source=CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
    long syncs=metricsAssertHelper.getCounter("syncTimeNumOps",source);
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs,source);
    final Put[] puts=new Put[10];
    for (int i=0; i < 10; i++) {
      puts[i]=new Put(Bytes.toBytes("row_" + i),Long.MAX_VALUE - 100);
      puts[i].addColumn(cf,qual,val);
    }
    OperationStatus[] codes=this.region.batchMutate(puts);
    assertEquals(10,codes.length);
    for (int i=0; i < 10; i++) {
      assertEquals(OperationStatusCode.SANITY_CHECK_FAILURE,codes[i].getOperationStatusCode());
    }
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs,source);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScanner_Wildcard_FromMemStore_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  long ts1=System.currentTimeMillis();
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addFamily(fam1);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertEquals(expected.get(i),actual.get(i));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testRegionScanner_Next() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] row2=Bytes.toBytes("row2");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] fam2=Bytes.toBytes("fam2");
  byte[] fam3=Bytes.toBytes("fam3");
  byte[] fam4=Bytes.toBytes("fam4");
  byte[][] families={fam1,fam2,fam3,fam4};
  long ts=System.currentTimeMillis();
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=null;
    put=new Put(row1);
    put.addColumn(fam1,(byte[])null,ts,null);
    put.addColumn(fam2,(byte[])null,ts,null);
    put.addColumn(fam3,(byte[])null,ts,null);
    put.addColumn(fam4,(byte[])null,ts,null);
    region.put(put);
    put=new Put(row2);
    put.addColumn(fam1,(byte[])null,ts,null);
    put.addColumn(fam2,(byte[])null,ts,null);
    put.addColumn(fam3,(byte[])null,ts,null);
    put.addColumn(fam4,(byte[])null,ts,null);
    region.put(put);
    Scan scan=new Scan();
    scan.addFamily(fam2);
    scan.addFamily(fam4);
    InternalScanner is=region.getScanner(scan);
    List<Cell> res=null;
    List<Cell> expected1=new ArrayList<Cell>();
    expected1.add(new KeyValue(row1,fam2,null,ts,KeyValue.Type.Put,null));
    expected1.add(new KeyValue(row1,fam4,null,ts,KeyValue.Type.Put,null));
    res=new ArrayList<Cell>();
    is.next(res);
    for (int i=0; i < res.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected1.get(i),res.get(i)));
    }
    List<Cell> expected2=new ArrayList<Cell>();
    expected2.add(new KeyValue(row2,fam2,null,ts,KeyValue.Type.Put,null));
    expected2.add(new KeyValue(row2,fam4,null,ts,KeyValue.Type.Put,null));
    res=new ArrayList<Cell>();
    is.next(res);
    for (int i=0; i < res.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected2.get(i),res.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipRecoveredEditsReplay() throws Exception {
  String method="testSkipRecoveredEditsReplay";
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  this.region=initHRegion(tableName,method,CONF,family);
  final WALFactory wals=new WALFactory(CONF,null,method);
  try {
    Path regiondir=region.getRegionFileSystem().getRegionDir();
    FileSystem fs=region.getRegionFileSystem().getFileSystem();
    byte[] regionName=region.getRegionInfo().getEncodedNameAsBytes();
    Path recoveredEditsDir=WALSplitter.getRegionDirRecoveredEditsDir(regiondir);
    long maxSeqId=1050;
    long minSeqId=1000;
    for (long i=minSeqId; i <= maxSeqId; i+=10) {
      Path recoveredEdits=new Path(recoveredEditsDir,String.format("%019d",i));
      fs.create(recoveredEdits);
      WALProvider.Writer writer=wals.createRecoveredEditsWriter(fs,recoveredEdits);
      long time=System.nanoTime();
      WALEdit edit=new WALEdit();
      edit.add(new KeyValue(row,family,Bytes.toBytes(i),time,KeyValue.Type.Put,Bytes.toBytes(i)));
      writer.append(new WAL.Entry(new HLogKey(regionName,tableName,i,time,HConstants.DEFAULT_CLUSTER_ID),edit));
      writer.close();
    }
    MonitoredTask status=TaskMonitor.get().createStatus(method);
    Map<byte[],Long> maxSeqIdInStores=new TreeMap<byte[],Long>(Bytes.BYTES_COMPARATOR);
    for (    Store store : region.getStores()) {
      maxSeqIdInStores.put(store.getColumnFamilyName().getBytes(),minSeqId - 1);
    }
    long seqId=region.replayRecoveredEditsIfAny(regiondir,maxSeqIdInStores,null,status);
    assertEquals(maxSeqId,seqId);
    region.getMVCC().advanceTo(seqId);
    Get get=new Get(row);
    Result result=region.get(get);
    for (long i=minSeqId; i <= maxSeqId; i+=10) {
      List<Cell> kvs=result.getColumnCells(family,Bytes.toBytes(i));
      assertEquals(1,kvs.size());
      assertArrayEquals(Bytes.toBytes(i),CellUtil.cloneValue(kvs.get(0)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
    wals.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=60000) public void testSplitRegionWithReverseScan() throws IOException {
  TableName tableName=TableName.valueOf("testSplitRegionWithReverseScan");
  byte[] qualifier=Bytes.toBytes("qualifier");
  Configuration hc=initSplit();
  int numRows=3;
  byte[][] families={fam1};
  String method=this.getName();
  this.region=initHRegion(tableName,method,hc,families);
  int startRow=100;
  putData(startRow,numRows,qualifier,families);
  int splitRow=startRow + numRows;
  putData(splitRow,numRows,qualifier,families);
  region.flush(true);
  HRegion[] regions=null;
  try {
    regions=splitRegion(region,Bytes.toBytes("" + splitRow));
    for (int i=0; i < regions.length; i++) {
      regions[i]=HRegion.openHRegion(regions[i],null);
    }
    assertEquals(2,regions.length);
    verifyData(regions[0],startRow,numRows,qualifier,families);
    verifyData(regions[1],splitRow,numRows,qualifier,families);
    Scan scan=new Scan(Bytes.toBytes(String.valueOf(startRow + 10 * numRows)));
    scan.setReversed(true);
    InternalScanner scanner=regions[1].getScanner(scan);
    List<Cell> currRow=new ArrayList<Cell>();
    boolean more=false;
    int verify=startRow + 2 * numRows - 1;
    do {
      more=scanner.next(currRow);
      assertEquals(Bytes.toString(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength()),verify + "");
      verify--;
      currRow.clear();
    }
 while (more);
    assertEquals(verify,startRow + numRows - 1);
    scanner.close();
    scan=new Scan(Bytes.toBytes(String.valueOf(startRow + 2 * numRows - 1)));
    scan.setReversed(true);
    scanner=regions[1].getScanner(scan);
    verify=startRow + 2 * numRows - 1;
    do {
      more=scanner.next(currRow);
      assertEquals(Bytes.toString(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength()),verify + "");
      verify--;
      currRow.clear();
    }
 while (more);
    assertEquals(verify,startRow + numRows - 1);
    scanner.close();
    scan=new Scan(Bytes.toBytes(String.valueOf(startRow + numRows)));
    scan.setReversed(true);
    scanner=regions[0].getScanner(scan);
    verify=startRow + numRows - 1;
    do {
      more=scanner.next(currRow);
      assertEquals(Bytes.toString(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength()),verify + "");
      verify--;
      currRow.clear();
    }
 while (more);
    assertEquals(verify,99);
    scanner.close();
    scan=new Scan(Bytes.toBytes(String.valueOf(startRow + numRows - 1)));
    scan.setReversed(true);
    scanner=regions[0].getScanner(scan);
    verify=startRow + numRows - 1;
    do {
      more=scanner.next(currRow);
      assertEquals(Bytes.toString(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength()),verify + "");
      verify--;
      currRow.clear();
    }
 while (more);
    assertEquals(verify,startRow - 1);
    scanner.close();
  }
  finally {
    this.region.close();
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_Wildcard_FromMemStoreAndFiles_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("quateslifier2");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  long ts4=ts1 + 3;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    KeyValue kv14=new KeyValue(row1,fam1,qf1,ts4,KeyValue.Type.Put,null);
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv24=new KeyValue(row1,fam1,qf2,ts4,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(row1);
    put.add(kv14);
    put.add(kv24);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv23);
    put.add(kv13);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv22);
    put.add(kv12);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv21);
    put.add(kv11);
    region.put(put);
    List<KeyValue> expected=new ArrayList<KeyValue>();
    expected.add(kv14);
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv24);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    int versions=3;
    scan.setMaxVersions(versions);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipRecoveredEditsReplaySomeIgnored() throws Exception {
  String method="testSkipRecoveredEditsReplaySomeIgnored";
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  this.region=initHRegion(tableName,method,CONF,family);
  final WALFactory wals=new WALFactory(CONF,null,method);
  try {
    Path regiondir=region.getRegionFileSystem().getRegionDir();
    FileSystem fs=region.getRegionFileSystem().getFileSystem();
    byte[] regionName=region.getRegionInfo().getEncodedNameAsBytes();
    Path recoveredEditsDir=WALSplitter.getRegionDirRecoveredEditsDir(regiondir);
    long maxSeqId=1050;
    long minSeqId=1000;
    for (long i=minSeqId; i <= maxSeqId; i+=10) {
      Path recoveredEdits=new Path(recoveredEditsDir,String.format("%019d",i));
      fs.create(recoveredEdits);
      WALProvider.Writer writer=wals.createRecoveredEditsWriter(fs,recoveredEdits);
      long time=System.nanoTime();
      WALEdit edit=new WALEdit();
      edit.add(new KeyValue(row,family,Bytes.toBytes(i),time,KeyValue.Type.Put,Bytes.toBytes(i)));
      writer.append(new WAL.Entry(new HLogKey(regionName,tableName,i,time,HConstants.DEFAULT_CLUSTER_ID),edit));
      writer.close();
    }
    long recoverSeqId=1030;
    MonitoredTask status=TaskMonitor.get().createStatus(method);
    Map<byte[],Long> maxSeqIdInStores=new TreeMap<byte[],Long>(Bytes.BYTES_COMPARATOR);
    for (    Store store : region.getStores()) {
      maxSeqIdInStores.put(store.getColumnFamilyName().getBytes(),recoverSeqId - 1);
    }
    long seqId=region.replayRecoveredEditsIfAny(regiondir,maxSeqIdInStores,null,status);
    assertEquals(maxSeqId,seqId);
    region.getMVCC().advanceTo(seqId);
    Get get=new Get(row);
    Result result=region.get(get);
    for (long i=minSeqId; i <= maxSeqId; i+=10) {
      List<Cell> kvs=result.getColumnCells(family,Bytes.toBytes(i));
      if (i < recoverSeqId) {
        assertEquals(0,kvs.size());
      }
 else {
        assertEquals(1,kvs.size());
        assertArrayEquals(Bytes.toBytes(i),CellUtil.cloneValue(kvs.get(0)));
      }
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
    wals.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Flushes the cache in a thread while scanning. The tests verify that the
 * scan is coherent - e.g. the returned results are always of the same or
 * later update as the previous results.
 * @throws IOExceptionscan / compact
 * @throws InterruptedExceptionthread join
 */
@Test public void testFlushCacheWhileScanning() throws IOException, InterruptedException {
  byte[] family=Bytes.toBytes("family");
  int numRows=1000;
  int flushAndScanInterval=10;
  int compactInterval=10 * flushAndScanInterval;
  String method="testFlushCacheWhileScanning";
  this.region=initHRegion(tableName,method,CONF,family);
  try {
    FlushThread flushThread=new FlushThread();
    flushThread.start();
    Scan scan=new Scan();
    scan.addFamily(family);
    scan.setFilter(new SingleColumnValueFilter(family,qual1,CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes(5L))));
    int expectedCount=0;
    List<Cell> res=new ArrayList<Cell>();
    boolean toggle=true;
    for (long i=0; i < numRows; i++) {
      Put put=new Put(Bytes.toBytes(i));
      put.setDurability(Durability.SKIP_WAL);
      put.addColumn(family,qual1,Bytes.toBytes(i % 10));
      region.put(put);
      if (i != 0 && i % compactInterval == 0) {
        region.compact(true);
      }
      if (i % 10 == 5L) {
        expectedCount++;
      }
      if (i != 0 && i % flushAndScanInterval == 0) {
        res.clear();
        InternalScanner scanner=region.getScanner(scan);
        if (toggle) {
          flushThread.flush();
        }
        while (scanner.next(res))         ;
        if (!toggle) {
          flushThread.flush();
        }
        assertEquals("i=" + i,expectedCount,res.size());
        toggle=!toggle;
      }
    }
    flushThread.done();
    flushThread.join();
    flushThread.checkNoError();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushMarkers() throws Exception {
  String method=name.getMethodName();
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  Path logDir=TEST_UTIL.getDataTestDirOnTestFS(method + ".log");
  final Configuration walConf=new Configuration(TEST_UTIL.getConfiguration());
  FSUtils.setRootDir(walConf,logDir);
  final WALFactory wals=new WALFactory(walConf,null,method);
  final WAL wal=wals.getWAL(tableName.getName(),tableName.getNamespace());
  this.region=initHRegion(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,method,CONF,false,Durability.USE_DEFAULT,wal,family);
  try {
    Path regiondir=region.getRegionFileSystem().getRegionDir();
    FileSystem fs=region.getRegionFileSystem().getFileSystem();
    byte[] regionName=region.getRegionInfo().getEncodedNameAsBytes();
    long maxSeqId=3;
    long minSeqId=0;
    for (long i=minSeqId; i < maxSeqId; i++) {
      Put put=new Put(Bytes.toBytes(i));
      put.addColumn(family,Bytes.toBytes(i),Bytes.toBytes(i));
      region.put(put);
      region.flush(true);
    }
    assertEquals(3,region.getStore(family).getStorefilesCount());
    List<String> storeFiles=new ArrayList<String>(3);
    for (    StoreFile sf : region.getStore(family).getStorefiles()) {
      storeFiles.add(sf.getPath().getName());
    }
    wal.shutdown();
    WAL.Reader reader=WALFactory.createReader(fs,DefaultWALProvider.getCurrentFileName(wal),TEST_UTIL.getConfiguration());
    try {
      List<WAL.Entry> flushDescriptors=new ArrayList<WAL.Entry>();
      long lastFlushSeqId=-1;
      while (true) {
        WAL.Entry entry=reader.next();
        if (entry == null) {
          break;
        }
        Cell cell=entry.getEdit().getCells().get(0);
        if (WALEdit.isMetaEditFamily(cell)) {
          FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(cell);
          assertNotNull(flushDesc);
          assertArrayEquals(tableName.getName(),flushDesc.getTableName().toByteArray());
          if (flushDesc.getAction() == FlushAction.START_FLUSH) {
            assertTrue(flushDesc.getFlushSequenceNumber() > lastFlushSeqId);
          }
 else           if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
            assertTrue(flushDesc.getFlushSequenceNumber() == lastFlushSeqId);
          }
          lastFlushSeqId=flushDesc.getFlushSequenceNumber();
          assertArrayEquals(regionName,flushDesc.getEncodedRegionName().toByteArray());
          assertEquals(1,flushDesc.getStoreFlushesCount());
          StoreFlushDescriptor storeFlushDesc=flushDesc.getStoreFlushes(0);
          assertArrayEquals(family,storeFlushDesc.getFamilyName().toByteArray());
          assertEquals("family",storeFlushDesc.getStoreHomeDir());
          if (flushDesc.getAction() == FlushAction.START_FLUSH) {
            assertEquals(0,storeFlushDesc.getFlushOutputCount());
          }
 else {
            assertEquals(1,storeFlushDesc.getFlushOutputCount());
            assertTrue(storeFiles.contains(storeFlushDesc.getFlushOutput(0)));
          }
          flushDescriptors.add(entry);
        }
      }
      assertEquals(3 * 2,flushDescriptors.size());
      Path recoveredEditsDir=WALSplitter.getRegionDirRecoveredEditsDir(regiondir);
      Path recoveredEdits=new Path(recoveredEditsDir,String.format("%019d",1000));
      fs.create(recoveredEdits);
      WALProvider.Writer writer=wals.createRecoveredEditsWriter(fs,recoveredEdits);
      for (      WAL.Entry entry : flushDescriptors) {
        writer.append(entry);
      }
      writer.close();
    }
  finally {
      if (null != reader) {
        try {
          reader.close();
        }
 catch (        IOException exception) {
          LOG.warn("Problem closing wal: " + exception.getMessage());
          LOG.debug("exception details",exception);
        }
      }
    }
    region.close();
    region=HRegion.openHRegion(region,null);
    for (long i=minSeqId; i < maxSeqId; i++) {
      Get get=new Get(Bytes.toBytes(i));
      Result result=region.get(get);
      byte[] value=result.getValue(family,Bytes.toBytes(i));
      assertArrayEquals(Bytes.toBytes(i),value);
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
    wals.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScanner_ExplicitColumns_FromMemStore_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  long ts1=System.currentTimeMillis();
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    Scan scan=new Scan(row1);
    scan.addColumn(fam1,qf1);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertEquals(expected.get(i),actual.get(i));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchPut_whileMultipleRowLocksHeld() throws Exception {
  byte[] cf=Bytes.toBytes(COLUMN_FAMILY);
  byte[] qual=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("val");
  this.region=initHRegion(TableName.valueOf(getName()),getName(),CONF,cf);
  MetricsWALSource source=CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
  try {
    long syncs=metricsAssertHelper.getCounter("syncTimeNumOps",source);
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs,source);
    final Put[] puts=new Put[10];
    for (int i=0; i < 10; i++) {
      puts[i]=new Put(Bytes.toBytes("row_" + i));
      puts[i].addColumn(cf,qual,val);
    }
    puts[5].addColumn(Bytes.toBytes("BAD_CF"),qual,val);
    LOG.info("batchPut will have to break into four batches to avoid row locks");
    RowLock rowLock1=region.getRowLock(Bytes.toBytes("row_2"));
    RowLock rowLock2=region.getRowLock(Bytes.toBytes("row_1"));
    RowLock rowLock3=region.getRowLock(Bytes.toBytes("row_3"));
    RowLock rowLock4=region.getRowLock(Bytes.toBytes("row_3"),true);
    MultithreadedTestUtil.TestContext ctx=new MultithreadedTestUtil.TestContext(CONF);
    final AtomicReference<OperationStatus[]> retFromThread=new AtomicReference<OperationStatus[]>();
    final CountDownLatch startingPuts=new CountDownLatch(1);
    final CountDownLatch startingClose=new CountDownLatch(1);
    TestThread putter=new TestThread(ctx){
      @Override public void doWork() throws IOException {
        startingPuts.countDown();
        retFromThread.set(region.batchMutate(puts));
      }
    }
;
    LOG.info("...starting put thread while holding locks");
    ctx.addThread(putter);
    ctx.startThreads();
    Thread regionCloseThread=new TestThread(ctx){
      @Override public void doWork(){
        try {
          startingPuts.await();
          Thread.sleep(10);
          startingClose.countDown();
          HBaseTestingUtility.closeRegionAndWAL(region);
        }
 catch (        IOException e) {
          throw new RuntimeException(e);
        }
catch (        InterruptedException e) {
          throw new RuntimeException(e);
        }
      }
    }
;
    regionCloseThread.start();
    startingClose.await();
    startingPuts.await();
    Thread.sleep(100);
    LOG.info("...releasing row lock 1, which should let put thread continue");
    rowLock1.release();
    rowLock2.release();
    rowLock3.release();
    waitForCounter(source,"syncTimeNumOps",syncs + 1);
    LOG.info("...joining on put thread");
    ctx.stop();
    regionCloseThread.join();
    OperationStatus[] codes=retFromThread.get();
    for (int i=0; i < codes.length; i++) {
      assertEquals((i == 5) ? OperationStatusCode.BAD_FAMILY : OperationStatusCode.SUCCESS,codes[i].getOperationStatusCode());
    }
    rowLock4.release();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegionReplayEvents </h4><pre class="type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReplayFlushSeqIds() throws IOException {
  int start=0;
  LOG.info("-- Writing some data to primary from " + start + " to "+ (start + 100));
  putData(primaryRegion,Durability.SYNC_WAL,start,100,cq,families);
  LOG.info("-- Flushing primary, creating 3 files for 3 stores");
  primaryRegion.flush(true);
  reader=createWALReaderForPrimary();
  long flushSeqId=-1;
  LOG.info("-- Replaying flush events in secondary");
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        LOG.info("-- Replaying flush start in secondary");
        secondaryRegion.replayWALFlushStartMarker(flushDesc);
        flushSeqId=flushDesc.getFlushSequenceNumber();
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        LOG.info("-- Replaying flush commit in secondary");
        secondaryRegion.replayWALFlushCommitMarker(flushDesc);
        assertEquals(flushSeqId,flushDesc.getFlushSequenceNumber());
      }
    }
  }
  long readPoint=secondaryRegion.getMVCC().getReadPoint();
  assertEquals(flushSeqId,readPoint);
  verifyData(secondaryRegion,0,100,cq,families);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where we prepare a flush with some seqId and we receive a flush commit marker
 * larger than the previous flush start marker.
 */
@Test public void testReplayFlushCommitMarkerLargerThanFlushStartMarker() throws IOException {
  putDataWithFlushes(primaryRegion,100,100,100);
  int numRows=200;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  FlushDescriptor commitFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        if (startFlushDesc == null) {
          LOG.info("-- Replaying flush start in secondary");
          startFlushDesc=flushDesc;
          PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
          assertNull(result.result);
        }
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        commitFlushDesc=FlushDescriptor.newBuilder(flushDesc).setFlushSequenceNumber(flushDesc.getFlushSequenceNumber() + 50).build();
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  long regionMemstoreSize=secondaryRegion.getMemstoreSize();
  LOG.info("Testing replaying flush COMMIT " + commitFlushDesc + " on top of flush START"+ startFlushDesc);
  assertTrue(commitFlushDesc.getFlushSequenceNumber() > startFlushDesc.getFlushSequenceNumber());
  LOG.info("-- Replaying flush commit in secondary" + commitFlushDesc);
  secondaryRegion.replayWALFlushCommitMarker(commitFlushDesc);
  expectedStoreFileCount++;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newFlushableSize=store.getFlushableSize();
  assertTrue(newFlushableSize > 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertTrue(newRegionMemstoreSize > 0);
  assertTrue(regionMemstoreSize > newRegionMemstoreSize);
  assertNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests cases where we prepare a flush with some seqId and we receive other flush start markers
 * equal to, greater or less than the previous flush start marker.
 */
@Test public void testReplayFlushStartMarkers() throws IOException {
  putDataWithFlushes(primaryRegion,100,100,100);
  int numRows=200;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
      long storeMemstoreSize=store.getMemStoreSize();
      long regionMemstoreSize=secondaryRegion.getMemstoreSize();
      long storeFlushableSize=store.getFlushableSize();
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        startFlushDesc=flushDesc;
        LOG.info("-- Replaying flush start in secondary");
        PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
        assertNull(result.result);
        assertEquals(result.flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
        assertTrue(regionMemstoreSize > 0);
        assertTrue(storeFlushableSize > 0);
        long newStoreMemstoreSize=store.getMemStoreSize();
        LOG.info("Memstore size reduced by:" + StringUtils.humanReadableInt(newStoreMemstoreSize - storeMemstoreSize));
        assertTrue(storeMemstoreSize > newStoreMemstoreSize);
        verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Replaying same flush start in secondary again");
  PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  FlushDescriptor startFlushDescSmallerSeqId=clone(startFlushDesc,startFlushDesc.getFlushSequenceNumber() - 50);
  LOG.info("-- Replaying same flush start in secondary again " + startFlushDescSmallerSeqId);
  result=secondaryRegion.replayWALFlushStartMarker(startFlushDescSmallerSeqId);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  FlushDescriptor startFlushDescLargerSeqId=clone(startFlushDesc,startFlushDesc.getFlushSequenceNumber() + 50);
  LOG.info("-- Replaying same flush start in secondary again " + startFlushDescLargerSeqId);
  result=secondaryRegion.replayWALFlushStartMarker(startFlushDescLargerSeqId);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplayFlushesAndCompactions() throws IOException {
  putDataWithFlushes(primaryRegion,100,300,100);
  LOG.info("-- Compacting primary, only 1 store");
  primaryRegion.compactStore(Bytes.toBytes("cf1"),NoLimitThroughputController.INSTANCE);
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  int lastReplayed=0;
  int expectedStoreFileCount=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    CompactionDescriptor compactionDesc=WALEdit.getCompaction(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      verifyData(secondaryRegion,0,lastReplayed,cq,families);
      Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
      long storeMemstoreSize=store.getMemStoreSize();
      long regionMemstoreSize=secondaryRegion.getMemstoreSize();
      long storeFlushableSize=store.getFlushableSize();
      long storeSize=store.getSize();
      long storeSizeUncompressed=store.getStoreSizeUncompressed();
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        LOG.info("-- Replaying flush start in secondary");
        PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(flushDesc);
        assertNull(result.result);
        assertEquals(result.flushOpSeqId,flushDesc.getFlushSequenceNumber());
        long newStoreMemstoreSize=store.getMemStoreSize();
        LOG.info("Memstore size reduced by:" + StringUtils.humanReadableInt(newStoreMemstoreSize - storeMemstoreSize));
        assertTrue(storeMemstoreSize > newStoreMemstoreSize);
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        LOG.info("-- Replaying flush commit in secondary");
        secondaryRegion.replayWALFlushCommitMarker(flushDesc);
        expectedStoreFileCount++;
        for (        Store s : secondaryRegion.getStores()) {
          assertEquals(expectedStoreFileCount,s.getStorefilesCount());
        }
        long newFlushableSize=store.getFlushableSize();
        assertTrue(storeFlushableSize > newFlushableSize);
        long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
        assertTrue(regionMemstoreSize > newRegionMemstoreSize);
        assertTrue(store.getSize() > storeSize);
        assertTrue(store.getStoreSizeUncompressed() > storeSizeUncompressed);
        assertEquals(store.getSize(),store.getStorefilesSize());
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else     if (compactionDesc != null) {
      secondaryRegion.replayWALCompactionMarker(compactionDesc,true,false,Long.MAX_VALUE);
      for (      Store store : secondaryRegion.getStores()) {
        if (store.getColumnFamilyName().equals("cf1")) {
          assertEquals(1,store.getStorefilesCount());
        }
 else {
          assertEquals(expectedStoreFileCount,store.getStorefilesCount());
        }
      }
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
      ;
    }
  }
  assertEquals(400 - 1,lastReplayed);
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,400,cq,families);
  LOG.info("-- Verifying edits from primary. Ensuring that files are not deleted");
  verifyData(primaryRegion,0,lastReplayed,cq,families);
  for (  Store store : primaryRegion.getStores()) {
    if (store.getColumnFamilyName().equals("cf1")) {
      assertEquals(1,store.getStorefilesCount());
    }
 else {
      assertEquals(expectedStoreFileCount,store.getStorefilesCount());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where we prepare a flush with some seqId and we receive a flush commit marker
 * less than the previous flush start marker.
 */
@Test public void testReplayFlushCommitMarkerSmallerThanFlushStartMarker() throws IOException {
  putDataWithFlushes(primaryRegion,100,200,100);
  int numRows=300;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  FlushDescriptor commitFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    System.out.println(lastReplayed);
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        if (startFlushDesc == null) {
          startFlushDesc=flushDesc;
        }
 else {
          LOG.info("-- Replaying flush start in secondary");
          startFlushDesc=flushDesc;
          PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
          assertNull(result.result);
        }
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        if (commitFlushDesc == null) {
          commitFlushDesc=flushDesc;
        }
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  long regionMemstoreSize=secondaryRegion.getMemstoreSize();
  LOG.info("Testing replaying flush COMMIT " + commitFlushDesc + " on top of flush START"+ startFlushDesc);
  assertTrue(commitFlushDesc.getFlushSequenceNumber() < startFlushDesc.getFlushSequenceNumber());
  LOG.info("-- Replaying flush commit in secondary" + commitFlushDesc);
  secondaryRegion.replayWALFlushCommitMarker(commitFlushDesc);
  expectedStoreFileCount++;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newFlushableSize=store.getFlushableSize();
  assertTrue(newFlushableSize > 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertEquals(regionMemstoreSize,newRegionMemstoreSize);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestKeyValueHeap </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws IOException {
  List<Cell> l1=new ArrayList<Cell>();
  l1.add(new KeyValue(row1,fam1,col5,data));
  l1.add(new KeyValue(row2,fam1,col1,data));
  l1.add(new KeyValue(row2,fam1,col2,data));
  scanners.add(new Scanner(l1));
  List<Cell> l2=new ArrayList<Cell>();
  l2.add(new KeyValue(row1,fam1,col1,data));
  l2.add(new KeyValue(row1,fam1,col2,data));
  scanners.add(new Scanner(l2));
  List<Cell> l3=new ArrayList<Cell>();
  l3.add(new KeyValue(row1,fam1,col3,data));
  l3.add(new KeyValue(row1,fam1,col4,data));
  l3.add(new KeyValue(row1,fam2,col1,data));
  l3.add(new KeyValue(row1,fam2,col2,data));
  l3.add(new KeyValue(row2,fam1,col3,data));
  scanners.add(new Scanner(l3));
  List<KeyValue> expected=new ArrayList<KeyValue>();
  expected.add(new KeyValue(row2,fam1,col1,data));
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparator.COMPARATOR);
  KeyValue seekKv=new KeyValue(row2,fam1,null,null);
  kvh.seek(seekKv);
  List<Cell> actual=new ArrayList<Cell>();
  actual.add(kvh.peek());
  assertEquals(expected.size(),actual.size());
  for (int i=0; i < expected.size(); i++) {
    assertEquals(expected.get(i),actual.get(i));
    if (PRINT) {
      System.out.println("expected " + expected.get(i) + "\nactual   "+ actual.get(i)+ "\n");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSorted() throws IOException {
  List<Cell> l1=new ArrayList<Cell>();
  l1.add(new KeyValue(row1,fam1,col5,data));
  l1.add(new KeyValue(row2,fam1,col1,data));
  l1.add(new KeyValue(row2,fam1,col2,data));
  scanners.add(new Scanner(l1));
  List<Cell> l2=new ArrayList<Cell>();
  l2.add(new KeyValue(row1,fam1,col1,data));
  l2.add(new KeyValue(row1,fam1,col2,data));
  scanners.add(new Scanner(l2));
  List<Cell> l3=new ArrayList<Cell>();
  l3.add(new KeyValue(row1,fam1,col3,data));
  l3.add(new KeyValue(row1,fam1,col4,data));
  l3.add(new KeyValue(row1,fam2,col1,data));
  l3.add(new KeyValue(row1,fam2,col2,data));
  l3.add(new KeyValue(row2,fam1,col3,data));
  scanners.add(new Scanner(l3));
  List<KeyValue> expected=new ArrayList<KeyValue>();
  expected.add(new KeyValue(row1,fam1,col1,data));
  expected.add(new KeyValue(row1,fam1,col2,data));
  expected.add(new KeyValue(row1,fam1,col3,data));
  expected.add(new KeyValue(row1,fam1,col4,data));
  expected.add(new KeyValue(row1,fam1,col5,data));
  expected.add(new KeyValue(row1,fam2,col1,data));
  expected.add(new KeyValue(row1,fam2,col2,data));
  expected.add(new KeyValue(row2,fam1,col1,data));
  expected.add(new KeyValue(row2,fam1,col2,data));
  expected.add(new KeyValue(row2,fam1,col3,data));
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparator.COMPARATOR);
  List<Cell> actual=new ArrayList<Cell>();
  while (kvh.peek() != null) {
    actual.add(kvh.next());
  }
  assertEquals(expected.size(),actual.size());
  for (int i=0; i < expected.size(); i++) {
    assertEquals(expected.get(i),actual.get(i));
    if (PRINT) {
      System.out.println("expected " + expected.get(i) + "\nactual   "+ actual.get(i)+ "\n");
    }
  }
  for (int i=0; i < actual.size() - 1; i++) {
    int ret=CellComparator.COMPARATOR.compare(actual.get(i),actual.get(i + 1));
    assertTrue(ret < 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMajorCompaction </h4><pre class="type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeBasedMajorCompaction() throws Exception {
  int delay=10 * 1000;
  float jitterPct=0.20f;
  conf.setLong(HConstants.MAJOR_COMPACTION_PERIOD,delay);
  conf.setFloat("hbase.hregion.majorcompaction.jitter",jitterPct);
  HStore s=((HStore)r.getStore(COLUMN_FAMILY));
  s.storeEngine.getCompactionPolicy().setConf(conf);
  try {
    createStoreFile(r);
    createStoreFile(r);
    r.compact(true);
    createStoreFile(r);
    r.compact(false);
    assertEquals(2,s.getStorefilesCount());
    RatioBasedCompactionPolicy c=(RatioBasedCompactionPolicy)s.storeEngine.getCompactionPolicy();
    Collection<StoreFile> storeFiles=s.getStorefiles();
    long mcTime=c.getNextMajorCompactTime(storeFiles);
    for (int i=0; i < 10; ++i) {
      assertEquals(mcTime,c.getNextMajorCompactTime(storeFiles));
    }
    long jitter=Math.round(delay * jitterPct);
    assertTrue(delay - jitter <= mcTime && mcTime <= delay + jitter);
    Thread.sleep(mcTime);
    r.compact(false);
    assertEquals(1,s.getStorefilesCount());
  }
  finally {
    conf.setLong(HConstants.MAJOR_COMPACTION_PERIOD,1000 * 60 * 60* 24);
    conf.setFloat("hbase.hregion.majorcompaction.jitter",0.20F);
    createStoreFile(r);
    r.compact(true);
    assertEquals(1,s.getStorefilesCount());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMemStoreChunkPool </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusingChunks(){
  Random rand=new Random();
  MemStoreLAB mslab=new HeapMemStoreLAB(conf);
  int expectedOff=0;
  byte[] lastBuffer=null;
  for (int i=0; i < 100; i++) {
    int size=rand.nextInt(1000);
    ByteRange alloc=mslab.allocateBytes(size);
    if (alloc.getBytes() != lastBuffer) {
      expectedOff=0;
      lastBuffer=alloc.getBytes();
    }
    assertEquals(expectedOff,alloc.getOffset());
    assertTrue("Allocation overruns buffer",alloc.getOffset() + size <= alloc.getBytes().length);
    expectedOff+=size;
  }
  mslab.close();
  int chunkCount=chunkPool.getPoolSize();
  assertTrue(chunkCount > 0);
  mslab=new HeapMemStoreLAB(conf);
  mslab.allocateBytes(1000);
  assertEquals(chunkCount - 1,chunkPool.getPoolSize());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMemStoreLAB </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a bunch of random allocations
 */
@Test public void testLABRandomAllocation(){
  Random rand=new Random();
  MemStoreLAB mslab=new HeapMemStoreLAB();
  int expectedOff=0;
  byte[] lastBuffer=null;
  for (int i=0; i < 100000; i++) {
    int size=rand.nextInt(1000);
    ByteRange alloc=mslab.allocateBytes(size);
    if (alloc.getBytes() != lastBuffer) {
      expectedOff=0;
      lastBuffer=alloc.getBytes();
    }
    assertEquals(expectedOff,alloc.getOffset());
    assertTrue("Allocation overruns buffer",alloc.getOffset() + size <= alloc.getBytes().length);
    expectedOff+=size;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMobStoreCompaction </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMajorCompactionAfterDelete() throws Exception {
  init(UTIL.getConfiguration(),100);
  byte[] dummyData=makeDummyData(200);
  Table loader=new RegionAsTable(region);
  int numHfiles=compactionThreshold - 1;
  byte[] deleteRow=Bytes.add(STARTROW,Bytes.toBytes(0));
  for (int i=0; i < numHfiles; i++) {
    Put p=createPut(i,dummyData);
    loader.put(p);
    region.flush(true);
  }
  assertEquals("Before compaction: store files",numHfiles,countStoreFiles());
  assertEquals("Before compaction: mob file count",numHfiles,countMobFiles());
  assertEquals("Before compaction: rows",numHfiles,countRows());
  assertEquals("Before compaction: mob rows",numHfiles,countMobRows());
  assertEquals("Before compaction: number of mob cells",numHfiles,countMobCellsInMetadata());
  Delete delete=new Delete(deleteRow);
  delete.addFamily(COLUMN_FAMILY);
  region.delete(delete);
  region.flush(true);
  assertEquals("Before compaction: store files",numHfiles + 1,countStoreFiles());
  assertEquals("Before compaction: mob files",numHfiles,countMobFiles());
  region.compact(true);
  assertEquals("After compaction: store files",1,countStoreFiles());
  assertEquals("After compaction: mob files",numHfiles + 1,countMobFiles());
  Scan scan=new Scan();
  scan.setRaw(true);
  InternalScanner scanner=region.getScanner(scan);
  List<Cell> results=new ArrayList<>();
  scanner.next(results);
  int deleteCount=0;
  while (!results.isEmpty()) {
    for (    Cell c : results) {
      if (c.getTypeByte() == KeyValue.Type.DeleteFamily.getCode()) {
        deleteCount++;
        assertTrue(Bytes.equals(CellUtil.cloneRow(c),deleteRow));
      }
    }
    results.clear();
    scanner.next(results);
  }
  assertEquals(0,deleteCount);
  scanner.close();
  assertEquals("The cells in mob files",numHfiles - 1,countMobCellsInMobFiles(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMultiColumnScanner </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColumnScanner() throws IOException {
  Region region=TEST_UTIL.createTestRegion(TABLE_NAME,new HColumnDescriptor(FAMILY).setCompressionType(comprAlgo).setBloomFilterType(bloomType).setMaxVersions(MAX_VERSIONS).setDataBlockEncoding(dataBlockEncoding));
  List<String> rows=sequentialStrings("row",NUM_ROWS);
  List<String> qualifiers=sequentialStrings("qual",NUM_COLUMNS);
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  Set<String> keySet=new HashSet<String>();
  Map<String,Long> lastDelTimeMap=new HashMap<String,Long>();
  Random rand=new Random(29372937L);
  Set<String> rowQualSkip=new HashSet<String>();
  for (  String row : rows)   for (  String qual : qualifiers)   if (rand.nextDouble() < COLUMN_SKIP_IN_ROW_PROB) {
    LOG.info("Skipping " + qual + " in row "+ row);
    rowQualSkip.add(rowQualKey(row,qual));
  }
  for (  String qual : qualifiers)   if (rand.nextDouble() < COLUMN_SKIP_EVERYWHERE_PROB) {
    LOG.info("Skipping " + qual + " in all rows");
    for (    String row : rows)     rowQualSkip.add(rowQualKey(row,qual));
  }
  for (int iFlush=0; iFlush < NUM_FLUSHES; ++iFlush) {
    for (    String qual : qualifiers) {
      if (rand.nextDouble() < COLUMN_SKIP_IN_STORE_FILE_PROB)       continue;
      byte[] qualBytes=Bytes.toBytes(qual);
      for (      String row : rows) {
        Put p=new Put(Bytes.toBytes(row));
        for (        long ts : TIMESTAMPS) {
          String value=createValue(row,qual,ts);
          KeyValue kv=KeyValueTestUtil.create(row,FAMILY,qual,ts,value);
          assertEquals(kv.getTimestamp(),ts);
          p.add(kv);
          String keyAsString=kv.toString();
          if (!keySet.contains(keyAsString)) {
            keySet.add(keyAsString);
            kvs.add(kv);
          }
        }
        region.put(p);
        Delete d=new Delete(Bytes.toBytes(row));
        boolean deletedSomething=false;
        for (        long ts : TIMESTAMPS)         if (rand.nextDouble() < DELETE_PROBABILITY) {
          d.addColumns(FAMILY_BYTES,qualBytes,ts);
          String rowAndQual=row + "_" + qual;
          Long whenDeleted=lastDelTimeMap.get(rowAndQual);
          lastDelTimeMap.put(rowAndQual,whenDeleted == null ? ts : Math.max(ts,whenDeleted));
          deletedSomething=true;
        }
        if (deletedSomething)         region.delete(d);
      }
    }
    region.flush(true);
  }
  Collections.sort(kvs,CellComparator.COMPARATOR);
  for (int maxVersions=1; maxVersions <= TIMESTAMPS.length; ++maxVersions) {
    for (int columnBitMask=1; columnBitMask <= MAX_COLUMN_BIT_MASK; ++columnBitMask) {
      Scan scan=new Scan();
      scan.setMaxVersions(maxVersions);
      Set<String> qualSet=new TreeSet<String>();
{
        int columnMaskTmp=columnBitMask;
        for (        String qual : qualifiers) {
          if ((columnMaskTmp & 1) != 0) {
            scan.addColumn(FAMILY_BYTES,Bytes.toBytes(qual));
            qualSet.add(qual);
          }
          columnMaskTmp>>=1;
        }
        assertEquals(0,columnMaskTmp);
      }
      InternalScanner scanner=region.getScanner(scan);
      List<Cell> results=new ArrayList<Cell>();
      int kvPos=0;
      int numResults=0;
      String queryInfo="columns queried: " + qualSet + " (columnBitMask="+ columnBitMask+ "), maxVersions="+ maxVersions;
      while (scanner.next(results) || results.size() > 0) {
        for (        Cell kv : results) {
          while (kvPos < kvs.size() && !matchesQuery(kvs.get(kvPos),qualSet,maxVersions,lastDelTimeMap)) {
            ++kvPos;
          }
          String rowQual=getRowQualStr(kv);
          String deleteInfo="";
          Long lastDelTS=lastDelTimeMap.get(rowQual);
          if (lastDelTS != null) {
            deleteInfo="; last timestamp when row/column " + rowQual + " was deleted: "+ lastDelTS;
          }
          assertTrue("Scanner returned additional key/value: " + kv + ", "+ queryInfo+ deleteInfo+ ";",kvPos < kvs.size());
          assertTrue("Scanner returned wrong key/value; " + queryInfo + deleteInfo+ ";",CellUtil.equalsIgnoreMvccVersion(kvs.get(kvPos),(kv)));
          ++kvPos;
          ++numResults;
        }
        results.clear();
      }
      for (; kvPos < kvs.size(); ++kvPos) {
        KeyValue remainingKV=kvs.get(kvPos);
        assertFalse("Matching column not returned by scanner: " + remainingKV + ", "+ queryInfo+ ", results returned: "+ numResults,matchesQuery(remainingKV,qualSet,maxVersions,lastDelTimeMap));
      }
    }
  }
  assertTrue("This test is supposed to delete at least some row/column " + "pairs",lastDelTimeMap.size() > 0);
  LOG.info("Number of row/col pairs deleted at least once: " + lastDelTimeMap.size());
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When a log roll is about to happen, we do a flush of the regions who will be affected by the
 * log roll. These flushes cannot be a selective flushes, otherwise we cannot roll the logs. This
 * test ensures that we do a full-flush in that scenario.
 * @throws IOException
 */
@Test(timeout=180000) public void testFlushingWhenLogRolling() throws Exception {
  TableName tableName=TableName.valueOf("testFlushingWhenLogRolling");
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setLong(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,128 * 1024 * 1024);
  conf.set(FlushPolicyFactory.HBASE_FLUSH_POLICY_KEY,FlushLargeStoresPolicy.class.getName());
  long cfFlushSizeLowerBound=2048;
  conf.setLong(FlushLargeStoresPolicy.HREGION_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND_MIN,cfFlushSizeLowerBound);
  conf.setLong("hbase.regionserver.logroll.period",60L * 60 * 1000);
  conf.setLong("hbase.regionserver.hlog.blocksize",128L * 1024 * 1024);
  final int maxLogs=10;
  conf.setInt("hbase.regionserver.maxlogs",maxLogs);
  final int numRegionServers=1;
  TEST_UTIL.startMiniCluster(numRegionServers);
  try {
    Table table=TEST_UTIL.createTable(tableName,FAMILIES);
    try (Admin admin=TEST_UTIL.getConnection().getAdmin()){
      admin.flush(TableName.NAMESPACE_TABLE_NAME);
    }
     Pair<Region,HRegionServer> desiredRegionAndServer=getRegionWithName(tableName);
    final Region desiredRegion=desiredRegionAndServer.getFirst();
    assertTrue("Could not find a region which hosts the new region.",desiredRegion != null);
    LOG.info("Writing to region=" + desiredRegion);
    for (int i=1; i <= 3; i++) {
      table.put(createPut(i,0));
    }
    for (int i=0; i < maxLogs; i++) {
      for (int j=0; j < 100; j++) {
        table.put(createPut(1,i * 100 + j));
      }
      int currentNumRolledLogFiles=getNumRolledLogFiles(desiredRegion);
      assertNull(getWAL(desiredRegion).rollWriter());
      while (getNumRolledLogFiles(desiredRegion) <= currentNumRolledLogFiles) {
        Thread.sleep(100);
      }
    }
    table.close();
    assertEquals(maxLogs,getNumRolledLogFiles(desiredRegion));
    assertTrue(desiredRegion.getStore(FAMILY1).getMemStoreSize() > cfFlushSizeLowerBound);
    assertTrue(desiredRegion.getStore(FAMILY2).getMemStoreSize() < cfFlushSizeLowerBound);
    assertTrue(desiredRegion.getStore(FAMILY3).getMemStoreSize() < cfFlushSizeLowerBound);
    table.put(createPut(1,12345678));
    desiredRegionAndServer.getSecond().walRoller.requestRollAll();
    TEST_UTIL.waitFor(30000,new Waiter.ExplainingPredicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return desiredRegion.getMemstoreSize() == 0;
      }
      @Override public String explainFailure() throws Exception {
        long memstoreSize=desiredRegion.getMemstoreSize();
        if (memstoreSize > 0) {
          return "Still have unflushed entries in memstore, memstore size is " + memstoreSize;
        }
        return "Unknown";
      }
    }
);
    LOG.info("Finished waiting on flush after too many WALs...");
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY1).getMemStoreSize());
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY2).getMemStoreSize());
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY3).getMemStoreSize());
    assertNull(getWAL(desiredRegion).rollWriter(true));
    assertTrue(getNumRolledLogFiles(desiredRegion) < maxLogs);
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestQueryMatcher </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMatch_Wildcard() throws IOException {
  List<MatchCode> expected=new ArrayList<ScanQueryMatcher.MatchCode>();
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.DONE);
  long now=EnvironmentEdgeManager.currentTime();
  ScanQueryMatcher qm=new ScanQueryMatcher(scan,new ScanInfo(this.conf,fam2,0,1,ttl,KeepDeletedCells.FALSE,0,rowComparator),null,now - ttl,now);
  List<KeyValue> memstore=new ArrayList<KeyValue>();
  memstore.add(new KeyValue(row1,fam2,col1,1,data));
  memstore.add(new KeyValue(row1,fam2,col2,1,data));
  memstore.add(new KeyValue(row1,fam2,col3,1,data));
  memstore.add(new KeyValue(row1,fam2,col4,1,data));
  memstore.add(new KeyValue(row1,fam2,col5,1,data));
  memstore.add(new KeyValue(row2,fam1,col1,1,data));
  List<ScanQueryMatcher.MatchCode> actual=new ArrayList<ScanQueryMatcher.MatchCode>();
  KeyValue k=memstore.get(0);
  qm.setToNewRow(k);
  for (  KeyValue kv : memstore) {
    actual.add(qm.match(kv));
  }
  assertEquals(expected.size(),actual.size());
  for (int i=0; i < expected.size(); i++) {
    assertEquals(expected.get(i),actual.get(i));
    if (PRINT) {
      System.out.println("expected " + expected.get(i) + ", actual "+ actual.get(i));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Verify that {@link ScanQueryMatcher} only skips expired KeyValue
 * instances and does not exit early from the row (skipping
 * later non-expired KeyValues).  This version mimics a Get with
 * explicitly specified column qualifiers.
 * @throws IOException
 */
@Test public void testMatch_ExpiredExplicit() throws IOException {
  long testTTL=1000;
  MatchCode[] expected=new MatchCode[]{ScanQueryMatcher.MatchCode.SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW,ScanQueryMatcher.MatchCode.DONE};
  long now=EnvironmentEdgeManager.currentTime();
  ScanQueryMatcher qm=new ScanQueryMatcher(scan,new ScanInfo(this.conf,fam2,0,1,testTTL,KeepDeletedCells.FALSE,0,rowComparator),get.getFamilyMap().get(fam2),now - testTTL,now);
  KeyValue[] kvs=new KeyValue[]{new KeyValue(row1,fam2,col1,now - 100,data),new KeyValue(row1,fam2,col2,now - 50,data),new KeyValue(row1,fam2,col3,now - 5000,data),new KeyValue(row1,fam2,col4,now - 500,data),new KeyValue(row1,fam2,col5,now - 10000,data),new KeyValue(row2,fam1,col1,now - 10,data)};
  KeyValue k=kvs[0];
  qm.setToNewRow(k);
  List<MatchCode> actual=new ArrayList<MatchCode>(kvs.length);
  for (  KeyValue kv : kvs) {
    actual.add(qm.match(kv));
  }
  assertEquals(expected.length,actual.size());
  for (int i=0; i < expected.length; i++) {
    if (PRINT) {
      System.out.println("expected " + expected[i] + ", actual "+ actual.get(i));
    }
    assertEquals(expected[i],actual.get(i));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Verify that {@link ScanQueryMatcher} only skips expired KeyValue
 * instances and does not exit early from the row (skipping
 * later non-expired KeyValues).  This version mimics a Get with
 * wildcard-inferred column qualifiers.
 * @throws IOException
 */
@Test public void testMatch_ExpiredWildcard() throws IOException {
  long testTTL=1000;
  MatchCode[] expected=new MatchCode[]{ScanQueryMatcher.MatchCode.INCLUDE,ScanQueryMatcher.MatchCode.INCLUDE,ScanQueryMatcher.MatchCode.SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.INCLUDE,ScanQueryMatcher.MatchCode.SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.DONE};
  long now=EnvironmentEdgeManager.currentTime();
  ScanQueryMatcher qm=new ScanQueryMatcher(scan,new ScanInfo(this.conf,fam2,0,1,testTTL,KeepDeletedCells.FALSE,0,rowComparator),null,now - testTTL,now);
  KeyValue[] kvs=new KeyValue[]{new KeyValue(row1,fam2,col1,now - 100,data),new KeyValue(row1,fam2,col2,now - 50,data),new KeyValue(row1,fam2,col3,now - 5000,data),new KeyValue(row1,fam2,col4,now - 500,data),new KeyValue(row1,fam2,col5,now - 10000,data),new KeyValue(row2,fam1,col1,now - 10,data)};
  KeyValue k=kvs[0];
  qm.setToNewRow(k);
  List<ScanQueryMatcher.MatchCode> actual=new ArrayList<ScanQueryMatcher.MatchCode>(kvs.length);
  for (  KeyValue kv : kvs) {
    actual.add(qm.match(kv));
  }
  assertEquals(expected.length,actual.size());
  for (int i=0; i < expected.length; i++) {
    if (PRINT) {
      System.out.println("expected " + expected[i] + ", actual "+ actual.get(i));
    }
    assertEquals(expected[i],actual.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionFavoredNodes </h4><pre class="type-9 type-11 type-21 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFavoredNodes() throws Exception {
  Assume.assumeTrue(createWithFavoredNode != null);
  InetSocketAddress[] nodes=new InetSocketAddress[REGION_SERVERS];
  List<DataNode> datanodes=TEST_UTIL.getDFSCluster().getDataNodes();
  Method selfAddress;
  try {
    selfAddress=DataNode.class.getMethod("getSelfAddr");
  }
 catch (  NoSuchMethodException ne) {
    selfAddress=DataNode.class.getMethod("getXferAddress");
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    nodes[i]=(InetSocketAddress)selfAddress.invoke(datanodes.get(i));
  }
  String[] nodeNames=new String[REGION_SERVERS];
  for (int i=0; i < REGION_SERVERS; i++) {
    nodeNames[i]=nodes[i].getAddress().getHostAddress() + ":" + nodes[i].getPort();
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    HRegionServer server=TEST_UTIL.getHBaseCluster().getRegionServer(i);
    List<Region> regions=server.getOnlineRegions(TABLE_NAME);
    for (    Region region : regions) {
      List<org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName> favoredNodes=new ArrayList<org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName>(3);
      String encodedRegionName=region.getRegionInfo().getEncodedName();
      for (int j=0; j < FAVORED_NODES_NUM; j++) {
        org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName.Builder b=org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName.newBuilder();
        b.setHostName(nodes[(i + j) % REGION_SERVERS].getAddress().getHostAddress());
        b.setPort(nodes[(i + j) % REGION_SERVERS].getPort());
        b.setStartCode(-1);
        favoredNodes.add(b.build());
      }
      server.updateRegionFavoredNodesMapping(encodedRegionName,favoredNodes);
    }
  }
  for (int i=0; i < FLUSHES; i++) {
    TEST_UTIL.loadTable(table,COLUMN_FAMILY,false);
    TEST_UTIL.flush();
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    HRegionServer server=TEST_UTIL.getHBaseCluster().getRegionServer(i);
    List<Region> regions=server.getOnlineRegions(TABLE_NAME);
    for (    Region region : regions) {
      List<String> files=region.getStoreFileList(new byte[][]{COLUMN_FAMILY});
      for (      String file : files) {
        FileStatus status=TEST_UTIL.getDFSCluster().getFileSystem().getFileStatus(new Path(new URI(file).getPath()));
        BlockLocation[] lbks=((DistributedFileSystem)TEST_UTIL.getDFSCluster().getFileSystem()).getFileBlockLocations(status,0,Long.MAX_VALUE);
        for (        BlockLocation lbk : lbks) {
          locations:           for (          String info : lbk.getNames()) {
            for (int j=0; j < FAVORED_NODES_NUM; j++) {
              if (info.equals(nodeNames[(i + j) % REGION_SERVERS])) {
                continue locations;
              }
            }
            fail("Block location " + info + " not a favored node");
          }
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionMergeTransactionOnCluster </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWholesomeMerge() throws Exception {
  LOG.info("Starting testWholesomeMerge");
  final TableName tableName=TableName.valueOf("testWholesomeMerge");
  Table table=createTableAndLoadData(master,tableName);
  mergeRegionsAndVerifyRegionNum(master,tableName,0,1,INITIAL_REGION_NUM - 1);
  PairOfSameType<HRegionInfo> mergedRegions=mergeRegionsAndVerifyRegionNum(master,tableName,1,2,INITIAL_REGION_NUM - 2);
  verifyRowCount(table,ROWSIZE);
  HRegionInfo hri=RandomUtils.nextBoolean() ? mergedRegions.getFirst() : mergedRegions.getSecond();
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  AssignmentManager am=cluster.getMaster().getAssignmentManager();
  RegionStates regionStates=am.getRegionStates();
  long start=EnvironmentEdgeManager.currentTime();
  while (!regionStates.isRegionInState(hri,State.MERGED)) {
    assertFalse("Timed out in waiting one merged region to be in state MERGED",EnvironmentEdgeManager.currentTime() - start > 60000);
    Thread.sleep(500);
  }
  am.assign(hri,true);
  assertFalse("Merged region can't be assigned",regionStates.isRegionInTransition(hri));
  assertTrue(regionStates.isRegionInState(hri,State.MERGED));
  am.unassign(hri,null);
  assertFalse("Merged region can't be unassigned",regionStates.isRegionInTransition(hri));
  assertTrue(regionStates.isRegionInState(hri,State.MERGED));
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerHostname </h4><pre class="type-4 type-9 type-7 type-8 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test(timeout=120000) public void testRegionServerHostname() throws Exception {
  final int NUM_MASTERS=1;
  final int NUM_RS=1;
  Enumeration<NetworkInterface> netInterfaceList=NetworkInterface.getNetworkInterfaces();
  while (netInterfaceList.hasMoreElements()) {
    NetworkInterface ni=netInterfaceList.nextElement();
    Enumeration<InetAddress> addrList=ni.getInetAddresses();
    while (addrList.hasMoreElements()) {
      InetAddress addr=addrList.nextElement();
      if (addr.isLoopbackAddress() || addr.isLinkLocalAddress() || addr.isMulticastAddress()) {
        continue;
      }
      String hostName=addr.getHostName();
      LOG.info("Found " + hostName + " on "+ ni);
      TEST_UTIL.getConfiguration().set(HRegionServer.MASTER_HOSTNAME_KEY,hostName);
      TEST_UTIL.getConfiguration().set(HRegionServer.RS_HOSTNAME_KEY,hostName);
      TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
      try {
        ZooKeeperWatcher zkw=TEST_UTIL.getZooKeeperWatcher();
        List<String> servers=ZKUtil.listChildrenNoWatch(zkw,zkw.rsZNode);
        assertTrue(servers.size() == NUM_RS + 1);
        for (        String server : servers) {
          assertTrue("From zookeeper: " + server + " hostname: "+ hostName,server.startsWith(hostName.toLowerCase() + ","));
        }
        zkw.close();
      }
  finally {
        TEST_UTIL.shutdownMiniCluster();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerMetrics </h4><pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanNextForSmallScan() throws IOException {
  String tableNameString="testScanNextSmall";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("One");
  List<Put> puts=new ArrayList<>();
  for (int insertCount=0; insertCount < 100; insertCount++) {
    Put p=new Put(Bytes.toBytes("" + insertCount + "row"));
    p.addColumn(cf,qualifier,val);
    puts.add(p);
  }
  try (Table t=TEST_UTIL.createTable(tableName,cf)){
    t.put(puts);
    Scan s=new Scan();
    s.setSmall(true);
    s.setCaching(1);
    ResultScanner resultScanners=t.getScanner(s);
    for (int nextCount=0; nextCount < NUM_SCAN_NEXT; nextCount++) {
      Result result=resultScanners.next();
      assertNotNull(result);
      assertEquals(1,result.size());
    }
  }
   numScanNext+=NUM_SCAN_NEXT;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    for (    HRegionLocation location : locator.getAllRegionLocations()) {
      HRegionInfo i=location.getRegionInfo();
      MetricsRegionAggregateSource agg=rs.getRegion(i.getRegionName()).getMetrics().getSource().getAggregateSource();
      String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ i.getEncodedName()+ "_metric";
      metricsHelper.assertCounter(prefix + "_scanNextNumOps",NUM_SCAN_NEXT,agg);
    }
    metricsHelper.assertCounter("ScanNext_num_ops",numScanNext,serverSource);
  }
   try (Admin admin=TEST_UTIL.getHBaseAdmin()){
    admin.disableTable(tableName);
    admin.deleteTable(tableName);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanNext() throws IOException {
  String tableNameString="testScanNext";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("One");
  List<Put> puts=new ArrayList<>();
  for (int insertCount=0; insertCount < 100; insertCount++) {
    Put p=new Put(Bytes.toBytes("" + insertCount + "row"));
    p.addColumn(cf,qualifier,val);
    puts.add(p);
  }
  try (Table t=TEST_UTIL.createTable(tableName,cf)){
    t.put(puts);
    Scan s=new Scan();
    s.setBatch(1);
    s.setCaching(1);
    ResultScanner resultScanners=t.getScanner(s);
    for (int nextCount=0; nextCount < NUM_SCAN_NEXT; nextCount++) {
      Result result=resultScanners.next();
      assertNotNull(result);
      assertEquals(1,result.size());
    }
  }
   numScanNext+=NUM_SCAN_NEXT;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    for (    HRegionLocation location : locator.getAllRegionLocations()) {
      HRegionInfo i=location.getRegionInfo();
      MetricsRegionAggregateSource agg=rs.getRegion(i.getRegionName()).getMetrics().getSource().getAggregateSource();
      String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ i.getEncodedName()+ "_metric";
      metricsHelper.assertCounter(prefix + "_scanNextNumOps",NUM_SCAN_NEXT,agg);
    }
    metricsHelper.assertCounter("ScanNext_num_ops",numScanNext,serverSource);
  }
   try (Admin admin=TEST_UTIL.getHBaseAdmin()){
    admin.disableTable(tableName);
    admin.deleteTable(tableName);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerNoMaster </h4><pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test(timeout=60000) public void testMultipleCloseFromMaster() throws Exception {
  for (int i=0; i < 10; i++) {
    AdminProtos.CloseRegionRequest crr=RequestConverter.buildCloseRegionRequest(getRS().getServerName(),regionName,null);
    try {
      AdminProtos.CloseRegionResponse responseClose=getRS().rpcServices.closeRegion(null,crr);
      Assert.assertTrue("request " + i + " failed",responseClose.getClosed() || responseClose.hasClosed());
    }
 catch (    ServiceException se) {
      Assert.assertTrue("The next queries may throw an exception.",i > 0);
    }
  }
  checkRegionIsClosed(HTU,getRS(),hri);
  openRegion(HTU,getRS(),hri);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestResettingCounters </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResettingCounters() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  Configuration conf=htu.getConfiguration();
  FileSystem fs=FileSystem.get(conf);
  byte[] table=Bytes.toBytes("table");
  byte[][] families=new byte[][]{Bytes.toBytes("family1"),Bytes.toBytes("family2"),Bytes.toBytes("family3")};
  int numQualifiers=10;
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++)   qualifiers[i]=Bytes.toBytes("qf" + i);
  int numRows=10;
  byte[][] rows=new byte[numRows][];
  for (int i=0; i < numRows; i++)   rows[i]=Bytes.toBytes("r" + i);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(table));
  for (  byte[] family : families)   htd.addFamily(new HColumnDescriptor(family));
  HRegionInfo hri=new HRegionInfo(htd.getTableName(),null,null,false);
  String testDir=htu.getDataTestDir() + "/TestResettingCounters/";
  Path path=new Path(testDir);
  if (fs.exists(path)) {
    if (!fs.delete(path,true)) {
      throw new IOException("Failed delete of " + path);
    }
  }
  Region region=HBaseTestingUtility.createRegionAndWAL(hri,path,conf,htd);
  try {
    Increment odd=new Increment(rows[0]);
    odd.setDurability(Durability.SKIP_WAL);
    Increment even=new Increment(rows[0]);
    even.setDurability(Durability.SKIP_WAL);
    Increment all=new Increment(rows[0]);
    all.setDurability(Durability.SKIP_WAL);
    for (int i=0; i < numQualifiers; i++) {
      if (i % 2 == 0)       even.addColumn(families[0],qualifiers[i],1);
 else       odd.addColumn(families[0],qualifiers[i],1);
      all.addColumn(families[0],qualifiers[i],1);
    }
    for (int i=0; i < 5; i++)     region.increment(odd,HConstants.NO_NONCE,HConstants.NO_NONCE);
    region.flush(true);
    for (int i=0; i < 5; i++)     region.increment(even,HConstants.NO_NONCE,HConstants.NO_NONCE);
    Result result=region.increment(all,HConstants.NO_NONCE,HConstants.NO_NONCE);
    assertEquals(numQualifiers,result.size());
    Cell[] kvs=result.rawCells();
    for (int i=0; i < kvs.length; i++) {
      System.out.println(kvs[i].toString());
      assertTrue(CellUtil.matchingQualifier(kvs[i],qualifiers[i]));
      assertEquals(6,Bytes.toLong(CellUtil.cloneValue(kvs[i])));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestReversibleScanners </h4><pre class="type-4 type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReversibleKeyValueHeap() throws IOException {
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  Path hfilePath=new Path(new Path(TEST_UTIL.getDataTestDir("testReversibleKeyValueHeap"),"regionname"),"familyname");
  CacheConfig cacheConf=new CacheConfig(TEST_UTIL.getConfiguration());
  HFileContextBuilder hcBuilder=new HFileContextBuilder();
  hcBuilder.withBlockSize(2 * 1024);
  HFileContext hFileContext=hcBuilder.build();
  StoreFile.Writer writer1=new StoreFile.WriterBuilder(TEST_UTIL.getConfiguration(),cacheConf,fs).withOutputDir(hfilePath).withFileContext(hFileContext).build();
  StoreFile.Writer writer2=new StoreFile.WriterBuilder(TEST_UTIL.getConfiguration(),cacheConf,fs).withOutputDir(hfilePath).withFileContext(hFileContext).build();
  MemStore memstore=new DefaultMemStore();
  writeMemstoreAndStoreFiles(memstore,new StoreFile.Writer[]{writer1,writer2});
  StoreFile sf1=new StoreFile(fs,writer1.getPath(),TEST_UTIL.getConfiguration(),cacheConf,BloomType.NONE);
  StoreFile sf2=new StoreFile(fs,writer2.getPath(),TEST_UTIL.getConfiguration(),cacheConf,BloomType.NONE);
  int startRowNum=ROWSIZE / 2;
  ReversedKeyValueHeap kvHeap=getReversibleKeyValueHeap(memstore,sf1,sf2,ROWS[startRowNum],MAXMVCC);
  internalTestSeekAndNextForReversibleKeyValueHeap(kvHeap,startRowNum);
  startRowNum=ROWSIZE - 1;
  kvHeap=getReversibleKeyValueHeap(memstore,sf1,sf2,HConstants.EMPTY_START_ROW,MAXMVCC);
  internalTestSeekAndNextForReversibleKeyValueHeap(kvHeap,startRowNum);
  for (int readPoint=0; readPoint < MAXMVCC; readPoint++) {
    LOG.info("Setting read point to " + readPoint);
    startRowNum=ROWSIZE - 1;
    kvHeap=getReversibleKeyValueHeap(memstore,sf1,sf2,HConstants.EMPTY_START_ROW,readPoint);
    for (int i=startRowNum; i >= 0; i--) {
      if (i - 2 < 0)       break;
      i=i - 2;
      kvHeap.seekToPreviousRow(KeyValueUtil.createFirstOnRow(ROWS[i + 1]));
      Pair<Integer,Integer> nextReadableNum=getNextReadableNumWithBackwardScan(i,0,readPoint);
      if (nextReadableNum == null)       break;
      KeyValue expecedKey=makeKV(nextReadableNum.getFirst(),nextReadableNum.getSecond());
      assertEquals(expecedKey,kvHeap.peek());
      i=nextReadableNum.getFirst();
      int qualNum=nextReadableNum.getSecond();
      if (qualNum + 1 < QUALSIZE) {
        kvHeap.backwardSeek(makeKV(i,qualNum + 1));
        nextReadableNum=getNextReadableNumWithBackwardScan(i,qualNum + 1,readPoint);
        if (nextReadableNum == null)         break;
        expecedKey=makeKV(nextReadableNum.getFirst(),nextReadableNum.getSecond());
        assertEquals(expecedKey,kvHeap.peek());
        i=nextReadableNum.getFirst();
        qualNum=nextReadableNum.getSecond();
      }
      kvHeap.next();
      if (qualNum + 1 >= QUALSIZE) {
        nextReadableNum=getNextReadableNumWithBackwardScan(i - 1,0,readPoint);
      }
 else {
        nextReadableNum=getNextReadableNumWithBackwardScan(i,qualNum + 1,readPoint);
      }
      if (nextReadableNum == null)       break;
      expecedKey=makeKV(nextReadableNum.getFirst(),nextReadableNum.getSecond());
      assertEquals(expecedKey,kvHeap.peek());
      i=nextReadableNum.getFirst();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScanner </h4><pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test basic stop row filter works.
 * @throws Exception
 */
@Test public void testStopRow() throws Exception {
  byte[] startrow=Bytes.toBytes("bbb");
  byte[] stoprow=Bytes.toBytes("ccc");
  try {
    this.region=TEST_UTIL.createLocalHRegion(TESTTABLEDESC,null,null);
    HBaseTestCase.addContent(this.region,HConstants.CATALOG_FAMILY);
    List<Cell> results=new ArrayList<Cell>();
    Scan scan=new Scan(Bytes.toBytes("abc"),Bytes.toBytes("abd"));
    scan.addFamily(HConstants.CATALOG_FAMILY);
    InternalScanner s=region.getScanner(scan);
    int count=0;
    while (s.next(results)) {
      count++;
    }
    s.close();
    assertEquals(0,count);
    scan=new Scan(startrow,stoprow);
    scan.addFamily(HConstants.CATALOG_FAMILY);
    s=region.getScanner(scan);
    count=0;
    Cell kv=null;
    results=new ArrayList<Cell>();
    for (boolean first=true; s.next(results); ) {
      kv=results.get(0);
      if (first) {
        assertTrue(CellUtil.matchingRow(kv,startrow));
        first=false;
      }
      count++;
    }
    assertTrue(Bytes.BYTES_COMPARATOR.compare(stoprow,CellUtil.cloneRow(kv)) > 0);
    assertTrue(count > 10);
    s.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScannerWithBulkload </h4><pre class="type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBulkLoad() throws Exception {
  TableName tableName=TableName.valueOf("testBulkLoad");
  long l=System.currentTimeMillis();
  Admin admin=TEST_UTIL.getHBaseAdmin();
  createTable(admin,tableName);
  Scan scan=createScan();
  final Table table=init(admin,l,scan,tableName);
  final Path hfilePath=writeToHFile(l,"/temp/testBulkLoad/","/temp/testBulkLoad/col/file",false);
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setBoolean("hbase.mapreduce.bulkload.assign.sequenceNumbers",true);
  final LoadIncrementalHFiles bulkload=new LoadIncrementalHFiles(conf);
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    bulkload.doBulkLoad(hfilePath,admin,table,locator);
  }
   ResultScanner scanner=table.getScanner(scan);
  Result result=scanner.next();
  result=scanAfterBulkLoad(scanner,result,"version2");
  Put put0=new Put(Bytes.toBytes("row1"));
  put0.add(new KeyValue(Bytes.toBytes("row1"),Bytes.toBytes("col"),Bytes.toBytes("q"),l,Bytes.toBytes("version3")));
  table.put(put0);
  admin.flush(tableName);
  scanner=table.getScanner(scan);
  result=scanner.next();
  while (result != null) {
    List<Cell> cells=result.getColumnCells(Bytes.toBytes("col"),Bytes.toBytes("q"));
    for (    Cell _c : cells) {
      if (Bytes.toString(_c.getRowArray(),_c.getRowOffset(),_c.getRowLength()).equals("row1")) {
        System.out.println(Bytes.toString(_c.getRowArray(),_c.getRowOffset(),_c.getRowLength()));
        System.out.println(Bytes.toString(_c.getQualifierArray(),_c.getQualifierOffset(),_c.getQualifierLength()));
        System.out.println(Bytes.toString(_c.getValueArray(),_c.getValueOffset(),_c.getValueLength()));
        Assert.assertEquals("version3",Bytes.toString(_c.getValueArray(),_c.getValueOffset(),_c.getValueLength()));
      }
    }
    result=scanner.next();
  }
  scanner.close();
  table.close();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBulkLoadNativeHFile() throws Exception {
  TableName tableName=TableName.valueOf("testBulkLoadNativeHFile");
  long l=System.currentTimeMillis();
  Admin admin=TEST_UTIL.getHBaseAdmin();
  createTable(admin,tableName);
  Scan scan=createScan();
  final Table table=init(admin,l,scan,tableName);
  final Path hfilePath=writeToHFile(l,"/temp/testBulkLoadNativeHFile/","/temp/testBulkLoadNativeHFile/col/file",true);
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setBoolean("hbase.mapreduce.bulkload.assign.sequenceNumbers",true);
  final LoadIncrementalHFiles bulkload=new LoadIncrementalHFiles(conf);
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    bulkload.doBulkLoad(hfilePath,admin,table,locator);
  }
   ResultScanner scanner=table.getScanner(scan);
  Result result=scanner.next();
  result=scanAfterBulkLoad(scanner,result,"version2");
  Put put0=new Put(Bytes.toBytes("row1"));
  put0.add(new KeyValue(Bytes.toBytes("row1"),Bytes.toBytes("col"),Bytes.toBytes("q"),l,Bytes.toBytes("version3")));
  table.put(put0);
  admin.flush(tableName);
  scanner=table.getScanner(scan);
  result=scanner.next();
  while (result != null) {
    List<Cell> cells=result.getColumnCells(Bytes.toBytes("col"),Bytes.toBytes("q"));
    for (    Cell _c : cells) {
      if (Bytes.toString(_c.getRowArray(),_c.getRowOffset(),_c.getRowLength()).equals("row1")) {
        System.out.println(Bytes.toString(_c.getRowArray(),_c.getRowOffset(),_c.getRowLength()));
        System.out.println(Bytes.toString(_c.getQualifierArray(),_c.getQualifierOffset(),_c.getQualifierLength()));
        System.out.println(Bytes.toString(_c.getValueArray(),_c.getValueOffset(),_c.getValueLength()));
        Assert.assertEquals("version3",Bytes.toString(_c.getValueArray(),_c.getValueOffset(),_c.getValueLength()));
      }
    }
    result=scanner.next();
  }
  scanner.close();
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestServerNonceManager </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalStartEnd() throws Exception {
  final long[] numbers=new long[]{NO_NONCE,1,2,Long.MAX_VALUE,Long.MIN_VALUE};
  ServerNonceManager nm=createManager();
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      assertTrue(nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
  for (int i=0; i < numbers.length; ++i) {
    assertTrue(nm.startOperation(numbers[i],NO_NONCE,createStoppable()));
  }
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      nm.endOperation(numbers[i],numbers[j],false);
      assertTrue(nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      nm.endOperation(numbers[i],numbers[j],true);
      assertEquals(numbers[j] == NO_NONCE,nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitLogWorker </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=60000) public void testAcquireMultiTasks() throws Exception {
  LOG.info("testAcquireMultiTasks");
  SplitLogCounters.resetCounters();
  final String TATAS="tatas";
  final ServerName RS=ServerName.valueOf("rs,1,1");
  final int maxTasks=3;
  Configuration testConf=HBaseConfiguration.create(TEST_UTIL.getConfiguration());
  testConf.setInt("hbase.regionserver.wal.max.splitters",maxTasks);
  RegionServerServices mockedRS=getRegionServer(RS);
  for (int i=0; i < maxTasks; i++) {
    zkw.getRecoverableZooKeeper().create(ZKSplitLog.getEncodedNodeName(zkw,TATAS + i),new SplitLogTask.Unassigned(ServerName.valueOf("mgr,1,1"),this.mode).toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
  SplitLogWorker slw=new SplitLogWorker(ds,testConf,mockedRS,neverEndingTask);
  slw.start();
  try {
    waitForCounter(SplitLogCounters.tot_wkr_task_acquired,0,maxTasks,WAIT_TIME);
    for (int i=0; i < maxTasks; i++) {
      byte[] bytes=ZKUtil.getData(zkw,ZKSplitLog.getEncodedNodeName(zkw,TATAS + i));
      SplitLogTask slt=SplitLogTask.parseFrom(bytes);
      assertTrue(slt.isOwned(RS));
    }
  }
  finally {
    stopSplitLogWorker(slw);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster </h4><pre class="type-4 type-9 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * If a table has regions that have no store files in a region, they should split successfully
 * into two regions with no store files.
 */
@Test(timeout=60000) public void testSplitRegionWithNoStoreFiles() throws Exception {
  final TableName tableName=TableName.valueOf("testSplitRegionWithNoStoreFiles");
  createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  int regionServerIndex=cluster.getServerWith(regions.get(0).getRegionInfo().getRegionName());
  HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    printOutRegions(regionServer,"Initial regions: ");
    Configuration conf=cluster.getConfiguration();
    HBaseFsck.debugLsr(conf,new Path("/"));
    Path rootDir=FSUtils.getRootDir(conf);
    FileSystem fs=TESTING_UTIL.getDFSCluster().getFileSystem();
    Map<String,Path> storefiles=FSUtils.getTableStoreFilePathMap(null,fs,rootDir,tableName);
    assertEquals("Expected nothing but found " + storefiles.toString(),storefiles.size(),0);
    regions=cluster.getRegions(tableName);
    final HRegion region=findSplittableRegion(regions);
    assertTrue("not able to find a splittable region",region != null);
    SplitTransactionImpl st=new MockedSplitTransaction(region,Bytes.toBytes("row2"));
    try {
      st.prepare();
      st.execute(regionServer,regionServer);
    }
 catch (    IOException e) {
      fail("Split execution should have succeeded with no exceptions thrown");
    }
    List<HRegion> daughters=cluster.getRegions(tableName);
    assertTrue(daughters.size() == 2);
    HBaseFsck.debugLsr(conf,new Path("/"));
    Map<String,Path> storefilesAfter=FSUtils.getTableStoreFilePathMap(null,fs,rootDir,tableName);
    assertEquals("Expected nothing but found " + storefilesAfter.toString(),storefilesAfter.size(),0);
    hri=region.getRegionInfo();
    AssignmentManager am=cluster.getMaster().getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    long start=EnvironmentEdgeManager.currentTime();
    while (!regionStates.isRegionInState(hri,State.SPLIT)) {
      assertFalse("Timed out in waiting split parent to be in state SPLIT",EnvironmentEdgeManager.currentTime() - start > 60000);
      Thread.sleep(500);
    }
    am.assign(hri,true);
    assertFalse("Split region can't be assigned",regionStates.isRegionInTransition(hri));
    assertTrue(regionStates.isRegionInState(hri,State.SPLIT));
    am.unassign(hri,null);
    assertFalse("Split region can't be unassigned",regionStates.isRegionInTransition(hri));
    assertTrue(regionStates.isRegionInState(hri,State.SPLIT));
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=300000) public void testExistingZnodeBlocksSplitAndWeRollback() throws IOException, InterruptedException, NodeExistsException, KeeperException, ServiceException {
  final TableName tableName=TableName.valueOf("testExistingZnodeBlocksSplitAndWeRollback");
  Table t=createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  int tableRegionIndex=ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  RegionStates regionStates=cluster.getMaster().getAssignmentManager().getRegionStates();
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    TESTING_UTIL.loadTable(t,HConstants.CATALOG_FAMILY,false);
    HRegionServer server=cluster.getRegionServer(tableRegionIndex);
    printOutRegions(server,"Initial regions: ");
    int regionCount=ProtobufUtil.getOnlineRegions(server.getRSRpcServices()).size();
    regionStates.updateRegionState(hri,RegionState.State.CLOSING);
    this.admin.splitRegion(hri.getRegionName());
    this.admin.splitRegion(hri.getRegionName());
    this.admin.splitRegion(hri.getRegionName());
    for (int i=0; i < 10; i++) {
      Thread.sleep(100);
      assertEquals(regionCount,ProtobufUtil.getOnlineRegions(server.getRSRpcServices()).size());
    }
    regionStates.regionOnline(hri,server.getServerName());
    split(hri,server,regionCount);
    checkAndGetDaughters(tableName);
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    t.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStore </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testICV_negMemstoreSize() throws IOException {
  init(this.name.getMethodName());
  long time=100;
  ManualEnvironmentEdge ee=new ManualEnvironmentEdge();
  ee.setValue(time);
  EnvironmentEdgeManagerTestHelper.injectEdge(ee);
  long newValue=3L;
  long size=0;
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091000"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091200"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091300"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091400"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091500"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  for (int i=0; i < 10000; ++i) {
    newValue++;
    long ret=this.store.updateColumnValue(row,family,qf1,newValue);
    long ret2=this.store.updateColumnValue(row2,family,qf1,newValue);
    if (ret != 0)     System.out.println("ret: " + ret);
    if (ret2 != 0)     System.out.println("ret2: " + ret2);
    Assert.assertTrue("ret: " + ret,ret >= 0);
    size+=ret;
    Assert.assertTrue("ret2: " + ret2,ret2 >= 0);
    size+=ret2;
    if (i % 1000 == 0)     ee.setValue(++time);
  }
  long computedSize=0;
  for (  Cell cell : ((DefaultMemStore)this.store.memstore).cellSet) {
    long kvsize=DefaultMemStore.heapSizeChange(cell,true);
    computedSize+=kvsize;
  }
  Assert.assertEquals(computedSize,size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStoreFile </h4><pre class="type-4 type-9 type-10 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that our mechanism of writing store files in one region to reference
 * store files in other regions works.
 * @throws IOException
 */
@Test public void testReference() throws IOException {
  final HRegionInfo hri=new HRegionInfo(TableName.valueOf("testReferenceTb"));
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(conf,fs,new Path(testDir,hri.getTable().getNameAsString()),hri);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(regionFs.createTempName()).withFileContext(meta).build();
  writeStoreFile(writer);
  Path hsfPath=regionFs.commitStoreFile(TEST_FAMILY,writer.getPath());
  StoreFile hsf=new StoreFile(this.fs,hsfPath,conf,cacheConf,BloomType.NONE);
  StoreFile.Reader reader=hsf.createReader();
  Cell kv=reader.midkey();
  byte[] midRow=CellUtil.cloneRow(kv);
  kv=reader.getLastKey();
  byte[] finalRow=CellUtil.cloneRow(kv);
  hsf.closeReader(true);
  HRegionInfo splitHri=new HRegionInfo(hri.getTable(),null,midRow);
  Path refPath=splitStoreFile(regionFs,splitHri,TEST_FAMILY,hsf,midRow,true);
  StoreFile refHsf=new StoreFile(this.fs,refPath,conf,cacheConf,BloomType.NONE);
  HFileScanner s=refHsf.createReader().getScanner(false,false);
  for (boolean first=true; (!s.isSeeked() && s.seekTo()) || s.next(); ) {
    ByteBuffer bb=ByteBuffer.wrap(((KeyValue)s.getKey()).getKey());
    kv=KeyValueUtil.createKeyValueFromKey(bb);
    if (first) {
      assertTrue(Bytes.equals(kv.getRowArray(),kv.getRowOffset(),kv.getRowLength(),midRow,0,midRow.length));
      first=false;
    }
  }
  assertTrue(Bytes.equals(kv.getRowArray(),kv.getRowOffset(),kv.getRowLength(),finalRow,0,finalRow.length));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheOnWriteEvictOnClose() throws Exception {
  Configuration conf=this.conf;
  Path baseDir=new Path(new Path(testDir,"7e0102"),"twoCOWEOC");
  BlockCache bc=new CacheConfig(conf).getBlockCache();
  assertNotNull(bc);
  CacheStats cs=bc.getStats();
  long startHit=cs.getHitCount();
  long startMiss=cs.getMissCount();
  long startEvicted=cs.getEvictedCount();
  conf.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,false);
  CacheConfig cacheConf=new CacheConfig(conf);
  Path pathCowOff=new Path(baseDir,"123456789");
  StoreFile.Writer writer=writeStoreFile(conf,cacheConf,pathCowOff,3);
  StoreFile hsf=new StoreFile(this.fs,writer.getPath(),conf,cacheConf,BloomType.NONE);
  LOG.debug(hsf.getPath().toString());
  StoreFile.Reader reader=hsf.createReader();
  reader.loadFileInfo();
  StoreFileScanner scanner=reader.getStoreFileScanner(true,true);
  scanner.seek(KeyValue.LOWESTKEY);
  while (scanner.next() != null)   ;
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss + 3,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startMiss+=3;
  scanner.close();
  reader.close(cacheConf.shouldEvictOnClose());
  conf.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,true);
  cacheConf=new CacheConfig(conf);
  Path pathCowOn=new Path(baseDir,"123456788");
  writer=writeStoreFile(conf,cacheConf,pathCowOn,3);
  hsf=new StoreFile(this.fs,writer.getPath(),conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  scanner=reader.getStoreFileScanner(true,true);
  scanner.seek(KeyValue.LOWESTKEY);
  while (scanner.next() != null)   ;
  assertEquals(startHit + 3,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startHit+=3;
  scanner.close();
  reader.close(cacheConf.shouldEvictOnClose());
  hsf=new StoreFile(this.fs,pathCowOff,conf,cacheConf,BloomType.NONE);
  StoreFile.Reader readerOne=hsf.createReader();
  readerOne.loadFileInfo();
  StoreFileScanner scannerOne=readerOne.getStoreFileScanner(true,true);
  scannerOne.seek(KeyValue.LOWESTKEY);
  hsf=new StoreFile(this.fs,pathCowOn,conf,cacheConf,BloomType.NONE);
  StoreFile.Reader readerTwo=hsf.createReader();
  readerTwo.loadFileInfo();
  StoreFileScanner scannerTwo=readerTwo.getStoreFileScanner(true,true);
  scannerTwo.seek(KeyValue.LOWESTKEY);
  Cell kv1=null;
  Cell kv2=null;
  while ((kv1=scannerOne.next()) != null) {
    kv2=scannerTwo.next();
    assertTrue(kv1.equals(kv2));
    KeyValue keyv1=KeyValueUtil.ensureKeyValue(kv1);
    KeyValue keyv2=KeyValueUtil.ensureKeyValue(kv2);
    assertTrue(Bytes.compareTo(keyv1.getBuffer(),keyv1.getKeyOffset(),keyv1.getKeyLength(),keyv2.getBuffer(),keyv2.getKeyOffset(),keyv2.getKeyLength()) == 0);
    assertTrue(Bytes.compareTo(kv1.getValueArray(),kv1.getValueOffset(),kv1.getValueLength(),kv2.getValueArray(),kv2.getValueOffset(),kv2.getValueLength()) == 0);
  }
  assertNull(scannerTwo.next());
  assertEquals(startHit + 6,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startHit+=6;
  scannerOne.close();
  readerOne.close(cacheConf.shouldEvictOnClose());
  scannerTwo.close();
  readerTwo.close(cacheConf.shouldEvictOnClose());
  conf.setBoolean("hbase.rs.evictblocksonclose",true);
  cacheConf=new CacheConfig(conf);
  hsf=new StoreFile(this.fs,pathCowOff,conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  reader.close(cacheConf.shouldEvictOnClose());
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted + 3,cs.getEvictedCount());
  startEvicted+=3;
  conf.setBoolean("hbase.rs.evictblocksonclose",false);
  cacheConf=new CacheConfig(conf);
  hsf=new StoreFile(this.fs,pathCowOn,conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  reader.close(cacheConf.shouldEvictOnClose());
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestTags </h4><pre class="type-9 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFlushAndCompactionwithCombinations() throws Exception {
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  byte[] fam=Bytes.toBytes("info");
  byte[] row=Bytes.toBytes("rowa");
  byte[] qual=Bytes.toBytes("qual");
  byte[] row1=Bytes.toBytes("rowb");
  byte[] row2=Bytes.toBytes("rowc");
  byte[] rowd=Bytes.toBytes("rowd");
  byte[] rowe=Bytes.toBytes("rowe");
  Table table=null;
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    HTableDescriptor desc=new HTableDescriptor(tableName);
    HColumnDescriptor colDesc=new HColumnDescriptor(fam);
    colDesc.setBlockCacheEnabled(true);
    colDesc.setDataBlockEncoding(encoding);
    desc.addFamily(colDesc);
    Admin admin=TEST_UTIL.getHBaseAdmin();
    admin.createTable(desc);
    try {
      table=TEST_UTIL.getConnection().getTable(tableName);
      Put put=new Put(row);
      byte[] value=Bytes.toBytes("value");
      put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value);
      int bigTagLen=Short.MAX_VALUE - 5;
      put.setAttribute("visibility",new byte[bigTagLen]);
      table.put(put);
      Put put1=new Put(row1);
      byte[] value1=Bytes.toBytes("1000dfsdf");
      put1.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value1);
      table.put(put1);
      admin.flush(tableName);
      Thread.sleep(1000);
      put1=new Put(row2);
      value1=Bytes.toBytes("1000dfsdf");
      put1.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value1);
      table.put(put1);
      admin.flush(tableName);
      Thread.sleep(1000);
      Put put2=new Put(rowd);
      byte[] value2=Bytes.toBytes("1000dfsdf");
      put2.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value2);
      table.put(put2);
      put2=new Put(rowe);
      value2=Bytes.toBytes("1000dfsddfdf");
      put2.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value2);
      put.setAttribute("visibility",Bytes.toBytes("ram"));
      table.put(put2);
      admin.flush(tableName);
      Thread.sleep(1000);
      TestCoprocessorForTags.checkTagPresence=true;
      Scan s=new Scan(row);
      s.setCaching(1);
      ResultScanner scanner=table.getScanner(s);
      try {
        Result next=null;
        while ((next=scanner.next()) != null) {
          CellScanner cellScanner=next.cellScanner();
          cellScanner.advance();
          KeyValue current=(KeyValue)cellScanner.current();
          if (CellUtil.matchingRow(current,row)) {
            assertEquals(1,TestCoprocessorForTags.tags.size());
            Tag tag=TestCoprocessorForTags.tags.get(0);
            assertEquals(bigTagLen,tag.getValueLength());
          }
 else {
            assertEquals(0,TestCoprocessorForTags.tags.size());
          }
        }
      }
  finally {
        if (scanner != null) {
          scanner.close();
        }
        TestCoprocessorForTags.checkTagPresence=false;
      }
      while (admin.getCompactionState(tableName) != CompactionState.NONE) {
        Thread.sleep(10);
      }
      TestCoprocessorForTags.checkTagPresence=true;
      scanner=table.getScanner(s);
      try {
        Result next=null;
        while ((next=scanner.next()) != null) {
          CellScanner cellScanner=next.cellScanner();
          cellScanner.advance();
          KeyValue current=(KeyValue)cellScanner.current();
          if (CellUtil.matchingRow(current,row)) {
            assertEquals(1,TestCoprocessorForTags.tags.size());
            Tag tag=TestCoprocessorForTags.tags.get(0);
            assertEquals(bigTagLen,tag.getValueLength());
          }
 else {
            assertEquals(0,TestCoprocessorForTags.tags.size());
          }
        }
      }
  finally {
        if (scanner != null) {
          scanner.close();
        }
        TestCoprocessorForTags.checkTagPresence=false;
      }
    }
  finally {
      if (table != null) {
        table.close();
      }
      admin.disableTable(tableName);
      admin.deleteTable(tableName);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestWideScanner </h4><pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWideScanBatching() throws IOException {
  final int batch=256;
  try {
    this.r=createNewHRegion(TESTTABLEDESC,null,null);
    int inserted=addWideContent(this.r);
    List<Cell> results=new ArrayList<Cell>();
    Scan scan=new Scan();
    scan.addFamily(A);
    scan.addFamily(B);
    scan.addFamily(C);
    scan.setMaxVersions(100);
    scan.setBatch(batch);
    InternalScanner s=r.getScanner(scan);
    int total=0;
    int i=0;
    boolean more;
    do {
      more=s.next(results);
      i++;
      LOG.info("iteration #" + i + ", results.size="+ results.size());
      assertTrue(results.size() <= batch);
      total+=results.size();
      if (results.size() > 0) {
        byte[] row=CellUtil.cloneRow(results.get(0));
        for (        Cell kv : results) {
          assertTrue(Bytes.equals(row,CellUtil.cloneRow(kv)));
        }
      }
      results.clear();
      Iterator<KeyValueScanner> scanners=((HRegion.RegionScannerImpl)s).storeHeap.getHeap().iterator();
      while (scanners.hasNext()) {
        StoreScanner ss=(StoreScanner)scanners.next();
        ss.updateReaders(new ArrayList<StoreFile>());
      }
    }
 while (more);
    LOG.info("inserted " + inserted + ", scanned "+ total);
    assertEquals(total,inserted);
    s.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.r);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestLogRolling </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that WAL is rolled when all data nodes in the pipeline have been
 * restarted.
 * @throws Exception
 */
@Test public void testLogRollOnPipelineRestart() throws Exception {
  LOG.info("Starting testLogRollOnPipelineRestart");
  assertTrue("This test requires WAL file replication.",fs.getDefaultReplication(TEST_UTIL.getDataTestDirOnTestFS()) > 1);
  LOG.info("Replication=" + fs.getDefaultReplication(TEST_UTIL.getDataTestDirOnTestFS()));
  Table t=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
  try {
    this.server=cluster.getRegionServer(0);
    HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(getName()));
    desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
    admin.createTable(desc);
    Table table=TEST_UTIL.getConnection().getTable(desc.getTableName());
    server=TEST_UTIL.getRSForFirstRegionInTable(desc.getTableName());
    HRegionInfo region=server.getOnlineRegions(desc.getTableName()).get(0).getRegionInfo();
    final WAL log=server.getWAL(region);
    final List<Path> paths=new ArrayList<Path>();
    final List<Integer> preLogRolledCalled=new ArrayList<Integer>();
    paths.add(DefaultWALProvider.getCurrentFileName(log));
    log.registerWALActionsListener(new WALActionsListener.Base(){
      @Override public void preLogRoll(      Path oldFile,      Path newFile){
        LOG.debug("preLogRoll: oldFile=" + oldFile + " newFile="+ newFile);
        preLogRolledCalled.add(new Integer(1));
      }
      @Override public void postLogRoll(      Path oldFile,      Path newFile){
        paths.add(newFile);
      }
    }
);
    assertTrue("Need append support for this test",FSUtils.isAppendSupported(TEST_UTIL.getConfiguration()));
    writeData(table,1002);
    long curTime=System.currentTimeMillis();
    LOG.info("log.getCurrentFileName()): " + DefaultWALProvider.getCurrentFileName(log));
    long oldFilenum=DefaultWALProvider.extractFileNumFromWAL(log);
    assertTrue("Log should have a timestamp older than now",curTime > oldFilenum && oldFilenum != -1);
    assertTrue("The log shouldn't have rolled yet",oldFilenum == DefaultWALProvider.extractFileNumFromWAL(log));
    dfsCluster.restartDataNodes();
    Thread.sleep(1000);
    dfsCluster.waitActive();
    LOG.info("Data Nodes restarted");
    validateData(table,1002);
    writeData(table,1003);
    long newFilenum=DefaultWALProvider.extractFileNumFromWAL(log);
    assertTrue("Missing datanode should've triggered a log roll",newFilenum > oldFilenum && newFilenum > curTime);
    validateData(table,1003);
    writeData(table,1004);
    dfsCluster.restartDataNodes();
    Thread.sleep(1000);
    dfsCluster.waitActive();
    LOG.info("Data Nodes restarted");
    validateData(table,1004);
    writeData(table,1005);
    log.rollWriter(true);
    assertTrue("preLogRolledCalled has size of " + preLogRolledCalled.size(),preLogRolledCalled.size() >= 1);
    Set<String> loggedRows=new HashSet<String>();
    FSUtils fsUtils=FSUtils.getInstance(fs,TEST_UTIL.getConfiguration());
    for (    Path p : paths) {
      LOG.debug("recovering lease for " + p);
      fsUtils.recoverFileLease(((HFileSystem)fs).getBackingFs(),p,TEST_UTIL.getConfiguration(),null);
      LOG.debug("Reading WAL " + FSUtils.getPath(p));
      WAL.Reader reader=null;
      try {
        reader=WALFactory.createReader(fs,p,TEST_UTIL.getConfiguration());
        WAL.Entry entry;
        while ((entry=reader.next()) != null) {
          LOG.debug("#" + entry.getKey().getLogSeqNum() + ": "+ entry.getEdit().getCells());
          for (          Cell cell : entry.getEdit().getCells()) {
            loggedRows.add(Bytes.toStringBinary(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength()));
          }
        }
      }
 catch (      EOFException e) {
        LOG.debug("EOF reading file " + FSUtils.getPath(p));
      }
 finally {
        if (reader != null)         reader.close();
      }
    }
    assertTrue(loggedRows.contains("row1002"));
    assertTrue(loggedRows.contains("row1003"));
    assertTrue(loggedRows.contains("row1004"));
    assertTrue(loggedRows.contains("row1005"));
    for (    Region r : server.getOnlineRegionsLocalContext()) {
      try {
        r.flush(true);
      }
 catch (      Exception e) {
        LOG.info(e);
      }
    }
    ResultScanner scanner=table.getScanner(new Scan());
    try {
      for (int i=2; i <= 5; i++) {
        Result r=scanner.next();
        assertNotNull(r);
        assertFalse(r.isEmpty());
        assertEquals("row100" + i,Bytes.toString(r.getRow()));
      }
    }
  finally {
      scanner.close();
    }
    for (    JVMClusterUtil.RegionServerThread rsThread : TEST_UTIL.getHBaseCluster().getRegionServerThreads()) {
      assertFalse(rsThread.getRegionServer().isAborted());
    }
  }
  finally {
    if (t != null)     t.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestLogRollingNoCluster </h4><pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Spin up a bunch of threads and have them all append to a WAL.  Roll the
 * WAL frequently to try and trigger NPE.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testContendedLogRolling() throws IOException, InterruptedException {
  Path dir=TEST_UTIL.getDataTestDir();
  TEST_UTIL.getConfiguration().setInt(HConstants.REGION_SERVER_HANDLER_COUNT,THREAD_COUNT);
  final Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  FSUtils.setRootDir(conf,dir);
  final WALFactory wals=new WALFactory(conf,null,TestLogRollingNoCluster.class.getName());
  final WAL wal=wals.getWAL(new byte[]{},null);
  Appender[] appenders=null;
  final int count=THREAD_COUNT;
  appenders=new Appender[count];
  try {
    for (int i=0; i < count; i++) {
      appenders[i]=new Appender(wal,i,count);
    }
    for (int i=0; i < count; i++) {
      appenders[i].start();
    }
    for (int i=0; i < count; i++) {
      appenders[i].join();
    }
  }
  finally {
    wals.close();
  }
  for (int i=0; i < count; i++) {
    assertFalse(appenders[i].isException());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationChangingPeerRegionservers </h4><pre class="type-9 type-2 type-10 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@Before public void setUp() throws Exception {
  for (  JVMClusterUtil.RegionServerThread r : utility1.getHBaseCluster().getRegionServerThreads()) {
    utility1.getHBaseAdmin().rollWALWriter(r.getRegionServer().getServerName());
  }
  utility1.deleteTableData(tableName);
  Scan scan=new Scan();
  int lastCount=0;
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for truncate");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != 0) {
      if (res.length < lastCount) {
        i--;
      }
      lastCount=res.length;
      LOG.info("Still got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationDisableInactivePeer </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disabling an inactive peer. Add a peer which is inactive, trying to
 * insert, disable the peer, then activate the peer and make sure nothing is
 * replicated. In Addition, enable the peer and check the updates are
 * replicated.
 * @throws Exception
 */
@Test(timeout=600000) public void testDisableInactivePeer() throws Exception {
  admin.enablePeer("2");
  utility2.shutdownMiniHBaseCluster();
  byte[] rowkey=Bytes.toBytes("disable inactive peer");
  Put put=new Put(rowkey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Thread.sleep(SLEEP_TIME * NB_RETRIES);
  admin.disablePeer("2");
  utility2.startMiniHBaseCluster(1,2);
  Get get=new Get(rowkey);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Replication wasn't disabled");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.enablePeer("2");
  Thread.sleep(SLEEP_TIME * NB_RETRIES);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME * NB_RETRIES);
    }
 else {
      assertArrayEquals(res.value(),row);
      return;
    }
  }
  fail("Waited too much time for put replication");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationSmallTests </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Integration test for TestReplicationAdmin, removes and re-add a peer
 * cluster
 * @throws Exception
 */
@Test(timeout=300000) public void testAddAndRemoveClusters() throws Exception {
  LOG.info("testAddAndRemoveClusters");
  admin.removePeer("2");
  Thread.sleep(SLEEP_TIME);
  byte[] rowKey=Bytes.toBytes("Won't be replicated");
  Put put=new Put(rowKey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Get get=new Get(rowKey);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      break;
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Not supposed to be replicated");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.addPeer("2",utility2.getClusterKey());
  Thread.sleep(SLEEP_TIME);
  rowKey=Bytes.toBytes("do rep");
  put=new Put(rowKey);
  put.addColumn(famName,row,row);
  LOG.info("Adding new row");
  htable1.put(put);
  get=new Get(rowKey);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME * i);
    }
 else {
      assertArrayEquals(res.value(),row);
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that version and column delete marker types are replicated
 * correctly.
 * @throws Exception
 */
@Test(timeout=300000) public void testDeleteTypes() throws Exception {
  LOG.info("testDeleteTypes");
  final byte[] v1=Bytes.toBytes("v1");
  final byte[] v2=Bytes.toBytes("v2");
  final byte[] v3=Bytes.toBytes("v3");
  htable1=utility1.getConnection().getTable(tableName);
  long t=EnvironmentEdgeManager.currentTime();
  Put put=new Put(row);
  put.addColumn(famName,row,t,v1);
  htable1.put(put);
  put=new Put(row);
  put.addColumn(famName,row,t + 1,v2);
  htable1.put(put);
  put=new Put(row);
  put.addColumn(famName,row,t + 2,v3);
  htable1.put(put);
  Get get=new Get(row);
  get.setMaxVersions();
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() < 3) {
      LOG.info("Rows not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[0]),v3);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[1]),v2);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[2]),v1);
      break;
    }
  }
  Delete d=new Delete(row);
  d.addColumn(famName,row,t);
  htable1.delete(d);
  get=new Get(row);
  get.setMaxVersions();
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() > 2) {
      LOG.info("Version not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[0]),v3);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[1]),v2);
      break;
    }
  }
  d=new Delete(row);
  d.addColumns(famName,row,t + 2);
  htable1.delete(d);
  get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for del replication");
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      LOG.info("Rows not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Do a more intense version testSmallBatch, one  that will trigger
 * wal rolling and other non-trivial code paths
 * @throws Exception
 */
@Test(timeout=300000) public void testLoading() throws Exception {
  LOG.info("Writing out rows to table1 in testLoading");
  List<Put> puts=new ArrayList<Put>();
  for (int i=0; i < NB_ROWS_IN_BIG_BATCH; i++) {
    Put put=new Put(Bytes.toBytes(i));
    put.addColumn(famName,row,row);
    puts.add(put);
  }
  htable1.setWriteBufferSize(1024);
  htable1.put(puts);
  Scan scan=new Scan();
  ResultScanner scanner=htable1.getScanner(scan);
  Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
  scanner.close();
  assertEquals(NB_ROWS_IN_BIG_BATCH,res.length);
  LOG.info("Looking in table2 for replicated rows in testLoading");
  long start=System.currentTimeMillis();
  final long retries=NB_RETRIES * 10;
  for (int i=0; i < retries; i++) {
    scan=new Scan();
    scanner=htable2.getScanner(scan);
    res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != NB_ROWS_IN_BIG_BATCH) {
      if (i == retries - 1) {
        int lastRow=-1;
        for (        Result result : res) {
          int currentRow=Bytes.toInt(result.getRow());
          for (int row=lastRow + 1; row < currentRow; row++) {
            LOG.error("Row missing: " + row);
          }
          lastRow=currentRow;
        }
        LOG.error("Last row: " + lastRow);
        fail("Waited too much time for normal batch replication, " + res.length + " instead of "+ NB_ROWS_IN_BIG_BATCH+ "; waited="+ (System.currentTimeMillis() - start)+ "ms");
      }
 else {
        LOG.info("Only got " + res.length + " rows... retrying");
        Thread.sleep(SLEEP_TIME);
      }
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disable/enable replication, trying to insert, make sure nothing's
 * replicated, enable it, the insert should be replicated
 * @throws Exception
 */
@Test(timeout=300000) public void testDisableEnable() throws Exception {
  admin.disablePeer("2");
  byte[] rowkey=Bytes.toBytes("disable enable");
  Put put=new Put(rowkey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Get get=new Get(rowkey);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Replication wasn't disabled");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.enablePeer("2");
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(res.value(),row);
      return;
    }
  }
  fail("Waited too much time for put replication");
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Try a small batch upload using the write buffer, check it's replicated
 * @throws Exception
 */
@Test(timeout=300000) public void testSmallBatch() throws Exception {
  LOG.info("testSmallBatch");
  List<Put> puts=new ArrayList<>();
  for (int i=0; i < NB_ROWS_IN_BATCH; i++) {
    Put put=new Put(Bytes.toBytes(i));
    put.addColumn(famName,row,row);
    puts.add(put);
  }
  htable1.put(puts);
  Scan scan=new Scan();
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(NB_ROWS_IN_BATCH);
  scanner1.close();
  assertEquals(NB_ROWS_IN_BATCH,res1.length);
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BATCH);
    scanner.close();
    if (res.length != NB_ROWS_IN_BATCH) {
      LOG.info("Only got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Test for HBASE-8663
 * Create two new Tables with colfamilies enabled for replication then run
 * ReplicationAdmin.listReplicated(). Finally verify the table:colfamilies. Note:
 * TestReplicationAdmin is a better place for this testing but it would need mocks.
 * @throws Exception
 */
@Test(timeout=300000) public void testVerifyListReplicatedTable() throws Exception {
  LOG.info("testVerifyListReplicatedTable");
  final String tName="VerifyListReplicated_";
  final String colFam="cf1";
  final int numOfTables=3;
  Admin hadmin=utility1.getHBaseAdmin();
  for (int i=0; i < numOfTables; i++) {
    HTableDescriptor ht=new HTableDescriptor(TableName.valueOf(tName + i));
    HColumnDescriptor cfd=new HColumnDescriptor(colFam);
    cfd.setScope(HConstants.REPLICATION_SCOPE_GLOBAL);
    ht.addFamily(cfd);
    hadmin.createTable(ht);
  }
  List<HashMap<String,String>> replicationColFams=admin.listReplicated();
  int[] match=new int[numOfTables];
  for (int i=0; i < replicationColFams.size(); i++) {
    HashMap<String,String> replicationEntry=replicationColFams.get(i);
    String tn=replicationEntry.get(ReplicationAdmin.TNAME);
    if ((tn.startsWith(tName)) && replicationEntry.get(ReplicationAdmin.CFNAME).equals(colFam)) {
      int m=Integer.parseInt(tn.substring(tn.length() - 1));
      match[m]++;
    }
  }
  for (int i=0; i < match.length; i++) {
    assertTrue("listReplicated() does not match table " + i,(match[i] == 1));
  }
  for (int i=0; i < numOfTables; i++) {
    TableName tableName=TableName.valueOf(tName + i);
    hadmin.disableTable(tableName);
    hadmin.deleteTable(tableName);
  }
  hadmin.close();
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add a row, check it's replicated, delete it, check's gone
 * @throws Exception
 */
@Test(timeout=300000) public void testSimplePutDelete() throws Exception {
  LOG.info("testSimplePutDelete");
  Put put=new Put(row);
  put.addColumn(famName,row,row);
  htable1=utility1.getConnection().getTable(tableName);
  htable1.put(put);
  Get get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(res.value(),row);
      break;
    }
  }
  Delete del=new Delete(row);
  htable1.delete(del);
  get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for del replication");
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      LOG.info("Row not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testVersionMismatchHBase14905() throws Exception {
  byte[] qualifierName=Bytes.toBytes("f1");
  Put put=new Put(Bytes.toBytes("r1"));
  long ts=System.currentTimeMillis();
  put.addColumn(famName,qualifierName,ts + 1,Bytes.toBytes("v1"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,ts + 2,Bytes.toBytes("v2"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,ts + 3,Bytes.toBytes("v3"));
  htable1.put(put);
  Scan scan=new Scan();
  scan.setMaxVersions(100);
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(1);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(1);
    scanner1.close();
    if (res1.length != 1) {
      LOG.info("Only got " + res1.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      int cellNumber=res1[0].getColumnCells(famName,Bytes.toBytes("f1")).size();
      if (cellNumber != 3) {
        LOG.info("Only got " + cellNumber + " cells");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        break;
      }
    }
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
  }
  try {
    admin.disablePeer("2");
    Put put2=new Put(Bytes.toBytes("r1"));
    put2.addColumn(famName,qualifierName,ts + 2,Bytes.toBytes("v99"));
    htable2.put(put2);
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(NB_ROWS_IN_BATCH);
    scanner1.close();
    assertEquals(1,res1.length);
    assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
    String[] args=new String[]{"--versions=100","2",tableName.getNameAsString()};
    Job job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
    if (job == null) {
      fail("Job wasn't created, see the log");
    }
    if (!job.waitForCompletion(true)) {
      fail("Job failed, see the log");
    }
    assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
    assertEquals(1,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
  }
  finally {
    admin.enablePeer("2");
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testHBase14905() throws Exception {
  byte[] qualifierName=Bytes.toBytes("f1");
  Put put=new Put(Bytes.toBytes("r1"));
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1002"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1001"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1112"));
  htable1.put(put);
  Scan scan=new Scan();
  scan.setMaxVersions(100);
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(1);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(1);
    scanner1.close();
    if (res1.length != 1) {
      LOG.info("Only got " + res1.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      int cellNumber=res1[0].getColumnCells(famName,Bytes.toBytes("f1")).size();
      if (cellNumber != 3) {
        LOG.info("Only got " + cellNumber + " cells");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        break;
      }
    }
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
  }
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1111"));
  htable2.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1112"));
  htable2.put(put);
  scan=new Scan();
  scan.setMaxVersions(100);
  scanner1=htable2.getScanner(scan);
  res1=scanner1.next(NB_ROWS_IN_BATCH);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(5,res1[0].getColumnCells(famName,qualifierName).size());
  String[] args=new String[]{"--versions=100","2",tableName.getNameAsString()};
  Job job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
  if (job == null) {
    fail("Job wasn't created, see the log");
  }
  if (!job.waitForCompletion(true)) {
    fail("Job failed, see the log");
  }
  assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
  assertEquals(1,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
}

</code></pre>

<br>
<pre class="type-9 type-2 type-10 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@Before public void setUp() throws Exception {
  for (  JVMClusterUtil.RegionServerThread r : utility1.getHBaseCluster().getRegionServerThreads()) {
    utility1.getHBaseAdmin().rollWALWriter(r.getRegionServer().getServerName());
  }
  utility1.deleteTableData(tableName);
  Scan scan=new Scan();
  int lastCount=0;
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for truncate");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != 0) {
      if (res.length < lastCount) {
        i--;
      }
      lastCount=res.length;
      LOG.info("Still got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationWithTags </h4><pre class="type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testReplicationWithCellTags() throws Exception {
  LOG.info("testSimplePutDelete");
  Put put=new Put(ROW);
  put.setAttribute("visibility",Bytes.toBytes("myTag3"));
  put.addColumn(FAMILY,ROW,ROW);
  htable1=utility1.getConnection().getTable(TABLE_NAME);
  htable1.put(put);
  Get get=new Get(ROW);
  try {
    for (int i=0; i < NB_RETRIES; i++) {
      if (i == NB_RETRIES - 1) {
        fail("Waited too much time for put replication");
      }
      Result res=htable2.get(get);
      if (res.size() == 0) {
        LOG.info("Row not available");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        assertArrayEquals(res.value(),ROW);
        assertEquals(1,TestCoprocessorForTagsAtSink.tags.size());
        Tag tag=TestCoprocessorForTagsAtSink.tags.get(0);
        assertEquals(TAG_TYPE,tag.getType());
        break;
      }
    }
  }
  finally {
    TestCoprocessorForTagsAtSink.tags=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestReplicationWALReaderManager </h4><pre class="type-9 type-10 type-11 type-7 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Path path=pathWatcher.currentPath;
  assertEquals(0,logManager.getPosition());
  appendToLog();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  WAL.Entry entry=logManager.readNextAndSetPosition();
  assertNotNull(entry);
  entry=logManager.readNextAndSetPosition();
  assertNull(entry);
  logManager.closeReader();
  long oldPos=logManager.getPosition();
  appendToLog();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  entry=logManager.readNextAndSetPosition();
  assertNotEquals(oldPos,logManager.getPosition());
  assertNotNull(entry);
  logManager.closeReader();
  oldPos=logManager.getPosition();
  log.rollWriter();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  entry=logManager.readNextAndSetPosition();
  assertEquals(oldPos,logManager.getPosition());
  assertNull(entry);
  logManager.finishCurrentFile();
  path=pathWatcher.currentPath;
  for (int i=0; i < nbRows; i++) {
    appendToLogPlus(walEditKVs);
  }
  log.rollWriter();
  logManager.openReader(path);
  logManager.seek();
  for (int i=0; i < nbRows; i++) {
    WAL.Entry e=logManager.readNextAndSetPosition();
    if (e == null) {
      fail("Should have enough entries");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestGetAndPutResource </h4><pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStartEndRowGetPutXML() throws IOException, JAXBException {
  String[] rows={ROW_1,ROW_2,ROW_3};
  String[] values={VALUE_1,VALUE_2,VALUE_3};
  Response response=null;
  for (int i=0; i < rows.length; i++) {
    response=putValueXML(TABLE,rows[i],COLUMN_1,values[i]);
    assertEquals(200,response.getCode());
    checkValueXML(TABLE,rows[i],COLUMN_1,values[i]);
  }
  response=getValueXML(TABLE,rows[0],rows[2],COLUMN_1);
  assertEquals(200,response.getCode());
  CellSetModel cellSet=(CellSetModel)xmlUnmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  assertEquals(2,cellSet.getRows().size());
  for (int i=0; i < cellSet.getRows().size() - 1; i++) {
    RowModel rowModel=cellSet.getRows().get(i);
    for (    CellModel cell : rowModel.getCells()) {
      assertEquals(COLUMN_1,Bytes.toString(cell.getColumn()));
      assertEquals(values[i],Bytes.toString(cell.getValue()));
    }
  }
  for (  String row : rows) {
    response=deleteRow(TABLE,row);
    assertEquals(200,response.getCode());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestTableScan </h4><pre class="type-4 type-9 type-10 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStreamingJSON() throws Exception {
  StringBuilder builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_1);
  builder.append("&");
  builder.append(Constants.SCAN_LIMIT + "=20");
  Response response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  ObjectMapper mapper=new JacksonProvider().locateMapper(CellSetModel.class,MediaType.APPLICATION_JSON_TYPE);
  CellSetModel model=mapper.readValue(response.getStream(),CellSetModel.class);
  int count=TestScannerResource.countCellSet(model);
  assertEquals(20,count);
  checkRowsNotNull(model);
  builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_2);
  response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  model=mapper.readValue(response.getStream(),CellSetModel.class);
  count=TestScannerResource.countCellSet(model);
  assertEquals(expectedRows2,count);
  checkRowsNotNull(model);
  builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_1);
  builder.append("&");
  builder.append(Constants.SCAN_START_ROW + "=aaa");
  builder.append("&");
  builder.append(Constants.SCAN_END_ROW + "=aay");
  response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  count=0;
  JsonFactory jfactory=new JsonFactory(mapper);
  JsonParser jParser=jfactory.createJsonParser(response.getStream());
  boolean found=false;
  while (jParser.nextToken() != JsonToken.END_OBJECT) {
    if (jParser.getCurrentToken() == JsonToken.START_OBJECT && found) {
      RowModel row=jParser.readValueAs(RowModel.class);
      assertNotNull(row.getKey());
      for (int i=0; i < row.getCells().size(); i++) {
        if (count == 0) {
          assertEquals("aaa",Bytes.toString(row.getKey()));
        }
        if (count == 23) {
          assertEquals("aax",Bytes.toString(row.getKey()));
        }
        count++;
      }
      jParser.skipChildren();
    }
 else {
      found=jParser.getCurrentToken() == JsonToken.START_ARRAY;
    }
  }
  assertEquals(24,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestUser </h4><pre class="type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that we're returning a result for the current user.
 * Previously getCurrent() was returning null if not initialized on
 * non-secure Hadoop variants.
 */
@Test public void testGetCurrent() throws Exception {
  User user1=User.getCurrent();
  assertNotNull(user1.ugi);
  LOG.debug("User1 is " + user1.getName());
  for (int i=0; i < 100; i++) {
    User u=User.getCurrent();
    assertNotNull(u);
    assertEquals(user1.getName(),u.getName());
    assertEquals(user1,u);
    assertEquals(user1.hashCode(),u.hashCode());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController </h4><pre class="type-9 type-10 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test(timeout=180000) public void testGlobalAuthorizationForNewRegisteredRS() throws Exception {
  LOG.debug("Test for global authorization for a new registered RegionServer.");
  MiniHBaseCluster hbaseCluster=TEST_UTIL.getHBaseCluster();
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor htd=new HTableDescriptor(TEST_TABLE2);
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  createTable(TEST_UTIL,htd);
  JVMClusterUtil.RegionServerThread newRsThread=hbaseCluster.startRegionServer();
  final HRegionServer newRs=newRsThread.getRegionServer();
  List<HRegionLocation> regions;
  try (RegionLocator locator=systemUserConnection.getRegionLocator(TEST_TABLE2)){
    regions=locator.getAllRegionLocations();
  }
   HRegionLocation location=regions.get(0);
  final HRegionInfo hri=location.getRegionInfo();
  final ServerName server=location.getServerName();
  try (Table table=systemUserConnection.getTable(TEST_TABLE2)){
    AccessTestAction moveAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        admin.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(newRs.getServerName().getServerName()));
        return null;
      }
    }
;
    SUPERUSER.runAs(moveAction);
    final int RETRIES_LIMIT=10;
    int retries=0;
    while (newRs.getOnlineRegions(TEST_TABLE2).size() < 1 && retries < RETRIES_LIMIT) {
      LOG.debug("Waiting for region to be opened. Already retried " + retries + " times.");
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
      }
      retries++;
      if (retries == RETRIES_LIMIT - 1) {
        fail("Retry exhaust for waiting region to be opened.");
      }
    }
    AccessTestAction putAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Put put=new Put(Bytes.toBytes("test"));
        put.addColumn(TEST_FAMILY,Bytes.toBytes("qual"),Bytes.toBytes("value"));
        table.put(put);
        return null;
      }
    }
;
    USER_ADMIN.runAs(putAction);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestTablePermissions </h4><pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAuthManager() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  TableAuthManager authManager=TableAuthManager.getOrCreate(ZKW,conf);
  User currentUser=User.getCurrent();
  assertTrue(authManager.authorize(currentUser,Permission.Action.ADMIN));
  for (int i=1; i <= 50; i++) {
    AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("testauth" + i),Permission.Action.ADMIN,Permission.Action.READ,Permission.Action.WRITE));
    assertTrue("Failed current user auth check on iter " + i,authManager.authorize(currentUser,Permission.Action.ADMIN));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandler </h4><pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithFilter() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScanWithFilter" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithFilter".getBytes());
  scan.setStopRow("testScanWithFilter\uffff".getBytes());
  scan.setFilterString(wrap(("KeyOnlyFilter()").getBytes()));
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScanWithFilter" + i).getBytes(),results.get(i).getRow());
    assertEquals(0,results.get(i).getColumnValues().get(0).getValue().length);
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithBatchSize() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  for (int i=0; i < 100; i++) {
    String colNum=pad(i,(byte)3);
    TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(("col" + colNum).getBytes()),wrap(("val" + colNum).getBytes()));
    columnValues.add(columnValue);
  }
  TPut put=new TPut(wrap(("testScanWithBatchSize").getBytes()),columnValues);
  handler.put(table,put);
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithBatchSize".getBytes());
  scan.setStopRow("testScanWithBatchSize\uffff".getBytes());
  scan.setBatchSize(10);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=null;
  for (int i=0; i < 10; i++) {
    results=handler.getScannerRows(scanId,1);
    assertEquals(1,results.size());
    List<TColumnValue> cols=results.get(0).getColumnValues();
    assertEquals(10,cols.size());
    for (int y=0; y < 10; y++) {
      int colNum=y + (10 * i);
      String colNumPad=pad(colNum,(byte)3);
      assertArrayEquals(("col" + colNumPad).getBytes(),cols.get(y).getQualifier());
    }
  }
  results=handler.getScannerRows(scanId,1);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,1);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetScannerResults() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 20; i++) {
    TPut put=new TPut(wrap(("testGetScannerResults" + pad(i,(byte)2)).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testGetScannerResults".getBytes());
  scan.setStopRow("testGetScannerResults05".getBytes());
  List<TResult> results=handler.getScannerResults(table,scan,5);
  assertEquals(5,results.size());
  for (int i=0; i < 5; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan.setStopRow("testGetScannerResults10".getBytes());
  results=handler.getScannerResults(table,scan,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan.setStopRow("testGetScannerResults20".getBytes());
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
  }
  scan=new TScan();
  scan.setColumns(columns);
  scan.setReversed(true);
  scan.setStartRow("testGetScannerResults20".getBytes());
  scan.setStopRow("testGetScannerResults".getBytes());
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(("testGetScannerResults" + pad(19 - i,(byte)2)).getBytes(),results.get(i).getRow());
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScan".getBytes());
  scan.setStopRow("testScan\uffff".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScan" + i).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReverseScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testReverseScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  scan.setReversed(true);
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testReverseScan\uffff".getBytes());
  scan.setStopRow("testReverseScan".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testReverseScan" + (9 - i)).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandlerWithLabels </h4><pre class="type-4 type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetScannerResultsWithAuthorizations() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 20; i++) {
    TPut put=new TPut(wrap(("testGetScannerResults" + pad(i,(byte)2)).getBytes()),columnValues);
    if (i == 3) {
      put.setCellVisibility(new TCellVisibility().setExpression(PUBLIC));
    }
 else {
      put.setCellVisibility(new TCellVisibility().setExpression("(" + SECRET + "|"+ CONFIDENTIAL+ ")"+ "&"+ "!"+ TOPSECRET));
    }
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testGetScannerResults".getBytes());
  scan.setStopRow("testGetScannerResults05".getBytes());
  TAuthorization tauth=new TAuthorization();
  List<String> labels=new ArrayList<String>();
  labels.add(SECRET);
  labels.add(PRIVATE);
  tauth.setLabels(labels);
  scan.setAuthorizations(tauth);
  List<TResult> results=handler.getScannerResults(table,scan,5);
  assertEquals(4,results.size());
  for (int i=0; i < 4; i++) {
    if (i < 3) {
      assertArrayEquals(("testGetScannerResults" + pad(i,(byte)2)).getBytes(),results.get(i).getRow());
    }
 else     if (i == 3) {
      continue;
    }
 else {
      assertArrayEquals(("testGetScannerResults" + pad(i + 1,(byte)2)).getBytes(),results.get(i).getRow());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithVisibilityLabels() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScan" + i).getBytes()),columnValues);
    if (i == 5) {
      put.setCellVisibility(new TCellVisibility().setExpression(PUBLIC));
    }
 else {
      put.setCellVisibility(new TCellVisibility().setExpression("(" + SECRET + "|"+ CONFIDENTIAL+ ")"+ "&"+ "!"+ TOPSECRET));
    }
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScan".getBytes());
  scan.setStopRow("testScan\uffff".getBytes());
  TAuthorization tauth=new TAuthorization();
  List<String> labels=new ArrayList<String>();
  labels.add(SECRET);
  labels.add(PRIVATE);
  tauth.setLabels(labels);
  scan.setAuthorizations(tauth);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(9,results.size());
  Assert.assertFalse(Bytes.equals(results.get(5).getRow(),("testScan" + 5).getBytes()));
  for (int i=0; i < 9; i++) {
    if (i < 5) {
      assertArrayEquals(("testScan" + i).getBytes(),results.get(i).getRow());
    }
 else     if (i == 5) {
      continue;
    }
 else {
      assertArrayEquals(("testScan" + (i + 1)).getBytes(),results.get(i).getRow());
    }
  }
  results=handler.getScannerRows(scanId,9);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,9);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestCopyOnWriteMaps </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCeilingKey() throws Exception {
  assertEquals(csm.ceilingKey(4000L),m.ceilingKey(4000L));
  assertEquals(csm.ceilingKey(400L),m.ceilingKey(400L));
  assertEquals(csm.ceilingKey(-1L),m.ceilingKey(-1L));
  for (int i=0; i < 100; i++) {
    Long key=ThreadLocalRandom.current().nextLong();
    assertEquals(csm.ceilingKey(key),m.ceilingKey(key));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloorEntry() throws Exception {
  for (int i=0; i < 100; i++) {
    Long key=ThreadLocalRandom.current().nextLong();
    assertEquals(csm.floorEntry(key),m.floorEntry(key));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLowerKey() throws Exception {
  assertEquals(csm.lowerKey(400L),m.lowerKey(400L));
  assertEquals(csm.lowerKey(-1L),m.lowerKey(-1L));
  for (int i=0; i < 100; i++) {
    Long key=ThreadLocalRandom.current().nextLong();
    assertEquals(csm.lowerKey(key),m.lowerKey(key));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHigherKey() throws Exception {
  assertEquals(csm.higherKey(4000L),m.higherKey(4000L));
  assertEquals(csm.higherKey(400L),m.higherKey(400L));
  assertEquals(csm.higherKey(-1L),m.higherKey(-1L));
  for (int i=0; i < 100; i++) {
    Long key=ThreadLocalRandom.current().nextLong();
    assertEquals(csm.higherKey(key),m.higherKey(key));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTailMap() throws Exception {
  Map<Long,Long> fromCsm=csm.tailMap(50L);
  Map<Long,Long> fromM=m.tailMap(50L);
  assertEquals(fromCsm,fromM);
  for (  Long value : m.keySet()) {
    assertEquals(csm.tailMap(value),m.tailMap(value));
  }
  for (long i=0; i < 100; i++) {
    long o=ThreadLocalRandom.current().nextLong(MAX_RAND);
    assertEquals(csm.tailMap(o),m.tailMap(o));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloorKey() throws Exception {
  for (int i=0; i < 100; i++) {
    Long key=ThreadLocalRandom.current().nextLong();
    assertEquals(csm.floorKey(key),m.floorKey(key));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestStruct </h4><pre class="type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test @SuppressWarnings("unchecked") public void testOrderPreservation() throws Exception {
  Object[] vals=new Object[constructorArgs.length];
  PositionedByteRange[] encodedGeneric=new PositionedByteRange[constructorArgs.length];
  PositionedByteRange[] encodedSpecialized=new PositionedByteRange[constructorArgs.length];
  Constructor<?> ctor=specialized.encodedClass().getConstructor(Object[].class);
  for (int i=0; i < vals.length; i++) {
    vals[i]=ctor.newInstance(new Object[]{constructorArgs[i]});
    encodedGeneric[i]=new SimplePositionedMutableByteRange(generic.encodedLength(constructorArgs[i]));
    encodedSpecialized[i]=new SimplePositionedMutableByteRange(specialized.encodedLength(vals[i]));
  }
  for (int i=0; i < vals.length; i++) {
    generic.encode(encodedGeneric[i],constructorArgs[i]);
    encodedGeneric[i].setPosition(0);
    specialized.encode(encodedSpecialized[i],vals[i]);
    encodedSpecialized[i].setPosition(0);
    assertArrayEquals(encodedGeneric[i].getBytes(),encodedSpecialized[i].getBytes());
  }
  Arrays.sort(vals);
  Arrays.sort(encodedGeneric);
  Arrays.sort(encodedSpecialized);
  for (int i=0; i < vals.length; i++) {
    assertEquals("Struct encoder does not preserve sort order at position " + i,vals[i],ctor.newInstance(new Object[]{generic.decode(encodedGeneric[i])}));
    assertEquals("Specialized encoder does not preserve sort order at position " + i,vals[i],specialized.decode(encodedSpecialized[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestBoundedArrayQueue </h4><pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBoundedArrayQueueOperations() throws Exception {
  assertEquals(0,queue.size());
  assertNull(queue.poll());
  assertNull(queue.peek());
  for (int i=0; i < qMaxElements; i++) {
    assertTrue(queue.offer(i));
  }
  assertEquals(qMaxElements,queue.size());
  assertFalse(queue.offer(0));
  assertEquals(0,queue.peek().intValue());
  assertEquals(0,queue.peek().intValue());
  for (int i=0; i < qMaxElements; i++) {
    assertEquals(i,queue.poll().intValue());
  }
  assertEquals(0,queue.size());
  assertNull(queue.poll());
  assertTrue(queue.offer(100));
  assertTrue(queue.offer(1000));
  assertEquals(100,queue.peek().intValue());
  assertEquals(100,queue.poll().intValue());
  assertEquals(1000,queue.poll().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestBoundedPriorityBlockingQueue </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsert() throws Exception {
  for (int i=1; i <= CAPACITY; i+=2) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals((1 + i) / 2,queue.size());
  }
  for (int i=2; i <= CAPACITY; i+=2) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals(CAPACITY / 2 + (i / 2),queue.size());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPoll(){
  assertNull(queue.poll());
  PriorityQueue<TestObject> testList=new PriorityQueue<TestObject>(CAPACITY,new TestObjectComparator());
  for (int i=0; i < CAPACITY; ++i) {
    TestObject obj=new TestObject(i,i);
    testList.add(obj);
    queue.offer(obj);
  }
  for (int i=0; i < CAPACITY; ++i) {
    assertEquals(testList.poll(),queue.poll());
  }
  assertNull(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFifoSamePriority() throws Exception {
  assertTrue(CAPACITY >= 6);
  for (int i=0; i < 6; ++i) {
    assertTrue(queue.offer(new TestObject((1 + (i % 2)) * 10,i)));
  }
  for (int i=0; i < 6; i+=2) {
    TestObject obj=queue.poll();
    assertEquals(10,obj.getPriority());
    assertEquals(i,obj.getSeqId());
  }
  for (int i=1; i < 6; i+=2) {
    TestObject obj=queue.poll();
    assertEquals(20,obj.getPriority());
    assertEquals(i,obj.getSeqId());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesAppend() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesAppendSamePriority() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(0,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepend() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(CAPACITY - i,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(CAPACITY - (i - 1),obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestByteBufferUtils </h4><pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test copying data from stream.
 * @throws IOException On test failure.
 */
@Test public void testCopyFromStream() throws IOException {
  ByteBuffer buffer=ByteBuffer.allocate(array.length);
  ByteArrayInputStream bis=new ByteArrayInputStream(array);
  DataInputStream dis=new DataInputStream(bis);
  ByteBufferUtils.copyFromStreamToBuffer(buffer,dis,array.length / 2);
  ByteBufferUtils.copyFromStreamToBuffer(buffer,dis,array.length - array.length / 2);
  for (int i=0; i < array.length; ++i) {
    assertEquals(array[i],buffer.get(i));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test copying to stream from buffer with offset.
 * @throws IOException On test failure.
 */
@Test public void testCopyToStreamWithOffset() throws IOException {
  ByteBuffer buffer=ByteBuffer.wrap(array);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  ByteBufferUtils.copyBufferToStream(bos,buffer,array.length / 2,array.length / 2);
  byte[] returnedArray=bos.toByteArray();
  for (int i=0; i < array.length / 2; ++i) {
    int pos=array.length / 2 + i;
    assertEquals(returnedArray[i],array[pos]);
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test copying from buffer.
 */
@Test public void testCopyFromBuffer(){
  ByteBuffer srcBuffer=ByteBuffer.allocate(array.length);
  ByteBuffer dstBuffer=ByteBuffer.allocate(array.length);
  srcBuffer.put(array);
  ByteBufferUtils.copyFromBufferToBuffer(srcBuffer,dstBuffer,array.length / 2,array.length / 4);
  for (int i=0; i < array.length / 4; ++i) {
    assertEquals(srcBuffer.get(i + array.length / 2),dstBuffer.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestByteRangeWithKVSerialization </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWritingAndReadingCells() throws Exception {
  final byte[] FAMILY=Bytes.toBytes("f1");
  final byte[] QUALIFIER=Bytes.toBytes("q1");
  final byte[] VALUE=Bytes.toBytes("v");
  int kvCount=1000000;
  List<KeyValue> kvs=new ArrayList<KeyValue>(kvCount);
  int totalSize=0;
  Tag[] tags=new Tag[]{new ArrayBackedTag((byte)1,"tag1")};
  for (int i=0; i < kvCount; i++) {
    KeyValue kv=new KeyValue(Bytes.toBytes(i),FAMILY,QUALIFIER,i,VALUE,tags);
    kv.setSequenceId(i);
    kvs.add(kv);
    totalSize+=kv.getLength() + Bytes.SIZEOF_LONG;
  }
  PositionedByteRange pbr=new SimplePositionedMutableByteRange(totalSize);
  for (  KeyValue kv : kvs) {
    writeCell(pbr,kv);
  }
  PositionedByteRange pbr1=new SimplePositionedMutableByteRange(pbr.getBytes(),0,pbr.getPosition());
  for (int i=0; i < kvCount; i++) {
    KeyValue kv=readCell(pbr1);
    KeyValue kv1=kvs.get(i);
    Assert.assertTrue(kv.equals(kv1));
    Assert.assertTrue(Bytes.equals(kv.getValueArray(),kv.getValueOffset(),kv.getValueLength(),kv1.getValueArray(),kv1.getValueOffset(),kv1.getValueLength()));
    Assert.assertTrue(Bytes.equals(kv.getTagsArray(),kv.getTagsOffset(),kv.getTagsLength(),kv1.getTagsArray(),kv1.getTagsOffset(),kv1.getTagsLength()));
    Assert.assertEquals(kv1.getSequenceId(),kv.getSequenceId());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFSTableDescriptors </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableDescriptors() throws IOException, InterruptedException {
  final String name="testHTableDescriptors";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  FSTableDescriptors htds=new FSTableDescriptors(UTIL.getConfiguration(),fs,rootdir){
    @Override public HTableDescriptor get(    TableName tablename) throws TableExistsException, FileNotFoundException, IOException {
      LOG.info(tablename + ", cachehits=" + this.cachehits);
      return super.get(tablename);
    }
  }
;
  final int count=10;
  for (int i=0; i < count; i++) {
    TableDescriptor htd=new TableDescriptor(new HTableDescriptor(TableName.valueOf(name + i)));
    htds.createTableDescriptor(htd);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name + i));
    htd.addFamily(new HColumnDescriptor("" + i));
    htds.updateTableDescriptor(new TableDescriptor(htd));
  }
  Thread.sleep(100);
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  assertEquals(count * 4,htds.invocations);
  assertTrue("expected=" + (count * 2) + ", actual="+ htds.cachehits,htds.cachehits >= (count * 2));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCacheConsistency() throws IOException, InterruptedException {
  final String name="testCacheConsistency";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  FSTableDescriptors chtds=new FSTableDescriptorsTest(UTIL.getConfiguration(),fs,rootdir);
  FSTableDescriptors nonchtds=new FSTableDescriptorsTest(UTIL.getConfiguration(),fs,rootdir,false,false);
  final int count=10;
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(name + i);
    nonchtds.createTableDescriptor(htd);
  }
  for (int i=0; i < count; i++) {
    assertTrue(chtds.get(TableName.valueOf(name + i)) != null);
  }
  assertTrue(nonchtds.getAll().size() == chtds.getAll().size());
  HTableDescriptor htd=new HTableDescriptor(HTableDescriptor.META_TABLEDESC.getTableName());
  nonchtds.createTableDescriptor(htd);
  assertTrue(nonchtds.getAll().size() == chtds.getAll().size());
  for (  Map.Entry entry : nonchtds.getAll().entrySet()) {
    String t=(String)entry.getKey();
    HTableDescriptor nchtd=(HTableDescriptor)entry.getValue();
    assertTrue("expected " + htd.toString() + " got: "+ chtds.get(TableName.valueOf(t)).toString(),(nchtd.equals(chtds.get(TableName.valueOf(t)))));
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableDescriptorsNoCache() throws IOException, InterruptedException {
  final String name="testHTableDescriptorsNoCache";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  FSTableDescriptors htds=new FSTableDescriptorsTest(UTIL.getConfiguration(),fs,rootdir,false,false);
  final int count=10;
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(name + i);
    htds.createTableDescriptor(htd);
  }
  for (int i=0; i < 2 * count; i++) {
    assertNotNull("Expected HTD, got null instead",htds.get(TableName.valueOf(name + i % 2)));
  }
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name + i));
    htd.addFamily(new HColumnDescriptor("" + i));
    htds.updateTableDescriptor(new TableDescriptor(htd));
  }
  for (int i=0; i < count; i++) {
    assertNotNull("Expected HTD, got null instead",htds.get(TableName.valueOf(name + i)));
    assertTrue("Column Family " + i + " missing",htds.get(TableName.valueOf(name + i)).hasFamily(Bytes.toBytes("" + i)));
  }
  assertEquals(count * 4,htds.invocations);
  assertEquals("expected=0, actual=" + htds.cachehits,0,htds.cachehits);
}

</code></pre>

<br>
<pre class="type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testTableInfoFileStatusComparator(){
  FileStatus bare=new FileStatus(0,false,0,0,-1,new Path("/tmp",FSTableDescriptors.TABLEINFO_FILE_PREFIX));
  FileStatus future=new FileStatus(0,false,0,0,-1,new Path("/tmp/tablinfo." + System.currentTimeMillis()));
  FileStatus farFuture=new FileStatus(0,false,0,0,-1,new Path("/tmp/tablinfo." + System.currentTimeMillis() + 1000));
  FileStatus[] alist={bare,future,farFuture};
  FileStatus[] blist={bare,farFuture,future};
  FileStatus[] clist={farFuture,bare,future};
  Comparator<FileStatus> c=FSTableDescriptors.TABLEINFO_FILESTATUS_COMPARATOR;
  Arrays.sort(alist,c);
  Arrays.sort(blist,c);
  Arrays.sort(clist,c);
  for (int i=0; i < alist.length; i++) {
    assertTrue(alist[i].equals(blist[i]));
    assertTrue(blist[i].equals(clist[i]));
    assertTrue(clist[i].equals(i == 0 ? farFuture : i == 1 ? future : bare));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFastLongHistogram </h4><pre class="type-9 type-10 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAdaptionOfChange(){
  FastLongHistogram hist=new FastLongHistogram(100,0,100);
  Random rand=new Random();
  for (int n=0; n < 10; n++) {
    for (int i=0; i < 900; i++) {
      hist.add(rand.nextInt(100),1);
    }
    for (int i=0; i < 100; i++) {
      hist.add(1000 + rand.nextInt(100),1);
    }
    long[] vals=hist.getQuantiles(new double[]{0.25,0.75,0.95});
    System.out.println(Arrays.toString(vals));
    if (n == 0) {
      Assert.assertTrue("Out of possible value",vals[0] >= 0 && vals[0] <= 50);
      Assert.assertTrue("Out of possible value",vals[1] >= 50 && vals[1] <= 100);
      Assert.assertTrue("Out of possible value",vals[2] >= 900 && vals[2] <= 1100);
    }
    hist.reset();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckOneRS </h4><pre class="type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testHbckAfterRegionMerge() throws Exception {
  TableName table=TableName.valueOf("testMergeRegionFilesInHdfs");
  Table meta=null;
  try {
    TEST_UTIL.getHBaseCluster().getMaster().setCatalogJanitorEnabled(false);
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    try (RegionLocator rl=connection.getRegionLocator(tbl.getName())){
      admin.flush(table);
      HRegionInfo region1=rl.getRegionLocation(Bytes.toBytes("A")).getRegionInfo();
      HRegionInfo region2=rl.getRegionLocation(Bytes.toBytes("B")).getRegionInfo();
      int regionCountBeforeMerge=rl.getAllRegionLocations().size();
      assertNotEquals(region1,region2);
      admin.mergeRegions(region1.getEncodedNameAsBytes(),region2.getEncodedNameAsBytes(),false);
      long timeout=System.currentTimeMillis() + 30 * 1000;
      while (true) {
        if (rl.getAllRegionLocations().size() < regionCountBeforeMerge) {
          break;
        }
 else         if (System.currentTimeMillis() > timeout) {
          fail("Time out waiting on region " + region1.getEncodedName() + " and "+ region2.getEncodedName()+ " be merged");
        }
        Thread.sleep(10);
      }
      assertEquals(ROWKEYS.length,countRows());
      HBaseFsck hbck=doFsck(conf,false);
      assertNoErrors(hbck);
    }
   }
  finally {
    TEST_UTIL.getHBaseCluster().getMaster().setCatalogJanitorEnabled(true);
    cleanupTable(table);
    IOUtils.closeQuietly(meta);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckTwoRS </h4><pre class="type-9 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This creates and fixes a bad table with a missing region -- hole in meta and data present but
 * .regioninfo missing (an orphan hdfs region)in the fs. At last we check every row was present
 * at the correct region.
 */
@Test(timeout=180000) public void testHDFSRegioninfoMissingAndCheckRegionBoundary() throws Exception {
  TableName table=TableName.valueOf("testHDFSRegioninfoMissingAndCheckRegionBoundary");
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    admin.disableTable(table);
    deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("C"),true,true,false,true,HRegionInfo.DEFAULT_REPLICA_ID);
    admin.enableTable(table);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_HDFS_REGION,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    assertEquals(0,hbck.getOverlapGroups(table).size());
    doFsck(conf,true);
    assertNoErrors(doFsck(conf,false));
    for (int i=0; i < ROWKEYS.length; i++) {
      if (i != ROWKEYS.length - 1) {
        assertEquals(1,countRows(ROWKEYS[i],ROWKEYS[i + 1]));
      }
 else {
        assertEquals(1,countRows(ROWKEYS[i],null));
      }
    }
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestIdLock </h4><pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleClients() throws Exception {
  ExecutorService exec=Executors.newFixedThreadPool(NUM_THREADS);
  try {
    ExecutorCompletionService<Boolean> ecs=new ExecutorCompletionService<Boolean>(exec);
    for (int i=0; i < NUM_THREADS; ++i)     ecs.submit(new IdLockTestThread("client_" + i));
    for (int i=0; i < NUM_THREADS; ++i) {
      Future<Boolean> result=ecs.take();
      assertTrue(result.get());
    }
    idLock.assertMapEmpty();
  }
  finally {
    exec.shutdown();
    exec.awaitTermination(5000,TimeUnit.MILLISECONDS);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestIdReadWriteLock </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testMultipleClients() throws Exception {
  ExecutorService exec=Executors.newFixedThreadPool(NUM_THREADS);
  try {
    ExecutorCompletionService<Boolean> ecs=new ExecutorCompletionService<Boolean>(exec);
    for (int i=0; i < NUM_THREADS; ++i)     ecs.submit(new IdLockTestThread("client_" + i));
    for (int i=0; i < NUM_THREADS; ++i) {
      Future<Boolean> result=ecs.take();
      assertTrue(result.get());
    }
    int entryPoolSize=idLock.purgeAndGetEntryPoolSize();
    LOG.debug("Size of entry pool after gc and purge: " + entryPoolSize);
    assertEquals(0,entryPoolSize);
  }
  finally {
    exec.shutdown();
    exec.awaitTermination(5000,TimeUnit.MILLISECONDS);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestLoadTestKVGenerator </h4><pre class="type-4 type-9 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testCorrectAndUniqueKeys(){
  Set<String> keys=new HashSet<String>();
  for (int i=0; i < 1000; ++i) {
    String k=LoadTestKVGenerator.md5PrefixedKey(i);
    assertFalse(keys.contains(k));
    assertTrue(k.endsWith("-" + i));
    keys.add(k);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testVerification(){
  for (int i=0; i < 1000; ++i) {
    for (int qualIndex=0; qualIndex < 20; ++qualIndex) {
      byte[] qual=String.valueOf(qualIndex).getBytes();
      byte[] rowKey=LoadTestKVGenerator.md5PrefixedKey(i).getBytes();
      byte[] v=gen.generateRandomSizeValue(rowKey,qual);
      assertTrue(LoadTestKVGenerator.verify(v,rowKey,qual));
      v[0]++;
      assertFalse(LoadTestKVGenerator.verify(v,rowKey,qual));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValueLength(){
  for (int i=0; i < 1000; ++i) {
    byte[] v=gen.generateRandomSizeValue(Integer.toString(i).getBytes(),String.valueOf(rand.nextInt()).getBytes());
    assertTrue(MIN_LEN <= v.length);
    assertTrue(v.length <= MAX_LEN);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestMergeTool </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test merge tool.
 * @throws Exception
 */
@Test public void testMergeTool() throws Exception {
  for (int i=0; i < regions.length; i++) {
    for (int j=0; j < rows[i].length; j++) {
      Get get=new Get(rows[i][j]);
      get.addFamily(FAMILY);
      Result result=regions[i].get(get);
      byte[] bytes=CellUtil.cloneValue(result.rawCells()[0]);
      assertNotNull(bytes);
      assertTrue(Bytes.equals(bytes,rows[i][j]));
    }
    HBaseTestingUtility.closeRegionAndWAL(regions[i]);
  }
  WAL log=wals.getWAL(new byte[]{},null);
  HRegion merged=mergeAndVerify("merging regions 0 and 1 ",this.sourceRegions[0].getRegionNameAsString(),this.sourceRegions[1].getRegionNameAsString(),log,2);
  merged=mergeAndVerify("merging regions 0+1 and 2",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[2].getRegionNameAsString(),log,3);
  merged=mergeAndVerify("merging regions 0+1+2 and 3",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[3].getRegionNameAsString(),log,4);
  merged=mergeAndVerify("merging regions 0+1+2+3 and 4",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[4].getRegionNameAsString(),log,rows.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestOrder </h4><pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testApplyDescending(){
  byte[][] vals=new byte[VALS.length][];
  byte[][] ordered=new byte[VALS.length][];
  for (int i=0; i < VALS.length; i++) {
    vals[i]=Arrays.copyOf(VALS[i],VALS[i].length);
    ordered[i]=Arrays.copyOf(VALS[i],VALS[i].length);
    DESCENDING.apply(ordered[i]);
  }
  Arrays.sort(vals,Collections.reverseOrder(Bytes.BYTES_COMPARATOR));
  Arrays.sort(ordered,Bytes.BYTES_COMPARATOR);
  for (int i=0; i < vals.length; i++) {
    DESCENDING.apply(ordered[i]);
    assertArrayEquals(vals[i],ordered[i]);
  }
  byte[] expected=new byte[]{VALS[0][0],DESCENDING.apply(VALS[0][1]),VALS[0][2]};
  byte[] rangeApply=Arrays.copyOf(VALS[0],VALS[0].length);
  DESCENDING.apply(rangeApply,1,1);
  assertArrayEquals(expected,rangeApply);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testApplyAscending(){
  byte[][] vals=new byte[VALS.length][];
  byte[][] ordered=new byte[VALS.length][];
  for (int i=0; i < VALS.length; i++) {
    vals[i]=Arrays.copyOf(VALS[i],VALS[i].length);
    ordered[i]=Arrays.copyOf(VALS[i],VALS[i].length);
    ASCENDING.apply(ordered[i]);
  }
  Arrays.sort(vals,Bytes.BYTES_COMPARATOR);
  Arrays.sort(ordered,Bytes.BYTES_COMPARATOR);
  for (int i=0; i < vals.length; i++) {
    assertArrayEquals(vals[i],ordered[i]);
  }
  byte[] rangeApply=Arrays.copyOf(VALS[0],VALS[0].length);
  ASCENDING.apply(rangeApply,1,1);
  assertArrayEquals(VALS[0],rangeApply);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestOrderedBytes </h4><pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test int8 encoding.
 */
@Test public void testInt8(){
  Byte[] vals={Byte.MIN_VALUE,Byte.MIN_VALUE / 2,0,Byte.MAX_VALUE / 2,Byte.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[2 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,2 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",2,OrderedBytes.encodeInt8(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",2,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",2,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",2,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",vals[i].byteValue(),OrderedBytes.decodeInt8(buf1));
      assertEquals("Did not consume enough bytes.",2,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][2];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeInt8(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Byte[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      int decoded=OrderedBytes.decodeInt8(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].byteValue(),decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test int32 encoding.
 */
@Test public void testInt32(){
  Integer[] vals={Integer.MIN_VALUE,Integer.MIN_VALUE / 2,0,Integer.MAX_VALUE / 2,Integer.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[5 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,5 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",5,OrderedBytes.encodeInt32(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",5,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",5,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",5,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",vals[i].intValue(),OrderedBytes.decodeInt32(buf1));
      assertEquals("Did not consume enough bytes.",5,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][5];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeInt32(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Integer[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      int decoded=OrderedBytes.decodeInt32(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].intValue(),decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test BlobCopy encoding.
 */
@Test public void testBlobCopy(){
  byte[][] vals={"".getBytes(),"foo".getBytes(),"foobarbazbub".getBytes(),{(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa},{(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55}};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (    byte[] val : vals) {
      int expectedLen=val.length + (Order.ASCENDING == ord ? 1 : 2);
      byte[] a=new byte[expectedLen + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,expectedLen + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLen,OrderedBytes.encodeBlobCopy(buf1,val,ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",expectedLen,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLen,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",expectedLen,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertArrayEquals("Deserialization failed.",val,OrderedBytes.decodeBlobCopy(buf1));
      assertEquals("Did not consume enough bytes.",expectedLen,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      encoded[i]=new byte[vals[i].length + (Order.ASCENDING == ord ? 1 : 2)];
      OrderedBytes.encodeBlobCopy(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    byte[][] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals,Bytes.BYTES_COMPARATOR);
 else     Arrays.sort(sortedVals,Collections.reverseOrder(Bytes.BYTES_COMPARATOR));
    for (int i=0; i < sortedVals.length; i++) {
      pbr.set(encoded[i]);
      byte[] decoded=OrderedBytes.decodeBlobCopy(pbr);
      assertArrayEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",Arrays.toString(sortedVals[i]),Arrays.toString(decoded),ord),sortedVals[i],decoded);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[] a=new byte[3 + (Order.ASCENDING == ord ? 1 : 2) + 2];
    PositionedByteRange buf=new SimplePositionedMutableByteRange(a,1,3 + (Order.ASCENDING == ord ? 1 : 2));
    OrderedBytes.encodeBlobCopy(buf,"foobarbaz".getBytes(),3,3,ord);
    buf.setPosition(0);
    assertArrayEquals("bar".getBytes(),OrderedBytes.decodeBlobCopy(buf));
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the variable uint64 encoding.
 * <p>
 * Building sqlite4 with -DVARINT_TOOL provides this reference:<br />
 * <code>$ ./varint_tool 240 2287 67823 16777215 4294967295 1099511627775
 * 281474976710655 72057594037927935 18446744073709551615<br />
 * 240 = f0<br />
 * 2287 = f8ff<br />
 * 67823 = f9ffff<br />
 * 16777215 = faffffff<br />
 * 4294967295 = fbffffffff<br />
 * 1099511627775 = fcffffffffff<br />
 * 281474976710655 = fdffffffffffff<br />
 * 72057594037927935 = feffffffffffffff<br />
 * 9223372036854775807 = ff7fffffffffffffff (Long.MAX_VAL)<br />
 * 9223372036854775808 = ff8000000000000000 (Long.MIN_VAL)<br />
 * 18446744073709551615 = ffffffffffffffffff<br /></code>
 * </p>
 */
@Test public void testVaruint64Boundaries(){
  long vals[]={239L,240L,2286L,2287L,67822L,67823L,16777214L,16777215L,4294967294L,4294967295L,1099511627774L,1099511627775L,281474976710654L,281474976710655L,72057594037927934L,72057594037927935L,Long.MAX_VALUE - 1,Long.MAX_VALUE,Long.MIN_VALUE + 1,Long.MIN_VALUE,-2L,-1L};
  int lens[]={1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,9,9,9,9};
  assertEquals("Broken test!",vals.length,lens.length);
  for (  boolean comp : new boolean[]{true,false}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[lens[i] + 2];
      PositionedByteRange buf=new SimplePositionedMutableByteRange(a,1,lens[i]);
      assertEquals("Surprising return value.",lens[i],OrderedBytes.putVaruint64(buf,vals[i],comp));
      assertEquals("Surprising serialized length.",lens[i],buf.getPosition());
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf.setPosition(0);
      assertEquals("Surprising return value.",lens[i],OrderedBytes.skipVaruint64(buf,comp));
      assertEquals("Did not skip enough bytes.",lens[i],buf.getPosition());
      buf.setPosition(0);
      assertEquals("Deserialization failed.",vals[i],OrderedBytes.getVaruint64(buf,comp));
      assertEquals("Did not consume enough bytes.",lens[i],buf.getPosition());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test string encoding.
 */
@Test public void testString(){
  String[] vals={"foo","baaaar","bazz"};
  int expectedLengths[]={5,8,6};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[expectedLengths[i] + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,expectedLengths[i] + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLengths[i],OrderedBytes.encodeString(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",expectedLengths[i],buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLengths[i],OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",expectedLengths[i],buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",vals[i],OrderedBytes.decodeString(buf1));
      assertEquals("Did not consume enough bytes.",expectedLengths[i],buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      encoded[i]=new byte[expectedLengths[i]];
      OrderedBytes.encodeString(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    String[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      pbr.set(encoded[i]);
      String decoded=OrderedBytes.decodeString(pbr);
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i],decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test int16 encoding.
 */
@Test public void testInt16(){
  Short[] vals={Short.MIN_VALUE,Short.MIN_VALUE / 2,0,Short.MAX_VALUE / 2,Short.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[3 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,3 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",3,OrderedBytes.encodeInt16(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",3,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",3,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",3,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",vals[i].shortValue(),OrderedBytes.decodeInt16(buf1));
      assertEquals("Did not consume enough bytes.",3,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][3];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeInt16(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Short[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      int decoded=OrderedBytes.decodeInt16(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].shortValue(),decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test int64 encoding.
 */
@Test public void testInt64(){
  Long[] vals={Long.MIN_VALUE,Long.MIN_VALUE / 2,0L,Long.MAX_VALUE / 2,Long.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[9 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,9 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",9,OrderedBytes.encodeInt64(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",9,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",9,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",9,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",vals[i].longValue(),OrderedBytes.decodeInt64(buf1));
      assertEquals("Did not consume enough bytes.",9,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][9];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeInt64(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Long[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      long decoded=OrderedBytes.decodeInt64(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].longValue(),decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test integer encoding. Example input values come from reference wiki
 * page.
 */
@Test public void testNumericInt(){
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < I_VALS.length; i++) {
      byte[] a=new byte[I_LENGTHS[i] + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,I_LENGTHS[i] + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",I_LENGTHS[i],OrderedBytes.encodeNumeric(buf1,I_VALS[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",I_LENGTHS[i],buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",I_LENGTHS[i],OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",I_LENGTHS[i],buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",I_VALS[i].longValue(),OrderedBytes.decodeNumericAsLong(buf1));
      assertEquals("Did not consume enough bytes.",I_LENGTHS[i],buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[I_VALS.length][];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < I_VALS.length; i++) {
      encoded[i]=new byte[I_LENGTHS[i]];
      OrderedBytes.encodeNumeric(pbr.set(encoded[i]),I_VALS[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Long[] sortedVals=Arrays.copyOf(I_VALS,I_VALS.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      pbr.set(encoded[i]);
      long decoded=OrderedBytes.decodeNumericAsLong(pbr);
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].longValue(),decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test BlobVar encoding.
 */
@Test public void testBlobVar(){
  byte[][] vals={"".getBytes(),"foo".getBytes(),"foobarbazbub".getBytes(),{(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa},{(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa},{(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa},{(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55},{(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55},{(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55,(byte)0x55},"1".getBytes(),"22".getBytes(),"333".getBytes(),"4444".getBytes(),"55555".getBytes(),"666666".getBytes(),"7777777".getBytes(),"88888888".getBytes()};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (    byte[] val : vals) {
      int expectedLen=OrderedBytes.blobVarEncodedLength(val.length);
      byte[] a=new byte[expectedLen + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,expectedLen + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLen,OrderedBytes.encodeBlobVar(buf1,val,ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",expectedLen,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",expectedLen,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",expectedLen,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertArrayEquals("Deserialization failed.",val,OrderedBytes.decodeBlobVar(buf1));
      assertEquals("Did not consume enough bytes.",expectedLen,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      encoded[i]=new byte[OrderedBytes.blobVarEncodedLength(vals[i].length)];
      OrderedBytes.encodeBlobVar(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    byte[][] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals,Bytes.BYTES_COMPARATOR);
 else     Arrays.sort(sortedVals,Collections.reverseOrder(Bytes.BYTES_COMPARATOR));
    for (int i=0; i < sortedVals.length; i++) {
      pbr.set(encoded[i]);
      byte[] decoded=OrderedBytes.decodeBlobVar(pbr);
      assertArrayEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",Arrays.toString(sortedVals[i]),Arrays.toString(decoded),ord),sortedVals[i],decoded);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test float64 encoding.
 */
@Test public void testFloat64(){
  Double[] vals={Double.MIN_VALUE,Double.MIN_VALUE + 1.0,0.0,Double.MAX_VALUE / 2.0,Double.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[9 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,9 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",9,OrderedBytes.encodeFloat64(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",9,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",9,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",9,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",Double.doubleToLongBits(vals[i].doubleValue()),Double.doubleToLongBits(OrderedBytes.decodeFloat64(buf1)));
      assertEquals("Did not consume enough bytes.",9,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][9];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeFloat64(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Double[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      double decoded=OrderedBytes.decodeFloat64(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),Double.doubleToLongBits(sortedVals[i].doubleValue()),Double.doubleToLongBits(decoded));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Expected lengths of equivalent values should match
 */
@Test public void testVerifyTestIntegrity(){
  for (int i=0; i < I_VALS.length; i++) {
    for (int d=0; d < D_VALS.length; d++) {
      if (Math.abs(I_VALS[i] - D_VALS[d]) < MIN_EPSILON) {
        assertEquals("Test inconsistency detected: expected lengths for " + I_VALS[i] + " do not match.",I_LENGTHS[i],D_LENGTHS[d]);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Fill gaps in Numeric encoding testing.
 */
@Test public void testNumericOther(){
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < BD_VALS.length; i++) {
      byte[] a=new byte[BD_LENGTHS[i] + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,BD_LENGTHS[i] + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",BD_LENGTHS[i],OrderedBytes.encodeNumeric(buf1,BD_VALS[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",BD_LENGTHS[i],buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",BD_LENGTHS[i],OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",BD_LENGTHS[i],buf1.getPosition() - 1);
      buf1.setPosition(1);
      BigDecimal decoded=OrderedBytes.decodeNumericAsBigDecimal(buf1);
      if (null == BD_VALS[i]) {
        assertEquals(BD_VALS[i],decoded);
      }
 else {
        assertEquals("Deserialization failed.",0,BD_VALS[i].compareTo(decoded));
      }
      assertEquals("Did not consume enough bytes.",BD_LENGTHS[i],buf1.getPosition() - 1);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test real encoding. Example input values come from reference wiki page.
 */
@Test public void testNumericReal(){
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < D_VALS.length; i++) {
      byte[] a=new byte[D_LENGTHS[i] + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,D_LENGTHS[i] + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",D_LENGTHS[i],OrderedBytes.encodeNumeric(buf1,D_VALS[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",D_LENGTHS[i],buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",D_LENGTHS[i],OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",D_LENGTHS[i],buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",D_VALS[i].doubleValue(),OrderedBytes.decodeNumericAsDouble(buf1),MIN_EPSILON);
      assertEquals("Did not consume enough bytes.",D_LENGTHS[i],buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[D_VALS.length][];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < D_VALS.length; i++) {
      encoded[i]=new byte[D_LENGTHS[i]];
      OrderedBytes.encodeNumeric(pbr.set(encoded[i]),D_VALS[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Double[] sortedVals=Arrays.copyOf(D_VALS,D_VALS.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      pbr.set(encoded[i]);
      double decoded=OrderedBytes.decodeNumericAsDouble(pbr);
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),sortedVals[i].doubleValue(),decoded,MIN_EPSILON);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify Real and Int encodings are compatible.
 */
@Test public void testNumericIntRealCompatibility(){
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < I_VALS.length; i++) {
      PositionedByteRange pbri=new SimplePositionedMutableByteRange(I_LENGTHS[i]);
      PositionedByteRange pbrr=new SimplePositionedMutableByteRange(I_LENGTHS[i]);
      OrderedBytes.encodeNumeric(pbri,I_VALS[i],ord);
      OrderedBytes.encodeNumeric(pbrr,I_VALS[i],ord);
      assertArrayEquals("Integer and real encodings differ.",pbri.getBytes(),pbrr.getBytes());
      pbri.setPosition(0);
      pbrr.setPosition(0);
      assertEquals((long)I_VALS[i],OrderedBytes.decodeNumericAsLong(pbri));
      assertEquals((long)I_VALS[i],(long)OrderedBytes.decodeNumericAsDouble(pbrr));
      BigDecimal bd=BigDecimal.valueOf(I_VALS[i]);
      PositionedByteRange pbrbd=new SimplePositionedMutableByteRange(I_LENGTHS[i]);
      OrderedBytes.encodeNumeric(pbrbd,bd,ord);
      assertArrayEquals("Integer and BigDecimal encodings differ.",pbri.getBytes(),pbrbd.getBytes());
      pbri.setPosition(0);
      assertEquals("Value not preserved when decoding as Long",0,bd.compareTo(BigDecimal.valueOf(OrderedBytes.decodeNumericAsLong(pbri))));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test float32 encoding.
 */
@Test public void testFloat32(){
  Float[] vals={Float.MIN_VALUE,Float.MIN_VALUE + 1.0f,0.0f,Float.MAX_VALUE / 2.0f,Float.MAX_VALUE};
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    for (int i=0; i < vals.length; i++) {
      byte[] a=new byte[5 + 3];
      PositionedByteRange buf1=new SimplePositionedMutableByteRange(a,1,5 + 1);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",5,OrderedBytes.encodeFloat32(buf1,vals[i],ord));
      assertEquals("Broken test: serialization did not consume entire buffer.",buf1.getLength(),buf1.getPosition());
      assertEquals("Surprising serialized length.",5,buf1.getPosition() - 1);
      assertEquals("Buffer underflow.",0,a[0]);
      assertEquals("Buffer underflow.",0,a[1]);
      assertEquals("Buffer overflow.",0,a[a.length - 1]);
      buf1.setPosition(1);
      assertEquals("Surprising return value.",5,OrderedBytes.skip(buf1));
      assertEquals("Did not skip enough bytes.",5,buf1.getPosition() - 1);
      buf1.setPosition(1);
      assertEquals("Deserialization failed.",Float.floatToIntBits(vals[i].floatValue()),Float.floatToIntBits(OrderedBytes.decodeFloat32(buf1)));
      assertEquals("Did not consume enough bytes.",5,buf1.getPosition() - 1);
    }
  }
  for (  Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
    byte[][] encoded=new byte[vals.length][5];
    PositionedByteRange pbr=new SimplePositionedMutableByteRange();
    for (int i=0; i < vals.length; i++) {
      OrderedBytes.encodeFloat32(pbr.set(encoded[i]),vals[i],ord);
    }
    Arrays.sort(encoded,Bytes.BYTES_COMPARATOR);
    Float[] sortedVals=Arrays.copyOf(vals,vals.length);
    if (ord == Order.ASCENDING)     Arrays.sort(sortedVals);
 else     Arrays.sort(sortedVals,Collections.reverseOrder());
    for (int i=0; i < sortedVals.length; i++) {
      float decoded=OrderedBytes.decodeFloat32(pbr.set(encoded[i]));
      assertEquals(String.format("Encoded representations do not preserve natural order: <%s>, <%s>, %s",sortedVals[i],decoded,ord),Float.floatToIntBits(sortedVals[i].floatValue()),Float.floatToIntBits(decoded));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.vint.TestFIntTool </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundTrips(){
  long[] values=new long[]{0,1,2,255,256,31123,65535,65536,65537,0xfffffeL,0xffffffL,0x1000000L,0x1000001L,Integer.MAX_VALUE - 1,Integer.MAX_VALUE,(long)Integer.MAX_VALUE + 1,Long.MAX_VALUE - 1,Long.MAX_VALUE};
  for (int i=0; i < values.length; ++i) {
    Assert.assertEquals(values[i],UFIntTool.fromBytes(UFIntTool.getBytes(8,values[i])));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.vint.TestVIntTool </h4><pre class="type-4 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundTrips(){
  Random random=new Random();
  for (int i=0; i < 10000; ++i) {
    int value=random.nextInt(Integer.MAX_VALUE);
    byte[] bytes=UVIntTool.getBytes(value);
    int roundTripped=UVIntTool.getInt(new SingleByteBuff(ByteBuffer.wrap(bytes)),0);
    Assert.assertEquals(value,roundTripped);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.vint.TestVLongTool </h4><pre class="type-4 type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRoundTrips(){
  Random random=new Random();
  for (int i=0; i < 10000; ++i) {
    long value=RandomNumberUtils.nextPositiveLong(random);
    byte[] bytes=UVLongTool.getBytes(value);
    long roundTripped=UVLongTool.getLong(bytes);
    Assert.assertEquals(value,roundTripped);
    int calculatedNumBytes=UVLongTool.numBytes(value);
    int actualNumBytes=bytes.length;
    Assert.assertEquals(actualNumBytes,calculatedNumBytes);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestDefaultWALProvider </h4><pre class="type-9 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Ensure that we can use Set.add to deduplicate WALs
 */
@Test public void setMembershipDedups() throws IOException {
  final Configuration localConf=new Configuration(conf);
  localConf.set(WALFactory.WAL_PROVIDER,DefaultWALProvider.class.getName());
  final WALFactory wals=new WALFactory(localConf,null,currentTest.getMethodName());
  try {
    final Set<WAL> seen=new HashSet<WAL>(1);
    final Random random=new Random();
    assertTrue("first attempt to add WAL from default provider should work.",seen.add(wals.getWAL(Bytes.toBytes(random.nextInt()),null)));
    for (int i=0; i < 1000; i++) {
      assertFalse("default wal provider is only supposed to return a single wal, which should " + "compare as .equals itself.",seen.add(wals.getWAL(Bytes.toBytes(random.nextInt()),null)));
    }
  }
  finally {
    wals.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestSecureWAL </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecureWAL() throws Exception {
  TableName tableName=TableName.valueOf("TestSecureWAL");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(tableName.getName()));
  HRegionInfo regioninfo=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false);
  final int total=10;
  final byte[] row=Bytes.toBytes("row");
  final byte[] family=Bytes.toBytes("family");
  final byte[] value=Bytes.toBytes("Test value");
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  final WALFactory wals=new WALFactory(TEST_UTIL.getConfiguration(),null,"TestSecureWAL");
  final WAL wal=wals.getWAL(regioninfo.getEncodedNameAsBytes(),regioninfo.getTable().getNamespace());
  for (int i=0; i < total; i++) {
    WALEdit kvs=new WALEdit();
    kvs.add(new KeyValue(row,family,Bytes.toBytes(i),value));
    wal.append(htd,regioninfo,new WALKey(regioninfo.getEncodedNameAsBytes(),tableName,System.currentTimeMillis()),kvs,true);
  }
  wal.sync();
  final Path walPath=DefaultWALProvider.getCurrentFileName(wal);
  wals.shutdown();
  long length=fs.getFileStatus(walPath).getLen();
  FSDataInputStream in=fs.open(walPath);
  byte[] fileData=new byte[(int)length];
  IOUtils.readFully(in,fileData);
  in.close();
  assertFalse("Cells appear to be plaintext",Bytes.contains(fileData,value));
  WAL.Reader reader=wals.createReader(TEST_UTIL.getTestFileSystem(),walPath);
  int count=0;
  WAL.Entry entry=new WAL.Entry();
  while (reader.next(entry) != null) {
    count++;
    List<Cell> cells=entry.getEdit().getCells();
    assertTrue("Should be one KV per WALEdit",cells.size() == 1);
    for (    Cell cell : cells) {
      assertTrue("Incorrect row",Bytes.equals(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength(),row,0,row.length));
      assertTrue("Incorrect family",Bytes.equals(cell.getFamilyArray(),cell.getFamilyOffset(),cell.getFamilyLength(),family,0,family.length));
      assertTrue("Incorrect value",Bytes.equals(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength(),value,0,value.length));
    }
  }
  assertEquals("Should have read back as many KVs as written",total,count);
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestWALFactory </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can write out an edit, close, and then read it back in again.
 * @throws IOException
 */
@Test public void testEditAdd() throws IOException {
  final int COL_COUNT=10;
  final HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("tablename")).addFamily(new HColumnDescriptor("column"));
  final byte[] row=Bytes.toBytes("row");
  WAL.Reader reader=null;
  try {
    final MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl(1);
    long timestamp=System.currentTimeMillis();
    WALEdit cols=new WALEdit();
    for (int i=0; i < COL_COUNT; i++) {
      cols.add(new KeyValue(row,Bytes.toBytes("column"),Bytes.toBytes(Integer.toString(i)),timestamp,new byte[]{(byte)(i + '0')}));
    }
    HRegionInfo info=new HRegionInfo(htd.getTableName(),row,Bytes.toBytes(Bytes.toString(row) + "1"),false);
    final WAL log=wals.getWAL(info.getEncodedNameAsBytes(),info.getTable().getNamespace());
    final long txid=log.append(htd,info,new WALKey(info.getEncodedNameAsBytes(),htd.getTableName(),System.currentTimeMillis(),mvcc),cols,true);
    log.sync(txid);
    log.startCacheFlush(info.getEncodedNameAsBytes(),htd.getFamiliesKeys());
    log.completeCacheFlush(info.getEncodedNameAsBytes());
    log.shutdown();
    Path filename=DefaultWALProvider.getCurrentFileName(log);
    reader=wals.createReader(fs,filename);
    for (int i=0; i < 1; i++) {
      WAL.Entry entry=reader.next(null);
      if (entry == null)       break;
      WALKey key=entry.getKey();
      WALEdit val=entry.getEdit();
      assertTrue(Bytes.equals(info.getEncodedNameAsBytes(),key.getEncodedRegionName()));
      assertTrue(htd.getTableName().equals(key.getTablename()));
      Cell cell=val.getCells().get(0);
      assertTrue(Bytes.equals(row,0,row.length,cell.getRowArray(),cell.getRowOffset(),cell.getRowLength()));
      assertEquals((byte)(i + '0'),CellUtil.cloneValue(cell)[0]);
      System.out.println(key + " " + val);
    }
  }
  finally {
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testAppendClose() throws Exception {
  TableName tableName=TableName.valueOf(currentTest.getMethodName());
  HRegionInfo regioninfo=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false);
  final WAL wal=wals.getWAL(regioninfo.getEncodedNameAsBytes(),regioninfo.getTable().getNamespace());
  final int total=20;
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(tableName.getName()));
  for (int i=0; i < total; i++) {
    WALEdit kvs=new WALEdit();
    kvs.add(new KeyValue(Bytes.toBytes(i),tableName.getName(),tableName.getName()));
    wal.append(htd,regioninfo,new WALKey(regioninfo.getEncodedNameAsBytes(),tableName,System.currentTimeMillis()),kvs,true);
  }
  wal.sync();
  int namenodePort=cluster.getNameNodePort();
  final Path walPath=DefaultWALProvider.getCurrentFileName(wal);
  try {
    DistributedFileSystem dfs=(DistributedFileSystem)cluster.getFileSystem();
    dfs.setSafeMode(HdfsConstants.SafeModeAction.SAFEMODE_ENTER);
    TEST_UTIL.shutdownMiniDFSCluster();
    try {
      wal.shutdown();
    }
 catch (    IOException e) {
      LOG.info(e);
    }
    fs.close();
    LOG.info("STOPPED first instance of the cluster");
  }
  finally {
    while (cluster.isClusterUp()) {
      LOG.error("Waiting for cluster to go down");
      Thread.sleep(1000);
    }
    assertFalse(cluster.isClusterUp());
    cluster=null;
    for (int i=0; i < 100; i++) {
      try {
        cluster=TEST_UTIL.startMiniDFSClusterForTestWAL(namenodePort);
        break;
      }
 catch (      BindException e) {
        LOG.info("Sleeping.  BindException bringing up new cluster");
        Threads.sleep(1000);
      }
    }
    cluster.waitActive();
    fs=cluster.getFileSystem();
    LOG.info("STARTED second instance.");
  }
  Method setLeasePeriod=cluster.getClass().getDeclaredMethod("setLeasePeriod",new Class[]{Long.TYPE,Long.TYPE});
  setLeasePeriod.setAccessible(true);
  setLeasePeriod.invoke(cluster,1000L,1000L);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
    LOG.info(e);
  }
  final FileSystem recoveredFs=fs;
  final Configuration rlConf=conf;
class RecoverLogThread extends Thread {
    public Exception exception=null;
    public void run(){
      try {
        FSUtils.getInstance(fs,rlConf).recoverFileLease(recoveredFs,walPath,rlConf,null);
      }
 catch (      IOException e) {
        exception=e;
      }
    }
  }
  RecoverLogThread t=new RecoverLogThread();
  t.start();
  t.join(60 * 1000);
  if (t.isAlive()) {
    t.interrupt();
    throw new Exception("Timed out waiting for WAL.recoverLog()");
  }
  if (t.exception != null)   throw t.exception;
  WAL.Reader reader=wals.createReader(fs,walPath);
  int count=0;
  WAL.Entry entry=new WAL.Entry();
  while (reader.next(entry) != null) {
    count++;
    assertTrue("Should be one KeyValue per WALEdit",entry.getEdit().getCells().size() == 1);
  }
  assertEquals(total,count);
  reader.close();
  setLeasePeriod.invoke(cluster,new Object[]{new Long(60000),new Long(3600000)});
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOException
 */
@Test public void testReadLegacyLog() throws IOException {
  final int columnCount=5;
  final int recordCount=5;
  final TableName tableName=TableName.valueOf("tablename");
  final byte[] row=Bytes.toBytes("row");
  long timestamp=System.currentTimeMillis();
  Path path=new Path(dir,"tempwal");
  SequenceFileLogWriter sflw=null;
  WAL.Reader reader=null;
  try {
    HRegionInfo hri=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
    HTableDescriptor htd=new HTableDescriptor(tableName);
    fs.mkdirs(dir);
    sflw=new SequenceFileLogWriter();
    sflw.init(fs,path,conf,false);
    for (int i=0; i < recordCount; ++i) {
      WALKey key=new HLogKey(hri.getEncodedNameAsBytes(),tableName,i,timestamp,HConstants.DEFAULT_CLUSTER_ID);
      WALEdit edit=new WALEdit();
      for (int j=0; j < columnCount; ++j) {
        if (i == 0) {
          htd.addFamily(new HColumnDescriptor("column" + j));
        }
        String value=i + "" + j;
        edit.add(new KeyValue(row,row,row,timestamp,Bytes.toBytes(value)));
      }
      sflw.append(new WAL.Entry(key,edit));
    }
    sflw.sync();
    sflw.close();
    reader=wals.createReader(fs,path);
    assertTrue(reader instanceof SequenceFileLogReader);
    for (int i=0; i < recordCount; ++i) {
      WAL.Entry entry=reader.next();
      assertNotNull(entry);
      assertEquals(columnCount,entry.getEdit().size());
      assertArrayEquals(hri.getEncodedNameAsBytes(),entry.getKey().getEncodedRegionName());
      assertEquals(tableName,entry.getKey().getTablename());
      int idx=0;
      for (      Cell val : entry.getEdit().getCells()) {
        assertTrue(Bytes.equals(row,0,row.length,val.getRowArray(),val.getRowOffset(),val.getRowLength()));
        String value=i + "" + idx;
        assertArrayEquals(Bytes.toBytes(value),CellUtil.cloneValue(val));
        idx++;
      }
    }
    WAL.Entry entry=reader.next();
    assertNull(entry);
  }
  finally {
    if (sflw != null) {
      sflw.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestWALFiltering </h4><pre class="type-4 type-9 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFlushedSequenceIdsSentToHMaster() throws IOException, InterruptedException, ServiceException {
  SortedMap<byte[],Long> allFlushedSequenceIds=new TreeMap<byte[],Long>(Bytes.BYTES_COMPARATOR);
  for (int i=0; i < NUM_RS; ++i) {
    flushAllRegions(i);
  }
  Thread.sleep(10000);
  HMaster master=TEST_UTIL.getMiniHBaseCluster().getMaster();
  for (int i=0; i < NUM_RS; ++i) {
    for (    byte[] regionName : getRegionsByServer(i)) {
      if (allFlushedSequenceIds.containsKey(regionName)) {
        GetLastFlushedSequenceIdRequest req=RequestConverter.buildGetLastFlushedSequenceIdRequest(regionName);
        assertEquals((long)allFlushedSequenceIds.get(regionName),master.getMasterRpcServices().getLastFlushedSequenceId(null,req).getLastFlushedSequenceId());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZooKeeperACL </h4><pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/master should be
 * created with 2 ACLs: one specifies that the hbase user has full access
 * to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseMasterServerZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/master",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/hbaseid should be
 * created with 2 ACLs: one specifies that the hbase user has full access
 * to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseIDZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/hbaseid",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/root-region-server
 * should be created with 2 ACLs: one specifies that the hbase user has
 * full access to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseRootRegionServerZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/root-region-server",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
