<h3><span class=" glyphicon glyphicon-tag"/>&nbspHybridVerifier</h3><kbd>Contains more than 2 JUnit-based stereotypes</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestLazyCfLoading </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadersAndWriters() throws Exception {
  Configuration conf=util.getConfiguration();
  String timeoutKey=String.format(TIMEOUT_KEY,this.getClass().getSimpleName());
  long maxRuntime=conf.getLong(timeoutKey,DEFAULT_TIMEOUT_MINUTES);
  long serverCount=util.getHBaseClusterInterface().getClusterStatus().getServersSize();
  long keysToWrite=serverCount * KEYS_TO_WRITE_PER_SERVER;
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(TABLE_NAME);
  MultiThreadedWriter writer=new MultiThreadedWriter(dataGen,conf,TABLE_NAME);
  writer.setMultiPut(true);
  LOG.info("Starting writer; the number of keys to write is " + keysToWrite);
  writer.start(1,keysToWrite,WRITER_THREADS);
  long now=EnvironmentEdgeManager.currentTime();
  long timeLimit=now + (maxRuntime * 60000);
  boolean isWriterDone=false;
  while (now < timeLimit && !isWriterDone) {
    LOG.info("Starting the scan; wrote approximately " + dataGen.getTotalNumberOfKeys() + " keys");
    isWriterDone=writer.isDone();
    if (isWriterDone) {
      LOG.info("Scanning full result, writer is done");
    }
    Scan scan=new Scan();
    for (    byte[] cf : dataGen.getColumnFamilies()) {
      scan.addFamily(cf);
    }
    scan.setFilter(dataGen.getScanFilter());
    scan.setLoadColumnFamiliesOnDemand(true);
    long onesGennedBeforeScan=dataGen.getExpectedNumberOfKeys();
    long startTs=EnvironmentEdgeManager.currentTime();
    ResultScanner results=table.getScanner(scan);
    long resultCount=0;
    Result result=null;
    while ((result=results.next()) != null) {
      boolean isOk=writer.verifyResultAgainstDataGenerator(result,true,true);
      Assert.assertTrue("Failed to verify [" + Bytes.toString(result.getRow()) + "]",isOk);
      ++resultCount;
    }
    long timeTaken=EnvironmentEdgeManager.currentTime() - startTs;
    long onesGennedAfterScan=dataGen.getExpectedNumberOfKeys();
    Assert.assertTrue("Read " + resultCount + " keys when at most "+ onesGennedAfterScan+ " were generated ",onesGennedAfterScan >= resultCount);
    if (isWriterDone) {
      Assert.assertTrue("Read " + resultCount + " keys; the writer is done and "+ onesGennedAfterScan+ " keys were generated",onesGennedAfterScan == resultCount);
    }
 else     if (onesGennedBeforeScan * 0.9 > resultCount) {
      LOG.warn("Read way too few keys (" + resultCount + "/"+ onesGennedBeforeScan+ ") - there might be a problem, or the writer might just be slow");
    }
    LOG.info("Scan took " + timeTaken + "ms");
    if (!isWriterDone) {
      Thread.sleep(WAIT_BETWEEN_SCANS_MS);
      now=EnvironmentEdgeManager.currentTime();
    }
  }
  Assert.assertEquals("There are write failures",0,writer.getNumWriteFailures());
  Assert.assertTrue("Writer is not done",isWriterDone);
  connection.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestManyRegions </h4><pre class="type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTableWithRegions() throws Exception {
  CountDownLatch doneSignal=new CountDownLatch(1);
  Worker worker=new Worker(doneSignal,util.getHBaseAdmin());
  Thread t=new Thread(worker);
  LOG.info("Launching worker thread to create the table.");
  t.start();
  boolean workerComplete=false;
  workerComplete=doneSignal.await(TIMEOUT_MINUTES,TimeUnit.MINUTES);
  if (!workerComplete) {
    t.interrupt();
    fail("Timeout limit expired.");
  }
  assertTrue("Table creation failed.",worker.isSuccess());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestCellComparator </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareByteBufferedCell(){
  byte[] r1=Bytes.toBytes("row1");
  byte[] r2=Bytes.toBytes("row2");
  byte[] f1=Bytes.toBytes("cf1");
  byte[] q1=Bytes.toBytes("qual1");
  byte[] q2=Bytes.toBytes("qual2");
  byte[] v=Bytes.toBytes("val1");
  KeyValue kv=new KeyValue(r1,f1,q1,v);
  ByteBuffer buffer=ByteBuffer.wrap(kv.getBuffer());
  Cell bbCell1=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  kv=new KeyValue(r2,f1,q1,v);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  Cell bbCell2=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertEquals(0,CellComparator.compareColumns(bbCell1,bbCell2));
  assertEquals(0,CellComparator.compareColumns(bbCell1,kv));
  kv=new KeyValue(r2,f1,q2,v);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  Cell bbCell3=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertEquals(0,CellComparator.compareFamilies(bbCell2,bbCell3));
  assertTrue(CellComparator.compareQualifiers(bbCell2,bbCell3) < 0);
  assertTrue(CellComparator.compareColumns(bbCell2,bbCell3) < 0);
  assertEquals(0,CellComparator.COMPARATOR.compareRows(bbCell2,bbCell3));
  assertTrue(CellComparator.COMPARATOR.compareRows(bbCell1,bbCell2) < 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestChoreService </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testTriggerNowFailsWhenNotScheduled() throws InterruptedException {
  final int period=100;
  final int sleep=5;
  ChoreService service=new ChoreService("testTriggerNowFailsWhenNotScheduled");
  CountingChore chore=new CountingChore("dn",period);
  try {
    assertFalse(chore.triggerNow());
    assertTrue(chore.getCountOfChoreCalls() == 0);
    service.scheduleChore(chore);
    Thread.sleep(sleep);
    assertEquals(1,chore.getCountOfChoreCalls());
    Thread.sleep(period);
    assertEquals(2,chore.getCountOfChoreCalls());
    assertTrue(chore.triggerNow());
    Thread.sleep(sleep);
    assertTrue(chore.triggerNow());
    Thread.sleep(sleep);
    assertTrue(chore.triggerNow());
    Thread.sleep(sleep);
    assertEquals(5,chore.getCountOfChoreCalls());
  }
  finally {
    shutdownService(service);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestClassFinder </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderFiltersByNameInJar() throws Exception {
  final long counter=testCounter.incrementAndGet();
  final String classNamePrefix=name.getMethodName();
  LOG.info("Created jar " + createAndLoadJar("",classNamePrefix,counter));
  ClassFinder.FileNameFilter notExcNameFilter=new ClassFinder.FileNameFilter(){
    @Override public boolean isCandidateFile(    String fileName,    String absFilePath){
      return !fileName.startsWith(PREFIX);
    }
  }
;
  ClassFinder incClassesFinder=new ClassFinder(null,notExcNameFilter,null);
  Set<Class<?>> incClasses=incClassesFinder.findClasses(makePackageName("",counter),false);
  assertEquals(1,incClasses.size());
  Class<?> incClass=makeClass("",classNamePrefix,counter);
  assertTrue(incClasses.contains(incClass));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderFiltersByPathInJar() throws Exception {
  final String CLASSNAME=name.getMethodName();
  long counter=testCounter.incrementAndGet();
  FileAndPath c1=compileTestClass(counter,"",CLASSNAME);
  FileAndPath c2=compileTestClass(counter,"","c2");
  packageAndLoadJar(c1);
  final String excludedJar=packageAndLoadJar(c2);
  final String excludedJarResource=new File(excludedJar).toURI().getRawSchemeSpecificPart();
  final ClassFinder.ResourcePathFilter notExcJarFilter=new ClassFinder.ResourcePathFilter(){
    @Override public boolean isCandidatePath(    String resourcePath,    boolean isJar){
      return !isJar || !resourcePath.equals(excludedJarResource);
    }
  }
;
  ClassFinder incClassesFinder=new ClassFinder(notExcJarFilter,null,null);
  Set<Class<?>> incClasses=incClassesFinder.findClasses(makePackageName("",counter),false);
  assertEquals(1,incClasses.size());
  Class<?> incClass=makeClass("",CLASSNAME,counter);
  assertTrue(incClasses.contains(incClass));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderFiltersByClassInDirs() throws Exception {
  final long counter=testCounter.incrementAndGet();
  final String classNamePrefix=name.getMethodName();
  String pkgNameSuffix=name.getMethodName();
  LOG.info("Created jar " + createAndLoadJar(pkgNameSuffix,classNamePrefix,counter));
  final Class<?> clazz=makeClass(pkgNameSuffix,classNamePrefix,counter);
  final ClassFinder.ClassFilter notThisFilter=new ClassFinder.ClassFilter(){
    @Override public boolean isCandidateClass(    Class<?> c){
      return c != clazz;
    }
  }
;
  String pkgName=makePackageName(pkgNameSuffix,counter);
  ClassFinder allClassesFinder=new ClassFinder();
  Set<Class<?>> allClasses=allClassesFinder.findClasses(pkgName,false);
  assertTrue("Classes in " + pkgName,allClasses.size() > 0);
  ClassFinder notThisClassFinder=new ClassFinder(null,null,notThisFilter);
  Set<Class<?>> notAllClasses=notThisClassFinder.findClasses(pkgName,false);
  assertFalse(contains(notAllClasses,clazz.getSimpleName()));
  assertEquals(allClasses.size() - 1,notAllClasses.size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderHandlesNestedPackages() throws Exception {
  final String NESTED=".nested";
  final String CLASSNAME1=name.getMethodName() + "1";
  final String CLASSNAME2=name.getMethodName() + "2";
  long counter=testCounter.incrementAndGet();
  FileAndPath c1=compileTestClass(counter,"","c1");
  FileAndPath c2=compileTestClass(counter,NESTED,CLASSNAME1);
  FileAndPath c3=compileTestClass(counter,NESTED,CLASSNAME2);
  packageAndLoadJar(c1,c2);
  packageAndLoadJar(c3);
  ClassFinder allClassesFinder=new ClassFinder();
  Set<Class<?>> nestedClasses=allClassesFinder.findClasses(makePackageName(NESTED,counter),false);
  assertEquals(2,nestedClasses.size());
  Class<?> nestedClass1=makeClass(NESTED,CLASSNAME1,counter);
  assertTrue(nestedClasses.contains(nestedClass1));
  Class<?> nestedClass2=makeClass(NESTED,CLASSNAME2,counter);
  assertTrue(nestedClasses.contains(nestedClass2));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderFiltersByNameInDirs() throws Exception {
  final long counter=testCounter.incrementAndGet();
  final String classNamePrefix=name.getMethodName();
  String pkgNameSuffix=name.getMethodName();
  LOG.info("Created jar " + createAndLoadJar(pkgNameSuffix,classNamePrefix,counter));
  final String classNameToFilterOut=classNamePrefix + counter;
  final ClassFinder.FileNameFilter notThisFilter=new ClassFinder.FileNameFilter(){
    @Override public boolean isCandidateFile(    String fileName,    String absFilePath){
      return !fileName.equals(classNameToFilterOut + ".class");
    }
  }
;
  String pkgName=makePackageName(pkgNameSuffix,counter);
  ClassFinder allClassesFinder=new ClassFinder();
  Set<Class<?>> allClasses=allClassesFinder.findClasses(pkgName,false);
  assertTrue("Classes in " + pkgName,allClasses.size() > 0);
  ClassFinder notThisClassFinder=new ClassFinder(null,notThisFilter,null);
  Set<Class<?>> notAllClasses=notThisClassFinder.findClasses(pkgName,false);
  assertFalse(contains(notAllClasses,classNameToFilterOut));
  assertEquals(allClasses.size() - 1,notAllClasses.size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassFinderFiltersByClassInJar() throws Exception {
  final long counter=testCounter.incrementAndGet();
  final String classNamePrefix=name.getMethodName();
  LOG.info("Created jar " + createAndLoadJar("",classNamePrefix,counter));
  final ClassFinder.ClassFilter notExcClassFilter=new ClassFinder.ClassFilter(){
    @Override public boolean isCandidateClass(    Class<?> c){
      return !c.getSimpleName().startsWith(PREFIX);
    }
  }
;
  ClassFinder incClassesFinder=new ClassFinder(null,null,notExcClassFilter);
  Set<Class<?>> incClasses=incClassesFinder.findClasses(makePackageName("",counter),false);
  assertEquals(1,incClasses.size());
  Class<?> incClass=makeClass("",classNamePrefix,counter);
  assertTrue(incClasses.contains(incClass));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestCompoundConfiguration </h4><pre class="type-10 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithStringMap(){
  Map<String,String> map=new HashMap<String,String>();
  map.put("B","2b");
  map.put("C","33");
  map.put("D","4");
  map.put("G",null);
  CompoundConfiguration compoundConf=new CompoundConfiguration().addStringMap(map);
  assertEquals("2b",compoundConf.get("B"));
  assertEquals(33,compoundConf.getInt("C",0));
  assertEquals("4",compoundConf.get("D"));
  assertEquals(4,compoundConf.getInt("D",0));
  assertNull(compoundConf.get("E"));
  assertEquals(6,compoundConf.getInt("F",6));
  assertNull(compoundConf.get("G"));
  int cnt=0;
  for (  Map.Entry<String,String> entry : compoundConf) {
    cnt++;
    if (entry.getKey().equals("B"))     assertEquals("2b",entry.getValue());
 else     if (entry.getKey().equals("G"))     assertEquals(null,entry.getValue());
  }
  assertEquals(4,cnt);
  CompoundConfiguration conf2=new CompoundConfiguration();
  conf2.set("X","modification");
  conf2.set("D","not4");
  assertEquals("modification",conf2.get("X"));
  assertEquals("not4",conf2.get("D"));
  conf2.addStringMap(map);
  assertEquals("4",conf2.get("D"));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithIbwMap(){
  Map<Bytes,Bytes> map=new HashMap<Bytes,Bytes>();
  map.put(strToIb("B"),strToIb("2b"));
  map.put(strToIb("C"),strToIb("33"));
  map.put(strToIb("D"),strToIb("4"));
  map.put(strToIb("G"),null);
  CompoundConfiguration compoundConf=new CompoundConfiguration().add(baseConf).addBytesMap(map);
  assertEquals("1",compoundConf.get("A"));
  assertEquals("2b",compoundConf.get("B"));
  assertEquals(33,compoundConf.getInt("C",0));
  assertEquals("4",compoundConf.get("D"));
  assertEquals(4,compoundConf.getInt("D",0));
  assertNull(compoundConf.get("E"));
  assertEquals(6,compoundConf.getInt("F",6));
  assertNull(compoundConf.get("G"));
  int cnt=0;
  for (  Map.Entry<String,String> entry : compoundConf) {
    cnt++;
    if (entry.getKey().equals("B"))     assertEquals("2b",entry.getValue());
 else     if (entry.getKey().equals("G"))     assertEquals(null,entry.getValue());
  }
  assertEquals(baseConfSize + 2,cnt);
  CompoundConfiguration conf2=new CompoundConfiguration();
  conf2.set("X","modification");
  conf2.set("D","not4");
  assertEquals("modification",conf2.get("X"));
  assertEquals("not4",conf2.get("D"));
  conf2.addBytesMap(map);
  assertEquals("4",conf2.get("D"));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithConfig(){
  Configuration conf=new Configuration();
  conf.set("B","2b");
  conf.set("C","33");
  conf.set("D","4");
  CompoundConfiguration compoundConf=new CompoundConfiguration().add(baseConf).add(conf);
  assertEquals("1",compoundConf.get("A"));
  assertEquals("2b",compoundConf.get("B"));
  assertEquals(33,compoundConf.getInt("C",0));
  assertEquals("4",compoundConf.get("D"));
  assertEquals(4,compoundConf.getInt("D",0));
  assertNull(compoundConf.get("E"));
  assertEquals(6,compoundConf.getInt("F",6));
  int cnt=0;
  for (  Map.Entry<String,String> entry : compoundConf) {
    cnt++;
    if (entry.getKey().equals("B"))     assertEquals("2b",entry.getValue());
 else     if (entry.getKey().equals("G"))     assertEquals(null,entry.getValue());
  }
  assertEquals(baseConfSize + 1,cnt);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicFunctionality() throws ClassNotFoundException {
  CompoundConfiguration compoundConf=new CompoundConfiguration().add(baseConf);
  assertEquals("1",compoundConf.get("A"));
  assertEquals(2,compoundConf.getInt("B",0));
  assertEquals(3,compoundConf.getInt("C",0));
  assertEquals(0,compoundConf.getInt("D",0));
  assertEquals(CompoundConfiguration.class,compoundConf.getClassByName(CompoundConfiguration.class.getName()));
  try {
    compoundConf.getClassByName("bad_class_name");
    fail("Trying to load bad_class_name should throw an exception");
  }
 catch (  ClassNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPut(){
  CompoundConfiguration compoundConf=new CompoundConfiguration().add(baseConf);
  assertEquals("1",compoundConf.get("A"));
  assertEquals(2,compoundConf.getInt("B",0));
  assertEquals(3,compoundConf.getInt("C",0));
  assertEquals(0,compoundConf.getInt("D",0));
  compoundConf.set("A","1337");
  compoundConf.set("string","stringvalue");
  assertEquals(1337,compoundConf.getInt("A",0));
  assertEquals("stringvalue",compoundConf.get("string"));
  assertEquals("1",baseConf.get("A"));
  assertNull(baseConf.get("string"));
  baseConf.set("setInParent","fromParent");
  assertEquals("fromParent",compoundConf.get("setInParent"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestGlobalMemStoreSize </h4><pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the global mem store size in the region server is equal to sum of each
 * region's mem store size
 * @throws Exception 
 */
@Test public void testGlobalMemStore() throws Exception {
  LOG.info("Starting cluster");
  Configuration conf=HBaseConfiguration.create();
  TEST_UTIL=new HBaseTestingUtility(conf);
  TEST_UTIL.startMiniCluster(1,regionServerNum);
  cluster=TEST_UTIL.getHBaseCluster();
  LOG.info("Waiting for active/ready master");
  cluster.waitForActiveAndReadyMaster();
  TableName table=TableName.valueOf("TestGlobalMemStoreSize");
  byte[] family=Bytes.toBytes("family");
  LOG.info("Creating table with " + regionNum + " regions");
  Table ht=TEST_UTIL.createMultiRegionTable(table,family,regionNum);
  int numRegions=-1;
  try (RegionLocator r=TEST_UTIL.getConnection().getRegionLocator(table)){
    numRegions=r.getStartKeys().length;
  }
   assertEquals(regionNum,numRegions);
  waitForAllRegionsAssigned();
  for (  HRegionServer server : getOnlineRegionServers()) {
    long globalMemStoreSize=0;
    for (    HRegionInfo regionInfo : ProtobufUtil.getOnlineRegions(server.getRSRpcServices())) {
      globalMemStoreSize+=server.getFromOnlineRegions(regionInfo.getEncodedName()).getMemstoreSize();
    }
    assertEquals(server.getRegionServerAccounting().getGlobalMemstoreSize(),globalMemStoreSize);
  }
  int i=0;
  for (  HRegionServer server : getOnlineRegionServers()) {
    LOG.info("Starting flushes on " + server.getServerName() + ", size="+ server.getRegionServerAccounting().getGlobalMemstoreSize());
    for (    HRegionInfo regionInfo : ProtobufUtil.getOnlineRegions(server.getRSRpcServices())) {
      Region r=server.getFromOnlineRegions(regionInfo.getEncodedName());
      flush(r,server);
    }
    LOG.info("Post flush on " + server.getServerName());
    long now=System.currentTimeMillis();
    long timeout=now + 1000;
    while (server.getRegionServerAccounting().getGlobalMemstoreSize() != 0 && timeout < System.currentTimeMillis()) {
      Threads.sleep(10);
    }
    long size=server.getRegionServerAccounting().getGlobalMemstoreSize();
    if (size > 0) {
      for (      HRegionInfo regionInfo : ProtobufUtil.getOnlineRegions(server.getRSRpcServices())) {
        Region r=server.getFromOnlineRegions(regionInfo.getEncodedName());
        long l=r.getMemstoreSize();
        if (l > 0) {
          assertTrue(regionInfo.isMetaRegion());
          LOG.info(r.toString() + " " + l+ ", reflushing");
          r.flush(true);
        }
      }
    }
    size=server.getRegionServerAccounting().getGlobalMemstoreSize();
    assertEquals("Server=" + server.getServerName() + ", i="+ i++,0,size);
  }
  ht.close();
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHBaseConfiguration </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubset() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  String prefix="hbase.mapred.output.";
  conf.set("hbase.security.authentication","kerberos");
  conf.set("hbase.regionserver.kerberos.principal","hbasesource");
  HBaseConfiguration.setWithPrefix(conf,prefix,ImmutableMap.of("hbase.regionserver.kerberos.principal","hbasedest","","shouldbemissing").entrySet());
  Configuration subsetConf=HBaseConfiguration.subset(conf,prefix);
  assertNull(subsetConf.get(prefix + "hbase.regionserver.kerberos.principal"));
  assertEquals("hbasedest",subsetConf.get("hbase.regionserver.kerberos.principal"));
  assertNull(subsetConf.get("hbase.security.authentication"));
  assertNull(subsetConf.get(""));
  Configuration mergedConf=HBaseConfiguration.create(conf);
  HBaseConfiguration.merge(mergedConf,subsetConf);
  assertEquals("hbasedest",mergedConf.get("hbase.regionserver.kerberos.principal"));
  assertEquals("kerberos",mergedConf.get("hbase.security.authentication"));
  assertEquals("shouldbemissing",mergedConf.get(prefix));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHBaseTestingUtility </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniZooKeeperWithOneServer() throws Exception {
  HBaseTestingUtility hbt=new HBaseTestingUtility();
  MiniZooKeeperCluster cluster1=hbt.startMiniZKCluster();
  try {
    assertEquals(0,cluster1.getBackupZooKeeperServerNum());
    assertTrue((cluster1.killCurrentActiveZooKeeperServer() == -1));
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniZooKeeperWithMultipleClientPorts() throws Exception {
  int defaultClientPort=8888;
  int i, j;
  HBaseTestingUtility hbt=new HBaseTestingUtility();
  int[] clientPortList1={1111,1112,1113};
  MiniZooKeeperCluster cluster1=hbt.startMiniZKCluster(clientPortList1.length,clientPortList1);
  try {
    List<Integer> clientPortListInCluster=cluster1.getClientPortList();
    for (i=0; i < clientPortListInCluster.size(); i++) {
      assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList1[i]);
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList2={2222,2223};
  MiniZooKeeperCluster cluster2=hbt.startMiniZKCluster(clientPortList2.length + 2,clientPortList2);
  try {
    List<Integer> clientPortListInCluster=cluster2.getClientPortList();
    for (i=0, j=0; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList2.length) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList2[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j++;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList3={3333,-3334,3335,0};
  MiniZooKeeperCluster cluster3=hbt.startMiniZKCluster(clientPortList3.length + 1,clientPortList3);
  try {
    List<Integer> clientPortListInCluster=cluster3.getClientPortList();
    for (i=0, j=0; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList3.length && clientPortList3[i] > 0) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList3[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j++;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  hbt.getConfiguration().setInt("test.hbase.zookeeper.property.clientPort",defaultClientPort);
  int[] clientPortList4={-4444,defaultClientPort + 2,4446,defaultClientPort};
  MiniZooKeeperCluster cluster4=hbt.startMiniZKCluster(clientPortList4.length + 1,clientPortList4);
  try {
    List<Integer> clientPortListInCluster=cluster4.getClientPortList();
    for (i=0, j=1; i < clientPortListInCluster.size(); i++) {
      if (i < clientPortList4.length && clientPortList4[i] > 0) {
        assertEquals(clientPortListInCluster.get(i).intValue(),clientPortList4[i]);
      }
 else {
        assertEquals(clientPortListInCluster.get(i).intValue(),defaultClientPort + j);
        j+=2;
      }
    }
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
  int[] clientPortList5={5555,5556,5556};
  try {
    MiniZooKeeperCluster cluster5=hbt.startMiniZKCluster(clientPortList5.length,clientPortList5);
    assertTrue(cluster5.getClientPort() == -1);
  }
 catch (  Exception e) {
  }
 finally {
    hbt.shutdownMiniZKCluster();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniZooKeeperWithMultipleServers() throws Exception {
  HBaseTestingUtility hbt=new HBaseTestingUtility();
  MiniZooKeeperCluster cluster2=hbt.startMiniZKCluster(5);
  int defaultClientPort=21818;
  cluster2.setDefaultClientPort(defaultClientPort);
  try {
    assertEquals(4,cluster2.getBackupZooKeeperServerNum());
    int currentActivePort=cluster2.killCurrentActiveZooKeeperServer();
    assertTrue(currentActivePort >= defaultClientPort);
    assertTrue(cluster2.getClientPort() == currentActivePort);
    currentActivePort=cluster2.killCurrentActiveZooKeeperServer();
    assertTrue(currentActivePort >= defaultClientPort);
    assertTrue(cluster2.getClientPort() == currentActivePort);
    assertEquals(2,cluster2.getBackupZooKeeperServerNum());
    assertEquals(3,cluster2.getZooKeeperServerNum());
    cluster2.killOneBackupZooKeeperServer();
    cluster2.killOneBackupZooKeeperServer();
    assertEquals(0,cluster2.getBackupZooKeeperServerNum());
    assertEquals(1,cluster2.getZooKeeperServerNum());
    currentActivePort=cluster2.killCurrentActiveZooKeeperServer();
    assertTrue(currentActivePort == -1);
    assertTrue(cluster2.getClientPort() == currentActivePort);
    cluster2.killOneBackupZooKeeperServer();
    assertEquals(-1,cluster2.getBackupZooKeeperServerNum());
    assertEquals(0,cluster2.getZooKeeperServerNum());
  }
  finally {
    hbt.shutdownMiniZKCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHColumnDescriptor </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPb() throws DeserializationException {
  HColumnDescriptor hcd=new HColumnDescriptor(new HColumnDescriptor(HConstants.CATALOG_FAMILY).setInMemory(true).setScope(HConstants.REPLICATION_SCOPE_LOCAL).setBloomFilterType(BloomType.NONE).setCacheDataInL1(true));
  final int v=123;
  hcd.setBlocksize(v);
  hcd.setTimeToLive(v);
  hcd.setBlockCacheEnabled(!HColumnDescriptor.DEFAULT_BLOCKCACHE);
  hcd.setValue("a","b");
  hcd.setMaxVersions(v);
  assertEquals(v,hcd.getMaxVersions());
  hcd.setMinVersions(v);
  assertEquals(v,hcd.getMinVersions());
  hcd.setKeepDeletedCells(KeepDeletedCells.TRUE);
  hcd.setInMemory(!HColumnDescriptor.DEFAULT_IN_MEMORY);
  boolean inmemory=hcd.isInMemory();
  hcd.setScope(v);
  hcd.setDataBlockEncoding(DataBlockEncoding.FAST_DIFF);
  hcd.setBloomFilterType(BloomType.ROW);
  hcd.setCompressionType(Algorithm.SNAPPY);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(1000L);
  hcd.setDFSReplication((short)v);
  byte[] bytes=hcd.toByteArray();
  HColumnDescriptor deserializedHcd=HColumnDescriptor.parseFrom(bytes);
  assertTrue(hcd.equals(deserializedHcd));
  assertEquals(v,hcd.getBlocksize());
  assertEquals(v,hcd.getTimeToLive());
  assertEquals(hcd.getValue("a"),deserializedHcd.getValue("a"));
  assertEquals(hcd.getMaxVersions(),deserializedHcd.getMaxVersions());
  assertEquals(hcd.getMinVersions(),deserializedHcd.getMinVersions());
  assertEquals(hcd.getKeepDeletedCells(),deserializedHcd.getKeepDeletedCells());
  assertEquals(inmemory,deserializedHcd.isInMemory());
  assertEquals(hcd.getScope(),deserializedHcd.getScope());
  assertTrue(deserializedHcd.getCompressionType().equals(Compression.Algorithm.SNAPPY));
  assertTrue(deserializedHcd.getDataBlockEncoding().equals(DataBlockEncoding.FAST_DIFF));
  assertTrue(deserializedHcd.getBloomFilterType().equals(BloomType.ROW));
  assertEquals(hcd.isMobEnabled(),deserializedHcd.isMobEnabled());
  assertEquals(hcd.getMobThreshold(),deserializedHcd.getMobThreshold());
  assertEquals(v,deserializedHcd.getDFSReplication());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHRegionLocation </h4><pre class="type-7 type-8 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * HRegionLocations are equal if they have the same 'location' -- i.e. host and
 * port -- even if they are carrying different regions.  Verify that is indeed
 * the case.
 */
@Test public void testHashAndEqualsCode(){
  ServerName hsa1=ServerName.valueOf("localhost",1234,-1L);
  HRegionLocation hrl1=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,hsa1);
  HRegionLocation hrl2=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,hsa1);
  assertEquals(hrl1.hashCode(),hrl2.hashCode());
  assertTrue(hrl1.equals(hrl2));
  HRegionLocation hrl3=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,hsa1);
  assertNotSame(hrl1,hrl3);
  assertTrue(hrl1.equals(hrl3));
  ServerName hsa2=ServerName.valueOf("localhost",12345,-1L);
  HRegionLocation hrl4=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,hsa2);
  assertFalse(hrl3.equals(hrl4));
  HRegionLocation hrl5=new HRegionLocation(hrl4.getRegionInfo(),hrl4.getServerName(),hrl4.getSeqNum() + 1);
  assertTrue(hrl4.equals(hrl5));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHTableDescriptor </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPb() throws DeserializationException, IOException {
  HTableDescriptor htd=new HTableDescriptor(TableName.META_TABLE_NAME);
  final int v=123;
  htd.setMaxFileSize(v);
  htd.setDurability(Durability.ASYNC_WAL);
  htd.setReadOnly(true);
  htd.setRegionReplication(2);
  byte[] bytes=htd.toByteArray();
  HTableDescriptor deserializedHtd=HTableDescriptor.parseFrom(bytes);
  assertEquals(htd,deserializedHtd);
  assertEquals(v,deserializedHtd.getMaxFileSize());
  assertTrue(deserializedHtd.isReadOnly());
  assertEquals(Durability.ASYNC_WAL,deserializedHtd.getDurability());
  assertEquals(deserializedHtd.getRegionReplication(),2);
}

</code></pre>

<br>
<pre class="type-7 type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testAddDuplicateFamilies(){
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("table"));
  byte[] familyName=Bytes.toBytes("cf");
  HColumnDescriptor hcd=new HColumnDescriptor(familyName);
  hcd.setBlocksize(1000);
  htd.addFamily(hcd);
  assertEquals(1000,htd.getFamily(familyName).getBlocksize());
  hcd=new HColumnDescriptor(familyName);
  hcd.setBlocksize(2000);
  htd.addFamily(hcd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestLocalHBaseCluster </h4><pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that we can start a local HBase cluster specifying a custom master
 * and regionserver class and then cast back to those classes; also that
 * the cluster will launch and terminate cleanly. See HBASE-6011. Uses the
 * HBaseTestingUtility facilities for creating a LocalHBaseCluster with
 * custom master and regionserver classes.
 */
@Test public void testLocalHBaseCluster() throws Exception {
  TEST_UTIL.startMiniCluster(1,1,null,MyHMaster.class,MyHRegionServer.class);
  try {
    int val=((MyHMaster)TEST_UTIL.getHBaseCluster().getMaster(0)).echo(42);
    assertEquals(42,val);
  }
 catch (  ClassCastException e) {
    fail("Could not cast master to our class");
  }
  try {
    int val=((MyHRegionServer)TEST_UTIL.getHBaseCluster().getRegionServer(0)).echo(42);
    assertEquals(42,val);
  }
 catch (  ClassCastException e) {
    fail("Could not cast regionserver to our class");
  }
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMetaTableAccessor </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests whether maximum of masters system time versus RSs local system time is used
 */
@Test public void testMastersSystemTimeIsUsedInUpdateLocations() throws IOException {
  long regionId=System.currentTimeMillis();
  HRegionInfo regionInfo=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,0);
  ServerName sn=ServerName.valueOf("bar",0,0);
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<HRegionInfo> regionInfos=Lists.newArrayList(regionInfo);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,1);
    long masterSystemTime=EnvironmentEdgeManager.currentTime() + 123456789;
    MetaTableAccessor.updateRegionLocation(connection,regionInfo,sn,1,masterSystemTime);
    Get get=new Get(regionInfo.getRegionName());
    Result result=meta.get(get);
    Cell serverCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getServerColumn(0));
    Cell startCodeCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getStartCodeColumn(0));
    Cell seqNumCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getSeqNumColumn(0));
    assertNotNull(serverCell);
    assertNotNull(startCodeCell);
    assertNotNull(seqNumCell);
    assertTrue(serverCell.getValueLength() > 0);
    assertTrue(startCodeCell.getValueLength() > 0);
    assertTrue(seqNumCell.getValueLength() > 0);
    assertEquals(masterSystemTime,serverCell.getTimestamp());
    assertEquals(masterSystemTime,startCodeCell.getTimestamp());
    assertEquals(masterSystemTime,seqNumCell.getTimestamp());
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMastersSystemTimeIsUsedInMergeRegions() throws IOException {
  long regionId=System.currentTimeMillis();
  HRegionInfo regionInfoA=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,new byte[]{'a'},false,regionId,0);
  HRegionInfo regionInfoB=new HRegionInfo(TableName.valueOf("table_foo"),new byte[]{'a'},HConstants.EMPTY_END_ROW,false,regionId,0);
  HRegionInfo mergedRegionInfo=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,0);
  ServerName sn=ServerName.valueOf("bar",0,0);
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<HRegionInfo> regionInfos=Lists.newArrayList(regionInfoA,regionInfoB);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,1);
    long serverNameTime=EnvironmentEdgeManager.currentTime() + 100000000;
    long masterSystemTime=EnvironmentEdgeManager.currentTime() + 123456789;
    MetaTableAccessor.updateRegionLocation(connection,regionInfoA,sn,1,serverNameTime);
    Get get=new Get(mergedRegionInfo.getRegionName());
    Result result=meta.get(get);
    Cell serverCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getServerColumn(0));
    assertNotNull(serverCell);
    assertEquals(serverNameTime,serverCell.getTimestamp());
    MetaTableAccessor.mergeRegions(connection,mergedRegionInfo,regionInfoA,regionInfoB,sn,1,masterSystemTime);
    result=meta.get(get);
    serverCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getServerColumn(0));
    Cell startCodeCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getStartCodeColumn(0));
    Cell seqNumCell=result.getColumnLatestCell(HConstants.CATALOG_FAMILY,MetaTableAccessor.getSeqNumColumn(0));
    assertNull(serverCell);
    assertNull(startCodeCell);
    assertNull(seqNumCell);
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMetaTableAccessorNoCluster </h4><pre class="type-4 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHRegionInfo() throws IOException {
  assertNull(MetaTableAccessor.getHRegionInfo(new Result()));
  List<Cell> kvs=new ArrayList<Cell>();
  Result r=Result.create(kvs);
  assertNull(MetaTableAccessor.getHRegionInfo(r));
  byte[] f=HConstants.CATALOG_FAMILY;
  kvs.add(new KeyValue(HConstants.EMPTY_BYTE_ARRAY,f,HConstants.SERVER_QUALIFIER,f));
  r=Result.create(kvs);
  assertNull(MetaTableAccessor.getHRegionInfo(r));
  kvs.add(new KeyValue(HConstants.EMPTY_BYTE_ARRAY,f,HConstants.REGIONINFO_QUALIFIER,f));
  HRegionInfo hri=MetaTableAccessor.getHRegionInfo(Result.create(kvs));
  assertTrue(hri == null);
  kvs.clear();
  kvs.add(new KeyValue(HConstants.EMPTY_BYTE_ARRAY,f,HConstants.REGIONINFO_QUALIFIER,HRegionInfo.FIRST_META_REGIONINFO.toByteArray()));
  hri=MetaTableAccessor.getHRegionInfo(Result.create(kvs));
  assertNotNull(hri);
  assertTrue(hri.equals(HRegionInfo.FIRST_META_REGIONINFO));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that MetaTableAccessor will ride over server throwing
 * "Server not running" IOEs.
 * @see @link {https://issues.apache.org/jira/browse/HBASE-3446}
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testRideOverServerNotRunning() throws IOException, InterruptedException, ServiceException {
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(UTIL.getConfiguration(),this.getClass().getSimpleName(),ABORTABLE,true);
  ServerName sn=ServerName.valueOf("example.com",1234,System.currentTimeMillis());
  ClusterConnection connection=null;
  try {
    final ClientProtos.ClientService.BlockingInterface implementation=Mockito.mock(ClientProtos.ClientService.BlockingInterface.class);
    List<Cell> kvs=new ArrayList<Cell>();
    final byte[] rowToVerify=Bytes.toBytes("rowToVerify");
    kvs.add(new KeyValue(rowToVerify,HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,HRegionInfo.FIRST_META_REGIONINFO.toByteArray()));
    kvs.add(new KeyValue(rowToVerify,HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER,Bytes.toBytes(sn.getHostAndPort())));
    kvs.add(new KeyValue(rowToVerify,HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER,Bytes.toBytes(sn.getStartcode())));
    final List<CellScannable> cellScannables=new ArrayList<CellScannable>(1);
    cellScannables.add(Result.create(kvs));
    final ScanResponse.Builder builder=ScanResponse.newBuilder();
    for (    CellScannable result : cellScannables) {
      builder.addCellsPerResult(((Result)result).size());
    }
    Mockito.when(implementation.scan((RpcController)Mockito.any(),(ScanRequest)Mockito.any())).thenThrow(new ServiceException("Server not running (1 of 3)")).thenThrow(new ServiceException("Server not running (2 of 3)")).thenThrow(new ServiceException("Server not running (3 of 3)")).thenReturn(ScanResponse.newBuilder().setScannerId(1234567890L).build()).thenAnswer(new Answer<ScanResponse>(){
      public ScanResponse answer(      InvocationOnMock invocation) throws Throwable {
        ((PayloadCarryingRpcController)invocation.getArguments()[0]).setCellScanner(CellUtil.createCellScanner(cellScannables));
        return builder.build();
      }
    }
).thenReturn(ScanResponse.newBuilder().setMoreResults(false).build());
    connection=HConnectionTestingUtility.getSpiedConnection(UTIL.getConfiguration());
    final HRegionLocation anyLocation=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,sn);
    final RegionLocations rl=new RegionLocations(anyLocation);
    Mockito.doReturn(rl).when(connection).locateRegion((TableName)Mockito.any(),(byte[])Mockito.any(),Mockito.anyBoolean(),Mockito.anyBoolean(),Mockito.anyInt());
    Mockito.doReturn(implementation).when(connection).getClient(Mockito.any(ServerName.class));
    NavigableMap<HRegionInfo,Result> hris=MetaTableAccessor.getServerUserRegions(connection,sn);
    assertEquals(1,hris.size());
    assertTrue(hris.firstEntry().getKey().equals(HRegionInfo.FIRST_META_REGIONINFO));
    assertTrue(Bytes.equals(rowToVerify,hris.firstEntry().getValue().getRow()));
    Mockito.verify(implementation,Mockito.times(6)).scan((RpcController)Mockito.any(),(ScanRequest)Mockito.any());
  }
  finally {
    if (connection != null && !connection.isClosed())     connection.close();
    zkw.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMetaTableLocator </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test interruptable while blocking wait on meta.
 * @throws IOException
 * @throws ServiceException
 * @throws InterruptedException
 */
@Test public void testInterruptWaitOnMeta() throws IOException, InterruptedException, ServiceException {
  final ClientProtos.ClientService.BlockingInterface client=Mockito.mock(ClientProtos.ClientService.BlockingInterface.class);
  Mockito.when(client.get((RpcController)Mockito.any(),(GetRequest)Mockito.any())).thenReturn(GetResponse.newBuilder().build());
  final MetaTableLocator mtl=new MetaTableLocator();
  ServerName meta=new MetaTableLocator().getMetaRegionLocation(this.watcher);
  assertNull(meta);
  Thread t=new Thread(){
    @Override public void run(){
      try {
        mtl.waitMetaRegionLocation(watcher);
      }
 catch (      InterruptedException e) {
        throw new RuntimeException("Interrupted",e);
      }
    }
  }
;
  t.start();
  while (!t.isAlive())   Threads.sleep(1);
  Threads.sleep(1);
  assertTrue(t.isAlive());
  mtl.stop();
  t.join();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test normal operations
 */
@Test public void testMetaLookup() throws IOException, InterruptedException, ServiceException, KeeperException {
  final ClientProtos.ClientService.BlockingInterface client=Mockito.mock(ClientProtos.ClientService.BlockingInterface.class);
  Mockito.when(client.get((RpcController)Mockito.any(),(GetRequest)Mockito.any())).thenReturn(GetResponse.newBuilder().build());
  final MetaTableLocator mtl=new MetaTableLocator();
  assertNull(mtl.getMetaRegionLocation(this.watcher));
  for (  RegionState.State state : RegionState.State.values()) {
    if (state.equals(RegionState.State.OPEN))     continue;
    MetaTableLocator.setMetaLocation(this.watcher,SN,state);
    assertNull(mtl.getMetaRegionLocation(this.watcher));
    assertEquals(state,MetaTableLocator.getMetaRegionState(this.watcher).getState());
  }
  MetaTableLocator.setMetaLocation(this.watcher,SN,RegionState.State.OPEN);
  assertEquals(mtl.getMetaRegionLocation(this.watcher),SN);
  assertEquals(RegionState.State.OPEN,MetaTableLocator.getMetaRegionState(this.watcher).getState());
  mtl.deleteMetaLocation(this.watcher);
  assertNull(MetaTableLocator.getMetaRegionState(this.watcher).getServerName());
  assertEquals(MetaTableLocator.getMetaRegionState(this.watcher).getState(),RegionState.State.OFFLINE);
  assertNull(mtl.getMetaRegionLocation(this.watcher));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test waiting on meat w/ no timeout specified.
 * @throws IOException
 * @throws InterruptedException
 * @throws KeeperException
 */
@Test public void testNoTimeoutWaitForMeta() throws IOException, InterruptedException, KeeperException {
  final MetaTableLocator mtl=new MetaTableLocator();
  ServerName hsa=mtl.getMetaRegionLocation(watcher);
  assertNull(hsa);
  Thread t=new WaitOnMetaThread();
  startWaitAliveThenWaitItLives(t,1);
  MetaTableLocator.setMetaLocation(this.watcher,SN,RegionState.State.OPEN);
  hsa=SN;
  t.join();
  assertTrue(mtl.getMetaRegionLocation(watcher).equals(hsa));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMultiVersions </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies versions across a cluster restart.
 * Port of old TestGetRowVersions test to here so can better utilize the spun
 * up cluster running more than a single test per spin up.  Keep old tests'
 * crazyness.
 */
@Test public void testGetRowVersions() throws Exception {
  final String tableName="testGetRowVersions";
  final byte[] contents=Bytes.toBytes("contents");
  final byte[] row=Bytes.toBytes("row");
  final byte[] value1=Bytes.toBytes("value1");
  final byte[] value2=Bytes.toBytes("value2");
  final long timestamp1=100L;
  final long timestamp2=200L;
  final HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(tableName));
  HColumnDescriptor hcd=new HColumnDescriptor(contents);
  hcd.setMaxVersions(3);
  desc.addFamily(hcd);
  this.admin.createTable(desc);
  Put put=new Put(row,timestamp1);
  put.addColumn(contents,contents,value1);
  Table table=UTIL.getConnection().getTable(desc.getTableName());
  table.put(put);
  table.close();
  UTIL.shutdownMiniHBaseCluster();
  LOG.debug("HBase cluster shut down -- restarting");
  UTIL.startMiniHBaseCluster(1,NUM_SLAVES);
  table=UTIL.getConnection().getTable(desc.getTableName());
  put=new Put(row,timestamp2);
  put.addColumn(contents,contents,value2);
  table.put(put);
  Get get=new Get(row);
  Result r=table.get(get);
  assertNotNull(r);
  assertFalse(r.isEmpty());
  assertTrue(r.size() == 1);
  byte[] value=r.getValue(contents,contents);
  assertTrue(value.length != 0);
  assertTrue(Bytes.equals(value,value2));
  get=new Get(row);
  get.setMaxVersions();
  r=table.get(get);
  assertTrue(r.size() == 2);
  value=r.getValue(contents,contents);
  assertTrue(value.length != 0);
  assertTrue(Bytes.equals(value,value2));
  NavigableMap<byte[],NavigableMap<byte[],NavigableMap<Long,byte[]>>> map=r.getMap();
  NavigableMap<byte[],NavigableMap<Long,byte[]>> familyMap=map.get(contents);
  NavigableMap<Long,byte[]> versionMap=familyMap.get(contents);
  assertTrue(versionMap.size() == 2);
  assertTrue(Bytes.equals(value1,versionMap.get(timestamp1)));
  assertTrue(Bytes.equals(value2,versionMap.get(timestamp2)));
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Port of old TestScanMultipleVersions test here so can better utilize the
 * spun up cluster running more than just a single test.  Keep old tests
 * crazyness.
 * <p>Tests five cases of scans and timestamps.
 * @throws Exception
 */
@Test public void testScanMultipleVersions() throws Exception {
  final TableName tableName=TableName.valueOf("testScanMultipleVersions");
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  final byte[][] rows=new byte[][]{Bytes.toBytes("row_0200"),Bytes.toBytes("row_0800")};
  final byte[][] splitRows=new byte[][]{Bytes.toBytes("row_0500")};
  final long[] timestamp=new long[]{100L,1000L};
  this.admin.createTable(desc,splitRows);
  Table table=UTIL.getConnection().getTable(tableName);
  Pair<byte[][],byte[][]> keys=UTIL.getConnection().getRegionLocator(tableName).getStartEndKeys();
  assertEquals(2,keys.getFirst().length);
  byte[][] startKeys=keys.getFirst();
  byte[][] endKeys=keys.getSecond();
  for (int i=0; i < startKeys.length; i++) {
    if (i == 0) {
      assertTrue(Bytes.equals(HConstants.EMPTY_START_ROW,startKeys[i]));
      assertTrue(Bytes.equals(endKeys[i],splitRows[0]));
    }
 else     if (i == 1) {
      assertTrue(Bytes.equals(splitRows[0],startKeys[i]));
      assertTrue(Bytes.equals(endKeys[i],HConstants.EMPTY_END_ROW));
    }
  }
  List<Put> puts=new ArrayList<>();
  for (int i=0; i < startKeys.length; i++) {
    for (int j=0; j < timestamp.length; j++) {
      Put put=new Put(rows[i],timestamp[j]);
      put.addColumn(HConstants.CATALOG_FAMILY,null,timestamp[j],Bytes.toBytes(timestamp[j]));
      puts.add(put);
    }
  }
  table.put(puts);
  for (int i=0; i < rows.length; i++) {
    for (int j=0; j < timestamp.length; j++) {
      Get get=new Get(rows[i]);
      get.addFamily(HConstants.CATALOG_FAMILY);
      get.setTimeStamp(timestamp[j]);
      Result result=table.get(get);
      int cellCount=0;
      for (      @SuppressWarnings("unused") Cell kv : result.listCells()) {
        cellCount++;
      }
      assertTrue(cellCount == 1);
    }
  }
  int count=0;
  Scan scan=new Scan();
  scan.addFamily(HConstants.CATALOG_FAMILY);
  ResultScanner s=table.getScanner(scan);
  try {
    for (Result rr=null; (rr=s.next()) != null; ) {
      System.out.println(rr.toString());
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeRange(1000L,Long.MAX_VALUE);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeStamp(1000L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeRange(100L,1000L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
  count=0;
  scan=new Scan();
  scan.setTimeStamp(100L);
  scan.addFamily(HConstants.CATALOG_FAMILY);
  s=table.getScanner(scan);
  try {
    while (s.next() != null) {
      count+=1;
    }
    assertEquals("Number of rows should be 2",2,count);
  }
  finally {
    s.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestNamespace </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testNamespaceOperations() throws IOException {
  admin.createNamespace(NamespaceDescriptor.create(prefix + "ns1").build());
  admin.createNamespace(NamespaceDescriptor.create(prefix + "ns2").build());
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      admin.createNamespace(NamespaceDescriptor.create(prefix + "ns1").build());
      return null;
    }
  }
,NamespaceExistException.class);
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("non_existing_namespace","table1"));
      htd.addFamily(new HColumnDescriptor("family1"));
      admin.createTable(htd);
      return null;
    }
  }
,NamespaceNotFoundException.class);
  admin.getNamespaceDescriptor(prefix + "ns1");
  runWithExpectedException(new Callable<NamespaceDescriptor>(){
    @Override public NamespaceDescriptor call() throws Exception {
      return admin.getNamespaceDescriptor("non_existing_namespace");
    }
  }
,NamespaceNotFoundException.class);
  admin.deleteNamespace(prefix + "ns2");
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      admin.deleteNamespace("non_existing_namespace");
      return null;
    }
  }
,NamespaceNotFoundException.class);
  NamespaceDescriptor ns1=admin.getNamespaceDescriptor(prefix + "ns1");
  ns1.setConfiguration("foo","bar");
  admin.modifyNamespace(ns1);
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      admin.modifyNamespace(NamespaceDescriptor.create("non_existing_namespace").build());
      return null;
    }
  }
,NamespaceNotFoundException.class);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(prefix + "ns1","table1"));
  htd.addFamily(new HColumnDescriptor("family1"));
  admin.createTable(htd);
  HTableDescriptor[] htds=admin.listTableDescriptorsByNamespace(prefix + "ns1");
  assertNotNull("Should have not returned null",htds);
  assertEquals("Should have returned non-empty array",1,htds.length);
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      admin.listTableDescriptorsByNamespace("non_existant_namespace");
      return null;
    }
  }
,NamespaceNotFoundException.class);
  TableName[] tableNames=admin.listTableNamesByNamespace(prefix + "ns1");
  assertNotNull("Should have not returned null",tableNames);
  assertEquals("Should have returned non-empty array",1,tableNames.length);
  runWithExpectedException(new Callable<Void>(){
    @Override public Void call() throws Exception {
      admin.listTableNamesByNamespace("non_existing_namespace");
      return null;
    }
  }
,NamespaceNotFoundException.class);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTableInSystemNamespace() throws Exception {
  TableName tableName=TableName.valueOf("hbase:createTableInSystemNamespace");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  HColumnDescriptor colDesc=new HColumnDescriptor("cf1");
  desc.addFamily(colDesc);
  admin.createTable(desc);
  assertEquals(0,admin.listTables().length);
  assertTrue(admin.tableExists(tableName));
  admin.disableTable(desc.getTableName());
  admin.deleteTable(desc.getTableName());
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createDoubleTest() throws IOException, InterruptedException {
  String testName="createDoubleTest";
  String nsName=prefix + "_" + testName;
  LOG.info(testName);
  TableName tableName=TableName.valueOf("my_table");
  TableName tableNameFoo=TableName.valueOf(nsName + ":my_table");
  admin.createNamespace(NamespaceDescriptor.create(nsName).build());
  TEST_UTIL.createTable(tableName,Bytes.toBytes(nsName));
  TEST_UTIL.createTable(tableNameFoo,Bytes.toBytes(nsName));
  assertEquals(2,admin.listTables().length);
  assertNotNull(admin.getTableDescriptor(tableName));
  assertNotNull(admin.getTableDescriptor(tableNameFoo));
  admin.disableTable(tableName);
  admin.deleteTable(tableName);
  assertEquals(1,admin.listTables().length);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTableTest() throws IOException, InterruptedException {
  String testName="createTableTest";
  String nsName=prefix + "_" + testName;
  LOG.info(testName);
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(nsName + ":my_table"));
  HColumnDescriptor colDesc=new HColumnDescriptor("my_cf");
  desc.addFamily(colDesc);
  try {
    admin.createTable(desc);
    fail("Expected no namespace exists exception");
  }
 catch (  NamespaceNotFoundException ex) {
  }
  admin.createNamespace(NamespaceDescriptor.create(nsName).build());
  admin.createTable(desc);
  TEST_UTIL.waitTableAvailable(desc.getTableName().getName(),10000);
  FileSystem fs=FileSystem.get(TEST_UTIL.getConfiguration());
  assertTrue(fs.exists(new Path(master.getMasterFileSystem().getRootDir(),new Path(HConstants.BASE_NAMESPACE_DIR,new Path(nsName,desc.getTableName().getQualifierAsString())))));
  assertEquals(1,admin.listTables().length);
  try {
    admin.deleteNamespace(nsName);
    fail("Expected non-empty namespace constraint exception");
  }
 catch (  Exception ex) {
    LOG.info("Caught expected exception: " + ex);
  }
  Table table=TEST_UTIL.getConnection().getTable(desc.getTableName());
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(Bytes.toBytes("my_cf"),Bytes.toBytes("my_col"),Bytes.toBytes("value1"));
  table.put(p);
  admin.flush(desc.getTableName());
  Get g=new Get(Bytes.toBytes("row1"));
  assertTrue(table.exists(g));
  TEST_UTIL.deleteTable(desc.getTableName());
  admin.deleteNamespace(nsName);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createRemoveTest() throws Exception {
  String testName="createRemoveTest";
  String nsName=prefix + "_" + testName;
  LOG.info(testName);
  admin.createNamespace(NamespaceDescriptor.create(nsName).build());
  assertEquals(3,admin.listNamespaceDescriptors().length);
  TEST_UTIL.waitFor(60000,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return zkNamespaceManager.list().size() == 3;
    }
  }
);
  assertNotNull(zkNamespaceManager.get(nsName));
  admin.deleteNamespace(nsName);
  assertEquals(2,admin.listNamespaceDescriptors().length);
  assertEquals(2,zkNamespaceManager.list().size());
  assertNull(zkNamespaceManager.get(nsName));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyReservedNS() throws IOException {
  NamespaceDescriptor ns=admin.getNamespaceDescriptor(NamespaceDescriptor.DEFAULT_NAMESPACE.getName());
  assertNotNull(ns);
  assertEquals(ns.getName(),NamespaceDescriptor.DEFAULT_NAMESPACE.getName());
  assertNotNull(zkNamespaceManager.get(NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR));
  ns=admin.getNamespaceDescriptor(NamespaceDescriptor.SYSTEM_NAMESPACE.getName());
  assertNotNull(ns);
  assertEquals(ns.getName(),NamespaceDescriptor.SYSTEM_NAMESPACE.getName());
  assertNotNull(zkNamespaceManager.get(NamespaceDescriptor.SYSTEM_NAMESPACE_NAME_STR));
  assertEquals(2,admin.listNamespaceDescriptors().length);
  Set<TableName> systemTables=Sets.newHashSet(TableName.META_TABLE_NAME,TableName.NAMESPACE_TABLE_NAME);
  HTableDescriptor[] descs=admin.listTableDescriptorsByNamespace(NamespaceDescriptor.SYSTEM_NAMESPACE.getName());
  assertEquals(systemTables.size(),descs.length);
  for (  HTableDescriptor desc : descs) {
    assertTrue(systemTables.contains(desc.getTableName()));
  }
  assertEquals(0,admin.listTables().length);
  boolean exceptionCaught=false;
  try {
    admin.createNamespace(NamespaceDescriptor.DEFAULT_NAMESPACE);
  }
 catch (  IOException exp) {
    LOG.warn(exp);
    exceptionCaught=true;
  }
 finally {
    assertTrue(exceptionCaught);
  }
  exceptionCaught=false;
  try {
    admin.createNamespace(NamespaceDescriptor.SYSTEM_NAMESPACE);
  }
 catch (  IOException exp) {
    LOG.warn(exp);
    exceptionCaught=true;
  }
 finally {
    assertTrue(exceptionCaught);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestOffheapKeyValue </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteBufferBackedKeyValueWithTags() throws Exception {
  KeyValue kvCell=new KeyValue(row1,fam1,qual1,0l,Type.Put,row1,tags);
  ByteBuffer buf=ByteBuffer.allocateDirect(kvCell.getBuffer().length);
  ByteBufferUtils.copyFromArrayToBuffer(buf,kvCell.getBuffer(),0,kvCell.getBuffer().length);
  ByteBufferedCell offheapKV=new OffheapKeyValue(buf,0,buf.capacity(),true,0l);
  assertEquals(ROW1,ByteBufferUtils.toStringBinary(offheapKV.getRowByteBuffer(),offheapKV.getRowPosition(),offheapKV.getRowLength()));
  assertEquals(FAM1,ByteBufferUtils.toStringBinary(offheapKV.getFamilyByteBuffer(),offheapKV.getFamilyPosition(),offheapKV.getFamilyLength()));
  assertEquals(QUAL1,ByteBufferUtils.toStringBinary(offheapKV.getQualifierByteBuffer(),offheapKV.getQualifierPosition(),offheapKV.getQualifierLength()));
  assertEquals(ROW1,ByteBufferUtils.toStringBinary(offheapKV.getValueByteBuffer(),offheapKV.getValuePosition(),offheapKV.getValueLength()));
  assertEquals(0L,offheapKV.getTimestamp());
  assertEquals(Type.Put.getCode(),offheapKV.getTypeByte());
  List<Tag> resTags=TagUtil.asList(offheapKV.getTagsArray(),offheapKV.getTagsOffset(),offheapKV.getTagsLength());
  Tag tag1=resTags.get(0);
  assertEquals(t1.getType(),tag1.getType());
  assertEquals(TagUtil.getValueAsString(t1),TagUtil.getValueAsString(tag1));
  Tag tag2=resTags.get(1);
  assertEquals(tag2.getType(),tag2.getType());
  assertEquals(TagUtil.getValueAsString(t2),TagUtil.getValueAsString(tag2));
  Tag res=CellUtil.getTag(offheapKV,(byte)2);
  assertEquals(TagUtil.getValueAsString(t2),TagUtil.getValueAsString(tag2));
  res=CellUtil.getTag(offheapKV,(byte)3);
  assertNull(res);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestPerformanceEvaluation </h4><pre class="type-4 type-7 type-8 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Exercise the mr spec writing.  Simple assertions to make sure it is basically working.
 * @throws IOException
 */
@Ignore @Test public void testWriteInputFile() throws IOException {
  TestOptions opts=new PerformanceEvaluation.TestOptions();
  final int clients=10;
  opts.setNumClientThreads(clients);
  opts.setPerClientRunRows(10);
  Path dir=PerformanceEvaluation.writeInputFile(HTU.getConfiguration(),opts,HTU.getDataTestDir());
  FileSystem fs=FileSystem.get(HTU.getConfiguration());
  Path p=new Path(dir,PerformanceEvaluation.JOB_INPUT_FILENAME);
  long len=fs.getFileStatus(p).getLen();
  assertTrue(len > 0);
  byte[] content=new byte[(int)len];
  FSDataInputStream dis=fs.open(p);
  try {
    dis.readFully(content);
    BufferedReader br=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(content)));
    int count=0;
    while (br.readLine() != null) {
      count++;
    }
    assertEquals(clients * PerformanceEvaluation.TASKS_PER_CLIENT,count);
  }
  finally {
    dis.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestRegionLocations </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstructWithNullElements(){
  RegionLocations list=new RegionLocations((HRegionLocation)null);
  assertTrue(list.isEmpty());
  assertEquals(1,list.size());
  assertEquals(0,list.numNonNullElements());
  list=new RegionLocations(null,hrl(info1,sn0));
  assertFalse(list.isEmpty());
  assertEquals(2,list.size());
  assertEquals(1,list.numNonNullElements());
  list=new RegionLocations(hrl(info0,sn0),null);
  assertEquals(2,list.size());
  assertEquals(1,list.numNonNullElements());
  list=new RegionLocations(null,hrl(info2,sn0),null,hrl(info9,sn0));
  assertEquals(10,list.size());
  assertEquals(2,list.numNonNullElements());
  list=new RegionLocations(null,hrl(info2,sn0),null,hrl(info9,sn0),null);
  assertEquals(11,list.size());
  assertEquals(2,list.numNonNullElements());
  list=new RegionLocations(null,hrl(info2,sn0),null,hrl(info9,sn0),null,null);
  assertEquals(12,list.size());
  assertEquals(2,list.numNonNullElements());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateLocationWithDifferentRegionId(){
  RegionLocations list;
  HRegionInfo info0=hri(regionId1,0);
  HRegionInfo info1=hri(regionId2,1);
  HRegionInfo info2=hri(regionId1,2);
  list=new RegionLocations(hrl(info0,sn1),hrl(info2,sn1));
  list=list.updateLocation(hrl(info1,sn2),false,true);
  assertNull(list.getRegionLocation(0));
  assertNotNull(list.getRegionLocation(1));
  assertNull(list.getRegionLocation(2));
  assertEquals(sn2,list.getRegionLocation(1).getServerName());
  assertEquals(3,list.size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove(){
  RegionLocations list;
  list=new RegionLocations();
  assertTrue(list == list.remove(hrl(info0,sn0)));
  list=hrll(hrl(info0,sn0));
  assertTrue(list == list.remove(hrl(info0,sn1)));
  list=list.remove(hrl(info0,sn0));
  assertTrue(list.isEmpty());
  list=hrll(hrl(info0,sn0),hrl(info1,sn1),hrl(info2,sn2),hrl(info9,sn2));
  assertTrue(list == list.remove(hrl(info1,sn3)));
  list=list.remove(hrl(info0,sn0));
  assertNull(list.getRegionLocation(0));
  assertEquals(sn1,list.getRegionLocation(1).getServerName());
  assertEquals(sn2,list.getRegionLocation(2).getServerName());
  assertNull(list.getRegionLocation(5));
  assertEquals(sn2,list.getRegionLocation(9).getServerName());
  list=list.remove(hrl(info9,sn2));
  assertNull(list.getRegionLocation(0));
  assertEquals(sn1,list.getRegionLocation(1).getServerName());
  assertEquals(sn2,list.getRegionLocation(2).getServerName());
  assertNull(list.getRegionLocation(5));
  assertNull(list.getRegionLocation(9));
  list=hrll(hrl(info0,sn1),hrl(info1,sn1),hrl(info2,sn0),hrl(info9,sn0));
  list=list.remove(hrl(info9,sn0));
  assertEquals(sn1,list.getRegionLocation(0).getServerName());
  assertEquals(sn1,list.getRegionLocation(1).getServerName());
  assertEquals(sn0,list.getRegionLocation(2).getServerName());
  assertNull(list.getRegionLocation(5));
  assertNull(list.getRegionLocation(9));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveByServer(){
  RegionLocations list;
  list=new RegionLocations();
  assertTrue(list == list.removeByServer(sn0));
  list=hrll(hrl(info0,sn0));
  assertTrue(list == list.removeByServer(sn1));
  list=list.removeByServer(sn0);
  assertEquals(0,list.numNonNullElements());
  list=hrll(hrl(info0,sn0),hrl(info1,sn1),hrl(info2,sn2),hrl(info9,sn2));
  assertTrue(list == list.removeByServer(sn3));
  list=list.removeByServer(sn0);
  assertNull(list.getRegionLocation(0));
  assertEquals(sn1,list.getRegionLocation(1).getServerName());
  assertEquals(sn2,list.getRegionLocation(2).getServerName());
  assertNull(list.getRegionLocation(5));
  assertEquals(sn2,list.getRegionLocation(9).getServerName());
  list=hrll(hrl(info0,sn1),hrl(info1,sn1),hrl(info2,sn0),hrl(info9,sn0));
  list=list.removeByServer(sn0);
  assertEquals(sn1,list.getRegionLocation(0).getServerName());
  assertEquals(sn1,list.getRegionLocation(1).getServerName());
  assertNull(list.getRegionLocation(2));
  assertNull(list.getRegionLocation(5));
  assertNull(list.getRegionLocation(9));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSizeMethods(){
  RegionLocations list=new RegionLocations();
  assertTrue(list.isEmpty());
  assertEquals(0,list.size());
  assertEquals(0,list.numNonNullElements());
  list=hrll((HRegionLocation)null);
  assertTrue(list.isEmpty());
  assertEquals(1,list.size());
  assertEquals(0,list.numNonNullElements());
  HRegionInfo info0=hri(0);
  list=hrll(hrl(info0,null));
  assertTrue(list.isEmpty());
  assertEquals(1,list.size());
  assertEquals(0,list.numNonNullElements());
  HRegionInfo info9=hri(9);
  list=hrll(hrl(info9,null));
  assertTrue(list.isEmpty());
  assertEquals(10,list.size());
  assertEquals(0,list.numNonNullElements());
  list=hrll(hrl(info0,null),hrl(info9,null));
  assertTrue(list.isEmpty());
  assertEquals(10,list.size());
  assertEquals(0,list.numNonNullElements());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeLocationsWithDifferentRegionId(){
  RegionLocations list1, list2;
  HRegionInfo info0=hri(regionId1,0);
  HRegionInfo info1=hri(regionId1,1);
  HRegionInfo info2=hri(regionId2,2);
  list1=hrll(hrl(info2,sn1));
  list2=hrll(hrl(info0,sn2),hrl(info1,sn2));
  list1=list2.mergeLocations(list1);
  assertNull(list1.getRegionLocation(0));
  assertNull(list1.getRegionLocation(1));
  assertNotNull(list1.getRegionLocation(2));
  assertEquals(sn1,list1.getRegionLocation(2).getServerName());
  assertEquals(3,list1.size());
  list1=hrll(hrl(info2,sn1));
  list2=hrll(hrl(info0,sn2),hrl(info1,sn2));
  list2=list1.mergeLocations(list2);
  assertNotNull(list2.getRegionLocation(0));
  assertNotNull(list2.getRegionLocation(1));
  assertNull(list2.getRegionLocation(2));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeLocations(){
  RegionLocations list1, list2;
  list1=new RegionLocations();
  list2=new RegionLocations();
  assertTrue(list1 == list1.mergeLocations(list2));
  list2=hrll(hrl(info0,sn0));
  list1=list1.mergeLocations(list2);
  assertEquals(sn0,list1.getRegionLocation(0).getServerName());
  list1=hrll();
  list1=list2.mergeLocations(list1);
  assertEquals(sn0,list1.getRegionLocation(0).getServerName());
  list1=hrll(hrl(info0,sn0),hrl(info1,sn1));
  list2=hrll(hrl(info2,sn2));
  list1=list2.mergeLocations(list1);
  assertEquals(sn0,list1.getRegionLocation(0).getServerName());
  assertEquals(sn1,list1.getRegionLocation(1).getServerName());
  assertEquals(2,list1.size());
  list1=hrll(hrl(info0,sn0),hrl(info1,sn1));
  list2=hrll(hrl(info2,sn2));
  list1=list1.mergeLocations(list2);
  assertEquals(sn0,list1.getRegionLocation(0).getServerName());
  assertEquals(sn1,list1.getRegionLocation(1).getServerName());
  assertEquals(sn2,list1.getRegionLocation(2).getServerName());
  list1=hrll(hrl(info0,sn0),hrl(info1,sn1));
  list2=hrll(hrl(info0,sn2),hrl(info1,sn2),hrl(info9,sn3));
  list1=list2.mergeLocations(list1);
  assertEquals(2,list1.size());
  assertEquals(sn0,list1.getRegionLocation(0).getServerName());
  assertEquals(sn1,list1.getRegionLocation(1).getServerName());
  list1=hrll(hrl(info0,sn0),hrl(info1,sn1));
  list2=hrll(hrl(info0,sn2),hrl(info1,sn2),hrl(info9,sn3));
  list1=list1.mergeLocations(list2);
  assertEquals(10,list1.size());
  assertEquals(sn2,list1.getRegionLocation(0).getServerName());
  assertEquals(sn2,list1.getRegionLocation(1).getServerName());
  assertEquals(sn3,list1.getRegionLocation(9).getServerName());
  list1=hrll(hrl(info0,sn0,10),hrl(info1,sn1,10));
  list2=hrll(hrl(info0,sn2,11),hrl(info1,sn2,11),hrl(info9,sn3,11));
  list1=list1.mergeLocations(list2);
  assertEquals(10,list1.size());
  assertEquals(sn2,list1.getRegionLocation(0).getServerName());
  assertEquals(sn2,list1.getRegionLocation(1).getServerName());
  assertEquals(sn3,list1.getRegionLocation(9).getServerName());
  list1=hrll(hrl(info0,sn0,10),hrl(info1,sn1,10));
  list2=hrll(hrl(info0,sn2,11),hrl(info1,sn2,11),hrl(info9,sn3,11));
  list1=list1.mergeLocations(list2);
  assertEquals(10,list1.size());
  assertEquals(sn2,list1.getRegionLocation(0).getServerName());
  assertEquals(sn2,list1.getRegionLocation(1).getServerName());
  assertEquals(sn3,list1.getRegionLocation(9).getServerName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestSerialization </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet() throws Exception {
  byte[] row="row".getBytes();
  byte[] fam="fam".getBytes();
  byte[] qf1="qf1".getBytes();
  long ts=System.currentTimeMillis();
  int maxVersions=2;
  Get get=new Get(row);
  get.addColumn(fam,qf1);
  get.setTimeRange(ts,ts + 1);
  get.setMaxVersions(maxVersions);
  ClientProtos.Get getProto=ProtobufUtil.toGet(get);
  Get desGet=ProtobufUtil.toGet(getProto);
  assertTrue(Bytes.equals(get.getRow(),desGet.getRow()));
  Set<byte[]> set=null;
  Set<byte[]> desSet=null;
  for (  Map.Entry<byte[],NavigableSet<byte[]>> entry : get.getFamilyMap().entrySet()) {
    assertTrue(desGet.getFamilyMap().containsKey(entry.getKey()));
    set=entry.getValue();
    desSet=desGet.getFamilyMap().get(entry.getKey());
    for (    byte[] qualifier : set) {
      assertTrue(desSet.contains(qualifier));
    }
  }
  assertEquals(get.getMaxVersions(),desGet.getMaxVersions());
  TimeRange tr=get.getTimeRange();
  TimeRange desTr=desGet.getTimeRange();
  assertEquals(tr.getMax(),desTr.getMax());
  assertEquals(tr.getMin(),desTr.getMin());
}

</code></pre>

<br>
<pre class="type-4 type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeyValueInvalidNegativeLength(){
  KeyValue kv_0=new KeyValue(Bytes.toBytes("myRow"),Bytes.toBytes("myCF"),Bytes.toBytes("myQualifier"),12345L,Bytes.toBytes("my12345"));
  KeyValue kv_1=new KeyValue(Bytes.toBytes("myRow"),Bytes.toBytes("myCF"),Bytes.toBytes("myQualifier"),12345L,Bytes.toBytes("my123"));
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  long l=0;
  try {
    l=KeyValue.oswrite(kv_0,dos,false);
    l+=KeyValue.oswrite(kv_1,dos,false);
    assertEquals(100L,l);
  }
 catch (  IOException e) {
    fail("Unexpected IOException" + e.getMessage());
  }
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream dis=new DataInputStream(bais);
  try {
    KeyValueUtil.create(dis);
    assertTrue(kv_0.equals(kv_1));
  }
 catch (  Exception e) {
    fail("Unexpected Exception" + e.getMessage());
  }
  try {
    KeyValueUtil.create(-1,dis);
    fail("Expected corrupt stream");
  }
 catch (  Exception e) {
    assertEquals("Failed read -1 bytes, stream corrupt?",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyValue() throws Exception {
  final String name="testKeyValue2";
  byte[] row=name.getBytes();
  byte[] fam="fam".getBytes();
  byte[] qf="qf".getBytes();
  long ts=System.currentTimeMillis();
  byte[] val="val".getBytes();
  KeyValue kv=new KeyValue(row,fam,qf,ts,val);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  long l=KeyValueUtil.write(kv,dos);
  dos.close();
  byte[] mb=baos.toByteArray();
  ByteArrayInputStream bais=new ByteArrayInputStream(mb);
  DataInputStream dis=new DataInputStream(bais);
  KeyValue deserializedKv=KeyValueUtil.create(dis);
  assertTrue(Bytes.equals(kv.getBuffer(),deserializedKv.getBuffer()));
  assertEquals(kv.getOffset(),deserializedKv.getOffset());
  assertEquals(kv.getLength(),deserializedKv.getLength());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScan() throws Exception {
  byte[] startRow="startRow".getBytes();
  byte[] stopRow="stopRow".getBytes();
  byte[] fam="fam".getBytes();
  byte[] qf1="qf1".getBytes();
  long ts=System.currentTimeMillis();
  int maxVersions=2;
  Scan scan=new Scan(startRow,stopRow);
  scan.addColumn(fam,qf1);
  scan.setTimeRange(ts,ts + 1);
  scan.setMaxVersions(maxVersions);
  ClientProtos.Scan scanProto=ProtobufUtil.toScan(scan);
  Scan desScan=ProtobufUtil.toScan(scanProto);
  assertTrue(Bytes.equals(scan.getStartRow(),desScan.getStartRow()));
  assertTrue(Bytes.equals(scan.getStopRow(),desScan.getStopRow()));
  assertEquals(scan.getCacheBlocks(),desScan.getCacheBlocks());
  Set<byte[]> set=null;
  Set<byte[]> desSet=null;
  for (  Map.Entry<byte[],NavigableSet<byte[]>> entry : scan.getFamilyMap().entrySet()) {
    assertTrue(desScan.getFamilyMap().containsKey(entry.getKey()));
    set=entry.getValue();
    desSet=desScan.getFamilyMap().get(entry.getKey());
    for (    byte[] column : set) {
      assertTrue(desSet.contains(column));
    }
    scan=new Scan(startRow);
    final String name="testScan";
    byte[] prefix=Bytes.toBytes(name);
    scan.setFilter(new PrefixFilter(prefix));
    scanProto=ProtobufUtil.toScan(scan);
    desScan=ProtobufUtil.toScan(scanProto);
    Filter f=desScan.getFilter();
    assertTrue(f instanceof PrefixFilter);
  }
  assertEquals(scan.getMaxVersions(),desScan.getMaxVersions());
  TimeRange tr=scan.getTimeRange();
  TimeRange desTr=desScan.getTimeRange();
  assertEquals(tr.getMax(),desTr.getMax());
  assertEquals(tr.getMin(),desTr.getMin());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestServerName </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostNameCaseSensitivity(){
  ServerName lower=ServerName.valueOf("www.example.org",1234,5678);
  ServerName upper=ServerName.valueOf("www.EXAMPLE.org",1234,5678);
  assertEquals(0,lower.compareTo(upper));
  assertEquals(0,upper.compareTo(lower));
  assertEquals(lower.hashCode(),upper.hashCode());
  assertTrue(lower.equals(upper));
  assertTrue(upper.equals(lower));
  assertTrue(ServerName.isSameHostnameAndPort(lower,upper));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerName(){
  ServerName sn=ServerName.valueOf("www.example.org",1234,5678);
  ServerName sn2=ServerName.valueOf("www.example.org",1234,5678);
  ServerName sn3=ServerName.valueOf("www.example.org",1234,56789);
  assertTrue(sn.equals(sn2));
  assertFalse(sn.equals(sn3));
  assertEquals(sn.hashCode(),sn2.hashCode());
  assertNotSame(sn.hashCode(),sn3.hashCode());
  assertEquals(sn.toString(),ServerName.getServerName("www.example.org",1234,5678));
  assertEquals(sn.toString(),ServerName.getServerName("www.example.org:1234",5678));
  assertEquals(sn.toString(),"www.example.org" + ServerName.SERVERNAME_SEPARATOR + "1234"+ ServerName.SERVERNAME_SEPARATOR+ "5678");
}

</code></pre>

<br>
<pre class="type-7 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getServerStartcodeFromServerName(){
  ServerName sn=ServerName.valueOf("www.example.org",1234,5678);
  assertEquals(5678,ServerName.getServerStartcodeFromServerName(sn.toString()));
  assertNotSame(5677,ServerName.getServerStartcodeFromServerName(sn.toString()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestZooKeeper </h4><pre class="type-11 type-7 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a bunch of znodes in a hierarchy, try deleting one that has childs (it will fail), then
 * delete it recursively, then delete the last znode
 * @throws Exception
 */
@Test public void testZNodeDeletes() throws Exception {
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(new Configuration(TEST_UTIL.getConfiguration()),TestZooKeeper.class.getName(),null);
  ZKUtil.createWithParents(zkw,"/l1/l2/l3/l4");
  try {
    ZKUtil.deleteNode(zkw,"/l1/l2");
    fail("We should not be able to delete if znode has childs");
  }
 catch (  KeeperException ex) {
    assertNotNull(ZKUtil.getDataNoWatch(zkw,"/l1/l2/l3/l4",null));
  }
  ZKUtil.deleteNodeRecursively(zkw,"/l1/l2");
  assertNull(ZKUtil.getDataNoWatch(zkw,"/l1/l2/l3/l4",null));
  ZKUtil.deleteNodeRecursively(zkw,"/l1/l2");
  ZKUtil.deleteNode(zkw,"/l1");
  assertNull(ZKUtil.getDataNoWatch(zkw,"/l1/l2",null));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the master does not call retainAssignment after recovery from expired zookeeper
 * session. Without the HBASE-6046 fix master always tries to assign all the user regions by
 * calling retainAssignment.
 */
@Test(timeout=300000) public void testRegionAssignmentAfterMasterRecoveryDueToZKExpiry() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  cluster.startRegionServer();
  cluster.waitForActiveAndReadyMaster(10000);
  HMaster m=cluster.getMaster();
  final ZooKeeperWatcher zkw=m.getZooKeeper();
  try (Admin admin=TEST_UTIL.getHBaseAdmin()){
    byte[][] SPLIT_KEYS=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c"),Bytes.toBytes("d"),Bytes.toBytes("e"),Bytes.toBytes("f"),Bytes.toBytes("g"),Bytes.toBytes("h"),Bytes.toBytes("i"),Bytes.toBytes("j")};
    String tableName="testRegionAssignmentAfterMasterRecoveryDueToZKExpiry";
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(tableName));
    htd.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
    admin.createTable(htd,SPLIT_KEYS);
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    m.getZooKeeper().close();
    MockLoadBalancer.retainAssignCalled=false;
    final int expectedNumOfListeners=countPermanentListeners(zkw);
    m.abort("Test recovery from zk session expired",new KeeperException.SessionExpiredException());
    assertTrue(m.isStopped());
    assertFalse("Retain assignment should not be called",MockLoadBalancer.retainAssignCalled);
    cluster.waitForActiveAndReadyMaster(120000);
    final HMaster newMaster=cluster.getMasterThread().getMaster();
    assertEquals(expectedNumOfListeners,countPermanentListeners(newMaster.getZooKeeper()));
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests whether the logs are split when master recovers from a expired zookeeper session and an
 * RS goes down.
 */
@Test(timeout=300000) public void testLogSplittingAfterMasterRecoveryDueToZKExpiry() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  cluster.startRegionServer();
  HMaster m=cluster.getMaster();
  Admin admin=TEST_UTIL.getHBaseAdmin();
  Table table=null;
  try {
    byte[][] SPLIT_KEYS=new byte[][]{Bytes.toBytes("1"),Bytes.toBytes("2"),Bytes.toBytes("3"),Bytes.toBytes("4"),Bytes.toBytes("5")};
    String tableName="testLogSplittingAfterMasterRecoveryDueToZKExpiry";
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(tableName));
    HColumnDescriptor hcd=new HColumnDescriptor("col");
    htd.addFamily(hcd);
    admin.createTable(htd,SPLIT_KEYS);
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    table=TEST_UTIL.getConnection().getTable(htd.getTableName());
    Put p;
    int numberOfPuts;
    for (numberOfPuts=0; numberOfPuts < 6; numberOfPuts++) {
      p=new Put(Bytes.toBytes(numberOfPuts));
      p.addColumn(Bytes.toBytes("col"),Bytes.toBytes("ql"),Bytes.toBytes("value" + numberOfPuts));
      table.put(p);
    }
    m.getZooKeeper().close();
    m.abort("Test recovery from zk session expired",new KeeperException.SessionExpiredException());
    assertTrue(m.isStopped());
    cluster.getRegionServer(0).abort("Aborting");
    Scan scan=new Scan();
    int numberOfRows=0;
    ResultScanner scanner=table.getScanner(scan);
    Result[] result=scanner.next(1);
    while (result != null && result.length > 0) {
      numberOfRows++;
      result=scanner.next(1);
    }
    assertEquals("Number of rows should be equal to number of puts.",numberOfPuts,numberOfRows);
  }
  finally {
    if (table != null)     table.close();
    admin.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.backup.TestHFileArchiving </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemovesRegionDirOnArchive() throws Exception {
  TableName TABLE_NAME=TableName.valueOf("testRemovesRegionDirOnArchive");
  UTIL.createTable(TABLE_NAME,TEST_FAM);
  final Admin admin=UTIL.getHBaseAdmin();
  List<HRegion> servingRegions=UTIL.getHBaseCluster().getRegions(TABLE_NAME);
  assertEquals(1,servingRegions.size());
  HRegion region=servingRegions.get(0);
  UTIL.loadRegion(region,TEST_FAM);
  admin.disableTable(TABLE_NAME);
  FileSystem fs=UTIL.getTestFileSystem();
  Path rootDir=region.getRegionFileSystem().getTableDir().getParent();
  Path regionDir=HRegion.getRegionDir(rootDir,region.getRegionInfo());
  HFileArchiver.archiveRegion(UTIL.getConfiguration(),fs,region.getRegionInfo());
  Path archiveDir=HFileArchiveTestingUtil.getRegionArchiveDir(UTIL.getConfiguration(),region);
  assertTrue(fs.exists(archiveDir));
  FileStatus[] stores=fs.listStatus(archiveDir,new PathFilter(){
    @Override public boolean accept(    Path p){
      if (p.getName().contains(HConstants.RECOVERED_EDITS_DIR)) {
        return false;
      }
      return true;
    }
  }
);
  assertTrue(stores.length == 1);
  FileStatus[] storeFiles=fs.listStatus(stores[0].getPath());
  assertTrue(storeFiles.length > 0);
  assertFalse(fs.exists(regionDir));
  UTIL.deleteTable(TABLE_NAME);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the region directory is removed when we archive a region without store files, but
 * still has hidden files.
 * @throws Exception
 */
@Test public void testDeleteRegionWithNoStoreFiles() throws Exception {
  TableName TABLE_NAME=TableName.valueOf("testDeleteRegionWithNoStoreFiles");
  UTIL.createTable(TABLE_NAME,TEST_FAM);
  List<HRegion> servingRegions=UTIL.getHBaseCluster().getRegions(TABLE_NAME);
  assertEquals(1,servingRegions.size());
  HRegion region=servingRegions.get(0);
  FileSystem fs=region.getRegionFileSystem().getFileSystem();
  Path rootDir=FSUtils.getRootDir(fs.getConf());
  Path regionDir=HRegion.getRegionDir(rootDir,region.getRegionInfo());
  FileStatus[] regionFiles=FSUtils.listStatus(fs,regionDir,null);
  Assert.assertNotNull("No files in the region directory",regionFiles);
  if (LOG.isDebugEnabled()) {
    List<Path> files=new ArrayList<Path>();
    for (    FileStatus file : regionFiles) {
      files.add(file.getPath());
    }
    LOG.debug("Current files:" + files);
  }
  final PathFilter dirFilter=new FSUtils.DirFilter(fs);
  PathFilter nonHidden=new PathFilter(){
    @Override public boolean accept(    Path file){
      return dirFilter.accept(file) && !file.getName().toString().startsWith(".");
    }
  }
;
  FileStatus[] storeDirs=FSUtils.listStatus(fs,regionDir,nonHidden);
  for (  FileStatus store : storeDirs) {
    LOG.debug("Deleting store for test");
    fs.delete(store.getPath(),true);
  }
  HFileArchiver.archiveRegion(UTIL.getConfiguration(),fs,region.getRegionInfo());
  assertFalse("Region directory (" + regionDir + "), still exists.",fs.exists(regionDir));
  UTIL.deleteTable(TABLE_NAME);
}

</code></pre>

<br>
<pre class="type-3 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    clearArchiveDirectory();
  }
 catch (  IOException e) {
    Assert.fail("Failure to delete archive directory:" + e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.backup.example.TestZooKeeperTableArchiveClient </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test archiving/cleaning across multiple tables, where some are retained, and others aren't
 * @throws Exception on failure
 */
@Test(timeout=300000) public void testMultipleTables() throws Exception {
  createArchiveDirectory();
  String otherTable="otherTable";
  FileSystem fs=UTIL.getTestFileSystem();
  Path archiveDir=getArchiveDir();
  Path tableDir=getTableDir(STRING_TABLE_NAME);
  Path otherTableDir=getTableDir(otherTable);
  toCleanup.add(archiveDir);
  toCleanup.add(tableDir);
  toCleanup.add(otherTableDir);
  Configuration conf=UTIL.getConfiguration();
  Stoppable stop=new StoppableImplementation();
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  HFileCleaner cleaner=setupAndCreateCleaner(conf,fs,archiveDir,stop);
  List<BaseHFileCleanerDelegate> cleaners=turnOnArchiving(STRING_TABLE_NAME,cleaner);
  final LongTermArchivingHFileCleaner delegate=(LongTermArchivingHFileCleaner)cleaners.get(0);
  HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAM);
  HRegion region=UTIL.createTestRegion(STRING_TABLE_NAME,hcd);
  List<Region> regions=new ArrayList<Region>();
  regions.add(region);
  when(rss.getOnlineRegions()).thenReturn(regions);
  final CompactedHFilesDischarger compactionCleaner=new CompactedHFilesDischarger(100,stop,rss,false);
  loadFlushAndCompact(region,TEST_FAM);
  compactionCleaner.chore();
  hcd=new HColumnDescriptor(TEST_FAM);
  HRegion otherRegion=UTIL.createTestRegion(otherTable,hcd);
  regions=new ArrayList<Region>();
  regions.add(otherRegion);
  when(rss.getOnlineRegions()).thenReturn(regions);
  final CompactedHFilesDischarger compactionCleaner1=new CompactedHFilesDischarger(100,stop,rss,false);
  loadFlushAndCompact(otherRegion,TEST_FAM);
  compactionCleaner1.chore();
  List<Path> files=getAllFiles(fs,archiveDir);
  if (files == null) {
    FSUtils.logFileSystemState(fs,archiveDir,LOG);
    throw new RuntimeException("Didn't load archive any files!");
  }
  int initialCountForPrimary=0;
  int initialCountForOtherTable=0;
  for (  Path file : files) {
    String tableName=file.getParent().getParent().getParent().getName();
    if (tableName.equals(otherTable))     initialCountForOtherTable++;
 else     if (tableName.equals(STRING_TABLE_NAME))     initialCountForPrimary++;
  }
  assertTrue("Didn't archive files for:" + STRING_TABLE_NAME,initialCountForPrimary > 0);
  assertTrue("Didn't archive files for:" + otherTable,initialCountForOtherTable > 0);
  CountDownLatch finished=setupCleanerWatching(delegate,cleaners,files.size() + 3);
  choreService.scheduleChore(cleaner);
  finished.await();
  stop.stop("");
  List<Path> archivedFiles=getAllFiles(fs,archiveDir);
  int archivedForPrimary=0;
  for (  Path file : archivedFiles) {
    String tableName=file.getParent().getParent().getParent().getName();
    assertFalse("Have a file from the non-archived table: " + file,tableName.equals(otherTable));
    if (tableName.equals(STRING_TABLE_NAME))     archivedForPrimary++;
  }
  assertEquals("Not all archived files for the primary table were retained.",initialCountForPrimary,archivedForPrimary);
  assertTrue("Archive directory was deleted via archiver",fs.exists(archiveDir));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testArchivingOnSingleTable() throws Exception {
  createArchiveDirectory();
  FileSystem fs=UTIL.getTestFileSystem();
  Path archiveDir=getArchiveDir();
  Path tableDir=getTableDir(STRING_TABLE_NAME);
  toCleanup.add(archiveDir);
  toCleanup.add(tableDir);
  Configuration conf=UTIL.getConfiguration();
  Stoppable stop=new StoppableImplementation();
  HFileCleaner cleaner=setupAndCreateCleaner(conf,fs,archiveDir,stop);
  List<BaseHFileCleanerDelegate> cleaners=turnOnArchiving(STRING_TABLE_NAME,cleaner);
  final LongTermArchivingHFileCleaner delegate=(LongTermArchivingHFileCleaner)cleaners.get(0);
  HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAM);
  HRegion region=UTIL.createTestRegion(STRING_TABLE_NAME,hcd);
  List<Region> regions=new ArrayList<Region>();
  regions.add(region);
  when(rss.getOnlineRegions()).thenReturn(regions);
  final CompactedHFilesDischarger compactionCleaner=new CompactedHFilesDischarger(100,stop,rss,false);
  loadFlushAndCompact(region,TEST_FAM);
  compactionCleaner.chore();
  List<Path> files=getAllFiles(fs,archiveDir);
  if (files == null) {
    FSUtils.logFileSystemState(fs,UTIL.getDataTestDir(),LOG);
    throw new RuntimeException("Didn't archive any files!");
  }
  CountDownLatch finished=setupCleanerWatching(delegate,cleaners,files.size());
  runCleaner(cleaner,finished,stop);
  List<Path> archivedFiles=getAllFiles(fs,archiveDir);
  assertEquals("Archived files changed after running archive cleaner.",files,archivedFiles);
  assertTrue(fs.exists(HFileArchiveUtil.getArchivePath(UTIL.getConfiguration())));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAdmin1 </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify schema modification takes.
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=300000) public void testOnlineChangeTableSchema() throws IOException, InterruptedException {
  final TableName tableName=TableName.valueOf("changeTableSchemaOnline");
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",true);
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  HTableDescriptor htd=this.admin.getTableDescriptor(tableName);
  HTableDescriptor copy=new HTableDescriptor(htd);
  assertTrue(htd.equals(copy));
  long newFlushSize=htd.getMemStoreFlushSize() / 2;
  if (newFlushSize <= 0) {
    newFlushSize=HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE / 2;
  }
  copy.setMemStoreFlushSize(newFlushSize);
  final String key="anyoldkey";
  assertTrue(htd.getValue(key) == null);
  copy.setValue(key,key);
  boolean expectedException=false;
  try {
    admin.modifyTable(tableName,copy);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  HTableDescriptor modifiedHtd=this.admin.getTableDescriptor(tableName);
  assertFalse(htd.equals(modifiedHtd));
  assertTrue(copy.equals(modifiedHtd));
  assertEquals(newFlushSize,modifiedHtd.getMemStoreFlushSize());
  assertEquals(key,modifiedHtd.getValue(key));
  int countOfFamilies=modifiedHtd.getFamilies().size();
  assertTrue(countOfFamilies > 0);
  HColumnDescriptor hcd=modifiedHtd.getFamilies().iterator().next();
  int maxversions=hcd.getMaxVersions();
  final int newMaxVersions=maxversions + 1;
  hcd.setMaxVersions(newMaxVersions);
  final byte[] hcdName=hcd.getName();
  expectedException=false;
  try {
    this.admin.modifyColumnFamily(tableName,hcd);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  HColumnDescriptor modifiedHcd=modifiedHtd.getFamily(hcdName);
  assertEquals(newMaxVersions,modifiedHcd.getMaxVersions());
  assertFalse(this.admin.isTableDisabled(tableName));
  final String xtracolName="xtracol";
  HColumnDescriptor xtracol=new HColumnDescriptor(xtracolName);
  xtracol.setValue(xtracolName,xtracolName);
  expectedException=false;
  try {
    this.admin.addColumnFamily(tableName,xtracol);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertFalse(expectedException);
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  hcd=modifiedHtd.getFamily(xtracol.getName());
  assertTrue(hcd != null);
  assertTrue(hcd.getValue(xtracolName).equals(xtracolName));
  this.admin.deleteColumnFamily(tableName,xtracol.getName());
  modifiedHtd=this.admin.getTableDescriptor(tableName);
  hcd=modifiedHtd.getFamily(xtracol.getName());
  assertTrue(hcd == null);
  this.admin.disableTable(tableName);
  this.admin.deleteTable(tableName);
  this.admin.listTables();
  assertFalse(this.admin.tableExists(tableName));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCompactionTimestamps() throws Exception {
  HColumnDescriptor fam1=new HColumnDescriptor("fam1");
  TableName tableName=TableName.valueOf("testCompactionTimestampsTable");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(fam1);
  this.admin.createTable(htd);
  Table table=TEST_UTIL.getConnection().getTable(htd.getTableName());
  long ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(Bytes.toBytes("fam1"),Bytes.toBytes("fam1"),Bytes.toBytes("fam1"));
  table.put(p);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(0,ts);
  byte[] regionName;
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regionName=l.getAllRegionLocations().get(0).getRegionInfo().getRegionName();
  }
   long ts1=this.admin.getLastMajorCompactionTimestampForRegion(regionName);
  assertEquals(ts,ts1);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(Bytes.toBytes("fam1"),Bytes.toBytes("fam1"),Bytes.toBytes("fam1"));
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(ts1,ts);
  TEST_UTIL.compact(tableName,true);
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertTrue(ts > ts1);
  ts1=this.admin.getLastMajorCompactionTimestampForRegion(regionName);
  assertEquals(ts,ts1);
  table.put(p);
  this.admin.flush(tableName);
  ts=this.admin.getLastMajorCompactionTimestamp(tableName);
  assertEquals(ts,ts1);
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test retain assignment on enableTable.
 * @throws IOException
 */
@Test(timeout=300000) public void testEnableTableRetainAssignment() throws IOException {
  final TableName tableName=TableName.valueOf("testEnableTableAssignment");
  byte[][] splitKeys={new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{4,4,4},new byte[]{5,5,5},new byte[]{6,6,6},new byte[]{7,7,7},new byte[]{8,8,8},new byte[]{9,9,9}};
  int expectedRegions=splitKeys.length + 1;
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,splitKeys);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    List<HRegionLocation> regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    admin.disableTable(tableName);
    admin.enableTable(tableName);
    List<HRegionLocation> regions2=l.getAllRegionLocations();
    assertEquals(regions.size(),regions2.size());
    assertTrue(regions2.containsAll(regions));
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTable() throws IOException {
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TableName tableName=TableName.valueOf("testCreateTable");
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  assertTrue("Table must be enabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(tableName,TableState.State.ENABLED));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(tableName));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testDisableAndEnableTable() throws IOException {
  final byte[] row=Bytes.toBytes("row");
  final byte[] qualifier=Bytes.toBytes("qualifier");
  final byte[] value=Bytes.toBytes("value");
  final TableName table=TableName.valueOf("testDisableAndEnableTable");
  Table ht=TEST_UTIL.createTable(table,HConstants.CATALOG_FAMILY);
  Put put=new Put(row);
  put.addColumn(HConstants.CATALOG_FAMILY,qualifier,value);
  ht.put(put);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  ht.get(get);
  this.admin.disableTable(ht.getName());
  assertTrue("Table must be disabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),TableState.State.DISABLED));
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table));
  get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  boolean ok=false;
  try {
    ht.get(get);
  }
 catch (  TableNotEnabledException e) {
    ok=true;
  }
  ok=false;
  Scan scan=new Scan();
  try {
    ResultScanner scanner=ht.getScanner(scan);
    Result res=null;
    do {
      res=scanner.next();
    }
 while (res != null);
  }
 catch (  TableNotEnabledException e) {
    ok=true;
  }
  assertTrue(ok);
  this.admin.enableTable(table);
  assertTrue("Table must be enabled.",TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getTableStateManager().isTableState(ht.getName(),TableState.State.ENABLED));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table));
  try {
    ht.get(get);
  }
 catch (  RetriesExhaustedException e) {
    ok=false;
  }
  assertTrue(ok);
  ht.close();
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTableNumberOfRegions() throws IOException, InterruptedException {
  TableName tableName=TableName.valueOf("testCreateTableNumberOfRegions");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc);
  List<HRegionLocation> regions;
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 1 region",1,regions.size());
  }
   TableName TABLE_2=TableName.valueOf(tableName.getNameAsString() + "_2");
  desc=new HTableDescriptor(TABLE_2);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,new byte[][]{new byte[]{42}});
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_2)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 2 region",2,regions.size());
  }
   TableName TABLE_3=TableName.valueOf(tableName.getNameAsString() + "_3");
  desc=new HTableDescriptor(TABLE_3);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,"a".getBytes(),"z".getBytes(),3);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_3)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have only 3 region",3,regions.size());
  }
   TableName TABLE_4=TableName.valueOf(tableName.getNameAsString() + "_4");
  desc=new HTableDescriptor(TABLE_4);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  try {
    admin.createTable(desc,"a".getBytes(),"z".getBytes(),2);
    fail("Should not be able to create a table with only 2 regions using this API.");
  }
 catch (  IllegalArgumentException eae) {
  }
  TableName TABLE_5=TableName.valueOf(tableName.getNameAsString() + "_5");
  desc=new HTableDescriptor(TABLE_5);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,new byte[]{1},new byte[]{127},16);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_5)){
    regions=l.getAllRegionLocations();
    assertEquals("Table should have 16 region",16,regions.size());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testShouldFailOnlineSchemaUpdateIfOnlineSchemaIsNotEnabled() throws Exception {
  final TableName tableName=TableName.valueOf("changeTableSchemaOnlineFailure");
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",false);
  HTableDescriptor[] tables=admin.listTables();
  int numTables=tables.length;
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  tables=this.admin.listTables();
  assertEquals(numTables + 1,tables.length);
  HTableDescriptor htd=this.admin.getTableDescriptor(tableName);
  HTableDescriptor copy=new HTableDescriptor(htd);
  assertTrue(htd.equals(copy));
  long newFlushSize=htd.getMemStoreFlushSize() / 2;
  if (newFlushSize <= 0) {
    newFlushSize=HTableDescriptor.DEFAULT_MEMSTORE_FLUSH_SIZE / 2;
  }
  copy.setMemStoreFlushSize(newFlushSize);
  final String key="anyoldkey";
  assertTrue(htd.getValue(key) == null);
  copy.setValue(key,key);
  boolean expectedException=false;
  try {
    admin.modifyTable(tableName,copy);
  }
 catch (  TableNotDisabledException re) {
    expectedException=true;
  }
  assertTrue("Online schema update should not happen.",expectedException);
  TEST_UTIL.getMiniHBaseCluster().getMaster().getConfiguration().setBoolean("hbase.online.schema.update.enable",true);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testDisableAndEnableTables() throws IOException {
  final byte[] row=Bytes.toBytes("row");
  final byte[] qualifier=Bytes.toBytes("qualifier");
  final byte[] value=Bytes.toBytes("value");
  final TableName table1=TableName.valueOf("testDisableAndEnableTable1");
  final TableName table2=TableName.valueOf("testDisableAndEnableTable2");
  Table ht1=TEST_UTIL.createTable(table1,HConstants.CATALOG_FAMILY);
  Table ht2=TEST_UTIL.createTable(table2,HConstants.CATALOG_FAMILY);
  Put put=new Put(row);
  put.addColumn(HConstants.CATALOG_FAMILY,qualifier,value);
  ht1.put(put);
  ht2.put(put);
  Get get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  ht1.get(get);
  ht2.get(get);
  this.admin.disableTables("testDisableAndEnableTable.*");
  get=new Get(row);
  get.addColumn(HConstants.CATALOG_FAMILY,qualifier);
  boolean ok=false;
  try {
    ht1.get(get);
    ht2.get(get);
  }
 catch (  org.apache.hadoop.hbase.DoNotRetryIOException e) {
    ok=true;
  }
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table1));
  assertEquals(TableState.State.DISABLED,getStateFromMeta(table2));
  assertTrue(ok);
  this.admin.enableTables("testDisableAndEnableTable.*");
  try {
    ht1.get(get);
  }
 catch (  IOException e) {
    ok=false;
  }
  try {
    ht2.get(get);
  }
 catch (  IOException e) {
    ok=false;
  }
  assertTrue(ok);
  ht1.close();
  ht2.close();
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table1));
  assertEquals(TableState.State.ENABLED,getStateFromMeta(table2));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateTableWithRegions() throws IOException, InterruptedException {
  TableName tableName=TableName.valueOf("testCreateTableWithRegions");
  byte[][] splitKeys={new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{4,4,4},new byte[]{5,5,5},new byte[]{6,6,6},new byte[]{7,7,7},new byte[]{8,8,8},new byte[]{9,9,9}};
  int expectedRegions=splitKeys.length + 1;
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,splitKeys);
  boolean tableAvailable=admin.isTableAvailable(tableName,splitKeys);
  assertTrue("Table should be created with splitKyes + 1 rows in META",tableAvailable);
  List<HRegionLocation> regions;
  Iterator<HRegionLocation> hris;
  HRegionInfo hri;
  ClusterConnection conn=(ClusterConnection)TEST_UTIL.getConnection();
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    hris=regions.iterator();
    hri=hris.next().getRegionInfo();
    assertTrue(hri.getStartKey() == null || hri.getStartKey().length == 0);
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[0]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[0]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[1]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[1]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[2]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[2]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[3]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[3]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[4]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[4]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[5]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[5]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[6]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[6]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[7]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[7]));
    assertTrue(Bytes.equals(hri.getEndKey(),splitKeys[8]));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),splitKeys[8]));
    assertTrue(hri.getEndKey() == null || hri.getEndKey().length == 0);
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   byte[] startKey={1,1,1,1,1,1,1,1,1,1};
  byte[] endKey={9,9,9,9,9,9,9,9,9,9};
  expectedRegions=10;
  TableName TABLE_2=TableName.valueOf(tableName.getNameAsString() + "_2");
  desc=new HTableDescriptor(TABLE_2);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(desc,startKey,endKey,expectedRegions);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_2)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    hris=regions.iterator();
    hri=hris.next().getRegionInfo();
    assertTrue(hri.getStartKey() == null || hri.getStartKey().length == 0);
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{1,1,1,1,1,1,1,1,1,1}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{1,1,1,1,1,1,1,1,1,1}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{2,2,2,2,2,2,2,2,2,2}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{2,2,2,2,2,2,2,2,2,2}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{3,3,3,3,3,3,3,3,3,3}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{3,3,3,3,3,3,3,3,3,3}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{4,4,4,4,4,4,4,4,4,4}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{4,4,4,4,4,4,4,4,4,4}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{5,5,5,5,5,5,5,5,5,5}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{5,5,5,5,5,5,5,5,5,5}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{6,6,6,6,6,6,6,6,6,6}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{6,6,6,6,6,6,6,6,6,6}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{7,7,7,7,7,7,7,7,7,7}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{7,7,7,7,7,7,7,7,7,7}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{8,8,8,8,8,8,8,8,8,8}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{8,8,8,8,8,8,8,8,8,8}));
    assertTrue(Bytes.equals(hri.getEndKey(),new byte[]{9,9,9,9,9,9,9,9,9,9}));
    hri=hris.next().getRegionInfo();
    assertTrue(Bytes.equals(hri.getStartKey(),new byte[]{9,9,9,9,9,9,9,9,9,9}));
    assertTrue(hri.getEndKey() == null || hri.getEndKey().length == 0);
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   startKey=new byte[]{0,0,0,0,0,0};
  endKey=new byte[]{1,0,0,0,0,0};
  expectedRegions=5;
  TableName TABLE_3=TableName.valueOf(tableName.getNameAsString() + "_3");
  desc=new HTableDescriptor(TABLE_3);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(desc,startKey,endKey,expectedRegions);
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE_3)){
    regions=l.getAllRegionLocations();
    assertEquals("Tried to create " + expectedRegions + " regions "+ "but only found "+ regions.size(),expectedRegions,regions.size());
    System.err.println("Found " + regions.size() + " regions");
    verifyRoundRobinDistribution(conn,l,expectedRegions);
  }
   splitKeys=new byte[][]{new byte[]{1,1,1},new byte[]{2,2,2},new byte[]{3,3,3},new byte[]{2,2,2}};
  TableName TABLE_4=TableName.valueOf(tableName.getNameAsString() + "_4");
  desc=new HTableDescriptor(TABLE_4);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  try {
    admin.createTable(desc,splitKeys);
    assertTrue("Should not be able to create this table because of " + "duplicate split keys",false);
  }
 catch (  IllegalArgumentException iae) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAdmin2 </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testMoveToPreviouslyAssignedRS() throws IOException, InterruptedException {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  TableName tableName=TableName.valueOf("testMoveToPreviouslyAssignedRS");
  Admin localAdmin=createTable(tableName);
  List<HRegionInfo> tableRegions=localAdmin.getTableRegions(tableName);
  HRegionInfo hri=tableRegions.get(0);
  AssignmentManager am=master.getAssignmentManager();
  assertTrue("Region " + hri.getRegionNameAsString() + " should be assigned properly",am.waitForAssignment(hri));
  ServerName server=am.getRegionStates().getRegionServerOfRegion(hri);
  localAdmin.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(server.getServerName()));
  assertEquals("Current region server and region server before move should be same.",server,am.getRegionStates().getRegionServerOfRegion(hri));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testCreateBadTables() throws IOException {
  String msg=null;
  try {
    this.admin.createTable(new HTableDescriptor(TableName.META_TABLE_NAME));
  }
 catch (  TableExistsException e) {
    msg=e.toString();
  }
  assertTrue("Unexcepted exception message " + msg,msg != null && msg.startsWith(TableExistsException.class.getName()) && msg.contains(TableName.META_TABLE_NAME.getNameAsString()));
  final HTableDescriptor threadDesc=new HTableDescriptor(TableName.valueOf("threaded_testCreateBadTables"));
  threadDesc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  int count=10;
  Thread[] threads=new Thread[count];
  final AtomicInteger successes=new AtomicInteger(0);
  final AtomicInteger failures=new AtomicInteger(0);
  final Admin localAdmin=this.admin;
  for (int i=0; i < count; i++) {
    threads[i]=new Thread(Integer.toString(i)){
      @Override public void run(){
        try {
          localAdmin.createTable(threadDesc);
          successes.incrementAndGet();
        }
 catch (        TableExistsException e) {
          failures.incrementAndGet();
        }
catch (        IOException e) {
          throw new RuntimeException("Failed threaded create" + getName(),e);
        }
      }
    }
;
  }
  for (int i=0; i < count; i++) {
    threads[i].start();
  }
  for (int i=0; i < count; i++) {
    while (threads[i].isAlive()) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
      }
    }
  }
  assertEquals(1,successes.get());
  assertEquals(count - 1,failures.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAsyncProcess </h4><pre class="type-11 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallQueueTooLarge() throws IOException {
  ClusterConnection conn=new MyConnectionImpl(conf);
  BufferedMutatorImpl mutator=(BufferedMutatorImpl)conn.getBufferedMutator(DUMMY_TABLE);
  AsyncProcessWithFailure ap=new AsyncProcessWithFailure(conn,conf,new CallQueueTooBigException());
  mutator.ap=ap;
  Assert.assertNotNull(mutator.ap.createServerErrorTracker());
  Put p=createPut(1,true);
  mutator.mutate(p);
  try {
    mutator.flush();
    Assert.fail();
  }
 catch (  RetriesExhaustedWithDetailsException expected) {
  }
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxTask() throws Exception {
  final AsyncProcess ap=new MyAsyncProcess(createHConnection(),conf,false);
  for (int i=0; i < 1000; i++) {
    ap.incTaskCounters(Arrays.asList("dummy".getBytes()),sn);
  }
  final Thread myThread=Thread.currentThread();
  Thread t=new Thread(){
    @Override public void run(){
      Threads.sleep(2000);
      myThread.interrupt();
    }
  }
;
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(1,true));
  t.start();
  try {
    ap.submit(DUMMY_TABLE,puts,false,null,false);
    Assert.fail("We should have been interrupted.");
  }
 catch (  InterruptedIOException expected) {
  }
  final long sleepTime=2000;
  Thread t2=new Thread(){
    @Override public void run(){
      Threads.sleep(sleepTime);
      while (ap.tasksInProgress.get() > 0) {
        ap.decTaskCounters(Arrays.asList("dummy".getBytes()),sn);
      }
    }
  }
;
  t2.start();
  long start=System.currentTimeMillis();
  ap.submit(DUMMY_TABLE,new ArrayList<Row>(),false,null,false);
  long end=System.currentTimeMillis();
  Assert.assertTrue(start + 100L + sleepTime > end);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFail() throws Exception {
  MyAsyncProcess ap=new MyAsyncProcess(createHConnection(),conf,false);
  List<Put> puts=new ArrayList<Put>();
  Put p=createPut(1,false);
  puts.add(p);
  AsyncRequestFuture ars=ap.submit(DUMMY_TABLE,puts,false,null,true);
  Assert.assertEquals(0,puts.size());
  ars.waitUntilDone();
  verifyResult(ars,false);
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
  Assert.assertEquals(1,ars.getErrors().exceptions.size());
  Assert.assertTrue("was: " + ars.getErrors().exceptions.get(0),failure.equals(ars.getErrors().exceptions.get(0)));
  Assert.assertTrue("was: " + ars.getErrors().exceptions.get(0),failure.equals(ars.getErrors().exceptions.get(0)));
  Assert.assertEquals(1,ars.getFailedOperations().size());
  Assert.assertTrue("was: " + ars.getFailedOperations().get(0),p.equals(ars.getFailedOperations().get(0)));
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitWithCB() throws Exception {
  ClusterConnection hc=createHConnection();
  final AtomicInteger updateCalled=new AtomicInteger(0);
  Batch.Callback cb=new Batch.Callback(){
    @Override public void update(    byte[] region,    byte[] row,    Object result){
      updateCalled.incrementAndGet();
    }
  }
;
  AsyncProcess ap=new MyAsyncProcess(hc,conf);
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(1,true));
  final AsyncRequestFuture ars=ap.submit(DUMMY_TABLE,puts,false,cb,false);
  Assert.assertTrue(puts.isEmpty());
  ars.waitUntilDone();
  Assert.assertEquals(updateCalled.get(),1);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatch() throws IOException, InterruptedException {
  ClusterConnection conn=new MyConnectionImpl(conf);
  HTable ht=new HTable(conn,new BufferedMutatorParams(DUMMY_TABLE));
  ht.multiAp=new MyAsyncProcess(conn,conf,false);
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,false));
  puts.add(createPut(1,true));
  puts.add(createPut(1,false));
  Object[] res=new Object[puts.size()];
  try {
    ht.processBatch(puts,res);
    Assert.fail();
  }
 catch (  RetriesExhaustedException expected) {
  }
  Assert.assertEquals(res[0],success);
  Assert.assertEquals(res[1],success);
  Assert.assertEquals(res[2],success);
  Assert.assertEquals(res[3],success);
  Assert.assertEquals(res[4],failure);
  Assert.assertEquals(res[5],success);
  Assert.assertEquals(res[6],failure);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorsServers() throws IOException {
  Configuration configuration=new Configuration(conf);
  ClusterConnection conn=new MyConnectionImpl(configuration);
  BufferedMutatorImpl mutator=new BufferedMutatorImpl(conn,null,null,new BufferedMutatorParams(DUMMY_TABLE));
  configuration.setBoolean(ConnectionImplementation.RETRIES_BY_SERVER_KEY,true);
  MyAsyncProcess ap=new MyAsyncProcess(conn,configuration,true);
  mutator.ap=ap;
  Assert.assertNotNull(mutator.ap.createServerErrorTracker());
  Assert.assertTrue(mutator.ap.serverTrackerTimeout > 200);
  mutator.ap.serverTrackerTimeout=1;
  Put p=createPut(1,false);
  mutator.mutate(p);
  try {
    mutator.flush();
    Assert.fail();
  }
 catch (  RetriesExhaustedWithDetailsException expected) {
  }
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitBusyRegionServer() throws Exception {
  ClusterConnection hc=createHConnection();
  AsyncProcess ap=new MyAsyncProcess(hc,conf);
  ap.taskCounterPerServer.put(sn2,new AtomicInteger(ap.maxConcurrentTasksPerServer));
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(1,true));
  puts.add(createPut(3,true));
  puts.add(createPut(1,true));
  puts.add(createPut(2,true));
  ap.submit(DUMMY_TABLE,puts,false,null,false);
  Assert.assertEquals(" puts=" + puts,1,puts.size());
  ap.taskCounterPerServer.put(sn2,new AtomicInteger(ap.maxConcurrentTasksPerServer - 1));
  ap.submit(DUMMY_TABLE,puts,false,null,false);
  Assert.assertTrue(puts.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailAndSuccess() throws Exception {
  MyAsyncProcess ap=new MyAsyncProcess(createHConnection(),conf,false);
  List<Put> puts=new ArrayList<Put>();
  puts.add(createPut(1,false));
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  AsyncRequestFuture ars=ap.submit(DUMMY_TABLE,puts,false,null,true);
  Assert.assertTrue(puts.isEmpty());
  ars.waitUntilDone();
  verifyResult(ars,false,true,true);
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
  ap.callsCt.set(0);
  Assert.assertEquals(1,ars.getErrors().actions.size());
  puts.add(createPut(1,true));
  ap.waitUntilDone();
  ars=ap.submit(DUMMY_TABLE,puts,false,null,true);
  Assert.assertEquals(0,puts.size());
  ars.waitUntilDone();
  Assert.assertEquals(1,ap.callsCt.get());
  verifyResult(ars,true);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalErrors() throws IOException {
  ClusterConnection conn=new MyConnectionImpl(conf);
  BufferedMutatorImpl mutator=(BufferedMutatorImpl)conn.getBufferedMutator(DUMMY_TABLE);
  AsyncProcessWithFailure ap=new AsyncProcessWithFailure(conn,conf,new IOException("test"));
  mutator.ap=ap;
  Assert.assertNotNull(mutator.ap.createServerErrorTracker());
  Put p=createPut(1,true);
  mutator.mutate(p);
  try {
    mutator.flush();
    Assert.fail();
  }
 catch (  RetriesExhaustedWithDetailsException expected) {
  }
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableFailedPutAndNewPut() throws Exception {
  ClusterConnection conn=createHConnection();
  BufferedMutatorImpl mutator=new BufferedMutatorImpl(conn,null,null,new BufferedMutatorParams(DUMMY_TABLE).writeBufferSize(0));
  MyAsyncProcess ap=new MyAsyncProcess(conn,conf,true);
  mutator.ap=ap;
  Put p=createPut(1,false);
  mutator.mutate(p);
  ap.waitUntilDone();
  p=createPut(1,true);
  Assert.assertEquals(0,mutator.writeAsyncBuffer.size());
  try {
    mutator.mutate(p);
    Assert.fail();
  }
 catch (  RetriesExhaustedException expected) {
  }
  Assert.assertEquals("the put should not been inserted.",0,mutator.writeAsyncBuffer.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAttributes </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAttributes(){
  Delete del=new Delete(new byte[]{'r'});
  Assert.assertTrue(del.getAttributesMap().isEmpty());
  Assert.assertNull(del.getAttribute("absent"));
  del.setAttribute("absent",null);
  Assert.assertTrue(del.getAttributesMap().isEmpty());
  Assert.assertNull(del.getAttribute("absent"));
  del.setAttribute("attribute1",Bytes.toBytes("value1"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),del.getAttribute("attribute1")));
  Assert.assertEquals(1,del.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),del.getAttributesMap().get("attribute1")));
  del.setAttribute("attribute1",Bytes.toBytes("value12"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),del.getAttribute("attribute1")));
  Assert.assertEquals(1,del.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),del.getAttributesMap().get("attribute1")));
  del.setAttribute("attribute2",Bytes.toBytes("value2"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),del.getAttribute("attribute2")));
  Assert.assertEquals(2,del.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),del.getAttributesMap().get("attribute2")));
  del.setAttribute("attribute2",null);
  Assert.assertNull(del.getAttribute("attribute2"));
  Assert.assertEquals(1,del.getAttributesMap().size());
  Assert.assertNull(del.getAttributesMap().get("attribute2"));
  del.setAttribute("attribute2",null);
  Assert.assertNull(del.getAttribute("attribute2"));
  Assert.assertEquals(1,del.getAttributesMap().size());
  Assert.assertNull(del.getAttributesMap().get("attribute2"));
  del.setAttribute("attribute1",null);
  Assert.assertNull(del.getAttribute("attribute1"));
  Assert.assertTrue(del.getAttributesMap().isEmpty());
  Assert.assertNull(del.getAttributesMap().get("attribute1"));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanId(){
  Scan scan=new Scan();
  Assert.assertNull("Make sure id is null if unset",scan.toMap().get("id"));
  scan.setId("myId");
  Assert.assertEquals("myId",scan.toMap().get("id"));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutId(){
  Put put=new Put(ROW);
  Assert.assertNull("Make sure id is null if unset",put.toMap().get("id"));
  put.setId("myId");
  Assert.assertEquals("myId",put.toMap().get("id"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutAttributes(){
  Put put=new Put(ROW);
  Assert.assertTrue(put.getAttributesMap().isEmpty());
  Assert.assertNull(put.getAttribute("absent"));
  put.setAttribute("absent",null);
  Assert.assertTrue(put.getAttributesMap().isEmpty());
  Assert.assertNull(put.getAttribute("absent"));
  put.setAttribute("attribute1",Bytes.toBytes("value1"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),put.getAttribute("attribute1")));
  Assert.assertEquals(1,put.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),put.getAttributesMap().get("attribute1")));
  put.setAttribute("attribute1",Bytes.toBytes("value12"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),put.getAttribute("attribute1")));
  Assert.assertEquals(1,put.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),put.getAttributesMap().get("attribute1")));
  put.setAttribute("attribute2",Bytes.toBytes("value2"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),put.getAttribute("attribute2")));
  Assert.assertEquals(2,put.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),put.getAttributesMap().get("attribute2")));
  put.setAttribute("attribute2",null);
  Assert.assertNull(put.getAttribute("attribute2"));
  Assert.assertEquals(1,put.getAttributesMap().size());
  Assert.assertNull(put.getAttributesMap().get("attribute2"));
  put.setAttribute("attribute2",null);
  Assert.assertNull(put.getAttribute("attribute2"));
  Assert.assertEquals(1,put.getAttributesMap().size());
  Assert.assertNull(put.getAttributesMap().get("attribute2"));
  put.setAttribute("attribute1",null);
  Assert.assertNull(put.getAttribute("attribute1"));
  Assert.assertTrue(put.getAttributesMap().isEmpty());
  Assert.assertNull(put.getAttributesMap().get("attribute1"));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetId(){
  Get get=new Get(ROW);
  Assert.assertNull("Make sure id is null if unset",get.toMap().get("id"));
  get.setId("myId");
  Assert.assertEquals("myId",get.toMap().get("id"));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteId(){
  Delete delete=new Delete(ROW);
  Assert.assertNull("Make sure id is null if unset",delete.toMap().get("id"));
  delete.setId("myId");
  Assert.assertEquals("myId",delete.toMap().get("id"));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendId(){
  Append append=new Append(ROW);
  Assert.assertNull("Make sure id is null if unset",append.toMap().get("id"));
  append.setId("myId");
  Assert.assertEquals("myId",append.toMap().get("id"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestBlockEvictionFromClient </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiGets() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(2);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testMultiGets");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    MultiGetThread[] getThreads=initiateMultiGet(table);
    Thread.sleep(200);
    int refCount;
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean foundNonZeroBlock=false;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        foundNonZeroBlock=true;
      }
    }
    assertTrue("Should have found nonzero ref count block",foundNonZeroBlock);
    CustomInnerRegionObserver.getCdl().get().countDown();
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    MultiGetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    iterateBlockCache(cache,iterator);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockEvictionAfterHBASE13082WithCompactionAndFlush() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    compactionLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testBlockEvictionAfterHBASE13082WithCompactionAndFlush");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserverWrapper.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    region.flush(true);
    int refCount=0;
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    byte[] data2=Bytes.add(data,data);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    System.out.println("Flushing cache");
    region.flush(true);
    Iterator<CachedBlock> iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    ScanThread[] scanThreads=initiateScan(table,false);
    Thread.sleep(100);
    iterator=cache.iterator();
    boolean usedBlocksFound=false;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    data2=Bytes.add(data,data);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    System.out.println("Flushing cache");
    region.flush(true);
    assertTrue("Blocks with non zero ref count should be found ",usedBlocksFound);
    usedBlocksFound=false;
    System.out.println("Compacting");
    assertEquals(3,store.getStorefilesCount());
    store.triggerMajorCompaction();
    region.compact(true);
    waitForStoreFileCount(store,1,10000);
    assertEquals(1,store.getStorefilesCount());
    iterator=cache.iterator();
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue("Blocks with non zero ref count should be found ",usedBlocksFound);
    compactionLatch.countDown();
    latch.countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    Result r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetsWithMultiColumnsAndExplicitTracker() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testGetsWithMultiColumnsAndExplicitTracker");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(FAMILY,Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    GetThread[] getThreads=initiateGet(table,true,false);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(10,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockEvictionWithParallelScans() throws Exception {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testBlockEvictionWithParallelScans");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    System.out.println("Flushing cache in problematic area");
    region.flush(true);
    ScanThread[] scanThreads=initiateScan(table,false);
    Thread.sleep(100);
    checkForBlockEviction(cache,false,false,false);
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    Iterator<CachedBlock> iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    byte[] data2=Bytes.add(data,data);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    Result r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    System.out.println("Flushing cache");
    region.flush(true);
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    System.out.println("Compacting");
    assertEquals(2,store.getStorefilesCount());
    store.triggerMajorCompaction();
    region.compact(true);
    waitForStoreFileCount(store,1,10000);
    assertEquals(1,store.getStorefilesCount());
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
    r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithMultipleColumnFamilies() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testScanWithMultipleColumnFamilies");
    byte[][] fams=new byte[10][];
    fams[0]=FAMILY;
    for (int i=1; i < 10; i++) {
      fams[i]=(Bytes.toBytes("testFamily" + i));
    }
    table=TEST_UTIL.createTable(tableName,fams,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(Bytes.toBytes("testFamily" + i),Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    ScanThread[] scanThreads=initiateScan(table,true);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(12,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    checkForBlockEviction(cache,true,false,false);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetWithMultipleColumnFamilies() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testGetWithMultipleColumnFamilies");
    byte[][] fams=new byte[10][];
    fams[0]=FAMILY;
    for (int i=1; i < 10; i++) {
      fams[i]=(Bytes.toBytes("testFamily" + i));
    }
    table=TEST_UTIL.createTable(tableName,fams,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    BlockCache cache=setCacheProperties(region);
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    for (int i=1; i < 10; i++) {
      put=new Put(ROW);
      put.addColumn(Bytes.toBytes("testFamily" + i),Bytes.toBytes("testQualifier" + i),data2);
      table.put(put);
      if (i % 2 == 0) {
        region.flush(true);
      }
    }
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    GetThread[] getThreads=initiateGet(table,true,true);
    Thread.sleep(200);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    int noOfBlocksWithRef=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        System.out.println("The refCount is " + refCount);
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
        noOfBlocksWithRef++;
      }
    }
    assertTrue(usedBlocksFound);
    assertEquals(3,noOfBlocksWithRef);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithException() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    exceptionLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testScanWithException");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserverWrapper.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    insertData(table);
    System.out.println("Flushing cache");
    region.flush(true);
    CustomInnerRegionObserver.throwException.set(true);
    ScanThread[] scanThreads=initiateScan(table,false);
    Thread.sleep(100);
    Iterator<CachedBlock> iterator=cache.iterator();
    boolean usedBlocksFound=false;
    int refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue(usedBlocksFound);
    exceptionLatch.countDown();
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    iterator=cache.iterator();
    usedBlocksFound=false;
    refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      if (refCount != 0) {
        assertEquals(NO_OF_THREADS,refCount);
        usedBlocksFound=true;
      }
    }
    assertTrue(usedBlocksFound);
    Thread.sleep(5100);
    iterator=cache.iterator();
    refCount=0;
    while (iterator.hasNext()) {
      CachedBlock next=iterator.next();
      BlockCacheKey cacheKey=new BlockCacheKey(next.getFilename(),next.getOffset());
      if (cache instanceof BucketCache) {
        refCount=((BucketCache)cache).getRefCount(cacheKey);
      }
 else       if (cache instanceof CombinedBlockCache) {
        refCount=((CombinedBlockCache)cache).getRefCount(cacheKey);
      }
 else {
        continue;
      }
      assertEquals(0,refCount);
    }
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestCheckAndMutate </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndMutate() throws Exception {
  final TableName tableName=TableName.valueOf("TestPutWithDelete");
  final byte[] rowKey=Bytes.toBytes("12345");
  final byte[] family=Bytes.toBytes("cf");
  Table table=TEST_UTIL.createTable(tableName,family);
  TEST_UTIL.waitTableAvailable(tableName.getName(),5000);
  try {
    Put put=new Put(rowKey);
    put.addColumn(family,Bytes.toBytes("A"),Bytes.toBytes("a"));
    put.addColumn(family,Bytes.toBytes("B"),Bytes.toBytes("b"));
    put.addColumn(family,Bytes.toBytes("C"),Bytes.toBytes("c"));
    table.put(put);
    Get get=new Get(rowKey);
    Result result=table.get(get);
    assertTrue("Column A value should be a",Bytes.toString(result.getValue(family,Bytes.toBytes("A"))).equals("a"));
    assertTrue("Column B value should be b",Bytes.toString(result.getValue(family,Bytes.toBytes("B"))).equals("b"));
    assertTrue("Column C value should be c",Bytes.toString(result.getValue(family,Bytes.toBytes("C"))).equals("c"));
    RowMutations rm=new RowMutations(rowKey);
    put=new Put(rowKey);
    put.addColumn(family,Bytes.toBytes("A"),Bytes.toBytes("a"));
    put.addColumn(family,Bytes.toBytes("B"),Bytes.toBytes("b"));
    rm.add(put);
    Delete del=new Delete(rowKey);
    del.addColumn(family,Bytes.toBytes("C"));
    rm.add(del);
    boolean res=table.checkAndMutate(rowKey,family,Bytes.toBytes("A"),CompareFilter.CompareOp.EQUAL,Bytes.toBytes("a"),rm);
    assertTrue(res);
    get=new Get(rowKey);
    result=table.get(get);
    assertTrue("Column A value should be a",Bytes.toString(result.getValue(family,Bytes.toBytes("A"))).equals("a"));
    assertTrue("Column B value should be b",Bytes.toString(result.getValue(family,Bytes.toBytes("B"))).equals("b"));
    assertTrue("Column C should not exist",result.getValue(family,Bytes.toBytes("C")) == null);
    try {
      Put p=new Put(rowKey);
      byte[] value=new byte[0];
      p.addColumn(new byte[]{'b','o','g','u','s'},new byte[]{'A'},value);
      rm=new RowMutations(rowKey);
      rm.add(p);
      table.checkAndMutate(rowKey,family,Bytes.toBytes("A"),CompareFilter.CompareOp.EQUAL,Bytes.toBytes("a"),rm);
      fail("Expected NoSuchColumnFamilyException");
    }
 catch (    NoSuchColumnFamilyException e) {
    }
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientExponentialBackoff </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxLoad(){
  Configuration conf=new Configuration(false);
  ExponentialClientBackoffPolicy backoff=new ExponentialClientBackoffPolicy(conf);
  ServerStatistics stats=new ServerStatistics();
  update(stats,100);
  assertEquals(ExponentialClientBackoffPolicy.DEFAULT_MAX_BACKOFF,backoff.getBackoffTime(server,regionname,stats));
  long max=100;
  conf.setLong(ExponentialClientBackoffPolicy.MAX_BACKOFF_KEY,max);
  ExponentialClientBackoffPolicy backoffShortTimeout=new ExponentialClientBackoffPolicy(conf);
  assertEquals(max,backoffShortTimeout.getBackoffTime(server,regionname,stats));
  update(stats,101);
  assertEquals(ExponentialClientBackoffPolicy.DEFAULT_MAX_BACKOFF,backoff.getBackoffTime(server,regionname,stats));
  assertEquals(max,backoffShortTimeout.getBackoffTime(server,regionname,stats));
  update(stats,99);
  assertTrue(backoff.getBackoffTime(server,regionname,stats) < ExponentialClientBackoffPolicy.DEFAULT_MAX_BACKOFF);
  assertTrue(backoffShortTimeout.getBackoffTime(server,regionname,stats) < max);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeapOccupancyPolicy(){
  Configuration conf=new Configuration(false);
  ExponentialClientBackoffPolicy backoff=new ExponentialClientBackoffPolicy(conf);
  ServerStatistics stats=new ServerStatistics();
  long backoffTime;
  update(stats,0,95,0);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertTrue("Heap occupancy at low watermark had no effect",backoffTime > 0);
  long previous=backoffTime;
  update(stats,0,96,0);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertTrue("Increase above low watermark should have increased backoff",backoffTime > previous);
  update(stats,0,98,0);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertEquals("We should be using max backoff when at high watermark",backoffTime,ExponentialClientBackoffPolicy.DEFAULT_MAX_BACKOFF);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionPressurePolicy(){
  Configuration conf=new Configuration(false);
  ExponentialClientBackoffPolicy backoff=new ExponentialClientBackoffPolicy(conf);
  ServerStatistics stats=new ServerStatistics();
  long backoffTime;
  update(stats,0,0,0);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertTrue("Compaction pressure has no effect",backoffTime == 0);
  long previous=backoffTime;
  update(stats,0,0,50);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertTrue("Compaction pressure should be bigger",backoffTime > previous);
  update(stats,0,0,100);
  backoffTime=backoff.getBackoffTime(server,regionname,stats);
  assertEquals("under heavy compaction pressure",backoffTime,ExponentialClientBackoffPolicy.DEFAULT_MAX_BACKOFF);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientNoCluster </h4><pre class="type-11 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Remove the @Ignore to try out timeout and retry asettings
 * @throws IOException
 */
@Ignore @Test public void testTimeoutAndRetries() throws IOException {
  Configuration localConfig=HBaseConfiguration.create(this.conf);
  localConfig.set("hbase.client.connection.impl",RpcTimeoutConnection.class.getName());
  Connection connection=ConnectionFactory.createConnection(localConfig);
  Table table=connection.getTable(TableName.META_TABLE_NAME);
  Throwable t=null;
  LOG.info("Start");
  try {
    table.exists(new Get(Bytes.toBytes("abc")));
  }
 catch (  SocketTimeoutException e) {
    LOG.info("Got expected exception",e);
    t=e;
  }
catch (  RetriesExhaustedException e) {
    fail();
  }
 finally {
    table.close();
  }
  connection.close();
  LOG.info("Stop");
  assertTrue(t != null);
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that operation timeout prevails over rpc default timeout and retries, etc.
 * @throws IOException
 */
@Test public void testRpcTimeout() throws IOException {
  Configuration localConfig=HBaseConfiguration.create(this.conf);
  localConfig.set("hbase.client.connection.impl",RpcTimeoutConnection.class.getName());
  int pause=10;
  localConfig.setInt("hbase.client.pause",pause);
  localConfig.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,10);
  localConfig.setInt(HConstants.HBASE_CLIENT_META_OPERATION_TIMEOUT,pause - 1);
  Connection connection=ConnectionFactory.createConnection(localConfig);
  Table table=connection.getTable(TableName.META_TABLE_NAME);
  Throwable t=null;
  try {
    table.exists(new Get(Bytes.toBytes("abc")));
  }
 catch (  SocketTimeoutException e) {
    LOG.info("Got expected exception",e);
    t=e;
  }
catch (  RetriesExhaustedException e) {
    fail();
  }
 finally {
    table.close();
    connection.close();
  }
  assertTrue(t != null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientPushback </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testClientTracksServerPushback() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  ClusterConnection conn=(ClusterConnection)ConnectionFactory.createConnection(conf);
  HTable table=(HTable)conn.getTable(tableName);
  HRegionServer rs=UTIL.getHBaseCluster().getRegionServer(0);
  Region region=rs.getOnlineRegions(tableName).get(0);
  LOG.debug("Writing some data to " + tableName);
  Put p=new Put(Bytes.toBytes("row"));
  p.addColumn(family,qualifier,Bytes.toBytes("value1"));
  table.put(p);
  int load=(int)((((HRegion)region).addAndGetGlobalMemstoreSize(0) * 100) / flushSizeBytes);
  LOG.debug("Done writing some data to " + tableName);
  ClientBackoffPolicy backoffPolicy=conn.getBackoffPolicy();
  assertTrue("Backoff policy is not correctly configured",backoffPolicy instanceof ExponentialClientBackoffPolicy);
  ServerStatisticTracker stats=conn.getStatisticsTracker();
  assertNotNull("No stats configured for the client!",stats);
  ServerName server=rs.getServerName();
  byte[] regionName=region.getRegionInfo().getRegionName();
  ServerStatistics serverStats=stats.getServerStatsForTesting(server);
  ServerStatistics.RegionStatistics regionStats=serverStats.getStatsForRegion(regionName);
  assertEquals("We did not find some load on the memstore",load,regionStats.getMemstoreLoadPercent());
  long backoffTime=backoffPolicy.getBackoffTime(server,regionName,serverStats);
  assertNotEquals("Reported load does not produce a backoff",backoffTime,0);
  LOG.debug("Backoff calculated for " + region.getRegionInfo().getRegionNameAsString() + " @ "+ server+ " is "+ backoffTime);
  List<Row> ops=new ArrayList<Row>(1);
  ops.add(p);
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicLong endTime=new AtomicLong();
  long startTime=EnvironmentEdgeManager.currentTime();
  table.mutator.ap.submit(tableName,ops,true,new Batch.Callback<Result>(){
    @Override public void update(    byte[] region,    byte[] row,    Result result){
      endTime.set(EnvironmentEdgeManager.currentTime());
      latch.countDown();
    }
  }
,true);
  String name=server.getServerName() + "," + Bytes.toStringBinary(regionName);
  MetricsConnection.RegionStats rsStats=conn.getConnectionMetrics().serverStats.get(server).get(regionName);
  assertEquals(name,rsStats.name);
  assertEquals(rsStats.heapOccupancyHist.getSnapshot().getMean(),(double)regionStats.getHeapOccupancyPercent(),0.1);
  assertEquals(rsStats.memstoreLoadHist.getSnapshot().getMean(),(double)regionStats.getMemstoreLoadPercent(),0.1);
  MetricsConnection.RunnerStats runnerStats=conn.getConnectionMetrics().runnerStats;
  assertEquals(runnerStats.delayRunners.getCount(),1);
  assertEquals(runnerStats.normalRunners.getCount(),1);
  assertEquals("",runnerStats.delayIntevalHist.getSnapshot().getMean(),(double)backoffTime,0.1);
  latch.await(backoffTime * 2,TimeUnit.MILLISECONDS);
  assertNotEquals("AsyncProcess did not submit the work time",endTime.get(),0);
  assertTrue("AsyncProcess did not delay long enough",endTime.get() - startTime >= backoffTime);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientScanner </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSizeLimit() throws IOException {
  final Result[] results=new Result[1];
  KeyValue kv1=new KeyValue("row".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  results[0]=Result.create(new Cell[]{kv1});
  RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  Mockito.when(caller.callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt())).thenAnswer(new Answer<Result[]>(){
    private int count=0;
    @Override public Result[] answer(    InvocationOnMock invocation) throws Throwable {
      ScannerCallableWithReplicas callable=invocation.getArgumentAt(0,ScannerCallableWithReplicas.class);
switch (count) {
case 0:
case 2:
        count++;
      return null;
case 1:
    count++;
  callable.setHasMoreResultsContext(true);
callable.setServerHasMoreResults(false);
return results;
default :
throw new RuntimeException("Expected only 2 invocations");
}
}
}
);
Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
scan.setCaching(100);
scan.setMaxResultSize(1);
try (MockClientScanner scanner=new MockClientScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
Mockito.verify(caller).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
InOrder inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(2)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
assertEquals(1,scanner.cache.size());
Result r=scanner.cache.poll();
assertNotNull(r);
CellScanner cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv1,cs.current());
assertFalse(cs.advance());
}
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCacheLimit() throws IOException {
  KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  final Result[] results=new Result[]{Result.create(new Cell[]{kv1}),Result.create(new Cell[]{kv2}),Result.create(new Cell[]{kv3})};
  RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  Mockito.when(caller.callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt())).thenAnswer(new Answer<Result[]>(){
    private int count=0;
    @Override public Result[] answer(    InvocationOnMock invocation) throws Throwable {
      ScannerCallableWithReplicas callable=invocation.getArgumentAt(0,ScannerCallableWithReplicas.class);
switch (count) {
case 0:
case 2:
        count++;
      return null;
case 1:
    count++;
  callable.setHasMoreResultsContext(true);
callable.setServerHasMoreResults(false);
return results;
default :
throw new RuntimeException("Expected only 2 invocations");
}
}
}
);
Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
scan.setCaching(1);
scan.setMaxResultSize(1000 * 1000);
try (MockClientScanner scanner=new MockClientScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
Mockito.verify(caller).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
InOrder inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(2)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
assertEquals(3,scanner.cache.size());
Result r=scanner.cache.poll();
assertNotNull(r);
CellScanner cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv1,cs.current());
assertFalse(cs.advance());
r=scanner.cache.poll();
assertNotNull(r);
cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv2,cs.current());
assertFalse(cs.advance());
r=scanner.cache.poll();
assertNotNull(r);
cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv3,cs.current());
assertFalse(cs.advance());
}
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testNoMoreResults() throws IOException {
  final Result[] results=new Result[1];
  KeyValue kv1=new KeyValue("row".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  results[0]=Result.create(new Cell[]{kv1});
  RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  Mockito.when(caller.callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt())).thenAnswer(new Answer<Result[]>(){
    private int count=0;
    @Override public Result[] answer(    InvocationOnMock invocation) throws Throwable {
      ScannerCallableWithReplicas callable=invocation.getArgumentAt(0,ScannerCallableWithReplicas.class);
switch (count) {
case 0:
case 2:
        count++;
      return null;
case 1:
    count++;
  callable.setHasMoreResultsContext(true);
callable.setServerHasMoreResults(false);
return results;
default :
throw new RuntimeException("Expected only 2 invocations");
}
}
}
);
Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
scan.setCaching(100);
scan.setMaxResultSize(1000 * 1000);
try (MockClientScanner scanner=new MockClientScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
Mockito.verify(caller).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
scanner.setRpcFinished(true);
InOrder inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(2)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
assertEquals(1,scanner.cache.size());
Result r=scanner.cache.poll();
assertNotNull(r);
CellScanner cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv1,cs.current());
assertFalse(cs.advance());
}
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testMoreResults() throws IOException {
  final Result[] results1=new Result[1];
  KeyValue kv1=new KeyValue("row".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  results1[0]=Result.create(new Cell[]{kv1});
  final Result[] results2=new Result[1];
  KeyValue kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  results2[0]=Result.create(new Cell[]{kv2});
  RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  Mockito.when(caller.callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt())).thenAnswer(new Answer<Result[]>(){
    private int count=0;
    @Override public Result[] answer(    InvocationOnMock invocation) throws Throwable {
      ScannerCallableWithReplicas callable=invocation.getArgumentAt(0,ScannerCallableWithReplicas.class);
switch (count) {
case 0:
case 3:
        count++;
      return null;
case 1:
    count++;
  callable.setHasMoreResultsContext(true);
callable.setServerHasMoreResults(true);
return results1;
case 2:
count++;
callable.setHasMoreResultsContext(true);
callable.setServerHasMoreResults(false);
return results2;
default :
throw new RuntimeException("Expected only 2 invocations");
}
}
}
);
scan.setCaching(100);
scan.setMaxResultSize(1000 * 1000);
try (MockClientScanner scanner=new MockClientScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
Mockito.verify(caller).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
InOrder inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(2)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
assertEquals(1,scanner.cache.size());
Result r=scanner.cache.poll();
assertNotNull(r);
CellScanner cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv1,cs.current());
assertFalse(cs.advance());
scanner.setRpcFinished(true);
inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(3)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
r=scanner.cache.poll();
assertNotNull(r);
cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv2,cs.current());
assertFalse(cs.advance());
}
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testNoResultsHint() throws IOException {
  final Result[] results=new Result[1];
  KeyValue kv1=new KeyValue("row".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  results[0]=Result.create(new Cell[]{kv1});
  RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  Mockito.when(caller.callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt())).thenAnswer(new Answer<Result[]>(){
    private int count=0;
    @Override public Result[] answer(    InvocationOnMock invocation) throws Throwable {
      ScannerCallableWithReplicas callable=invocation.getArgumentAt(0,ScannerCallableWithReplicas.class);
switch (count) {
case 0:
case 2:
        count++;
      return null;
case 1:
    count++;
  callable.setHasMoreResultsContext(false);
return results;
default :
throw new RuntimeException("Expected only 2 invocations");
}
}
}
);
scan.setCaching(100);
scan.setMaxResultSize(1000 * 1000);
try (MockClientScanner scanner=new MockClientScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
scanner.setRpcFinished(true);
InOrder inOrder=Mockito.inOrder(caller);
scanner.loadCache();
inOrder.verify(caller,Mockito.times(2)).callWithoutRetries(Mockito.any(RetryingCallable.class),Mockito.anyInt());
assertEquals(1,scanner.cache.size());
Result r=scanner.cache.poll();
assertNotNull(r);
CellScanner cs=r.cellScanner();
assertTrue(cs.advance());
assertEquals(kv1,cs.current());
assertFalse(cs.advance());
}
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientSmallReversedScanner </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextNoRecords() throws Exception {
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenReturn(new Result[0]);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    assertEquals(0,csrs.cache.size());
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextPresent() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  @SuppressWarnings("unchecked") RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1})};
        }
 else {
          results=new Result[0];
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenAnswer(createTrueThenFalseAnswer());
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    Queue<Result> results=csrs.cache;
    Iterator<Result> iter=results.iterator();
    assertEquals(3,results.size());
    for (int i=3; i >= 1 && iter.hasNext(); i--) {
      Result result=iter.next();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextFewerRecords() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1})};
        }
 else {
          throw new RuntimeException("Should not fetch a third batch from the server");
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    Queue<Result> results=csrs.cache;
    Iterator<Result> iter=results.iterator();
    assertEquals(2,results.size());
    for (int i=3; i >= 2 && iter.hasNext(); i--) {
      Result result=iter.next();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    results.clear();
    csrs.loadCache();
    assertEquals(1,results.size());
    Result result=results.peek();
    assertEquals("row1",new String(result.getRow(),StandardCharsets.UTF_8));
    assertEquals(1,result.getMap().size());
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextNoRecords() throws Exception {
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallReversedScanner csrs=new ClientSmallReversedScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    csrs.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,csrs.getScannerTimeout())).thenReturn(new Result[0]);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenReturn(false);
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    csrs.loadCache();
    assertEquals(0,csrs.cache.size());
    assertTrue(csrs.closed);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientSmallScanner </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextNoRecords() throws Exception {
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenReturn(new Result[0]);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    assertEquals(0,css.cache.size());
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoContextFewerRecords() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  scan.setCaching(2);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3})};
        }
 else {
          throw new RuntimeException("Should not fetch a third batch from the server");
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(false);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenThrow(new RuntimeException("Should not be called"));
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    Queue<Result> results=css.cache;
    assertEquals(2,results.size());
    for (int i=1; i <= 2; i++) {
      Result result=results.poll();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    results.clear();
    css.loadCache();
    assertEquals(1,results.size());
    Result result=results.peek();
    assertEquals("row3",new String(result.getRow(),StandardCharsets.UTF_8));
    assertEquals(1,result.getMap().size());
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextNoRecords() throws Exception {
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenReturn(new Result[0]);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenReturn(false);
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    assertEquals(0,css.cache.size());
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextPresent() throws Exception {
  final KeyValue kv1=new KeyValue("row1".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv2=new KeyValue("row2".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum), kv3=new KeyValue("row3".getBytes(),"cf".getBytes(),"cq".getBytes(),1,Type.Maximum);
  ScannerCallableWithReplicas callableWithReplicas=Mockito.mock(ScannerCallableWithReplicas.class);
  @SuppressWarnings("unchecked") RpcRetryingCaller<Result[]> caller=Mockito.mock(RpcRetryingCaller.class);
  Mockito.when(rpcFactory.<Result[]>newCaller()).thenReturn(caller);
  SmallScannerCallableFactory factory=getFactory(callableWithReplicas);
  try (ClientSmallScanner css=new ClientSmallScanner(conf,scan,TableName.valueOf("table"),clusterConn,rpcFactory,controllerFactory,pool,Integer.MAX_VALUE)){
    css.setScannerCallableFactory(factory);
    Mockito.when(caller.callWithoutRetries(callableWithReplicas,css.getScannerTimeout())).thenAnswer(new Answer<Result[]>(){
      int count=0;
      @Override public Result[] answer(      InvocationOnMock invocation){
        Result[] results;
        if (0 == count) {
          results=new Result[]{Result.create(new Cell[]{kv1}),Result.create(new Cell[]{kv2})};
        }
 else         if (1 == count) {
          results=new Result[]{Result.create(new Cell[]{kv3})};
        }
 else {
          results=new Result[0];
        }
        count++;
        return results;
      }
    }
);
    Mockito.when(callableWithReplicas.hasMoreResultsContext()).thenReturn(true);
    Mockito.when(callableWithReplicas.getServerHasMoreResults()).thenAnswer(createTrueThenFalseAnswer());
    HRegionInfo regionInfo=Mockito.mock(HRegionInfo.class);
    Mockito.when(callableWithReplicas.getHRegionInfo()).thenReturn(regionInfo);
    Mockito.when(regionInfo.getEndKey()).thenReturn(HConstants.EMPTY_BYTE_ARRAY);
    css.loadCache();
    Queue<Result> results=css.cache;
    assertEquals(3,results.size());
    for (int i=1; i <= 3; i++) {
      Result result=results.poll();
      byte[] row=result.getRow();
      assertEquals("row" + i,new String(row,StandardCharsets.UTF_8));
      assertEquals(1,result.getMap().size());
    }
    assertTrue(css.closed);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFastFail </h4><pre class="type-4 type-8 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Can go zombie -- see HBASE-14421; FIX") @Test public void testFastFail() throws IOException, InterruptedException {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  final String tableName="testClientRelearningExperiment";
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(Bytes.toBytes(tableName)));
  desc.addFamily(new HColumnDescriptor(FAMILY));
  admin.createTable(desc,Bytes.toBytes("aaaa"),Bytes.toBytes("zzzz"),32);
  final long numRows=1000;
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setLong(HConstants.HBASE_CLIENT_OPERATION_TIMEOUT,SLEEPTIME * 100);
  conf.setInt(HConstants.HBASE_CLIENT_PAUSE,SLEEPTIME / 10);
  conf.setBoolean(HConstants.HBASE_CLIENT_FAST_FAIL_MODE_ENABLED,true);
  conf.setLong(HConstants.HBASE_CLIENT_FAST_FAIL_THREASHOLD_MS,0);
  conf.setClass(HConstants.HBASE_CLIENT_FAST_FAIL_INTERCEPTOR_IMPL,MyPreemptiveFastFailInterceptor.class,PreemptiveFastFailInterceptor.class);
  final Connection connection=ConnectionFactory.createConnection(conf);
  List<Put> puts=new ArrayList<>();
  for (long i=0; i < numRows; i++) {
    byte[] rowKey=longToByteArrayKey(i);
    Put put=new Put(rowKey);
    byte[] value=rowKey;
    put.addColumn(FAMILY,QUALIFIER,value);
    puts.add(put);
  }
  try (Table table=connection.getTable(TableName.valueOf(tableName))){
    table.put(puts);
    LOG.info("Written all puts.");
  }
   int nThreads=100;
  ExecutorService service=Executors.newFixedThreadPool(nThreads);
  final CountDownLatch continueOtherHalf=new CountDownLatch(1);
  final CountDownLatch doneHalfway=new CountDownLatch(nThreads);
  final AtomicInteger numSuccessfullThreads=new AtomicInteger(0);
  final AtomicInteger numFailedThreads=new AtomicInteger(0);
  final AtomicLong totalTimeTaken=new AtomicLong(0);
  final AtomicInteger numBlockedWorkers=new AtomicInteger(0);
  final AtomicInteger numPreemptiveFastFailExceptions=new AtomicInteger(0);
  List<Future<Boolean>> futures=new ArrayList<Future<Boolean>>();
  for (int i=0; i < nThreads; i++) {
    futures.add(service.submit(new Callable<Boolean>(){
      /** 
 * The workers are going to perform a couple of reads. The second read
 * will follow the killing of a regionserver so that we make sure that
 * some of threads go into PreemptiveFastFailExcception
 */
      public Boolean call() throws Exception {
        try (Table table=connection.getTable(TableName.valueOf(tableName))){
          Thread.sleep(Math.abs(random.nextInt()) % 250);
          byte[] row=longToByteArrayKey(Math.abs(random.nextLong()) % numRows);
          Get g=new Get(row);
          g.addColumn(FAMILY,QUALIFIER);
          try {
            table.get(g);
          }
 catch (          Exception e) {
            LOG.debug("Get failed : ",e);
            doneHalfway.countDown();
            return false;
          }
          doneHalfway.countDown();
          continueOtherHalf.await();
          long startTime=System.currentTimeMillis();
          g=new Get(row);
          g.addColumn(FAMILY,QUALIFIER);
          try {
            table.get(g);
            numSuccessfullThreads.addAndGet(1);
          }
 catch (          Exception e) {
            if (e instanceof PreemptiveFastFailException) {
              numPreemptiveFastFailExceptions.addAndGet(1);
            }
            numFailedThreads.addAndGet(1);
            return false;
          }
 finally {
            long enTime=System.currentTimeMillis();
            totalTimeTaken.addAndGet(enTime - startTime);
            if ((enTime - startTime) >= SLEEPTIME) {
              numBlockedWorkers.addAndGet(1);
            }
          }
          return true;
        }
 catch (        Exception e) {
          LOG.error("Caught unknown exception",e);
          doneHalfway.countDown();
          return false;
        }
      }
    }
));
  }
  doneHalfway.await();
  TEST_UTIL.getHBaseCluster().getRegionServer(0).getRpcServer().stop();
  TEST_UTIL.getHBaseCluster().getRegionServer(0).stop("Testing");
  continueOtherHalf.countDown();
  Thread.sleep(2 * SLEEPTIME);
  TEST_UTIL.getHBaseCluster().startRegionServer();
  int numThreadsReturnedFalse=0;
  int numThreadsReturnedTrue=0;
  int numThreadsThrewExceptions=0;
  for (  Future<Boolean> f : futures) {
    try {
      numThreadsReturnedTrue+=f.get() ? 1 : 0;
      numThreadsReturnedFalse+=f.get() ? 0 : 1;
    }
 catch (    Exception e) {
      numThreadsThrewExceptions++;
    }
  }
  LOG.debug("numThreadsReturnedFalse:" + numThreadsReturnedFalse + " numThreadsReturnedTrue:"+ numThreadsReturnedTrue+ " numThreadsThrewExceptions:"+ numThreadsThrewExceptions+ " numFailedThreads:"+ numFailedThreads.get()+ " numSuccessfullThreads:"+ numSuccessfullThreads.get()+ " numBlockedWorkers:"+ numBlockedWorkers.get()+ " totalTimeWaited: "+ totalTimeTaken.get() / (numBlockedWorkers.get() == 0 ? Long.MAX_VALUE : numBlockedWorkers.get()) + " numPFFEs: " + numPreemptiveFastFailExceptions.get());
  assertEquals("The expected number of all the successfull and the failed " + "threads should equal the total number of threads that we spawned",nThreads,numFailedThreads.get() + numSuccessfullThreads.get());
  assertEquals("All the failures should be coming from the secondput failure",numFailedThreads.get(),numThreadsReturnedFalse);
  assertEquals("Number of threads that threw execution exceptions " + "otherwise should be 0",numThreadsThrewExceptions,0);
  assertEquals("The regionservers that returned true should equal to the" + " number of successful threads",numThreadsReturnedTrue,numSuccessfullThreads.get());
  assertTrue("There will be atleast one thread that retried instead of failing",MyPreemptiveFastFailInterceptor.numBraveSouls.get() > 0);
  assertTrue("There will be atleast one PreemptiveFastFail exception," + " otherwise, the test makes little sense." + "numPreemptiveFastFailExceptions: "+ numPreemptiveFastFailExceptions.get(),numPreemptiveFastFailExceptions.get() > 0);
  assertTrue("Only few thread should ideally be waiting for the dead " + "regionserver to be coming back. numBlockedWorkers:" + numBlockedWorkers.get() + " threads that retried : "+ MyPreemptiveFastFailInterceptor.numBraveSouls.get(),numBlockedWorkers.get() <= MyPreemptiveFastFailInterceptor.numBraveSouls.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFromClientSide </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSmallScan() throws Exception {
  TableName TABLE=TableName.valueOf("testSmallScan");
  Table table=TEST_UTIL.createTable(TABLE,FAMILY);
  int insertNum=10;
  for (int i=0; i < 10; i++) {
    Put put=new Put(Bytes.toBytes("row" + String.format("%03d",i)));
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
  }
  ResultScanner scanner=table.getScanner(new Scan());
  int count=0;
  for (  Result r : scanner) {
    assertTrue(!r.isEmpty());
    count++;
  }
  assertEquals(insertNum,count);
  Scan scan=new Scan(HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
  scan.setSmall(true);
  scan.setCaching(2);
  scanner=table.getScanner(scan);
  count=0;
  for (  Result r : scanner) {
    assertTrue(!r.isEmpty());
    count++;
  }
  assertEquals(insertNum,count);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiscHTableStuff() throws IOException {
  final TableName tableAname=TableName.valueOf("testMiscHTableStuffA");
  final TableName tableBname=TableName.valueOf("testMiscHTableStuffB");
  final byte[] attrName=Bytes.toBytes("TESTATTR");
  final byte[] attrValue=Bytes.toBytes("somevalue");
  byte[] value=Bytes.toBytes("value");
  Table a=TEST_UTIL.createTable(tableAname,HConstants.CATALOG_FAMILY);
  Table b=TEST_UTIL.createTable(tableBname,HConstants.CATALOG_FAMILY);
  Put put=new Put(ROW);
  put.addColumn(HConstants.CATALOG_FAMILY,null,value);
  a.put(put);
  Table newA=TEST_UTIL.getConnection().getTable(tableAname);
  Scan scan=new Scan();
  scan.addFamily(HConstants.CATALOG_FAMILY);
  ResultScanner s=newA.getScanner(scan);
  try {
    for (    Result r : s) {
      put=new Put(r.getRow());
      put.setDurability(Durability.SKIP_WAL);
      for (      Cell kv : r.rawCells()) {
        put.add(kv);
      }
      b.put(put);
    }
  }
  finally {
    s.close();
  }
  Table anotherA=TEST_UTIL.getConnection().getTable(tableAname);
  Get get=new Get(ROW);
  get.addFamily(HConstants.CATALOG_FAMILY);
  anotherA.get(get);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor desc=new HTableDescriptor(a.getTableDescriptor());
  admin.disableTable(tableAname);
  desc.setValue(attrName,attrValue);
  for (  HColumnDescriptor c : desc.getFamilies())   c.setValue(attrName,attrValue);
  admin.modifyTable(tableAname,desc);
  admin.enableTable(tableAname);
  desc=a.getTableDescriptor();
  assertEquals("wrong table descriptor returned",desc.getTableName(),tableAname);
  value=desc.getValue(attrName);
  assertFalse("missing HTD attribute value",value == null);
  assertFalse("HTD attribute value is incorrect",Bytes.compareTo(value,attrValue) != 0);
  for (  HColumnDescriptor c : desc.getFamilies()) {
    value=c.getValue(attrName);
    assertFalse("missing HCD attribute value",value == null);
    assertFalse("HCD attribute value is incorrect",Bytes.compareTo(value,attrValue) != 0);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic client side validation of HBASE-4536
 */
@Test public void testKeepDeletedCells() throws Exception {
  final TableName TABLENAME=TableName.valueOf("testKeepDeletesCells");
  final byte[] FAMILY=Bytes.toBytes("family");
  final byte[] C0=Bytes.toBytes("c0");
  final byte[] T1=Bytes.toBytes("T1");
  final byte[] T2=Bytes.toBytes("T2");
  final byte[] T3=Bytes.toBytes("T3");
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY).setKeepDeletedCells(KeepDeletedCells.TRUE).setDataBlockEncoding(DataBlockEncoding.PREFIX_TREE).setMaxVersions(3);
  HTableDescriptor desc=new HTableDescriptor(TABLENAME);
  desc.addFamily(hcd);
  TEST_UTIL.getHBaseAdmin().createTable(desc);
  Table h=TEST_UTIL.getConnection().getTable(TABLENAME);
  long ts=System.currentTimeMillis();
  Put p=new Put(T1,ts);
  p.addColumn(FAMILY,C0,T1);
  h.put(p);
  p=new Put(T1,ts + 2);
  p.addColumn(FAMILY,C0,T2);
  h.put(p);
  p=new Put(T1,ts + 4);
  p.addColumn(FAMILY,C0,T3);
  h.put(p);
  Delete d=new Delete(T1,ts + 3);
  h.delete(d);
  d=new Delete(T1,ts + 3);
  d.addColumns(FAMILY,C0,ts + 3);
  h.delete(d);
  Get g=new Get(T1);
  g.setTimeRange(0,ts + 3);
  Result r=h.get(g);
  assertArrayEquals(T2,r.getValue(FAMILY,C0));
  Scan s=new Scan(T1);
  s.setTimeRange(0,ts + 3);
  s.setMaxVersions();
  ResultScanner scanner=h.getScanner(s);
  Cell[] kvs=scanner.next().rawCells();
  assertArrayEquals(T2,CellUtil.cloneValue(kvs[0]));
  assertArrayEquals(T1,CellUtil.cloneValue(kvs[1]));
  scanner.close();
  s=new Scan(T1);
  s.setRaw(true);
  s.setMaxVersions();
  scanner=h.getScanner(s);
  kvs=scanner.next().rawCells();
  assertTrue(CellUtil.isDeleteFamily(kvs[0]));
  assertArrayEquals(T3,CellUtil.cloneValue(kvs[1]));
  assertTrue(CellUtil.isDelete(kvs[2]));
  assertArrayEquals(T2,CellUtil.cloneValue(kvs[3]));
  assertArrayEquals(T1,CellUtil.cloneValue(kvs[4]));
  scanner.close();
  h.close();
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests reversed scan under multi regions
 */
@Test public void testReversedScanUnderMultiRegions() throws Exception {
  TableName TABLE=TableName.valueOf("testReversedScanUnderMultiRegions");
  byte[] maxByteArray=ReversedClientScanner.MAX_BYTE_ARRAY;
  byte[][] splitRows=new byte[][]{Bytes.toBytes("005"),Bytes.add(Bytes.toBytes("005"),Bytes.multiple(maxByteArray,16)),Bytes.toBytes("006"),Bytes.add(Bytes.toBytes("006"),Bytes.multiple(maxByteArray,8)),Bytes.toBytes("007"),Bytes.add(Bytes.toBytes("007"),Bytes.multiple(maxByteArray,4)),Bytes.toBytes("008"),Bytes.multiple(maxByteArray,2)};
  Table table=TEST_UTIL.createTable(TABLE,FAMILY,splitRows);
  TEST_UTIL.waitUntilAllRegionsAssigned(table.getName());
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE)){
    assertEquals(splitRows.length + 1,l.getAllRegionLocations().size());
  }
   int insertNum=splitRows.length;
  for (int i=0; i < insertNum; i++) {
    Put put=new Put(splitRows[i]);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
  }
  ResultScanner scanner=table.getScanner(new Scan());
  int count=0;
  for (  Result r : scanner) {
    assertTrue(!r.isEmpty());
    count++;
  }
  assertEquals(insertNum,count);
  Scan scan=new Scan();
  scan.setReversed(true);
  scanner=table.getScanner(scan);
  count=0;
  byte[] lastRow=null;
  for (  Result r : scanner) {
    assertTrue(!r.isEmpty());
    count++;
    byte[] thisRow=r.getRow();
    if (lastRow != null) {
      assertTrue("Error scan order, last row= " + Bytes.toString(lastRow) + ",this row="+ Bytes.toString(thisRow),Bytes.compareTo(thisRow,lastRow) < 0);
    }
    lastRow=thisRow;
  }
  assertEquals(insertNum,count);
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilters() throws Exception {
  TableName TABLE=TableName.valueOf("testFilters");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  byte[][] ROWS=makeN(ROW,10);
  byte[][] QUALIFIERS={Bytes.toBytes("col0-<d2v1>-<d3v2>"),Bytes.toBytes("col1-<d2v1>-<d3v2>"),Bytes.toBytes("col2-<d2v1>-<d3v2>"),Bytes.toBytes("col3-<d2v1>-<d3v2>"),Bytes.toBytes("col4-<d2v1>-<d3v2>"),Bytes.toBytes("col5-<d2v1>-<d3v2>"),Bytes.toBytes("col6-<d2v1>-<d3v2>"),Bytes.toBytes("col7-<d2v1>-<d3v2>"),Bytes.toBytes("col8-<d2v1>-<d3v2>"),Bytes.toBytes("col9-<d2v1>-<d3v2>")};
  for (int i=0; i < 10; i++) {
    Put put=new Put(ROWS[i]);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(FAMILY,QUALIFIERS[i],VALUE);
    ht.put(put);
  }
  Scan scan=new Scan();
  scan.addFamily(FAMILY);
  Filter filter=new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator("col[1-5]"));
  scan.setFilter(filter);
  ResultScanner scanner=ht.getScanner(scan);
  int expectedIndex=1;
  for (  Result result : ht.getScanner(scan)) {
    assertEquals(result.size(),1);
    assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[expectedIndex]));
    assertTrue(Bytes.equals(CellUtil.cloneQualifier(result.rawCells()[0]),QUALIFIERS[expectedIndex]));
    expectedIndex++;
  }
  assertEquals(expectedIndex,6);
  scanner.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that cache on write works all the way up from the client-side.
 * Performs inserts, flushes, and compactions, verifying changes in the block
 * cache along the way.
 * @throws Exception
 */
@Test public void testCacheOnWriteEvictOnClose() throws Exception {
  TableName tableName=TableName.valueOf("testCOWEOCfromClient");
  byte[] data=Bytes.toBytes("data");
  Table table=TEST_UTIL.createTable(tableName,FAMILY);
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    long startBlockCount=cache.getBlockCount();
    long startBlockHits=cache.getStats().getHitCount();
    long startBlockMiss=cache.getStats().getMissCount();
    for (int i=0; i < 5; i++) {
      Thread.sleep(100);
      if (startBlockCount != cache.getBlockCount() || startBlockHits != cache.getStats().getHitCount() || startBlockMiss != cache.getStats().getMissCount()) {
        startBlockCount=cache.getBlockCount();
        startBlockHits=cache.getStats().getHitCount();
        startBlockMiss=cache.getStats().getMissCount();
        i=-1;
      }
    }
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    assertEquals(startBlockCount,cache.getBlockCount());
    assertEquals(startBlockHits,cache.getStats().getHitCount());
    assertEquals(startBlockMiss,cache.getStats().getMissCount());
    System.out.println("Flushing cache");
    region.flush(true);
    long expectedBlockCount=startBlockCount + 1;
    long expectedBlockHits=startBlockHits;
    long expectedBlockMiss=startBlockMiss;
    assertEquals(expectedBlockCount,cache.getBlockCount());
    assertEquals(expectedBlockHits,cache.getStats().getHitCount());
    assertEquals(expectedBlockMiss,cache.getStats().getMissCount());
    assertTrue(Bytes.equals(table.get(new Get(ROW)).value(),data));
    assertEquals(expectedBlockCount,cache.getBlockCount());
    assertEquals(++expectedBlockHits,cache.getStats().getHitCount());
    assertEquals(expectedBlockMiss,cache.getStats().getMissCount());
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    byte[] data2=Bytes.add(data,data);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    Result r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    assertEquals(expectedBlockCount,cache.getBlockCount());
    assertEquals(++expectedBlockHits,cache.getStats().getHitCount());
    assertEquals(expectedBlockMiss,cache.getStats().getMissCount());
    System.out.println("Flushing cache");
    region.flush(true);
    assertEquals(++expectedBlockCount,cache.getBlockCount());
    assertEquals(expectedBlockHits,cache.getStats().getHitCount());
    assertEquals(expectedBlockMiss,cache.getStats().getMissCount());
    System.out.println("Compacting");
    assertEquals(2,store.getStorefilesCount());
    store.triggerMajorCompaction();
    region.compact(true);
    waitForStoreFileCount(store,1,10000);
    assertEquals(1,store.getStorefilesCount());
    expectedBlockCount-=2;
    assertEquals(expectedBlockCount,cache.getBlockCount());
    expectedBlockHits+=2;
    assertEquals(expectedBlockMiss,cache.getStats().getMissCount());
    assertEquals(expectedBlockHits,cache.getStats().getHitCount());
    r=table.get(new Get(ROW));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER),data));
    assertTrue(Bytes.equals(r.getValue(FAMILY,QUALIFIER2),data2));
    expectedBlockCount+=1;
    assertEquals(expectedBlockCount,cache.getBlockCount());
    assertEquals(expectedBlockHits,cache.getStats().getHitCount());
    assertEquals(++expectedBlockMiss,cache.getStats().getMissCount());
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientPoolRoundRobin() throws IOException {
  final TableName tableName=TableName.valueOf("testClientPoolRoundRobin");
  int poolSize=3;
  int numVersions=poolSize * 2;
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.HBASE_CLIENT_IPC_POOL_TYPE,"round-robin");
  conf.setInt(HConstants.HBASE_CLIENT_IPC_POOL_SIZE,poolSize);
  Table table=TEST_UTIL.createTable(tableName,new byte[][]{FAMILY},Integer.MAX_VALUE);
  final long ts=EnvironmentEdgeManager.currentTime();
  Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions();
  for (int versions=1; versions <= numVersions; versions++) {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,ts + versions,VALUE);
    table.put(put);
    Result result=table.get(get);
    NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
    assertEquals("The number of versions of '" + FAMILY + ":"+ QUALIFIER+ " did not match "+ versions,versions,navigableMap.size());
    for (    Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
      assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowMutation() throws Exception {
  LOG.info("Starting testRowMutation");
  final TableName TABLENAME=TableName.valueOf("testRowMutation");
  Table t=TEST_UTIL.createTable(TABLENAME,FAMILY);
  byte[][] QUALIFIERS=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b")};
  RowMutations arm=new RowMutations(ROW);
  Put p=new Put(ROW);
  p.addColumn(FAMILY,QUALIFIERS[0],VALUE);
  arm.add(p);
  t.mutateRow(arm);
  Get g=new Get(ROW);
  Result r=t.get(g);
  assertEquals(0,Bytes.compareTo(VALUE,r.getValue(FAMILY,QUALIFIERS[0])));
  arm=new RowMutations(ROW);
  p=new Put(ROW);
  p.addColumn(FAMILY,QUALIFIERS[1],VALUE);
  arm.add(p);
  Delete d=new Delete(ROW);
  d.addColumns(FAMILY,QUALIFIERS[0]);
  arm.add(d);
  t.mutateRow(arm);
  r=t.get(g);
  assertEquals(0,Bytes.compareTo(VALUE,r.getValue(FAMILY,QUALIFIERS[1])));
  assertNull(r.getValue(FAMILY,QUALIFIERS[0]));
  try {
    arm=new RowMutations(ROW);
    p=new Put(ROW);
    p.addColumn(new byte[]{'b','o','g','u','s'},QUALIFIERS[0],VALUE);
    arm.add(p);
    t.mutateRow(arm);
    fail("Expected NoSuchColumnFamilyException");
  }
 catch (  NoSuchColumnFamilyException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeTimestamp() throws IOException {
  Table table=TEST_UTIL.createTable(TableName.valueOf("testNegativeTimestamp"),FAMILY);
  try {
    Put put=new Put(ROW,-1);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
    fail("Negative timestamps should not have been allowed");
  }
 catch (  IllegalArgumentException ex) {
    assertTrue(ex.getMessage().contains("negative"));
  }
  try {
    Put put=new Put(ROW);
    long ts=-1;
    put.addColumn(FAMILY,QUALIFIER,ts,VALUE);
    table.put(put);
    fail("Negative timestamps should not have been allowed");
  }
 catch (  IllegalArgumentException ex) {
    assertTrue(ex.getMessage().contains("negative"));
  }
  try {
    Delete delete=new Delete(ROW,-1);
    table.delete(delete);
    fail("Negative timestamps should not have been allowed");
  }
 catch (  IllegalArgumentException ex) {
    assertTrue(ex.getMessage().contains("negative"));
  }
  try {
    Delete delete=new Delete(ROW);
    delete.addFamily(FAMILY,-1);
    table.delete(delete);
    fail("Negative timestamps should not have been allowed");
  }
 catch (  IllegalArgumentException ex) {
    assertTrue(ex.getMessage().contains("negative"));
  }
  try {
    Scan scan=new Scan();
    scan.setTimeRange(-1,1);
    table.getScanner(scan);
    fail("Negative timestamps should not have been allowed");
  }
 catch (  IllegalArgumentException ex) {
    assertTrue(ex.getMessage().contains("negative"));
  }
  try {
    new KeyValue(Bytes.toBytes(42),Bytes.toBytes(42),Bytes.toBytes(42),-1,Bytes.toBytes(42));
  }
 catch (  IllegalArgumentException ex) {
    fail("KeyValue SHOULD allow negative timestamps");
  }
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test filters when multiple regions.  It does counts.  Needs eye-balling of
 * logs to ensure that we're not scanning more regions that we're supposed to.
 * Related to the TestFilterAcrossRegions over in the o.a.h.h.filter package.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testFilterAcrossMultipleRegions() throws IOException, InterruptedException {
  TableName name=TableName.valueOf("testFilterAcrossMutlipleRegions");
  Table t=TEST_UTIL.createTable(name,FAMILY);
  int rowCount=TEST_UTIL.loadTable(t,FAMILY,false);
  assertRowCount(t,rowCount);
  List<HRegionLocation> regions=splitTable(t);
  assertRowCount(t,rowCount);
  byte[] endKey=regions.get(0).getRegionInfo().getEndKey();
  int endKeyCount=countRows(t,createScanWithRowFilter(endKey));
  assertTrue(endKeyCount < rowCount);
  byte[] key=new byte[]{endKey[0],endKey[1],(byte)(endKey[2] + 1)};
  int plusOneCount=countRows(t,createScanWithRowFilter(key));
  assertEquals(endKeyCount + 1,plusOneCount);
  key=new byte[]{endKey[0],endKey[1],(byte)(endKey[2] + 2)};
  int plusTwoCount=countRows(t,createScanWithRowFilter(key));
  assertEquals(endKeyCount + 2,plusTwoCount);
  key=new byte[]{endKey[0],endKey[1],(byte)(endKey[2] - 1)};
  int minusOneCount=countRows(t,createScanWithRowFilter(key));
  assertEquals(endKeyCount - 1,minusOneCount);
  key=new byte[]{'a','a','a'};
  int countBBB=countRows(t,createScanWithRowFilter(key,null,CompareFilter.CompareOp.EQUAL));
  assertEquals(1,countBBB);
  int countGreater=countRows(t,createScanWithRowFilter(endKey,null,CompareFilter.CompareOp.GREATER_OR_EQUAL));
  assertEquals(0,countGreater);
  countGreater=countRows(t,createScanWithRowFilter(endKey,endKey,CompareFilter.CompareOp.GREATER_OR_EQUAL));
  assertEquals(rowCount - endKeyCount,countGreater);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFiltersWithReverseScan() throws Exception {
  TableName TABLE=TableName.valueOf("testFiltersWithReverseScan");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  byte[][] ROWS=makeN(ROW,10);
  byte[][] QUALIFIERS={Bytes.toBytes("col0-<d2v1>-<d3v2>"),Bytes.toBytes("col1-<d2v1>-<d3v2>"),Bytes.toBytes("col2-<d2v1>-<d3v2>"),Bytes.toBytes("col3-<d2v1>-<d3v2>"),Bytes.toBytes("col4-<d2v1>-<d3v2>"),Bytes.toBytes("col5-<d2v1>-<d3v2>"),Bytes.toBytes("col6-<d2v1>-<d3v2>"),Bytes.toBytes("col7-<d2v1>-<d3v2>"),Bytes.toBytes("col8-<d2v1>-<d3v2>"),Bytes.toBytes("col9-<d2v1>-<d3v2>")};
  for (int i=0; i < 10; i++) {
    Put put=new Put(ROWS[i]);
    put.addColumn(FAMILY,QUALIFIERS[i],VALUE);
    ht.put(put);
  }
  Scan scan=new Scan();
  scan.setReversed(true);
  scan.addFamily(FAMILY);
  Filter filter=new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator("col[1-5]"));
  scan.setFilter(filter);
  ResultScanner scanner=ht.getScanner(scan);
  int expectedIndex=5;
  for (  Result result : scanner) {
    assertEquals(result.size(),1);
    Cell c=result.rawCells()[0];
    assertTrue(Bytes.equals(c.getRowArray(),c.getRowOffset(),c.getRowLength(),ROWS[expectedIndex],0,ROWS[expectedIndex].length));
    assertTrue(Bytes.equals(c.getQualifierArray(),c.getQualifierOffset(),c.getQualifierLength(),QUALIFIERS[expectedIndex],0,QUALIFIERS[expectedIndex].length));
    expectedIndex--;
  }
  assertEquals(expectedIndex,0);
  scanner.close();
  ht.close();
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Flakey: HBASE-8989") @Test public void testClientPoolThreadLocal() throws IOException {
  final TableName tableName=TableName.valueOf("testClientPoolThreadLocal");
  int poolSize=Integer.MAX_VALUE;
  int numVersions=3;
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(HConstants.HBASE_CLIENT_IPC_POOL_TYPE,"thread-local");
  conf.setInt(HConstants.HBASE_CLIENT_IPC_POOL_SIZE,poolSize);
  final Table table=TEST_UTIL.createTable(tableName,new byte[][]{FAMILY},3);
  final long ts=EnvironmentEdgeManager.currentTime();
  final Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions();
  for (int versions=1; versions <= numVersions; versions++) {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,ts + versions,VALUE);
    table.put(put);
    Result result=table.get(get);
    NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
    assertEquals("The number of versions of '" + FAMILY + ":"+ QUALIFIER+ " did not match "+ versions+ "; "+ put.toString()+ ", "+ get.toString(),versions,navigableMap.size());
    for (    Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
      assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
    }
  }
  final Object waitLock=new Object();
  ExecutorService executorService=Executors.newFixedThreadPool(numVersions);
  final AtomicReference<AssertionError> error=new AtomicReference<AssertionError>(null);
  for (int versions=numVersions; versions < numVersions * 2; versions++) {
    final int versionsCopy=versions;
    executorService.submit(new Callable<Void>(){
      @Override public Void call(){
        try {
          Put put=new Put(ROW);
          put.addColumn(FAMILY,QUALIFIER,ts + versionsCopy,VALUE);
          table.put(put);
          Result result=table.get(get);
          NavigableMap<Long,byte[]> navigableMap=result.getMap().get(FAMILY).get(QUALIFIER);
          assertEquals("The number of versions of '" + Bytes.toString(FAMILY) + ":"+ Bytes.toString(QUALIFIER)+ " did not match "+ versionsCopy,versionsCopy,navigableMap.size());
          for (          Map.Entry<Long,byte[]> entry : navigableMap.entrySet()) {
            assertTrue("The value at time " + entry.getKey() + " did not match what was put",Bytes.equals(VALUE,entry.getValue()));
          }
synchronized (waitLock) {
            waitLock.wait();
          }
        }
 catch (        Exception e) {
        }
catch (        AssertionError e) {
          error.set(e);
          LOG.error(e);
        }
        return null;
      }
    }
);
  }
synchronized (waitLock) {
    waitLock.notifyAll();
  }
  executorService.shutdownNow();
  assertNull(error.get());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests reversed scan under multi regions
 */
@Test public void testSmallReversedScanUnderMultiRegions() throws Exception {
  TableName TABLE=TableName.valueOf("testSmallReversedScanUnderMultiRegions");
  byte[][] splitRows=new byte[][]{Bytes.toBytes("000"),Bytes.toBytes("002"),Bytes.toBytes("004"),Bytes.toBytes("006"),Bytes.toBytes("008"),Bytes.toBytes("010")};
  Table table=TEST_UTIL.createTable(TABLE,FAMILY,splitRows);
  TEST_UTIL.waitUntilAllRegionsAssigned(table.getName());
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(TABLE)){
    assertEquals(splitRows.length + 1,l.getAllRegionLocations().size());
  }
   for (  byte[] splitRow : splitRows) {
    Put put=new Put(splitRow);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
    byte[] nextRow=Bytes.copy(splitRow);
    nextRow[nextRow.length - 1]++;
    put=new Put(nextRow);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
  }
  ResultScanner scanner=table.getScanner(new Scan());
  int count=0;
  for (  Result r : scanner) {
    assertTrue(!r.isEmpty());
    count++;
  }
  assertEquals(12,count);
  reverseScanTest(table,false);
  reverseScanTest(table,true);
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIllegalTableDescriptor() throws Exception {
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testIllegalTableDescriptor"));
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY);
  checkTableIsIllegal(htd);
  htd.addFamily(hcd);
  checkTableIsLegal(htd);
  htd.setMaxFileSize(1024);
  checkTableIsIllegal(htd);
  htd.setMaxFileSize(0);
  checkTableIsIllegal(htd);
  htd.setMaxFileSize(1024 * 1024 * 1024);
  checkTableIsLegal(htd);
  htd.setMemStoreFlushSize(1024);
  checkTableIsIllegal(htd);
  htd.setMemStoreFlushSize(0);
  checkTableIsIllegal(htd);
  htd.setMemStoreFlushSize(128 * 1024 * 1024);
  checkTableIsLegal(htd);
  htd.setRegionSplitPolicyClassName("nonexisting.foo.class");
  checkTableIsIllegal(htd);
  htd.setRegionSplitPolicyClassName(null);
  checkTableIsLegal(htd);
  hcd.setBlocksize(0);
  checkTableIsIllegal(htd);
  hcd.setBlocksize(1024 * 1024 * 128);
  checkTableIsIllegal(htd);
  hcd.setBlocksize(1024);
  checkTableIsLegal(htd);
  hcd.setTimeToLive(0);
  checkTableIsIllegal(htd);
  hcd.setTimeToLive(-1);
  checkTableIsIllegal(htd);
  hcd.setTimeToLive(1);
  checkTableIsLegal(htd);
  hcd.setMinVersions(-1);
  checkTableIsIllegal(htd);
  hcd.setMinVersions(3);
  try {
    hcd.setMaxVersions(2);
    fail();
  }
 catch (  IllegalArgumentException ex) {
    hcd.setMaxVersions(10);
  }
  checkTableIsLegal(htd);
  hcd.setMaxVersions(4);
  hcd.setMinVersions(5);
  checkTableIsIllegal(htd);
  hcd.setMinVersions(3);
  hcd.setScope(-1);
  checkTableIsIllegal(htd);
  hcd.setScope(0);
  checkTableIsLegal(htd);
  try {
    hcd.setDFSReplication((short)-1);
    fail("Illegal value for setDFSReplication did not throw");
  }
 catch (  IllegalArgumentException e) {
  }
  hcd.setValue(HColumnDescriptor.DFS_REPLICATION,"-1");
  checkTableIsIllegal(htd);
  try {
    hcd.setDFSReplication((short)-1);
    fail("Should throw exception if an illegal value is explicitly being set");
  }
 catch (  IllegalArgumentException e) {
  }
  htd.setMemStoreFlushSize(0);
  ListAppender listAppender=new ListAppender();
  Logger log=Logger.getLogger(HMaster.class);
  log.addAppender(listAppender);
  log.setLevel(Level.WARN);
  htd.setConfiguration("hbase.table.sanity.checks",Boolean.FALSE.toString());
  checkTableIsLegal(htd);
  assertFalse(listAppender.getMessages().isEmpty());
  assertTrue(listAppender.getMessages().get(0).startsWith("MEMSTORE_FLUSHSIZE for table " + "descriptor or \"hbase.hregion.memstore.flush.size\" (0) is too small, which might " + "cause very frequent flushing."));
  log.removeAppender(listAppender);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterWithLongCompartor() throws Exception {
  TableName TABLE=TableName.valueOf("testFilterWithLongCompartor");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  byte[][] ROWS=makeN(ROW,10);
  byte[][] values=new byte[10][];
  for (int i=0; i < 10; i++) {
    values[i]=Bytes.toBytes(100L * i);
  }
  for (int i=0; i < 10; i++) {
    Put put=new Put(ROWS[i]);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(FAMILY,QUALIFIER,values[i]);
    ht.put(put);
  }
  Scan scan=new Scan();
  scan.addFamily(FAMILY);
  Filter filter=new SingleColumnValueFilter(FAMILY,QUALIFIER,CompareOp.GREATER,new LongComparator(500));
  scan.setFilter(filter);
  ResultScanner scanner=ht.getScanner(scan);
  int expectedIndex=0;
  for (  Result result : ht.getScanner(scan)) {
    assertEquals(result.size(),1);
    assertTrue(Bytes.toLong(result.getValue(FAMILY,QUALIFIER)) > 500);
    expectedIndex++;
  }
  assertEquals(expectedIndex,4);
  scanner.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonCachedGetRegionLocation() throws Exception {
  TableName TABLE=TableName.valueOf("testNonCachedGetRegionLocation");
  byte[] family1=Bytes.toBytes("f1");
  byte[] family2=Bytes.toBytes("f2");
  try (Table table=TEST_UTIL.createTable(TABLE,new byte[][]{family1,family2},10);Admin admin=TEST_UTIL.getHBaseAdmin();RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(TABLE)){
    List<HRegionLocation> allRegionLocations=locator.getAllRegionLocations();
    assertEquals(1,allRegionLocations.size());
    HRegionInfo regionInfo=allRegionLocations.get(0).getRegionInfo();
    ServerName addrBefore=allRegionLocations.get(0).getServerName();
    HRegionLocation addrCache=locator.getRegionLocation(regionInfo.getStartKey(),false);
    HRegionLocation addrNoCache=locator.getRegionLocation(regionInfo.getStartKey(),true);
    assertEquals(addrBefore.getPort(),addrCache.getPort());
    assertEquals(addrBefore.getPort(),addrNoCache.getPort());
    ServerName addrAfter=null;
    for (int i=0; i < SLAVES; i++) {
      HRegionServer regionServer=TEST_UTIL.getHBaseCluster().getRegionServer(i);
      ServerName addr=regionServer.getServerName();
      if (addr.getPort() != addrBefore.getPort()) {
        admin.move(regionInfo.getEncodedNameAsBytes(),Bytes.toBytes(addr.toString()));
        Thread.sleep(5000);
        addrAfter=addr;
        break;
      }
    }
    addrCache=locator.getRegionLocation(regionInfo.getStartKey(),false);
    addrNoCache=locator.getRegionLocation(regionInfo.getStartKey(),true);
    assertNotNull(addrAfter);
    assertTrue(addrAfter.getPort() != addrCache.getPort());
    assertEquals(addrAfter.getPort(),addrNoCache.getPort());
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPut() throws IOException {
  final byte[] CONTENTS_FAMILY=Bytes.toBytes("contents");
  final byte[] SMALL_FAMILY=Bytes.toBytes("smallfam");
  final byte[] row1=Bytes.toBytes("row1");
  final byte[] row2=Bytes.toBytes("row2");
  final byte[] value=Bytes.toBytes("abcd");
  Table table=TEST_UTIL.createTable(TableName.valueOf("testPut"),new byte[][]{CONTENTS_FAMILY,SMALL_FAMILY});
  Put put=new Put(row1);
  put.addColumn(CONTENTS_FAMILY,null,value);
  table.put(put);
  put=new Put(row2);
  put.addColumn(CONTENTS_FAMILY,null,value);
  assertEquals(put.size(),1);
  assertEquals(put.getFamilyCellMap().get(CONTENTS_FAMILY).size(),1);
  KeyValue kv=(KeyValue)put.getFamilyCellMap().get(CONTENTS_FAMILY).get(0);
  assertTrue(Bytes.equals(CellUtil.cloneFamily(kv),CONTENTS_FAMILY));
  assertTrue(Bytes.equals(CellUtil.cloneQualifier(kv),new byte[0]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(kv),value));
  table.put(put);
  Scan scan=new Scan();
  scan.addColumn(CONTENTS_FAMILY,null);
  ResultScanner scanner=table.getScanner(scan);
  for (  Result r : scanner) {
    for (    Cell key : r.rawCells()) {
      System.out.println(Bytes.toString(r.getRow()) + ": " + key.toString());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClosestRowBefore() throws IOException, InterruptedException {
  final TableName tableName=TableName.valueOf("testGetClosestRowBefore");
  final byte[] firstRow=Bytes.toBytes("row111");
  final byte[] secondRow=Bytes.toBytes("row222");
  final byte[] thirdRow=Bytes.toBytes("row333");
  final byte[] forthRow=Bytes.toBytes("row444");
  final byte[] beforeFirstRow=Bytes.toBytes("row");
  final byte[] beforeSecondRow=Bytes.toBytes("row22");
  final byte[] beforeThirdRow=Bytes.toBytes("row33");
  final byte[] beforeForthRow=Bytes.toBytes("row44");
  try (Table t=TEST_UTIL.createTable(tableName,new byte[][]{HConstants.CATALOG_FAMILY,Bytes.toBytes("info2")},1,1024);RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    if (t instanceof HTableInterface) {
      HTableInterface table=(HTableInterface)t;
      String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
      Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
      Put put1=new Put(firstRow);
      Put put2=new Put(secondRow);
      Put put3=new Put(thirdRow);
      Put put4=new Put(forthRow);
      byte[] one=new byte[]{1};
      byte[] two=new byte[]{2};
      byte[] three=new byte[]{3};
      byte[] four=new byte[]{4};
      put1.addColumn(HConstants.CATALOG_FAMILY,null,one);
      put2.addColumn(HConstants.CATALOG_FAMILY,null,two);
      put3.addColumn(HConstants.CATALOG_FAMILY,null,three);
      put4.addColumn(HConstants.CATALOG_FAMILY,null,four);
      table.put(put1);
      table.put(put2);
      table.put(put3);
      table.put(put4);
      region.flush(true);
      Result result;
      result=getReverseScanResult(table,beforeFirstRow,HConstants.CATALOG_FAMILY);
      assertNull(result);
      result=getReverseScanResult(table,firstRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),firstRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),one));
      result=getReverseScanResult(table,beforeSecondRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),firstRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),one));
      result=getReverseScanResult(table,secondRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),secondRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),two));
      result=getReverseScanResult(table,beforeThirdRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),secondRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),two));
      result=getReverseScanResult(table,thirdRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),thirdRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),three));
      result=getReverseScanResult(table,beforeForthRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),thirdRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),three));
      result=getReverseScanResult(table,forthRow,HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),forthRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),four));
      result=getReverseScanResult(table,Bytes.add(forthRow,one),HConstants.CATALOG_FAMILY);
      assertTrue(result.containsColumn(HConstants.CATALOG_FAMILY,null));
      assertTrue(Bytes.equals(result.getRow(),forthRow));
      assertTrue(Bytes.equals(result.getValue(HConstants.CATALOG_FAMILY,null),four));
    }
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletes() throws Exception {
  TableName TABLE=TableName.valueOf("testDeletes");
  byte[][] ROWS=makeNAscii(ROW,6);
  byte[][] FAMILIES=makeNAscii(FAMILY,3);
  byte[][] VALUES=makeN(VALUE,5);
  long[] ts={1000,2000,3000,4000,5000};
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES,3);
  Put put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[1],VALUES[1]);
  ht.put(put);
  Delete delete=new Delete(ROW);
  delete.addFamily(FAMILIES[0],ts[0]);
  ht.delete(delete);
  Get get=new Get(ROW);
  get.addFamily(FAMILIES[0]);
  get.setMaxVersions(Integer.MAX_VALUE);
  Result result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1]},new byte[][]{VALUES[1]},0,0);
  Scan scan=new Scan(ROW);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1]},new byte[][]{VALUES[1]},0,0);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[3],VALUES[3]);
  put.addColumn(FAMILIES[0],null,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],null,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],null,ts[3],VALUES[3]);
  ht.put(put);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],QUALIFIER);
  ht.delete(delete);
  get=new Get(ROW);
  get.addColumn(FAMILIES[0],QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  scan=new Scan(ROW);
  scan.addColumn(FAMILIES[0],QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],null);
  ht.delete(delete);
  delete=new Delete(ROW);
  delete.addColumns(FAMILIES[0],null);
  ht.delete(delete);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  ht.put(put);
  get=new Get(ROW);
  get.addFamily(FAMILIES[0]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  scan=new Scan(ROW);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[1]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[2]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  get=new Get(ROWS[2]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 4 key but received " + result.size() + ": "+ result,result.size() == 4);
  delete=new Delete(ROWS[0]);
  delete.addFamily(FAMILIES[2]);
  ht.delete(delete);
  delete=new Delete(ROWS[1]);
  delete.addColumns(FAMILIES[1],QUALIFIER);
  ht.delete(delete);
  delete=new Delete(ROWS[2]);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[2],QUALIFIER);
  ht.delete(delete);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertNResult(result,ROWS[0],FAMILIES[1],QUALIFIER,new long[]{ts[0],ts[1]},new byte[][]{VALUES[0],VALUES[1]},0,1);
  scan=new Scan(ROWS[0]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertNResult(result,ROWS[0],FAMILIES[1],QUALIFIER,new long[]{ts[0],ts[1]},new byte[][]{VALUES[0],VALUES[1]},0,1);
  get=new Get(ROWS[1]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  scan=new Scan(ROWS[1]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  get=new Get(ROWS[2]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertEquals(1,result.size());
  assertNResult(result,ROWS[2],FAMILIES[2],QUALIFIER,new long[]{ts[2]},new byte[][]{VALUES[2]},0,0);
  scan=new Scan(ROWS[2]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertEquals(1,result.size());
  assertNResult(result,ROWS[2],FAMILIES[2],QUALIFIER,new long[]{ts[2]},new byte[][]{VALUES[2]},0,0);
  delete=new Delete(ROWS[3]);
  delete.addFamily(FAMILIES[1]);
  ht.delete(delete);
  put=new Put(ROWS[3]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[0]);
  ht.put(put);
  put=new Put(ROWS[4]);
  put.addColumn(FAMILIES[1],QUALIFIER,VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[2]);
  ht.put(put);
  get=new Get(ROWS[3]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 1 key but received " + result.size(),result.size() == 1);
  get=new Get(ROWS[4]);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  scan=new Scan(ROWS[3]);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  ResultScanner scanner=ht.getScanner(scan);
  result=scanner.next();
  assertTrue("Expected 1 key but received " + result.size(),result.size() == 1);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[3]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[0]));
  result=scanner.next();
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[1]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[1]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[1]),VALUES[2]));
  scanner.close();
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    put=new Put(bytes);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(FAMILIES[0],QUALIFIER,bytes);
    ht.put(put);
  }
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    get=new Get(bytes);
    get.addFamily(FAMILIES[0]);
    result=ht.get(get);
    assertTrue(result.size() == 1);
  }
  ArrayList<Delete> deletes=new ArrayList<Delete>();
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    delete=new Delete(bytes);
    delete.addFamily(FAMILIES[0]);
    deletes.add(delete);
  }
  ht.delete(deletes);
  for (int i=0; i < 10; i++) {
    byte[] bytes=Bytes.toBytes(i);
    get=new Get(bytes);
    get.addFamily(FAMILIES[0]);
    result=ht.get(get);
    assertTrue(result.size() == 0);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletesWithReverseScan() throws Exception {
  TableName TABLE=TableName.valueOf("testDeletesWithReverseScan");
  byte[][] ROWS=makeNAscii(ROW,6);
  byte[][] FAMILIES=makeNAscii(FAMILY,3);
  byte[][] VALUES=makeN(VALUE,5);
  long[] ts={1000,2000,3000,4000,5000};
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES,3);
  Put put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[1],VALUES[1]);
  ht.put(put);
  Delete delete=new Delete(ROW);
  delete.addFamily(FAMILIES[0],ts[0]);
  ht.delete(delete);
  Scan scan=new Scan(ROW);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  Result result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1]},new byte[][]{VALUES[1]},0,0);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[3],VALUES[3]);
  put.addColumn(FAMILIES[0],null,ts[4],VALUES[4]);
  put.addColumn(FAMILIES[0],null,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[0],null,ts[3],VALUES[3]);
  ht.put(put);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],QUALIFIER);
  ht.delete(delete);
  scan=new Scan(ROW);
  scan.setReversed(true);
  scan.addColumn(FAMILIES[0],QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  delete=new Delete(ROW);
  delete.addColumn(FAMILIES[0],null);
  ht.delete(delete);
  delete=new Delete(ROW);
  delete.addColumns(FAMILIES[0],null);
  ht.delete(delete);
  put=new Put(ROW);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[0],QUALIFIER,ts[4],VALUES[4]);
  ht.put(put);
  scan=new Scan(ROW);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[0]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILIES[0],QUALIFIER,new long[]{ts[1],ts[2],ts[3]},new byte[][]{VALUES[1],VALUES[2],VALUES[3]},0,2);
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[1]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  put=new Put(ROWS[2]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[0],VALUES[0]);
  put.addColumn(FAMILIES[1],QUALIFIER,ts[1],VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIER,ts[3],VALUES[3]);
  ht.put(put);
  delete=new Delete(ROWS[0]);
  delete.addFamily(FAMILIES[2]);
  ht.delete(delete);
  delete=new Delete(ROWS[1]);
  delete.addColumns(FAMILIES[1],QUALIFIER);
  ht.delete(delete);
  delete=new Delete(ROWS[2]);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[1],QUALIFIER);
  delete.addColumn(FAMILIES[2],QUALIFIER);
  ht.delete(delete);
  scan=new Scan(ROWS[0]);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertNResult(result,ROWS[0],FAMILIES[1],QUALIFIER,new long[]{ts[0],ts[1]},new byte[][]{VALUES[0],VALUES[1]},0,1);
  scan=new Scan(ROWS[1]);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  scan=new Scan(ROWS[2]);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertEquals(1,result.size());
  assertNResult(result,ROWS[2],FAMILIES[2],QUALIFIER,new long[]{ts[2]},new byte[][]{VALUES[2]},0,0);
  delete=new Delete(ROWS[3]);
  delete.addFamily(FAMILIES[1]);
  ht.delete(delete);
  put=new Put(ROWS[3]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[0]);
  ht.put(put);
  put=new Put(ROWS[4]);
  put.addColumn(FAMILIES[1],QUALIFIER,VALUES[1]);
  put.addColumn(FAMILIES[2],QUALIFIER,VALUES[2]);
  ht.put(put);
  scan=new Scan(ROWS[4]);
  scan.setReversed(true);
  scan.addFamily(FAMILIES[1]);
  scan.addFamily(FAMILIES[2]);
  scan.setMaxVersions(Integer.MAX_VALUE);
  ResultScanner scanner=ht.getScanner(scan);
  result=scanner.next();
  assertTrue("Expected 2 keys but received " + result.size(),result.size() == 2);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[1]),ROWS[4]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[1]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[1]),VALUES[2]));
  result=scanner.next();
  assertTrue("Expected 1 key but received " + result.size(),result.size() == 1);
  assertTrue(Bytes.equals(CellUtil.cloneRow(result.rawCells()[0]),ROWS[3]));
  assertTrue(Bytes.equals(CellUtil.cloneValue(result.rawCells()[0]),VALUES[0]));
  scanner.close();
  ht.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test ScanMetrics
 * @throws Exception
 */
@Test @SuppressWarnings("unused") public void testScanMetrics() throws Exception {
  TableName TABLENAME=TableName.valueOf("testScanMetrics");
  Table ht=TEST_UTIL.createMultiRegionTable(TABLENAME,FAMILY);
  int numOfRegions=-1;
  try (RegionLocator r=TEST_UTIL.getConnection().getRegionLocator(TABLENAME)){
    numOfRegions=r.getStartKeys().length;
  }
   Put put1=new Put(Bytes.toBytes("zzz1"));
  put1.addColumn(FAMILY,QUALIFIER,VALUE);
  Put put2=new Put(Bytes.toBytes("zzz2"));
  put2.addColumn(FAMILY,QUALIFIER,VALUE);
  Put put3=new Put(Bytes.toBytes("zzz3"));
  put3.addColumn(FAMILY,QUALIFIER,VALUE);
  ht.put(Arrays.asList(put1,put2,put3));
  Scan scan1=new Scan();
  int numRecords=0;
  ResultScanner scanner=ht.getScanner(scan1);
  for (  Result result : scanner) {
    numRecords++;
  }
  scanner.close();
  LOG.info("test data has " + numRecords + " records.");
  assertEquals(null,scan1.getScanMetrics());
  Scan scan2=new Scan();
  scan2.setScanMetricsEnabled(true);
  scan2.setCaching(numRecords + 1);
  scanner=ht.getScanner(scan2);
  for (  Result result : scanner.next(numRecords - 1)) {
  }
  scanner.close();
  assertNotNull(scan2.getScanMetrics());
  scan2=new Scan();
  scan2.setScanMetricsEnabled(true);
  scan2.setCaching(1);
  scanner=ht.getScanner(scan2);
  for (  Result result : scanner.next(numRecords - 1)) {
  }
  scanner.close();
  ScanMetrics scanMetrics=scan2.getScanMetrics();
  assertEquals("Did not access all the regions in the table",numOfRegions,scanMetrics.countOfRegions.get());
  scan2=new Scan();
  scan2.setScanMetricsEnabled(true);
  scan2.setCaching(1);
  scanner=ht.getScanner(scan2);
  int numBytes=0;
  for (  Result result : scanner.next(1)) {
    for (    Cell cell : result.listCells()) {
      numBytes+=CellUtil.estimatedSerializedSizeOf(cell);
    }
  }
  scanner.close();
  scanMetrics=scan2.getScanMetrics();
  assertEquals("Did not count the result bytes",numBytes,scanMetrics.countOfBytesInResults.get());
  scan2=new Scan();
  scan2.setScanMetricsEnabled(true);
  scan2.setCaching(1);
  scan2.setSmall(true);
  scanner=ht.getScanner(scan2);
  numBytes=0;
  for (  Result result : scanner.next(1)) {
    for (    Cell cell : result.listCells()) {
      numBytes+=CellUtil.estimatedSerializedSizeOf(cell);
    }
  }
  scanner.close();
  scanMetrics=scan2.getScanMetrics();
  assertEquals("Did not count the result bytes",numBytes,scanMetrics.countOfBytesInResults.get());
  Scan scanWithClose=new Scan();
  scanWithClose.setCaching(numRecords);
  scanWithClose.setScanMetricsEnabled(true);
  ResultScanner scannerWithClose=ht.getScanner(scanWithClose);
  for (  Result result : scannerWithClose.next(numRecords + 1)) {
  }
  scannerWithClose.close();
  ScanMetrics scanMetricsWithClose=getScanMetrics(scanWithClose);
  assertEquals("Did not access all the regions in the table",numOfRegions,scanMetricsWithClose.countOfRegions.get());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndPut() throws IOException {
  final byte[] anotherrow=Bytes.toBytes("anotherrow");
  final byte[] value2=Bytes.toBytes("abcd");
  Table table=TEST_UTIL.createTable(TableName.valueOf("testCheckAndPut"),FAMILY);
  Put put1=new Put(ROW);
  put1.addColumn(FAMILY,QUALIFIER,VALUE);
  boolean ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,VALUE,put1);
  assertEquals(ok,false);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,null,put1);
  assertEquals(ok,true);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,null,put1);
  assertEquals(ok,false);
  Put put2=new Put(ROW);
  put2.addColumn(FAMILY,QUALIFIER,value2);
  ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,VALUE,put2);
  assertEquals(ok,true);
  Put put3=new Put(anotherrow);
  put3.addColumn(FAMILY,QUALIFIER,VALUE);
  try {
    ok=table.checkAndPut(ROW,FAMILY,QUALIFIER,value2,put3);
    fail("trying to check and modify different rows should have failed.");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic client side validation of HBASE-10118
 */
@Test public void testPurgeFutureDeletes() throws Exception {
  final TableName TABLENAME=TableName.valueOf("testPurgeFutureDeletes");
  final byte[] ROW=Bytes.toBytes("row");
  final byte[] FAMILY=Bytes.toBytes("family");
  final byte[] COLUMN=Bytes.toBytes("column");
  final byte[] VALUE=Bytes.toBytes("value");
  Table table=TEST_UTIL.createTable(TABLENAME,FAMILY);
  long ts=System.currentTimeMillis() * 2;
  Put put=new Put(ROW,ts);
  put.addColumn(FAMILY,COLUMN,VALUE);
  table.put(put);
  Get get=new Get(ROW);
  Result result=table.get(get);
  assertArrayEquals(VALUE,result.getValue(FAMILY,COLUMN));
  Delete del=new Delete(ROW);
  del.addColumn(FAMILY,COLUMN,ts);
  table.delete(del);
  get=new Get(ROW);
  result=table.get(get);
  assertNull(result.getValue(FAMILY,COLUMN));
  TEST_UTIL.getHBaseAdmin().flush(TABLENAME);
  TEST_UTIL.getHBaseAdmin().majorCompact(TABLENAME);
  TEST_UTIL.waitFor(6000,new Waiter.Predicate<IOException>(){
    @Override public boolean evaluate() throws IOException {
      return TEST_UTIL.getHBaseAdmin().getCompactionState(TABLENAME) == AdminProtos.GetRegionInfoResponse.CompactionState.NONE;
    }
  }
);
  put=new Put(ROW,ts);
  put.addColumn(FAMILY,COLUMN,VALUE);
  table.put(put);
  get=new Get(ROW);
  result=table.get(get);
  assertArrayEquals(VALUE,result.getValue(FAMILY,COLUMN));
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFromClientSide3 </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableExistsAllBeforeGet() throws Exception {
  final byte[] ROW2=Bytes.add(ROW,Bytes.toBytes("2"));
  Table table=TEST_UTIL.createTable(TableName.valueOf("testHTableExistsAllBeforeGet"),new byte[][]{FAMILY});
  try {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
    put=new Put(ROW2);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
    Get get=new Get(ROW);
    Get get2=new Get(ROW2);
    ArrayList<Get> getList=new ArrayList(2);
    getList.add(get);
    getList.add(get2);
    boolean[] exists=table.existsAll(getList);
    assertEquals(true,exists[0]);
    assertEquals(true,exists[1]);
    Result[] result=table.get(getList);
    assertEquals(false,result[0].isEmpty());
    assertTrue(Bytes.equals(VALUE,result[0].getValue(FAMILY,QUALIFIER)));
    assertEquals(false,result[1].isEmpty());
    assertTrue(Bytes.equals(VALUE,result[1].getValue(FAMILY,QUALIFIER)));
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEmptyRow() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(Bytes.toBytes("test")));
  desc.addFamily(new HColumnDescriptor(FAMILY));
  admin.createTable(desc);
  Table table=TEST_UTIL.getConnection().getTable(desc.getTableName());
  Put put=new Put(ROW_BYTES);
  put.addColumn(FAMILY,COL_QUAL,VAL_BYTES);
  table.put(put);
  Result res=null;
  try {
    res=table.get(new Get(new byte[0]));
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  assertTrue(res == null);
  res=table.get(new Get(Bytes.toBytes("r1-not-exist")));
  assertTrue(res.isEmpty() == true);
  res=table.get(new Get(ROW_BYTES));
  assertTrue(Arrays.equals(res.getValue(FAMILY,COL_QUAL),VAL_BYTES));
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAdvancedConfigOverride() throws Exception {
  TEST_UTIL.getConfiguration().setInt("hbase.hstore.compaction.min",3);
  TableName tableName=TableName.valueOf("testAdvancedConfigOverride");
  Table hTable=TEST_UTIL.createTable(tableName,FAMILY,10);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  ClusterConnection connection=(ClusterConnection)TEST_UTIL.getConnection();
  byte[] row=Bytes.toBytes(random.nextInt());
  performMultiplePutAndFlush((HBaseAdmin)admin,hTable,row,FAMILY,3,100);
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    HRegionLocation loc=locator.getRegionLocation(row,true);
    byte[] regionName=loc.getRegionInfo().getRegionName();
    AdminProtos.AdminService.BlockingInterface server=connection.getAdmin(loc.getServerName());
    assertTrue(ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size() > 1);
    admin.compact(tableName);
    for (int i=0; i < 10 * 1000 / 40; ++i) {
      loc=locator.getRegionLocation(row,true);
      if (!loc.getRegionInfo().isOffline()) {
        regionName=loc.getRegionInfo().getRegionName();
        server=connection.getAdmin(loc.getServerName());
        if (ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size() <= 1) {
          break;
        }
      }
      Thread.sleep(40);
    }
    assertTrue(ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size() <= 1);
    LOG.info("hbase.hstore.compaction.min should now be 5");
    HTableDescriptor htd=new HTableDescriptor(hTable.getTableDescriptor());
    htd.setValue("hbase.hstore.compaction.min",String.valueOf(5));
    admin.modifyTable(tableName,htd);
    Pair<Integer,Integer> st;
    while (null != (st=admin.getAlterStatus(tableName)) && st.getFirst() > 0) {
      LOG.debug(st.getFirst() + " regions left to update");
      Thread.sleep(40);
    }
    LOG.info("alter status finished");
    performMultiplePutAndFlush((HBaseAdmin)admin,hTable,row,FAMILY,3,10);
    admin.compact(tableName);
    Thread.sleep(10 * 1000);
    loc=locator.getRegionLocation(row,true);
    regionName=loc.getRegionInfo().getRegionName();
    server=connection.getAdmin(loc.getServerName());
    int sfCount=ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size();
    assertTrue(sfCount > 1);
    LOG.info("hbase.hstore.compaction.min should now be 2");
    HColumnDescriptor hcd=new HColumnDescriptor(htd.getFamily(FAMILY));
    hcd.setValue("hbase.hstore.compaction.min",String.valueOf(2));
    htd.modifyFamily(hcd);
    admin.modifyTable(tableName,htd);
    while (null != (st=admin.getAlterStatus(tableName)) && st.getFirst() > 0) {
      LOG.debug(st.getFirst() + " regions left to update");
      Thread.sleep(40);
    }
    LOG.info("alter status finished");
    admin.compact(tableName);
    for (int i=0; i < 10 * 1000 / 40; ++i) {
      loc=locator.getRegionLocation(row,true);
      regionName=loc.getRegionInfo().getRegionName();
      try {
        server=connection.getAdmin(loc.getServerName());
        if (ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size() < sfCount) {
          break;
        }
      }
 catch (      Exception e) {
        LOG.debug("Waiting for region to come online: " + regionName);
      }
      Thread.sleep(40);
    }
    assertTrue(ProtobufUtil.getStoreFiles(server,regionName,FAMILY).size() < sfCount);
    LOG.info("Removing CF config value");
    LOG.info("hbase.hstore.compaction.min should now be 5");
    hcd=new HColumnDescriptor(htd.getFamily(FAMILY));
    hcd.setValue("hbase.hstore.compaction.min",null);
    htd.modifyFamily(hcd);
    admin.modifyTable(tableName,htd);
    while (null != (st=admin.getAlterStatus(tableName)) && st.getFirst() > 0) {
      LOG.debug(st.getFirst() + " regions left to update");
      Thread.sleep(40);
    }
    LOG.info("alter status finished");
    assertNull(hTable.getTableDescriptor().getFamily(FAMILY).getValue("hbase.hstore.compaction.min"));
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableExistsBeforeGet() throws Exception {
  Table table=TEST_UTIL.createTable(TableName.valueOf("testHTableExistsBeforeGet"),new byte[][]{FAMILY});
  try {
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,VALUE);
    table.put(put);
    Get get=new Get(ROW);
    boolean exist=table.exists(get);
    assertEquals(true,exist);
    Result result=table.get(get);
    assertEquals(false,result.isEmpty());
    assertTrue(Bytes.equals(VALUE,result.getValue(FAMILY,QUALIFIER)));
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestGet </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestGetRowFromGetCopyConstructor() throws Exception {
  Get get=new Get(ROW);
  get.setFilter(null);
  get.setAuthorizations(new Authorizations("foo"));
  get.setACL("u",new Permission(Permission.Action.READ));
  get.setConsistency(Consistency.TIMELINE);
  get.setReplicaId(2);
  get.setIsolationLevel(IsolationLevel.READ_UNCOMMITTED);
  get.setCheckExistenceOnly(true);
  get.setTimeRange(3,4);
  get.setMaxVersions(11);
  get.setMaxResultsPerColumnFamily(10);
  get.setRowOffsetPerColumnFamily(11);
  get.setCacheBlocks(true);
  Get copyGet=new Get(get);
  assertEquals(0,Bytes.compareTo(get.getRow(),copyGet.getRow()));
  assertEquals(get.getId(),copyGet.getId());
  assertEquals(get.getFilter(),copyGet.getFilter());
  assertTrue(get.getAuthorizations().toString().equals(copyGet.getAuthorizations().toString()));
  assertTrue(Bytes.equals(get.getACL(),copyGet.getACL()));
  assertEquals(get.getConsistency(),copyGet.getConsistency());
  assertEquals(get.getReplicaId(),copyGet.getReplicaId());
  assertEquals(get.getIsolationLevel(),copyGet.getIsolationLevel());
  assertEquals(get.isCheckExistenceOnly(),copyGet.isCheckExistenceOnly());
  assertTrue(get.getTimeRange().equals(copyGet.getTimeRange()));
  assertEquals(get.getMaxVersions(),copyGet.getMaxVersions());
  assertEquals(get.getMaxResultsPerColumnFamily(),copyGet.getMaxResultsPerColumnFamily());
  assertEquals(get.getRowOffsetPerColumnFamily(),copyGet.getRowOffsetPerColumnFamily());
  assertEquals(get.getCacheBlocks(),copyGet.getCacheBlocks());
  assertEquals(get.getId(),copyGet.getId());
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDynamicFilter() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  String localPath=conf.get("hbase.local.dir") + File.separator + "jars"+ File.separator;
  File jarFile=new File(localPath,"MockFilter.jar");
  jarFile.delete();
  assertFalse("Should be deleted: " + jarFile.getPath(),jarFile.exists());
  ClientProtos.Get getProto1=ClientProtos.Get.parseFrom(Base64.decode(PB_GET));
  ClientProtos.Get getProto2=ClientProtos.Get.parseFrom(Base64.decode(PB_GET_WITH_FILTER_LIST));
  try {
    ProtobufUtil.toGet(getProto1);
    fail("Should not be able to load the filter class");
  }
 catch (  IOException ioe) {
    assertTrue(ioe.getCause() instanceof ClassNotFoundException);
  }
  try {
    ProtobufUtil.toGet(getProto2);
    fail("Should not be able to load the filter class");
  }
 catch (  IOException ioe) {
    assertTrue(ioe.getCause() instanceof InvocationTargetException);
    InvocationTargetException ite=(InvocationTargetException)ioe.getCause();
    assertTrue(ite.getTargetException() instanceof DeserializationException);
  }
  FileOutputStream fos=new FileOutputStream(jarFile);
  fos.write(Base64.decode(MOCK_FILTER_JAR));
  fos.close();
  Get get1=ProtobufUtil.toGet(getProto1);
  assertEquals("test.MockFilter",get1.getFilter().getClass().getName());
  Get get2=ProtobufUtil.toGet(getProto2);
  assertTrue(get2.getFilter() instanceof FilterList);
  List<Filter> filters=((FilterList)get2.getFilter()).getFilters();
  assertEquals(3,filters.size());
  assertEquals("test.MockFilter",filters.get(0).getClass().getName());
  assertEquals("my.MockFilter",filters.get(1).getClass().getName());
  assertTrue(filters.get(2) instanceof KeyOnlyFilter);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAttributes(){
  Get get=new Get(ROW);
  Assert.assertTrue(get.getAttributesMap().isEmpty());
  Assert.assertNull(get.getAttribute("absent"));
  get.setAttribute("absent",null);
  Assert.assertTrue(get.getAttributesMap().isEmpty());
  Assert.assertNull(get.getAttribute("absent"));
  get.setAttribute("attribute1",Bytes.toBytes("value1"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),get.getAttribute("attribute1")));
  Assert.assertEquals(1,get.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),get.getAttributesMap().get("attribute1")));
  get.setAttribute("attribute1",Bytes.toBytes("value12"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),get.getAttribute("attribute1")));
  Assert.assertEquals(1,get.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),get.getAttributesMap().get("attribute1")));
  get.setAttribute("attribute2",Bytes.toBytes("value2"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),get.getAttribute("attribute2")));
  Assert.assertEquals(2,get.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),get.getAttributesMap().get("attribute2")));
  get.setAttribute("attribute2",null);
  Assert.assertNull(get.getAttribute("attribute2"));
  Assert.assertEquals(1,get.getAttributesMap().size());
  Assert.assertNull(get.getAttributesMap().get("attribute2"));
  get.setAttribute("attribute2",null);
  Assert.assertNull(get.getAttribute("attribute2"));
  Assert.assertEquals(1,get.getAttributesMap().size());
  Assert.assertNull(get.getAttributesMap().get("attribute2"));
  get.setAttribute("attribute1",null);
  Assert.assertNull(get.getAttribute("attribute1"));
  Assert.assertTrue(get.getAttributesMap().isEmpty());
  Assert.assertNull(get.getAttributesMap().get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAttributesSerialization() throws IOException {
  Get get=new Get(Bytes.toBytes("row"));
  get.setAttribute("attribute1",Bytes.toBytes("value1"));
  get.setAttribute("attribute2",Bytes.toBytes("value2"));
  get.setAttribute("attribute3",Bytes.toBytes("value3"));
  ClientProtos.Get getProto=ProtobufUtil.toGet(get);
  Get get2=ProtobufUtil.toGet(getProto);
  Assert.assertNull(get2.getAttribute("absent"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),get2.getAttribute("attribute1")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),get2.getAttribute("attribute2")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value3"),get2.getAttribute("attribute3")));
  Assert.assertEquals(3,get2.getAttributesMap().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestHBaseAdminNoCluster </h4><pre class="type-11 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Verify that PleaseHoldException gets retried.
 * HBASE-8764
 * @throws IOException
 * @throws ZooKeeperConnectionException
 * @throws MasterNotRunningException
 * @throws ServiceException
 */
@Ignore @Test public void testMasterMonitorCallableRetries() throws MasterNotRunningException, ZooKeeperConnectionException, IOException, ServiceException {
  Configuration configuration=HBaseConfiguration.create();
  configuration.setLong(HConstants.HBASE_CLIENT_PAUSE,1);
  final int count=10;
  configuration.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,count);
  ClusterConnection connection=HConnectionTestingUtility.getMockedConnection(configuration);
  MasterKeepAliveConnection masterAdmin=Mockito.mock(MasterKeepAliveConnection.class);
  Mockito.when(masterAdmin.createTable((RpcController)Mockito.any(),(CreateTableRequest)Mockito.any())).thenThrow(new ServiceException("Test fail").initCause(new PleaseHoldException("test")));
  Mockito.when(connection.getKeepAliveMasterService()).thenReturn(masterAdmin);
  Admin admin=new HBaseAdmin(connection);
  try {
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testMasterMonitorCollableRetries"));
    try {
      admin.createTable(htd,HBaseTestingUtility.KEYS_FOR_HBA_CREATE_TABLE);
      fail();
    }
 catch (    RetriesExhaustedException e) {
      LOG.info("Expected fail",e);
    }
    Mockito.verify(masterAdmin,Mockito.atLeast(count)).createTable((RpcController)Mockito.any(),(CreateTableRequest)Mockito.any());
  }
  finally {
    admin.close();
    if (connection != null)     connection.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestHCM </h4><pre class="type-7 type-8 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Test presumes RETRY_BACKOFF will never change; it has") @Test public void testErrorBackoffTimeCalculation() throws Exception {
  final long ANY_PAUSE=100;
  ServerName location=ServerName.valueOf("127.0.0.1",1,0);
  ServerName diffLocation=ServerName.valueOf("127.0.0.1",2,0);
  ManualEnvironmentEdge timeMachine=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(timeMachine);
  try {
    long timeBase=timeMachine.currentTime();
    long largeAmountOfTime=ANY_PAUSE * 1000;
    ConnectionImplementation.ServerErrorTracker tracker=new ConnectionImplementation.ServerErrorTracker(largeAmountOfTime,100);
    assertEquals(0,tracker.calculateBackoffTime(location,ANY_PAUSE));
    tracker.reportServerError(location);
    assertEqualsWithJitter(ANY_PAUSE,tracker.calculateBackoffTime(location,ANY_PAUSE));
    tracker.reportServerError(location);
    tracker.reportServerError(location);
    tracker.reportServerError(location);
    assertEqualsWithJitter(ANY_PAUSE * 5,tracker.calculateBackoffTime(location,ANY_PAUSE));
    assertEquals(0,tracker.calculateBackoffTime(diffLocation,ANY_PAUSE));
    tracker.reportServerError(diffLocation);
    assertEqualsWithJitter(ANY_PAUSE,tracker.calculateBackoffTime(diffLocation,ANY_PAUSE));
    assertEqualsWithJitter(ANY_PAUSE * 10,tracker.calculateBackoffTime(location,ANY_PAUSE * 2));
    long timeShift=(long)(ANY_PAUSE * 0.5);
    timeMachine.setValue(timeBase + timeShift);
    assertEqualsWithJitter((ANY_PAUSE * 5) - timeShift,tracker.calculateBackoffTime(location,ANY_PAUSE),ANY_PAUSE * 2);
    timeMachine.setValue(timeBase + ANY_PAUSE * 100);
    assertEquals(0,tracker.calculateBackoffTime(location,ANY_PAUSE));
    long timeLeft=(long)(ANY_PAUSE * 0.5);
    timeMachine.setValue(timeBase + largeAmountOfTime - timeLeft);
    assertTrue(tracker.canTryMore(1));
    tracker.reportServerError(location);
    assertEquals(timeLeft,tracker.calculateBackoffTime(location,ANY_PAUSE));
    timeMachine.setValue(timeBase + largeAmountOfTime);
    assertFalse(tracker.canTryMore(1));
  }
  finally {
    EnvironmentEdgeManager.reset();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterConnection() throws IOException {
  ThreadPoolExecutor otherPool=new ThreadPoolExecutor(1,1,5,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),Threads.newDaemonThreadFactory("test-hcm"));
  Connection con1=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
  Connection con2=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration(),otherPool);
  assertTrue(otherPool == ((ConnectionImplementation)con2).getCurrentBatchPool());
  TableName tableName=TableName.valueOf("testClusterConnection");
  TEST_UTIL.createTable(tableName,FAM_NAM).close();
  HTable t=(HTable)con1.getTable(tableName,otherPool);
  assertNull("Internal Thread pool should be null",((ConnectionImplementation)con1).getCurrentBatchPool());
  assertTrue(otherPool == t.getPool());
  t.close();
  t=(HTable)con2.getTable(tableName);
  assertTrue(otherPool == t.getPool());
  t.close();
  t=(HTable)con2.getTable(tableName);
  assertTrue(otherPool == t.getPool());
  t.close();
  t=(HTable)con2.getTable(tableName);
  assertTrue(otherPool == t.getPool());
  t.close();
  t=(HTable)con1.getTable(tableName);
  ExecutorService pool=((ConnectionImplementation)con1).getCurrentBatchPool();
  assertNotNull("An internal Thread pool should have been created",pool);
  assertTrue(t.getPool() == pool);
  t.close();
  t=(HTable)con1.getTable(tableName);
  assertTrue(t.getPool() == pool);
  t.close();
  con1.close();
  assertTrue(pool.isShutdown());
  con2.close();
  assertFalse(otherPool.isShutdown());
  otherPool.shutdownNow();
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that when we delete a location using the first row of a region
 * that we really delete it.
 * @throws Exception
 */
@Test public void testRegionCaching() throws Exception {
  TEST_UTIL.createMultiRegionTable(TABLE_NAME,FAM_NAM).close();
  Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,0);
  Connection connection=ConnectionFactory.createConnection(conf);
  final Table table=connection.getTable(TABLE_NAME);
  TEST_UTIL.waitUntilAllRegionsAssigned(table.getName());
  Put put=new Put(ROW);
  put.addColumn(FAM_NAM,ROW,ROW);
  table.put(put);
  ConnectionImplementation conn=(ConnectionImplementation)connection;
  assertNotNull(conn.getCachedLocation(TABLE_NAME,ROW));
  final int nextPort=conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort() + 1;
  HRegionLocation loc=conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation();
  conn.updateCachedLocation(loc.getRegionInfo(),loc.getServerName(),ServerName.valueOf("127.0.0.1",nextPort,HConstants.LATEST_TIMESTAMP),HConstants.LATEST_TIMESTAMP);
  Assert.assertEquals(conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort(),nextPort);
  conn.clearRegionCache(TABLE_NAME,ROW.clone());
  RegionLocations rl=conn.getCachedLocation(TABLE_NAME,ROW);
  assertNull("What is this location?? " + rl,rl);
  conn.clearRegionCache(TABLE_NAME);
  Assert.assertEquals(0,conn.getNumberOfCachedRegionLocations(TABLE_NAME));
  Put put2=new Put(ROW);
  put2.addColumn(FAM_NAM,ROW,ROW);
  table.put(put2);
  assertNotNull(conn.getCachedLocation(TABLE_NAME,ROW));
  assertNotNull(conn.getCachedLocation(TableName.valueOf(TABLE_NAME.getName()),ROW.clone()));
  TEST_UTIL.getHBaseAdmin().setBalancerRunning(false,false);
  HMaster master=TEST_UTIL.getMiniHBaseCluster().getMaster();
  while (master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(1);
  }
  HRegionLocation toMove=conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation();
  byte[] regionName=toMove.getRegionInfo().getRegionName();
  byte[] encodedRegionNameBytes=toMove.getRegionInfo().getEncodedNameAsBytes();
  int curServerId=TEST_UTIL.getHBaseCluster().getServerWith(regionName);
  int destServerId=(curServerId == 0 ? 1 : 0);
  HRegionServer curServer=TEST_UTIL.getHBaseCluster().getRegionServer(curServerId);
  HRegionServer destServer=TEST_UTIL.getHBaseCluster().getRegionServer(destServerId);
  ServerName destServerName=destServer.getServerName();
  Assert.assertTrue(curServer != destServer);
  Assert.assertFalse(curServer.getServerName().equals(destServer.getServerName()));
  Assert.assertFalse(toMove.getPort() == destServerName.getPort());
  Assert.assertNotNull(curServer.getOnlineRegion(regionName));
  Assert.assertNull(destServer.getOnlineRegion(regionName));
  Assert.assertFalse(TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().isRegionsInTransition());
  LOG.info("Move starting region=" + toMove.getRegionInfo().getRegionNameAsString());
  TEST_UTIL.getHBaseAdmin().move(toMove.getRegionInfo().getEncodedNameAsBytes(),destServerName.getServerName().getBytes());
  while (destServer.getOnlineRegion(regionName) == null || destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(1);
  }
  LOG.info("Move finished for region=" + toMove.getRegionInfo().getRegionNameAsString());
  Assert.assertNull(curServer.getOnlineRegion(regionName));
  Assert.assertNotNull(destServer.getOnlineRegion(regionName));
  Assert.assertFalse(destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
  Assert.assertFalse(curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
  Assert.assertFalse(conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort() == destServerName.getPort());
  LOG.info("Put starting");
  Put put3=new Put(ROW);
  put3.addColumn(FAM_NAM,ROW,ROW);
  try {
    table.put(put3);
    Assert.fail("Unreachable point");
  }
 catch (  RetriesExhaustedWithDetailsException e) {
    LOG.info("Put done, exception caught: " + e.getClass());
    Assert.assertEquals(1,e.getNumExceptions());
    Assert.assertEquals(1,e.getCauses().size());
    Assert.assertArrayEquals(e.getRow(0).getRow(),ROW);
    Throwable cause=ClientExceptionsUtil.findException(e.getCause(0));
    Assert.assertNotNull(cause);
    Assert.assertTrue(cause instanceof RegionMovedException);
  }
  Assert.assertNotNull("Cached connection is null",conn.getCachedLocation(TABLE_NAME,ROW));
  Assert.assertEquals("Previous server was " + curServer.getServerName().getHostAndPort(),destServerName.getPort(),conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort());
  Assert.assertFalse(destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
  Assert.assertFalse(curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
  LOG.info("Move starting region=" + toMove.getRegionInfo().getRegionNameAsString());
  TEST_UTIL.getHBaseAdmin().move(toMove.getRegionInfo().getEncodedNameAsBytes(),curServer.getServerName().getServerName().getBytes());
  while (curServer.getOnlineRegion(regionName) == null || destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(1);
  }
  Assert.assertNotNull(curServer.getOnlineRegion(regionName));
  Assert.assertNull(destServer.getOnlineRegion(regionName));
  LOG.info("Move finished for region=" + toMove.getRegionInfo().getRegionNameAsString());
  Assert.assertFalse(conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort() == curServer.getServerName().getPort());
  Scan sc=new Scan();
  sc.setStopRow(ROW);
  sc.setStartRow(ROW);
  TEST_UTIL.getConfiguration().setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,1);
  try {
    ResultScanner rs=table.getScanner(sc);
    while (rs.next() != null) {
    }
    Assert.fail("Unreachable point");
  }
 catch (  RetriesExhaustedException e) {
    LOG.info("Scan done, expected exception caught: " + e.getClass());
  }
  Assert.assertNotNull(conn.getCachedLocation(TABLE_NAME,ROW));
  Assert.assertEquals("Previous server was " + destServer.getServerName().getHostAndPort(),curServer.getServerName().getPort(),conn.getCachedLocation(TABLE_NAME,ROW).getRegionLocation().getPort());
  TEST_UTIL.getConfiguration().setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,HConstants.DEFAULT_HBASE_CLIENT_RETRIES_NUMBER);
  table.close();
  connection.close();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that stale cache updates don't override newer cached values.
 */
@Test public void testCacheSeqNums() throws Exception {
  Table table=TEST_UTIL.createMultiRegionTable(TABLE_NAME2,FAM_NAM);
  Put put=new Put(ROW);
  put.addColumn(FAM_NAM,ROW,ROW);
  table.put(put);
  ConnectionImplementation conn=(ConnectionImplementation)TEST_UTIL.getConnection();
  HRegionLocation location=conn.getCachedLocation(TABLE_NAME2,ROW).getRegionLocation();
  assertNotNull(location);
  ServerName anySource=ServerName.valueOf(location.getHostname(),location.getPort() - 1,0L);
  int nextPort=location.getPort() + 1;
  conn.updateCachedLocation(location.getRegionInfo(),location.getServerName(),ServerName.valueOf("127.0.0.1",nextPort,0),location.getSeqNum() - 1);
  location=conn.getCachedLocation(TABLE_NAME2,ROW).getRegionLocation();
  Assert.assertEquals(nextPort,location.getPort());
  nextPort=location.getPort() + 1;
  conn.updateCachedLocation(location.getRegionInfo(),location.getServerName(),ServerName.valueOf("127.0.0.1",nextPort,0),location.getSeqNum() - 1);
  location=conn.getCachedLocation(TABLE_NAME2,ROW).getRegionLocation();
  Assert.assertEquals(nextPort,location.getPort());
  nextPort=location.getPort() + 1;
  conn.updateCachedLocation(location.getRegionInfo(),anySource,ServerName.valueOf("127.0.0.1",nextPort,0),location.getSeqNum() + 1);
  location=conn.getCachedLocation(TABLE_NAME2,ROW).getRegionLocation();
  Assert.assertEquals(nextPort,location.getPort());
  nextPort=location.getPort() + 1;
  conn.updateCachedLocation(location.getRegionInfo(),anySource,ServerName.valueOf("127.0.0.1",nextPort,0),location.getSeqNum() - 1);
  location=conn.getCachedLocation(TABLE_NAME2,ROW).getRegionLocation();
  Assert.assertEquals(nextPort - 1,location.getPort());
  table.close();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-17 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test(expected=RegionServerStoppedException.class) public void testClusterStatus() throws Exception {
  TableName tn=TableName.valueOf("testClusterStatus");
  byte[] cf="cf".getBytes();
  byte[] rk="rk1".getBytes();
  JVMClusterUtil.RegionServerThread rs=TEST_UTIL.getHBaseCluster().startRegionServer();
  rs.waitForServerOnline();
  final ServerName sn=rs.getRegionServer().getServerName();
  Table t=TEST_UTIL.createTable(tn,cf);
  TEST_UTIL.waitTableAvailable(tn);
  while (TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(1);
  }
  final ConnectionImplementation hci=(ConnectionImplementation)TEST_UTIL.getConnection();
  try (RegionLocator l=TEST_UTIL.getConnection().getRegionLocator(tn)){
    while (l.getRegionLocation(rk).getPort() != sn.getPort()) {
      TEST_UTIL.getHBaseAdmin().move(l.getRegionLocation(rk).getRegionInfo().getEncodedNameAsBytes(),Bytes.toBytes(sn.toString()));
      while (TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().isRegionsInTransition()) {
        Thread.sleep(1);
      }
      hci.clearRegionCache(tn);
    }
    Assert.assertNotNull(hci.clusterStatusListener);
    TEST_UTIL.assertRegionOnServer(l.getRegionLocation(rk).getRegionInfo(),sn,20000);
  }
   Put p1=new Put(rk);
  p1.addColumn(cf,"qual".getBytes(),"val".getBytes());
  t.put(p1);
  rs.getRegionServer().abort("I'm dead");
  TEST_UTIL.waitFor(40000,1000,true,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return TEST_UTIL.getHBaseCluster().getMaster().getServerManager().getDeadServers().isDeadServer(sn);
    }
  }
);
  TEST_UTIL.waitFor(40000,1000,true,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return hci.clusterStatusListener.isDeadServer(sn);
    }
  }
);
  t.close();
  hci.getClient(sn);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the connection to the dead server is cut immediately when we receive the
 * notification.
 * @throws Exception
 */
@Test public void testConnectionCut() throws Exception {
  TableName tableName=TableName.valueOf("HCM-testConnectionCut");
  TEST_UTIL.createTable(tableName,FAM_NAM).close();
  boolean previousBalance=TEST_UTIL.getHBaseAdmin().setBalancerRunning(false,true);
  Configuration c2=new Configuration(TEST_UTIL.getConfiguration());
  c2.set(HConstants.HBASE_CLIENT_INSTANCE_ID,String.valueOf(-1));
  c2.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,0);
  c2.setInt(HConstants.HBASE_RPC_TIMEOUT_KEY,30 * 1000);
  final Connection connection=ConnectionFactory.createConnection(c2);
  final Table table=connection.getTable(tableName);
  Put p=new Put(FAM_NAM);
  p.addColumn(FAM_NAM,FAM_NAM,FAM_NAM);
  table.put(p);
  final ConnectionImplementation hci=(ConnectionImplementation)connection;
  final HRegionLocation loc;
  try (RegionLocator rl=connection.getRegionLocator(tableName)){
    loc=rl.getRegionLocation(FAM_NAM);
  }
   Get get=new Get(FAM_NAM);
  Assert.assertNotNull(table.get(get));
  get=new Get(FAM_NAM);
  get.setFilter(new BlockingFilter());
  Thread t=new Thread(){
    @Override public void run(){
synchronized (syncBlockingFilter) {
        try {
          syncBlockingFilter.wait();
        }
 catch (        InterruptedException e) {
          throw new RuntimeException(e);
        }
      }
      hci.clusterStatusListener.deadServerHandler.newDead(loc.getServerName());
    }
  }
;
  t.start();
  try {
    table.get(get);
    Assert.fail();
  }
 catch (  IOException expected) {
    LOG.debug("Received: " + expected);
    Assert.assertFalse(expected instanceof SocketTimeoutException);
    Assert.assertFalse(syncBlockingFilter.get());
  }
 finally {
    syncBlockingFilter.set(true);
    t.join();
    TEST_UTIL.getHBaseAdmin().setBalancerRunning(previousBalance,true);
  }
  table.close();
  connection.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMulti() throws Exception {
  Table table=TEST_UTIL.createMultiRegionTable(TABLE_NAME3,FAM_NAM);
  try {
    ConnectionImplementation conn=(ConnectionImplementation)TEST_UTIL.getConnection();
    conn.clearRegionCache(TABLE_NAME3);
    Assert.assertEquals(0,conn.getNumberOfCachedRegionLocations(TABLE_NAME3));
    TEST_UTIL.getHBaseAdmin().setBalancerRunning(false,false);
    HMaster master=TEST_UTIL.getMiniHBaseCluster().getMaster();
    while (master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
      Thread.sleep(1);
    }
    Put put=new Put(ROW_X);
    put.addColumn(FAM_NAM,ROW_X,ROW_X);
    table.put(put);
    HRegionLocation toMove=conn.getCachedLocation(TABLE_NAME3,ROW_X).getRegionLocation();
    byte[] regionName=toMove.getRegionInfo().getRegionName();
    byte[] encodedRegionNameBytes=toMove.getRegionInfo().getEncodedNameAsBytes();
    int curServerId=TEST_UTIL.getHBaseCluster().getServerWith(regionName);
    int destServerId=(curServerId == 0 ? 1 : 0);
    HRegionServer curServer=TEST_UTIL.getHBaseCluster().getRegionServer(curServerId);
    HRegionServer destServer=TEST_UTIL.getHBaseCluster().getRegionServer(destServerId);
    ServerName destServerName=destServer.getServerName();
    List<Region> regions=curServer.getOnlineRegions(TABLE_NAME3);
    byte[] otherRow=null;
    for (    Region region : regions) {
      if (!region.getRegionInfo().getEncodedName().equals(toMove.getRegionInfo().getEncodedName()) && Bytes.BYTES_COMPARATOR.compare(region.getRegionInfo().getStartKey(),ROW_X) < 0) {
        otherRow=region.getRegionInfo().getStartKey();
        break;
      }
    }
    assertNotNull(otherRow);
    if (otherRow.length <= 0)     otherRow=Bytes.toBytes("aaa");
    Put put2=new Put(otherRow);
    put2.addColumn(FAM_NAM,otherRow,otherRow);
    table.put(put2);
    Assert.assertTrue(curServer != destServer);
    Assert.assertNotEquals(curServer.getServerName(),destServer.getServerName());
    Assert.assertNotEquals(toMove.getPort(),destServerName.getPort());
    Assert.assertNotNull(curServer.getOnlineRegion(regionName));
    Assert.assertNull(destServer.getOnlineRegion(regionName));
    Assert.assertFalse(TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().isRegionsInTransition());
    LOG.info("Move starting region=" + toMove.getRegionInfo().getRegionNameAsString());
    TEST_UTIL.getHBaseAdmin().move(toMove.getRegionInfo().getEncodedNameAsBytes(),destServerName.getServerName().getBytes());
    while (destServer.getOnlineRegion(regionName) == null || destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes) || master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
      Thread.sleep(1);
    }
    LOG.info("Move finished for region=" + toMove.getRegionInfo().getRegionNameAsString());
    Assert.assertNull(curServer.getOnlineRegion(regionName));
    Assert.assertNotNull(destServer.getOnlineRegion(regionName));
    Assert.assertFalse(destServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
    Assert.assertFalse(curServer.getRegionsInTransitionInRS().containsKey(encodedRegionNameBytes));
    Assert.assertFalse(conn.getCachedLocation(TABLE_NAME3,ROW_X).getRegionLocation().getPort() == destServerName.getPort());
    final int prevNumRetriesVal=setNumTries(conn,2);
    Put put3=new Put(ROW_X);
    put3.addColumn(FAM_NAM,ROW_X,ROW_X);
    Put put4=new Put(otherRow);
    put4.addColumn(FAM_NAM,otherRow,otherRow);
    ArrayList<Put> actions=Lists.newArrayList(put4,put3);
    table.batch(actions,null);
    setNumTries(conn,prevNumRetriesVal);
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestLeaseRenewal </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeaseRenewal() throws Exception {
  HTable table=TEST_UTIL.createTable(TableName.valueOf("testLeaseRenewal"),FAMILY);
  Put p=new Put(ROW_BYTES);
  p.addColumn(FAMILY,COL_QUAL,VAL_BYTES);
  table.put(p);
  p=new Put(ANOTHERROW);
  p.addColumn(FAMILY,COL_QUAL,VAL_BYTES);
  table.put(p);
  Scan s=new Scan();
  s.setCaching(1);
  ResultScanner rs=table.getScanner(s);
  assertTrue(rs.renewLease());
  assertTrue(Arrays.equals(rs.next().getRow(),ANOTHERROW));
  Thread.sleep(leaseTimeout / 2);
  assertTrue(rs.renewLease());
  Thread.sleep(leaseTimeout / 2);
  assertTrue(rs.renewLease());
  Thread.sleep(leaseTimeout / 2);
  assertTrue(rs.renewLease());
  assertTrue(Arrays.equals(rs.next().getRow(),ROW_BYTES));
  assertTrue(rs.renewLease());
  assertNull(rs.next());
  assertFalse(rs.renewLease());
  rs.close();
  table.close();
  MetricsHBaseServerSource serverSource=TEST_UTIL.getMiniHBaseCluster().getRegionServer(0).getRpcServer().getMetrics().getMetricsSource();
  HELPER.assertCounter("exceptions.OutOfOrderScannerNextException",0,serverSource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMultiParallel </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testBatchWithGet() throws Exception {
  LOG.info("test=testBatchWithGet");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  table.batch(puts,null);
  List<Row> gets=new ArrayList<Row>();
  for (  byte[] k : KEYS) {
    Get get=new Get(k);
    get.addColumn(BYTES_FAMILY,QUALIFIER);
    gets.add(get);
  }
  Result[] multiRes=new Result[gets.size()];
  table.batch(gets,multiRes);
  List<Result> singleRes=new ArrayList<Result>();
  for (  Row get : gets) {
    singleRes.add(table.get((Get)get));
  }
  Assert.assertEquals(singleRes.size(),multiRes.length);
  for (int i=0; i < singleRes.size(); i++) {
    Assert.assertTrue(singleRes.get(i).containsColumn(BYTES_FAMILY,QUALIFIER));
    Cell[] singleKvs=singleRes.get(i).rawCells();
    Cell[] multiKvs=multiRes[i].rawCells();
    for (int j=0; j < singleKvs.length; j++) {
      Assert.assertEquals(singleKvs[j],multiKvs[j]);
      Assert.assertEquals(0,Bytes.compareTo(CellUtil.cloneValue(singleKvs[j]),CellUtil.cloneValue(multiKvs[j])));
    }
  }
  table.close();
}

</code></pre>

<br>
<pre class="type-4 type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadFam() throws Exception {
  LOG.info("test=testBadFam");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Row> actions=new ArrayList<Row>();
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(Bytes.toBytes("bad_family"),Bytes.toBytes("qual"),Bytes.toBytes("value"));
  actions.add(p);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(BYTES_FAMILY,Bytes.toBytes("qual"),Bytes.toBytes("value"));
  actions.add(p);
  Object[] r=new Object[actions.size()];
  try {
    table.batch(actions,r);
    fail();
  }
 catch (  RetriesExhaustedWithDetailsException ex) {
    LOG.debug(ex);
    assertFalse(ex.mayHaveClusterIssues());
  }
  assertEquals(2,r.length);
  assertTrue(r[0] instanceof Throwable);
  assertTrue(r[1] instanceof Result);
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestOperation </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the client Operations' JSON encoding to ensure that produced JSON is
 * parseable and that the details are present and not corrupted.
 * @throws IOException
 */
@Test public void testOperationJSON() throws IOException {
  Scan scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  String json=scan.toJSON();
  Map<String,Object> parsedJSON=mapper.readValue(json,HashMap.class);
  assertEquals("startRow incorrect in Scan.toJSON()",Bytes.toStringBinary(ROW),parsedJSON.get("startRow"));
  List familyInfo=(List)((Map)parsedJSON.get("families")).get(Bytes.toStringBinary(FAMILY));
  assertNotNull("Family absent in Scan.toJSON()",familyInfo);
  assertEquals("Qualifier absent in Scan.toJSON()",1,familyInfo.size());
  assertEquals("Qualifier incorrect in Scan.toJSON()",Bytes.toStringBinary(QUALIFIER),familyInfo.get(0));
  Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  json=get.toJSON();
  parsedJSON=mapper.readValue(json,HashMap.class);
  assertEquals("row incorrect in Get.toJSON()",Bytes.toStringBinary(ROW),parsedJSON.get("row"));
  familyInfo=(List)((Map)parsedJSON.get("families")).get(Bytes.toStringBinary(FAMILY));
  assertNotNull("Family absent in Get.toJSON()",familyInfo);
  assertEquals("Qualifier absent in Get.toJSON()",1,familyInfo.size());
  assertEquals("Qualifier incorrect in Get.toJSON()",Bytes.toStringBinary(QUALIFIER),familyInfo.get(0));
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,VALUE);
  json=put.toJSON();
  parsedJSON=mapper.readValue(json,HashMap.class);
  assertEquals("row absent in Put.toJSON()",Bytes.toStringBinary(ROW),parsedJSON.get("row"));
  familyInfo=(List)((Map)parsedJSON.get("families")).get(Bytes.toStringBinary(FAMILY));
  assertNotNull("Family absent in Put.toJSON()",familyInfo);
  assertEquals("KeyValue absent in Put.toJSON()",1,familyInfo.size());
  Map kvMap=(Map)familyInfo.get(0);
  assertEquals("Qualifier incorrect in Put.toJSON()",Bytes.toStringBinary(QUALIFIER),kvMap.get("qualifier"));
  assertEquals("Value length incorrect in Put.toJSON()",VALUE.length,kvMap.get("vlen"));
  Delete delete=new Delete(ROW);
  delete.addColumn(FAMILY,QUALIFIER);
  json=delete.toJSON();
  parsedJSON=mapper.readValue(json,HashMap.class);
  assertEquals("row absent in Delete.toJSON()",Bytes.toStringBinary(ROW),parsedJSON.get("row"));
  familyInfo=(List)((Map)parsedJSON.get("families")).get(Bytes.toStringBinary(FAMILY));
  assertNotNull("Family absent in Delete.toJSON()",familyInfo);
  assertEquals("KeyValue absent in Delete.toJSON()",1,familyInfo.size());
  kvMap=(Map)familyInfo.get(0);
  assertEquals("Qualifier incorrect in Delete.toJSON()",Bytes.toStringBinary(QUALIFIER),kvMap.get("qualifier"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestProcedureFuture </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the spin loop for the procedure running works.
 */
@Test(timeout=60000) public void testWithProcIdAndSpinning() throws Exception {
  final AtomicInteger spinCount=new AtomicInteger(0);
  HBaseAdmin admin=Mockito.mock(HBaseAdmin.class);
  TestFuture f=new TestFuture(admin,100L){
    @Override protected GetProcedureResultResponse getProcedureResult(    final GetProcedureResultRequest request) throws IOException {
      boolean done=spinCount.incrementAndGet() >= 10;
      return GetProcedureResultResponse.newBuilder().setState(done ? GetProcedureResultResponse.State.FINISHED : GetProcedureResultResponse.State.RUNNING).build();
    }
  }
;
  f.get(1,TimeUnit.MINUTES);
  assertEquals(10,spinCount.get());
  assertTrue("expected convertResult() to be called",f.wasConvertResultCalled());
  assertFalse("unexpected waitOperationResult() called",f.wasWaitOperationResultCalled());
  assertTrue("expected postOperationResult() to be called",f.wasPostOperationResultCalled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestPutDeleteEtcCellIteration </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementIteration() throws IOException {
  Increment increment=new Increment(ROW);
  for (int i=0; i < COUNT; i++) {
    byte[] bytes=Bytes.toBytes(i);
    increment.addColumn(bytes,bytes,i);
  }
  int index=0;
  for (CellScanner cellScanner=increment.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    int value=index;
    byte[] bytes=Bytes.toBytes(index++);
    KeyValue kv=(KeyValue)cell;
    assertTrue(Bytes.equals(CellUtil.cloneFamily(kv),bytes));
    long a=Bytes.toLong(CellUtil.cloneValue(kv));
    assertEquals(value,a);
  }
  assertEquals(COUNT,index);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendIteration() throws IOException {
  Append a=new Append(ROW);
  for (int i=0; i < COUNT; i++) {
    byte[] bytes=Bytes.toBytes(i);
    a.add(bytes,bytes,bytes);
  }
  int index=0;
  for (CellScanner cellScanner=a.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    byte[] bytes=Bytes.toBytes(index++);
    KeyValue kv=(KeyValue)cell;
    assertTrue(Bytes.equals(CellUtil.cloneFamily(kv),bytes));
    assertTrue(Bytes.equals(CellUtil.cloneValue(kv),bytes));
  }
  assertEquals(COUNT,index);
}

</code></pre>

<br>
<pre class="type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ConcurrentModificationException.class) public void testPutConcurrentModificationOnIteration() throws IOException {
  Put p=new Put(ROW);
  for (int i=0; i < COUNT; i++) {
    byte[] bytes=Bytes.toBytes(i);
    p.addColumn(bytes,bytes,TIMESTAMP,bytes);
  }
  int index=0;
  int trigger=3;
  for (CellScanner cellScanner=p.cellScanner(); cellScanner.advance(); ) {
    Cell cell=cellScanner.current();
    byte[] bytes=Bytes.toBytes(index++);
    if (trigger == 3)     p.addColumn(bytes,bytes,TIMESTAMP,bytes);
    cell.equals(new KeyValue(ROW,bytes,bytes,TIMESTAMP,bytes));
  }
  assertEquals(COUNT,index);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestReplicaWithCluster </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testChangeTable() throws Exception {
  HTableDescriptor hdt=HTU.createTableDescriptor("testChangeTable");
  hdt.setRegionReplication(NB_SERVERS);
  hdt.addCoprocessor(SlowMeCopro.class.getName());
  Table table=HTU.createTable(hdt,new byte[][]{f},null);
  Put p=new Put(row);
  p.addColumn(f,row,row);
  table.put(p);
  Get g=new Get(row);
  Result r=table.get(g);
  Assert.assertFalse(r.isStale());
  HTableDescriptor bHdt=HTU.getHBaseAdmin().getTableDescriptor(hdt.getTableName());
  HColumnDescriptor hcd=new HColumnDescriptor(row);
  hdt.addFamily(hcd);
  HTU.getHBaseAdmin().disableTable(hdt.getTableName());
  HTU.getHBaseAdmin().modifyTable(hdt.getTableName(),hdt);
  HTU.getHBaseAdmin().enableTable(hdt.getTableName());
  HTableDescriptor nHdt=HTU.getHBaseAdmin().getTableDescriptor(hdt.getTableName());
  Assert.assertEquals("fams=" + Arrays.toString(nHdt.getColumnFamilies()),bHdt.getColumnFamilies().length + 1,nHdt.getColumnFamilies().length);
  p=new Put(row);
  p.addColumn(row,row,row);
  table.put(p);
  g=new Get(row);
  r=table.get(g);
  Assert.assertFalse(r.isStale());
  try {
    SlowMeCopro.cdl.set(new CountDownLatch(1));
    g=new Get(row);
    g.setConsistency(Consistency.TIMELINE);
    r=table.get(g);
    Assert.assertTrue(r.isStale());
  }
  finally {
    SlowMeCopro.cdl.get().countDown();
    SlowMeCopro.sleepTime.set(0);
  }
  Admin admin=HTU.getHBaseAdmin();
  nHdt=admin.getTableDescriptor(hdt.getTableName());
  Assert.assertEquals("fams=" + Arrays.toString(nHdt.getColumnFamilies()),bHdt.getColumnFamilies().length + 1,nHdt.getColumnFamilies().length);
  admin.disableTable(hdt.getTableName());
  admin.deleteTable(hdt.getTableName());
  admin.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestRestoreSnapshotFromClient </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptedSnapshot() throws IOException, InterruptedException {
  SnapshotTestingUtils.corruptSnapshot(TEST_UTIL,Bytes.toString(snapshotName0));
  TableName cloneName=TableName.valueOf("corruptedClone-" + System.currentTimeMillis());
  try {
    admin.cloneSnapshot(snapshotName0,cloneName);
    fail("Expected CorruptedSnapshotException, got succeeded cloneSnapshot()");
  }
 catch (  CorruptedSnapshotException e) {
    assertFalse(admin.tableExists(cloneName));
  }
catch (  Exception e) {
    fail("Expected CorruptedSnapshotException got: " + e);
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestoreSchemaChange() throws Exception {
  Table table=TEST_UTIL.getConnection().getTable(tableName);
  admin.disableTable(tableName);
  admin.addColumnFamily(tableName,getTestRestoreSchemaChangeHCD());
  admin.enableTable(tableName);
  assertEquals(2,table.getTableDescriptor().getFamilies().size());
  HTableDescriptor htd=admin.getTableDescriptor(tableName);
  assertEquals(2,htd.getFamilies().size());
  SnapshotTestingUtils.loadData(TEST_UTIL,tableName,500,TEST_FAMILY2);
  long snapshot2Rows=snapshot1Rows + 500;
  assertEquals(snapshot2Rows,countRows(table));
  assertEquals(500,countRows(table,TEST_FAMILY2));
  Set<String> fsFamilies=getFamiliesFromFS(tableName);
  assertEquals(2,fsFamilies.size());
  admin.disableTable(tableName);
  admin.snapshot(snapshotName2,tableName);
  admin.restoreSnapshot(snapshotName0);
  admin.enableTable(tableName);
  assertEquals(1,table.getTableDescriptor().getFamilies().size());
  try {
    countRows(table,TEST_FAMILY2);
    fail("family '" + Bytes.toString(TEST_FAMILY2) + "' should not exists");
  }
 catch (  NoSuchColumnFamilyException e) {
  }
  assertEquals(snapshot0Rows,countRows(table));
  htd=admin.getTableDescriptor(tableName);
  assertEquals(1,htd.getFamilies().size());
  fsFamilies=getFamiliesFromFS(tableName);
  assertEquals(1,fsFamilies.size());
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName2);
  admin.enableTable(tableName);
  htd=admin.getTableDescriptor(tableName);
  assertEquals(2,htd.getFamilies().size());
  assertEquals(2,table.getTableDescriptor().getFamilies().size());
  assertEquals(500,countRows(table,TEST_FAMILY2));
  assertEquals(snapshot2Rows,countRows(table));
  fsFamilies=getFamiliesFromFS(tableName);
  assertEquals(2,fsFamilies.size());
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestRpcControllerFactory </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFallbackToDefaultRpcControllerFactory(){
  Configuration conf=new Configuration(UTIL.getConfiguration());
  conf.set(RpcControllerFactory.CUSTOM_CONTROLLER_CONF_KEY,"foo.bar.Baz");
  RpcControllerFactory factory=RpcControllerFactory.instantiate(conf);
  assertNotNull(factory);
  assertEquals(factory.getClass(),RpcControllerFactory.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestScan </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanAttributes(){
  Scan scan=new Scan();
  Assert.assertTrue(scan.getAttributesMap().isEmpty());
  Assert.assertNull(scan.getAttribute("absent"));
  scan.setAttribute("absent",null);
  Assert.assertTrue(scan.getAttributesMap().isEmpty());
  Assert.assertNull(scan.getAttribute("absent"));
  scan.setAttribute("attribute1",Bytes.toBytes("value1"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),scan.getAttribute("attribute1")));
  Assert.assertEquals(1,scan.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),scan.getAttributesMap().get("attribute1")));
  scan.setAttribute("attribute1",Bytes.toBytes("value12"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),scan.getAttribute("attribute1")));
  Assert.assertEquals(1,scan.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value12"),scan.getAttributesMap().get("attribute1")));
  scan.setAttribute("attribute2",Bytes.toBytes("value2"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),scan.getAttribute("attribute2")));
  Assert.assertEquals(2,scan.getAttributesMap().size());
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),scan.getAttributesMap().get("attribute2")));
  scan.setAttribute("attribute2",null);
  Assert.assertNull(scan.getAttribute("attribute2"));
  Assert.assertEquals(1,scan.getAttributesMap().size());
  Assert.assertNull(scan.getAttributesMap().get("attribute2"));
  scan.setAttribute("attribute2",null);
  Assert.assertNull(scan.getAttribute("attribute2"));
  Assert.assertEquals(1,scan.getAttributesMap().size());
  Assert.assertNull(scan.getAttributesMap().get("attribute2"));
  scan.setAttribute("attribute1",null);
  Assert.assertNull(scan.getAttribute("attribute1"));
  Assert.assertTrue(scan.getAttributesMap().isEmpty());
  Assert.assertNull(scan.getAttributesMap().get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAttributesSerialization() throws IOException {
  Scan scan=new Scan();
  scan.setAttribute("attribute1",Bytes.toBytes("value1"));
  scan.setAttribute("attribute2",Bytes.toBytes("value2"));
  scan.setAttribute("attribute3",Bytes.toBytes("value3"));
  ClientProtos.Scan scanProto=ProtobufUtil.toScan(scan);
  Scan scan2=ProtobufUtil.toScan(scanProto);
  Assert.assertNull(scan2.getAttribute("absent"));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value1"),scan2.getAttribute("attribute1")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value2"),scan2.getAttribute("attribute2")));
  Assert.assertTrue(Arrays.equals(Bytes.toBytes("value3"),scan2.getAttribute("attribute3")));
  Assert.assertEquals(3,scan2.getAttributesMap().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestSnapshotFromClient </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testListTableSnapshots() throws Exception {
  Admin admin=null;
  TableName tableName2=TableName.valueOf("testListTableSnapshots");
  try {
    admin=UTIL.getHBaseAdmin();
    HTableDescriptor htd=new HTableDescriptor(tableName2);
    UTIL.createTable(htd,new byte[][]{TEST_FAM},UTIL.getConfiguration());
    String table1Snapshot1="Table1Snapshot1";
    admin.snapshot(table1Snapshot1,TABLE_NAME);
    LOG.debug("Snapshot1 completed.");
    String table1Snapshot2="Table1Snapshot2";
    admin.snapshot(table1Snapshot2,TABLE_NAME);
    LOG.debug("Snapshot2 completed.");
    String table2Snapshot1="Table2Snapshot1";
    admin.snapshot(Bytes.toBytes(table2Snapshot1),tableName2);
    LOG.debug(table2Snapshot1 + " completed.");
    List<SnapshotDescription> listTableSnapshots=admin.listTableSnapshots("test.*",".*");
    List<String> listTableSnapshotNames=new ArrayList<String>();
    assertEquals(3,listTableSnapshots.size());
    for (    SnapshotDescription s : listTableSnapshots) {
      listTableSnapshotNames.add(s.getName());
    }
    assertTrue(listTableSnapshotNames.contains(table1Snapshot1));
    assertTrue(listTableSnapshotNames.contains(table1Snapshot2));
    assertTrue(listTableSnapshotNames.contains(table2Snapshot1));
  }
  finally {
    if (admin != null) {
      try {
        admin.deleteSnapshots("Table.*");
      }
 catch (      SnapshotDoesNotExistException ignore) {
      }
      if (admin.tableExists(tableName2)) {
        UTIL.deleteTable(tableName2);
      }
      admin.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testListTableSnapshotsWithRegex() throws Exception {
  Admin admin=null;
  try {
    admin=UTIL.getHBaseAdmin();
    String table1Snapshot1="Table1Snapshot1";
    admin.snapshot(table1Snapshot1,TABLE_NAME);
    LOG.debug("Snapshot1 completed.");
    String table1Snapshot2="Table1Snapshot2";
    admin.snapshot(table1Snapshot2,TABLE_NAME);
    LOG.debug("Snapshot2 completed.");
    String table2Snapshot1="Table2Snapshot1";
    admin.snapshot(Bytes.toBytes(table2Snapshot1),TABLE_NAME);
    LOG.debug(table2Snapshot1 + " completed.");
    List<SnapshotDescription> listTableSnapshots=admin.listTableSnapshots("test.*","Table1.*");
    List<String> listTableSnapshotNames=new ArrayList<String>();
    assertEquals(2,listTableSnapshots.size());
    for (    SnapshotDescription s : listTableSnapshots) {
      listTableSnapshotNames.add(s.getName());
    }
    assertTrue(listTableSnapshotNames.contains(table1Snapshot1));
    assertTrue(listTableSnapshotNames.contains(table1Snapshot2));
    assertFalse(listTableSnapshotNames.contains(table2Snapshot1));
  }
  finally {
    if (admin != null) {
      try {
        admin.deleteSnapshots("Table.*");
      }
 catch (      SnapshotDoesNotExistException ignore) {
      }
      admin.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestTimestampsFilter </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColumns() throws Exception {
  byte[] TABLE=Bytes.toBytes("testTimestampsFilterMultiColumns");
  byte[] FAMILY=Bytes.toBytes("event_log");
  byte[][] FAMILIES=new byte[][]{FAMILY};
  Table ht=TEST_UTIL.createTable(TableName.valueOf(TABLE),FAMILIES,Integer.MAX_VALUE);
  Put p=new Put(Bytes.toBytes("row"));
  p.addColumn(FAMILY,Bytes.toBytes("column0"),(long)3,Bytes.toBytes("value0-3"));
  p.addColumn(FAMILY,Bytes.toBytes("column1"),(long)3,Bytes.toBytes("value1-3"));
  p.addColumn(FAMILY,Bytes.toBytes("column2"),(long)1,Bytes.toBytes("value2-1"));
  p.addColumn(FAMILY,Bytes.toBytes("column2"),(long)2,Bytes.toBytes("value2-2"));
  p.addColumn(FAMILY,Bytes.toBytes("column2"),(long)3,Bytes.toBytes("value2-3"));
  p.addColumn(FAMILY,Bytes.toBytes("column3"),(long)2,Bytes.toBytes("value3-2"));
  p.addColumn(FAMILY,Bytes.toBytes("column4"),(long)1,Bytes.toBytes("value4-1"));
  p.addColumn(FAMILY,Bytes.toBytes("column4"),(long)2,Bytes.toBytes("value4-2"));
  p.addColumn(FAMILY,Bytes.toBytes("column4"),(long)3,Bytes.toBytes("value4-3"));
  ht.put(p);
  ArrayList<Long> timestamps=new ArrayList<Long>();
  timestamps.add(new Long(3));
  TimestampsFilter filter=new TimestampsFilter(timestamps);
  Get g=new Get(Bytes.toBytes("row"));
  g.setFilter(filter);
  g.setMaxVersions();
  g.addColumn(FAMILY,Bytes.toBytes("column2"));
  g.addColumn(FAMILY,Bytes.toBytes("column4"));
  Result result=ht.get(g);
  for (  Cell kv : result.listCells()) {
    System.out.println("found row " + Bytes.toString(CellUtil.cloneRow(kv)) + ", column "+ Bytes.toString(CellUtil.cloneQualifier(kv))+ ", value "+ Bytes.toString(CellUtil.cloneValue(kv)));
  }
  assertEquals(result.listCells().size(),2);
  assertTrue(CellUtil.matchingValue(result.listCells().get(0),Bytes.toBytes("value2-3")));
  assertTrue(CellUtil.matchingValue(result.listCells().get(1),Bytes.toBytes("value4-3")));
  ht.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.replication.TestReplicationAdmin </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * basic checks that when we add a peer that it is enabled, and that we can disable
 * @throws Exception
 */
@Test public void testEnableDisable() throws Exception {
  admin.addPeer(ID_ONE,KEY_ONE);
  assertEquals(1,admin.getPeersCount());
  assertTrue(admin.getPeerState(ID_ONE));
  admin.disablePeer(ID_ONE);
  assertFalse(admin.getPeerState(ID_ONE));
  try {
    admin.getPeerState(ID_SECOND);
  }
 catch (  IllegalArgumentException iae) {
  }
  admin.removePeer(ID_ONE);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendPeerTableCFs() throws Exception {
  admin.addPeer(ID_ONE,KEY_ONE);
  admin.appendPeerTableCFs(ID_ONE,"t1");
  assertEquals("t1",admin.getPeerTableCFs(ID_ONE));
  admin.appendPeerTableCFs(ID_ONE,"t2");
  String peerTablesOne=admin.getPeerTableCFs(ID_ONE);
  assertTrue("Should contain t1",peerTablesOne.contains("t1"));
  assertTrue("Should contain t2",peerTablesOne.contains("t2"));
  assertTrue("Should contain ; as the seperator",peerTablesOne.contains(";"));
  admin.appendPeerTableCFs(ID_ONE,"t3:f1");
  String peerTablesTwo=admin.getPeerTableCFs(ID_ONE);
  assertTrue("Should contain t1",peerTablesTwo.contains("t1"));
  assertTrue("Should contain t2",peerTablesTwo.contains("t2"));
  assertTrue("Should contain t3:f1",peerTablesTwo.contains("t3:f1"));
  assertTrue("Should contain ; as the seperator",peerTablesTwo.contains(";"));
  admin.removePeer(ID_ONE);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the peer configuration used by ReplicationAdmin contains all
 * the peer's properties.
 */
@Test public void testPeerConfig() throws Exception {
  ReplicationPeerConfig config=new ReplicationPeerConfig();
  config.setClusterKey(KEY_ONE);
  config.getConfiguration().put("key1","value1");
  config.getConfiguration().put("key2","value2");
  admin.addPeer(ID_ONE,config,null);
  List<ReplicationPeer> peers=admin.listValidReplicationPeers();
  assertEquals(1,peers.size());
  ReplicationPeer peerOne=peers.get(0);
  assertNotNull(peerOne);
  assertEquals("value1",peerOne.getConfiguration().get("key1"));
  assertEquals("value2",peerOne.getConfiguration().get("key2"));
  admin.removePeer(ID_ONE);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPeerWithUnDeletedQueues() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(conf,"Test HBaseAdmin",null);
  ReplicationQueues repQueues=ReplicationFactory.getReplicationQueues(zkw,conf,null);
  repQueues.init("server1");
  repQueues.addLog(ID_ONE,"file1");
  try {
    admin.addPeer(ID_ONE,KEY_ONE);
    fail();
  }
 catch (  ReplicationException e) {
  }
  repQueues.removeQueue(ID_ONE);
  assertEquals(0,repQueues.getAllQueues().size());
  repQueues.addLog(ID_ONE + "-server2","file1");
  try {
    admin.addPeer(ID_ONE,KEY_ONE);
    fail();
  }
 catch (  ReplicationException e) {
  }
  repQueues.removeAllQueues();
  zkw.close();
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemovePeerTableCFs() throws Exception {
  admin.addPeer(ID_ONE,KEY_ONE);
  try {
    admin.removePeerTableCFs(ID_ONE,"t3");
    assertTrue(false);
  }
 catch (  ReplicationException e) {
  }
  assertEquals("",admin.getPeerTableCFs(ID_ONE));
  admin.setPeerTableCFs(ID_ONE,"t1;t2:cf1");
  try {
    admin.removePeerTableCFs(ID_ONE,"t3");
    assertTrue(false);
  }
 catch (  ReplicationException e) {
  }
  assertEquals("t1;t2:cf1",admin.getPeerTableCFs(ID_ONE));
  try {
    admin.removePeerTableCFs(ID_ONE,"t1:f1");
    assertTrue(false);
  }
 catch (  ReplicationException e) {
  }
  admin.removePeerTableCFs(ID_ONE,"t1");
  assertEquals("t2:cf1",admin.getPeerTableCFs(ID_ONE));
  try {
    admin.removePeerTableCFs(ID_ONE,"t2");
    assertTrue(false);
  }
 catch (  ReplicationException e) {
  }
  admin.removePeerTableCFs(ID_ONE,"t2:cf1");
  assertEquals("",admin.getPeerTableCFs(ID_ONE));
  admin.removePeer(ID_ONE);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple testing of adding and removing peers, basically shows that
 * all interactions with ZK work
 * @throws Exception
 */
@Test public void testAddRemovePeer() throws Exception {
  admin.addPeer(ID_ONE,KEY_ONE);
  try {
    admin.addPeer(ID_ONE,KEY_ONE);
  }
 catch (  IllegalArgumentException iae) {
  }
  assertEquals(1,admin.getPeersCount());
  try {
    admin.removePeer(ID_SECOND);
    fail();
  }
 catch (  IllegalArgumentException iae) {
  }
  assertEquals(1,admin.getPeersCount());
  try {
    admin.addPeer(ID_SECOND,KEY_SECOND);
  }
 catch (  IllegalStateException iae) {
    fail();
  }
  assertEquals(2,admin.getPeersCount());
  admin.removePeer(ID_ONE);
  assertEquals(1,admin.getPeersCount());
  admin.removePeer(ID_SECOND);
  assertEquals(0,admin.getPeersCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.replication.TestReplicationAdminWithClusters </h4><pre class="type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testEnableReplicationWhenTableDescriptorIsNotSameInClusters() throws Exception {
  HTableDescriptor table=admin2.getTableDescriptor(tableName);
  HColumnDescriptor f=new HColumnDescriptor("newFamily");
  table.addFamily(f);
  admin2.disableTable(tableName);
  admin2.modifyTable(tableName,table);
  admin2.enableTable(tableName);
  try {
    adminExt.enableTableRep(tableName);
    fail("Exception should be thrown if table descriptors in the clusters are not same.");
  }
 catch (  RuntimeException ignored) {
  }
  admin1.disableTable(tableName);
  admin1.modifyTable(tableName,table);
  admin1.enableTable(tableName);
  adminExt.enableTableRep(tableName);
  table=admin1.getTableDescriptor(tableName);
  for (  HColumnDescriptor fam : table.getColumnFamilies()) {
    assertEquals(fam.getScope(),HConstants.REPLICATION_SCOPE_GLOBAL);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.TestCellCodec </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOne() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  Codec codec=new CellCodec();
  Codec.Encoder encoder=codec.getEncoder(dos);
  final KeyValue kv=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("v"));
  kv.setSequenceId(Long.MAX_VALUE);
  encoder.write(kv);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=codec.getDecoder(dis);
  assertTrue(decoder.advance());
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThree() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  Codec codec=new CellCodec();
  Codec.Encoder encoder=codec.getEncoder(dos);
  final KeyValue kv1=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("1"),Bytes.toBytes("1"));
  final KeyValue kv2=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("2"),Bytes.toBytes("2"));
  final KeyValue kv3=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("3"),Bytes.toBytes("3"));
  encoder.write(kv1);
  encoder.write(kv2);
  encoder.write(kv3);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=codec.getDecoder(dis);
  assertTrue(decoder.advance());
  Cell c=decoder.current();
  assertTrue(CellUtil.equals(c,kv1));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv2));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv3));
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyWorks() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  Codec codec=new CellCodec();
  Codec.Encoder encoder=codec.getEncoder(dos);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  assertEquals(0,offset);
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=codec.getDecoder(dis);
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(0,cis.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.TestCellCodecWithTags </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCellWithTag() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  Codec codec=new CellCodecWithTags();
  Codec.Encoder encoder=codec.getEncoder(dos);
  final Cell cell1=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("1"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("1"),new Tag[]{new ArrayBackedTag((byte)1,Bytes.toBytes("teststring1")),new ArrayBackedTag((byte)2,Bytes.toBytes("teststring2"))});
  final Cell cell2=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("2"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("2"),new Tag[]{new ArrayBackedTag((byte)1,Bytes.toBytes("teststring3"))});
  final Cell cell3=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("3"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("3"),new Tag[]{new ArrayBackedTag((byte)2,Bytes.toBytes("teststring4")),new ArrayBackedTag((byte)2,Bytes.toBytes("teststring5")),new ArrayBackedTag((byte)1,Bytes.toBytes("teststring6"))});
  encoder.write(cell1);
  encoder.write(cell2);
  encoder.write(cell3);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=codec.getDecoder(dis);
  assertTrue(decoder.advance());
  Cell c=decoder.current();
  assertTrue(CellUtil.equals(c,cell1));
  List<Tag> tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(2,tags.size());
  Tag tag=tags.get(0);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring1"),TagUtil.cloneValue(tag)));
  tag=tags.get(1);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring2"),TagUtil.cloneValue(tag)));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,cell2));
  tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(1,tags.size());
  tag=tags.get(0);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring3"),TagUtil.cloneValue(tag)));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,cell3));
  tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(3,tags.size());
  tag=tags.get(0);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring4"),TagUtil.cloneValue(tag)));
  tag=tags.get(1);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring5"),TagUtil.cloneValue(tag)));
  tag=tags.get(2);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring6"),TagUtil.cloneValue(tag)));
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.TestCellMessageCodec </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyWorks() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  MessageCodec cmc=new MessageCodec();
  Codec.Encoder encoder=cmc.getEncoder(dos);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  assertEquals(0,offset);
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=cmc.getDecoder(dis);
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(0,cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThree() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  MessageCodec cmc=new MessageCodec();
  Codec.Encoder encoder=cmc.getEncoder(dos);
  final KeyValue kv1=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("1"),Bytes.toBytes("1"));
  final KeyValue kv2=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("2"),Bytes.toBytes("2"));
  final KeyValue kv3=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("3"),Bytes.toBytes("3"));
  encoder.write(kv1);
  encoder.write(kv2);
  encoder.write(kv3);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=cmc.getDecoder(dis);
  assertTrue(decoder.advance());
  Cell c=decoder.current();
  assertTrue(CellUtil.equals(c,kv1));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv2));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv3));
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOne() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  MessageCodec cmc=new MessageCodec();
  Codec.Encoder encoder=cmc.getEncoder(dos);
  final KeyValue kv=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("v"));
  encoder.write(kv);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=cmc.getDecoder(dis);
  assertTrue(decoder.advance());
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.TestKeyValueCodec </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOne() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  KeyValueCodec kvc=new KeyValueCodec();
  Codec.Encoder encoder=kvc.getEncoder(dos);
  final KeyValue kv=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("v"));
  final long length=kv.getLength() + Bytes.SIZEOF_INT;
  encoder.write(kv);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  assertEquals(length,offset);
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=kvc.getDecoder(dis);
  assertTrue(decoder.advance());
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(length,cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThree() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  KeyValueCodec kvc=new KeyValueCodec();
  Codec.Encoder encoder=kvc.getEncoder(dos);
  final KeyValue kv1=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("1"),Bytes.toBytes("1"));
  final KeyValue kv2=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("2"),Bytes.toBytes("2"));
  final KeyValue kv3=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("3"),Bytes.toBytes("3"));
  final long length=kv1.getLength() + Bytes.SIZEOF_INT;
  encoder.write(kv1);
  encoder.write(kv2);
  encoder.write(kv3);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  assertEquals(length * 3,offset);
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=kvc.getDecoder(dis);
  assertTrue(decoder.advance());
  KeyValue kv=(KeyValue)decoder.current();
  assertTrue(kv1.equals(kv));
  assertTrue(decoder.advance());
  kv=(KeyValue)decoder.current();
  assertTrue(kv2.equals(kv));
  assertTrue(decoder.advance());
  kv=(KeyValue)decoder.current();
  assertTrue(kv3.equals(kv));
  assertFalse(decoder.advance());
  dis.close();
  assertEquals((length * 3),cis.getCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyWorks() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  KeyValueCodec kvc=new KeyValueCodec();
  Codec.Encoder encoder=kvc.getEncoder(dos);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  assertEquals(0,offset);
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=kvc.getDecoder(dis);
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(0,cis.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.TestKeyValueCodecWithTags </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyValueWithTag() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CountingOutputStream cos=new CountingOutputStream(baos);
  DataOutputStream dos=new DataOutputStream(cos);
  Codec codec=new KeyValueCodecWithTags();
  Codec.Encoder encoder=codec.getEncoder(dos);
  final KeyValue kv1=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("1"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("1"),new Tag[]{new ArrayBackedTag((byte)1,Bytes.toBytes("teststring1")),new ArrayBackedTag((byte)2,Bytes.toBytes("teststring2"))});
  final KeyValue kv2=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("2"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("2"),new Tag[]{new ArrayBackedTag((byte)1,Bytes.toBytes("teststring3"))});
  final KeyValue kv3=new KeyValue(Bytes.toBytes("r"),Bytes.toBytes("f"),Bytes.toBytes("3"),HConstants.LATEST_TIMESTAMP,Bytes.toBytes("3"),new Tag[]{new ArrayBackedTag((byte)2,Bytes.toBytes("teststring4")),new ArrayBackedTag((byte)2,Bytes.toBytes("teststring5")),new ArrayBackedTag((byte)1,Bytes.toBytes("teststring6"))});
  encoder.write(kv1);
  encoder.write(kv2);
  encoder.write(kv3);
  encoder.flush();
  dos.close();
  long offset=cos.getCount();
  CountingInputStream cis=new CountingInputStream(new ByteArrayInputStream(baos.toByteArray()));
  DataInputStream dis=new DataInputStream(cis);
  Codec.Decoder decoder=codec.getDecoder(dis);
  assertTrue(decoder.advance());
  Cell c=decoder.current();
  assertTrue(CellUtil.equals(c,kv1));
  List<Tag> tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(2,tags.size());
  Tag tag=tags.get(0);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring1"),TagUtil.cloneValue(tag)));
  tag=tags.get(1);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring2"),TagUtil.cloneValue(tag)));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv2));
  tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(1,tags.size());
  tag=tags.get(0);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring3"),TagUtil.cloneValue(tag)));
  assertTrue(decoder.advance());
  c=decoder.current();
  assertTrue(CellUtil.equals(c,kv3));
  tags=TagUtil.asList(c.getTagsArray(),c.getTagsOffset(),c.getTagsLength());
  assertEquals(3,tags.size());
  tag=tags.get(0);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring4"),TagUtil.cloneValue(tag)));
  tag=tags.get(1);
  assertEquals(2,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring5"),TagUtil.cloneValue(tag)));
  tag=tags.get(2);
  assertEquals(1,tag.getType());
  assertTrue(Bytes.equals(Bytes.toBytes("teststring6"),TagUtil.cloneValue(tag)));
  assertFalse(decoder.advance());
  dis.close();
  assertEquals(offset,cis.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.builder.TestTokenizer </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderRoundTrip(){
  Assert.assertEquals(inputs.size(),roundTripped.size());
  Assert.assertTrue(Bytes.isSorted(roundTripped));
  Assert.assertTrue(Bytes.equals(inputs,roundTripped));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.column.TestColumnBuilder </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * methods 
 */
@Test public void testReaderRoundTrip() throws IOException {
  for (int i=0; i < sortedUniqueColumns.size(); ++i) {
    ByteRange column=sortedUniqueColumns.get(i);
    builder.addSorted(column);
  }
  List<byte[]> builderOutputArrays=builder.getArrays();
  for (int i=0; i < builderOutputArrays.size(); ++i) {
    byte[] inputArray=sortedUniqueColumns.get(i).deepCopyToNewArray();
    byte[] outputArray=builderOutputArrays.get(i);
    boolean same=Bytes.equals(inputArray,outputArray);
    Assert.assertTrue(same);
  }
  Assert.assertEquals(sortedUniqueColumns.size(),builderOutputArrays.size());
  writer=new ColumnSectionWriter(blockMeta,builder,ColumnNodeType.QUALIFIER);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  writer.compile().writeBytes(baos);
  bytes=baos.toByteArray();
  buffer=new byte[blockMeta.getMaxQualifierLength()];
  reader=new ColumnReader(buffer,ColumnNodeType.QUALIFIER);
  reader.initOnBlock(blockMeta,new SingleByteBuff(ByteBuffer.wrap(bytes)));
  List<TokenizerNode> builderNodes=Lists.newArrayList();
  builder.appendNodes(builderNodes,true,true);
  int i=0;
  for (  TokenizerNode builderNode : builderNodes) {
    if (!builderNode.hasOccurrences()) {
      continue;
    }
    Assert.assertEquals(1,builderNode.getNumOccurrences());
    int position=builderNode.getOutputArrayOffset();
    byte[] output=reader.populateBuffer(position).copyBufferToNewArray();
    boolean same=Bytes.equals(sortedUniqueColumns.get(i).deepCopyToNewArray(),output);
    Assert.assertTrue(same);
    ++i;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.row.TestPrefixTreeSearcher </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSeekMisses() throws IOException {
  CellSearcher searcher=null;
  List<Integer> rowStartIndexes=rows.getRowStartIndexes();
  try {
    searcher=DecoderFactory.checkOut(block,true);
    for (    boolean beforeVsAfterOnMiss : new boolean[]{true,false}) {
      for (int i=0; i < rows.getInputs().size(); ++i) {
        KeyValue kv=rows.getInputs().get(i);
        Cell inputNextRow=CellUtil.createFirstOnNextRow(kv);
        CellScannerPosition position=beforeVsAfterOnMiss ? searcher.positionAtOrBefore(inputNextRow) : searcher.positionAtOrAfter(inputNextRow);
        boolean isFirstInRow=rowStartIndexes.contains(i);
        if (isFirstInRow) {
          int rowIndex=rowStartIndexes.indexOf(i);
          if (rowIndex < rowStartIndexes.size() - 1) {
            if (beforeVsAfterOnMiss) {
              Assert.assertEquals(CellScannerPosition.BEFORE,position);
            }
 else {
              Assert.assertEquals(CellScannerPosition.AFTER,position);
            }
            int expectedInputIndex=beforeVsAfterOnMiss ? rowStartIndexes.get(rowIndex + 1) - 1 : rowStartIndexes.get(rowIndex + 1);
            Assert.assertEquals(rows.getInputs().get(expectedInputIndex),searcher.current());
          }
        }
        KeyValue inputPreviousKv=KeyValueUtil.previousKey(kv);
        boolean hit=searcher.positionAt(inputPreviousKv);
        Assert.assertFalse(hit);
        position=searcher.positionAtOrAfter(inputPreviousKv);
        if (CollectionUtils.isLastIndex(rows.getInputs(),i)) {
          Assert.assertTrue(CellScannerPosition.AFTER_LAST == position);
        }
 else {
          Assert.assertTrue(CellScannerPosition.AFTER == position);
          Assert.assertEquals(rows.getInputs().get(i + 1),searcher.current());
        }
      }
    }
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanForwards() throws IOException {
  CellSearcher searcher=null;
  try {
    searcher=DecoderFactory.checkOut(block,true);
    int i=-1;
    while (searcher.advance()) {
      ++i;
      KeyValue inputCell=rows.getInputs().get(i);
      Cell outputCell=searcher.current();
      Assert.assertEquals(inputCell,outputCell);
      Assert.assertEquals(outputCell,inputCell);
      Assert.assertTrue(CellUtil.equals(inputCell,outputCell));
    }
    Assert.assertEquals(rows.getInputs().size(),i + 1);
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.constraint.TestConstraint </h4><pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that constraints will fail properly
 * @throws Exception
 */
@SuppressWarnings("unchecked") @Test(timeout=60000) public void testConstraintFails() throws Exception {
  HTableDescriptor desc=new HTableDescriptor(tableName);
  for (  byte[] family : new byte[][]{dummy,test}) {
    desc.addFamily(new HColumnDescriptor(family));
  }
  Constraints.add(desc,AllFailConstraint.class);
  util.getHBaseAdmin().createTable(desc);
  Table table=util.getConnection().getTable(tableName);
  Put put=new Put(row1);
  byte[] qualifier=new byte[0];
  put.addColumn(dummy,qualifier,"fail".getBytes());
  LOG.warn("Doing put in table");
  try {
    table.put(put);
    fail("This put should not have suceeded - AllFailConstraint was not run!");
  }
 catch (  RetriesExhaustedWithDetailsException e) {
    List<Throwable> causes=e.getCauses();
    assertEquals("More than one failure cause - should only be the failure constraint exception",1,causes.size());
    Throwable t=causes.get(0);
    assertEquals(ConstraintException.class,t.getClass());
  }
  table.close();
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check to make sure a constraint is unloaded when it fails
 * @throws Exception
 */
@Test public void testIsUnloaded() throws Exception {
  HTableDescriptor desc=new HTableDescriptor(tableName);
  for (  byte[] family : new byte[][]{dummy,test}) {
    desc.addFamily(new HColumnDescriptor(family));
  }
  Constraints.add(desc,RuntimeFailConstraint.class);
  Constraints.add(desc,CheckWasRunConstraint.class);
  CheckWasRunConstraint.wasRun=false;
  util.getHBaseAdmin().createTable(desc);
  Table table=util.getConnection().getTable(tableName);
  Put put=new Put(row1);
  byte[] qualifier=new byte[0];
  put.addColumn(dummy,qualifier,"pass".getBytes());
  try {
    table.put(put);
    fail("RuntimeFailConstraint wasn't triggered - this put shouldn't work!");
  }
 catch (  Exception e) {
  }
  table.put(put);
  assertFalse(CheckWasRunConstraint.wasRun);
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.constraint.TestConstraints </h4><pre class="type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigurationPreserved() throws Throwable {
  Configuration conf=new Configuration();
  conf.setBoolean("_ENABLED",false);
  conf.setLong("_PRIORITY",10);
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf("table"));
  Constraints.add(desc,AlsoWorks.class,conf);
  Constraints.add(desc,WorksConstraint.class);
  assertFalse(Constraints.enabled(desc,AlsoWorks.class));
  List<? extends Constraint> constraints=Constraints.getConstraints(desc,this.getClass().getClassLoader());
  for (  Constraint c : constraints) {
    Configuration storedConf=c.getConf();
    if (c instanceof AlsoWorks)     assertEquals(10,storedConf.getLong("_PRIORITY",-1));
 else     assertEquals(2,storedConf.getLong("_PRIORITY",-1));
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testReadWriteWithConf() throws Throwable {
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf("table"));
  Constraints.add(desc,new Pair<Class<? extends Constraint>,Configuration>(CheckConfigurationConstraint.class,CheckConfigurationConstraint.getConfiguration()));
  List<? extends Constraint> c=Constraints.getConstraints(desc,this.getClass().getClassLoader());
  assertEquals(1,c.size());
  assertEquals(CheckConfigurationConstraint.class,c.get(0).getClass());
  Constraints.add(desc,new Pair<Class<? extends Constraint>,Configuration>(CheckConfigurationConstraint.class,new Configuration(false)));
  try {
    Constraints.getConstraints(desc,this.getClass().getClassLoader());
    fail("No exception thrown  - configuration not overwritten");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestBatchCoprocessorEndpoint </h4><pre class="type-4 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregationWithErrors() throws Throwable {
  Table table=util.getConnection().getTable(TEST_TABLE);
  final Map<byte[],ColumnAggregationWithErrorsProtos.SumResponse> results=Collections.synchronizedMap(new TreeMap<byte[],ColumnAggregationWithErrorsProtos.SumResponse>(Bytes.BYTES_COMPARATOR));
  ColumnAggregationWithErrorsProtos.SumRequest.Builder builder=ColumnAggregationWithErrorsProtos.SumRequest.newBuilder();
  builder.setFamily(ByteStringer.wrap(TEST_FAMILY));
  if (TEST_QUALIFIER != null && TEST_QUALIFIER.length > 0) {
    builder.setQualifier(ByteStringer.wrap(TEST_QUALIFIER));
  }
  boolean hasError=false;
  try {
    table.batchCoprocessorService(ColumnAggregationWithErrorsProtos.ColumnAggregationServiceWithErrors.getDescriptor().findMethodByName("sum"),builder.build(),ROWS[0],ROWS[ROWS.length - 1],ColumnAggregationWithErrorsProtos.SumResponse.getDefaultInstance(),new Batch.Callback<ColumnAggregationWithErrorsProtos.SumResponse>(){
      @Override public void update(      byte[] region,      byte[] row,      ColumnAggregationWithErrorsProtos.SumResponse result){
        results.put(region,result);
      }
    }
);
  }
 catch (  Throwable t) {
    LOG.info("Exceptions in coprocessor service",t);
    hasError=true;
  }
  int sumResult=0;
  int expectedResult=0;
  for (  Map.Entry<byte[],ColumnAggregationWithErrorsProtos.SumResponse> e : results.entrySet()) {
    LOG.info("Got value " + e.getValue().getSum() + " for region "+ Bytes.toStringBinary(e.getKey()));
    sumResult+=e.getValue().getSum();
  }
  for (int i=0; i < rowSeperator2; i++) {
    expectedResult+=i;
  }
  assertEquals("Invalid result",expectedResult,sumResult);
  assertTrue(hasError);
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestClassLoading </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClassLoadingFromHDFS() throws Exception {
  FileSystem fs=cluster.getFileSystem();
  File jarFile1=buildCoprocessorJar(cpName1);
  File jarFile2=buildCoprocessorJar(cpName2);
  fs.copyFromLocalFile(new Path(jarFile1.getPath()),new Path(fs.getUri().toString() + Path.SEPARATOR));
  String jarFileOnHDFS1=fs.getUri().toString() + Path.SEPARATOR + jarFile1.getName();
  Path pathOnHDFS1=new Path(jarFileOnHDFS1);
  assertTrue("Copy jar file to HDFS failed.",fs.exists(pathOnHDFS1));
  LOG.info("Copied jar file to HDFS: " + jarFileOnHDFS1);
  fs.copyFromLocalFile(new Path(jarFile2.getPath()),new Path(fs.getUri().toString() + Path.SEPARATOR));
  String jarFileOnHDFS2=fs.getUri().toString() + Path.SEPARATOR + jarFile2.getName();
  Path pathOnHDFS2=new Path(jarFileOnHDFS2);
  assertTrue("Copy jar file to HDFS failed.",fs.exists(pathOnHDFS2));
  LOG.info("Copied jar file to HDFS: " + jarFileOnHDFS2);
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor("test"));
  htd.setValue("COPROCESSOR$1",jarFileOnHDFS1.toString() + "|" + cpName1+ "|"+ Coprocessor.PRIORITY_USER);
  htd.setValue("COPROCESSOR$2",jarFileOnHDFS2.toString() + "|" + cpName2+ "|"+ Coprocessor.PRIORITY_USER+ "|k1=v1,k2=v2,k3=v3");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  if (admin.tableExists(tableName)) {
    if (admin.isTableEnabled(tableName)) {
      admin.disableTable(tableName);
    }
    admin.deleteTable(tableName);
  }
  CoprocessorClassLoader.clearCache();
  byte[] startKey={10,63};
  byte[] endKey={12,43};
  admin.createTable(htd,startKey,endKey,4);
  waitForTable(htd.getTableName());
  boolean foundTableRegion=false;
  boolean found1=true, found2=true, found2_k1=true, found2_k2=true, found2_k3=true;
  Map<Region,Set<ClassLoader>> regionsActiveClassLoaders=new HashMap<Region,Set<ClassLoader>>();
  MiniHBaseCluster hbase=TEST_UTIL.getHBaseCluster();
  for (  Region region : hbase.getRegionServer(0).getOnlineRegionsLocalContext()) {
    if (region.getRegionInfo().getRegionNameAsString().startsWith(tableName.getNameAsString())) {
      foundTableRegion=true;
      CoprocessorEnvironment env;
      env=region.getCoprocessorHost().findCoprocessorEnvironment(cpName1);
      found1=found1 && (env != null);
      env=region.getCoprocessorHost().findCoprocessorEnvironment(cpName2);
      found2=found2 && (env != null);
      if (env != null) {
        Configuration conf=env.getConfiguration();
        found2_k1=found2_k1 && (conf.get("k1") != null);
        found2_k2=found2_k2 && (conf.get("k2") != null);
        found2_k3=found2_k3 && (conf.get("k3") != null);
      }
 else {
        found2_k1=found2_k2=found2_k3=false;
      }
      regionsActiveClassLoaders.put(region,((CoprocessorHost)region.getCoprocessorHost()).getExternalClassLoaders());
    }
  }
  assertTrue("No region was found for table " + tableName,foundTableRegion);
  assertTrue("Class " + cpName1 + " was missing on a region",found1);
  assertTrue("Class " + cpName2 + " was missing on a region",found2);
  assertTrue("Configuration key 'k1' was missing on a region",found2_k1);
  assertTrue("Configuration key 'k2' was missing on a region",found2_k2);
  assertTrue("Configuration key 'k3' was missing on a region",found2_k3);
  assertNotNull(jarFileOnHDFS1 + " was not cached",CoprocessorClassLoader.getIfCached(pathOnHDFS1));
  assertNotNull(jarFileOnHDFS2 + " was not cached",CoprocessorClassLoader.getIfCached(pathOnHDFS2));
  assertEquals("The number of cached classloaders should be equal to the number" + " of external jar files",2,CoprocessorClassLoader.getAllCached().size());
  Set<ClassLoader> externalClassLoaders=new HashSet<ClassLoader>(CoprocessorClassLoader.getAllCached());
  for (  Map.Entry<Region,Set<ClassLoader>> regionCP : regionsActiveClassLoaders.entrySet()) {
    assertTrue("Some CP classloaders for region " + regionCP.getKey() + " are not cached."+ " ClassLoader Cache:"+ externalClassLoaders+ " Region ClassLoaders:"+ regionCP.getValue(),externalClassLoaders.containsAll(regionCP.getValue()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindCoprocessors(){
  CoprocessorHost masterCpHost=TEST_UTIL.getHBaseCluster().getMaster().getMasterCoprocessorHost();
  List<MasterObserver> masterObservers=masterCpHost.findCoprocessors(MasterObserver.class);
  assertTrue(masterObservers != null && masterObservers.size() > 0);
  assertEquals(masterCoprocessor.getSimpleName(),masterObservers.get(0).getClass().getSimpleName());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrivateClassLoader() throws Exception {
  File jarFile=buildCoprocessorJar(cpName4);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(cpName4));
  htd.addFamily(new HColumnDescriptor("test"));
  htd.setValue("COPROCESSOR$1",getLocalPath(jarFile) + "|" + cpName4+ "|"+ Coprocessor.PRIORITY_USER);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  admin.createTable(htd);
  waitForTable(htd.getTableName());
  boolean found=false;
  MiniHBaseCluster hbase=TEST_UTIL.getHBaseCluster();
  for (  Region region : hbase.getRegionServer(0).getOnlineRegionsLocalContext()) {
    if (region.getRegionInfo().getRegionNameAsString().startsWith(cpName4)) {
      Coprocessor cp=region.getCoprocessorHost().findCoprocessor(cpName4);
      if (cp != null) {
        found=true;
        assertEquals("Class " + cpName4 + " was not loaded by CoprocessorClassLoader",cp.getClass().getClassLoader().getClass(),CoprocessorClassLoader.class);
      }
    }
  }
  assertTrue("Class " + cpName4 + " was missing on a region",found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestCoprocessorEndpoint </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoprocessorService() throws Throwable {
  Table table=util.getConnection().getTable(TEST_TABLE);
  List<HRegionLocation> regions;
  try (RegionLocator rl=util.getConnection().getRegionLocator(TEST_TABLE)){
    regions=rl.getAllRegionLocations();
  }
   final TestProtos.EchoRequestProto request=TestProtos.EchoRequestProto.newBuilder().setMessage("hello").build();
  final Map<byte[],String> results=Collections.synchronizedMap(new TreeMap<byte[],String>(Bytes.BYTES_COMPARATOR));
  try {
    final RpcController controller=new ServerRpcController();
    table.coprocessorService(TestRpcServiceProtos.TestProtobufRpcProto.class,ROWS[0],ROWS[ROWS.length - 1],new Batch.Call<TestRpcServiceProtos.TestProtobufRpcProto,TestProtos.EchoResponseProto>(){
      public TestProtos.EchoResponseProto call(      TestRpcServiceProtos.TestProtobufRpcProto instance) throws IOException {
        LOG.debug("Default response is " + TestProtos.EchoRequestProto.getDefaultInstance());
        BlockingRpcCallback<TestProtos.EchoResponseProto> callback=new BlockingRpcCallback<TestProtos.EchoResponseProto>();
        instance.echo(controller,request,callback);
        TestProtos.EchoResponseProto response=callback.get();
        LOG.debug("Batch.Call returning result " + response);
        return response;
      }
    }
,new Batch.Callback<TestProtos.EchoResponseProto>(){
      public void update(      byte[] region,      byte[] row,      TestProtos.EchoResponseProto result){
        assertNotNull(result);
        assertEquals("hello",result.getMessage());
        results.put(region,result.getMessage());
      }
    }
);
    for (    Map.Entry<byte[],String> e : results.entrySet()) {
      LOG.info("Got value " + e.getValue() + " for region "+ Bytes.toStringBinary(e.getKey()));
    }
    assertEquals(3,results.size());
    for (    HRegionLocation info : regions) {
      LOG.info("Region info is " + info.getRegionInfo().getRegionNameAsString());
      assertTrue(results.containsKey(info.getRegionInfo().getRegionName()));
    }
    results.clear();
    table.coprocessorService(TestRpcServiceProtos.TestProtobufRpcProto.class,ROWS[rowSeperator1],ROWS[ROWS.length - 1],new Batch.Call<TestRpcServiceProtos.TestProtobufRpcProto,TestProtos.EchoResponseProto>(){
      public TestProtos.EchoResponseProto call(      TestRpcServiceProtos.TestProtobufRpcProto instance) throws IOException {
        LOG.debug("Default response is " + TestProtos.EchoRequestProto.getDefaultInstance());
        BlockingRpcCallback<TestProtos.EchoResponseProto> callback=new BlockingRpcCallback<TestProtos.EchoResponseProto>();
        instance.echo(controller,request,callback);
        TestProtos.EchoResponseProto response=callback.get();
        LOG.debug("Batch.Call returning result " + response);
        return response;
      }
    }
,new Batch.Callback<TestProtos.EchoResponseProto>(){
      public void update(      byte[] region,      byte[] row,      TestProtos.EchoResponseProto result){
        assertNotNull(result);
        assertEquals("hello",result.getMessage());
        results.put(region,result.getMessage());
      }
    }
);
    for (    Map.Entry<byte[],String> e : results.entrySet()) {
      LOG.info("Got value " + e.getValue() + " for region "+ Bytes.toStringBinary(e.getKey()));
    }
    assertEquals(2,results.size());
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoprocessorServiceNullResponse() throws Throwable {
  Table table=util.getConnection().getTable(TEST_TABLE);
  List<HRegionLocation> regions;
  try (RegionLocator rl=util.getConnection().getRegionLocator(TEST_TABLE)){
    regions=rl.getAllRegionLocations();
  }
   final TestProtos.EchoRequestProto request=TestProtos.EchoRequestProto.newBuilder().setMessage("hello").build();
  try {
    final RpcController controller=new ServerRpcController();
    Map<byte[],String> results=table.coprocessorService(TestRpcServiceProtos.TestProtobufRpcProto.class,ROWS[0],ROWS[ROWS.length - 1],new Batch.Call<TestRpcServiceProtos.TestProtobufRpcProto,String>(){
      public String call(      TestRpcServiceProtos.TestProtobufRpcProto instance) throws IOException {
        BlockingRpcCallback<TestProtos.EchoResponseProto> callback=new BlockingRpcCallback<TestProtos.EchoResponseProto>();
        instance.echo(controller,request,callback);
        TestProtos.EchoResponseProto response=callback.get();
        LOG.debug("Batch.Call got result " + response);
        return null;
      }
    }
);
    for (    Map.Entry<byte[],String> e : results.entrySet()) {
      LOG.info("Got value " + e.getValue() + " for region "+ Bytes.toStringBinary(e.getKey()));
    }
    assertEquals(3,results.size());
    for (    HRegionLocation region : regions) {
      HRegionInfo info=region.getRegionInfo();
      LOG.info("Region info is " + info.getRegionNameAsString());
      assertTrue(results.containsKey(info.getRegionName()));
      assertNull(results.get(info.getRegionName()));
    }
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestCoprocessorInterface </h4><pre class="type-4 type-9 type-11 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSharedData() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  byte[][] families={fam1,fam2,fam3};
  Configuration hc=initSplit();
  Region region=initHRegion(tableName,name.getMethodName(),hc,new Class<?>[]{},families);
  for (int i=0; i < 3; i++) {
    HBaseTestCase.addContent(region,fam3);
    region.flush(true);
  }
  region.compact(false);
  byte[] splitRow=((HRegion)region).checkSplit();
  assertNotNull(splitRow);
  Region[] regions=split(region,splitRow);
  for (int i=0; i < regions.length; i++) {
    regions[i]=reopenRegion(regions[i],CoprocessorImpl.class,CoprocessorII.class);
  }
  Coprocessor c=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  Coprocessor c2=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
  Object o=((CoprocessorImpl)c).getSharedData().get("test1");
  Object o2=((CoprocessorII)c2).getSharedData().get("test2");
  assertNotNull(o);
  assertNotNull(o2);
  assertFalse(((CoprocessorImpl)c).getSharedData() == ((CoprocessorII)c2).getSharedData());
  for (int i=1; i < regions.length; i++) {
    c=regions[i].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
    c2=regions[i].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
    assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
    assertTrue(((CoprocessorII)c2).getSharedData().get("test2") == o2);
  }
  for (int i=0; i < regions.length; i++) {
    try {
      byte[] r=regions[i].getRegionInfo().getStartKey();
      if (r == null || r.length <= 0) {
        r=new byte[]{0};
      }
      Get g=new Get(r);
      regions[i].get(g);
      fail();
    }
 catch (    org.apache.hadoop.hbase.DoNotRetryIOException xc) {
    }
    assertNull(regions[i].getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName()));
  }
  c=regions[0].getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
  c=c2=null;
  System.gc();
  region=reopenRegion(regions[0],CoprocessorImpl.class,CoprocessorII.class);
  c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  assertTrue(((CoprocessorImpl)c).getSharedData().get("test1") == o);
  c2=region.getCoprocessorHost().findCoprocessor(CoprocessorII.class.getName());
  Object o3=((CoprocessorII)c2).getSharedData().get("test2");
  assertFalse(o3 == o2);
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoprocessorInterface() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  byte[][] families={fam1,fam2,fam3};
  Configuration hc=initSplit();
  Region region=initHRegion(tableName,name.getMethodName(),hc,new Class<?>[]{CoprocessorImpl.class},families);
  for (int i=0; i < 3; i++) {
    HBaseTestCase.addContent(region,fam3);
    region.flush(true);
  }
  region.compact(false);
  byte[] splitRow=((HRegion)region).checkSplit();
  assertNotNull(splitRow);
  Region[] regions=split(region,splitRow);
  for (int i=0; i < regions.length; i++) {
    regions[i]=reopenRegion(regions[i],CoprocessorImpl.class);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
  Coprocessor c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
  Scan s=new Scan();
  RegionScanner scanner=regions[0].getCoprocessorHost().postScannerOpen(s,regions[0].getScanner(s));
  assertTrue(scanner instanceof CustomScanner);
  scanner.next(new ArrayList<Cell>());
  assertTrue("Coprocessor not started",((CoprocessorImpl)c).wasStarted());
  assertTrue("Coprocessor not stopped",((CoprocessorImpl)c).wasStopped());
  assertTrue(((CoprocessorImpl)c).wasOpened());
  assertTrue(((CoprocessorImpl)c).wasClosed());
  assertTrue(((CoprocessorImpl)c).wasFlushed());
  assertTrue(((CoprocessorImpl)c).wasCompacted());
  assertTrue(((CoprocessorImpl)c).wasSplit());
  for (int i=0; i < regions.length; i++) {
    HBaseTestingUtility.closeRegionAndWAL(regions[i]);
    c=region.getCoprocessorHost().findCoprocessor(CoprocessorImpl.class.getName());
    assertTrue("Coprocessor not started",((CoprocessorImpl)c).wasStarted());
    assertTrue("Coprocessor not stopped",((CoprocessorImpl)c).wasStopped());
    assertTrue(((CoprocessorImpl)c).wasOpened());
    assertTrue(((CoprocessorImpl)c).wasClosed());
    assertTrue(((CoprocessorImpl)c).wasCompacted());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithAbort </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testExceptionFromCoprocessorWhenCreatingTable() throws IOException {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  BuggyMasterObserver cp=(BuggyMasterObserver)host.findCoprocessor(BuggyMasterObserver.class.getName());
  assertFalse("No table created yet",cp.wasCreateTableCalled());
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(UTIL.getConfiguration(),"unittest",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal ZK error: " + why,e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  MasterTracker masterTracker=new MasterTracker(zkw,"/hbase/master",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal ZK master tracker error, why=",e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  masterTracker.start();
  zkw.registerListener(masterTracker);
  assertTrue(HMaster.getLoadedCoprocessors().contains(TestMasterCoprocessorExceptionWithAbort.BuggyMasterObserver.class.getName()));
  CreateTableThread createTableThread=new CreateTableThread(UTIL);
  createTableThread.start();
  for (int i=0; i < 30; i++) {
    if (masterTracker.masterZKNodeWasDeleted == true) {
      break;
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      fail("InterruptedException while waiting for master zk node to " + "be deleted.");
    }
  }
  assertTrue("Master aborted on coprocessor exception, as expected.",masterTracker.masterZKNodeWasDeleted);
  createTableThread.interrupt();
  try {
    createTableThread.join(1000);
  }
 catch (  InterruptedException e) {
    assertTrue("Ignoring InterruptedException while waiting for " + " createTableThread.join().",true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithRemove </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testExceptionFromCoprocessorWhenCreatingTable() throws IOException {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  BuggyMasterObserver cp=(BuggyMasterObserver)host.findCoprocessor(BuggyMasterObserver.class.getName());
  assertFalse("No table created yet",cp.wasCreateTableCalled());
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(UTIL.getConfiguration(),"unittest",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal ZK error: " + why,e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  MasterTracker masterTracker=new MasterTracker(zkw,"/hbase/master",new Abortable(){
    @Override public void abort(    String why,    Throwable e){
      throw new RuntimeException("Fatal Zookeeper tracker error, why=",e);
    }
    @Override public boolean isAborted(){
      return false;
    }
  }
);
  masterTracker.start();
  zkw.registerListener(masterTracker);
  String coprocessorName=BuggyMasterObserver.class.getName();
  assertTrue(HMaster.getLoadedCoprocessors().contains(coprocessorName));
  HTableDescriptor htd1=new HTableDescriptor(TableName.valueOf(TEST_TABLE1));
  htd1.addFamily(new HColumnDescriptor(TEST_FAMILY1));
  boolean threwDNRE=false;
  try {
    Admin admin=UTIL.getHBaseAdmin();
    admin.createTable(htd1);
  }
 catch (  IOException e) {
    if (e.getClass().getName().equals("org.apache.hadoop.hbase.DoNotRetryIOException")) {
      threwDNRE=true;
    }
  }
 finally {
    assertTrue(threwDNRE);
  }
  try {
    Thread.sleep(3000);
  }
 catch (  InterruptedException e) {
    fail("InterruptedException while sleeping.");
  }
  assertFalse("Master survived coprocessor NPE, as expected.",masterTracker.masterZKNodeWasDeleted);
  String loadedCoprocessors=HMaster.getLoadedCoprocessors();
  assertTrue(loadedCoprocessors.contains(coprocessorName));
  HTableDescriptor htd2=new HTableDescriptor(TableName.valueOf(TEST_TABLE2));
  htd2.addFamily(new HColumnDescriptor(TEST_FAMILY2));
  Admin admin=UTIL.getHBaseAdmin();
  try {
    admin.createTable(htd2);
  }
 catch (  IOException e) {
    fail("Failed to create table after buggy coprocessor removal: " + e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestMasterObserver </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testRegionTransitionOperations() throws Exception {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  CPMasterObserver cp=(CPMasterObserver)host.findCoprocessor(CPMasterObserver.class.getName());
  cp.enableBypass(false);
  cp.resetStates();
  Table table=UTIL.createMultiRegionTable(tableName,TEST_FAMILY);
  try (RegionLocator r=UTIL.getConnection().getRegionLocator(tableName)){
    UTIL.waitUntilAllRegionsAssigned(tableName);
    List<HRegionLocation> regions=r.getAllRegionLocations();
    HRegionLocation firstGoodPair=null;
    for (    HRegionLocation e : regions) {
      if (e.getServerName() != null) {
        firstGoodPair=e;
        break;
      }
    }
    assertNotNull("Found a non-null entry",firstGoodPair);
    LOG.info("Found " + firstGoodPair.toString());
    Collection<ServerName> servers=master.getClusterStatus().getServers();
    String destName=null;
    String serverNameForFirstRegion=firstGoodPair.getServerName().toString();
    LOG.info("serverNameForFirstRegion=" + serverNameForFirstRegion);
    ServerName masterServerName=master.getServerName();
    boolean found=false;
    for (    ServerName info : servers) {
      LOG.info("ServerName=" + info);
      if (!serverNameForFirstRegion.equals(info.getServerName()) && !masterServerName.equals(info)) {
        destName=info.toString();
        found=true;
        break;
      }
    }
    assertTrue("Found server",found);
    LOG.info("Found " + destName);
    master.getMasterRpcServices().moveRegion(null,RequestConverter.buildMoveRegionRequest(firstGoodPair.getRegionInfo().getEncodedNameAsBytes(),Bytes.toBytes(destName)));
    assertTrue("Coprocessor should have been called on region move",cp.wasMoveCalled());
    master.balanceSwitch(true);
    assertTrue("Coprocessor should have been called on balance switch",cp.wasBalanceSwitchCalled());
    master.balanceSwitch(false);
    AssignmentManager mgr=master.getAssignmentManager();
    Collection<RegionState> transRegions=mgr.getRegionStates().getRegionsInTransition().values();
    for (    RegionState state : transRegions) {
      mgr.getRegionStates().waitOnRegionToClearRegionsInTransition(state.getRegion());
    }
    HRegionServer rs=cluster.getRegionServer(0);
    byte[] destRS=Bytes.toBytes(cluster.getRegionServer(1).getServerName().toString());
    waitForRITtoBeZero(master);
    List<HRegionInfo> openRegions=ProtobufUtil.getOnlineRegions(rs.getRSRpcServices());
    int moveCnt=openRegions.size() / 2;
    for (int i=0; i < moveCnt; i++) {
      HRegionInfo info=openRegions.get(i);
      if (!info.isMetaTable()) {
        master.getMasterRpcServices().moveRegion(null,RequestConverter.buildMoveRegionRequest(openRegions.get(i).getEncodedNameAsBytes(),destRS));
      }
    }
    waitForRITtoBeZero(master);
    master.balanceSwitch(true);
    boolean balanceRun=master.balance();
    assertTrue("Coprocessor should be called on region rebalancing",cp.wasBalanceCalled());
  }
  finally {
    Admin admin=UTIL.getHBaseAdmin();
    admin.disableTable(tableName);
    deleteTable(admin,tableName);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testTableOperations() throws Exception {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  final TableName tableName=TableName.valueOf(name.getMethodName());
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  CPMasterObserver cp=(CPMasterObserver)host.findCoprocessor(CPMasterObserver.class.getName());
  cp.enableBypass(true);
  cp.resetStates();
  assertFalse("No table created yet",cp.wasCreateTableCalled());
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  try (Connection connection=ConnectionFactory.createConnection(UTIL.getConfiguration());Admin admin=connection.getAdmin()){
    tableCreationLatch=new CountDownLatch(1);
    admin.createTable(htd,Arrays.copyOfRange(HBaseTestingUtility.KEYS,1,HBaseTestingUtility.KEYS.length));
    assertTrue("Test table should be created",cp.wasCreateTableCalled());
    tableCreationLatch.await();
    assertTrue("Table pre create handler called.",cp.wasPreCreateTableHandlerCalled());
    assertTrue("Table create handler should be called.",cp.wasCreateTableHandlerCalled());
    RegionLocator regionLocator=connection.getRegionLocator(htd.getTableName());
    List<HRegionLocation> regions=regionLocator.getAllRegionLocations();
    admin.mergeRegions(regions.get(0).getRegionInfo().getEncodedNameAsBytes(),regions.get(1).getRegionInfo().getEncodedNameAsBytes(),true);
    assertTrue("Coprocessor should have been called on region merge",cp.wasDispatchMergeCalled());
    tableCreationLatch=new CountDownLatch(1);
    admin.disableTable(tableName);
    assertTrue(admin.isTableDisabled(tableName));
    assertTrue("Coprocessor should have been called on table disable",cp.wasDisableTableCalled());
    assertTrue("Disable table handler should be called.",cp.wasDisableTableHandlerCalled());
    assertFalse(cp.wasEnableTableCalled());
    admin.enableTable(tableName);
    assertTrue(admin.isTableEnabled(tableName));
    assertTrue("Coprocessor should have been called on table enable",cp.wasEnableTableCalled());
    assertTrue("Enable table handler should be called.",cp.wasEnableTableHandlerCalled());
    admin.disableTable(tableName);
    assertTrue(admin.isTableDisabled(tableName));
    htd.setMaxFileSize(512 * 1024 * 1024);
    modifyTableSync(admin,tableName,htd);
    assertTrue("Test table should have been modified",cp.wasModifyTableCalled());
    admin.addColumnFamily(tableName,new HColumnDescriptor(TEST_FAMILY2));
    assertTrue("New column family shouldn't have been added to test table",cp.preAddColumnCalledOnly());
    HColumnDescriptor hcd1=new HColumnDescriptor(TEST_FAMILY2);
    hcd1.setMaxVersions(25);
    admin.modifyColumnFamily(tableName,hcd1);
    assertTrue("Second column family should be modified",cp.preModifyColumnCalledOnly());
    admin.truncateTable(tableName,false);
    admin.disableTable(tableName);
    assertTrue(admin.isTableDisabled(tableName));
    deleteTable(admin,tableName);
    assertFalse("Test table should have been deleted",admin.tableExists(tableName));
    assertTrue("Coprocessor should have been called on table delete",cp.wasDeleteTableCalled());
    assertTrue("Delete table handler should be called.",cp.wasDeleteTableHandlerCalled());
    cp.enableBypass(false);
    cp.resetStates();
    admin.createTable(htd);
    assertTrue("Test table should be created",cp.wasCreateTableCalled());
    tableCreationLatch.await();
    assertTrue("Table pre create handler called.",cp.wasPreCreateTableHandlerCalled());
    assertTrue("Table create handler should be called.",cp.wasCreateTableHandlerCalled());
    assertFalse(cp.wasDisableTableCalled());
    assertFalse(cp.wasDisableTableHandlerCalled());
    admin.disableTable(tableName);
    assertTrue(admin.isTableDisabled(tableName));
    assertTrue("Coprocessor should have been called on table disable",cp.wasDisableTableCalled());
    assertTrue("Disable table handler should be called.",cp.wasDisableTableHandlerCalled());
    htd.setMaxFileSize(512 * 1024 * 1024);
    modifyTableSync(admin,tableName,htd);
    assertTrue("Test table should have been modified",cp.wasModifyTableCalled());
    admin.addColumnFamily(tableName,new HColumnDescriptor(TEST_FAMILY2));
    assertTrue("New column family should have been added to test table",cp.wasAddColumnCalled());
    assertTrue("Add column handler should be called.",cp.wasAddColumnHandlerCalled());
    HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY2);
    hcd.setMaxVersions(25);
    admin.modifyColumnFamily(tableName,hcd);
    assertTrue("Second column family should be modified",cp.wasModifyColumnCalled());
    assertTrue("Modify table handler should be called.",cp.wasModifyColumnHandlerCalled());
    assertFalse(cp.wasEnableTableCalled());
    assertFalse(cp.wasEnableTableHandlerCalled());
    admin.enableTable(tableName);
    assertTrue(admin.isTableEnabled(tableName));
    assertTrue("Coprocessor should have been called on table enable",cp.wasEnableTableCalled());
    assertTrue("Enable table handler should be called.",cp.wasEnableTableHandlerCalled());
    admin.disableTable(tableName);
    assertTrue(admin.isTableDisabled(tableName));
    assertFalse("No column family deleted yet",cp.wasDeleteColumnCalled());
    assertFalse("Delete table column handler should not be called.",cp.wasDeleteColumnHandlerCalled());
    admin.deleteColumnFamily(tableName,TEST_FAMILY2);
    HTableDescriptor tableDesc=admin.getTableDescriptor(tableName);
    assertNull("'" + Bytes.toString(TEST_FAMILY2) + "' should have been removed",tableDesc.getFamily(TEST_FAMILY2));
    assertTrue("Coprocessor should have been called on column delete",cp.wasDeleteColumnCalled());
    assertTrue("Delete table column handler should be called.",cp.wasDeleteColumnHandlerCalled());
    assertFalse("No table deleted yet",cp.wasDeleteTableCalled());
    assertFalse("Delete table handler should not be called.",cp.wasDeleteTableHandlerCalled());
    deleteTable(admin,tableName);
    assertFalse("Test table should have been deleted",admin.tableExists(tableName));
    assertTrue("Coprocessor should have been called on table delete",cp.wasDeleteTableCalled());
    assertTrue("Delete table handler should be called.",cp.wasDeleteTableHandlerCalled());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testNamespaceOperations() throws Exception {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  String testNamespace="observed_ns";
  HMaster master=cluster.getMaster();
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  CPMasterObserver cp=(CPMasterObserver)host.findCoprocessor(CPMasterObserver.class.getName());
  cp.enableBypass(false);
  cp.resetStates();
  Admin admin=UTIL.getHBaseAdmin();
  admin.createNamespace(NamespaceDescriptor.create(testNamespace).build());
  assertTrue("Test namespace should be created",cp.wasCreateNamespaceCalled());
  assertNotNull(admin.getNamespaceDescriptor(testNamespace));
  assertTrue("Test namespace descriptor should have been called",cp.wasGetNamespaceDescriptorCalled());
  cp.enableBypass(true);
  cp.resetStates();
  boolean expected=false;
  try {
    admin.modifyNamespace(NamespaceDescriptor.create(testNamespace).build());
  }
 catch (  BypassCoprocessorException ce) {
    expected=true;
  }
  assertTrue(expected);
  assertTrue("Test namespace should not have been modified",cp.preModifyNamespaceCalledOnly());
  assertNotNull(admin.getNamespaceDescriptor(testNamespace));
  assertTrue("Test namespace descriptor should have been called",cp.wasGetNamespaceDescriptorCalled());
  expected=false;
  try {
    admin.deleteNamespace(testNamespace);
  }
 catch (  BypassCoprocessorException ce) {
    expected=true;
  }
  assertTrue(expected);
  assertTrue("Test namespace should not have been deleted",cp.preDeleteNamespaceCalledOnly());
  assertNotNull(admin.getNamespaceDescriptor(testNamespace));
  assertTrue("Test namespace descriptor should have been called",cp.wasGetNamespaceDescriptorCalled());
  cp.enableBypass(false);
  cp.resetStates();
  admin.modifyNamespace(NamespaceDescriptor.create(testNamespace).build());
  assertTrue("Test namespace should have been modified",cp.wasModifyNamespaceCalled());
  admin.deleteNamespace(testNamespace);
  assertTrue("Test namespace should have been deleted",cp.wasDeleteNamespaceCalled());
  cp.enableBypass(true);
  cp.resetStates();
  expected=false;
  try {
    admin.createNamespace(NamespaceDescriptor.create(testNamespace).build());
  }
 catch (  BypassCoprocessorException ce) {
    expected=true;
  }
  assertTrue(expected);
  assertTrue("Test namespace should not be created",cp.preCreateNamespaceCalledOnly());
  cp.enableBypass(true);
  cp.resetStates();
  admin.listNamespaceDescriptors();
  assertTrue("post listNamespace should not have been called",cp.preListNamespaceDescriptorsCalledOnly());
  cp.enableBypass(false);
  cp.resetStates();
  admin.listNamespaceDescriptors();
  assertTrue("post listNamespace should have been called",cp.wasListNamespaceDescriptorsCalled());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testStarted() throws Exception {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  assertTrue("Master should be active",master.isActiveMaster());
  MasterCoprocessorHost host=master.getMasterCoprocessorHost();
  assertNotNull("CoprocessorHost should not be null",host);
  CPMasterObserver cp=(CPMasterObserver)host.findCoprocessor(CPMasterObserver.class.getName());
  assertNotNull("CPMasterObserver coprocessor not found or not installed!",cp);
  assertTrue("MasterObserver should have been started",cp.wasStarted());
  assertTrue("preMasterInitialization() hook should have been called",cp.wasMasterInitializationCalled());
  assertTrue("postStartMaster() hook should have been called",cp.wasStartMasterCalled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionObserverInterface </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests overriding compaction handling via coprocessor hooks
 * @throws Exception
 */
@Test(timeout=300000) public void testCompactionOverride() throws Exception {
  TableName compactTable=TableName.valueOf("TestCompactionOverride");
  Admin admin=util.getHBaseAdmin();
  if (admin.tableExists(compactTable)) {
    admin.disableTable(compactTable);
    admin.deleteTable(compactTable);
  }
  HTableDescriptor htd=new HTableDescriptor(compactTable);
  htd.addFamily(new HColumnDescriptor(A));
  htd.addCoprocessor(EvenOnlyCompactor.class.getName());
  admin.createTable(htd);
  Table table=util.getConnection().getTable(compactTable);
  for (long i=1; i <= 10; i++) {
    byte[] iBytes=Bytes.toBytes(i);
    Put put=new Put(iBytes);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(A,A,iBytes);
    table.put(put);
  }
  HRegion firstRegion=cluster.getRegions(compactTable).get(0);
  Coprocessor cp=firstRegion.getCoprocessorHost().findCoprocessor(EvenOnlyCompactor.class.getName());
  assertNotNull("EvenOnlyCompactor coprocessor should be loaded",cp);
  EvenOnlyCompactor compactor=(EvenOnlyCompactor)cp;
  long ts=System.currentTimeMillis();
  admin.flush(compactTable);
  for (int i=0; i < 10; i++) {
    if (compactor.lastFlush >= ts) {
      break;
    }
    Thread.sleep(1000);
  }
  assertTrue("Flush didn't complete",compactor.lastFlush >= ts);
  LOG.debug("Flush complete");
  ts=compactor.lastFlush;
  admin.majorCompact(compactTable);
  for (int i=0; i < 30; i++) {
    if (compactor.lastCompaction >= ts) {
      break;
    }
    Thread.sleep(1000);
  }
  LOG.debug("Last compaction was at " + compactor.lastCompaction);
  assertTrue("Compaction didn't complete",compactor.lastCompaction >= ts);
  ResultScanner scanner=table.getScanner(new Scan());
  try {
    for (long i=2; i <= 10; i+=2) {
      Result r=scanner.next();
      assertNotNull(r);
      assertFalse(r.isEmpty());
      byte[] iBytes=Bytes.toBytes(i);
      assertArrayEquals("Row should be " + i,r.getRow(),iBytes);
      assertArrayEquals("Value should be " + i,r.getValue(A,A),iBytes);
    }
  }
  finally {
    scanner.close();
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionObserverScannerOpenHook </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Unfortunately, the easiest way to test this is to spin up a mini-cluster since we want to do
 * the usual compaction mechanism on the region, rather than going through the backdoor to the
 * region
 */
@Test public void testRegionObserverCompactionTimeStacking() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  conf.setClass(HConstants.REGION_IMPL,CompactionCompletionNotifyingRegion.class,HRegion.class);
  conf.setInt("hbase.hstore.compaction.min",2);
  UTIL.startMiniCluster();
  String tableName="testRegionObserverCompactionTimeStacking";
  byte[] ROW=Bytes.toBytes("testRow");
  byte[] A=Bytes.toBytes("A");
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(tableName));
  desc.addFamily(new HColumnDescriptor(A));
  desc.addCoprocessor(EmptyRegionObsever.class.getName(),null,Coprocessor.PRIORITY_USER,null);
  desc.addCoprocessor(NoDataFromCompaction.class.getName(),null,Coprocessor.PRIORITY_HIGHEST,null);
  Admin admin=UTIL.getHBaseAdmin();
  admin.createTable(desc);
  Table table=UTIL.getConnection().getTable(desc.getTableName());
  Put put=new Put(ROW);
  put.addColumn(A,A,A);
  table.put(put);
  HRegionServer rs=UTIL.getRSForFirstRegionInTable(desc.getTableName());
  List<Region> regions=rs.getOnlineRegions(desc.getTableName());
  assertEquals("More than 1 region serving test table with 1 row",1,regions.size());
  Region region=regions.get(0);
  admin.flushRegion(region.getRegionInfo().getRegionName());
  CountDownLatch latch=((CompactionCompletionNotifyingRegion)region).getCompactionStateChangeLatch();
  put=new Put(Bytes.toBytes("anotherrow"));
  put.addColumn(A,A,A);
  table.put(put);
  admin.flushRegion(region.getRegionInfo().getRegionName());
  latch.await();
  Get get=new Get(ROW);
  Result r=table.get(get);
  assertNull("Got an unexpected number of rows - no data should be returned with the NoDataFromScan coprocessor. Found: " + r,r.listCells());
  get=new Get(Bytes.toBytes("anotherrow"));
  r=table.get(get);
  assertNull("Got an unexpected number of rows - no data should be returned with the NoDataFromScan coprocessor Found: " + r,r.listCells());
  table.close();
  UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorEndpoint </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEndpointExceptions() throws Exception {
  final ServerName serverName=TEST_UTIL.getHBaseCluster().getRegionServer(0).getServerName();
  final ServerRpcController controller=new ServerRpcController();
  final BlockingRpcCallback<DummyRegionServerEndpointProtos.DummyResponse> rpcCallback=new BlockingRpcCallback<DummyRegionServerEndpointProtos.DummyResponse>();
  DummyRegionServerEndpointProtos.DummyService service=ProtobufUtil.newServiceStub(DummyRegionServerEndpointProtos.DummyService.class,TEST_UTIL.getHBaseAdmin().coprocessorService(serverName));
  service.dummyThrow(controller,DummyRegionServerEndpointProtos.DummyRequest.getDefaultInstance(),rpcCallback);
  assertEquals(null,rpcCallback.get());
  assertTrue(controller.failedOnException());
  assertEquals(WHAT_TO_THROW.getClass().getName().trim(),((RemoteWithExtrasException)controller.getFailedOn().getCause()).getClassName().trim());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testExceptionFromCoprocessorDuringPut() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,2);
  conf.set(CoprocessorHost.REGION_COPROCESSOR_CONF_KEY,BuggyRegionObserver.class.getName());
  conf.setBoolean(CoprocessorHost.ABORT_ON_ERROR_KEY,true);
  TEST_UTIL.startMiniCluster(2);
  try {
    final byte[] TEST_FAMILY=Bytes.toBytes("aaa");
    Table table=TEST_UTIL.createMultiRegionTable(TABLE_NAME,TEST_FAMILY);
    TEST_UTIL.waitUntilAllRegionsAssigned(TABLE_NAME);
    final HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TABLE_NAME);
    try {
      final byte[] ROW=Bytes.toBytes("aaa");
      Put put=new Put(ROW);
      put.addColumn(TEST_FAMILY,ROW,ROW);
      table.put(put);
    }
 catch (    IOException e) {
    }
    boolean aborted=false;
    for (int i=0; i < 10; i++) {
      aborted=regionServer.isAborted();
      if (aborted) {
        break;
      }
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
        fail("InterruptedException while waiting for regionserver " + "zk node to be deleted.");
      }
    }
    Assert.assertTrue("The region server should have aborted",aborted);
    table.close();
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithRemove </h4><pre class="type-9 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testExceptionFromCoprocessorDuringPut() throws IOException, InterruptedException {
  TableName TEST_TABLE=TableName.valueOf("observed_table");
  byte[] TEST_FAMILY=Bytes.toBytes("aaa");
  Table table=TEST_UTIL.createMultiRegionTable(TEST_TABLE,TEST_FAMILY);
  TEST_UTIL.waitUntilAllRegionsAssigned(TEST_TABLE);
  HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(TEST_TABLE);
  boolean threwIOE=false;
  try {
    final byte[] ROW=Bytes.toBytes("aaa");
    Put put=new Put(ROW);
    put.addColumn(TEST_FAMILY,ROW,ROW);
    table.put(put);
    table.put(put);
  }
 catch (  IOException e) {
    threwIOE=true;
  }
 finally {
    assertTrue("The regionserver should have thrown an exception",threwIOE);
  }
  for (int i=0; i < 10; i++) {
    assertFalse(regionServer.isAborted());
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      fail("InterruptedException while waiting for regionserver " + "zk node to be deleted.");
    }
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerObserver </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies the hooks in regions merge.
 * @throws Exception
 */
@Test public void testCoprocessorHooksInRegionsMerge() throws Exception {
  final int NUM_MASTERS=1;
  final int NUM_RS=1;
  final String TABLENAME="testRegionServerObserver";
  final String TABLENAME2="testRegionServerObserver_2";
  final byte[] FAM=Bytes.toBytes("fam");
  Configuration conf=HBaseConfiguration.create();
  conf.setClass("hbase.coprocessor.regionserver.classes",CPRegionServerObserver.class,RegionServerObserver.class);
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility(conf);
  TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  try {
    MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
    HRegionServer regionServer=cluster.getRegionServer(0);
    RegionServerCoprocessorHost cpHost=regionServer.getRegionServerCoprocessorHost();
    Coprocessor coprocessor=cpHost.findCoprocessor(CPRegionServerObserver.class.getName());
    CPRegionServerObserver regionServerObserver=(CPRegionServerObserver)coprocessor;
    HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(TABLENAME));
    desc.addFamily(new HColumnDescriptor(FAM));
    admin.createTable(desc,new byte[][]{Bytes.toBytes("row")});
    desc=new HTableDescriptor(TableName.valueOf(TABLENAME2));
    desc.addFamily(new HColumnDescriptor(FAM));
    admin.createTable(desc,new byte[][]{Bytes.toBytes("row")});
    assertFalse(regionServerObserver.wasRegionMergeCalled());
    List<Region> regions=regionServer.getOnlineRegions(TableName.valueOf(TABLENAME));
    admin.mergeRegions(regions.get(0).getRegionInfo().getEncodedNameAsBytes(),regions.get(1).getRegionInfo().getEncodedNameAsBytes(),true);
    int regionsCount=regionServer.getOnlineRegions(TableName.valueOf(TABLENAME)).size();
    while (regionsCount != 1) {
      regionsCount=regionServer.getOnlineRegions(TableName.valueOf(TABLENAME)).size();
      Thread.sleep(1000);
    }
    assertTrue(regionServerObserver.wasRegionMergeCalled());
    assertTrue(regionServerObserver.wasPreMergeCommit());
    assertTrue(regionServerObserver.wasPostMergeCommit());
    assertEquals(regionsCount,1);
    assertEquals(regionServer.getOnlineRegions(TableName.valueOf(TABLENAME2)).size(),1);
  }
  finally {
    if (admin != null)     admin.close();
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestWALObserver </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test WAL replay behavior with WALObserver.
 */
@Test public void testWALCoprocessorReplay() throws Exception {
  TableName tableName=TableName.valueOf("testWALCoprocessorReplay");
  final HTableDescriptor htd=getBasic3FamilyHTableDescriptor(tableName);
  MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
  final HRegionInfo hri=new HRegionInfo(tableName,null,null);
  final Path basedir=FSUtils.getTableDir(this.hbaseRootDir,tableName);
  deleteDir(basedir);
  fs.mkdirs(new Path(basedir,hri.getEncodedName()));
  final Configuration newConf=HBaseConfiguration.create(this.conf);
  WAL wal=wals.getWAL(UNSPECIFIED_REGION,null);
  WALEdit edit=new WALEdit();
  long now=EnvironmentEdgeManager.currentTime();
  final int countPerFamily=1000;
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addWALEdits(tableName,hri,TEST_ROW,hcd.getName(),countPerFamily,EnvironmentEdgeManager.getDelegate(),wal,htd,mvcc);
  }
  wal.append(htd,hri,new WALKey(hri.getEncodedNameAsBytes(),tableName,now,mvcc),edit,true);
  wal.sync();
  User user=HBaseTestingUtility.getDifferentUser(newConf,".replay.wal.secondtime");
  user.runAs(new PrivilegedExceptionAction(){
    public Object run() throws Exception {
      Path p=runWALSplit(newConf);
      LOG.info("WALSplit path == " + p);
      FileSystem newFS=FileSystem.get(newConf);
      final WALFactory wals2=new WALFactory(conf,null,currentTest.getMethodName() + "2");
      WAL wal2=wals2.getWAL(UNSPECIFIED_REGION,null);
      ;
      HRegion region=HRegion.openHRegion(newConf,FileSystem.get(newConf),hbaseRootDir,hri,htd,wal2,TEST_UTIL.getHBaseCluster().getRegionServer(0),null);
      long seqid2=region.getOpenSeqNum();
      SampleRegionWALObserver cp2=(SampleRegionWALObserver)region.getCoprocessorHost().findCoprocessor(SampleRegionWALObserver.class.getName());
      assertNotNull(cp2);
      assertTrue(cp2.isPreWALRestoreCalled());
      assertTrue(cp2.isPostWALRestoreCalled());
      assertFalse(cp2.isPreWALRestoreDeprecatedCalled());
      assertFalse(cp2.isPostWALRestoreDeprecatedCalled());
      region.close();
      wals2.close();
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.errorhandling.TestForeignExceptionDispatcher </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that a dispatcher only dispatches only the first exception, and does not propagate
 * subsequent exceptions.
 */
@Test public void testErrorPropagation(){
  ForeignExceptionListener listener1=Mockito.mock(ForeignExceptionListener.class);
  ForeignExceptionListener listener2=Mockito.mock(ForeignExceptionListener.class);
  ForeignExceptionDispatcher dispatcher=new ForeignExceptionDispatcher();
  dispatcher.addListener(listener1);
  dispatcher.addListener(listener2);
  dispatcher.receive(EXTEXN);
  Mockito.verify(listener1,Mockito.times(1)).receive(EXTEXN);
  Mockito.verify(listener2,Mockito.times(1)).receive(EXTEXN);
  try {
    dispatcher.rethrowException();
    fail("Monitor should have thrown an exception after getting error.");
  }
 catch (  ForeignException ex) {
    assertTrue("Got an unexpected exception:" + ex,ex.getCause() == EXTEXN.getCause());
    LOG.debug("Got the testing exception!");
  }
  dispatcher.receive(EXTEXN2);
  Mockito.verify(listener1,Mockito.never()).receive(EXTEXN2);
  Mockito.verify(listener2,Mockito.never()).receive(EXTEXN2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.errorhandling.TestForeignExceptionSerialization </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Compare that a generic exception's stack trace has the same stack trace elements after
 * serialization and deserialization
 * @throws InvalidProtocolBufferException
 */
@Test public void testRemoteFromLocal() throws InvalidProtocolBufferException {
  String errorMsg="some message";
  Exception generic=new Exception(errorMsg);
  generic.printStackTrace();
  assertTrue(generic.getMessage().contains(errorMsg));
  ForeignException e=ForeignException.deserialize(ForeignException.serialize(srcName,generic));
  assertArrayEquals("Local stack trace got corrupted",generic.getStackTrace(),e.getCause().getStackTrace());
  e.printStackTrace();
  assertTrue(e.getCause().getCause() == null);
  assertTrue(e.getCause().getMessage().contains(errorMsg));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that we get back similar stack trace information before an after serialization.
 * @throws InvalidProtocolBufferException
 */
@Test public void testSimpleException() throws InvalidProtocolBufferException {
  String data="some bytes";
  ForeignException in=new ForeignException("SRC",new IllegalArgumentException(data));
  ForeignException e=ForeignException.deserialize(ForeignException.serialize(srcName,in));
  assertNotNull(e);
  StackTraceElement elem=new StackTraceElement(this.getClass().toString(),"method","file",1);
  in.setStackTrace(new StackTraceElement[]{elem});
  e=ForeignException.deserialize(ForeignException.serialize(srcName,in));
  assertNotNull(e);
  assertEquals("Stack trace got corrupted",elem,e.getCause().getStackTrace()[0]);
  assertEquals("Got an unexpectedly long stack trace",1,e.getCause().getStackTrace().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.executor.TestExecutorService </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecutorService() throws Exception {
  int maxThreads=5;
  int maxTries=10;
  int sleepInterval=10;
  Server mockedServer=mock(Server.class);
  when(mockedServer.getConfiguration()).thenReturn(HBaseConfiguration.create());
  ExecutorService executorService=new ExecutorService("unit_test");
  executorService.startExecutorService(ExecutorType.MASTER_SERVER_OPERATIONS,maxThreads);
  Executor executor=executorService.getExecutor(ExecutorType.MASTER_SERVER_OPERATIONS);
  ThreadPoolExecutor pool=executor.threadPoolExecutor;
  assertEquals(0,pool.getPoolSize());
  AtomicBoolean lock=new AtomicBoolean(true);
  AtomicInteger counter=new AtomicInteger(0);
  for (int i=0; i < maxThreads; i++) {
    executorService.submit(new TestEventHandler(mockedServer,EventType.M_SERVER_SHUTDOWN,lock,counter));
  }
  int tries=0;
  while (counter.get() < maxThreads && tries < maxTries) {
    LOG.info("Waiting for all event handlers to start...");
    Thread.sleep(sleepInterval);
    tries++;
  }
  assertEquals(maxThreads,counter.get());
  assertEquals(maxThreads,pool.getPoolSize());
  ExecutorStatus status=executor.getStatus();
  assertTrue(status.queuedEvents.isEmpty());
  assertEquals(5,status.running.size());
  checkStatusDump(status);
synchronized (lock) {
    lock.set(false);
    lock.notifyAll();
  }
  while (counter.get() < (maxThreads * 2) && tries < maxTries) {
    System.out.println("Waiting for all event handlers to finish...");
    Thread.sleep(sleepInterval);
    tries++;
  }
  assertEquals(maxThreads * 2,counter.get());
  assertEquals(maxThreads,pool.getPoolSize());
  for (int i=0; i < (2 * maxThreads); i++) {
    executorService.submit(new TestEventHandler(mockedServer,EventType.M_SERVER_SHUTDOWN,lock,counter));
  }
synchronized (lock) {
    lock.set(false);
    lock.notifyAll();
  }
  Thread.sleep(ExecutorService.Executor.keepAliveTimeInMillis * 2);
  assertEquals(maxThreads,pool.getPoolSize());
  executorService.shutdown();
  assertEquals(0,executorService.getAllExecutorStatuses().size());
  executorService.submit(new TestEventHandler(mockedServer,EventType.M_SERVER_SHUTDOWN,lock,counter));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestComparatorSerialization </h4><pre class="type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegexStringComparator() throws Exception {
  RegexStringComparator regexStringComparator=new RegexStringComparator(".+-2");
  assertTrue(regexStringComparator.areSerializedFieldsEqual(ProtobufUtil.toComparator(ProtobufUtil.toComparator(regexStringComparator))));
  try {
    new RegexStringComparator("regex",Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
  }
 catch (  Throwable t) {
    assertNull("Exception occured while created the RegexStringComparator object",t);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestComparators </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCellFieldsCompare() throws Exception {
  byte[] r0=Bytes.toBytes("row0");
  byte[] r1=Bytes.toBytes("row1");
  byte[] r2=Bytes.toBytes("row2");
  byte[] f=Bytes.toBytes("cf1");
  byte[] q1=Bytes.toBytes("qual1");
  byte[] q2=Bytes.toBytes("qual2");
  byte[] q3=Bytes.toBytes("r");
  long l1=1234L;
  byte[] v1=Bytes.toBytes(l1);
  long l2=2000L;
  byte[] v2=Bytes.toBytes(l2);
  KeyValue kv=new KeyValue(r1,f,q1,v1);
  ByteBuffer buffer=ByteBuffer.wrap(kv.getBuffer());
  Cell bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  ByteArrayComparable comparable=new BinaryComparator(r1);
  assertEquals(0,CellComparator.compareRow(bbCell,comparable));
  assertEquals(0,CellComparator.compareRow(kv,comparable));
  kv=new KeyValue(r0,f,q1,v1);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertTrue(CellComparator.compareRow(bbCell,comparable) > 0);
  assertTrue(CellComparator.compareRow(kv,comparable) > 0);
  kv=new KeyValue(r2,f,q1,v1);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertTrue(CellComparator.compareRow(bbCell,comparable) < 0);
  assertTrue(CellComparator.compareRow(kv,comparable) < 0);
  comparable=new BinaryPrefixComparator(Bytes.toBytes("qual"));
  assertEquals(0,CellComparator.compareQualifier(bbCell,comparable));
  assertEquals(0,CellComparator.compareQualifier(kv,comparable));
  kv=new KeyValue(r2,f,q2,v1);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertEquals(0,CellComparator.compareQualifier(bbCell,comparable));
  assertEquals(0,CellComparator.compareQualifier(kv,comparable));
  kv=new KeyValue(r2,f,q3,v1);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertTrue(CellComparator.compareQualifier(bbCell,comparable) < 0);
  assertTrue(CellComparator.compareQualifier(kv,comparable) < 0);
  comparable=new LongComparator(l1);
  assertEquals(0,CellComparator.compareValue(bbCell,comparable));
  assertEquals(0,CellComparator.compareValue(kv,comparable));
  kv=new KeyValue(r1,f,q1,v2);
  buffer=ByteBuffer.wrap(kv.getBuffer());
  bbCell=new ByteBufferedCellImpl(buffer,0,buffer.remaining());
  assertTrue(CellComparator.compareValue(bbCell,comparable) < 0);
  assertTrue(CellComparator.compareValue(kv,comparable) < 0);
  comparable=new SubstringComparator("cf");
  assertEquals(0,CellComparator.compareFamily(bbCell,comparable));
  assertEquals(0,CellComparator.compareFamily(kv,comparable));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestDependentColumnFilter </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for HBASE-8794. Avoid NullPointerException in DependentColumnFilter.toString().
 */
@Test public void testToStringWithNullComparator(){
  Filter filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER);
  assertNotNull(filter.toString());
  assertTrue("check string contains 'null' as compatator is null",filter.toString().contains("null"));
  filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER,true,CompareOp.EQUAL,null);
  assertNotNull(filter.toString());
  assertTrue("check string contains 'null' as compatator is null",filter.toString().contains("null"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToStringWithNonNullComparator(){
  Filter filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER,true,CompareOp.EQUAL,new BinaryComparator(MATCH_VAL));
  assertNotNull(filter.toString());
  assertTrue("check string contains comparator value",filter.toString().contains("match"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilter </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterListWithPrefixFilter() throws IOException {
  byte[] family=Bytes.toBytes("f1");
  byte[] qualifier=Bytes.toBytes("q1");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("TestFilter"));
  htd.addFamily(new HColumnDescriptor(family));
  HRegionInfo info=new HRegionInfo(htd.getTableName(),null,null,false);
  Region testRegion=HBaseTestingUtility.createRegionAndWAL(info,TEST_UTIL.getDataTestDir(),TEST_UTIL.getConfiguration(),htd);
  for (int i=0; i < 5; i++) {
    Put p=new Put(Bytes.toBytes((char)('a' + i) + "row"));
    p.setDurability(Durability.SKIP_WAL);
    p.addColumn(family,qualifier,Bytes.toBytes(String.valueOf(111 + i)));
    testRegion.put(p);
  }
  testRegion.flush(true);
  PrefixFilter pf=new PrefixFilter(new byte[]{'b'});
  SingleColumnValueFilter scvf=new SingleColumnValueFilter(family,qualifier,CompareOp.EQUAL,Bytes.toBytes("113"));
  FilterList filterList=new FilterList(Operator.MUST_PASS_ONE,pf,scvf);
  Scan s1=new Scan();
  s1.setFilter(filterList);
  InternalScanner scanner=testRegion.getScanner(s1);
  List<Cell> results=new ArrayList<Cell>();
  int resultCount=0;
  while (scanner.next(results)) {
    resultCount++;
    byte[] row=CellUtil.cloneRow(results.get(0));
    LOG.debug("Found row: " + Bytes.toStringBinary(row));
    assertTrue(Bytes.equals(row,Bytes.toBytes("brow")) || Bytes.equals(row,Bytes.toBytes("crow")));
    results.clear();
  }
  assertEquals(2,resultCount);
  scanner.close();
  WAL wal=((HRegion)testRegion).getWAL();
  ((HRegion)testRegion).close();
  wal.close();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the the {@link WhileMatchFilter} works in combination with a{@link Filter} that uses the{@link Filter#filterRow()} method.
 * See HBASE-2258.
 * @throws Exception
 */
@Test public void testWhileMatchFilterWithFilterRow() throws Exception {
  final int pageSize=4;
  Scan s=new Scan();
  WhileMatchFilter filter=new WhileMatchFilter(new PageFilter(pageSize));
  s.setFilter(filter);
  InternalScanner scanner=this.region.getScanner(s);
  int scannerCounter=0;
  while (true) {
    boolean isMoreResults=scanner.next(new ArrayList<Cell>());
    scannerCounter++;
    if (scannerCounter >= pageSize) {
      assertTrue("The WhileMatchFilter should now filter all remaining",filter.filterAllRemaining());
    }
    if (!isMoreResults) {
      break;
    }
  }
  assertEquals("The page filter returned more rows than expected",pageSize,scannerCounter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilterList </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test pass-thru of hints.
 */
@Test public void testHintPassThru() throws Exception {
  final KeyValue minKeyValue=new KeyValue(Bytes.toBytes(0L),null,null);
  final KeyValue maxKeyValue=new KeyValue(Bytes.toBytes(Long.MAX_VALUE),null,null);
  Filter filterNoHint=new FilterBase(){
    @Override public byte[] toByteArray(){
      return null;
    }
    @Override public ReturnCode filterKeyValue(    Cell ignored) throws IOException {
      return ReturnCode.INCLUDE;
    }
  }
;
  Filter filterMinHint=new FilterBase(){
    @Override public ReturnCode filterKeyValue(    Cell ignored){
      return ReturnCode.SEEK_NEXT_USING_HINT;
    }
    @Override public Cell getNextCellHint(    Cell currentKV){
      return minKeyValue;
    }
    @Override public byte[] toByteArray(){
      return null;
    }
  }
;
  Filter filterMaxHint=new FilterBase(){
    @Override public ReturnCode filterKeyValue(    Cell ignored){
      return ReturnCode.SEEK_NEXT_USING_HINT;
    }
    @Override public Cell getNextCellHint(    Cell cell){
      return new KeyValue(Bytes.toBytes(Long.MAX_VALUE),null,null);
    }
    @Override public byte[] toByteArray(){
      return null;
    }
  }
;
  FilterList filterList=new FilterList(Operator.MUST_PASS_ONE,Arrays.asList(new Filter[]{filterMinHint,filterMaxHint}));
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),minKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ONE,Arrays.asList(new Filter[]{filterMinHint,filterMaxHint,filterNoHint}));
  assertNull(filterList.getNextCellHint(null));
  filterList=new FilterList(Operator.MUST_PASS_ONE,Arrays.asList(new Filter[]{filterNoHint,filterMaxHint}));
  assertNull(filterList.getNextCellHint(null));
  filterList=new FilterList(Operator.MUST_PASS_ONE,Arrays.asList(new Filter[]{filterMaxHint,filterMaxHint}));
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),maxKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(new Filter[]{filterMinHint,filterMaxHint}));
  filterList.filterKeyValue(null);
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),minKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(new Filter[]{filterMaxHint,filterMinHint}));
  filterList.filterKeyValue(null);
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),maxKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(new Filter[]{filterNoHint,filterMinHint,filterMaxHint}));
  filterList.filterKeyValue(null);
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),minKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(new Filter[]{filterNoHint,filterMaxHint}));
  filterList.filterKeyValue(null);
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),maxKeyValue));
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(new Filter[]{filterNoHint,filterMinHint}));
  filterList.filterKeyValue(null);
  assertEquals(0,CellComparator.COMPARATOR.compare(filterList.getNextCellHint(null),minKeyValue));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilterWithScanLimits </h4><pre class="type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithLimit(){
  int kv_number=0;
  try {
    Scan scan=new Scan();
    scan.setBatch(2);
    SingleColumnValueFilter filter=new SingleColumnValueFilter(Bytes.toBytes(columnFamily),Bytes.toBytes("c5"),CompareFilter.CompareOp.EQUAL,new SubstringComparator("2_c5"));
    scan.setFilter(filter);
    Table table=openTable(tableName);
    ResultScanner scanner=table.getScanner(scan);
    for (    Result result : scanner) {
      for (      Cell kv : result.listCells()) {
        kv_number++;
        LOG.debug(kv_number + ". kv: " + kv);
      }
    }
    scanner.close();
    table.close();
  }
 catch (  Exception e) {
    assertNotNull("No IncompatibleFilterException catched",e);
  }
  LOG.debug("check the fetched kv number");
  assertEquals("We should not get result(s) returned.",0,kv_number);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilterWrapper </h4><pre class="type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterWrapper(){
  int kv_number=0;
  int row_number=0;
  try {
    Scan scan=new Scan();
    List<Filter> fs=new ArrayList<Filter>();
    DependentColumnFilter f1=new DependentColumnFilter(Bytes.toBytes("f1"),Bytes.toBytes("c5"),true,CompareFilter.CompareOp.EQUAL,new SubstringComparator("c5"));
    PageFilter f2=new PageFilter(2);
    fs.add(f1);
    fs.add(f2);
    FilterList filter=new FilterList(fs);
    scan.setFilter(filter);
    Table table=connection.getTable(name);
    ResultScanner scanner=table.getScanner(scan);
    for (    Result result : scanner) {
      row_number++;
      for (      Cell kv : result.listCells()) {
        LOG.debug(kv_number + ". kv: " + kv);
        kv_number++;
        assertEquals("Returned row is not correct",new String(CellUtil.cloneRow(kv)),"row" + (row_number + 1));
      }
    }
    scanner.close();
    table.close();
  }
 catch (  Exception e) {
    assertNull("Exception happens in scan",e);
  }
  LOG.debug("check the fetched kv number");
  assertEquals("We should get 8 results returned.",8,kv_number);
  assertEquals("We should get 2 rows returned",2,row_number);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestParseFilter </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompoundFilter3() throws IOException {
  String filterString=" ColumnPrefixFilter ('realtime')AND  " + "FirstKeyOnlyFilter() OR SKIP FamilyFilter(=, 'substring:hihi')";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof FilterList);
  assertTrue(filters.get(1) instanceof SkipFilter);
  filterList=(FilterList)filters.get(0);
  SkipFilter skipFilter=(SkipFilter)filters.get(1);
  filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof ColumnPrefixFilter);
  assertTrue(filters.get(1) instanceof FirstKeyOnlyFilter);
  ColumnPrefixFilter columnPrefixFilter=(ColumnPrefixFilter)filters.get(0);
  byte[] columnPrefix=columnPrefixFilter.getPrefix();
  assertEquals(new String(columnPrefix),"realtime");
  FirstKeyOnlyFilter firstKeyOnlyFilter=(FirstKeyOnlyFilter)filters.get(1);
  assertTrue(skipFilter.getFilter() instanceof FamilyFilter);
  FamilyFilter familyFilter=(FamilyFilter)skipFilter.getFilter();
  assertEquals(CompareFilter.CompareOp.EQUAL,familyFilter.getOperator());
  assertTrue(familyFilter.getComparator() instanceof SubstringComparator);
  SubstringComparator substringComparator=(SubstringComparator)familyFilter.getComparator();
  assertEquals("hihi",new String(substringComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrecedence2() throws IOException {
  String filterString=" PrefixFilter ('realtime')AND  SKIP FirstKeyOnlyFilter()" + "OR KeyOnlyFilter()";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof FilterList);
  assertTrue(filters.get(1) instanceof KeyOnlyFilter);
  filterList=(FilterList)filters.get(0);
  filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof PrefixFilter);
  assertTrue(filters.get(1) instanceof SkipFilter);
  PrefixFilter prefixFilter=(PrefixFilter)filters.get(0);
  byte[] prefix=prefixFilter.getPrefix();
  assertEquals(new String(prefix),"realtime");
  SkipFilter skipFilter=(SkipFilter)filters.get(1);
  assertTrue(skipFilter.getFilter() instanceof FirstKeyOnlyFilter);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimestampsFilter() throws IOException {
  String filterString="TimestampsFilter(9223372036854775806, 6)";
  TimestampsFilter timestampsFilter=doTestFilter(filterString,TimestampsFilter.class);
  List<Long> timestamps=timestampsFilter.getTimestamps();
  assertEquals(timestamps.size(),2);
  assertEquals(timestamps.get(0),new Long(6));
  filterString="TimestampsFilter()";
  timestampsFilter=doTestFilter(filterString,TimestampsFilter.class);
  timestamps=timestampsFilter.getTimestamps();
  assertEquals(timestamps.size(),0);
  filterString="TimestampsFilter(9223372036854775808, 6)";
  try {
    doTestFilter(filterString,ColumnPaginationFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("Long Argument was too large");
  }
  filterString="TimestampsFilter(-45, 6)";
  try {
    doTestFilter(filterString,ColumnPaginationFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("Timestamp Arguments should not be negative");
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQualifierFilter() throws IOException {
  String filterString="QualifierFilter(=, 'regexstring:pre*')";
  QualifierFilter qualifierFilter=doTestFilter(filterString,QualifierFilter.class);
  assertEquals(CompareFilter.CompareOp.EQUAL,qualifierFilter.getOperator());
  assertTrue(qualifierFilter.getComparator() instanceof RegexStringComparator);
  RegexStringComparator regexStringComparator=(RegexStringComparator)qualifierFilter.getComparator();
  assertEquals("pre*",new String(regexStringComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrefixFilter() throws IOException {
  String filterString=" PrefixFilter('row' ) ";
  PrefixFilter prefixFilter=doTestFilter(filterString,PrefixFilter.class);
  byte[] prefix=prefixFilter.getPrefix();
  assertEquals(new String(prefix),"row");
  filterString=" PrefixFilter(row)";
  try {
    doTestFilter(filterString,PrefixFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompoundFilter4() throws IOException {
  String filterString=" ColumnPrefixFilter ('realtime') OR " + "FirstKeyOnlyFilter() OR SKIP FamilyFilter(=, 'substring:hihi')";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof ColumnPrefixFilter);
  assertTrue(filters.get(1) instanceof FirstKeyOnlyFilter);
  assertTrue(filters.get(2) instanceof SkipFilter);
  ColumnPrefixFilter columnPrefixFilter=(ColumnPrefixFilter)filters.get(0);
  FirstKeyOnlyFilter firstKeyOnlyFilter=(FirstKeyOnlyFilter)filters.get(1);
  SkipFilter skipFilter=(SkipFilter)filters.get(2);
  byte[] columnPrefix=columnPrefixFilter.getPrefix();
  assertEquals(new String(columnPrefix),"realtime");
  assertTrue(skipFilter.getFilter() instanceof FamilyFilter);
  FamilyFilter familyFilter=(FamilyFilter)skipFilter.getFilter();
  assertEquals(CompareFilter.CompareOp.EQUAL,familyFilter.getOperator());
  assertTrue(familyFilter.getComparator() instanceof SubstringComparator);
  SubstringComparator substringComparator=(SubstringComparator)familyFilter.getComparator();
  assertEquals("hihi",new String(substringComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrecedence1() throws IOException {
  String filterString=" (PrefixFilter ('realtime')AND  FirstKeyOnlyFilter()" + " OR KeyOnlyFilter())";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof FilterList);
  assertTrue(filters.get(1) instanceof KeyOnlyFilter);
  filterList=(FilterList)filters.get(0);
  filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof PrefixFilter);
  assertTrue(filters.get(1) instanceof FirstKeyOnlyFilter);
  PrefixFilter prefixFilter=(PrefixFilter)filters.get(0);
  byte[] prefix=prefixFilter.getPrefix();
  assertEquals(new String(prefix),"realtime");
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompoundFilter1() throws IOException {
  String filterString=" (PrefixFilter ('realtime')AND  FirstKeyOnlyFilter())";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filters.get(0) instanceof PrefixFilter);
  assertTrue(filters.get(1) instanceof FirstKeyOnlyFilter);
  PrefixFilter PrefixFilter=(PrefixFilter)filters.get(0);
  byte[] prefix=PrefixFilter.getPrefix();
  assertEquals(new String(prefix),"realtime");
  FirstKeyOnlyFilter firstKeyOnlyFilter=(FirstKeyOnlyFilter)filters.get(1);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFamilyFilter() throws IOException {
  String filterString="FamilyFilter(>=, 'binaryprefix:pre')";
  FamilyFilter familyFilter=doTestFilter(filterString,FamilyFilter.class);
  assertEquals(CompareFilter.CompareOp.GREATER_OR_EQUAL,familyFilter.getOperator());
  assertTrue(familyFilter.getComparator() instanceof BinaryPrefixComparator);
  BinaryPrefixComparator binaryPrefixComparator=(BinaryPrefixComparator)familyFilter.getComparator();
  assertEquals("pre",new String(binaryPrefixComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompoundFilter2() throws IOException {
  String filterString="(PrefixFilter('realtime') AND QualifierFilter (>=, 'binary:e'))" + "OR FamilyFilter (=, 'binary:qualifier') ";
  FilterList filterList=doTestFilter(filterString,FilterList.class);
  ArrayList<Filter> filterListFilters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filterListFilters.get(0) instanceof FilterList);
  assertTrue(filterListFilters.get(1) instanceof FamilyFilter);
  assertEquals(filterList.getOperator(),FilterList.Operator.MUST_PASS_ONE);
  filterList=(FilterList)filterListFilters.get(0);
  FamilyFilter familyFilter=(FamilyFilter)filterListFilters.get(1);
  filterListFilters=(ArrayList<Filter>)filterList.getFilters();
  assertTrue(filterListFilters.get(0) instanceof PrefixFilter);
  assertTrue(filterListFilters.get(1) instanceof QualifierFilter);
  assertEquals(filterList.getOperator(),FilterList.Operator.MUST_PASS_ALL);
  assertEquals(CompareFilter.CompareOp.EQUAL,familyFilter.getOperator());
  assertTrue(familyFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)familyFilter.getComparator();
  assertEquals("qualifier",new String(binaryComparator.getValue()));
  PrefixFilter prefixFilter=(PrefixFilter)filterListFilters.get(0);
  byte[] prefix=prefixFilter.getPrefix();
  assertEquals(new String(prefix),"realtime");
  QualifierFilter qualifierFilter=(QualifierFilter)filterListFilters.get(1);
  assertEquals(CompareFilter.CompareOp.GREATER_OR_EQUAL,qualifierFilter.getOperator());
  assertTrue(qualifierFilter.getComparator() instanceof BinaryComparator);
  binaryComparator=(BinaryComparator)qualifierFilter.getComparator();
  assertEquals("e",new String(binaryComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleColumnValueExcludeFilter() throws IOException {
  String filterString="SingleColumnValueExcludeFilter ('family', 'qualifier', <, 'binaryprefix:a')";
  SingleColumnValueExcludeFilter singleColumnValueExcludeFilter=doTestFilter(filterString,SingleColumnValueExcludeFilter.class);
  assertEquals(singleColumnValueExcludeFilter.getOperator(),CompareFilter.CompareOp.LESS);
  assertEquals("family",new String(singleColumnValueExcludeFilter.getFamily()));
  assertEquals("qualifier",new String(singleColumnValueExcludeFilter.getQualifier()));
  assertEquals(new String(singleColumnValueExcludeFilter.getComparator().getValue()),"a");
  assertFalse(singleColumnValueExcludeFilter.getFilterIfMissing());
  assertTrue(singleColumnValueExcludeFilter.getLatestVersionOnly());
  filterString="SingleColumnValueExcludeFilter " + "('family', 'qualifier', <=, 'binaryprefix:a', true, false)";
  singleColumnValueExcludeFilter=doTestFilter(filterString,SingleColumnValueExcludeFilter.class);
  assertEquals("family",new String(singleColumnValueExcludeFilter.getFamily()));
  assertEquals("qualifier",new String(singleColumnValueExcludeFilter.getQualifier()));
  assertEquals(singleColumnValueExcludeFilter.getOperator(),CompareFilter.CompareOp.LESS_OR_EQUAL);
  assertTrue(singleColumnValueExcludeFilter.getComparator() instanceof BinaryPrefixComparator);
  BinaryPrefixComparator binaryPrefixComparator=(BinaryPrefixComparator)singleColumnValueExcludeFilter.getComparator();
  assertEquals(new String(binaryPrefixComparator.getValue()),"a");
  assertTrue(singleColumnValueExcludeFilter.getFilterIfMissing());
  assertFalse(singleColumnValueExcludeFilter.getLatestVersionOnly());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnPaginationFilter() throws IOException {
  String filterString="ColumnPaginationFilter(4, 6)";
  ColumnPaginationFilter columnPaginationFilter=doTestFilter(filterString,ColumnPaginationFilter.class);
  int limit=columnPaginationFilter.getLimit();
  assertEquals(limit,4);
  int offset=columnPaginationFilter.getOffset();
  assertEquals(offset,6);
  filterString=" ColumnPaginationFilter('124')";
  try {
    doTestFilter(filterString,ColumnPaginationFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("ColumnPaginationFilter needs two arguments");
  }
  filterString=" ColumnPaginationFilter('4' , '123a')";
  try {
    doTestFilter(filterString,ColumnPaginationFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("ColumnPaginationFilter needs two ints as arguments");
  }
  filterString=" ColumnPaginationFilter('4' , '-123')";
  try {
    doTestFilter(filterString,ColumnPaginationFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("ColumnPaginationFilter arguments should not be negative");
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDependentColumnFilter() throws IOException {
  String filterString="DependentColumnFilter('family', 'qualifier', true, =, 'binary:abc')";
  DependentColumnFilter dependentColumnFilter=doTestFilter(filterString,DependentColumnFilter.class);
  assertEquals("family",new String(dependentColumnFilter.getFamily()));
  assertEquals("qualifier",new String(dependentColumnFilter.getQualifier()));
  assertTrue(dependentColumnFilter.getDropDependentColumn());
  assertEquals(CompareFilter.CompareOp.EQUAL,dependentColumnFilter.getOperator());
  assertTrue(dependentColumnFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)dependentColumnFilter.getComparator();
  assertEquals("abc",new String(binaryComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkipFilter() throws IOException {
  String filterString="SKIP ValueFilter( =,  'binary:0')";
  SkipFilter skipFilter=doTestFilter(filterString,SkipFilter.class);
  assertTrue(skipFilter.getFilter() instanceof ValueFilter);
  ValueFilter valueFilter=(ValueFilter)skipFilter.getFilter();
  assertEquals(CompareFilter.CompareOp.EQUAL,valueFilter.getOperator());
  assertTrue(valueFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)valueFilter.getComparator();
  assertEquals("0",new String(binaryComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleColumnValueFilter() throws IOException {
  String filterString="SingleColumnValueFilter " + "('family', 'qualifier', >=, 'binary:a', true, false)";
  SingleColumnValueFilter singleColumnValueFilter=doTestFilter(filterString,SingleColumnValueFilter.class);
  assertEquals("family",new String(singleColumnValueFilter.getFamily()));
  assertEquals("qualifier",new String(singleColumnValueFilter.getQualifier()));
  assertEquals(singleColumnValueFilter.getOperator(),CompareFilter.CompareOp.GREATER_OR_EQUAL);
  assertTrue(singleColumnValueFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)singleColumnValueFilter.getComparator();
  assertEquals(new String(binaryComparator.getValue()),"a");
  assertTrue(singleColumnValueFilter.getFilterIfMissing());
  assertFalse(singleColumnValueFilter.getLatestVersionOnly());
  filterString="SingleColumnValueFilter ('family', 'qualifier', >, 'binaryprefix:a')";
  singleColumnValueFilter=doTestFilter(filterString,SingleColumnValueFilter.class);
  assertEquals("family",new String(singleColumnValueFilter.getFamily()));
  assertEquals("qualifier",new String(singleColumnValueFilter.getQualifier()));
  assertEquals(singleColumnValueFilter.getOperator(),CompareFilter.CompareOp.GREATER);
  assertTrue(singleColumnValueFilter.getComparator() instanceof BinaryPrefixComparator);
  BinaryPrefixComparator binaryPrefixComparator=(BinaryPrefixComparator)singleColumnValueFilter.getComparator();
  assertEquals(new String(binaryPrefixComparator.getValue()),"a");
  assertFalse(singleColumnValueFilter.getFilterIfMissing());
  assertTrue(singleColumnValueFilter.getLatestVersionOnly());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWhileFilter() throws IOException {
  String filterString=" WHILE   RowFilter ( !=, 'binary:row1')";
  WhileMatchFilter whileMatchFilter=doTestFilter(filterString,WhileMatchFilter.class);
  assertTrue(whileMatchFilter.getFilter() instanceof RowFilter);
  RowFilter rowFilter=(RowFilter)whileMatchFilter.getFilter();
  assertEquals(CompareFilter.CompareOp.NOT_EQUAL,rowFilter.getOperator());
  assertTrue(rowFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)rowFilter.getComparator();
  assertEquals("row1",new String(binaryComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPageFilter() throws IOException {
  String filterString=" PageFilter(4)";
  PageFilter pageFilter=doTestFilter(filterString,PageFilter.class);
  long pageSize=pageFilter.getPageSize();
  assertEquals(pageSize,4);
  filterString=" PageFilter('123')";
  try {
    doTestFilter(filterString,PageFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println("PageFilter needs an int as an argument");
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnRangeFilter() throws IOException {
  String filterString="ColumnRangeFilter('abc', true, 'xyz', false)";
  ColumnRangeFilter columnRangeFilter=doTestFilter(filterString,ColumnRangeFilter.class);
  assertEquals("abc",new String(columnRangeFilter.getMinColumn()));
  assertEquals("xyz",new String(columnRangeFilter.getMaxColumn()));
  assertTrue(columnRangeFilter.isMinColumnInclusive());
  assertFalse(columnRangeFilter.isMaxColumnInclusive());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowFilter() throws IOException {
  String filterString="RowFilter ( =,   'binary:regionse')";
  RowFilter rowFilter=doTestFilter(filterString,RowFilter.class);
  assertEquals(CompareFilter.CompareOp.EQUAL,rowFilter.getOperator());
  assertTrue(rowFilter.getComparator() instanceof BinaryComparator);
  BinaryComparator binaryComparator=(BinaryComparator)rowFilter.getComparator();
  assertEquals("regionse",new String(binaryComparator.getValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnCountGetFilter() throws IOException {
  String filterString=" ColumnCountGetFilter(4)";
  ColumnCountGetFilter columnCountGetFilter=doTestFilter(filterString,ColumnCountGetFilter.class);
  int limit=columnCountGetFilter.getLimit();
  assertEquals(limit,4);
  filterString=" ColumnCountGetFilter('abc')";
  try {
    doTestFilter(filterString,ColumnCountGetFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println(e.getMessage());
  }
  filterString=" ColumnCountGetFilter(2147483648)";
  try {
    doTestFilter(filterString,ColumnCountGetFilter.class);
    assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    System.out.println(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueFilter() throws IOException {
  String filterString="ValueFilter(!=, 'substring:pre')";
  ValueFilter valueFilter=doTestFilter(filterString,ValueFilter.class);
  assertEquals(CompareFilter.CompareOp.NOT_EQUAL,valueFilter.getOperator());
  assertTrue(valueFilter.getComparator() instanceof SubstringComparator);
  SubstringComparator substringComparator=(SubstringComparator)valueFilter.getComparator();
  assertEquals("pre",new String(substringComparator.getValue()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestSingleColumnValueExcludeFilter </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the overridden functionality of filterKeyValue(KeyValue)
 * @throws Exception
 */
@Test public void testFilterKeyValue() throws Exception {
  Filter filter=new SingleColumnValueExcludeFilter(COLUMN_FAMILY,COLUMN_QUALIFIER,CompareOp.EQUAL,VAL_1);
  List<Cell> kvs=new ArrayList<Cell>();
  KeyValue kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER_2,VAL_1);
  kvs.add(new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER_2,VAL_1));
  kvs.add(new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_1));
  kvs.add(new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER_2,VAL_1));
  filter.filterRowCells(kvs);
  assertEquals("resultSize",kvs.size(),2);
  assertTrue("leftKV1",CellComparator.COMPARATOR.compare(kvs.get(0),kv) == 0);
  assertTrue("leftKV2",CellComparator.COMPARATOR.compare(kvs.get(1),kv) == 0);
  assertFalse("allRemainingWhenMatch",filter.filterAllRemaining());
  filter.reset();
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER_2,VAL_1);
  assertTrue("otherColumn",filter.filterKeyValue(kv) == Filter.ReturnCode.INCLUDE);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER,VAL_2);
  assertTrue("testedMismatch",filter.filterKeyValue(kv) == Filter.ReturnCode.NEXT_ROW);
  kv=new KeyValue(ROW,COLUMN_FAMILY,COLUMN_QUALIFIER_2,VAL_1);
  assertTrue("otherColumn",filter.filterKeyValue(kv) == Filter.ReturnCode.NEXT_ROW);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.fs.TestBlockReorder </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the hook works within HBase, including when there are multiple blocks.
 */
@Test() public void testHBaseCluster() throws Exception {
  byte[] sb="sb".getBytes();
  htu.startMiniZKCluster();
  MiniHBaseCluster hbm=htu.startMiniHBaseCluster(1,1);
  hbm.waitForActiveAndReadyMaster();
  HRegionServer targetRs=hbm.getMaster();
  String host4=targetRs.getServerName().getHostname();
  LOG.info("Starting a new datanode with the name=" + host4);
  cluster.startDataNodes(conf,1,true,null,new String[]{"/r4"},new String[]{host4},null);
  cluster.waitClusterUp();
  final int repCount=3;
  conf=targetRs.getConfiguration();
  HFileSystem rfs=(HFileSystem)targetRs.getFileSystem();
  Table h=htu.createTable(TableName.valueOf("table"),sb);
  String rootDir=new Path(FSUtils.getRootDir(conf) + "/" + HConstants.HREGION_LOGDIR_NAME+ "/"+ targetRs.getServerName().toString()).toUri().getPath();
  DistributedFileSystem mdfs=(DistributedFileSystem)hbm.getMaster().getMasterFileSystem().getFileSystem();
  int nbTest=0;
  while (nbTest < 10) {
    final List<Region> regions=targetRs.getOnlineRegions(h.getName());
    final CountDownLatch latch=new CountDownLatch(regions.size());
    final WALActionsListener listener=new WALActionsListener.Base(){
      @Override public void postLogRoll(      final Path oldPath,      final Path newPath) throws IOException {
        latch.countDown();
      }
    }
;
    for (    Region region : regions) {
      ((HRegion)region).getWAL().registerWALActionsListener(listener);
    }
    htu.getHBaseAdmin().rollWALWriter(targetRs.getServerName());
    try {
      latch.await();
    }
 catch (    InterruptedException exception) {
      LOG.warn("Interrupted while waiting for the wal of '" + targetRs + "' to roll. If later "+ "tests fail, it's probably because we should still be waiting.");
      Thread.currentThread().interrupt();
    }
    for (    Region region : regions) {
      ((HRegion)region).getWAL().unregisterWALActionsListener(listener);
    }
    Thread.sleep(100);
    Put p=new Put(sb);
    p.addColumn(sb,sb,sb);
    h.put(p);
    DirectoryListing dl=dfs.getClient().listPaths(rootDir,HdfsFileStatus.EMPTY_NAME);
    HdfsFileStatus[] hfs=dl.getPartialListing();
    Assert.assertTrue(hfs.length >= 1);
    for (    HdfsFileStatus hf : hfs) {
      try {
        LOG.info("Log file found: " + hf.getLocalName() + " in "+ rootDir);
        String logFile=rootDir + "/" + hf.getLocalName();
        FileStatus fsLog=rfs.getFileStatus(new Path(logFile));
        LOG.info("Checking log file: " + logFile);
        BlockLocation[] bls=rfs.getFileBlockLocations(fsLog,0,1);
        if (bls.length > 0) {
          BlockLocation bl=bls[0];
          LOG.info(bl.getHosts().length + " replicas for block 0 in " + logFile+ " ");
          for (int i=0; i < bl.getHosts().length - 1; i++) {
            LOG.info(bl.getHosts()[i] + "    " + logFile);
            Assert.assertNotSame(bl.getHosts()[i],host4);
          }
          String last=bl.getHosts()[bl.getHosts().length - 1];
          LOG.info(last + "    " + logFile);
          if (host4.equals(last)) {
            nbTest++;
            LOG.info(logFile + " is on the new datanode and is ok");
            if (bl.getHosts().length == 3) {
              testFromDFS(dfs,logFile,repCount,host4);
              testFromDFS(mdfs,logFile,repCount,host4);
            }
          }
        }
      }
 catch (      FileNotFoundException exception) {
        LOG.debug("Failed to find log file '" + hf.getLocalName() + "'; it probably was "+ "archived out from under us so we'll ignore and retry. If this test hangs "+ "indefinitely you should treat this failure as a symptom.",exception);
      }
catch (      RemoteException exception) {
        if (exception.unwrapRemoteException() instanceof FileNotFoundException) {
          LOG.debug("Failed to find log file '" + hf.getLocalName() + "'; it probably was "+ "archived out from under us so we'll ignore and retry. If this test hangs "+ "indefinitely you should treat this failure as a symptom.",exception);
        }
 else {
          throw exception;
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the reorder algo works as we expect.
 */
@Test public void testBlockLocation() throws Exception {
  htu.startMiniZKCluster();
  MiniHBaseCluster hbm=htu.startMiniHBaseCluster(1,1);
  conf=hbm.getConfiguration();
  final String fileName="/helloWorld";
  Path p=new Path(fileName);
  final int repCount=3;
  Assert.assertTrue((short)cluster.getDataNodes().size() >= repCount);
  FSDataOutputStream fop=dfs.create(p,(short)repCount);
  final double toWrite=875.5613;
  fop.writeDouble(toWrite);
  fop.close();
  for (int i=0; i < 10; i++) {
    LocatedBlocks l;
    final long max=System.currentTimeMillis() + 10000;
    do {
      l=getNamenode(dfs.getClient()).getBlockLocations(fileName,0,1);
      Assert.assertNotNull(l.getLocatedBlocks());
      Assert.assertEquals(l.getLocatedBlocks().size(),1);
      Assert.assertTrue("Expecting " + repCount + " , got "+ l.get(0).getLocations().length,System.currentTimeMillis() < max);
    }
 while (l.get(0).getLocations().length != repCount);
    Object originalList[]=l.getLocatedBlocks().toArray();
    HFileSystem.ReorderWALBlocks lrb=new HFileSystem.ReorderWALBlocks();
    lrb.reorderBlocks(conf,l,fileName);
    Assert.assertArrayEquals(originalList,l.getLocatedBlocks().toArray());
    Assert.assertNotNull(conf.get(HConstants.HBASE_DIR));
    Assert.assertFalse(conf.get(HConstants.HBASE_DIR).isEmpty());
    String pseudoLogFile=conf.get(HConstants.HBASE_DIR) + "/" + HConstants.HREGION_LOGDIR_NAME+ "/"+ host1+ ",6977,6576"+ "/mylogfile";
    Assert.assertNotNull("log= " + pseudoLogFile,DefaultWALProvider.getServerNameFromWALDirectoryName(dfs.getConf(),pseudoLogFile));
    lrb.reorderBlocks(conf,l,pseudoLogFile);
    Assert.assertEquals(host1,l.get(0).getLocations()[2].getHostName());
    lrb.reorderBlocks(conf,l,pseudoLogFile);
    Assert.assertEquals(host1,l.get(0).getLocations()[2].getHostName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpRequestLog </h4><pre class="type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppenderDefined(){
  HttpRequestLogAppender requestLogAppender=new HttpRequestLogAppender();
  requestLogAppender.setName("testrequestlog");
  Logger.getLogger("http.requests.test").addAppender(requestLogAppender);
  RequestLog requestLog=HttpRequestLog.getRequestLog("test");
  Logger.getLogger("http.requests.test").removeAppender(requestLogAppender);
  assertNotNull("RequestLog should not be null",requestLog);
  assertEquals("Class mismatch",NCSARequestLog.class,requestLog.getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpServer </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindAddress() throws Exception {
  checkBindAddress("localhost",0,false).stop();
  HttpServer myServer=checkBindAddress("localhost",0,false);
  HttpServer myServer2=null;
  try {
    int port=myServer.getConnectorAddress(0).getPort();
    myServer2=checkBindAddress("localhost",port,true);
    port=myServer2.getConnectorAddress(0).getPort();
    myServer2.stop();
    assertNull(myServer2.getConnectorAddress(0));
    myServer2.openListeners();
    assertEquals(port,myServer2.getConnectorAddress(0).getPort());
  }
  finally {
    myServer.stop();
    if (myServer2 != null) {
      myServer2.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testContentTypes() throws Exception {
  URL cssUrl=new URL(baseUrl,"/static/test.css");
  HttpURLConnection conn=(HttpURLConnection)cssUrl.openConnection();
  conn.connect();
  assertEquals(200,conn.getResponseCode());
  assertEquals("text/css",conn.getContentType());
  URL servletUrl=new URL(baseUrl,"/echo?a=b");
  conn=(HttpURLConnection)servletUrl.openConnection();
  conn.connect();
  assertEquals(200,conn.getResponseCode());
  assertEquals("text/plain; charset=utf-8",conn.getContentType());
  servletUrl=new URL(baseUrl,"/echo?a=b.css");
  conn=(HttpURLConnection)servletUrl.openConnection();
  conn.connect();
  assertEquals(200,conn.getResponseCode());
  assertEquals("text/plain; charset=utf-8",conn.getContentType());
  servletUrl=new URL(baseUrl,"/htmlcontent");
  conn=(HttpURLConnection)servletUrl.openConnection();
  conn.connect();
  assertEquals(200,conn.getResponseCode());
  assertEquals("text/html; charset=utf-8",conn.getContentType());
  servletUrl=new URL(baseUrl,"/testjsp.jsp");
  conn=(HttpURLConnection)servletUrl.openConnection();
  conn.connect();
  assertEquals(200,conn.getResponseCode());
  assertEquals("text/html; charset=utf-8",conn.getContentType());
}

</code></pre>

<br>
<pre class="type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the maximum number of threads cannot be exceeded. 
 */
@Test public void testMaxThreads() throws Exception {
  int clientThreads=MAX_THREADS * 10;
  Executor executor=Executors.newFixedThreadPool(clientThreads);
  final CountDownLatch ready=new CountDownLatch(clientThreads);
  final CountDownLatch start=new CountDownLatch(1);
  for (int i=0; i < clientThreads; i++) {
    executor.execute(new Runnable(){
      @Override public void run(){
        ready.countDown();
        try {
          start.await();
          assertEquals("a:b\nc:d\n",readOutput(new URL(baseUrl,"/echo?a=b&c=d")));
          int serverThreads=server.webServer.getThreadPool().getThreads();
          assertTrue("More threads are started than expected, Server Threads count: " + serverThreads,serverThreads <= MAX_THREADS);
          System.out.println("Number of threads = " + serverThreads + " which is less or equal than the max = "+ MAX_THREADS);
        }
 catch (        Exception e) {
        }
      }
    }
);
  }
  ready.await();
  start.countDown();
}

</code></pre>

<br>
<pre class="type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Verify the access for /logs, /stacks, /conf, /logLevel and /metrics
 * servlets, when authentication filters are set, but authorization is not
 * enabled.
 * @throws Exception 
 */
@Test @Ignore public void testDisabledAuthorizationOfDefaultServlets() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,DummyFilterInitializer.class.getName());
  conf.set(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,MyGroupsProvider.class.getName());
  Groups.getUserToGroupsMappingService(conf);
  MyGroupsProvider.clearMapping();
  MyGroupsProvider.mapping.put("userA",Arrays.asList("groupA"));
  MyGroupsProvider.mapping.put("userB",Arrays.asList("groupB"));
  HttpServer myServer=new HttpServer.Builder().setName("test").addEndpoint(new URI("http://localhost:0")).setFindPort(true).build();
  myServer.setAttribute(HttpServer.CONF_CONTEXT_ATTRIBUTE,conf);
  myServer.start();
  String serverURL="http://" + NetUtils.getHostPortString(myServer.getConnectorAddress(0)) + "/";
  for (  String servlet : new String[]{"conf","logs","stacks","logLevel","metrics"}) {
    for (    String user : new String[]{"userA","userB"}) {
      assertEquals(HttpURLConnection.HTTP_OK,getHttpStatusCode(serverURL + servlet,user));
    }
  }
  myServer.stop();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Verify the administrator access for /logs, /stacks, /conf, /logLevel and
 * /metrics servlets.
 * @throws Exception
 */
@Test @Ignore public void testAuthorizationOfDefaultServlets() throws Exception {
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.HADOOP_SECURITY_AUTHORIZATION,true);
  conf.setBoolean(CommonConfigurationKeys.HADOOP_SECURITY_INSTRUMENTATION_REQUIRES_ADMIN,true);
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,DummyFilterInitializer.class.getName());
  conf.set(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,MyGroupsProvider.class.getName());
  Groups.getUserToGroupsMappingService(conf);
  MyGroupsProvider.clearMapping();
  MyGroupsProvider.mapping.put("userA",Arrays.asList("groupA"));
  MyGroupsProvider.mapping.put("userB",Arrays.asList("groupB"));
  MyGroupsProvider.mapping.put("userC",Arrays.asList("groupC"));
  MyGroupsProvider.mapping.put("userD",Arrays.asList("groupD"));
  MyGroupsProvider.mapping.put("userE",Arrays.asList("groupE"));
  HttpServer myServer=new HttpServer.Builder().setName("test").addEndpoint(new URI("http://localhost:0")).setFindPort(true).setConf(conf).setACL(new AccessControlList("userA,userB groupC,groupD")).build();
  myServer.setAttribute(HttpServer.CONF_CONTEXT_ATTRIBUTE,conf);
  myServer.start();
  String serverURL="http://" + NetUtils.getHostPortString(myServer.getConnectorAddress(0)) + "/";
  for (  String servlet : new String[]{"conf","logs","stacks","logLevel","metrics"}) {
    for (    String user : new String[]{"userA","userB","userC","userD"}) {
      assertEquals(HttpURLConnection.HTTP_OK,getHttpStatusCode(serverURL + servlet,user));
    }
    assertEquals(HttpURLConnection.HTTP_UNAUTHORIZED,getHttpStatusCode(serverURL + servlet,"userE"));
  }
  myServer.stop();
}

</code></pre>

<br>
<pre class="type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoCacheHeader() throws Exception {
  URL url=new URL(baseUrl,"/echo?a=b&c=d");
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
  assertEquals("no-cache",conn.getHeaderField("Cache-Control"));
  assertEquals("no-cache",conn.getHeaderField("Pragma"));
  assertNotNull(conn.getHeaderField("Expires"));
  assertNotNull(conn.getHeaderField("Date"));
  assertEquals(conn.getHeaderField("Expires"),conn.getHeaderField("Date"));
  assertEquals("DENY",conn.getHeaderField("X-Frame-Options"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpServerLifecycle </h4><pre class="type-7 type-13 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test that the server is alive once started
 * @throws Throwableon failure
 */
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testWepAppContextAfterServerStop() throws Throwable {
  HttpServer server=null;
  String key="test.attribute.key";
  String value="test.attribute.value";
  server=createTestServer();
  assertNotLive(server);
  server.start();
  server.setAttribute(key,value);
  assertAlive(server);
  assertEquals(value,server.getAttribute(key));
  stop(server);
  assertNull("Server context should have cleared",server.getAttribute(key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestServletFilter </h4><pre class="type-9 type-10 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testServletFilter() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,SimpleFilter.Initializer.class.getName());
  HttpServer http=createTestServer(conf);
  http.start();
  final String fsckURL="/fsck";
  final String stacksURL="/stacks";
  final String ajspURL="/a.jsp";
  final String logURL="/logs/a.log";
  final String hadooplogoURL="/static/hadoop-logo.jpg";
  final String[] urls={fsckURL,stacksURL,ajspURL,logURL,hadooplogoURL};
  final Random ran=new Random();
  final int[] sequence=new int[50];
  for (int i=0; i < sequence.length; i++) {
    sequence[i]=ran.nextInt(urls.length);
  }
  final String prefix="http://" + NetUtils.getHostPortString(http.getConnectorAddress(0));
  try {
    for (int i=0; i < sequence.length; i++) {
      access(prefix + urls[sequence[i]]);
      if (sequence[i] == 0) {
        assertEquals(null,uri);
      }
 else {
        assertEquals(urls[sequence[i]],uri);
        uri=null;
      }
    }
  }
  finally {
    http.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServletFilterWhenInitThrowsException() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer.FILTER_INITIALIZERS_PROPERTY,ErrorFilter.Initializer.class.getName());
  HttpServer http=createTestServer(conf);
  try {
    http.start();
    fail("expecting exception");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Problem in starting http server. Server handlers failed"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.conf.TestConfServlet </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteXml() throws Exception {
  StringWriter sw=new StringWriter();
  ConfServlet.writeResponse(getTestConf(),sw,"xml");
  String xml=sw.toString();
  DocumentBuilderFactory docBuilderFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder builder=docBuilderFactory.newDocumentBuilder();
  Document doc=builder.parse(new InputSource(new StringReader(xml)));
  NodeList nameNodes=doc.getElementsByTagName("name");
  boolean foundSetting=false;
  for (int i=0; i < nameNodes.getLength(); i++) {
    Node nameNode=nameNodes.item(i);
    String key=nameNode.getTextContent();
    System.err.println("xml key: " + key);
    if (TEST_KEY.equals(key)) {
      foundSetting=true;
      Element propertyElem=(Element)nameNode.getParentNode();
      String val=propertyElem.getElementsByTagName("value").item(0).getTextContent();
      assertEquals(TEST_VAL,val);
    }
  }
  assertTrue(foundSetting);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadFormat() throws Exception {
  StringWriter sw=new StringWriter();
  try {
    ConfServlet.writeResponse(getTestConf(),sw,"not a format");
    fail("writeResponse with bad format didn't throw!");
  }
 catch (  ConfServlet.BadFormatException bfe) {
  }
  assertEquals("",sw.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.TestFileLink </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that link is still readable even when the current file gets deleted.
 * NOTE: This test is valid only on HDFS.
 * When a file is deleted from a local file-system, it is simply 'unlinked'.
 * The inode, which contains the file's data, is not deleted until all
 * processes have finished with it.
 * In HDFS when the request exceed the cached block locations,
 * a query to the namenode is performed, using the filename,
 * and the deleted file doesn't exists anymore (FileNotFoundException).
 */
@Test public void testHDFSLinkReadDuringDelete() throws Exception {
  HBaseTestingUtility testUtil=new HBaseTestingUtility();
  Configuration conf=testUtil.getConfiguration();
  conf.setInt("dfs.blocksize",1024 * 1024);
  conf.setInt("dfs.client.read.prefetch.size",2 * 1024 * 1024);
  testUtil.startMiniDFSCluster(1);
  MiniDFSCluster cluster=testUtil.getDFSCluster();
  FileSystem fs=cluster.getFileSystem();
  assertEquals("hdfs",fs.getUri().getScheme());
  try {
    List<Path> files=new ArrayList<Path>();
    for (int i=0; i < 3; i++) {
      Path path=new Path(String.format("test-data-%d",i));
      writeSomeData(fs,path,1 << 20,(byte)i);
      files.add(path);
    }
    FileLink link=new FileLink(files);
    FSDataInputStream in=link.open(fs);
    try {
      byte[] data=new byte[8192];
      int n;
      n=in.read(data);
      dataVerify(data,n,(byte)0);
      fs.delete(files.get(0),true);
      skipBuffer(in,(byte)0);
      n=in.read(data);
      dataVerify(data,n,(byte)1);
      fs.delete(files.get(1),true);
      skipBuffer(in,(byte)1);
      n=in.read(data);
      dataVerify(data,n,(byte)2);
      fs.delete(files.get(2),true);
      skipBuffer(in,(byte)2);
      try {
        n=in.read(data);
        assert (n <= 0);
      }
 catch (      FileNotFoundException e) {
        assertTrue(true);
      }
    }
  finally {
      in.close();
    }
  }
  finally {
    testUtil.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.TestHFileLink </h4><pre class="type-4 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidLinkNames(){
  String validLinkNames[]={"foo=fefefe-0123456","ns=foo=abababa-fefefefe"};
  for (  String name : validLinkNames) {
    Assert.assertTrue("Failed validating:" + name,name.matches(HFileLink.LINK_NAME_REGEX));
  }
  for (  String name : validLinkNames) {
    Assert.assertTrue("Failed validating:" + name,HFileLink.isHFileLink(name));
  }
  String testName="foo=fefefe-0123456";
  Assert.assertEquals(TableName.valueOf("foo"),HFileLink.getReferencedTableName(testName));
  Assert.assertEquals("fefefe",HFileLink.getReferencedRegionName(testName));
  Assert.assertEquals("0123456",HFileLink.getReferencedHFileName(testName));
  Assert.assertEquals(testName,HFileLink.createHFileLinkName(TableName.valueOf("foo"),"fefefe","0123456"));
  testName="ns=foo=fefefe-0123456";
  Assert.assertEquals(TableName.valueOf("ns","foo"),HFileLink.getReferencedTableName(testName));
  Assert.assertEquals("fefefe",HFileLink.getReferencedRegionName(testName));
  Assert.assertEquals("0123456",HFileLink.getReferencedHFileName(testName));
  Assert.assertEquals(testName,HFileLink.createHFileLinkName(TableName.valueOf("ns","foo"),"fefefe","0123456"));
  for (  String name : validLinkNames) {
    Matcher m=HFileLink.LINK_NAME_PATTERN.matcher(name);
    assertTrue(m.matches());
    Assert.assertEquals(HFileLink.getReferencedTableName(name),TableName.valueOf(m.group(1),m.group(2)));
    Assert.assertEquals(HFileLink.getReferencedRegionName(name),m.group(3));
    Assert.assertEquals(HFileLink.getReferencedHFileName(name),m.group(4));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.TestHalfStoreFileReader </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHalfScanner() throws IOException {
  String root_dir=TEST_UTIL.getDataTestDir().toString();
  Path p=new Path(root_dir,"test");
  Configuration conf=TEST_UTIL.getConfiguration();
  FileSystem fs=FileSystem.get(conf);
  CacheConfig cacheConf=new CacheConfig(conf);
  HFileContext meta=new HFileContextBuilder().withBlockSize(1024).build();
  HFile.Writer w=HFile.getWriterFactory(conf,cacheConf).withPath(fs,p).withFileContext(meta).create();
  List<KeyValue> items=genSomeKeys();
  for (  KeyValue kv : items) {
    w.append(kv);
  }
  w.close();
  HFile.Reader r=HFile.createReader(fs,p,cacheConf,conf);
  r.loadFileInfo();
  Cell midKV=r.midkey();
  byte[] midkey=CellUtil.cloneRow(midKV);
  Reference bottom=new Reference(midkey,Reference.Range.bottom);
  Reference top=new Reference(midkey,Reference.Range.top);
  KeyValue beforeMidKey=null;
  for (  KeyValue item : items) {
    if (CellComparator.COMPARATOR.compare(item,midKV) >= 0) {
      break;
    }
    beforeMidKey=item;
  }
  System.out.println("midkey: " + midKV + " or: "+ Bytes.toStringBinary(midkey));
  System.out.println("beforeMidKey: " + beforeMidKey);
  Cell foundKeyValue=doTestOfSeekBefore(p,fs,bottom,midKV,cacheConf);
  assertEquals(beforeMidKey,foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,top,items.get(items.size() - 1),cacheConf);
  assertEquals(items.get(items.size() - 2),foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,bottom,items.get(items.size() - 1),cacheConf);
  assertEquals(beforeMidKey,foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,top,items.get(0),cacheConf);
  assertNull(foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,bottom,items.get(0),cacheConf);
  assertNull(foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,top,items.get(1),cacheConf);
  assertNull(foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,bottom,items.get(1),cacheConf);
  assertEquals(items.get(0),foundKeyValue);
  foundKeyValue=doTestOfSeekBefore(p,fs,top,midKV,cacheConf);
  assertNull(foundKeyValue);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.TestCipherProvider </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomProvider(){
  Configuration conf=HBaseConfiguration.create();
  conf.set(HConstants.CRYPTO_CIPHERPROVIDER_CONF_KEY,MyCipherProvider.class.getName());
  CipherProvider provider=Encryption.getCipherProvider(conf);
  assertTrue(provider instanceof MyCipherProvider);
  assertTrue(Arrays.asList(provider.getSupportedCiphers()).contains("TEST"));
  Cipher a=Encryption.getCipher(conf,"TEST");
  assertNotNull(a);
  assertTrue(a.getProvider() instanceof MyCipherProvider);
  assertEquals(a.getName(),"TEST");
  assertEquals(a.getKeyLength(),0);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultProvider(){
  Configuration conf=HBaseConfiguration.create();
  CipherProvider provider=Encryption.getCipherProvider(conf);
  assertTrue(provider instanceof DefaultCipherProvider);
  String algorithm=conf.get(HConstants.CRYPTO_KEY_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  assertTrue(Arrays.asList(provider.getSupportedCiphers()).contains(algorithm));
  Cipher a=Encryption.getCipher(conf,algorithm);
  assertNotNull(a);
  assertTrue(a.getProvider() instanceof DefaultCipherProvider);
  assertEquals(a.getName(),algorithm);
  assertEquals(a.getKeyLength(),AES.KEY_LENGTH);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.TestKeyProvider </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestProvider(){
  Configuration conf=HBaseConfiguration.create();
  conf.set(HConstants.CRYPTO_KEYPROVIDER_CONF_KEY,KeyProviderForTesting.class.getName());
  KeyProvider provider=Encryption.getKeyProvider(conf);
  assertNotNull("Null returned for provider",provider);
  assertTrue("Provider is not the expected type",provider instanceof KeyProviderForTesting);
  Key key=provider.getKey("foo");
  assertNotNull("Test provider did not return a key as expected",key);
  assertEquals("Test provider did not create a key for AES",key.getAlgorithm(),"AES");
  assertEquals("Test provider did not create a key of adequate length",key.getEncoded().length,AES.KEY_LENGTH);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.TestKeyStoreKeyProvider </h4><pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testKeyStoreKeyProviderWithPassword() throws Exception {
  KeyProvider provider=new KeyStoreKeyProvider();
  provider.init("jceks://" + storeFile.toURI().getPath() + "?password="+ PASSWORD);
  Key key=provider.getKey(ALIAS);
  assertNotNull(key);
  byte[] keyBytes=key.getEncoded();
  assertEquals(keyBytes.length,KEY.length);
  for (int i=0; i < KEY.length; i++) {
    assertEquals(keyBytes[i],KEY[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testKeyStoreKeyProviderWithPasswordFile() throws Exception {
  KeyProvider provider=new KeyStoreKeyProvider();
  provider.init("jceks://" + storeFile.toURI().getPath() + "?passwordFile="+ URLEncoder.encode(passwordFile.getAbsolutePath(),"UTF-8"));
  Key key=provider.getKey(ALIAS);
  assertNotNull(key);
  byte[] keyBytes=key.getEncoded();
  assertEquals(keyBytes.length,KEY.length);
  for (int i=0; i < KEY.length; i++) {
    assertEquals(keyBytes[i],KEY[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.aes.TestAES </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAESAlgorithm() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  Cipher aes=Encryption.getCipher(conf,"AES");
  assertEquals(aes.getKeyLength(),AES.KEY_LENGTH);
  assertEquals(aes.getIvLength(),AES.IV_LENGTH);
  Encryptor e=aes.getEncryptor();
  e.setKey(new SecretKeySpec(Bytes.fromHex("2b7e151628aed2a6abf7158809cf4f3c"),"AES"));
  e.setIv(Bytes.fromHex("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"));
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  OutputStream cout=e.createEncryptionStream(out);
  cout.write(Bytes.fromHex("6bc1bee22e409f96e93d7e117393172a"));
  cout.write(Bytes.fromHex("ae2d8a571e03ac9c9eb76fac45af8e51"));
  cout.write(Bytes.fromHex("30c81c46a35ce411e5fbc1191a0a52ef"));
  cout.write(Bytes.fromHex("f69f2445df4f9b17ad2b417be66c3710"));
  cout.close();
  ByteArrayInputStream in=new ByteArrayInputStream(out.toByteArray());
  byte[] b=new byte[16];
  IOUtils.readFully(in,b);
  assertTrue("Failed #1",Bytes.equals(b,Bytes.fromHex("874d6191b620e3261bef6864990db6ce")));
  IOUtils.readFully(in,b);
  assertTrue("Failed #2",Bytes.equals(b,Bytes.fromHex("9806f66b7970fdff8617187bb9fffdff")));
  IOUtils.readFully(in,b);
  assertTrue("Failed #3",Bytes.equals(b,Bytes.fromHex("5ae4df3edbd5d35e5b4f09020db03eab")));
  IOUtils.readFully(in,b);
  assertTrue("Failed #4",Bytes.equals(b,Bytes.fromHex("1e031dda2fbe03d1792170a0f3009cee")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestEncodedSeekers </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncodedSeeker() throws IOException {
  System.err.println("Testing encoded seekers for encoding : " + encoding + ", includeTags : "+ includeTags+ ", compressTags : "+ compressTags);
  if (includeTags) {
    testUtil.getConfiguration().setInt(HFile.FORMAT_VERSION_KEY,3);
  }
  LruBlockCache cache=(LruBlockCache)new CacheConfig(testUtil.getConfiguration()).getBlockCache();
  cache.clearCache();
  HColumnDescriptor hcd=(new HColumnDescriptor(CF_NAME)).setMaxVersions(MAX_VERSIONS).setDataBlockEncoding(encoding).setBlocksize(BLOCK_SIZE).setBloomFilterType(BloomType.NONE).setCompressTags(compressTags);
  Region region=testUtil.createTestRegion(TABLE_NAME,hcd);
  doPuts(region);
  doGets(region);
  region.compact(false);
  doGets(region);
  Map<DataBlockEncoding,Integer> encodingCounts=cache.getEncodingCountsForTest();
  System.err.println("encodingCounts=" + encodingCounts);
  assertEquals(1,encodingCounts.size());
  DataBlockEncoding encodingInCache=encodingCounts.keySet().iterator().next();
  assertEquals(encoding,encodingInCache);
  assertTrue(encodingCounts.get(encodingInCache) > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestPrefixTree </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHBASE11728() throws Exception {
  Put put=new Put(Bytes.toBytes("a-b-0-0"));
  put.addColumn(fam,qual1,Bytes.toBytes("c1-value"));
  region.put(put);
  put=new Put(row1_bytes);
  put.addColumn(fam,qual1,Bytes.toBytes("c1-value"));
  region.put(put);
  put=new Put(row2_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value"));
  region.put(put);
  put=new Put(row3_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value-2"));
  region.put(put);
  put=new Put(row4_bytes);
  put.addColumn(fam,qual2,Bytes.toBytes("c2-value-3"));
  region.put(put);
  region.flush(true);
  String[] rows=new String[3];
  rows[0]=row1;
  rows[1]=row2;
  rows[2]=row3;
  byte[][] val=new byte[3][];
  val[0]=Bytes.toBytes("c1-value");
  val[1]=Bytes.toBytes("c2-value");
  val[2]=Bytes.toBytes("c2-value-2");
  Scan scan=new Scan();
  scan.setStartRow(row1_bytes);
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  RegionScanner scanner=region.getScanner(scan);
  List<Cell> cells=new ArrayList<Cell>();
  for (int i=0; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
      assertEquals(Bytes.toString(val[i]),Bytes.toString(cellScanner.current().getValueArray(),cellScanner.current().getValueOffset(),cellScanner.current().getValueLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(row1_bytes);
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  for (int i=1; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(Bytes.toBytes("a-b-A-1-"));
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  for (int i=1; i < 3; i++) {
    assertEquals(i < 2,scanner.next(cells));
    CellScanner cellScanner=Result.create(cells).cellScanner();
    while (cellScanner.advance()) {
      assertEquals(rows[i],Bytes.toString(cellScanner.current().getRowArray(),cellScanner.current().getRowOffset(),cellScanner.current().getRowLength()));
    }
    cells.clear();
  }
  scanner.close();
  scan=new Scan();
  scan.addColumn(fam,qual2);
  scan.setStartRow(Bytes.toBytes("a-b-A-1-140239"));
  scan.setStopRow(Bytes.toBytes("a-b-A-1:"));
  scanner=region.getScanner(scan);
  assertFalse(scanner.next(cells));
  assertFalse(cells.isEmpty());
  scanner.close();
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHBASE12817() throws IOException {
  for (int i=0; i < 100; i++) {
    region.put(new Put(Bytes.toBytes("obj" + (2900 + i))).addColumn(fam,qual1,Bytes.toBytes(i)));
  }
  region.put(new Put(Bytes.toBytes("obj299")).addColumn(fam,qual1,Bytes.toBytes("whatever")));
  region.put(new Put(Bytes.toBytes("obj29")).addColumn(fam,qual1,Bytes.toBytes("whatever")));
  region.put(new Put(Bytes.toBytes("obj2")).addColumn(fam,qual1,Bytes.toBytes("whatever")));
  region.put(new Put(Bytes.toBytes("obj3")).addColumn(fam,qual1,Bytes.toBytes("whatever")));
  region.flush(true);
  Scan scan=new Scan(Bytes.toBytes("obj29995"));
  RegionScanner scanner=region.getScanner(scan);
  List<Cell> cells=new ArrayList<Cell>();
  assertFalse(scanner.next(cells));
  assertArrayEquals(Bytes.toBytes("obj3"),Result.create(cells).getRow());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestPrefixTreeEncoding </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithRandomData() throws Exception {
  PrefixTreeCodec encoder=new PrefixTreeCodec();
  ByteArrayOutputStream baosInMemory=new ByteArrayOutputStream();
  DataOutputStream userDataStream=new DataOutputStream(baosInMemory);
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(false).withIncludesTags(includesTag).withCompression(Algorithm.NONE).build();
  HFileBlockEncodingContext blkEncodingCtx=new HFileBlockDefaultEncodingContext(DataBlockEncoding.PREFIX_TREE,new byte[0],meta);
  generateRandomTestData(kvset,numBatchesWritten++,includesTag,encoder,blkEncodingCtx,userDataStream);
  EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  byte[] onDiskBytes=baosInMemory.toByteArray();
  ByteBuffer readBuffer=ByteBuffer.wrap(onDiskBytes,DataBlockEncoding.ID_SIZE,onDiskBytes.length - DataBlockEncoding.ID_SIZE);
  seeker.setCurrentBuffer(new SingleByteBuff(readBuffer));
  Cell previousKV=null;
  do {
    Cell currentKV=seeker.getCell();
    System.out.println(currentKV);
    if (previousKV != null && CellComparator.COMPARATOR.compare(currentKV,previousKV) < 0) {
      dumpInputKVSet();
      fail("Current kv " + currentKV + " is smaller than previous keyvalue "+ previousKV);
    }
    if (!includesTag) {
      assertFalse(currentKV.getTagsLength() > 0);
    }
 else {
      Assert.assertTrue(currentKV.getTagsLength() > 0);
    }
    previousKV=currentKV;
  }
 while (seeker.next());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSeekBeforeWithFixedData() throws Exception {
  formatRowNum=true;
  PrefixTreeCodec encoder=new PrefixTreeCodec();
  int batchId=numBatchesWritten++;
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(false).withIncludesTags(includesTag).withCompression(Algorithm.NONE).build();
  HFileBlockEncodingContext blkEncodingCtx=new HFileBlockDefaultEncodingContext(DataBlockEncoding.PREFIX_TREE,new byte[0],meta);
  ByteArrayOutputStream baosInMemory=new ByteArrayOutputStream();
  DataOutputStream userDataStream=new DataOutputStream(baosInMemory);
  generateFixedTestData(kvset,batchId,false,includesTag,encoder,blkEncodingCtx,userDataStream);
  EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  byte[] onDiskBytes=baosInMemory.toByteArray();
  ByteBuffer readBuffer=ByteBuffer.wrap(onDiskBytes,DataBlockEncoding.ID_SIZE,onDiskBytes.length - DataBlockEncoding.ID_SIZE);
  seeker.setCurrentBuffer(new SingleByteBuff(readBuffer));
  Cell seekKey=CellUtil.createFirstDeleteFamilyCellOnRow(getRowKey(batchId,0),CF_BYTES);
  seeker.seekToKeyInBlock(seekKey,true);
  assertEquals(null,seeker.getCell());
  seekKey=CellUtil.createFirstDeleteFamilyCellOnRow(getRowKey(batchId,NUM_ROWS_PER_BATCH / 3),CF_BYTES);
  seeker.seekToKeyInBlock(seekKey,true);
  assertNotNull(seeker.getCell());
  assertArrayEquals(getRowKey(batchId,NUM_ROWS_PER_BATCH / 3 - 1),CellUtil.cloneRow(seeker.getCell()));
  seekKey=CellUtil.createFirstDeleteFamilyCellOnRow(Bytes.toBytes("zzzz"),CF_BYTES);
  seeker.seekToKeyInBlock(seekKey,true);
  assertNotNull(seeker.getCell());
  assertArrayEquals(getRowKey(batchId,NUM_ROWS_PER_BATCH - 1),CellUtil.cloneRow(seeker.getCell()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestCacheConfig </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that when BUCKET_CACHE_COMBINED_KEY is false, the non-default, that we deploy
 * LruBlockCache as L1 with a BucketCache for L2.
 */
@Test(timeout=10000) public void testBucketCacheConfigL1L2Setup(){
  this.conf.set(HConstants.BUCKET_CACHE_IOENGINE_KEY,"offheap");
  this.conf.setFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,0.001f);
  MemoryUsage mu=ManagementFactory.getMemoryMXBean().getHeapMemoryUsage();
  long lruExpectedSize=CacheConfig.getLruCacheSize(this.conf,mu);
  final int bcSize=100;
  long bcExpectedSize=100 * 1024 * 1024;
  assertTrue(lruExpectedSize < bcExpectedSize);
  this.conf.setInt(HConstants.BUCKET_CACHE_SIZE_KEY,bcSize);
  this.conf.setBoolean(CacheConfig.BUCKET_CACHE_COMBINED_KEY,false);
  CacheConfig cc=new CacheConfig(this.conf);
  basicBlockCacheOps(cc,false,false);
  assertTrue(cc.getBlockCache() instanceof LruBlockCache);
  LruBlockCache lbc=(LruBlockCache)cc.getBlockCache();
  assertEquals(lruExpectedSize,lbc.getMaxSize());
  BlockCache bc=lbc.getVictimHandler();
  assertEquals(bcExpectedSize,((BucketCache)bc).getMaxSize());
  long initialL1BlockCount=lbc.getBlockCount();
  long initialL2BlockCount=bc.getBlockCount();
  Cacheable c=new DataCacheEntry();
  BlockCacheKey bck=new BlockCacheKey("bck",0);
  lbc.cacheBlock(bck,c,false,false);
  assertEquals(initialL1BlockCount + 1,lbc.getBlockCount());
  assertEquals(initialL2BlockCount,bc.getBlockCount());
  final long justTooBigSize=lbc.acceptableSize() + 1;
  lbc.cacheBlock(new BlockCacheKey("bck2",0),new DataCacheEntry(){
    @Override public long heapSize(){
      return justTooBigSize;
    }
    @Override public int getSerializedLength(){
      return (int)heapSize();
    }
  }
);
  while (initialL1BlockCount != lbc.getBlockCount())   Threads.sleep(10);
  assertEquals(initialL1BlockCount,lbc.getBlockCount());
  long count=bc.getBlockCount();
  assertTrue(initialL2BlockCount + 1 <= count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestChecksum </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test all checksum types by writing and reading back blocks.
 */
@Test public void testAllChecksumTypes() throws IOException {
  List<ChecksumType> cktypes=new ArrayList<>(Arrays.asList(ChecksumType.values()));
  for (Iterator<ChecksumType> itr=cktypes.iterator(); itr.hasNext(); ) {
    ChecksumType cktype=itr.next();
    Path path=new Path(TEST_UTIL.getDataTestDir(),"checksum" + cktype.getName());
    FSDataOutputStream os=fs.create(path);
    HFileContext meta=new HFileContextBuilder().withChecksumType(cktype).build();
    HFileBlock.Writer hbw=new HFileBlock.Writer(null,meta);
    DataOutputStream dos=hbw.startWriting(BlockType.DATA);
    for (int i=0; i < 1000; ++i)     dos.writeInt(i);
    hbw.writeHeaderAndData(os);
    int totalSize=hbw.getOnDiskSizeWithHeader();
    os.close();
    assertEquals(true,hfs.useHBaseChecksum());
    FSDataInputStreamWrapper is=new FSDataInputStreamWrapper(fs,path);
    meta=new HFileContextBuilder().withHBaseCheckSum(true).build();
    HFileBlock.FSReader hbr=new HFileBlock.FSReaderImpl(is,totalSize,(HFileSystem)fs,path,meta);
    HFileBlock b=hbr.readBlockData(0,-1,-1,false);
    ByteBuff data=b.getBufferWithoutHeader();
    for (int i=0; i < 1000; i++) {
      assertEquals(i,data.getInt());
    }
    boolean exception_thrown=false;
    try {
      data.getInt();
    }
 catch (    BufferUnderflowException e) {
      exception_thrown=true;
    }
    assertTrue(exception_thrown);
    assertEquals(0,HFile.getChecksumFailuresCount());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestFixedFileTrailer </h4><pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrailer() throws IOException {
  FixedFileTrailer t=new FixedFileTrailer(version,HFileReaderImpl.PBUF_TRAILER_MINOR_VERSION);
  t.setDataIndexCount(3);
  t.setEntryCount(((long)Integer.MAX_VALUE) + 1);
  t.setLastDataBlockOffset(291);
  t.setNumDataIndexLevels(3);
  t.setComparatorClass(CellComparator.COMPARATOR.getClass());
  t.setFirstDataBlockOffset(9081723123L);
  t.setUncompressedDataIndexSize(827398717L);
  t.setLoadOnOpenOffset(128);
  t.setMetaIndexCount(7);
  t.setTotalUncompressedBytes(129731987);
{
    DataOutputStream dos=new DataOutputStream(baos);
    t.serialize(dos);
    dos.flush();
    assertEquals(dos.size(),FixedFileTrailer.getTrailerSize(version));
  }
  byte[] bytes=baos.toByteArray();
  baos.reset();
  assertEquals(bytes.length,FixedFileTrailer.getTrailerSize(version));
  ByteArrayInputStream bais=new ByteArrayInputStream(bytes);
{
    DataInputStream dis=new DataInputStream(bais);
    FixedFileTrailer t2=new FixedFileTrailer(version,HFileReaderImpl.PBUF_TRAILER_MINOR_VERSION);
    t2.deserialize(dis);
    assertEquals(-1,bais.read());
    checkLoadedTrailer(version,t,t2);
  }
  Path trailerPath=new Path(util.getDataTestDir(),"trailer_" + version);
{
    for (    byte invalidVersion : new byte[]{HFile.MIN_FORMAT_VERSION - 1,HFile.MAX_FORMAT_VERSION + 1}) {
      bytes[bytes.length - 1]=invalidVersion;
      writeTrailer(trailerPath,null,bytes);
      try {
        readTrailer(trailerPath);
        fail("Exception expected");
      }
 catch (      IllegalArgumentException ex) {
        String msg=ex.getMessage();
        String cleanMsg=msg.replaceAll("^(java(\\.[a-zA-Z]+)+:\\s+)?|\\s+\\(.*\\)\\s*$","");
        assertEquals("Actual exception message is \"" + msg + "\".\n"+ "Cleaned-up message","Invalid HFile version: " + invalidVersion,cleanMsg);
        LOG.info("Got an expected exception: " + msg);
      }
    }
  }
  writeTrailer(trailerPath,t,null);
  FixedFileTrailer t4=readTrailer(trailerPath);
  checkLoadedTrailer(version,t,t4);
  String trailerStr=t.toString();
  assertEquals("Invalid number of fields in the string representation " + "of the trailer: " + trailerStr,NUM_FIELDS_BY_VERSION[version - 2],trailerStr.split(", ").length);
  assertEquals(trailerStr,t4.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks </h4><pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheBlocks() throws IOException {
  TEST_UTIL.getConfiguration().setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,BLOCK_SIZE);
  HColumnDescriptor hcd=new HColumnDescriptor(Bytes.toBytes(CF)).setMaxVersions(MAX_VERSIONS).setCompressionType(COMPRESSION_ALGORITHM).setBloomFilterType(BLOOM_TYPE);
  hcd.setBlocksize(BLOCK_SIZE);
  hcd.setBlockCacheEnabled(cfCacheEnabled);
  Region region=TEST_UTIL.createTestRegion(TABLE,hcd);
  BlockCache cache=region.getStore(hcd.getName()).getCacheConfig().getBlockCache();
  CacheStats stats=cache.getStats();
  writeTestData(region);
  assertEquals(0,stats.getHitCount());
  assertEquals(0,HFile.dataBlockReadCnt.get());
  region.get(new Get(Bytes.toBytes("row" + 0)));
  assertTrue(stats.getHitCount() > 0);
  assertTrue(HFile.dataBlockReadCnt.get() > 0);
  long missCount=stats.getMissCount();
  region.get(new Get(Bytes.toBytes("row" + 0)));
  if (this.cfCacheEnabled)   assertEquals(missCount,stats.getMissCount());
 else   assertTrue(stats.getMissCount() > missCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFile </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetShortMidpoint(){
  Cell left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  Cell right=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  Cell mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) <= 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) <= 0);
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("b"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) <= 0);
  left=CellUtil.createCell(Bytes.toBytes("g"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("i"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) <= 0);
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("bbbbbbb"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) < 0);
  assertEquals(1,(int)mid.getRowLength());
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("a"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) <= 0);
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("aaaaaaaa"),Bytes.toBytes("b"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) < 0);
  assertEquals(2,(int)mid.getFamilyLength());
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("aaaaaaaaa"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) < 0);
  assertEquals(2,(int)mid.getQualifierLength());
  left=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("a"),Bytes.toBytes("a"),Bytes.toBytes("b"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.COMPARATOR,left,right);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.COMPARATOR.compareKeyIgnoresMvcc(mid,right) <= 0);
  assertEquals(1,(int)mid.getQualifierLength());
  left=CellUtil.createCell(Bytes.toBytes("g"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  right=CellUtil.createCell(Bytes.toBytes("i"),Bytes.toBytes("a"),Bytes.toBytes("a"));
  mid=HFileWriterImpl.getMidpoint(CellComparator.META_COMPARATOR,left,right);
  assertTrue(CellComparator.META_COMPARATOR.compareKeyIgnoresMvcc(left,mid) < 0);
  assertTrue(CellComparator.META_COMPARATOR.compareKeyIgnoresMvcc(mid,right) == 0);
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] family=Bytes.toBytes("family");
  byte[] qualA=Bytes.toBytes("qfA");
  byte[] qualB=Bytes.toBytes("qfB");
  final CellComparator keyComparator=CellComparator.COMPARATOR;
  long ts=5;
  KeyValue kv1=new KeyValue(Bytes.toBytes("the quick brown fox"),family,qualA,ts,Type.Put);
  KeyValue kv2=new KeyValue(Bytes.toBytes("the who test text"),family,qualA,ts,Type.Put);
  Cell newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) > 0);
  byte[] expectedArray=Bytes.toBytes("the r");
  Bytes.equals(newKey.getRowArray(),newKey.getRowOffset(),newKey.getRowLength(),expectedArray,0,expectedArray.length);
  kv1=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,5,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,0,Type.Put);
  assertTrue(keyComparator.compare(kv1,kv2) < 0);
  newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) == 0);
  kv1=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,-5,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,-10,Type.Put);
  assertTrue(keyComparator.compare(kv1,kv2) < 0);
  newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) == 0);
  kv1=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,5,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualB,5,Type.Put);
  assertTrue(keyComparator.compare(kv1,kv2) < 0);
  newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) > 0);
  assertTrue(Arrays.equals(CellUtil.cloneFamily(newKey),family));
  assertTrue(Arrays.equals(CellUtil.cloneQualifier(newKey),qualB));
  assertTrue(newKey.getTimestamp() == HConstants.LATEST_TIMESTAMP);
  assertTrue(newKey.getTypeByte() == Type.Maximum.getCode());
  final CellComparator metaKeyComparator=CellComparator.META_COMPARATOR;
  kv1=new KeyValue(Bytes.toBytes("ilovehbase123"),family,qualA,5,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("ilovehbase234"),family,qualA,0,Type.Put);
  newKey=HFileWriterImpl.getMidpoint(metaKeyComparator,kv1,kv2);
  assertTrue(metaKeyComparator.compare(kv1,newKey) < 0);
  assertTrue((metaKeyComparator.compare(kv2,newKey) == 0));
  kv1=new KeyValue(Bytes.toBytes("ilovehbase"),family,qualA,ts,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("ilovehbaseandhdfs"),family,qualA,ts,Type.Put);
  assertTrue(keyComparator.compare(kv1,kv2) < 0);
  newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) > 0);
  expectedArray=Bytes.toBytes("ilovehbasea");
  Bytes.equals(newKey.getRowArray(),newKey.getRowOffset(),newKey.getRowLength(),expectedArray,0,expectedArray.length);
  kv1=new KeyValue(Bytes.toBytes("100abcdefg"),family,qualA,ts,Type.Put);
  kv2=new KeyValue(Bytes.toBytes("101abcdefg"),family,qualA,ts,Type.Put);
  assertTrue(keyComparator.compare(kv1,kv2) < 0);
  newKey=HFileWriterImpl.getMidpoint(keyComparator,kv1,kv2);
  assertTrue(keyComparator.compare(kv1,newKey) < 0);
  assertTrue((keyComparator.compare(kv2,newKey)) > 0);
  expectedArray=Bytes.toBytes("101");
  Bytes.equals(newKey.getRowArray(),newKey.getRowOffset(),newKey.getRowLength(),expectedArray,0,expectedArray.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlock </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoCompression() throws IOException {
  CacheConfig cacheConf=Mockito.mock(CacheConfig.class);
  Mockito.when(cacheConf.isBlockCacheEnabled()).thenReturn(false);
  HFileBlock block=createTestV2Block(NONE,includesMemstoreTS,false).getBlockForCaching(cacheConf);
  assertEquals(4000,block.getUncompressedSizeWithoutHeader());
  assertEquals(4004,block.getOnDiskSizeWithoutHeader());
  assertTrue(block.isUnpacked());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockCompatibility </h4><pre class="type-4 type-10 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderV2() throws IOException {
  if (includesTag) {
    TEST_UTIL.getConfiguration().setInt("hfile.format.version",3);
  }
  for (  Compression.Algorithm algo : COMPRESSION_ALGORITHMS) {
    for (    boolean pread : new boolean[]{false,true}) {
      LOG.info("testReaderV2: Compression algorithm: " + algo + ", pread="+ pread);
      Path path=new Path(TEST_UTIL.getDataTestDir(),"blocks_v2_" + algo);
      FSDataOutputStream os=fs.create(path);
      Writer hbw=new Writer(algo,null,includesMemstoreTS,includesTag);
      long totalSize=0;
      for (int blockId=0; blockId < 2; ++blockId) {
        DataOutputStream dos=hbw.startWriting(BlockType.DATA);
        for (int i=0; i < 1234; ++i)         dos.writeInt(i);
        hbw.writeHeaderAndData(os);
        totalSize+=hbw.getOnDiskSizeWithHeader();
      }
      os.close();
      FSDataInputStream is=fs.open(path);
      HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTag).withCompression(algo).build();
      HFileBlock.FSReader hbr=new HFileBlock.FSReaderImpl(new FSDataInputStreamWrapper(is),totalSize,fs,path,meta);
      HFileBlock b=hbr.readBlockData(0,-1,-1,pread);
      is.close();
      b.sanityCheck();
      assertEquals(4936,b.getUncompressedSizeWithoutHeader());
      assertEquals(algo == GZ ? 2173 : 4936,b.getOnDiskSizeWithoutHeader() - b.totalChecksumBytes());
      HFileBlock expected=b;
      if (algo == GZ) {
        is=fs.open(path);
        hbr=new HFileBlock.FSReaderImpl(new FSDataInputStreamWrapper(is),totalSize,fs,path,meta);
        b=hbr.readBlockData(0,2173 + HConstants.HFILEBLOCK_HEADER_SIZE_NO_CHECKSUM + b.totalChecksumBytes(),-1,pread);
        assertEquals(expected,b);
        int wrongCompressedSize=2172;
        try {
          b=hbr.readBlockData(0,wrongCompressedSize + HConstants.HFILEBLOCK_HEADER_SIZE_NO_CHECKSUM,-1,pread);
          fail("Exception expected");
        }
 catch (        IOException ex) {
          String expectedPrefix="On-disk size without header provided is " + wrongCompressedSize + ", but block header contains "+ b.getOnDiskSizeWithoutHeader()+ ".";
          assertTrue("Invalid exception message: '" + ex.getMessage() + "'.\nMessage is expected to start with: '"+ expectedPrefix+ "'",ex.getMessage().startsWith(expectedPrefix));
        }
        is.close();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test encoding/decoding data blocks.
 * @throws IOException a bug or a problem with temporary files.
 */
@Test public void testDataBlockEncoding() throws IOException {
  if (includesTag) {
    TEST_UTIL.getConfiguration().setInt("hfile.format.version",3);
  }
  final int numBlocks=5;
  for (  Compression.Algorithm algo : COMPRESSION_ALGORITHMS) {
    for (    boolean pread : new boolean[]{false,true}) {
      for (      DataBlockEncoding encoding : DataBlockEncoding.values()) {
        LOG.info("testDataBlockEncoding algo " + algo + " pread = "+ pread+ " encoding "+ encoding);
        Path path=new Path(TEST_UTIL.getDataTestDir(),"blocks_v2_" + algo + "_"+ encoding.toString());
        FSDataOutputStream os=fs.create(path);
        HFileDataBlockEncoder dataBlockEncoder=(encoding != DataBlockEncoding.NONE) ? new HFileDataBlockEncoderImpl(encoding) : NoOpDataBlockEncoder.INSTANCE;
        TestHFileBlockCompatibility.Writer hbw=new TestHFileBlockCompatibility.Writer(algo,dataBlockEncoder,includesMemstoreTS,includesTag);
        long totalSize=0;
        final List<Integer> encodedSizes=new ArrayList<Integer>();
        final List<ByteBuffer> encodedBlocks=new ArrayList<ByteBuffer>();
        for (int blockId=0; blockId < numBlocks; ++blockId) {
          hbw.startWriting(BlockType.DATA);
          TestHFileBlock.writeTestKeyValues(hbw,blockId,pread,includesTag);
          hbw.writeHeaderAndData(os);
          int headerLen=HConstants.HFILEBLOCK_HEADER_SIZE_NO_CHECKSUM;
          byte[] encodedResultWithHeader=hbw.getUncompressedDataWithHeader();
          final int encodedSize=encodedResultWithHeader.length - headerLen;
          if (encoding != DataBlockEncoding.NONE) {
            headerLen+=DataBlockEncoding.ID_SIZE;
          }
          byte[] encodedDataSection=new byte[encodedResultWithHeader.length - headerLen];
          System.arraycopy(encodedResultWithHeader,headerLen,encodedDataSection,0,encodedDataSection.length);
          final ByteBuffer encodedBuf=ByteBuffer.wrap(encodedDataSection);
          encodedSizes.add(encodedSize);
          encodedBlocks.add(encodedBuf);
          totalSize+=hbw.getOnDiskSizeWithHeader();
        }
        os.close();
        FSDataInputStream is=fs.open(path);
        HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTag).withCompression(algo).build();
        HFileBlock.FSReaderImpl hbr=new HFileBlock.FSReaderImpl(new FSDataInputStreamWrapper(is),totalSize,fs,path,meta);
        hbr.setDataBlockEncoder(dataBlockEncoder);
        hbr.setIncludesMemstoreTS(includesMemstoreTS);
        HFileBlock b;
        int pos=0;
        for (int blockId=0; blockId < numBlocks; ++blockId) {
          b=hbr.readBlockData(pos,-1,-1,pread);
          b.sanityCheck();
          if (meta.isCompressedOrEncrypted()) {
            assertFalse(b.isUnpacked());
            b=b.unpack(meta,hbr);
          }
          pos+=b.getOnDiskSizeWithHeader();
          assertEquals((int)encodedSizes.get(blockId),b.getUncompressedSizeWithoutHeader());
          ByteBuff actualBuffer=b.getBufferWithoutHeader();
          if (encoding != DataBlockEncoding.NONE) {
            assertEquals(0,actualBuffer.get(0));
            assertEquals(encoding.getId(),actualBuffer.get(1));
            actualBuffer.position(2);
            actualBuffer=actualBuffer.slice();
          }
          ByteBuffer expectedBuffer=encodedBlocks.get(blockId);
          expectedBuffer.rewind();
          TestHFileBlock.assertBuffersEqual(new SingleByteBuff(expectedBuffer),actualBuffer,algo,encoding,pread);
        }
        is.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockIndex </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testing block index through the HFile writer/reader APIs. Allows to test
 * setting index block size through configuration, intermediate-level index
 * blocks, and caching index blocks on write.
 * @throws IOException
 */
@Test public void testHFileWriterAndReader() throws IOException {
  Path hfilePath=new Path(TEST_UTIL.getDataTestDir(),"hfile_for_block_index");
  CacheConfig cacheConf=new CacheConfig(conf);
  BlockCache blockCache=cacheConf.getBlockCache();
  for (int testI=0; testI < INDEX_CHUNK_SIZES.length; ++testI) {
    int indexBlockSize=INDEX_CHUNK_SIZES[testI];
    int expectedNumLevels=EXPECTED_NUM_LEVELS[testI];
    LOG.info("Index block size: " + indexBlockSize + ", compression: "+ compr);
    blockCache.evictBlocksByHfileName(hfilePath.getName());
    conf.setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,indexBlockSize);
    Set<String> keyStrSet=new HashSet<String>();
    byte[][] keys=new byte[NUM_KV][];
    byte[][] values=new byte[NUM_KV][];
{
      HFileContext meta=new HFileContextBuilder().withBlockSize(SMALL_BLOCK_SIZE).withCompression(compr).build();
      HFile.Writer writer=HFile.getWriterFactory(conf,cacheConf).withPath(fs,hfilePath).withFileContext(meta).create();
      Random rand=new Random(19231737);
      byte[] family=Bytes.toBytes("f");
      byte[] qualifier=Bytes.toBytes("q");
      for (int i=0; i < NUM_KV; ++i) {
        byte[] row=RandomKeyValueUtil.randomOrderedKey(rand,i);
        KeyValue kv=new KeyValue(row,family,qualifier,EnvironmentEdgeManager.currentTime(),RandomKeyValueUtil.randomValue(rand));
        byte[] k=kv.getKey();
        writer.append(kv);
        keys[i]=k;
        values[i]=CellUtil.cloneValue(kv);
        keyStrSet.add(Bytes.toStringBinary(k));
        if (i > 0) {
          assertTrue((CellComparator.COMPARATOR.compare(kv,keys[i - 1],0,keys[i - 1].length)) > 0);
        }
      }
      writer.close();
    }
    HFile.Reader reader=HFile.createReader(fs,hfilePath,cacheConf,conf);
    assertEquals(expectedNumLevels,reader.getTrailer().getNumDataIndexLevels());
    assertTrue(Bytes.equals(keys[0],((KeyValue)reader.getFirstKey()).getKey()));
    assertTrue(Bytes.equals(keys[NUM_KV - 1],((KeyValue)reader.getLastKey()).getKey()));
    LOG.info("Last key: " + Bytes.toStringBinary(keys[NUM_KV - 1]));
    for (    boolean pread : new boolean[]{false,true}) {
      HFileScanner scanner=reader.getScanner(true,pread);
      for (int i=0; i < NUM_KV; ++i) {
        checkSeekTo(keys,scanner,i);
        checkKeyValue("i=" + i,keys[i],values[i],ByteBuffer.wrap(((KeyValue)scanner.getKey()).getKey()),scanner.getValue());
      }
      assertTrue(scanner.seekTo());
      for (int i=NUM_KV - 1; i >= 0; --i) {
        checkSeekTo(keys,scanner,i);
        checkKeyValue("i=" + i,keys[i],values[i],ByteBuffer.wrap(((KeyValue)scanner.getKey()).getKey()),scanner.getValue());
      }
    }
    HFile.Reader reader2=reader;
    HFileBlock.FSReader fsReader=reader2.getUncachedBlockReader();
    HFileBlock.BlockIterator iter=fsReader.blockRange(0,reader.getTrailer().getLoadOnOpenDataOffset());
    HFileBlock block;
    List<byte[]> blockKeys=new ArrayList<byte[]>();
    while ((block=iter.nextBlock()) != null) {
      if (block.getBlockType() != BlockType.LEAF_INDEX)       return;
      ByteBuff b=block.getBufferReadOnly();
      int n=b.getIntAfterPosition(0);
      int entriesOffset=Bytes.SIZEOF_INT * (n + 2);
      for (int i=0; i < n; ++i) {
        int keyRelOffset=b.getIntAfterPosition(Bytes.SIZEOF_INT * (i + 1));
        int nextKeyRelOffset=b.getIntAfterPosition(Bytes.SIZEOF_INT * (i + 2));
        int keyLen=nextKeyRelOffset - keyRelOffset;
        int keyOffset=b.arrayOffset() + entriesOffset + keyRelOffset+ HFileBlockIndex.SECONDARY_INDEX_ENTRY_OVERHEAD;
        byte[] blockKey=Arrays.copyOfRange(b.array(),keyOffset,keyOffset + keyLen);
        String blockKeyStr=Bytes.toString(blockKey);
        blockKeys.add(blockKey);
        assertTrue("Invalid block key from leaf-level block: " + blockKeyStr,keyStrSet.contains(blockKeyStr));
      }
    }
    assertEquals(Bytes.toStringBinary(blockKeys.get((blockKeys.size() - 1) / 2)),reader.midkey());
    assertEquals(UNCOMPRESSED_INDEX_SIZES[testI],reader.getTrailer().getUncompressedDataIndexSize());
    reader.close();
    reader2.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecondaryIndexBinarySearch() throws IOException {
  int numTotalKeys=99;
  assertTrue(numTotalKeys % 2 == 1);
  int numSearchedKeys=(numTotalKeys - 1) / 2;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  dos.writeInt(numSearchedKeys);
  int curAllEntriesSize=0;
  int numEntriesAdded=0;
  int secondaryIndexEntries[]=new int[numTotalKeys];
  for (int i=0; i < numTotalKeys; ++i) {
    byte[] k=RandomKeyValueUtil.randomOrderedKey(rand,i * 2);
    KeyValue cell=new KeyValue(k,Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("val"));
    keys.add(cell.getKey());
    String msgPrefix="Key #" + i + " ("+ Bytes.toStringBinary(k)+ "): ";
    StringBuilder padding=new StringBuilder();
    while (msgPrefix.length() + padding.length() < 70)     padding.append(' ');
    msgPrefix+=padding;
    if (i % 2 == 1) {
      dos.writeInt(curAllEntriesSize);
      secondaryIndexEntries[i]=curAllEntriesSize;
      LOG.info(msgPrefix + "secondary index entry #" + ((i - 1) / 2)+ ", offset "+ curAllEntriesSize);
      curAllEntriesSize+=cell.getKey().length + HFileBlockIndex.SECONDARY_INDEX_ENTRY_OVERHEAD;
      ++numEntriesAdded;
    }
 else {
      secondaryIndexEntries[i]=-1;
      LOG.info(msgPrefix + "not in the searched array");
    }
  }
  for (int i=0; i < keys.size() - 1; ++i)   assertTrue(CellComparator.COMPARATOR.compare(new KeyValue.KeyOnlyKeyValue(keys.get(i),0,keys.get(i).length),new KeyValue.KeyOnlyKeyValue(keys.get(i + 1),0,keys.get(i + 1).length)) < 0);
  dos.writeInt(curAllEntriesSize);
  assertEquals(numSearchedKeys,numEntriesAdded);
  int secondaryIndexOffset=dos.size();
  assertEquals(Bytes.SIZEOF_INT * (numSearchedKeys + 2),secondaryIndexOffset);
  for (int i=1; i <= numTotalKeys - 1; i+=2) {
    assertEquals(dos.size(),secondaryIndexOffset + secondaryIndexEntries[i]);
    long dummyFileOffset=getDummyFileOffset(i);
    int dummyOnDiskSize=getDummyOnDiskSize(i);
    LOG.debug("Storing file offset=" + dummyFileOffset + " and onDiskSize="+ dummyOnDiskSize+ " at offset "+ dos.size());
    dos.writeLong(dummyFileOffset);
    dos.writeInt(dummyOnDiskSize);
    LOG.debug("Stored key " + ((i - 1) / 2) + " at offset "+ dos.size());
    dos.write(keys.get(i));
  }
  dos.writeInt(curAllEntriesSize);
  ByteBuffer nonRootIndex=ByteBuffer.wrap(baos.toByteArray());
  for (int i=0; i < numTotalKeys; ++i) {
    byte[] searchKey=keys.get(i);
    byte[] arrayHoldingKey=new byte[searchKey.length + searchKey.length / 2];
    System.arraycopy(searchKey,0,arrayHoldingKey,searchKey.length / 2,searchKey.length);
    KeyValue.KeyOnlyKeyValue cell=new KeyValue.KeyOnlyKeyValue(arrayHoldingKey,searchKey.length / 2,searchKey.length);
    int searchResult=BlockIndexReader.binarySearchNonRootIndex(cell,new MultiByteBuff(nonRootIndex),CellComparator.COMPARATOR);
    String lookupFailureMsg="Failed to look up key #" + i + " ("+ Bytes.toStringBinary(searchKey)+ ")";
    int expectedResult;
    int referenceItem;
    if (i % 2 == 1) {
      expectedResult=(i - 1) / 2;
      referenceItem=i;
    }
 else {
      expectedResult=i / 2 - 1;
      referenceItem=i - 1;
    }
    assertEquals(lookupFailureMsg,expectedResult,searchResult);
    boolean locateBlockResult=(BlockIndexReader.locateNonRootIndexEntry(new MultiByteBuff(nonRootIndex),cell,CellComparator.COMPARATOR) != -1);
    if (i == 0) {
      assertFalse(locateBlockResult);
    }
 else {
      assertTrue(locateBlockResult);
      String errorMsg="i=" + i + ", position="+ nonRootIndex.position();
      assertEquals(errorMsg,getDummyFileOffset(referenceItem),nonRootIndex.getLong());
      assertEquals(errorMsg,getDummyOnDiskSize(referenceItem),nonRootIndex.getInt());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileEncryption </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testHFileEncryptionMetadata() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  CacheConfig cacheConf=new CacheConfig(conf);
  HFileContext fileContext=new HFileContextBuilder().withEncryptionContext(cryptoContext).build();
  Path path=new Path(TEST_UTIL.getDataTestDir(),"cryptometa.hfile");
  FSDataOutputStream out=fs.create(path);
  HFile.Writer writer=HFile.getWriterFactory(conf,cacheConf).withOutputStream(out).withFileContext(fileContext).create();
  try {
    KeyValue kv=new KeyValue("foo".getBytes(),"f1".getBytes(),null,"value".getBytes());
    writer.append(kv);
  }
  finally {
    writer.close();
    out.close();
  }
  HFile.Reader reader=HFile.createReader(fs,path,cacheConf,conf);
  try {
    reader.loadFileInfo();
    FixedFileTrailer trailer=reader.getTrailer();
    assertNotNull(trailer.getEncryptionKey());
    Encryption.Context readerContext=reader.getFileContext().getEncryptionContext();
    assertEquals(readerContext.getCipher().getName(),cryptoContext.getCipher().getName());
    assertTrue(Bytes.equals(readerContext.getKeyBytes(),cryptoContext.getKeyBytes()));
  }
  finally {
    reader.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=6000000) public void testHFileEncryption() throws Exception {
  RedundantKVGenerator generator=new RedundantKVGenerator();
  List<KeyValue> testKvs=generator.generateTestKeyValues(1000);
  Configuration conf=TEST_UTIL.getConfiguration();
  CacheConfig cacheConf=new CacheConfig(conf);
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    for (    Compression.Algorithm compression : TestHFileBlock.COMPRESSION_ALGORITHMS) {
      HFileContext fileContext=new HFileContextBuilder().withBlockSize(4096).withEncryptionContext(cryptoContext).withCompression(compression).withDataBlockEncoding(encoding).build();
      LOG.info("Writing with " + fileContext);
      Path path=new Path(TEST_UTIL.getDataTestDir(),UUID.randomUUID().toString() + ".hfile");
      FSDataOutputStream out=fs.create(path);
      HFile.Writer writer=HFile.getWriterFactory(conf,cacheConf).withOutputStream(out).withFileContext(fileContext).create();
      try {
        for (        KeyValue kv : testKvs) {
          writer.append(kv);
        }
      }
  finally {
        writer.close();
        out.close();
      }
      LOG.info("Reading with " + fileContext);
      int i=0;
      HFileScanner scanner=null;
      HFile.Reader reader=HFile.createReader(fs,path,cacheConf,conf);
      try {
        reader.loadFileInfo();
        FixedFileTrailer trailer=reader.getTrailer();
        assertNotNull(trailer.getEncryptionKey());
        scanner=reader.getScanner(false,false);
        assertTrue("Initial seekTo failed",scanner.seekTo());
        do {
          Cell kv=scanner.getCell();
          assertTrue("Read back an unexpected or invalid KV",testKvs.contains(KeyValueUtil.ensureKeyValue(kv)));
          i++;
        }
 while (scanner.next());
      }
  finally {
        reader.close();
        scanner.close();
      }
      assertEquals("Did not read back as many KVs as written",i,testKvs.size());
      LOG.info("Random seeking with " + fileContext);
      reader=HFile.createReader(fs,path,cacheConf,conf);
      try {
        scanner=reader.getScanner(false,true);
        assertTrue("Initial seekTo failed",scanner.seekTo());
        for (i=0; i < 100; i++) {
          KeyValue kv=testKvs.get(RNG.nextInt(testKvs.size()));
          assertEquals("Unable to find KV as expected: " + kv,scanner.seekTo(kv),0);
        }
      }
  finally {
        scanner.close();
        reader.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestLazyDataBlockDecompression </h4><pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompressionIncreasesEffectiveBlockCacheSize() throws Exception {
  int maxSize=(int)(HConstants.DEFAULT_BLOCKSIZE * 2.1);
  Path hfilePath=new Path(TEST_UTIL.getDataTestDir(),"testCompressionIncreasesEffectiveBlockcacheSize");
  HFileContext context=new HFileContextBuilder().withCompression(Compression.Algorithm.GZ).build();
  LOG.info("context=" + context);
  Configuration lazyCompressDisabled=HBaseConfiguration.create(TEST_UTIL.getConfiguration());
  lazyCompressDisabled.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressDisabled.setBoolean(CacheConfig.CACHE_BLOOM_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressDisabled.setBoolean(CacheConfig.CACHE_INDEX_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressDisabled.setBoolean(CacheConfig.CACHE_DATA_BLOCKS_COMPRESSED_KEY,false);
  CacheConfig.GLOBAL_BLOCK_CACHE_INSTANCE=new LruBlockCache(maxSize,HConstants.DEFAULT_BLOCKSIZE,false,lazyCompressDisabled);
  CacheConfig cc=new CacheConfig(lazyCompressDisabled);
  assertFalse(cc.shouldCacheDataCompressed());
  assertTrue(cc.getBlockCache() instanceof LruBlockCache);
  LruBlockCache disabledBlockCache=(LruBlockCache)cc.getBlockCache();
  LOG.info("disabledBlockCache=" + disabledBlockCache);
  assertEquals("test inconsistency detected.",maxSize,disabledBlockCache.getMaxSize());
  assertTrue("eviction thread spawned unintentionally.",disabledBlockCache.getEvictionThread() == null);
  assertEquals("freshly created blockcache contains blocks.",0,disabledBlockCache.getBlockCount());
  writeHFile(lazyCompressDisabled,cc,fs,hfilePath,context,2000);
  cacheBlocks(lazyCompressDisabled,cc,fs,hfilePath,context);
  long disabledBlockCount=disabledBlockCache.getBlockCount();
  assertTrue("blockcache should contain blocks. disabledBlockCount=" + disabledBlockCount,disabledBlockCount > 0);
  long disabledEvictedCount=disabledBlockCache.getStats().getEvictedCount();
  for (  Map.Entry<BlockCacheKey,LruCachedBlock> e : disabledBlockCache.getMapForTests().entrySet()) {
    HFileBlock block=(HFileBlock)e.getValue().getBuffer();
    assertTrue("found a packed block, block=" + block,block.isUnpacked());
  }
  Configuration lazyCompressEnabled=HBaseConfiguration.create(TEST_UTIL.getConfiguration());
  lazyCompressEnabled.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressEnabled.setBoolean(CacheConfig.CACHE_BLOOM_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressEnabled.setBoolean(CacheConfig.CACHE_INDEX_BLOCKS_ON_WRITE_KEY,cacheOnWrite);
  lazyCompressEnabled.setBoolean(CacheConfig.CACHE_DATA_BLOCKS_COMPRESSED_KEY,true);
  CacheConfig.GLOBAL_BLOCK_CACHE_INSTANCE=new LruBlockCache(maxSize,HConstants.DEFAULT_BLOCKSIZE,false,lazyCompressEnabled);
  cc=new CacheConfig(lazyCompressEnabled);
  assertTrue("test improperly configured.",cc.shouldCacheDataCompressed());
  assertTrue(cc.getBlockCache() instanceof LruBlockCache);
  LruBlockCache enabledBlockCache=(LruBlockCache)cc.getBlockCache();
  LOG.info("enabledBlockCache=" + enabledBlockCache);
  assertEquals("test inconsistency detected",maxSize,enabledBlockCache.getMaxSize());
  assertTrue("eviction thread spawned unintentionally.",enabledBlockCache.getEvictionThread() == null);
  assertEquals("freshly created blockcache contains blocks.",0,enabledBlockCache.getBlockCount());
  cacheBlocks(lazyCompressEnabled,cc,fs,hfilePath,context);
  long enabledBlockCount=enabledBlockCache.getBlockCount();
  assertTrue("blockcache should contain blocks. enabledBlockCount=" + enabledBlockCount,enabledBlockCount > 0);
  long enabledEvictedCount=enabledBlockCache.getStats().getEvictedCount();
  int candidatesFound=0;
  for (  Map.Entry<BlockCacheKey,LruCachedBlock> e : enabledBlockCache.getMapForTests().entrySet()) {
    candidatesFound++;
    HFileBlock block=(HFileBlock)e.getValue().getBuffer();
    if (cc.shouldCacheCompressed(block.getBlockType().getCategory())) {
      assertFalse("found an unpacked block, block=" + block + ", block buffer capacity="+ block.getBufferWithoutHeader().capacity(),block.isUnpacked());
    }
  }
  assertTrue("did not find any candidates for compressed caching. Invalid test.",candidatesFound > 0);
  LOG.info("disabledBlockCount=" + disabledBlockCount + ", enabledBlockCount="+ enabledBlockCount);
  assertTrue("enabling compressed data blocks should increase the effective cache size. " + "disabledBlockCount=" + disabledBlockCount + ", enabledBlockCount="+ enabledBlockCount,disabledBlockCount < enabledBlockCount);
  LOG.info("disabledEvictedCount=" + disabledEvictedCount + ", enabledEvictedCount="+ enabledEvictedCount);
  assertTrue("enabling compressed data blocks should reduce the number of evictions. " + "disabledEvictedCount=" + disabledEvictedCount + ", enabledEvictedCount="+ enabledEvictedCount,enabledEvictedCount < disabledEvictedCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestLruBlockCache </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheEvictionSimple() throws Exception {
  long maxSize=100000;
  long blockSize=calculateBlockSizeDefault(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false);
  CachedItem[] blocks=generateFixedBlocks(10,blockSize,"block");
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
  }
  assertEquals(1,cache.getStats().getEvictionCount());
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.heapSize() < maxSize);
  assertTrue(cache.heapSize() < (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(blocks[0].cacheKey,true,false,true) == null);
  for (int i=1; i < blocks.length; i++) {
    assertEquals(cache.getBlock(blocks[i].cacheKey,true,false,true),blocks[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheEvictionTwoPriorities() throws Exception {
  long maxSize=100000;
  long blockSize=calculateBlockSizeDefault(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false);
  CachedItem[] singleBlocks=generateFixedBlocks(5,10000,"single");
  CachedItem[] multiBlocks=generateFixedBlocks(5,10000,"multi");
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : multiBlocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
    assertEquals(cache.getBlock(block.cacheKey,true,false,true),block);
  }
  for (  CachedItem block : singleBlocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.heapSize();
  }
  assertEquals(cache.getStats().getEvictionCount(),1);
  assertEquals(cache.getStats().getEvictedCount(),2);
  assertTrue(expectedCacheSize > (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.heapSize() <= maxSize);
  assertTrue(cache.heapSize() <= (maxSize * LruBlockCache.DEFAULT_ACCEPTABLE_FACTOR));
  assertTrue(cache.getBlock(singleBlocks[0].cacheKey,true,false,true) == null);
  assertTrue(cache.getBlock(multiBlocks[0].cacheKey,true,false,true) == null);
  for (int i=1; i < 4; i++) {
    assertEquals(cache.getBlock(singleBlocks[i].cacheKey,true,false,true),singleBlocks[i]);
    assertEquals(cache.getBlock(multiBlocks[i].cacheKey,true,false,true),multiBlocks[i]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheSimple() throws Exception {
  long maxSize=1000000;
  long blockSize=calculateBlockSizeDefault(maxSize,101);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize);
  CachedItem[] blocks=generateRandomBlocks(100,blockSize);
  long expectedCacheSize=cache.heapSize();
  for (  CachedItem block : blocks) {
    assertTrue(cache.getBlock(block.cacheKey,true,false,true) == null);
  }
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.cacheKey,block);
    expectedCacheSize+=block.cacheBlockHeapSize();
  }
  assertEquals(expectedCacheSize,cache.heapSize());
  for (  CachedItem block : blocks) {
    HeapSize buf=cache.getBlock(block.cacheKey,true,false,true);
    assertTrue(buf != null);
    assertEquals(buf.heapSize(),block.heapSize());
  }
  long expectedBlockCount=cache.getBlockCount();
  for (  CachedItem block : blocks) {
    cache.cacheBlock(block.cacheKey,block);
  }
  assertEquals("Cache should ignore cache requests for blocks already in cache",expectedBlockCount,cache.getBlockCount());
  assertEquals(expectedCacheSize,cache.heapSize());
  for (  CachedItem block : blocks) {
    HeapSize buf=cache.getBlock(block.cacheKey,true,false,true);
    assertTrue(buf != null);
    assertEquals(buf.heapSize(),block.heapSize());
  }
  assertEquals(0,cache.getStats().getEvictionCount());
  Thread t=new LruBlockCache.StatisticsThread(cache);
  t.start();
  t.join();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxBlockSize() throws Exception {
  long maxSize=100000;
  long blockSize=calculateBlockSize(maxSize,10);
  LruBlockCache cache=new LruBlockCache(maxSize,blockSize,false,(int)Math.ceil(1.2 * maxSize / blockSize),LruBlockCache.DEFAULT_LOAD_FACTOR,LruBlockCache.DEFAULT_CONCURRENCY_LEVEL,0.66f,0.99f,0.33f,0.33f,0.34f,false,1024);
  CachedItem[] tooLong=generateFixedBlocks(10,1024 + 5,"long");
  CachedItem[] small=generateFixedBlocks(15,600,"small");
  for (  CachedItem i : tooLong) {
    cache.cacheBlock(i.cacheKey,i);
  }
  for (  CachedItem i : small) {
    cache.cacheBlock(i.cacheKey,i);
  }
  assertEquals(15,cache.getBlockCount());
  for (  CachedItem i : small) {
    assertNotNull(cache.getBlock(i.cacheKey,true,false,false));
  }
  for (  CachedItem i : tooLong) {
    assertNull(cache.getBlock(i.cacheKey,true,false,false));
  }
  assertEquals(10,cache.getStats().getFailedInserts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestScannerFromBucketCache </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicScanWithOffheapBucketCacheWithMBB() throws IOException {
  setUp(true,true);
  byte[] row1=Bytes.toBytes("row1offheap");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("famoffheap");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,conf,test_util,fam1);
  try {
    List<Cell> expected=insertData(row1,qf1,qf2,fam1,ts1,ts2,ts3,true);
    List<Cell> actual=performScan(row1,fam1);
    for (int i=0; i < expected.size(); i++) {
      assertFalse(actual.get(i) instanceof OffheapKeyValue);
      assertFalse(actual.get(i) instanceof ShareableMemory);
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
    Thread.sleep(500);
    Scan scan=new Scan(row1);
    scan.addFamily(fam1);
    scan.setMaxVersions(10);
    actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan,false);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      if (i != 5) {
        assertTrue(actual.get(i) instanceof OffheapKeyValue);
      }
      assertTrue(actual.get(i) instanceof ShareableMemory);
    }
  }
 catch (  InterruptedException e) {
  }
 finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestSeekBeforeWithInlineBlocks </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Scanner.seekBefore() could fail because when seeking to a previous HFile data block, it needs 
 * to know the size of that data block, which it calculates using current data block offset and 
 * the previous data block offset.  This fails to work when there are leaf-level index blocks in 
 * the scannable section of the HFile, i.e. starting in HFileV2.  This test will try seekBefore() 
 * on a flat (single-level) and multi-level (2,3) HFile and confirm this bug is now fixed.  This
 * bug also happens for inline Bloom blocks for the same reasons.
 */
@Test public void testMultiIndexLevelRandomHFileWithBlooms() throws IOException {
  conf=TEST_UTIL.getConfiguration();
  for (int hfileVersion=HFile.MIN_FORMAT_VERSION_WITH_TAGS; hfileVersion <= HFile.MAX_FORMAT_VERSION; hfileVersion++) {
    conf.setInt(HFile.FORMAT_VERSION_KEY,hfileVersion);
    fs=HFileSystem.get(conf);
    for (    BloomType bloomType : BloomType.values()) {
      for (int testI=0; testI < INDEX_CHUNK_SIZES.length; testI++) {
        int indexBlockSize=INDEX_CHUNK_SIZES[testI];
        int expectedNumLevels=EXPECTED_NUM_LEVELS[testI];
        LOG.info(String.format("Testing HFileVersion: %s, BloomType: %s, Index Levels: %s",hfileVersion,bloomType,expectedNumLevels));
        conf.setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,indexBlockSize);
        conf.setInt(BloomFilterFactory.IO_STOREFILE_BLOOM_BLOCK_SIZE,BLOOM_BLOCK_SIZE);
        Cell[] cells=new Cell[NUM_KV];
        Path hfilePath=new Path(TEST_UTIL.getDataTestDir(),String.format("testMultiIndexLevelRandomHFileWithBlooms-%s-%s-%s",hfileVersion,bloomType,testI));
        conf.setFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,0.0f);
        CacheConfig cacheConf=new CacheConfig(conf);
{
          HFileContext meta=new HFileContextBuilder().withBlockSize(DATA_BLOCK_SIZE).build();
          StoreFile.Writer storeFileWriter=new StoreFile.WriterBuilder(conf,cacheConf,fs).withFilePath(hfilePath).withFileContext(meta).withBloomType(bloomType).build();
          for (int i=0; i < NUM_KV; i++) {
            byte[] row=RandomKeyValueUtil.randomOrderedKey(RAND,i);
            byte[] qual=RandomKeyValueUtil.randomRowOrQualifier(RAND);
            byte[] value=RandomKeyValueUtil.randomValue(RAND);
            KeyValue kv=new KeyValue(row,FAM,qual,value);
            storeFileWriter.append(kv);
            cells[i]=kv;
          }
          storeFileWriter.close();
        }
        HFile.Reader reader=HFile.createReader(fs,hfilePath,cacheConf,conf);
        assertEquals(expectedNumLevels,reader.getTrailer().getNumDataIndexLevels());
        for (        boolean pread : new boolean[]{false,true}) {
          HFileScanner scanner=reader.getScanner(true,pread);
          checkNoSeekBefore(cells,scanner,0);
          for (int i=1; i < NUM_KV; i++) {
            checkSeekBefore(cells,scanner,i);
            checkCell(cells[i - 1],scanner.getCell());
          }
          assertTrue(scanner.seekTo());
          for (int i=NUM_KV - 1; i >= 1; i--) {
            checkSeekBefore(cells,scanner,i);
            checkCell(cells[i - 1],scanner.getCell());
          }
          checkNoSeekBefore(cells,scanner,0);
          scanner.close();
        }
        reader.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestBucketCache </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryLeak() throws Exception {
  final BlockCacheKey cacheKey=new BlockCacheKey("dummy",1L);
  cacheAndWaitUntilFlushedToBucket(cache,cacheKey,new CacheTestUtils.ByteArrayCacheable(new byte[10]));
  long lockId=cache.backingMap.get(cacheKey).offset();
  ReentrantReadWriteLock lock=cache.offsetLock.getLock(lockId);
  lock.writeLock().lock();
  Thread evictThread=new Thread("evict-block"){
    @Override public void run(){
      cache.evictBlock(cacheKey);
    }
  }
;
  evictThread.start();
  cache.offsetLock.waitForWaiters(lockId,1);
  cache.blockEvicted(cacheKey,cache.backingMap.remove(cacheKey),true);
  cacheAndWaitUntilFlushedToBucket(cache,cacheKey,new CacheTestUtils.ByteArrayCacheable(new byte[10]));
  lock.writeLock().unlock();
  evictThread.join();
  assertEquals(1L,cache.getBlockCount());
  assertTrue(cache.getCurrentSize() > 0L);
  assertTrue("We should have a block!",cache.iterator().hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestBucketWriterThread </h4><pre class="type-2 type-8 type-5 type-20 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Set up variables and get BucketCache and WriterThread into state where tests can  manually
 * control the running of WriterThread and BucketCache is empty.
 * @throws Exception
 */
@Before public void setUp() throws Exception {
  final int capacity=16;
  final int writerThreadsCount=1;
  this.bc=new MockBucketCache("heap",capacity,1,new int[]{1},writerThreadsCount,capacity,null,100);
  assertEquals(writerThreadsCount,bc.writerThreads.length);
  assertEquals(writerThreadsCount,bc.writerQueues.size());
  this.wt=bc.writerThreads[0];
  this.q=bc.writerQueues.get(0);
  wt.disableWriter();
  this.plainKey=new BlockCacheKey("f",0);
  this.plainCacheable=Mockito.mock(Cacheable.class);
  assertThat(bc.ramCache.isEmpty(),is(true));
  assertTrue(q.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.util.TestLRUDictionary </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic(){
  Random rand=new Random();
  byte[] testBytes=new byte[10];
  rand.nextBytes(testBytes);
  assertEquals(testee.findEntry(testBytes,0,testBytes.length),-1);
  assertFalse(isDictionaryEmpty(testee));
  short t=testee.findEntry(testBytes,0,testBytes.length);
  assertTrue(t != -1);
  byte[] testBytesCopy=new byte[20];
  Bytes.putBytes(testBytesCopy,10,testBytes,0,testBytes.length);
  assertEquals(testee.findEntry(testBytesCopy,10,testBytes.length),t);
  assertTrue(Arrays.equals(testBytes,testee.getEntry(t)));
  testee.clear();
  assertTrue(isDictionaryEmpty(testee));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.AbstractTestIPC </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * It is hard to verify the compression is actually happening under the wraps. Hope that if
 * unsupported, we'll get an exception out of some time (meantime, have to trace it manually to
 * confirm that compression is happening down in the client and server).
 * @throws IOException
 * @throws InterruptedException
 * @throws SecurityException
 * @throws NoSuchMethodException
 */
@Test public void testCompressCellBlock() throws IOException, InterruptedException, SecurityException, NoSuchMethodException, ServiceException {
  Configuration conf=new Configuration(HBaseConfiguration.create());
  conf.set("hbase.client.rpc.compressor",GzipCodec.class.getCanonicalName());
  List<Cell> cells=new ArrayList<Cell>();
  int count=3;
  for (int i=0; i < count; i++) {
    cells.add(CELL);
  }
  AbstractRpcClient client=createRpcClient(conf);
  TestRpcServer rpcServer=new TestRpcServer();
  try {
    rpcServer.start();
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    PayloadCarryingRpcController pcrc=new PayloadCarryingRpcController(CellUtil.createCellScanner(cells));
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    Pair<Message,CellScanner> r=client.call(pcrc,md,param,md.getOutputType().toProto(),User.getCurrent(),address,new MetricsConnection.CallStats());
    int index=0;
    while (r.getSecond().advance()) {
      assertTrue(CELL.equals(r.getSecond().current()));
      index++;
    }
    assertEquals(count,index);
  }
  finally {
    client.close();
    rpcServer.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRTEDuringConnectionSetup() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  TestRpcServer rpcServer=new TestRpcServer();
  AbstractRpcClient client=createRpcClientRTEDuringConnectionSetup(conf);
  try {
    rpcServer.start();
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    client.call(null,md,param,null,User.getCurrent(),address,new MetricsConnection.CallStats());
    fail("Expected an exception to have been thrown!");
  }
 catch (  Exception e) {
    LOG.info("Caught expected exception: " + e.toString());
    assertTrue(StringUtils.stringifyException(e).contains("Injected fault"));
  }
 finally {
    client.close();
    rpcServer.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestAsyncIPC </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRTEDuringAsyncConnectionSetup() throws Exception {
  TestRpcServer rpcServer=new TestRpcServer();
  AsyncRpcClient client=createRpcClientRTEDuringConnectionSetup(CONF);
  try {
    rpcServer.start();
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    RpcChannel channel=client.createRpcChannel(ServerName.valueOf(address.getHostName(),address.getPort(),System.currentTimeMillis()),User.getCurrent(),0);
    final AtomicBoolean done=new AtomicBoolean(false);
    PayloadCarryingRpcController controller=new PayloadCarryingRpcController();
    controller.notifyOnFail(new RpcCallback<IOException>(){
      @Override public void run(      IOException e){
        done.set(true);
        LOG.info("Caught expected exception: " + e.toString());
        assertTrue(StringUtils.stringifyException(e).contains("Injected fault"));
      }
    }
);
    channel.callMethod(md,controller,param,md.getOutputType().toProto(),new RpcCallback<Message>(){
      @Override public void run(      Message parameter){
        done.set(true);
        fail("Expected an exception to have been thrown!");
      }
    }
);
    TEST_UTIL.waitFor(1000,new Waiter.Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return done.get();
      }
    }
);
  }
  finally {
    client.close();
    rpcServer.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestGlobalEventLoopGroup </h4><pre class="type-7 type-8 type-16 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  Configuration conf=HBaseConfiguration.create();
  conf.setBoolean(AsyncRpcClient.USE_GLOBAL_EVENT_LOOP_GROUP,true);
  AsyncRpcClient client=new AsyncRpcClient(conf);
  assertNotNull(AsyncRpcClient.GLOBAL_EVENT_LOOP_GROUP);
  AsyncRpcClient client1=new AsyncRpcClient(conf);
  assertSame(client.bootstrap.group(),client1.bootstrap.group());
  client1.close();
  assertFalse(client.bootstrap.group().isShuttingDown());
  conf.setBoolean(AsyncRpcClient.USE_GLOBAL_EVENT_LOOP_GROUP,false);
  AsyncRpcClient client2=new AsyncRpcClient(conf);
  assertNotSame(client.bootstrap.group(),client2.bootstrap.group());
  client2.close();
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestPayloadCarryingRpcController </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListOfCellScannerables() throws IOException {
  List<CellScannable> cells=new ArrayList<CellScannable>();
  final int count=10;
  for (int i=0; i < count; i++) {
    cells.add(createCell(i));
  }
  PayloadCarryingRpcController controller=new PayloadCarryingRpcController(cells);
  CellScanner cellScanner=controller.cellScanner();
  int index=0;
  for (; cellScanner.advance(); index++) {
    Cell cell=cellScanner.current();
    byte[] indexBytes=Bytes.toBytes(index);
    assertTrue("" + index,Bytes.equals(indexBytes,0,indexBytes.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
  }
  assertEquals(count,index);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestProtoBufRpc </h4><pre class="type-4 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProtoBufRpc() throws Exception {
  RpcClient rpcClient=RpcClientFactory.createClient(conf,HConstants.CLUSTER_ID_DEFAULT);
  try {
    BlockingRpcChannel channel=rpcClient.createBlockingRpcChannel(ServerName.valueOf(this.isa.getHostName(),this.isa.getPort(),System.currentTimeMillis()),User.getCurrent(),0);
    TestRpcServiceProtos.TestProtobufRpcProto.BlockingInterface stub=TestRpcServiceProtos.TestProtobufRpcProto.newBlockingStub(channel);
    TestProtos.EmptyRequestProto emptyRequest=TestProtos.EmptyRequestProto.newBuilder().build();
    stub.ping(null,emptyRequest);
    EchoRequestProto echoRequest=EchoRequestProto.newBuilder().setMessage("hello").build();
    EchoResponseProto echoResponse=stub.echo(null,echoRequest);
    Assert.assertEquals(echoResponse.getMessage(),"hello");
    try {
      stub.error(null,emptyRequest);
      Assert.fail("Expected exception is not thrown");
    }
 catch (    ServiceException e) {
    }
  }
  finally {
    rpcClient.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestRpcClientLeaks </h4><pre class="type-8 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RetriesExhaustedException.class) public void testSocketClosed() throws IOException, InterruptedException {
  String tableName="testSocketClosed";
  TableName name=TableName.valueOf(tableName);
  UTIL.createTable(name,fam1).close();
  Configuration conf=new Configuration(UTIL.getConfiguration());
  conf.set(RpcClientFactory.CUSTOM_RPC_CLIENT_IMPL_CONF_KEY,MyRpcClientImpl.class.getName());
  conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,2);
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(TableName.valueOf(tableName));
  table.get(new Get("asd".getBytes()));
  connection.close();
  for (  Socket socket : MyRpcClientImpl.savedSockets) {
    assertTrue("Socket + " + socket + " is not closed",socket.isClosed());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestGroupingTableMap </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"deprecation"}) public void shouldCreateNewKey() throws Exception {
  GroupingTableMap gTableMap=null;
  try {
    Result result=mock(Result.class);
    Reporter reporter=mock(Reporter.class);
    final byte[] bSeparator=Bytes.toBytes(" ");
    gTableMap=new GroupingTableMap();
    Configuration cfg=new Configuration();
    cfg.set(GroupingTableMap.GROUP_COLUMNS,"familyA:qualifierA familyB:qualifierB");
    JobConf jobConf=new JobConf(cfg);
    gTableMap.configure(jobConf);
    final byte[] firstPartKeyValue=Bytes.toBytes("34879512738945");
    final byte[] secondPartKeyValue=Bytes.toBytes("35245142671437");
    byte[] row={};
    List<Cell> cells=ImmutableList.<Cell>of(new KeyValue(row,"familyA".getBytes(),"qualifierA".getBytes(),firstPartKeyValue),new KeyValue(row,"familyB".getBytes(),"qualifierB".getBytes(),secondPartKeyValue));
    when(result.listCells()).thenReturn(cells);
    final AtomicBoolean outputCollected=new AtomicBoolean();
    OutputCollector<ImmutableBytesWritable,Result> outputCollector=new OutputCollector<ImmutableBytesWritable,Result>(){
      @Override public void collect(      ImmutableBytesWritable arg,      Result result) throws IOException {
        assertArrayEquals(com.google.common.primitives.Bytes.concat(firstPartKeyValue,bSeparator,secondPartKeyValue),arg.copyBytes());
        outputCollected.set(true);
      }
    }
;
    gTableMap.map(null,result,outputCollector,reporter);
    verify(result).listCells();
    Assert.assertTrue("Output not received",outputCollected.get());
    final byte[] firstPartValue=Bytes.toBytes("238947928");
    final byte[] secondPartValue=Bytes.toBytes("4678456942345");
    byte[][] data={firstPartValue,secondPartValue};
    ImmutableBytesWritable byteWritable=gTableMap.createGroupKey(data);
    assertArrayEquals(com.google.common.primitives.Bytes.concat(firstPartValue,bSeparator,secondPartValue),byteWritable.get());
  }
  finally {
    if (gTableMap != null)     gTableMap.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestRowCounter </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void shouldExitAndPrintUsageSinceParameterNumberLessThanThree() throws Exception {
  final String[] args=new String[]{"one","two"};
  String line="ERROR: Wrong number of parameters: " + args.length;
  String result=new OutputReader(System.err){
    @Override void doRead() throws Exception {
      assertEquals(-1,new RowCounter().run(args));
    }
  }
.read();
  assertTrue(result.startsWith(line));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"deprecation"}) public void shouldCreateAndRunSubmittableJob() throws Exception {
  RowCounter rCounter=new RowCounter();
  rCounter.setConf(HBaseConfiguration.create());
  String[] args=new String[]{"\temp","tableA","column1","column2","column3"};
  JobConf jobConfig=rCounter.createSubmittableJob(args);
  assertNotNull(jobConfig);
  assertEquals(0,jobConfig.getNumReduceTasks());
  assertEquals("rowcounter",jobConfig.getJobName());
  assertEquals(jobConfig.getMapOutputValueClass(),Result.class);
  assertEquals(jobConfig.getMapperClass(),RowCounterMapper.class);
  assertEquals(jobConfig.get(TableInputFormat.COLUMN_LIST),Joiner.on(' ').join("column1","column2","column3"));
  assertEquals(jobConfig.getMapOutputKeyClass(),ImmutableBytesWritable.class);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void shouldPrintUsage() throws Exception {
  String expectedOutput="rowcounter <outputdir> <tablename> <column1> [<column2>...]";
  String result=new OutputReader(System.out){
    @Override void doRead(){
      assertEquals(-1,RowCounter.printUsage());
    }
  }
.read();
  assertTrue(result.startsWith(expectedOutput));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestTableMapReduceUtil </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check what the given number of reduce tasks for the given job configuration
 * does not exceed the number of regions for the given table.
 */
@Test public void shouldNumberOfReduceTaskNotExceedNumberOfRegionsForGivenTable() throws IOException {
  Assert.assertNotNull(presidentsTable);
  Configuration cfg=UTIL.getConfiguration();
  JobConf jobConf=new JobConf(cfg);
  TableMapReduceUtil.setNumReduceTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.limitNumReduceTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.setScannerCaching(jobConf,100);
  assertEquals(1,jobConf.getNumReduceTasks());
  assertEquals(100,jobConf.getInt("hbase.client.scanner.caching",0));
  jobConf.setNumReduceTasks(10);
  TableMapReduceUtil.setNumMapTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.limitNumReduceTasks(TABLE_NAME,jobConf);
  assertEquals(1,jobConf.getNumReduceTasks());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.IntegrationTestTableMapReduceUtil </h4><pre class="type-2 type-21 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void skipMiniCluster(){
  assumeTrue("test requires a distributed cluster.",util.isDistributedCluster());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestCellCounter </h4><pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method of CellCounter
 */
@Test(timeout=300000) public void testCellCounterMain() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    try {
      CellCounter.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("ERROR: Wrong number of parameters:"));
      assertTrue(data.toString().contains("Usage:"));
    }
  }
  finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestCopyTable </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStartStopRow() throws Exception {
  final TableName TABLENAME1=TableName.valueOf("testStartStopRow1");
  final TableName TABLENAME2=TableName.valueOf("testStartStopRow2");
  final byte[] FAMILY=Bytes.toBytes("family");
  final byte[] COLUMN1=Bytes.toBytes("c1");
  final byte[] ROW0=Bytes.toBytes("row0");
  final byte[] ROW1=Bytes.toBytes("row1");
  final byte[] ROW2=Bytes.toBytes("row2");
  Table t1=TEST_UTIL.createTable(TABLENAME1,FAMILY);
  Table t2=TEST_UTIL.createTable(TABLENAME2,FAMILY);
  Put p=new Put(ROW0);
  p.addColumn(FAMILY,COLUMN1,COLUMN1);
  t1.put(p);
  p=new Put(ROW1);
  p.addColumn(FAMILY,COLUMN1,COLUMN1);
  t1.put(p);
  p=new Put(ROW2);
  p.addColumn(FAMILY,COLUMN1,COLUMN1);
  t1.put(p);
  CopyTable copy=new CopyTable();
  assertEquals(0,ToolRunner.run(new Configuration(TEST_UTIL.getConfiguration()),copy,new String[]{"--new.name=" + TABLENAME2,"--startrow=row1","--stoprow=row2",TABLENAME1.getNameAsString()}));
  Get g=new Get(ROW1);
  Result r=t2.get(g);
  assertEquals(1,r.size());
  assertTrue(CellUtil.matchingQualifier(r.rawCells()[0],COLUMN1));
  g=new Get(ROW0);
  r=t2.get(g);
  assertEquals(0,r.size());
  g=new Get(ROW2);
  r=t2.get(g);
  assertEquals(0,r.size());
  t1.close();
  t2.close();
  TEST_UTIL.deleteTable(TABLENAME1);
  TEST_UTIL.deleteTable(TABLENAME2);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test copy of table from sourceTable to targetTable all rows from family a
 */
@Test public void testRenameFamily() throws Exception {
  TableName sourceTable=TableName.valueOf("sourceTable");
  TableName targetTable=TableName.valueOf("targetTable");
  byte[][] families={FAMILY_A,FAMILY_B};
  Table t=TEST_UTIL.createTable(sourceTable,families);
  Table t2=TEST_UTIL.createTable(targetTable,families);
  Put p=new Put(ROW1);
  p.addColumn(FAMILY_A,QUALIFIER,Bytes.toBytes("Data11"));
  p.addColumn(FAMILY_B,QUALIFIER,Bytes.toBytes("Data12"));
  p.addColumn(FAMILY_A,QUALIFIER,Bytes.toBytes("Data13"));
  t.put(p);
  p=new Put(ROW2);
  p.addColumn(FAMILY_B,QUALIFIER,Bytes.toBytes("Dat21"));
  p.addColumn(FAMILY_A,QUALIFIER,Bytes.toBytes("Data22"));
  p.addColumn(FAMILY_B,QUALIFIER,Bytes.toBytes("Data23"));
  t.put(p);
  long currentTime=System.currentTimeMillis();
  String[] args=new String[]{"--new.name=" + targetTable,"--families=a:b","--all.cells","--starttime=" + (currentTime - 100000),"--endtime=" + (currentTime + 100000),"--versions=1",sourceTable.getNameAsString()};
  assertNull(t2.get(new Get(ROW1)).getRow());
  assertTrue(runCopy(args));
  assertNotNull(t2.get(new Get(ROW1)).getRow());
  Result res=t2.get(new Get(ROW1));
  byte[] b1=res.getValue(FAMILY_B,QUALIFIER);
  assertEquals("Data13",new String(b1));
  assertNotNull(t2.get(new Get(ROW2)).getRow());
  res=t2.get(new Get(ROW2));
  b1=res.getValue(FAMILY_A,QUALIFIER);
  assertNull(b1);
}

</code></pre>

<br>
<pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method of CopyTable.
 */
@Test public void testMainMethod() throws Exception {
  String[] emptyArgs={"-h"};
  PrintStream oldWriter=System.err;
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  PrintStream writer=new PrintStream(data);
  System.setErr(writer);
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  try {
    CopyTable.main(emptyArgs);
    fail("should be exit");
  }
 catch (  SecurityException e) {
    assertEquals(1,newSecurityManager.getExitCode());
  }
 finally {
    System.setErr(oldWriter);
    System.setSecurityManager(SECURITY_MANAGER);
  }
  assertTrue(data.toString().contains("rs.class"));
  assertTrue(data.toString().contains("Usage:"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat2 </h4><pre class="type-7 type-8 type-16 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test that {@link HFileOutputFormat2} RecordWriter amends timestamps if
 * passed a keyvalue whose timestamp is {@link HConstants#LATEST_TIMESTAMP}.
 * @see <a href="https://issues.apache.org/jira/browse/HBASE-2615">HBASE-2615</a>
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void test_LATEST_TIMESTAMP_isReplaced() throws Exception {
  Configuration conf=new Configuration(this.util.getConfiguration());
  RecordWriter<ImmutableBytesWritable,Cell> writer=null;
  TaskAttemptContext context=null;
  Path dir=util.getDataTestDir("test_LATEST_TIMESTAMP_isReplaced");
  try {
    Job job=new Job(conf);
    FileOutputFormat.setOutputPath(job,dir);
    context=createTestTaskAttemptContext(job);
    HFileOutputFormat2 hof=new HFileOutputFormat2();
    writer=hof.getRecordWriter(context);
    final byte[] b=Bytes.toBytes("b");
    KeyValue kv=new KeyValue(b,b,b);
    KeyValue original=kv.clone();
    writer.write(new ImmutableBytesWritable(),kv);
    assertFalse(original.equals(kv));
    assertTrue(Bytes.equals(CellUtil.cloneRow(original),CellUtil.cloneRow(kv)));
    assertTrue(Bytes.equals(CellUtil.cloneFamily(original),CellUtil.cloneFamily(kv)));
    assertTrue(Bytes.equals(CellUtil.cloneQualifier(original),CellUtil.cloneQualifier(kv)));
    assertNotSame(original.getTimestamp(),kv.getTimestamp());
    assertNotSame(HConstants.LATEST_TIMESTAMP,kv.getTimestamp());
    kv=new KeyValue(b,b,b,kv.getTimestamp() - 1,b);
    original=kv.clone();
    writer.write(new ImmutableBytesWritable(),kv);
    assertTrue(original.equals(kv));
  }
  finally {
    if (writer != null && context != null)     writer.close(context);
    dir.getFileSystem(conf).delete(dir,true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureBloomType(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyBloomTypeMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyBloomTypeMap() throws IOException {
  for (int numCfs=0; numCfs <= 2; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,BloomType> familyToBloomType=getMockColumnFamiliesForBloomType(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForBloomType(table,familyToBloomType);
    HFileOutputFormat2.configureBloomType(table.getTableDescriptor(),conf);
    Map<byte[],BloomType> retrievedFamilyToBloomTypeMap=HFileOutputFormat2.createFamilyBloomTypeMap(conf);
    for (    Entry<String,BloomType> entry : familyToBloomType.entrySet()) {
      assertEquals("BloomType configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToBloomTypeMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureCompression(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyCompressionMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyCompressionMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,Compression.Algorithm> familyToCompression=getMockColumnFamiliesForCompression(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForCompression(table,familyToCompression);
    HFileOutputFormat2.configureCompression(conf,table.getTableDescriptor());
    Map<byte[],Algorithm> retrievedFamilyToCompressionMap=HFileOutputFormat2.createFamilyCompressionMap(conf);
    for (    Entry<String,Algorithm> entry : familyToCompression.entrySet()) {
      assertEquals("Compression configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToCompressionMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void test_TIMERANGE() throws Exception {
  Configuration conf=new Configuration(this.util.getConfiguration());
  RecordWriter<ImmutableBytesWritable,Cell> writer=null;
  TaskAttemptContext context=null;
  Path dir=util.getDataTestDir("test_TIMERANGE_present");
  LOG.info("Timerange dir writing to dir: " + dir);
  try {
    Job job=new Job(conf);
    FileOutputFormat.setOutputPath(job,dir);
    context=createTestTaskAttemptContext(job);
    HFileOutputFormat2 hof=new HFileOutputFormat2();
    writer=hof.getRecordWriter(context);
    final byte[] b=Bytes.toBytes("b");
    KeyValue kv=new KeyValue(b,b,b,2000,b);
    KeyValue original=kv.clone();
    writer.write(new ImmutableBytesWritable(),kv);
    assertEquals(original,kv);
    kv=new KeyValue(b,b,b,1000,b);
    original=kv.clone();
    writer.write(new ImmutableBytesWritable(),kv);
    assertEquals(original,kv);
    writer.close(context);
    FileSystem fs=FileSystem.get(conf);
    Path attemptDirectory=hof.getDefaultWorkFile(context,"").getParent();
    FileStatus[] sub1=fs.listStatus(attemptDirectory);
    FileStatus[] file=fs.listStatus(sub1[0].getPath());
    HFile.Reader rd=HFile.createReader(fs,file[0].getPath(),new CacheConfig(conf),conf);
    Map<byte[],byte[]> finfo=rd.loadFileInfo();
    byte[] range=finfo.get("TIMERANGE".getBytes());
    assertNotNull(range);
    TimeRangeTracker timeRangeTracker=new TimeRangeTracker();
    Writables.copyWritable(range,timeRangeTracker);
    LOG.info(timeRangeTracker.getMinimumTimestamp() + "...." + timeRangeTracker.getMaximumTimestamp());
    assertEquals(1000,timeRangeTracker.getMinimumTimestamp());
    assertEquals(2000,timeRangeTracker.getMaximumTimestamp());
    rd.close();
  }
  finally {
    if (writer != null && context != null)     writer.close(context);
    dir.getFileSystem(conf).delete(dir,true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test that {@link HFileOutputFormat2} RecordWriter uses compression and
 * bloom filter settings from the column family descriptor
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testColumnFamilySettings() throws Exception {
  Configuration conf=new Configuration(this.util.getConfiguration());
  RecordWriter<ImmutableBytesWritable,Cell> writer=null;
  TaskAttemptContext context=null;
  Path dir=util.getDataTestDir("testColumnFamilySettings");
  Table table=Mockito.mock(Table.class);
  RegionLocator regionLocator=Mockito.mock(RegionLocator.class);
  HTableDescriptor htd=new HTableDescriptor(TABLE_NAME);
  Mockito.doReturn(htd).when(table).getTableDescriptor();
  for (  HColumnDescriptor hcd : HBaseTestingUtility.generateColumnDescriptors()) {
    htd.addFamily(hcd);
  }
  setupMockStartKeys(regionLocator);
  try {
    conf.set("io.seqfile.compression.type","NONE");
    conf.set("hbase.fs.tmp.dir",dir.toString());
    conf.setBoolean(HFileOutputFormat2.LOCALITY_SENSITIVE_CONF_KEY,false);
    Job job=new Job(conf,"testLocalMRIncrementalLoad");
    job.setWorkingDirectory(util.getDataTestDirOnTestFS("testColumnFamilySettings"));
    setupRandomGeneratorMapper(job);
    HFileOutputFormat2.configureIncrementalLoad(job,table.getTableDescriptor(),regionLocator);
    FileOutputFormat.setOutputPath(job,dir);
    context=createTestTaskAttemptContext(job);
    HFileOutputFormat2 hof=new HFileOutputFormat2();
    writer=hof.getRecordWriter(context);
    writeRandomKeyValues(writer,context,htd.getFamiliesKeys(),ROWSPERSPLIT);
    writer.close(context);
    FileSystem fs=dir.getFileSystem(conf);
    hof.getOutputCommitter(context).commitTask(context);
    hof.getOutputCommitter(context).commitJob(context);
    FileStatus[] families=FSUtils.listStatus(fs,dir,new FSUtils.FamilyDirFilter(fs));
    assertEquals(htd.getFamilies().size(),families.length);
    for (    FileStatus f : families) {
      String familyStr=f.getPath().getName();
      HColumnDescriptor hcd=htd.getFamily(Bytes.toBytes(familyStr));
      Path dataFilePath=fs.listStatus(f.getPath())[0].getPath();
      Reader reader=HFile.createReader(fs,dataFilePath,new CacheConfig(conf),conf);
      Map<byte[],byte[]> fileInfo=reader.loadFileInfo();
      byte[] bloomFilter=fileInfo.get(StoreFile.BLOOM_FILTER_TYPE_KEY);
      if (bloomFilter == null)       bloomFilter=Bytes.toBytes("NONE");
      assertEquals("Incorrect bloom filter used for column family " + familyStr + "(reader: "+ reader+ ")",hcd.getBloomFilterType(),BloomType.valueOf(Bytes.toString(bloomFilter)));
      assertEquals("Incorrect compression used for column family " + familyStr + "(reader: "+ reader+ ")",hcd.getCompressionType(),reader.getFileContext().getCompression());
    }
  }
  finally {
    dir.getFileSystem(conf).delete(dir,true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureDataBlockEncoding(HTableDescriptor,Configuration)}and {@link HFileOutputFormat2#createFamilyDataBlockEncodingMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyDataBlockEncodingMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,DataBlockEncoding> familyToDataBlockEncoding=getMockColumnFamiliesForDataBlockEncoding(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForDataBlockEncoding(table,familyToDataBlockEncoding);
    HTableDescriptor tableDescriptor=table.getTableDescriptor();
    HFileOutputFormat2.configureDataBlockEncoding(tableDescriptor,conf);
    Map<byte[],DataBlockEncoding> retrievedFamilyToDataBlockEncodingMap=HFileOutputFormat2.createFamilyDataBlockEncodingMap(conf);
    for (    Entry<String,DataBlockEncoding> entry : familyToDataBlockEncoding.entrySet()) {
      assertEquals("DataBlockEncoding configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToDataBlockEncodingMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Run small MR job.
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testWritingPEData() throws Exception {
  Configuration conf=util.getConfiguration();
  Path testDir=util.getDataTestDirOnTestFS("testWritingPEData");
  FileSystem fs=testDir.getFileSystem(conf);
  conf.setInt("mapreduce.task.io.sort.mb",20);
  conf.setLong(HConstants.HREGION_MAX_FILESIZE,64 * 1024);
  Job job=new Job(conf,"testWritingPEData");
  setupRandomGeneratorMapper(job);
  byte[] startKey=new byte[RandomKVGeneratingMapper.KEYLEN_DEFAULT];
  byte[] endKey=new byte[RandomKVGeneratingMapper.KEYLEN_DEFAULT];
  Arrays.fill(startKey,(byte)0);
  Arrays.fill(endKey,(byte)0xff);
  job.setPartitionerClass(SimpleTotalOrderPartitioner.class);
  SimpleTotalOrderPartitioner.setStartKey(job.getConfiguration(),startKey);
  SimpleTotalOrderPartitioner.setEndKey(job.getConfiguration(),endKey);
  job.setReducerClass(KeyValueSortReducer.class);
  job.setOutputFormatClass(HFileOutputFormat2.class);
  job.setNumReduceTasks(4);
  job.getConfiguration().setStrings("io.serializations",conf.get("io.serializations"),MutationSerialization.class.getName(),ResultSerialization.class.getName(),KeyValueSerialization.class.getName());
  FileOutputFormat.setOutputPath(job,testDir);
  assertTrue(job.waitForCompletion(false));
  FileStatus[] files=fs.listStatus(testDir);
  assertTrue(files.length > 0);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This test is to test the scenario happened in HBASE-6901.
 * All files are bulk loaded and excluded from minor compaction.
 * Without the fix of HBASE-6901, an ArrayIndexOutOfBoundsException
 * will be thrown.
 */
@Ignore("Flakey: See HBASE-9051") @Test public void testExcludeAllFromMinorCompaction() throws Exception {
  Configuration conf=util.getConfiguration();
  conf.setInt("hbase.hstore.compaction.min",2);
  generateRandomStartKeys(5);
  util.startMiniCluster();
  try (Connection conn=ConnectionFactory.createConnection();Admin admin=conn.getAdmin();Table table=util.createTable(TABLE_NAME,FAMILIES);RegionLocator locator=conn.getRegionLocator(TABLE_NAME)){
    final FileSystem fs=util.getDFSCluster().getFileSystem();
    assertEquals("Should start with empty table",0,util.countRows(table));
    final Path storePath=new Path(FSUtils.getTableDir(FSUtils.getRootDir(conf),TABLE_NAME),new Path(admin.getTableRegions(TABLE_NAME).get(0).getEncodedName(),Bytes.toString(FAMILIES[0])));
    assertEquals(0,fs.listStatus(storePath).length);
    conf.setBoolean("hbase.mapreduce.hfileoutputformat.compaction.exclude",true);
    for (int i=0; i < 2; i++) {
      Path testDir=util.getDataTestDirOnTestFS("testExcludeAllFromMinorCompaction_" + i);
      runIncrementalPELoad(conf,table.getTableDescriptor(),conn.getRegionLocator(TABLE_NAME),testDir);
      new LoadIncrementalHFiles(conf).doBulkLoad(testDir,admin,table,locator);
    }
    int expectedRows=2 * NMapInputFormat.getNumMapTasks(conf) * ROWSPERSPLIT;
    assertEquals("LoadIncrementalHFiles should put expected data in table",expectedRows,util.countRows(table));
    assertEquals(2,fs.listStatus(storePath).length);
    admin.compact(TABLE_NAME);
    try {
      quickPoll(new Callable<Boolean>(){
        @Override public Boolean call() throws Exception {
          List<HRegion> regions=util.getMiniHBaseCluster().getRegions(TABLE_NAME);
          for (          HRegion region : regions) {
            for (            Store store : region.getStores()) {
              store.closeAndArchiveCompactedFiles();
            }
          }
          return fs.listStatus(storePath).length == 1;
        }
      }
,5000);
      throw new IOException("SF# = " + fs.listStatus(storePath).length);
    }
 catch (    AssertionError ae) {
    }
    admin.majorCompact(TABLE_NAME);
    quickPoll(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        List<HRegion> regions=util.getMiniHBaseCluster().getRegions(TABLE_NAME);
        for (        HRegion region : regions) {
          for (          Store store : region.getStores()) {
            store.closeAndArchiveCompactedFiles();
          }
        }
        return fs.listStatus(storePath).length == 1;
      }
    }
,5000);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testExcludeMinorCompaction() throws Exception {
  Configuration conf=util.getConfiguration();
  conf.setInt("hbase.hstore.compaction.min",2);
  generateRandomStartKeys(5);
  util.startMiniCluster();
  try (Connection conn=ConnectionFactory.createConnection(conf);Admin admin=conn.getAdmin()){
    Path testDir=util.getDataTestDirOnTestFS("testExcludeMinorCompaction");
    final FileSystem fs=util.getDFSCluster().getFileSystem();
    Table table=util.createTable(TABLE_NAME,FAMILIES);
    assertEquals("Should start with empty table",0,util.countRows(table));
    final Path storePath=new Path(FSUtils.getTableDir(FSUtils.getRootDir(conf),TABLE_NAME),new Path(admin.getTableRegions(TABLE_NAME).get(0).getEncodedName(),Bytes.toString(FAMILIES[0])));
    assertEquals(0,fs.listStatus(storePath).length);
    Put p=new Put(Bytes.toBytes("test"));
    p.addColumn(FAMILIES[0],Bytes.toBytes("1"),Bytes.toBytes("1"));
    table.put(p);
    admin.flush(TABLE_NAME);
    assertEquals(1,util.countRows(table));
    quickPoll(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        return fs.listStatus(storePath).length == 1;
      }
    }
,5000);
    conf.setBoolean("hbase.mapreduce.hfileoutputformat.compaction.exclude",true);
    RegionLocator regionLocator=conn.getRegionLocator(TABLE_NAME);
    runIncrementalPELoad(conf,table.getTableDescriptor(),regionLocator,testDir);
    new LoadIncrementalHFiles(conf).doBulkLoad(testDir,admin,table,regionLocator);
    int expectedRows=NMapInputFormat.getNumMapTasks(conf) * ROWSPERSPLIT;
    assertEquals("LoadIncrementalHFiles should put expected data in table",expectedRows + 1,util.countRows(table));
    assertEquals(2,fs.listStatus(storePath).length);
    admin.compact(TABLE_NAME);
    try {
      quickPoll(new Callable<Boolean>(){
        @Override public Boolean call() throws Exception {
          return fs.listStatus(storePath).length == 1;
        }
      }
,5000);
      throw new IOException("SF# = " + fs.listStatus(storePath).length);
    }
 catch (    AssertionError ae) {
    }
    admin.majorCompact(TABLE_NAME);
    quickPoll(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        return fs.listStatus(storePath).length == 1;
      }
    }
,5000);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test for {@link HFileOutputFormat2#configureBlockSize(org.apache.hadoop.hbase.client.Table,Configuration)} and {@link HFileOutputFormat2#createFamilyBlockSizeMap(Configuration)}.
 * Tests that the compression map is correctly serialized into
 * and deserialized from configuration
 * @throws IOException
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testSerializeDeserializeFamilyBlockSizeMap() throws IOException {
  for (int numCfs=0; numCfs <= 3; numCfs++) {
    Configuration conf=new Configuration(this.util.getConfiguration());
    Map<String,Integer> familyToBlockSize=getMockColumnFamiliesForBlockSize(numCfs);
    Table table=Mockito.mock(HTable.class);
    setupMockColumnFamiliesForBlockSize(table,familyToBlockSize);
    HFileOutputFormat2.configureBlockSize(table.getTableDescriptor(),conf);
    Map<byte[],Integer> retrievedFamilyToBlockSizeMap=HFileOutputFormat2.createFamilyBlockSizeMap(conf);
    for (    Entry<String,Integer> entry : familyToBlockSize.entrySet()) {
      assertEquals("BlockSize configuration incorrect for column family:" + entry.getKey(),entry.getValue(),retrievedFamilyToBlockSizeMap.get(entry.getKey().getBytes()));
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testJobConfiguration() throws Exception {
  Configuration conf=new Configuration(this.util.getConfiguration());
  conf.set(HConstants.TEMPORARY_FS_DIRECTORY_KEY,util.getDataTestDir("testJobConfiguration").toString());
  Job job=new Job(conf);
  job.setWorkingDirectory(util.getDataTestDir("testJobConfiguration"));
  Table table=Mockito.mock(Table.class);
  RegionLocator regionLocator=Mockito.mock(RegionLocator.class);
  setupMockStartKeys(regionLocator);
  setupMockTableName(regionLocator);
  HFileOutputFormat2.configureIncrementalLoad(job,table.getTableDescriptor(),regionLocator);
  assertEquals(job.getNumReduceTasks(),4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestHashTable </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashTable() throws Exception {
  final TableName tableName=TableName.valueOf("testHashTable");
  final byte[] family=Bytes.toBytes("family");
  final byte[] column1=Bytes.toBytes("c1");
  final byte[] column2=Bytes.toBytes("c2");
  final byte[] column3=Bytes.toBytes("c3");
  int numRows=100;
  int numRegions=10;
  int numHashFiles=3;
  byte[][] splitRows=new byte[numRegions - 1][];
  for (int i=1; i < numRegions; i++) {
    splitRows[i - 1]=Bytes.toBytes(numRows * i / numRegions);
  }
  long timestamp=1430764183454L;
  Table t1=TEST_UTIL.createTable(tableName,family,splitRows);
  for (int i=0; i < numRows; i++) {
    Put p=new Put(Bytes.toBytes(i),timestamp);
    p.addColumn(family,column1,column1);
    p.addColumn(family,column2,column2);
    p.addColumn(family,column3,column3);
    t1.put(p);
  }
  t1.close();
  HashTable hashTable=new HashTable(TEST_UTIL.getConfiguration());
  Path testDir=TEST_UTIL.getDataTestDirOnTestFS(tableName.getNameAsString());
  long batchSize=300;
  int code=hashTable.run(new String[]{"--batchsize=" + batchSize,"--numhashfiles=" + numHashFiles,"--scanbatch=2",tableName.getNameAsString(),testDir.toString()});
  assertEquals("test job failed",0,code);
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  HashTable.TableHash tableHash=HashTable.TableHash.read(fs.getConf(),testDir);
  assertEquals(tableName.getNameAsString(),tableHash.tableName);
  assertEquals(batchSize,tableHash.batchSize);
  assertEquals(numHashFiles,tableHash.numHashFiles);
  assertEquals(numHashFiles - 1,tableHash.partitions.size());
  for (  ImmutableBytesWritable bytes : tableHash.partitions) {
    LOG.debug("partition: " + Bytes.toInt(bytes.get()));
  }
  ImmutableMap<Integer,ImmutableBytesWritable> expectedHashes=ImmutableMap.<Integer,ImmutableBytesWritable>builder().put(-1,new ImmutableBytesWritable(Bytes.fromHex("714cb10a9e3b5569852980edd8c6ca2f"))).put(5,new ImmutableBytesWritable(Bytes.fromHex("28d961d9252ce8f8d44a07b38d3e1d96"))).put(10,new ImmutableBytesWritable(Bytes.fromHex("f6bbc4a224d8fd929b783a92599eaffa"))).put(15,new ImmutableBytesWritable(Bytes.fromHex("522deb5d97f73a414ecc11457be46881"))).put(20,new ImmutableBytesWritable(Bytes.fromHex("b026f2611aaa46f7110116d807545352"))).put(25,new ImmutableBytesWritable(Bytes.fromHex("39ffc1a3094aa12a2e90ffd9cef2ce93"))).put(30,new ImmutableBytesWritable(Bytes.fromHex("f6b4d75727ce9a30ac29e4f08f601666"))).put(35,new ImmutableBytesWritable(Bytes.fromHex("422e2d2f1eb79a8f02171a705a42c090"))).put(40,new ImmutableBytesWritable(Bytes.fromHex("559ad61c900fffefea0a15abf8a97bc3"))).put(45,new ImmutableBytesWritable(Bytes.fromHex("23019084513eca41cee436b2a29611cb"))).put(50,new ImmutableBytesWritable(Bytes.fromHex("b40467d222ddb4949b142fe145ee9edc"))).put(55,new ImmutableBytesWritable(Bytes.fromHex("372bf89fcd8ca4b7ab3c1add9d07f7e4"))).put(60,new ImmutableBytesWritable(Bytes.fromHex("69ae0585e6255de27dce974e332b8f8b"))).put(65,new ImmutableBytesWritable(Bytes.fromHex("8029610044297aad0abdbecd485d8e59"))).put(70,new ImmutableBytesWritable(Bytes.fromHex("de5f784f7f78987b6e57ecfd81c8646f"))).put(75,new ImmutableBytesWritable(Bytes.fromHex("1cd757cc4e1715c8c3b1c24447a1ec56"))).put(80,new ImmutableBytesWritable(Bytes.fromHex("f9a53aacfeb6142b08066615e7038095"))).put(85,new ImmutableBytesWritable(Bytes.fromHex("89b872b7e639df32d3276b33928c0c91"))).put(90,new ImmutableBytesWritable(Bytes.fromHex("45eeac0646d46a474ea0484175faed38"))).put(95,new ImmutableBytesWritable(Bytes.fromHex("f57c447e32a08f4bf1abb2892839ac56"))).build();
  Map<Integer,ImmutableBytesWritable> actualHashes=new HashMap<Integer,ImmutableBytesWritable>();
  Path dataDir=new Path(testDir,HashTable.HASH_DATA_DIR);
  for (int i=0; i < numHashFiles; i++) {
    Path hashPath=new Path(dataDir,HashTable.TableHash.getDataFileName(i));
    MapFile.Reader reader=new MapFile.Reader(hashPath,fs.getConf());
    ImmutableBytesWritable key=new ImmutableBytesWritable();
    ImmutableBytesWritable hash=new ImmutableBytesWritable();
    while (reader.next(key,hash)) {
      String keyString=Bytes.toHex(key.get(),key.getOffset(),key.getLength());
      LOG.debug("Key: " + (keyString.isEmpty() ? "-1" : Integer.parseInt(keyString,16)) + " Hash: "+ Bytes.toHex(hash.get(),hash.getOffset(),hash.getLength()));
      int intKey=-1;
      if (key.getLength() > 0) {
        intKey=Bytes.toInt(key.get(),key.getOffset(),key.getLength());
      }
      if (actualHashes.containsKey(intKey)) {
        Assert.fail("duplicate key in data files: " + intKey);
      }
      actualHashes.put(intKey,new ImmutableBytesWritable(hash.copyBytes()));
    }
    reader.close();
  }
  FileStatus[] files=fs.listStatus(testDir);
  for (  FileStatus file : files) {
    LOG.debug("Output file: " + file.getPath());
  }
  files=fs.listStatus(dataDir);
  for (  FileStatus file : files) {
    LOG.debug("Data file: " + file.getPath());
  }
  if (!expectedHashes.equals(actualHashes)) {
    LOG.error("Diff: " + Maps.difference(expectedHashes,actualHashes));
  }
  Assert.assertEquals(expectedHashes,actualHashes);
  TEST_UTIL.deleteTable(tableName);
  TEST_UTIL.cleanupDataTestDirOnTestFS();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportExport </h4><pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test main method. Export should print help and call System.exit
 */
@Test public void testExportMain() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    Export.main(args);
    fail("should be SecurityException");
  }
 catch (  SecurityException e) {
    assertEquals(-1,newSecurityManager.getExitCode());
    assertTrue(data.toString().contains("Wrong number of arguments:"));
    assertTrue(data.toString().contains("Usage: Export [-D <property=value>]* <tablename> <outputdir> [<versions> " + "[<starttime> [<endtime>]] [^[regex pattern] or [Prefix] to filter]]"));
    assertTrue(data.toString().contains("-D hbase.mapreduce.scan.column.family=<familyName>"));
    assertTrue(data.toString().contains("-D hbase.mapreduce.include.deleted.rows=true"));
    assertTrue(data.toString().contains("-Dhbase.client.scanner.caching=100"));
    assertTrue(data.toString().contains("-Dmapreduce.map.speculative=false"));
    assertTrue(data.toString().contains("-Dmapreduce.reduce.speculative=false"));
    assertTrue(data.toString().contains("-Dhbase.export.scanner.batch=10"));
  }
 finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithMultipleDeleteFamilyMarkersOfSameRowSameFamily() throws Exception {
  TableName EXPORT_TABLE=TableName.valueOf("exportWithMultipleDeleteFamilyMarkersOfSameRowSameFamily");
  HTableDescriptor desc=new HTableDescriptor(EXPORT_TABLE);
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE));
  UTIL.getHBaseAdmin().createTable(desc);
  Table exportT=UTIL.getConnection().getTable(EXPORT_TABLE);
  Put p=new Put(ROW1);
  p.addColumn(FAMILYA,QUAL,now,QUAL);
  exportT.put(p);
  Delete d=new Delete(ROW1,now + 3);
  exportT.delete(d);
  p=new Put(ROW1);
  p.addColumn(FAMILYA,QUAL,now + 5,"s".getBytes());
  exportT.put(p);
  d=new Delete(ROW1,now + 7);
  exportT.delete(d);
  String[] args=new String[]{"-D" + Export.RAW_SCAN + "=true",EXPORT_TABLE.getNameAsString(),FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  String IMPORT_TABLE="importWithMultipleDeleteFamilyMarkersOfSameRowSameFamily";
  desc=new HTableDescriptor(TableName.valueOf(IMPORT_TABLE));
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE));
  UTIL.getHBaseAdmin().createTable(desc);
  Table importT=UTIL.getConnection().getTable(TableName.valueOf(IMPORT_TABLE));
  args=new String[]{IMPORT_TABLE,FQ_OUTPUT_DIR};
  assertTrue(runImport(args));
  Scan s=new Scan();
  s.setMaxVersions();
  s.setRaw(true);
  ResultScanner importedTScanner=importT.getScanner(s);
  Result importedTResult=importedTScanner.next();
  ResultScanner exportedTScanner=exportT.getScanner(s);
  Result exportedTResult=exportedTScanner.next();
  try {
    Result.compareResults(exportedTResult,importedTResult);
  }
 catch (  Exception e) {
    fail("Original and imported tables data comparision failed with error:" + e.getMessage());
  }
 finally {
    exportT.close();
    importT.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test main method. Import should print help and call System.exit
 */
@Test public void testImportMain() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    Import.main(args);
    fail("should be SecurityException");
  }
 catch (  SecurityException e) {
    assertEquals(-1,newSecurityManager.getExitCode());
    assertTrue(data.toString().contains("Wrong number of arguments:"));
    assertTrue(data.toString().contains("-Dimport.bulk.output=/path/for/output"));
    assertTrue(data.toString().contains("-Dimport.filter.class=<name of filter class>"));
    assertTrue(data.toString().contains("-Dimport.bulk.output=/path/for/output"));
    assertTrue(data.toString().contains("-Dmapreduce.reduce.speculative=false"));
  }
 finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a simple table, run an Export Job on it, Import with filtering on,  verify counts,
 * attempt with invalid values.
 */
@Test public void testWithFilter() throws Exception {
  String EXPORT_TABLE="exportSimpleCase_ImportWithFilter";
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(EXPORT_TABLE));
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5));
  UTIL.getHBaseAdmin().createTable(desc);
  Table exportTable=UTIL.getConnection().getTable(desc.getTableName());
  Put p1=new Put(ROW1);
  p1.addColumn(FAMILYA,QUAL,now,QUAL);
  p1.addColumn(FAMILYA,QUAL,now + 1,QUAL);
  p1.addColumn(FAMILYA,QUAL,now + 2,QUAL);
  p1.addColumn(FAMILYA,QUAL,now + 3,QUAL);
  p1.addColumn(FAMILYA,QUAL,now + 4,QUAL);
  Put p2=new Put(ROW2);
  p2.addColumn(FAMILYA,QUAL,now,QUAL);
  exportTable.put(Arrays.asList(p1,p2));
  String[] args=new String[]{EXPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  String IMPORT_TABLE="importWithFilter";
  desc=new HTableDescriptor(TableName.valueOf(IMPORT_TABLE));
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5));
  UTIL.getHBaseAdmin().createTable(desc);
  Table importTable=UTIL.getConnection().getTable(desc.getTableName());
  args=new String[]{"-D" + Import.FILTER_CLASS_CONF_KEY + "="+ PrefixFilter.class.getName(),"-D" + Import.FILTER_ARGS_CONF_KEY + "="+ Bytes.toString(ROW1),IMPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertTrue(runImport(args));
  PrefixFilter filter=new PrefixFilter(ROW1);
  int count=getCount(exportTable,filter);
  Assert.assertEquals("Unexpected row count between export and import tables",count,getCount(importTable,null));
  args=new String[]{"-D" + Import.FILTER_CLASS_CONF_KEY + "="+ Filter.class.getName(),"-D" + Import.FILTER_ARGS_CONF_KEY + "="+ Bytes.toString(ROW1)+ "",EXPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertFalse(runImport(args));
  exportTable.close();
  importTable.close();
}

</code></pre>

<br>
<pre class="type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Allocates resources before the execution of the test cases
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before @After public void cleanup() throws Exception {
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  fs.delete(new Path(OUTPUT_DIR),true);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test import data from 0.94 exported file
 * @throws Exception
 */
@Test public void testImport94Table() throws Exception {
  final String name="exportedTableIn94Format";
  URL url=TestImportExport.class.getResource(name);
  File f=new File(url.toURI());
  if (!f.exists()) {
    LOG.warn("FAILED TO FIND " + f + "; skipping out on test");
    return;
  }
  assertTrue(f.exists());
  LOG.info("FILE=" + f);
  Path importPath=new Path(f.toURI());
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  fs.copyFromLocalFile(importPath,new Path(FQ_OUTPUT_DIR + Path.SEPARATOR + name));
  String IMPORT_TABLE=name;
  try (Table t=UTIL.createTable(TableName.valueOf(IMPORT_TABLE),Bytes.toBytes("f1"),3)){
    String[] args=new String[]{"-Dhbase.import.version=0.94",IMPORT_TABLE,FQ_OUTPUT_DIR};
    assertTrue(runImport(args));
    assertEquals(5,UTIL.countRows(t));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithDeletes() throws Exception {
  String EXPORT_TABLE="exportWithDeletes";
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(EXPORT_TABLE));
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE));
  UTIL.getHBaseAdmin().createTable(desc);
  try (Table t=UTIL.getConnection().getTable(desc.getTableName())){
    Put p=new Put(ROW1);
    p.addColumn(FAMILYA,QUAL,now,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 1,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 2,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 3,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 4,QUAL);
    t.put(p);
    Delete d=new Delete(ROW1,now + 3);
    t.delete(d);
    d=new Delete(ROW1);
    d.addColumns(FAMILYA,QUAL,now + 2);
    t.delete(d);
  }
   String[] args=new String[]{"-D" + Export.RAW_SCAN + "=true",EXPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  String IMPORT_TABLE="importWithDeletes";
  desc=new HTableDescriptor(TableName.valueOf(IMPORT_TABLE));
  desc.addFamily(new HColumnDescriptor(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE));
  UTIL.getHBaseAdmin().createTable(desc);
  try (Table t=UTIL.getConnection().getTable(desc.getTableName())){
    args=new String[]{IMPORT_TABLE,FQ_OUTPUT_DIR};
    assertTrue(runImport(args));
    Scan s=new Scan();
    s.setMaxVersions();
    s.setRaw(true);
    ResultScanner scanner=t.getScanner(s);
    Result r=scanner.next();
    Cell[] res=r.rawCells();
    assertTrue(CellUtil.isDeleteFamily(res[0]));
    assertEquals(now + 4,res[1].getTimestamp());
    assertEquals(now + 3,res[2].getTimestamp());
    assertTrue(CellUtil.isDelete(res[3]));
    assertEquals(now + 2,res[4].getTimestamp());
    assertEquals(now + 1,res[5].getTimestamp());
    assertEquals(now,res[6].getTimestamp());
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test simple replication case with column mapping
 * @throws Exception
 */
@Test public void testSimpleCase() throws Exception {
  String EXPORT_TABLE="exportSimpleCase";
  try (Table t=UTIL.createTable(TableName.valueOf(EXPORT_TABLE),FAMILYA,3)){
    Put p=new Put(ROW1);
    p.addColumn(FAMILYA,QUAL,now,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 1,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 2,QUAL);
    t.put(p);
    p=new Put(ROW2);
    p.addColumn(FAMILYA,QUAL,now,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 1,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 2,QUAL);
    t.put(p);
  }
   String[] args=new String[]{EXPORT_TABLE,FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  String IMPORT_TABLE="importTableSimpleCase";
  try (Table t=UTIL.createTable(TableName.valueOf(IMPORT_TABLE),FAMILYB,3)){
    args=new String[]{"-D" + Import.CF_RENAME_PROP + "="+ FAMILYA_STRING+ ":"+ FAMILYB_STRING,IMPORT_TABLE,FQ_OUTPUT_DIR};
    assertTrue(runImport(args));
    Get g=new Get(ROW1);
    g.setMaxVersions();
    Result r=t.get(g);
    assertEquals(3,r.size());
    g=new Get(ROW2);
    g.setMaxVersions();
    r=t.get(g);
    assertEquals(3,r.size());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTsv </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobConfigurationsWithTsvImporterTextMapper() throws Exception {
  Path bulkOutputPath=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  String INPUT_FILE="InputFile1.csv";
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterTextMapper","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=,","-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ bulkOutputPath.toString(),tn.getNameAsString(),INPUT_FILE};
  assertEquals("running test job configuration failed.",0,ToolRunner.run(new Configuration(util.getConfiguration()),new ImportTsv(){
    @Override public int run(    String[] args) throws Exception {
      Job job=createSubmittableJob(getConf(),args);
      assertTrue(job.getMapperClass().equals(TsvImporterTextMapper.class));
      assertTrue(job.getReducerClass().equals(TextSortReducer.class));
      assertTrue(job.getMapOutputValueClass().equals(Text.class));
      return 0;
    }
  }
,args));
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobConfigurationsWithDryMode() throws Exception {
  Path bulkOutputPath=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  String INPUT_FILE="InputFile1.csv";
  String[] argsArray=new String[]{"-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=,","-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ bulkOutputPath.toString(),"-D" + ImportTsv.DRY_RUN_CONF_KEY + "=true",tn.getNameAsString(),INPUT_FILE};
  assertEquals("running test job configuration failed.",0,ToolRunner.run(new Configuration(util.getConfiguration()),new ImportTsv(){
    @Override public int run(    String[] args) throws Exception {
      Job job=createSubmittableJob(getConf(),args);
      assertTrue(job.getOutputFormatClass().equals(NullOutputFormat.class));
      return 0;
    }
  }
,argsArray));
  util.deleteTable(tn);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTsvParser </h4><pre class="type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadTsvLineException.class) public void testTsvParserNoTimestampValue() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a,HBASE_TS_KEY","\t");
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  byte[] line=Bytes.toBytes("rowkey\tval_a");
  parser.parse(line,line.length);
}

</code></pre>

<br>
<pre class="type-7 type-5 type-17 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadTsvLineException.class) public void testTsvParserInvalidTimestamp() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,HBASE_TS_KEY,col_a,","\t");
  assertEquals(1,parser.getTimestampKeyColumnIndex());
  byte[] line=Bytes.toBytes("rowkey\ttimestamp\tval_a");
  ParsedLine parsed=parser.parse(line,line.length);
  assertEquals(-1,parsed.getTimestamp(-1));
  checkParsing(parsed,Splitter.on("\t").split(Bytes.toString(line)));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTsvParser() throws BadTsvLineException {
  TsvParser parser=new TsvParser("col_a,col_b:qual,HBASE_ROW_KEY,col_d","\t");
  assertBytesEquals(Bytes.toBytes("col_a"),parser.getFamily(0));
  assertBytesEquals(HConstants.EMPTY_BYTE_ARRAY,parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col_b"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("qual"),parser.getQualifier(1));
  assertNull(parser.getFamily(2));
  assertNull(parser.getQualifier(2));
  assertEquals(2,parser.getRowKeyColumnIndex());
  assertEquals(TsvParser.DEFAULT_TIMESTAMP_COLUMN_INDEX,parser.getTimestampKeyColumnIndex());
  byte[] line=Bytes.toBytes("val_a\tval_b\tval_c\tval_d");
  ParsedLine parsed=parser.parse(line,line.length);
  checkParsing(parsed,Splitter.on("\t").split(Bytes.toString(line)));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTsvParseAttributesKey() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a,HBASE_TS_KEY,HBASE_ATTRIBUTES_KEY","\t");
  assertEquals(0,parser.getRowKeyColumnIndex());
  byte[] line=Bytes.toBytes("rowkey\tval_a\t1234\tkey=>value");
  ParsedLine parse=parser.parse(line,line.length);
  assertEquals(18,parse.getAttributeKeyOffset());
  assertEquals(3,parser.getAttributesKeyColumnIndex());
  String attributes[]=parse.getIndividualAttributes();
  assertEquals(attributes[0],"key=>value");
  try {
    line=Bytes.toBytes("rowkey\tval_a\t1234");
    parser.parse(line,line.length);
    fail("Should get BadTsvLineException on empty rowkey.");
  }
 catch (  BadTsvLineException b) {
  }
  parser=new TsvParser("HBASE_ATTRIBUTES_KEY,col_a,HBASE_ROW_KEY,HBASE_TS_KEY","\t");
  assertEquals(2,parser.getRowKeyColumnIndex());
  line=Bytes.toBytes("key=>value\tval_a\trowkey\t1234");
  parse=parser.parse(line,line.length);
  assertEquals(0,parse.getAttributeKeyOffset());
  assertEquals(0,parser.getAttributesKeyColumnIndex());
  attributes=parse.getIndividualAttributes();
  assertEquals(attributes[0],"key=>value");
  try {
    line=Bytes.toBytes("val_a");
    ParsedLine parse2=parser.parse(line,line.length);
    fail("Should get BadTsvLineException when number of columns less than rowkey position.");
  }
 catch (  BadTsvLineException b) {
  }
  parser=new TsvParser("col_a,HBASE_ATTRIBUTES_KEY,HBASE_TS_KEY,HBASE_ROW_KEY","\t");
  assertEquals(3,parser.getRowKeyColumnIndex());
  line=Bytes.toBytes("val_a\tkey0=>value0,key1=>value1,key2=>value2\t1234\trowkey");
  parse=parser.parse(line,line.length);
  assertEquals(1,parser.getAttributesKeyColumnIndex());
  assertEquals(6,parse.getAttributeKeyOffset());
  String[] attr=parse.getIndividualAttributes();
  int i=0;
  for (  String str : attr) {
    assertEquals(("key" + i + "=>"+ "value"+ i),str);
    i++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTsvParserWithTimestamp() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,HBASE_TS_KEY,col_a,","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertNull(parser.getFamily(1));
  assertNull(parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col_a"),parser.getFamily(2));
  assertBytesEquals(HConstants.EMPTY_BYTE_ARRAY,parser.getQualifier(2));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertEquals(1,parser.getTimestampKeyColumnIndex());
  byte[] line=Bytes.toBytes("rowkey\t1234\tval_a");
  ParsedLine parsed=parser.parse(line,line.length);
  assertEquals(1234l,parsed.getTimestamp(-1));
  checkParsing(parsed,Splitter.on("\t").split(Bytes.toString(line)));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTsvParserSpecParsing(){
  TsvParser parser;
  parser=new TsvParser("HBASE_ROW_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,col1:scol2","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(2));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(2));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertFalse(parser.hasTimestamp());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  parser=new TsvParser("HBASE_ROW_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2,HBASE_ATTRIBUTES_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(0,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  assertEquals(4,parser.getAttributesKeyColumnIndex());
  parser=new TsvParser("HBASE_ATTRIBUTES_KEY,col1:scol1,HBASE_TS_KEY,col1:scol2,HBASE_ROW_KEY","\t");
  assertNull(parser.getFamily(0));
  assertNull(parser.getQualifier(0));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(1));
  assertBytesEquals(Bytes.toBytes("scol1"),parser.getQualifier(1));
  assertBytesEquals(Bytes.toBytes("col1"),parser.getFamily(3));
  assertBytesEquals(Bytes.toBytes("scol2"),parser.getQualifier(3));
  assertEquals(4,parser.getRowKeyColumnIndex());
  assertTrue(parser.hasTimestamp());
  assertEquals(2,parser.getTimestampKeyColumnIndex());
  assertEquals(0,parser.getAttributesKeyColumnIndex());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTsvParserParseRowKey() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a,HBASE_TS_KEY","\t");
  assertEquals(0,parser.getRowKeyColumnIndex());
  byte[] line=Bytes.toBytes("rowkey\tval_a\t1234");
  Pair<Integer,Integer> rowKeyOffsets=parser.parseRowKey(line,line.length);
  assertEquals(0,rowKeyOffsets.getFirst().intValue());
  assertEquals(6,rowKeyOffsets.getSecond().intValue());
  try {
    line=Bytes.toBytes("\t\tval_a\t1234");
    parser.parseRowKey(line,line.length);
    fail("Should get BadTsvLineException on empty rowkey.");
  }
 catch (  BadTsvLineException b) {
  }
  parser=new TsvParser("col_a,HBASE_ROW_KEY,HBASE_TS_KEY","\t");
  assertEquals(1,parser.getRowKeyColumnIndex());
  line=Bytes.toBytes("val_a\trowkey\t1234");
  rowKeyOffsets=parser.parseRowKey(line,line.length);
  assertEquals(6,rowKeyOffsets.getFirst().intValue());
  assertEquals(6,rowKeyOffsets.getSecond().intValue());
  try {
    line=Bytes.toBytes("val_a");
    rowKeyOffsets=parser.parseRowKey(line,line.length);
    fail("Should get BadTsvLineException when number of columns less than rowkey position.");
  }
 catch (  BadTsvLineException b) {
  }
  parser=new TsvParser("col_a,HBASE_TS_KEY,HBASE_ROW_KEY","\t");
  assertEquals(2,parser.getRowKeyColumnIndex());
  line=Bytes.toBytes("val_a\t1234\trowkey");
  rowKeyOffsets=parser.parseRowKey(line,line.length);
  assertEquals(11,rowKeyOffsets.getFirst().intValue());
  assertEquals(6,rowKeyOffsets.getSecond().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testLoadTooMayHFiles() throws Exception {
  Path dir=util.getDataTestDirOnTestFS("testLoadTooMayHFiles");
  FileSystem fs=util.getTestFileSystem();
  dir=dir.makeQualified(fs);
  Path familyDir=new Path(dir,Bytes.toString(FAMILY));
  byte[] from=Bytes.toBytes("begin");
  byte[] to=Bytes.toBytes("end");
  for (int i=0; i <= MAX_FILES_PER_REGION_PER_FAMILY; i++) {
    HFileTestUtil.createHFile(util.getConfiguration(),fs,new Path(familyDir,"hfile_" + i),FAMILY,QUALIFIER,from,to,1000);
  }
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(util.getConfiguration());
  String[] args={dir.toString(),"mytable_testLoadTooMayHFiles"};
  try {
    loader.run(args);
    fail("Bulk loading too many files should fail");
  }
 catch (  IOException ie) {
    assertTrue(ie.getMessage().contains("Trying to load more than " + MAX_FILES_PER_REGION_PER_FAMILY + " hfiles"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFilesSplitRecovery </h4><pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This simulates an remote exception which should cause LIHF to exit with an
 * exception.
 */
@Test(expected=IOException.class,timeout=120000) public void testGroupOrSplitFailure() throws Exception {
  TableName table=TableName.valueOf("groupOrSplitFailure");
  try (Connection connection=ConnectionFactory.createConnection(util.getConfiguration())){
    setupTable(connection,table,10);
    LoadIncrementalHFiles lih=new LoadIncrementalHFiles(util.getConfiguration()){
      int i=0;
      @Override protected List<LoadQueueItem> groupOrSplit(      Multimap<ByteBuffer,LoadQueueItem> regionGroups,      final LoadQueueItem item,      final Table table,      final Pair<byte[][],byte[][]> startEndKeys) throws IOException {
        i++;
        if (i == 5) {
          throw new IOException("failure");
        }
        return super.groupOrSplit(regionGroups,item,table,startEndKeys);
      }
    }
;
    Path dir=buildBulkFiles(table,1);
    try (Table t=connection.getTable(table);RegionLocator locator=connection.getRegionLocator(table);Admin admin=connection.getAdmin()){
      lih.doBulkLoad(dir,admin,t,locator);
    }
   }
   fail("doBulkLoad should have thrown an exception");
}

</code></pre>

<br>
<pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that shows that exception thrown from the RS side will result in an
 * exception on the LIHFile client.
 */
@Test(expected=IOException.class,timeout=120000) public void testBulkLoadPhaseFailure() throws Exception {
  TableName table=TableName.valueOf("bulkLoadPhaseFailure");
  final AtomicInteger attmptedCalls=new AtomicInteger();
  final AtomicInteger failedCalls=new AtomicInteger();
  util.getConfiguration().setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,2);
  try (Connection connection=ConnectionFactory.createConnection(this.util.getConfiguration())){
    setupTable(connection,table,10);
    LoadIncrementalHFiles lih=new LoadIncrementalHFiles(util.getConfiguration()){
      @Override protected List<LoadQueueItem> tryAtomicRegionLoad(      final Connection conn,      TableName tableName,      final byte[] first,      Collection<LoadQueueItem> lqis) throws IOException {
        int i=attmptedCalls.incrementAndGet();
        if (i == 1) {
          Connection errConn=null;
          try {
            errConn=getMockedConnection(util.getConfiguration());
          }
 catch (          Exception e) {
            LOG.fatal("mocking cruft, should never happen",e);
            throw new RuntimeException("mocking cruft, should never happen");
          }
          failedCalls.incrementAndGet();
          return super.tryAtomicRegionLoad((HConnection)errConn,tableName,first,lqis);
        }
        return super.tryAtomicRegionLoad((HConnection)conn,tableName,first,lqis);
      }
    }
;
    try {
      Path dir=buildBulkFiles(table,1);
      try (Table t=connection.getTable(table);RegionLocator locator=connection.getRegionLocator(table);Admin admin=connection.getAdmin()){
        lih.doBulkLoad(dir,admin,t,locator);
      }
     }
  finally {
      util.getConfiguration().setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,HConstants.DEFAULT_HBASE_CLIENT_RETRIES_NUMBER);
    }
    fail("doBulkLoad should have thrown an exception");
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestMapReduceExamples </h4><pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method of SampleUploader.
 */
@Test public void testMainSampleUploader() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    try {
      SampleUploader.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("Wrong number of arguments:"));
      assertTrue(data.toString().contains("Usage: SampleUploader <input> <tablename>"));
    }
  }
  finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method of IndexBuilder
 */
@Test public void testMainIndexBuilder() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    try {
      IndexBuilder.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("arguments supplied, required: 3"));
      assertTrue(data.toString().contains("Usage: IndexBuilder <TABLE_NAME> <COLUMN_FAMILY> <ATTR> [<ATTR> ...]"));
    }
  }
  finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestRowCounter </h4><pre class="type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test main method. Import should print help and call System.exit
 */
@Test public void testImportMain() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    try {
      RowCounter.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("Wrong number of parameters:"));
      assertTrue(data.toString().contains("Usage: RowCounter [options] <tablename> " + "[--starttime=[start] --endtime=[end] " + "[--range=[startKey],[endKey]] "+ "[<column1> <column2>...]"));
      assertTrue(data.toString().contains("-Dhbase.client.scanner.caching=100"));
      assertTrue(data.toString().contains("-Dmapreduce.map.speculative=false"));
    }
    data.reset();
    try {
      args=new String[2];
      args[0]="table";
      args[1]="--range=1";
      RowCounter.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("Please specify range in such format as \"--range=a,b\" or, with only one boundary," + " \"--range=,b\" or \"--range=a,\""));
      assertTrue(data.toString().contains("Usage: RowCounter [options] <tablename> " + "[--starttime=[start] --endtime=[end] " + "[--range=[startKey],[endKey]] "+ "[<column1> <column2>...]"));
    }
  }
  finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableMapReduceUtil </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitTableMapperJob2() throws Exception {
  Configuration configuration=new Configuration();
  Job job=new Job(configuration,"tableName");
  TableMapReduceUtil.initTableMapperJob(Bytes.toBytes("Table"),new Scan(),Import.Importer.class,Text.class,Text.class,job,false,WALInputFormat.class);
  assertEquals(WALInputFormat.class,job.getInputFormatClass());
  assertEquals(Import.Importer.class,job.getMapperClass());
  assertEquals(LongWritable.class,job.getOutputKeyClass());
  assertEquals(Text.class,job.getOutputValueClass());
  assertNull(job.getCombinerClass());
  assertEquals("Table",job.getConfiguration().get(TableInputFormat.INPUT_TABLE));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitTableMapperJob4() throws Exception {
  Configuration configuration=new Configuration();
  Job job=new Job(configuration,"tableName");
  TableMapReduceUtil.initTableMapperJob(Bytes.toBytes("Table"),new Scan(),Import.Importer.class,Text.class,Text.class,job,false);
  assertEquals(TableInputFormat.class,job.getInputFormatClass());
  assertEquals(Import.Importer.class,job.getMapperClass());
  assertEquals(LongWritable.class,job.getOutputKeyClass());
  assertEquals(Text.class,job.getOutputValueClass());
  assertNull(job.getCombinerClass());
  assertEquals("Table",job.getConfiguration().get(TableInputFormat.INPUT_TABLE));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitTableMapperJob3() throws Exception {
  Configuration configuration=new Configuration();
  Job job=new Job(configuration,"tableName");
  TableMapReduceUtil.initTableMapperJob(Bytes.toBytes("Table"),new Scan(),Import.Importer.class,Text.class,Text.class,job);
  assertEquals(TableInputFormat.class,job.getInputFormatClass());
  assertEquals(Import.Importer.class,job.getMapperClass());
  assertEquals(LongWritable.class,job.getOutputKeyClass());
  assertEquals(Text.class,job.getOutputValueClass());
  assertNull(job.getCombinerClass());
  assertEquals("Table",job.getConfiguration().get(TableInputFormat.INPUT_TABLE));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitTableMapperJob1() throws Exception {
  Configuration configuration=new Configuration();
  Job job=new Job(configuration,"tableName");
  TableMapReduceUtil.initTableMapperJob("Table",new Scan(),Import.Importer.class,Text.class,Text.class,job,false,WALInputFormat.class);
  assertEquals(WALInputFormat.class,job.getInputFormatClass());
  assertEquals(Import.Importer.class,job.getMapperClass());
  assertEquals(LongWritable.class,job.getOutputKeyClass());
  assertEquals(Text.class,job.getOutputValueClass());
  assertNull(job.getCombinerClass());
  assertEquals("Table",job.getConfiguration().get(TableInputFormat.INPUT_TABLE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableSplit </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * length of region should not influence hashcode
 */
@Test public void testHashCode_length(){
  TableSplit split1=new TableSplit(TableName.valueOf("table"),"row-start".getBytes(),"row-end".getBytes(),"location",1984);
  TableSplit split2=new TableSplit(TableName.valueOf("table"),"row-start".getBytes(),"row-end".getBytes(),"location",1982);
  assertEquals(split1,split2);
  assertTrue(split1.hashCode() == split2.hashCode());
  HashSet<TableSplit> set=new HashSet<TableSplit>(2);
  set.add(split1);
  set.add(split2);
  assertTrue(set.size() == 1);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashCode(){
  TableSplit split1=new TableSplit(TableName.valueOf("table"),"row-start".getBytes(),"row-end".getBytes(),"location");
  TableSplit split2=new TableSplit(TableName.valueOf("table"),"row-start".getBytes(),"row-end".getBytes(),"location");
  assertEquals(split1,split2);
  assertTrue(split1.hashCode() == split2.hashCode());
  HashSet<TableSplit> set=new HashSet<TableSplit>(2);
  set.add(split1);
  set.add(split2);
  assertTrue(set.size() == 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestWALPlayer </h4><pre class="type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method
 */
@Test public void testMainMethod() throws Exception {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    try {
      WALPlayer.main(args);
      fail("should be SecurityException");
    }
 catch (    SecurityException e) {
      assertEquals(-1,newSecurityManager.getExitCode());
      assertTrue(data.toString().contains("ERROR: Wrong number of arguments:"));
      assertTrue(data.toString().contains("Usage: WALPlayer [options] <wal inputdir>" + " <tables> [<tableMappings>]"));
      assertTrue(data.toString().contains("-Dwal.bulk.output=/path/for/output"));
    }
  }
  finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple end-to-end test
 * @throws Exception
 */
@Test public void testWALPlayer() throws Exception {
  final TableName TABLENAME1=TableName.valueOf("testWALPlayer1");
  final TableName TABLENAME2=TableName.valueOf("testWALPlayer2");
  final byte[] FAMILY=Bytes.toBytes("family");
  final byte[] COLUMN1=Bytes.toBytes("c1");
  final byte[] COLUMN2=Bytes.toBytes("c2");
  final byte[] ROW=Bytes.toBytes("row");
  Table t1=TEST_UTIL.createTable(TABLENAME1,FAMILY);
  Table t2=TEST_UTIL.createTable(TABLENAME2,FAMILY);
  Put p=new Put(ROW);
  p.addColumn(FAMILY,COLUMN1,COLUMN1);
  p.addColumn(FAMILY,COLUMN2,COLUMN2);
  t1.put(p);
  Delete d=new Delete(ROW);
  d.addColumns(FAMILY,COLUMN1);
  t1.delete(d);
  WAL log=cluster.getRegionServer(0).getWAL(null);
  log.rollWriter();
  String walInputDir=new Path(cluster.getMaster().getMasterFileSystem().getRootDir(),HConstants.HREGION_LOGDIR_NAME).toString();
  Configuration configuration=TEST_UTIL.getConfiguration();
  WALPlayer player=new WALPlayer(configuration);
  String optionName="_test_.name";
  configuration.set(optionName,"1000");
  player.setupTime(configuration,optionName);
  assertEquals(1000,configuration.getLong(optionName,0));
  assertEquals(0,ToolRunner.run(configuration,player,new String[]{walInputDir,TABLENAME1.getNameAsString(),TABLENAME2.getNameAsString()}));
  Get g=new Get(ROW);
  Result r=t2.get(g);
  assertEquals(1,r.size());
  assertTrue(CellUtil.matchingQualifier(r.rawCells()[0],COLUMN2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestAssignmentManagerOnCluster </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disabled region is ignored by SSH
 */
@Test(timeout=60000) public void testAssignDisabledRegionBySSH() throws Exception {
  TableName table=TableName.valueOf("testAssignDisabledRegionBySSH");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  MyMaster master;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    master=(MyMaster)cluster.getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName metaServer=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    ServerName oldServerName=null;
    while (true) {
      assertTrue(am.waitForAssignment(hri));
      RegionState state=regionStates.getRegionState(hri);
      oldServerName=state.getServerName();
      if (!ServerName.isSameHostnameAndPort(oldServerName,metaServer)) {
        MyRegionServer.abortedServer=oldServerName;
        break;
      }
      int i=cluster.getServerWithMeta();
      HRegionServer rs=cluster.getRegionServer(i == 0 ? 1 : 0);
      oldServerName=rs.getServerName();
      master.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(oldServerName.getServerName()));
    }
    assertTrue(regionStates.isRegionOnline(hri));
    assertEquals(oldServerName,regionStates.getRegionServerOfRegion(hri));
    master.disableTable(hri.getTable(),HConstants.NO_NONCE,HConstants.NO_NONCE);
    cluster.killRegionServer(oldServerName);
    cluster.waitForRegionServerToStop(oldServerName,-1);
    ServerManager serverManager=master.getServerManager();
    while (!serverManager.isServerDead(oldServerName) || serverManager.getDeadServers().areDeadServersInProgress()) {
      Thread.sleep(100);
    }
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    assertTrue(regionStates.isRegionOffline(hri));
  }
  finally {
    MyRegionServer.abortedServer=null;
    TEST_UTIL.deleteTable(table);
    cluster.startRegionServer();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests region open failed
 */
@Test(timeout=60000) public void testOpenFailed() throws Exception {
  TableName table=TableName.valueOf("testOpenFailed");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    MyLoadBalancer.controledRegion=hri.getEncodedName();
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    assertFalse(am.waitForAssignment(hri));
    RegionState state=am.getRegionStates().getRegionState(hri);
    assertEquals(RegionState.State.FAILED_OPEN,state.getState());
    assertNull(state.getServerName());
    MyLoadBalancer.controledRegion=null;
    master.assignRegion(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
  }
  finally {
    MyLoadBalancer.controledRegion=null;
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests offlining a region
 */
@Test(timeout=60000) public void testOfflineRegion() throws Exception {
  TableName table=TableName.valueOf("testOfflineRegion");
  try {
    HRegionInfo hri=createTableAndGetOneRegion(table);
    RegionStates regionStates=TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates();
    ServerName serverName=regionStates.getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
    admin.offline(hri.getRegionName());
    long timeoutTime=System.currentTimeMillis() + 800;
    while (true) {
      if (regionStates.getRegionByStateOfTable(table).get(RegionState.State.OFFLINE).contains(hri))       break;
      long now=System.currentTimeMillis();
      if (now > timeoutTime) {
        fail("Failed to offline the region in time");
        break;
      }
      Thread.sleep(10);
    }
    RegionState regionState=regionStates.getRegionState(hri);
    assertTrue(regionState.isOffline());
  }
  finally {
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests restarting meta regionserver
 */
@Test(timeout=180000) public void testRestartMetaRegionServer() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  boolean stoppedARegionServer=false;
  try {
    HMaster master=cluster.getMaster();
    RegionStates regionStates=master.getAssignmentManager().getRegionStates();
    ServerName metaServerName=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    if (master.getServerName().equals(metaServerName)) {
      metaServerName=cluster.getLiveRegionServerThreads().get(0).getRegionServer().getServerName();
      master.move(HRegionInfo.FIRST_META_REGIONINFO.getEncodedNameAsBytes(),Bytes.toBytes(metaServerName.getServerName()));
      TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    }
    RegionState metaState=MetaTableLocator.getMetaRegionState(master.getZooKeeper());
    assertEquals("Meta should be not in transition",metaState.getState(),RegionState.State.OPEN);
    assertNotEquals("Meta should be moved off master",metaState.getServerName(),master.getServerName());
    assertEquals("Meta should be on the meta server",metaState.getServerName(),metaServerName);
    cluster.killRegionServer(metaServerName);
    stoppedARegionServer=true;
    cluster.waitForRegionServerToStop(metaServerName,60000);
    final ServerName oldServerName=metaServerName;
    final ServerManager serverManager=master.getServerManager();
    TEST_UTIL.waitFor(120000,200,new Waiter.Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return serverManager.isServerDead(oldServerName) && !serverManager.areDeadServersInProgress();
      }
    }
);
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    assertTrue("Meta should be assigned",regionStates.isRegionOnline(HRegionInfo.FIRST_META_REGIONINFO));
    metaState=MetaTableLocator.getMetaRegionState(master.getZooKeeper());
    assertEquals("Meta should be not in transition",metaState.getState(),RegionState.State.OPEN);
    assertEquals("Meta should be assigned",metaState.getServerName(),regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO));
    assertNotEquals("Meta should be assigned on a different server",metaState.getServerName(),metaServerName);
  }
  finally {
    if (stoppedARegionServer) {
      cluster.startRegionServer();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests moving a region
 */
@Test(timeout=50000) public void testMoveRegion() throws Exception {
  TableName table=TableName.valueOf("testMoveRegion");
  try {
    HRegionInfo hri=createTableAndGetOneRegion(table);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    RegionStates regionStates=master.getAssignmentManager().getRegionStates();
    ServerName serverName=regionStates.getRegionServerOfRegion(hri);
    ServerManager serverManager=master.getServerManager();
    ServerName destServerName=null;
    List<JVMClusterUtil.RegionServerThread> regionServers=TEST_UTIL.getHBaseCluster().getLiveRegionServerThreads();
    for (    JVMClusterUtil.RegionServerThread regionServer : regionServers) {
      HRegionServer destServer=regionServer.getRegionServer();
      destServerName=destServer.getServerName();
      if (!destServerName.equals(serverName) && serverManager.isServerOnline(destServerName)) {
        break;
      }
    }
    assertTrue(destServerName != null && !destServerName.equals(serverName));
    TEST_UTIL.getHBaseAdmin().move(hri.getEncodedNameAsBytes(),Bytes.toBytes(destServerName.getServerName()));
    long timeoutTime=System.currentTimeMillis() + 30000;
    while (true) {
      ServerName sn=regionStates.getRegionServerOfRegion(hri);
      if (sn != null && sn.equals(destServerName)) {
        TEST_UTIL.assertRegionOnServer(hri,sn,200);
        break;
      }
      long now=System.currentTimeMillis();
      if (now > timeoutTime) {
        fail("Failed to move the region in time: " + regionStates.getRegionState(hri));
      }
      regionStates.waitForUpdate(50);
    }
  }
  finally {
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests region open failure which is not recoverable
 */
@Test(timeout=60000) public void testOpenFailedUnrecoverable() throws Exception {
  TableName table=TableName.valueOf("testOpenFailedUnrecoverable");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    FileSystem fs=FileSystem.get(conf);
    Path tableDir=FSUtils.getTableDir(FSUtils.getRootDir(conf),table);
    Path regionDir=new Path(tableDir,hri.getEncodedName());
    fs.create(regionDir,true);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    assertFalse(am.waitForAssignment(hri));
    RegionState state=am.getRegionStates().getRegionState(hri);
    assertEquals(RegionState.State.FAILED_OPEN,state.getState());
    assertNotNull(state.getServerName());
    fs.delete(regionDir,true);
    master.assignRegion(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
  }
  finally {
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests region close failed
 */
@Test(timeout=60000) public void testCloseFailed() throws Exception {
  TableName table=TableName.valueOf("testCloseFailed");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    assertTrue(am.waitForAssignment(hri));
    ServerName sn=am.getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,sn,6000);
    MyRegionObserver.preCloseEnabled.set(true);
    am.unassign(hri);
    RegionState state=am.getRegionStates().getRegionState(hri);
    assertEquals(RegionState.State.FAILED_CLOSE,state.getState());
    MyRegionObserver.preCloseEnabled.set(false);
    am.unassign(hri);
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,serverName,200);
  }
  finally {
    MyRegionObserver.preCloseEnabled.set(false);
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test SSH waiting for extra region server for assignment
 */
@Test(timeout=300000) public void testSSHWaitForServerToAssignRegion() throws Exception {
  TableName table=TableName.valueOf("testSSHWaitForServerToAssignRegion");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  boolean startAServer=false;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    HMaster master=cluster.getMaster();
    final ServerManager serverManager=master.getServerManager();
    MyLoadBalancer.countRegionServers=Integer.valueOf(serverManager.countOfRegionServers());
    HRegionServer rs=TEST_UTIL.getRSForFirstRegionInTable(table);
    assertNotNull("First region should be assigned",rs);
    final ServerName serverName=rs.getServerName();
    int counter=MyLoadBalancer.counter.get() + 5;
    cluster.killRegionServer(serverName);
    startAServer=true;
    cluster.waitForRegionServerToStop(serverName,-1);
    while (counter > MyLoadBalancer.counter.get()) {
      Thread.sleep(1000);
    }
    cluster.startRegionServer();
    startAServer=false;
    TEST_UTIL.waitFor(120000,1000,new Waiter.Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return serverManager.isServerDead(serverName) && !serverManager.areDeadServersInProgress();
      }
    }
);
    TEST_UTIL.waitUntilNoRegionsInTransition(300000);
    rs=TEST_UTIL.getRSForFirstRegionInTable(table);
    assertTrue("First region should be re-assigned to a different server",rs != null && !serverName.equals(rs.getServerName()));
  }
  finally {
    MyLoadBalancer.countRegionServers=null;
    TEST_UTIL.deleteTable(table);
    if (startAServer) {
      cluster.startRegionServer();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests assign a region while it's closing.
 */
@Test(timeout=60000) public void testAssignWhileClosing() throws Exception {
  TableName table=TableName.valueOf("testAssignWhileClosing");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    assertTrue(am.waitForAssignment(hri));
    ServerName sn=am.getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnServer(hri,sn,6000);
    MyRegionObserver.preCloseEnabled.set(true);
    am.unassign(hri);
    RegionState state=am.getRegionStates().getRegionState(hri);
    assertEquals(RegionState.State.FAILED_CLOSE,state.getState());
    MyRegionObserver.preCloseEnabled.set(false);
    am.unassign(hri);
    am.assign(hri,true);
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,200);
  }
  finally {
    MyRegionObserver.preCloseEnabled.set(false);
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * If a table is deleted, we should not be able to move it anymore.
 * Otherwise, the region will be brought back.
 * @throws Exception
 */
@Test(timeout=50000) public void testMoveRegionOfDeletedTable() throws Exception {
  TableName table=TableName.valueOf("testMoveRegionOfDeletedTable");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  try {
    HRegionInfo hri=createTableAndGetOneRegion(table);
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName serverName=regionStates.getRegionServerOfRegion(hri);
    ServerName destServerName=null;
    for (int i=0; i < 3; i++) {
      HRegionServer destServer=TEST_UTIL.getHBaseCluster().getRegionServer(i);
      if (!destServer.getServerName().equals(serverName)) {
        destServerName=destServer.getServerName();
        break;
      }
    }
    assertTrue(destServerName != null && !destServerName.equals(serverName));
    TEST_UTIL.deleteTable(table);
    try {
      admin.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(destServerName.getServerName()));
      fail("We should not find the region");
    }
 catch (    IOException ioe) {
      assertTrue(ioe instanceof UnknownRegionException);
    }
    am.balance(new RegionPlan(hri,serverName,destServerName));
    assertFalse("The region should not be in transition",regionStates.isRegionInTransition(hri));
  }
  finally {
    if (admin.tableExists(table)) {
      TEST_UTIL.deleteTable(table);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests region close racing with open
 */
@Test(timeout=60000) public void testOpenCloseRacing() throws Exception {
  TableName table=TableName.valueOf("testOpenCloseRacing");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    meta.close();
    MyRegionObserver.postOpenEnabled.set(true);
    MyRegionObserver.postOpenCalled=false;
    HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
    master.assignRegion(hri);
    long end=EnvironmentEdgeManager.currentTime() + 20000;
    while (!MyRegionObserver.postOpenCalled) {
      assertFalse("Timed out waiting for postOpen to be called",EnvironmentEdgeManager.currentTime() > end);
      Thread.sleep(300);
    }
    AssignmentManager am=master.getAssignmentManager();
    am.unassign(hri);
    RegionState state=am.getRegionStates().getRegionState(hri);
    ServerName oldServerName=state.getServerName();
    assertTrue(state.isOpening() && oldServerName != null);
    MyRegionObserver.postOpenEnabled.set(false);
    ServerName destServerName=null;
    int numRS=TEST_UTIL.getHBaseCluster().getLiveRegionServerThreads().size();
    for (int i=0; i < numRS; i++) {
      HRegionServer destServer=TEST_UTIL.getHBaseCluster().getRegionServer(i);
      if (!destServer.getServerName().equals(oldServerName)) {
        destServerName=destServer.getServerName();
        break;
      }
    }
    assertNotNull(destServerName);
    assertFalse("Region should be assigned on a new region server",oldServerName.equals(destServerName));
    List<HRegionInfo> regions=new ArrayList<HRegionInfo>();
    regions.add(hri);
    am.assign(destServerName,regions);
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,6000);
  }
  finally {
    MyRegionObserver.postOpenEnabled.set(false);
    TEST_UTIL.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test offlined region is assigned by SSH
 */
@Test(timeout=60000) public void testAssignOfflinedRegionBySSH() throws Exception {
  TableName table=TableName.valueOf("testAssignOfflinedRegionBySSH");
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  MyMaster master=null;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.addFamily(new HColumnDescriptor(FAMILY));
    admin.createTable(desc);
    Table meta=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
    HRegionInfo hri=new HRegionInfo(desc.getTableName(),Bytes.toBytes("A"),Bytes.toBytes("Z"));
    MetaTableAccessor.addRegionToMeta(meta,hri);
    master=(MyMaster)cluster.getMaster();
    master.assignRegion(hri);
    AssignmentManager am=master.getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    ServerName metaServer=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
    ServerName oldServerName=null;
    while (true) {
      assertTrue(am.waitForAssignment(hri));
      RegionState state=regionStates.getRegionState(hri);
      oldServerName=state.getServerName();
      if (!ServerName.isSameHostnameAndPort(oldServerName,metaServer)) {
        MyRegionServer.abortedServer=oldServerName;
        break;
      }
      int i=cluster.getServerWithMeta();
      HRegionServer rs=cluster.getRegionServer(i == 0 ? 1 : 0);
      oldServerName=rs.getServerName();
      master.move(hri.getEncodedNameAsBytes(),Bytes.toBytes(oldServerName.getServerName()));
    }
    assertTrue(regionStates.isRegionOnline(hri));
    assertEquals(oldServerName,regionStates.getRegionServerOfRegion(hri));
    cluster.killRegionServer(oldServerName);
    cluster.waitForRegionServerToStop(oldServerName,-1);
    ServerManager serverManager=master.getServerManager();
    while (!serverManager.isServerDead(oldServerName) || serverManager.getDeadServers().areDeadServersInProgress()) {
      Thread.sleep(100);
    }
    am.waitOnRegionToClearRegionsInTransition(hri);
    assertTrue(am.waitForAssignment(hri));
    ServerName serverName=master.getAssignmentManager().getRegionStates().getRegionServerOfRegion(hri);
    TEST_UTIL.assertRegionOnlyOnServer(hri,serverName,200);
  }
  finally {
    MyRegionServer.abortedServer=null;
    TEST_UTIL.deleteTable(table);
    cluster.startRegionServer();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestCatalogJanitor </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * CatalogJanitor.scan() should not clean parent regions if their own
 * parents are still referencing them. This ensures that grandfather regions
 * do not point to deleted parent regions.
 */
@Test public void testScanDoesNotCleanRegionsWithExistingParents() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  setRootDirAndCleanIt(htu,"testScanDoesNotCleanRegionsWithExistingParents");
  Server server=new MockServer(htu);
  MasterServices services=new MockMasterServices(server);
  final HTableDescriptor htd=createHTableDescriptor();
  HRegionInfo parent=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),new byte[0],true);
  Thread.sleep(1001);
  HRegionInfo splita=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),Bytes.toBytes("ccc"),true);
  Thread.sleep(1001);
  HRegionInfo splitaa=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),Bytes.toBytes("bbb"),false);
  HRegionInfo splitab=new HRegionInfo(htd.getTableName(),Bytes.toBytes("bbb"),Bytes.toBytes("ccc"),false);
  HRegionInfo splitb=new HRegionInfo(htd.getTableName(),Bytes.toBytes("ccc"),new byte[0]);
  Thread.sleep(1001);
  final Map<HRegionInfo,Result> splitParents=new TreeMap<HRegionInfo,Result>(new SplitParentFirstComparator());
  splitParents.put(parent,createResult(parent,splita,splitb));
  splita.setOffline(true);
  splitParents.put(splita,createResult(splita,splitaa,splitab));
  final Map<HRegionInfo,Result> mergedRegions=new TreeMap<HRegionInfo,Result>();
  CatalogJanitor janitor=spy(new CatalogJanitor(server,services));
  doReturn(new Triple<Integer,Map<HRegionInfo,Result>,Map<HRegionInfo,Result>>(10,mergedRegions,splitParents)).when(janitor).getMergedRegionsAndSplitParents();
  Path splitaRef=createReferences(services,htd,parent,splita,Bytes.toBytes("ccc"),false);
  assertEquals(0,janitor.scan());
  FileSystem fs=FileSystem.get(htu.getConfiguration());
  assertTrue(fs.delete(splitaRef,true));
  assertEquals(2,janitor.scan());
  services.stop("test finished");
  janitor.cancel(true);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArchiveOldRegion() throws Exception {
  String table="table";
  HBaseTestingUtility htu=new HBaseTestingUtility();
  setRootDirAndCleanIt(htu,"testCleanParent");
  Server server=new MockServer(htu);
  MasterServices services=new MockMasterServices(server);
  CatalogJanitor janitor=new CatalogJanitor(server,services);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(table));
  htd.addFamily(new HColumnDescriptor("f"));
  HRegionInfo parent=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),Bytes.toBytes("eee"));
  HRegionInfo splita=new HRegionInfo(htd.getTableName(),Bytes.toBytes("aaa"),Bytes.toBytes("ccc"));
  HRegionInfo splitb=new HRegionInfo(htd.getTableName(),Bytes.toBytes("ccc"),Bytes.toBytes("eee"));
  Result parentMetaRow=createResult(parent,splita,splitb);
  FileSystem fs=FileSystem.get(htu.getConfiguration());
  Path rootdir=services.getMasterFileSystem().getRootDir();
  FSUtils.setRootDir(fs.getConf(),rootdir);
  Path tabledir=FSUtils.getTableDir(rootdir,htd.getTableName());
  Path storedir=HStore.getStoreHomedir(tabledir,parent,htd.getColumnFamilies()[0].getName());
  Path storeArchive=HFileArchiveUtil.getStoreArchivePath(services.getConfiguration(),parent,tabledir,htd.getColumnFamilies()[0].getName());
  LOG.debug("Table dir:" + tabledir);
  LOG.debug("Store dir:" + storedir);
  LOG.debug("Store archive dir:" + storeArchive);
  FileStatus[] mockFiles=addMockStoreFiles(2,services,storedir);
  FileStatus[] storeFiles=fs.listStatus(storedir);
  int index=0;
  for (  FileStatus file : storeFiles) {
    LOG.debug("Have store file:" + file.getPath());
    assertEquals("Got unexpected store file",mockFiles[index].getPath(),storeFiles[index].getPath());
    index++;
  }
  assertTrue(janitor.cleanParent(parent,parentMetaRow));
  LOG.debug("Finished cleanup of parent region");
  FileStatus[] archivedStoreFiles=fs.listStatus(storeArchive);
  logFiles("archived files",storeFiles);
  logFiles("archived files",archivedStoreFiles);
  assertArchiveEqualToOriginal(storeFiles,archivedStoreFiles,fs);
  FSUtils.delete(fs,rootdir,true);
  services.stop("Test finished");
  server.stop("Test finished");
  janitor.cancel(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestClusterStatusPublisher </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxSend(){
  ClusterStatusPublisher csp=new ClusterStatusPublisher(){
    @Override protected List<Pair<ServerName,Long>> getDeadServers(    long since){
      List<Pair<ServerName,Long>> res=new ArrayList<Pair<ServerName,Long>>();
switch ((int)EnvironmentEdgeManager.currentTime()) {
case 2:
        res.add(new Pair<ServerName,Long>(ServerName.valueOf("hn",10,10),1L));
      break;
case 1000:
    break;
}
return res;
}
}
;
mee.setValue(2);
for (int i=0; i < ClusterStatusPublisher.NB_SEND; i++) {
Assert.assertEquals("i=" + i,1,csp.generateDeadServersListToSend().size());
}
mee.setValue(1000);
Assert.assertTrue(csp.generateDeadServersListToSend().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestDeadServer </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsDead(){
  DeadServer ds=new DeadServer();
  ds.add(hostname123);
  ds.notifyServer(hostname123);
  assertTrue(ds.areDeadServersInProgress());
  ds.finish(hostname123);
  assertFalse(ds.areDeadServersInProgress());
  ds.add(hostname1234);
  ds.notifyServer(hostname1234);
  assertTrue(ds.areDeadServersInProgress());
  ds.finish(hostname1234);
  assertFalse(ds.areDeadServersInProgress());
  ds.add(hostname12345);
  ds.notifyServer(hostname12345);
  assertTrue(ds.areDeadServersInProgress());
  ds.finish(hostname12345);
  assertFalse(ds.areDeadServersInProgress());
  final ServerName deadServer=ServerName.valueOf("127.0.0.1",9090,112321L);
  assertFalse(ds.cleanPreviousInstance(deadServer));
  ds.add(deadServer);
  assertTrue(ds.isDeadServer(deadServer));
  Set<ServerName> deadServerNames=ds.copyServerNames();
  for (  ServerName eachDeadServer : deadServerNames) {
    Assert.assertNotNull(ds.getTimeOfDeath(eachDeadServer));
  }
  final ServerName deadServerHostComingAlive=ServerName.valueOf("127.0.0.1",9090,223341L);
  assertTrue(ds.cleanPreviousInstance(deadServerHostComingAlive));
  assertFalse(ds.isDeadServer(deadServer));
  assertFalse(ds.cleanPreviousInstance(deadServerHostComingAlive));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestGetLastFlushedSequenceId </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws IOException, InterruptedException {
  testUtil.getHBaseAdmin().createNamespace(NamespaceDescriptor.create(tableName.getNamespaceAsString()).build());
  Table table=testUtil.createTable(tableName,families);
  table.put(new Put(Bytes.toBytes("k")).addColumn(family,Bytes.toBytes("q"),Bytes.toBytes("v")));
  MiniHBaseCluster cluster=testUtil.getMiniHBaseCluster();
  List<JVMClusterUtil.RegionServerThread> rsts=cluster.getRegionServerThreads();
  Region region=null;
  for (int i=0; i < cluster.getRegionServerThreads().size(); i++) {
    HRegionServer hrs=rsts.get(i).getRegionServer();
    for (    Region r : hrs.getOnlineRegions(tableName)) {
      region=r;
      break;
    }
  }
  assertNotNull(region);
  Thread.sleep(2000);
  RegionStoreSequenceIds ids=testUtil.getHBaseCluster().getMaster().getLastSequenceId(region.getRegionInfo().getEncodedNameAsBytes());
  assertEquals(HConstants.NO_SEQNUM,ids.getLastFlushedSequenceId());
  long storeSequenceId=ids.getStoreSequenceId(0).getSequenceId();
  assertTrue(storeSequenceId > 0);
  testUtil.getHBaseAdmin().flush(tableName);
  Thread.sleep(2000);
  ids=testUtil.getHBaseCluster().getMaster().getLastSequenceId(region.getRegionInfo().getEncodedNameAsBytes());
  assertTrue(ids.getLastFlushedSequenceId() + " > " + storeSequenceId,ids.getLastFlushedSequenceId() > storeSequenceId);
  assertEquals(ids.getLastFlushedSequenceId(),ids.getStoreSequenceId(0).getSequenceId());
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMaster </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveRegionWhenNotInitialized(){
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HMaster m=cluster.getMaster();
  try {
    m.setInitialized(false);
    HRegionInfo meta=HRegionInfo.FIRST_META_REGIONINFO;
    m.move(meta.getEncodedNameAsBytes(),null);
    fail("Region should not be moved since master is not initialized");
  }
 catch (  IOException ioe) {
    assertTrue(ioe instanceof PleaseHoldException);
  }
 finally {
    m.setInitialized(true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void testMasterOpsWhileSplitting() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HMaster m=cluster.getMaster();
  try (Table ht=TEST_UTIL.createTable(TABLENAME,FAMILYNAME)){
    assertTrue(m.assignmentManager.getTableStateManager().isTableState(TABLENAME,TableState.State.ENABLED));
    TEST_UTIL.loadTable(ht,FAMILYNAME,false);
  }
   List<Pair<HRegionInfo,ServerName>> tableRegions=MetaTableAccessor.getTableRegionsAndLocations(m.getConnection(),TABLENAME);
  LOG.info("Regions after load: " + Joiner.on(',').join(tableRegions));
  assertEquals(1,tableRegions.size());
  assertArrayEquals(HConstants.EMPTY_START_ROW,tableRegions.get(0).getFirst().getStartKey());
  assertArrayEquals(HConstants.EMPTY_END_ROW,tableRegions.get(0).getFirst().getEndKey());
  LOG.info("Splitting table");
  TEST_UTIL.getHBaseAdmin().split(TABLENAME);
  LOG.info("Waiting for split result to be about to open");
  RegionStates regionStates=m.assignmentManager.getRegionStates();
  while (regionStates.getRegionsOfTable(TABLENAME).size() <= 1) {
    Thread.sleep(100);
  }
  LOG.info("Making sure we can call getTableRegions while opening");
  tableRegions=MetaTableAccessor.getTableRegionsAndLocations(m.getConnection(),TABLENAME,false);
  LOG.info("Regions: " + Joiner.on(',').join(tableRegions));
  assertEquals(3,tableRegions.size());
  LOG.info("Making sure we can call getTableRegionClosest while opening");
  Pair<HRegionInfo,ServerName> pair=m.getTableRegionForRow(TABLENAME,Bytes.toBytes("cde"));
  LOG.info("Result is: " + pair);
  Pair<HRegionInfo,ServerName> tableRegionFromName=MetaTableAccessor.getRegion(m.getConnection(),pair.getFirst().getRegionName());
  assertEquals(tableRegionFromName.getFirst(),pair.getFirst());
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveThrowsUnknownRegionException() throws IOException {
  TableName tableName=TableName.valueOf("testMoveThrowsUnknownRegionException");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  HColumnDescriptor hcd=new HColumnDescriptor("value");
  htd.addFamily(hcd);
  admin.createTable(htd,null);
  try {
    HRegionInfo hri=new HRegionInfo(tableName,Bytes.toBytes("A"),Bytes.toBytes("Z"));
    admin.move(hri.getEncodedNameAsBytes(),null);
    fail("Region should not be moved since it is fake");
  }
 catch (  IOException ioe) {
    assertTrue(ioe instanceof UnknownRegionException);
  }
 finally {
    TEST_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveThrowsPleaseHoldException() throws IOException {
  TableName tableName=TableName.valueOf("testMoveThrowsPleaseHoldException");
  HMaster master=TEST_UTIL.getMiniHBaseCluster().getMaster();
  HTableDescriptor htd=new HTableDescriptor(tableName);
  HColumnDescriptor hcd=new HColumnDescriptor("value");
  htd.addFamily(hcd);
  admin.createTable(htd,null);
  try {
    List<HRegionInfo> tableRegions=admin.getTableRegions(tableName);
    master.setInitialized(false);
    admin.move(tableRegions.get(0).getEncodedNameAsBytes(),null);
    fail("Region should not be moved since master is not initialized");
  }
 catch (  IOException ioe) {
    assertTrue(StringUtils.stringifyException(ioe).contains("PleaseHoldException"));
  }
 finally {
    master.setInitialized(true);
    TEST_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterFailover </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test of master failover.
 * <p>
 * Starts with three masters.  Kills a backup master.  Then kills the active
 * master.  Ensures the final master becomes active and we can still contact
 * the cluster.
 * @throws Exception
 */
@Test(timeout=240000) public void testSimpleMasterFailover() throws Exception {
  final int NUM_MASTERS=3;
  final int NUM_RS=3;
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  List<MasterThread> masterThreads=cluster.getMasterThreads();
  for (  MasterThread mt : masterThreads) {
    assertTrue(mt.isAlive());
  }
  int numActive=0;
  int activeIndex=-1;
  ServerName activeName=null;
  HMaster active=null;
  for (int i=0; i < masterThreads.size(); i++) {
    if (masterThreads.get(i).getMaster().isActiveMaster()) {
      numActive++;
      activeIndex=i;
      active=masterThreads.get(activeIndex).getMaster();
      activeName=active.getServerName();
    }
  }
  assertEquals(1,numActive);
  assertEquals(NUM_MASTERS,masterThreads.size());
  LOG.info("Active master " + activeName);
  assertNotNull(active);
  ClusterStatus status=active.getClusterStatus();
  assertTrue(status.getMaster().equals(activeName));
  assertEquals(2,status.getBackupMastersSize());
  assertEquals(2,status.getBackupMasters().size());
  int backupIndex=(activeIndex == 0 ? 1 : activeIndex - 1);
  HMaster master=cluster.getMaster(backupIndex);
  LOG.debug("\n\nStopping a backup master: " + master.getServerName() + "\n");
  cluster.stopMaster(backupIndex,false);
  cluster.waitOnMaster(backupIndex);
  for (int i=0; i < masterThreads.size(); i++) {
    if (masterThreads.get(i).getMaster().isActiveMaster()) {
      assertTrue(activeName.equals(masterThreads.get(i).getMaster().getServerName()));
      activeIndex=i;
      active=masterThreads.get(activeIndex).getMaster();
    }
  }
  assertEquals(1,numActive);
  assertEquals(2,masterThreads.size());
  int rsCount=masterThreads.get(activeIndex).getMaster().getClusterStatus().getServersSize();
  LOG.info("Active master " + active.getServerName() + " managing "+ rsCount+ " regions servers");
  assertEquals(4,rsCount);
  assertNotNull(active);
  status=active.getClusterStatus();
  assertTrue(status.getMaster().equals(activeName));
  assertEquals(1,status.getBackupMastersSize());
  assertEquals(1,status.getBackupMasters().size());
  LOG.debug("\n\nStopping the active master " + active.getServerName() + "\n");
  cluster.stopMaster(activeIndex,false);
  cluster.waitOnMaster(activeIndex);
  assertTrue(cluster.waitForActiveAndReadyMaster());
  LOG.debug("\n\nVerifying backup master is now active\n");
  assertEquals(1,masterThreads.size());
  active=masterThreads.get(0).getMaster();
  assertNotNull(active);
  status=active.getClusterStatus();
  ServerName mastername=status.getMaster();
  assertTrue(mastername.equals(active.getServerName()));
  assertTrue(active.isActiveMaster());
  assertEquals(0,status.getBackupMastersSize());
  assertEquals(0,status.getBackupMasters().size());
  int rss=status.getServersSize();
  LOG.info("Active master " + mastername.getServerName() + " managing "+ rss+ " region servers");
  assertEquals(4,rss);
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test region in pending_open/close when master failover
 */
@Test(timeout=180000) public void testPendingOpenOrCloseWhenMasterFailover() throws Exception {
  final int NUM_MASTERS=1;
  final int NUM_RS=1;
  Configuration conf=HBaseConfiguration.create();
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility(conf);
  TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  log("Cluster started");
  List<MasterThread> masterThreads=cluster.getMasterThreads();
  assertEquals(1,masterThreads.size());
  assertTrue(cluster.waitForActiveAndReadyMaster());
  HMaster master=masterThreads.get(0).getMaster();
  assertTrue(master.isActiveMaster());
  assertTrue(master.isInitialized());
  Table onlineTable=TEST_UTIL.createTable(TableName.valueOf("onlineTable"),"family");
  onlineTable.close();
  HTableDescriptor offlineTable=new HTableDescriptor(TableName.valueOf(Bytes.toBytes("offlineTable")));
  offlineTable.addFamily(new HColumnDescriptor(Bytes.toBytes("family")));
  FileSystem filesystem=FileSystem.get(conf);
  Path rootdir=FSUtils.getRootDir(conf);
  FSTableDescriptors fstd=new FSTableDescriptors(conf,filesystem,rootdir);
  fstd.createTableDescriptor(offlineTable);
  HRegionInfo hriOffline=new HRegionInfo(offlineTable.getTableName(),null,null);
  createRegion(hriOffline,rootdir,conf,offlineTable);
  MetaTableAccessor.addRegionToMeta(master.getConnection(),hriOffline);
  log("Regions in hbase:meta and namespace have been created");
  assertEquals(3,cluster.countServedRegions());
  HRegionInfo hriOnline=null;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(TableName.valueOf("onlineTable"))){
    hriOnline=locator.getRegionLocation(HConstants.EMPTY_START_ROW).getRegionInfo();
  }
   RegionStates regionStates=master.getAssignmentManager().getRegionStates();
  RegionStateStore stateStore=master.getAssignmentManager().getRegionStateStore();
  RegionState oldState=regionStates.getRegionState(hriOnline);
  RegionState newState=new RegionState(hriOnline,State.PENDING_CLOSE,oldState.getServerName());
  stateStore.updateRegionState(HConstants.NO_SEQNUM,newState,oldState);
  oldState=new RegionState(hriOffline,State.OFFLINE);
  newState=new RegionState(hriOffline,State.PENDING_OPEN,newState.getServerName());
  stateStore.updateRegionState(HConstants.NO_SEQNUM,newState,oldState);
  HRegionInfo failedClose=new HRegionInfo(offlineTable.getTableName(),null,null);
  createRegion(failedClose,rootdir,conf,offlineTable);
  MetaTableAccessor.addRegionToMeta(master.getConnection(),failedClose);
  oldState=new RegionState(failedClose,State.PENDING_CLOSE);
  newState=new RegionState(failedClose,State.FAILED_CLOSE,newState.getServerName());
  stateStore.updateRegionState(HConstants.NO_SEQNUM,newState,oldState);
  HRegionInfo failedOpen=new HRegionInfo(offlineTable.getTableName(),null,null);
  createRegion(failedOpen,rootdir,conf,offlineTable);
  MetaTableAccessor.addRegionToMeta(master.getConnection(),failedOpen);
  oldState=new RegionState(failedOpen,State.PENDING_OPEN);
  newState=new RegionState(failedOpen,State.FAILED_OPEN,newState.getServerName());
  stateStore.updateRegionState(HConstants.NO_SEQNUM,newState,oldState);
  HRegionInfo failedOpenNullServer=new HRegionInfo(offlineTable.getTableName(),null,null);
  LOG.info("Failed open NUll server " + failedOpenNullServer.getEncodedName());
  createRegion(failedOpenNullServer,rootdir,conf,offlineTable);
  MetaTableAccessor.addRegionToMeta(master.getConnection(),failedOpenNullServer);
  oldState=new RegionState(failedOpenNullServer,State.OFFLINE);
  newState=new RegionState(failedOpenNullServer,State.FAILED_OPEN,null);
  stateStore.updateRegionState(HConstants.NO_SEQNUM,newState,oldState);
  log("Aborting master");
  cluster.abortMaster(0);
  cluster.waitOnMaster(0);
  log("Master has aborted");
  log("Starting up a new master");
  master=cluster.startMaster().getMaster();
  log("Waiting for master to be ready");
  cluster.waitForActiveAndReadyMaster();
  log("Master is ready");
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  regionStates=master.getAssignmentManager().getRegionStates();
  assertTrue(regionStates.isRegionOnline(hriOffline));
  assertTrue(regionStates.isRegionOnline(hriOnline));
  assertTrue(regionStates.isRegionOnline(failedClose));
  assertTrue(regionStates.isRegionOnline(failedOpenNullServer));
  assertTrue(regionStates.isRegionOnline(failedOpen));
  log("Done with verification, shutting down cluster");
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterRestartAfterDisablingTable </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForCheckingIfEnableAndDisableWorksFineAfterSwitch() throws Exception {
  final int NUM_MASTERS=2;
  final int NUM_RS=1;
  final int NUM_REGIONS_TO_CREATE=4;
  log("Starting cluster");
  Configuration conf=HBaseConfiguration.create();
  HBaseTestingUtility TEST_UTIL=new HBaseTestingUtility(conf);
  TEST_UTIL.startMiniCluster(NUM_MASTERS,NUM_RS);
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  log("Waiting for active/ready master");
  cluster.waitForActiveAndReadyMaster();
  TableName table=TableName.valueOf("tableRestart");
  byte[] family=Bytes.toBytes("family");
  log("Creating table with " + NUM_REGIONS_TO_CREATE + " regions");
  Table ht=TEST_UTIL.createMultiRegionTable(table,family,NUM_REGIONS_TO_CREATE);
  int numRegions=-1;
  try (RegionLocator r=TEST_UTIL.getConnection().getRegionLocator(table)){
    numRegions=r.getStartKeys().length;
  }
   numRegions+=1;
  log("Waiting for no more RIT\n");
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  log("Disabling table\n");
  TEST_UTIL.getHBaseAdmin().disableTable(table);
  NavigableSet<String> regions=HBaseTestingUtility.getAllOnlineRegions(cluster);
  assertEquals("The number of regions for the table tableRestart should be 0 and only" + "the catalog and namespace tables should be present.",2,regions.size());
  List<MasterThread> masterThreads=cluster.getMasterThreads();
  MasterThread activeMaster=null;
  if (masterThreads.get(0).getMaster().isActiveMaster()) {
    activeMaster=masterThreads.get(0);
  }
 else {
    activeMaster=masterThreads.get(1);
  }
  activeMaster.getMaster().stop("stopping the active master so that the backup can become active");
  cluster.hbaseCluster.waitOnMaster(activeMaster);
  cluster.waitForActiveAndReadyMaster();
  assertTrue("The table should not be in enabled state",cluster.getMaster().getAssignmentManager().getTableStateManager().isTableState(TableName.valueOf("tableRestart"),TableState.State.DISABLED,TableState.State.DISABLING));
  log("Enabling table\n");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  admin.enableTable(table);
  admin.close();
  log("Waiting for no more RIT\n");
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  log("Verifying there are " + numRegions + " assigned on cluster\n");
  regions=HBaseTestingUtility.getAllOnlineRegions(cluster);
  assertEquals("The assigned regions were not onlined after master" + " switch except for the catalog and namespace tables.",6,regions.size());
  assertTrue("The table should be in enabled state",cluster.getMaster().getAssignmentManager().getTableStateManager().isTableState(TableName.valueOf("tableRestart"),TableState.State.ENABLED));
  ht.close();
  TEST_UTIL.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterShutdown </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test of shutdown.
 * <p>
 * Starts with three masters.  Tells the active master to shutdown the cluster.
 * Verifies that all masters are properly shutdown.
 * @throws Exception
 */
@Test(timeout=120000) public void testMasterShutdown() throws Exception {
  final int NUM_MASTERS=3;
  final int NUM_RS=3;
  Configuration conf=HBaseConfiguration.create();
  HBaseTestingUtility htu=new HBaseTestingUtility(conf);
  htu.startMiniCluster(NUM_MASTERS,NUM_RS);
  MiniHBaseCluster cluster=htu.getHBaseCluster();
  List<MasterThread> masterThreads=cluster.getMasterThreads();
  for (  MasterThread mt : masterThreads) {
    assertTrue(mt.isAlive());
  }
  HMaster active=null;
  for (int i=0; i < masterThreads.size(); i++) {
    if (masterThreads.get(i).getMaster().isActiveMaster()) {
      active=masterThreads.get(i).getMaster();
      break;
    }
  }
  assertNotNull(active);
  ClusterStatus status=active.getClusterStatus();
  assertEquals(2,status.getBackupMastersSize());
  assertEquals(2,status.getBackupMasters().size());
  active.shutdown();
  for (int i=NUM_MASTERS - 1; i >= 0; --i) {
    cluster.waitOnMaster(i);
  }
  assertEquals(0,masterThreads.size());
  htu.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterStatusServlet </h4><pre class="type-4 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAssignmentManagerTruncatedList() throws IOException {
  AssignmentManager am=Mockito.mock(AssignmentManager.class);
  RegionStates rs=Mockito.mock(RegionStates.class);
  NavigableMap<String,RegionState> regionsInTransition=Maps.newTreeMap();
  for (byte i=0; i < 100; i++) {
    HRegionInfo hri=new HRegionInfo(FAKE_TABLE.getTableName(),new byte[]{i},new byte[]{(byte)(i + 1)});
    regionsInTransition.put(hri.getEncodedName(),new RegionState(hri,RegionState.State.CLOSING,12345L,FAKE_HOST));
  }
  regionsInTransition.put(HRegionInfo.FIRST_META_REGIONINFO.getEncodedName(),new RegionState(HRegionInfo.FIRST_META_REGIONINFO,RegionState.State.CLOSING,12345L,FAKE_HOST));
  Mockito.doReturn(rs).when(am).getRegionStates();
  Mockito.doReturn(regionsInTransition).when(rs).getRegionsInTransition();
  StringWriter sw=new StringWriter();
  new AssignmentManagerStatusTmpl().setLimit(50).render(sw,am);
  String result=sw.toString();
  assertTrue(result.contains(HRegionInfo.FIRST_META_REGIONINFO.getEncodedName()));
  Matcher matcher=Pattern.compile("CLOSING").matcher(result);
  int count=0;
  while (matcher.find()) {
    count++;
  }
  assertEquals(50,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMetaShutdownHandler </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test will test the expire handling of a meta-carrying
 * region server.
 * After HBaseMiniCluster is up, we will delete the ephemeral
 * node of the meta-carrying region server, which will trigger
 * the expire of this region server on the master.
 * On the other hand, we will slow down the abort process on
 * the region server so that it is still up during the master SSH.
 * We will check that the master SSH is still successfully done.
 */
@Test(timeout=180000) public void testExpireMetaRegionServer() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  HMaster master=cluster.getMaster();
  RegionStates regionStates=master.getAssignmentManager().getRegionStates();
  ServerName metaServerName=regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO);
  if (master.getServerName().equals(metaServerName) || metaServerName == null || !metaServerName.equals(cluster.getServerHoldingMeta())) {
    metaServerName=cluster.getLiveRegionServerThreads().get(0).getRegionServer().getServerName();
    master.move(HRegionInfo.FIRST_META_REGIONINFO.getEncodedNameAsBytes(),Bytes.toBytes(metaServerName.getServerName()));
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  }
  RegionState metaState=MetaTableLocator.getMetaRegionState(master.getZooKeeper());
  assertEquals("Meta should be not in transition",metaState.getState(),RegionState.State.OPEN);
  assertNotEquals("Meta should be moved off master",metaServerName,master.getServerName());
  String rsEphemeralNodePath=ZKUtil.joinZNode(master.getZooKeeper().rsZNode,metaServerName.toString());
  ZKUtil.deleteNode(master.getZooKeeper(),rsEphemeralNodePath);
  final ServerManager serverManager=master.getServerManager();
  final ServerName priorMetaServerName=metaServerName;
  TEST_UTIL.waitFor(120000,200,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return !serverManager.isServerOnline(priorMetaServerName) && !serverManager.areDeadServersInProgress();
    }
  }
);
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  assertTrue("Meta should be assigned",regionStates.isRegionOnline(HRegionInfo.FIRST_META_REGIONINFO));
  metaState=MetaTableLocator.getMetaRegionState(master.getZooKeeper());
  assertEquals("Meta should be not in transition",metaState.getState(),RegionState.State.OPEN);
  assertEquals("Meta should be assigned",metaState.getServerName(),regionStates.getRegionServerOfRegion(HRegionInfo.FIRST_META_REGIONINFO));
  assertNotEquals("Meta should be assigned on a different server",metaState.getServerName(),metaServerName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMetricsMasterProcSourceImpl </h4><pre class="type-7 type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstance() throws Exception {
  MetricsMasterProcSourceFactory metricsMasterProcSourceFactory=CompatibilitySingletonFactory.getInstance(MetricsMasterProcSourceFactory.class);
  MetricsMasterProcSource masterProcSource=metricsMasterProcSourceFactory.create(null);
  assertTrue(masterProcSource instanceof MetricsMasterProcSourceImpl);
  assertSame(metricsMasterProcSourceFactory,CompatibilitySingletonFactory.getInstance(MetricsMasterProcSourceFactory.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMetricsMasterSourceImpl </h4><pre class="type-7 type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstance() throws Exception {
  MetricsMasterSourceFactory metricsMasterSourceFactory=CompatibilitySingletonFactory.getInstance(MetricsMasterSourceFactory.class);
  MetricsMasterSource masterSource=metricsMasterSourceFactory.create(null);
  assertTrue(masterSource instanceof MetricsMasterSourceImpl);
  assertSame(metricsMasterSourceFactory,CompatibilitySingletonFactory.getInstance(MetricsMasterSourceFactory.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestRegionPlacement </h4><pre class="type-4 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Test for unfinished feature") @Test public void testRegionPlacement() throws Exception {
  String tableStr="testRegionAssignment";
  TableName table=TableName.valueOf(tableStr);
  createTable(table,REGION_NUM);
  TEST_UTIL.waitTableAvailable(table);
  verifyRegionOnPrimaryRS(REGION_NUM);
  FavoredNodesPlan currentPlan=rp.getRegionAssignmentSnapshot().getExistingAssignmentPlan();
  verifyRegionServerUpdated(currentPlan);
  FavoredNodesPlan shuffledPlan=this.shuffleAssignmentPlan(currentPlan,FavoredNodesPlan.Position.SECONDARY,FavoredNodesPlan.Position.TERTIARY);
  rp.updateAssignmentPlan(shuffledPlan);
  verifyRegionAssignment(shuffledPlan,0,REGION_NUM);
  shuffledPlan=this.shuffleAssignmentPlan(currentPlan,FavoredNodesPlan.Position.PRIMARY,FavoredNodesPlan.Position.SECONDARY);
  rp.updateAssignmentPlan(shuffledPlan);
  verifyRegionAssignment(shuffledPlan,REGION_NUM,REGION_NUM);
  RegionPlacementMaintainer rp=new RegionPlacementMaintainer(TEST_UTIL.getConfiguration());
  rp.setTargetTableName(new String[]{tableStr});
  List<AssignmentVerificationReport> reports=rp.verifyRegionPlacement(false);
  AssignmentVerificationReport report=reports.get(0);
  assertTrue(report.getRegionsWithoutValidFavoredNodes().size() == 0);
  assertTrue(report.getNonFavoredAssignedRegions().size() == 0);
  assertTrue(report.getTotalFavoredAssignments() >= REGION_NUM);
  assertTrue(report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.PRIMARY) != 0);
  assertTrue(report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.SECONDARY) == 0);
  assertTrue(report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.TERTIARY) == 0);
  assertTrue(report.getUnassignedRegions().size() == 0);
  killRandomServerAndVerifyAssignment();
  reports=rp.verifyRegionPlacement(false);
  report=reports.get(0);
  assertTrue(report.getRegionsWithoutValidFavoredNodes().size() == 0);
  assertTrue(report.getNonFavoredAssignedRegions().size() == 0);
  assertTrue(report.getTotalFavoredAssignments() >= REGION_NUM);
  assertTrue(report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.PRIMARY) > 0);
  assertTrue("secondary " + report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.SECONDARY) + " tertiary "+ report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.TERTIARY),(report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.SECONDARY) > 0 || report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.TERTIARY) > 0));
  assertTrue((report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.PRIMARY) + report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.SECONDARY) + report.getNumRegionsOnFavoredNodeByPosition(FavoredNodesPlan.Position.TERTIARY)) == REGION_NUM);
  RegionPlacementMaintainer.printAssignmentPlan(currentPlan);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestRestartCluster </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests retaining assignments on a cluster restart
 */
@Test(timeout=300000) public void testRetainAssignmentOnRestart() throws Exception {
  UTIL.startMiniCluster(2);
  while (!UTIL.getMiniHBaseCluster().getMaster().isInitialized()) {
    Threads.sleep(1);
  }
  UTIL.getMiniHBaseCluster().getMaster().getMasterRpcServices().synchronousBalanceSwitch(false);
  LOG.info("\n\nCreating tables");
  for (  TableName TABLE : TABLES) {
    UTIL.createTable(TABLE,FAMILY);
  }
  for (  TableName TABLE : TABLES) {
    UTIL.waitTableEnabled(TABLE);
  }
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  UTIL.waitUntilNoRegionsInTransition(120000);
  SnapshotOfRegionAssignmentFromMeta snapshot=new SnapshotOfRegionAssignmentFromMeta(master.getConnection());
  snapshot.initialize();
  Map<HRegionInfo,ServerName> regionToRegionServerMap=snapshot.getRegionToRegionServerMap();
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  List<JVMClusterUtil.RegionServerThread> threads=cluster.getLiveRegionServerThreads();
  assertEquals(2,threads.size());
  int[] rsPorts=new int[3];
  for (int i=0; i < 2; i++) {
    rsPorts[i]=threads.get(i).getRegionServer().getServerName().getPort();
  }
  rsPorts[2]=cluster.getMaster().getServerName().getPort();
  for (  ServerName serverName : regionToRegionServerMap.values()) {
    boolean found=false;
    for (int k=0; k < 3 && !found; k++) {
      found=serverName.getPort() == rsPorts[k];
    }
    assertTrue(found);
  }
  LOG.info("\n\nShutting down HBase cluster");
  cluster.shutdown();
  cluster.waitUntilShutDown();
  LOG.info("\n\nSleeping a bit");
  Thread.sleep(2000);
  LOG.info("\n\nStarting cluster the second time with the same ports");
  try {
    cluster.getConf().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,4);
    master=cluster.startMaster().getMaster();
    for (int i=0; i < 3; i++) {
      cluster.getConf().setInt(HConstants.REGIONSERVER_PORT,rsPorts[i]);
      cluster.startRegionServer();
    }
  }
  finally {
    cluster.getConf().setInt(HConstants.REGIONSERVER_PORT,0);
    cluster.getConf().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,2);
  }
  List<ServerName> localServers=master.getServerManager().getOnlineServersList();
  assertEquals(4,localServers.size());
  for (int i=0; i < 3; i++) {
    boolean found=false;
    for (    ServerName serverName : localServers) {
      if (serverName.getPort() == rsPorts[i]) {
        found=true;
        break;
      }
    }
    assertTrue(found);
  }
  RegionStates regionStates=master.getAssignmentManager().getRegionStates();
  int expectedRegions=regionToRegionServerMap.size() + 1;
  while (!master.isInitialized() || regionStates.getRegionAssignments().size() != expectedRegions) {
    Threads.sleep(100);
  }
  snapshot=new SnapshotOfRegionAssignmentFromMeta(master.getConnection());
  snapshot.initialize();
  Map<HRegionInfo,ServerName> newRegionToRegionServerMap=snapshot.getRegionToRegionServerMap();
  assertEquals(regionToRegionServerMap.size(),newRegionToRegionServerMap.size());
  for (  Map.Entry<HRegionInfo,ServerName> entry : newRegionToRegionServerMap.entrySet()) {
    if (TableName.NAMESPACE_TABLE_NAME.equals(entry.getKey().getTable()))     continue;
    ServerName oldServer=regionToRegionServerMap.get(entry.getKey());
    ServerName currentServer=entry.getValue();
    assertEquals(oldServer.getHostAndPort(),currentServer.getHostAndPort());
    assertNotEquals(oldServer.getStartcode(),currentServer.getStartcode());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testClusterRestart() throws Exception {
  UTIL.startMiniCluster(3);
  while (!UTIL.getMiniHBaseCluster().getMaster().isInitialized()) {
    Threads.sleep(1);
  }
  LOG.info("\n\nCreating tables");
  for (  TableName TABLE : TABLES) {
    UTIL.createTable(TABLE,FAMILY);
  }
  for (  TableName TABLE : TABLES) {
    UTIL.waitTableEnabled(TABLE);
  }
  List<HRegionInfo> allRegions=MetaTableAccessor.getAllRegions(UTIL.getConnection(),false);
  assertEquals(4,allRegions.size());
  LOG.info("\n\nShutting down cluster");
  UTIL.shutdownMiniHBaseCluster();
  LOG.info("\n\nSleeping a bit");
  Thread.sleep(2000);
  LOG.info("\n\nStarting cluster the second time");
  UTIL.restartHBaseCluster(3);
  allRegions=MetaTableAccessor.getAllRegions(UTIL.getConnection(),false);
  assertEquals(4,allRegions.size());
  LOG.info("\n\nWaiting for tables to be available");
  for (  TableName TABLE : TABLES) {
    try {
      UTIL.createTable(TABLE,FAMILY);
      assertTrue("Able to create table that should already exist",false);
    }
 catch (    TableExistsException tee) {
      LOG.info("Table already exists as expected");
    }
    UTIL.waitTableAvailable(TABLE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestSplitLogManager </h4><pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.startMiniZKCluster();
  conf=TEST_UTIL.getConfiguration();
  zkw=new ZooKeeperWatcher(conf,"split-log-manager-tests" + UUID.randomUUID().toString(),null);
  ds=new DummyServer(zkw,conf);
  ZKUtil.deleteChildrenRecursively(zkw,zkw.baseZNode);
  ZKUtil.createAndFailSilent(zkw,zkw.baseZNode);
  assertTrue(ZKUtil.checkExists(zkw,zkw.baseZNode) != -1);
  LOG.debug(zkw.baseZNode + " created");
  ZKUtil.createAndFailSilent(zkw,zkw.splitLogZNode);
  assertTrue(ZKUtil.checkExists(zkw,zkw.splitLogZNode) != -1);
  LOG.debug(zkw.splitLogZNode + " created");
  stopped=false;
  resetCounters();
  Mockito.when(sm.isServerOnline(Mockito.any(ServerName.class))).thenReturn(true);
  Mockito.when(master.getServerManager()).thenReturn(sm);
  to=12000;
  conf.setInt(HConstants.HBASE_SPLITLOG_MANAGER_TIMEOUT,to);
  conf.setInt("hbase.splitlog.manager.unassigned.timeout",2 * to);
  conf.setInt("hbase.splitlog.manager.timeoutmonitor.period",100);
  to=to + 16 * 100;
  this.mode=(conf.getBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,false) ? RecoveryMode.LOG_REPLAY : RecoveryMode.LOG_SPLITTING);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testTaskResigned() throws Exception {
  LOG.info("TestTaskResigned - resubmit task node once in RESIGNED state");
  assertEquals(tot_mgr_resubmit.get(),0);
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  assertEquals(tot_mgr_resubmit.get(),0);
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo/1");
  assertEquals(tot_mgr_resubmit.get(),0);
  final ServerName worker1=ServerName.valueOf("worker1,1,1");
  assertEquals(tot_mgr_resubmit.get(),0);
  SplitLogTask slt=new SplitLogTask.Resigned(worker1,this.mode);
  assertEquals(tot_mgr_resubmit.get(),0);
  ZKUtil.setData(zkw,tasknode,slt.toByteArray());
  ZKUtil.checkExists(zkw,tasknode);
  if (tot_mgr_resubmit.get() == 0) {
    waitForCounter(tot_mgr_resubmit,0,1,to / 2);
  }
  assertEquals(tot_mgr_resubmit.get(),1);
  byte[] taskstate=ZKUtil.getData(zkw,tasknode);
  slt=SplitLogTask.parseFrom(taskstate);
  assertTrue(slt.isUnassigned(DUMMY_MASTER));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testUnassignedOrphan() throws Exception {
  LOG.info("TestUnassignedOrphan - an unassigned task is resubmitted at" + " startup");
  String tasknode=ZKSplitLog.getEncodedNodeName(zkw,"orphan/test/slash");
  SplitLogTask slt=new SplitLogTask.Unassigned(DUMMY_MASTER,this.mode);
  zkw.getRecoverableZooKeeper().create(tasknode,slt.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  int version=ZKUtil.checkExists(zkw,tasknode);
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  waitForCounter(tot_mgr_orphan_task_acquired,0,1,to / 2);
  Task task=slm.findOrCreateOrphanTask(tasknode);
  assertTrue(task.isOrphan());
  assertTrue(task.isUnassigned());
  waitForCounter(tot_mgr_rescan,0,1,to / 2);
  Task task2=slm.findOrCreateOrphanTask(tasknode);
  assertTrue(task == task2);
  LOG.debug("task = " + task);
  assertEquals(1L,tot_mgr_resubmit.get());
  assertEquals(1,task.incarnation.get());
  assertEquals(0,task.unforcedResubmits.get());
  assertTrue(task.isOrphan());
  assertTrue(task.isUnassigned());
  assertTrue(ZKUtil.checkExists(zkw,tasknode) > version);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testRescanCleanup() throws Exception {
  LOG.info("TestRescanCleanup - ensure RESCAN nodes are cleaned up");
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo/1");
  int version=ZKUtil.checkExists(zkw,tasknode);
  final ServerName worker1=ServerName.valueOf("worker1,1,1");
  SplitLogTask slt=new SplitLogTask.Owned(worker1,this.mode);
  ZKUtil.setData(zkw,tasknode,slt.toByteArray());
  waitForCounter(tot_mgr_heartbeat,0,1,to / 2);
  waitForCounter(new Expr(){
    @Override public long eval(){
      return (tot_mgr_resubmit.get() + tot_mgr_resubmit_failed.get());
    }
  }
,0,1,5 * 60000);
  Assert.assertEquals("Could not run test. Lost ZK connection?",0,tot_mgr_resubmit_failed.get());
  int version1=ZKUtil.checkExists(zkw,tasknode);
  assertTrue(version1 > version);
  byte[] taskstate=ZKUtil.getData(zkw,tasknode);
  slt=SplitLogTask.parseFrom(taskstate);
  assertTrue(slt.isUnassigned(DUMMY_MASTER));
  waitForCounter(tot_mgr_rescan_deleted,0,1,to / 2);
}

</code></pre>

<br>
<pre class="type-4 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testMultipleResubmits() throws Exception {
  LOG.info("TestMultipleResbmits - no indefinite resubmissions");
  conf.setInt("hbase.splitlog.max.resubmit",2);
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  TaskBatch batch=new TaskBatch();
  String tasknode=submitTaskAndWait(batch,"foo/1");
  int version=ZKUtil.checkExists(zkw,tasknode);
  final ServerName worker1=ServerName.valueOf("worker1,1,1");
  final ServerName worker2=ServerName.valueOf("worker2,1,1");
  final ServerName worker3=ServerName.valueOf("worker3,1,1");
  SplitLogTask slt=new SplitLogTask.Owned(worker1,this.mode);
  ZKUtil.setData(zkw,tasknode,slt.toByteArray());
  waitForCounter(tot_mgr_heartbeat,0,1,to / 2);
  waitForCounter(tot_mgr_resubmit,0,1,to + to / 2);
  int version1=ZKUtil.checkExists(zkw,tasknode);
  assertTrue(version1 > version);
  slt=new SplitLogTask.Owned(worker2,this.mode);
  ZKUtil.setData(zkw,tasknode,slt.toByteArray());
  waitForCounter(tot_mgr_heartbeat,1,2,to / 2);
  waitForCounter(tot_mgr_resubmit,1,2,to + to / 2);
  int version2=ZKUtil.checkExists(zkw,tasknode);
  assertTrue(version2 > version1);
  slt=new SplitLogTask.Owned(worker3,this.mode);
  ZKUtil.setData(zkw,tasknode,slt.toByteArray());
  waitForCounter(tot_mgr_heartbeat,2,3,to / 2);
  waitForCounter(tot_mgr_resubmit_threshold_reached,0,1,to + to / 2);
  Thread.sleep(to + to / 2);
  assertEquals(2L,tot_mgr_resubmit.get() - tot_mgr_resubmit_force.get());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("DLR is broken by HBASE-12751") @Test(timeout=60000) public void testGetPreviousRecoveryMode() throws Exception {
  LOG.info("testGetPreviousRecoveryMode");
  SplitLogCounters.resetCounters();
  conf.setBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,true);
  zkw.getRecoverableZooKeeper().create(ZKSplitLog.getEncodedNodeName(zkw,"testRecovery"),new SplitLogTask.Unassigned(ServerName.valueOf("mgr,1,1"),RecoveryMode.LOG_SPLITTING).toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  LOG.info("Mode1=" + slm.getRecoveryMode());
  assertTrue(slm.isLogSplitting());
  zkw.getRecoverableZooKeeper().delete(ZKSplitLog.getEncodedNodeName(zkw,"testRecovery"),-1);
  LOG.info("Mode2=" + slm.getRecoveryMode());
  slm.setRecoveryMode(false);
  LOG.info("Mode3=" + slm.getRecoveryMode());
  assertTrue("Mode4=" + slm.getRecoveryMode(),slm.isLogReplaying());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestTableLockManager </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=600000) public void testTableReadLock() throws Exception {
  prepareMiniCluster();
  LoadTestTool loadTool=new LoadTestTool();
  loadTool.setConf(TEST_UTIL.getConfiguration());
  int numKeys=10000;
  final TableName tableName=TableName.valueOf("testTableReadLock");
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  final byte[] family=Bytes.toBytes("test_cf");
  desc.addFamily(new HColumnDescriptor(family));
  admin.createTable(desc);
  int ret=loadTool.run(new String[]{"-tn",tableName.getNameAsString(),"-write",String.format("%d:%d:%d",1,10,10),"-num_keys",String.valueOf(numKeys),"-skip_init"});
  if (0 != ret) {
    String errorMsg="Load failed with error code " + ret;
    LOG.error(errorMsg);
    fail(errorMsg);
  }
  int familyValues=admin.getTableDescriptor(tableName).getFamily(family).getValues().size();
  StoppableImplementation stopper=new StoppableImplementation();
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  ScheduledChore alterThread=new ScheduledChore("Alter Chore",stopper,10000){
    @Override protected void chore(){
      Random random=new Random();
      try {
        HTableDescriptor htd=admin.getTableDescriptor(tableName);
        String val=String.valueOf(random.nextInt());
        htd.getFamily(family).setValue(val,val);
        desc.getFamily(family).setValue(val,val);
        admin.modifyTable(tableName,htd);
      }
 catch (      Exception ex) {
        LOG.warn("Caught exception",ex);
        fail(ex.getMessage());
      }
    }
  }
;
  ScheduledChore splitThread=new ScheduledChore("Split thread",stopper,5000){
    @Override public void chore(){
      try {
        HRegion region=TEST_UTIL.getSplittableRegion(tableName,-1);
        if (region != null) {
          byte[] regionName=region.getRegionInfo().getRegionName();
          admin.flushRegion(regionName);
          admin.compactRegion(regionName);
          admin.splitRegion(regionName);
        }
 else {
          LOG.warn("Could not find suitable region for the table.  Possibly the " + "region got closed and the attempts got over before " + "the region could have got reassigned.");
        }
      }
 catch (      NotServingRegionException nsre) {
        LOG.warn("Caught exception",nsre);
      }
catch (      Exception ex) {
        LOG.warn("Caught exception",ex);
        fail(ex.getMessage());
      }
    }
  }
;
  choreService.scheduleChore(alterThread);
  choreService.scheduleChore(splitThread);
  TEST_UTIL.waitTableEnabled(tableName);
  while (true) {
    List<HRegionInfo> regions=admin.getTableRegions(tableName);
    LOG.info(String.format("Table #regions: %d regions: %s:",regions.size(),regions));
    assertEquals(admin.getTableDescriptor(tableName),desc);
    for (    HRegion region : TEST_UTIL.getMiniHBaseCluster().getRegions(tableName)) {
      HTableDescriptor regionTableDesc=region.getTableDesc();
      assertEquals(desc,regionTableDesc);
    }
    if (regions.size() >= 5) {
      break;
    }
    Threads.sleep(1000);
  }
  stopper.stop("test finished");
  int newFamilyValues=admin.getTableDescriptor(tableName).getFamily(family).getValues().size();
  LOG.info(String.format("Altered the table %d times",newFamilyValues - familyValues));
  assertTrue(newFamilyValues > familyValues);
  ret=loadTool.run(new String[]{"-tn",tableName.getNameAsString(),"-read","100:10","-num_keys",String.valueOf(numKeys),"-skip_init"});
  if (0 != ret) {
    String errorMsg="Verify failed with error code " + ret;
    LOG.error(errorMsg);
    fail(errorMsg);
  }
  admin.close();
  choreService.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestBaseLoadBalancer </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests immediate assignment.
 * Invariant is that all regions have an assignment.
 * @throws Exception
 */
@Test(timeout=30000) public void testImmediateAssignment() throws Exception {
  List<ServerName> tmp=getListOfServerNames(randomServers(1,0));
  tmp.add(master);
  ServerName sn=loadBalancer.randomAssignment(HRegionInfo.FIRST_META_REGIONINFO,tmp);
  assertEquals(master,sn);
  HRegionInfo hri=randomRegions(1,-1).get(0);
  sn=loadBalancer.randomAssignment(hri,tmp);
  assertNotEquals(master,sn);
  tmp=new ArrayList<ServerName>();
  tmp.add(master);
  sn=loadBalancer.randomAssignment(hri,tmp);
  assertNull("Should not assign user regions on master",sn);
  for (  int[] mock : regionsAndServersMocks) {
    LOG.debug("testImmediateAssignment with " + mock[0] + " regions and "+ mock[1]+ " servers");
    List<HRegionInfo> regions=randomRegions(mock[0]);
    List<ServerAndLoad> servers=randomServers(mock[1],0);
    List<ServerName> list=getListOfServerNames(servers);
    Map<HRegionInfo,ServerName> assignments=loadBalancer.immediateAssignment(regions,list);
    assertImmediateAssignment(regions,list,assignments);
    returnRegions(regions);
    returnServers(list);
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the bulk assignment used during cluster startup.
 * Round-robin. Should yield a balanced cluster so same invariant as the load
 * balancer holds, all servers holding either floor(avg) or ceiling(avg).
 * @throws Exception
 */
@Test(timeout=180000) public void testBulkAssignment() throws Exception {
  List<ServerName> tmp=getListOfServerNames(randomServers(5,0));
  List<HRegionInfo> hris=randomRegions(20);
  hris.add(HRegionInfo.FIRST_META_REGIONINFO);
  tmp.add(master);
  Map<ServerName,List<HRegionInfo>> plans=loadBalancer.roundRobinAssignment(hris,tmp);
  assertTrue(plans.get(master).contains(HRegionInfo.FIRST_META_REGIONINFO));
  assertEquals(1,plans.get(master).size());
  int totalRegion=0;
  for (  List<HRegionInfo> regions : plans.values()) {
    totalRegion+=regions.size();
  }
  assertEquals(hris.size(),totalRegion);
  for (  int[] mock : regionsAndServersMocks) {
    LOG.debug("testBulkAssignment with " + mock[0] + " regions and "+ mock[1]+ " servers");
    List<HRegionInfo> regions=randomRegions(mock[0]);
    List<ServerAndLoad> servers=randomServers(mock[1],0);
    List<ServerName> list=getListOfServerNames(servers);
    Map<ServerName,List<HRegionInfo>> assignments=loadBalancer.roundRobinAssignment(regions,list);
    float average=(float)regions.size() / servers.size();
    int min=(int)Math.floor(average);
    int max=(int)Math.ceil(average);
    if (assignments != null && !assignments.isEmpty()) {
      for (      List<HRegionInfo> regionList : assignments.values()) {
        assertTrue(regionList.size() == min || regionList.size() == max);
      }
    }
    returnRegions(regions);
    returnServers(list);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestFavoredNodeAssignmentHelper </h4><pre class="type-4 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSecondaryAndTertiaryPlacementWithSingleRack(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",10);
  Triple<Map<HRegionInfo,ServerName>,FavoredNodeAssignmentHelper,List<HRegionInfo>> primaryRSMapAndHelper=secondaryAndTertiaryRSPlacementHelper(60000,rackToServerCount);
  FavoredNodeAssignmentHelper helper=primaryRSMapAndHelper.getSecond();
  Map<HRegionInfo,ServerName> primaryRSMap=primaryRSMapAndHelper.getFirst();
  List<HRegionInfo> regions=primaryRSMapAndHelper.getThird();
  Map<HRegionInfo,ServerName[]> secondaryAndTertiaryMap=helper.placeSecondaryAndTertiaryRS(primaryRSMap);
  for (  HRegionInfo region : regions) {
    ServerName[] secondaryAndTertiaryServers=secondaryAndTertiaryMap.get(region);
    assertTrue(!secondaryAndTertiaryServers[0].equals(primaryRSMap.get(region)));
    assertTrue(!secondaryAndTertiaryServers[1].equals(primaryRSMap.get(region)));
    assertTrue(!secondaryAndTertiaryServers[0].equals(secondaryAndTertiaryServers[1]));
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSecondaryAndTertiaryPlacementWithMultipleRacks(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",10);
  rackToServerCount.put("rack2",10);
  Triple<Map<HRegionInfo,ServerName>,FavoredNodeAssignmentHelper,List<HRegionInfo>> primaryRSMapAndHelper=secondaryAndTertiaryRSPlacementHelper(60000,rackToServerCount);
  FavoredNodeAssignmentHelper helper=primaryRSMapAndHelper.getSecond();
  Map<HRegionInfo,ServerName> primaryRSMap=primaryRSMapAndHelper.getFirst();
  assertTrue(primaryRSMap.size() == 60000);
  Map<HRegionInfo,ServerName[]> secondaryAndTertiaryMap=helper.placeSecondaryAndTertiaryRS(primaryRSMap);
  assertTrue(secondaryAndTertiaryMap.size() == 60000);
  for (  Map.Entry<HRegionInfo,ServerName[]> entry : secondaryAndTertiaryMap.entrySet()) {
    ServerName[] allServersForRegion=entry.getValue();
    String primaryRSRack=rackManager.getRack(primaryRSMap.get(entry.getKey()));
    String secondaryRSRack=rackManager.getRack(allServersForRegion[0]);
    String tertiaryRSRack=rackManager.getRack(allServersForRegion[1]);
    assertTrue(!primaryRSRack.equals(secondaryRSRack));
    assertTrue(secondaryRSRack.equals(tertiaryRSRack));
  }
}

</code></pre>

<br>
<pre class="type-4 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSmallCluster(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",2);
  List<ServerName> servers=getServersFromRack(rackToServerCount);
  FavoredNodeAssignmentHelper helper=new FavoredNodeAssignmentHelper(servers,new Configuration());
  assertFalse(helper.canPlaceFavoredNodes());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSecondaryAndTertiaryPlacementWithLessThanTwoServersInRacks(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",1);
  rackToServerCount.put("rack2",1);
  Triple<Map<HRegionInfo,ServerName>,FavoredNodeAssignmentHelper,List<HRegionInfo>> primaryRSMapAndHelper=secondaryAndTertiaryRSPlacementHelper(6,rackToServerCount);
  FavoredNodeAssignmentHelper helper=primaryRSMapAndHelper.getSecond();
  Map<HRegionInfo,ServerName> primaryRSMap=primaryRSMapAndHelper.getFirst();
  List<HRegionInfo> regions=primaryRSMapAndHelper.getThird();
  assertTrue(primaryRSMap.size() == 6);
  Map<HRegionInfo,ServerName[]> secondaryAndTertiaryMap=helper.placeSecondaryAndTertiaryRS(primaryRSMap);
  for (  HRegionInfo region : regions) {
    assertTrue(secondaryAndTertiaryMap.get(region) == null);
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSecondaryAndTertiaryPlacementWithMoreThanOneServerInPrimaryRack(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",2);
  rackToServerCount.put("rack2",1);
  Triple<Map<HRegionInfo,ServerName>,FavoredNodeAssignmentHelper,List<HRegionInfo>> primaryRSMapAndHelper=secondaryAndTertiaryRSPlacementHelper(6,rackToServerCount);
  FavoredNodeAssignmentHelper helper=primaryRSMapAndHelper.getSecond();
  Map<HRegionInfo,ServerName> primaryRSMap=primaryRSMapAndHelper.getFirst();
  List<HRegionInfo> regions=primaryRSMapAndHelper.getThird();
  assertTrue(primaryRSMap.size() == 6);
  Map<HRegionInfo,ServerName[]> secondaryAndTertiaryMap=helper.placeSecondaryAndTertiaryRS(primaryRSMap);
  for (  HRegionInfo region : regions) {
    ServerName s=primaryRSMap.get(region);
    ServerName secondaryRS=secondaryAndTertiaryMap.get(region)[0];
    ServerName tertiaryRS=secondaryAndTertiaryMap.get(region)[1];
    if (rackManager.getRack(s).equals("rack1")) {
      assertTrue(rackManager.getRack(secondaryRS).equals("rack2") && rackManager.getRack(tertiaryRS).equals("rack1"));
    }
    if (rackManager.getRack(s).equals("rack2")) {
      assertTrue(rackManager.getRack(secondaryRS).equals("rack1") && rackManager.getRack(tertiaryRS).equals("rack1"));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testSecondaryAndTertiaryPlacementWithSingleServer(){
  Map<String,Integer> rackToServerCount=new HashMap<String,Integer>();
  rackToServerCount.put("rack1",1);
  Triple<Map<HRegionInfo,ServerName>,FavoredNodeAssignmentHelper,List<HRegionInfo>> primaryRSMapAndHelper=secondaryAndTertiaryRSPlacementHelper(1,rackToServerCount);
  FavoredNodeAssignmentHelper helper=primaryRSMapAndHelper.getSecond();
  Map<HRegionInfo,ServerName> primaryRSMap=primaryRSMapAndHelper.getFirst();
  List<HRegionInfo> regions=primaryRSMapAndHelper.getThird();
  Map<HRegionInfo,ServerName[]> secondaryAndTertiaryMap=helper.placeSecondaryAndTertiaryRS(primaryRSMap);
  assertTrue(secondaryAndTertiaryMap.get(regions.get(0)) == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestRegionLocationFinder </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapHostNameToServerName() throws Exception {
  List<String> topHosts=new ArrayList<String>();
  for (int i=0; i < ServerNum; i++) {
    HRegionServer server=cluster.getRegionServer(i);
    String serverHost=server.getServerName().getHostname();
    if (!topHosts.contains(serverHost)) {
      topHosts.add(serverHost);
    }
  }
  List<ServerName> servers=finder.mapHostNameToServerName(topHosts);
  assertEquals(1,topHosts.size());
  for (int i=0; i < ServerNum; i++) {
    ServerName server=cluster.getRegionServer(i).getServerName();
    assertTrue(servers.contains(server));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeepRegionLoad() throws Exception {
  ServerName sn=ServerName.valueOf("test:8080",100);
  int numClusterStatusToAdd=20000;
  for (int i=0; i < numClusterStatusToAdd; i++) {
    ServerLoad sl=mock(ServerLoad.class);
    RegionLoad rl=mock(RegionLoad.class);
    when(rl.getStores()).thenReturn(i);
    Map<byte[],RegionLoad> regionLoadMap=new TreeMap<byte[],RegionLoad>(Bytes.BYTES_COMPARATOR);
    regionLoadMap.put(Bytes.toBytes(REGION_KEY),rl);
    when(sl.getRegionsLoad()).thenReturn(regionLoadMap);
    ClusterStatus clusterStatus=mock(ClusterStatus.class);
    when(clusterStatus.getServers()).thenReturn(Arrays.asList(sn));
    when(clusterStatus.getLoad(sn)).thenReturn(sl);
    loadBalancer.setClusterStatus(clusterStatus);
  }
  assertTrue(loadBalancer.loads.get(REGION_KEY) != null);
  assertTrue(loadBalancer.loads.get(REGION_KEY).size() == 15);
  Queue<RegionLoad> loads=loadBalancer.loads.get(REGION_KEY);
  int i=0;
  while (loads.size() > 0) {
    RegionLoad rl=loads.remove();
    assertEquals(i + (numClusterStatusToAdd - 15),rl.getStores());
    i++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplicaCostForReplicas(){
  Configuration conf=HBaseConfiguration.create();
  StochasticLoadBalancer.CostFunction costFunction=new StochasticLoadBalancer.RegionReplicaHostCostFunction(conf);
  int[] servers=new int[]{3,3,3,3,3};
  TreeMap<ServerName,List<HRegionInfo>> clusterState=mockClusterServers(servers);
  BaseLoadBalancer.Cluster cluster;
  cluster=new BaseLoadBalancer.Cluster(clusterState,null,null,null);
  costFunction.init(cluster);
  double costWithoutReplicas=costFunction.cost();
  assertEquals(0,costWithoutReplicas,0);
  HRegionInfo replica1=RegionReplicaUtil.getRegionInfoForReplica(clusterState.firstEntry().getValue().get(0),1);
  clusterState.lastEntry().getValue().add(replica1);
  cluster=new BaseLoadBalancer.Cluster(clusterState,null,null,null);
  costFunction.init(cluster);
  double costWith1ReplicaDifferentServer=costFunction.cost();
  assertEquals(0,costWith1ReplicaDifferentServer,0);
  HRegionInfo replica2=RegionReplicaUtil.getRegionInfoForReplica(replica1,2);
  clusterState.lastEntry().getValue().add(replica2);
  cluster=new BaseLoadBalancer.Cluster(clusterState,null,null,null);
  costFunction.init(cluster);
  double costWith1ReplicaSameServer=costFunction.cost();
  assertTrue(costWith1ReplicaDifferentServer < costWith1ReplicaSameServer);
  HRegionInfo replica3;
  Iterator<Entry<ServerName,List<HRegionInfo>>> it;
  Entry<ServerName,List<HRegionInfo>> entry;
  clusterState=mockClusterServers(servers);
  it=clusterState.entrySet().iterator();
  entry=it.next();
  HRegionInfo hri=entry.getValue().get(0);
  replica1=RegionReplicaUtil.getRegionInfoForReplica(hri,1);
  replica2=RegionReplicaUtil.getRegionInfoForReplica(hri,2);
  replica3=RegionReplicaUtil.getRegionInfoForReplica(hri,3);
  entry.getValue().add(replica1);
  entry.getValue().add(replica2);
  it.next().getValue().add(replica3);
  cluster=new BaseLoadBalancer.Cluster(clusterState,null,null,null);
  costFunction.init(cluster);
  double costWith3ReplicasSameServer=costFunction.cost();
  clusterState=mockClusterServers(servers);
  hri=clusterState.firstEntry().getValue().get(0);
  replica1=RegionReplicaUtil.getRegionInfoForReplica(hri,1);
  replica2=RegionReplicaUtil.getRegionInfoForReplica(hri,2);
  replica3=RegionReplicaUtil.getRegionInfoForReplica(hri,3);
  clusterState.firstEntry().getValue().add(replica1);
  clusterState.lastEntry().getValue().add(replica2);
  clusterState.lastEntry().getValue().add(replica3);
  cluster=new BaseLoadBalancer.Cluster(clusterState,null,null,null);
  costFunction.init(cluster);
  double costWith2ReplicasOnTwoServers=costFunction.cost();
  assertTrue(costWith2ReplicasOnTwoServers < costWith3ReplicasSameServer);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewCost(){
  Configuration conf=HBaseConfiguration.create();
  StochasticLoadBalancer.CostFunction costFunction=new StochasticLoadBalancer.RegionCountSkewCostFunction(conf);
  for (  int[] mockCluster : clusterStateMocks) {
    costFunction.init(mockCluster(mockCluster));
    double cost=costFunction.cost();
    assertTrue(cost >= 0);
    assertTrue(cost <= 1.01);
  }
  costFunction.init(mockCluster(new int[]{0,0,0,0,1}));
  assertEquals(0,costFunction.cost(),0.01);
  costFunction.init(mockCluster(new int[]{0,0,0,1,1}));
  assertEquals(0,costFunction.cost(),0.01);
  costFunction.init(mockCluster(new int[]{0,0,1,1,1}));
  assertEquals(0,costFunction.cost(),0.01);
  costFunction.init(mockCluster(new int[]{0,1,1,1,1}));
  assertEquals(0,costFunction.cost(),0.01);
  costFunction.init(mockCluster(new int[]{1,1,1,1,1}));
  assertEquals(0,costFunction.cost(),0.01);
  costFunction.init(mockCluster(new int[]{10000,0,0,0,0}));
  assertEquals(1,costFunction.cost(),0.01);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.cleaner.TestHFileLinkCleaner </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHFileLinkCleaning() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  FSUtils.setRootDir(conf,TEST_UTIL.getDataTestDir());
  conf.set(HFileCleaner.MASTER_HFILE_CLEANER_PLUGINS,HFileLinkCleaner.class.getName());
  Path rootDir=FSUtils.getRootDir(conf);
  FileSystem fs=FileSystem.get(conf);
  final TableName tableName=TableName.valueOf("test-table");
  final TableName tableLinkName=TableName.valueOf("test-link");
  final String hfileName="1234567890";
  final String familyName="cf";
  HRegionInfo hri=new HRegionInfo(tableName);
  HRegionInfo hriLink=new HRegionInfo(tableLinkName);
  Path archiveDir=HFileArchiveUtil.getArchivePath(conf);
  Path archiveStoreDir=HFileArchiveUtil.getStoreArchivePath(conf,tableName,hri.getEncodedName(),familyName);
  Path archiveLinkStoreDir=HFileArchiveUtil.getStoreArchivePath(conf,tableLinkName,hriLink.getEncodedName(),familyName);
  Path familyPath=getFamilyDirPath(archiveDir,tableName,hri.getEncodedName(),familyName);
  fs.mkdirs(familyPath);
  Path hfilePath=new Path(familyPath,hfileName);
  fs.createNewFile(hfilePath);
  Path familyLinkPath=getFamilyDirPath(rootDir,tableLinkName,hriLink.getEncodedName(),familyName);
  fs.mkdirs(familyLinkPath);
  HFileLink.create(conf,fs,familyLinkPath,hri,hfileName);
  Path linkBackRefDir=HFileLink.getBackReferencesDir(archiveStoreDir,hfileName);
  assertTrue(fs.exists(linkBackRefDir));
  FileStatus[] backRefs=fs.listStatus(linkBackRefDir);
  assertEquals(1,backRefs.length);
  Path linkBackRef=backRefs[0].getPath();
  final long ttl=1000;
  conf.setLong(TimeToLiveHFileCleaner.TTL_CONF_KEY,ttl);
  Server server=new DummyServer();
  HFileCleaner cleaner=new HFileCleaner(1000,server,conf,fs,archiveDir);
  cleaner.chore();
  assertTrue(fs.exists(linkBackRef));
  assertTrue(fs.exists(hfilePath));
  fs.rename(FSUtils.getTableDir(rootDir,tableLinkName),FSUtils.getTableDir(archiveDir,tableLinkName));
  cleaner.chore();
  assertFalse("Link should be deleted",fs.exists(linkBackRef));
  Thread.sleep(ttl * 2);
  cleaner.chore();
  assertFalse("HFile should be deleted",fs.exists(hfilePath));
  for (int i=0; i < 4; ++i) {
    Thread.sleep(ttl * 2);
    cleaner.chore();
  }
  assertFalse("HFile should be deleted",fs.exists(FSUtils.getTableDir(archiveDir,tableName)));
  assertFalse("Link should be deleted",fs.exists(FSUtils.getTableDir(archiveDir,tableLinkName)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.cleaner.TestReplicationHFileCleaner </h4><pre class="type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDeletableFiles() throws Exception {
  Path notDeletablefile=new Path(root,"testGetDeletableFiles_1");
  fs.createNewFile(notDeletablefile);
  assertTrue("Test file not created!",fs.exists(notDeletablefile));
  Path deletablefile=new Path(root,"testGetDeletableFiles_2");
  fs.createNewFile(deletablefile);
  assertTrue("Test file not created!",fs.exists(deletablefile));
  List<FileStatus> files=new ArrayList<FileStatus>(2);
  FileStatus f=new FileStatus();
  f.setPath(deletablefile);
  files.add(f);
  f=new FileStatus();
  f.setPath(notDeletablefile);
  files.add(f);
  List<String> hfiles=new ArrayList<>(1);
  hfiles.add(notDeletablefile.getName());
  rq.addHFileRefs(peerId,hfiles);
  ReplicationHFileCleaner cleaner=new ReplicationHFileCleaner();
  cleaner.setConf(conf);
  Iterator<FileStatus> deletableFilesIterator=cleaner.getDeletableFiles(files).iterator();
  int i=0;
  while (deletableFilesIterator.hasNext() && i < 2) {
    i++;
  }
  if (i > 2) {
    fail("File " + notDeletablefile + " should not be deletable as its hfile reference node is not added.");
  }
  assertTrue(deletableFilesIterator.next().getPath().equals(deletablefile));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.cleaner.TestSnapshotFromMaster </h4><pre class="type-4 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the snapshot hfile archive cleaner works correctly. HFiles that are in snapshots
 * should be retained, while those that are not in a snapshot should be deleted.
 * @throws Exception on failure
 */
@Test(timeout=300000) public void testSnapshotHFileArchiving() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  UTIL.deleteTable(TABLE_NAME);
  HTableDescriptor htd=new HTableDescriptor(TABLE_NAME);
  htd.setCompactionEnabled(false);
  UTIL.createTable(htd,new byte[][]{TEST_FAM},null);
  for (int i=0; i < 5; i++) {
    UTIL.loadTable(UTIL.getConnection().getTable(TABLE_NAME),TEST_FAM);
    UTIL.flush(TABLE_NAME);
  }
  admin.disableTable(TABLE_NAME);
  htd.setCompactionEnabled(true);
  String snapshotName="snapshot";
  byte[] snapshotNameBytes=Bytes.toBytes(snapshotName);
  admin.snapshot(snapshotNameBytes,TABLE_NAME);
  LOG.info("After snapshot File-System state");
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshotNameBytes,TABLE_NAME);
  admin.modifyTable(TABLE_NAME,htd);
  admin.enableTable(TABLE_NAME);
  List<HRegion> regions=UTIL.getHBaseCluster().getRegions(TABLE_NAME);
  for (  HRegion region : regions) {
    region.waitForFlushesAndCompactions();
    region.compactStores();
  }
  List<RegionServerThread> regionServerThreads=UTIL.getMiniHBaseCluster().getRegionServerThreads();
  HRegionServer hrs=null;
  for (  RegionServerThread rs : regionServerThreads) {
    if (!rs.getRegionServer().getOnlineRegions(TABLE_NAME).isEmpty()) {
      hrs=rs.getRegionServer();
      break;
    }
  }
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(100,null,hrs,false);
  cleaner.chore();
  LOG.info("After compaction File-System state");
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  LOG.debug("Running hfile cleaners");
  ensureHFileCleanersRun();
  LOG.info("After cleaners File-System state: " + rootDir);
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  Path snapshotTable=SnapshotDescriptionUtils.getCompletedSnapshotDir(snapshotName,rootDir);
  Set<String> snapshotHFiles=SnapshotReferenceUtil.getHFileNames(UTIL.getConfiguration(),fs,snapshotTable);
  LOG.debug("Have snapshot hfiles:");
  for (  String fileName : snapshotHFiles) {
    LOG.debug(fileName);
  }
  Collection<String> files=getArchivedHFiles(archiveDir,rootDir,fs,TABLE_NAME);
  for (  String fileName : snapshotHFiles) {
    assertTrue("Archived hfiles " + files + " is missing snapshot file:"+ fileName,files.contains(fileName));
  }
  admin.deleteSnapshot(snapshotNameBytes);
  SnapshotTestingUtils.assertNoSnapshots(admin);
  List<BaseHFileCleanerDelegate> delegates=UTIL.getMiniHBaseCluster().getMaster().getHFileCleaner().cleanersChain;
  for (  BaseHFileCleanerDelegate delegate : delegates) {
    if (delegate instanceof SnapshotHFileCleaner) {
      ((SnapshotHFileCleaner)delegate).getFileCacheForTesting().triggerCacheRefreshForTesting();
    }
  }
  LOG.debug("Running hfile cleaners");
  ensureHFileCleanersRun();
  LOG.info("After delete snapshot cleaners run File-System state");
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  files=getArchivedHFiles(archiveDir,rootDir,fs,TABLE_NAME);
  assertEquals("Still have some hfiles in the archive, when their snapshot has been deleted.",0,files.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.handler.TestEnableTableHandler </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testEnableTableWithNoRegionServers() throws Exception {
  final TableName tableName=TableName.valueOf("testEnableTableWithNoRegionServers");
  final MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  final HMaster m=cluster.getMaster();
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(FAMILYNAME));
  admin.createTable(desc);
  admin.disableTable(tableName);
  TEST_UTIL.waitTableDisabled(tableName.getName());
  admin.enableTable(tableName);
  TEST_UTIL.waitTableEnabled(tableName);
  admin.disableTable(tableName);
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  JVMClusterUtil.RegionServerThread rs=cluster.getRegionServerThreads().get(0);
  rs.getRegionServer().stop("stop");
  cluster.waitForRegionServerToStop(rs.getRegionServer().getServerName(),10000);
  LOG.debug("Now enabling table " + tableName);
  admin.enableTable(tableName);
  assertTrue(admin.isTableEnabled(tableName));
  JVMClusterUtil.RegionServerThread rs2=cluster.startRegionServer();
  cluster.waitForRegionServerToStart(rs2.getRegionServer().getServerName().getHostname(),rs2.getRegionServer().getServerName().getPort(),60000);
  List<HRegionInfo> regions=TEST_UTIL.getHBaseAdmin().getTableRegions(tableName);
  assertEquals(1,regions.size());
  for (  HRegionInfo region : regions) {
    TEST_UTIL.getHBaseAdmin().assign(region.getEncodedNameAsBytes());
  }
  LOG.debug("Waiting for table assigned " + tableName);
  TEST_UTIL.waitUntilAllRegionsAssigned(tableName);
  List<HRegionInfo> onlineRegions=admin.getOnlineRegions(rs2.getRegionServer().getServerName());
  ArrayList<HRegionInfo> tableRegions=filterTableRegions(tableName,onlineRegions);
  assertEquals(1,tableRegions.size());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * We were only clearing rows that had a hregioninfo column in hbase:meta.  Mangled rows that
 * were missing the hregioninfo because of error were being left behind messing up any
 * subsequent table made with the same name. HBASE-12980
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=60000) public void testDeleteForSureClearsAllTableRowsFromMeta() throws IOException, InterruptedException {
  final TableName tableName=TableName.valueOf("testDeleteForSureClearsAllTableRowsFromMeta");
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(FAMILYNAME));
  try {
    createTable(TEST_UTIL,desc,HBaseTestingUtility.KEYS_FOR_HBA_CREATE_TABLE);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Got an exception while creating " + tableName);
  }
  try (Table metaTable=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME)){
    try (ResultScanner scanner=metaTable.getScanner(MetaTableAccessor.getScanForTableName(TEST_UTIL.getConnection(),tableName))){
      for (      Result result : scanner) {
        Delete d=new Delete(result.getRow());
        d.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER);
        LOG.info("Mangled: " + d);
        metaTable.delete(d);
        break;
      }
    }
     admin.disableTable(tableName);
    TEST_UTIL.waitTableDisabled(tableName.getName());
    try {
      deleteTable(TEST_UTIL,tableName);
    }
 catch (    Exception e) {
      e.printStackTrace();
      fail("Got an exception while deleting " + tableName);
    }
    int rowCount=0;
    try (ResultScanner scanner=metaTable.getScanner(MetaTableAccessor.getScanForTableName(TEST_UTIL.getConnection(),tableName))){
      for (      Result result : scanner) {
        LOG.info("Found when none expected: " + result);
        rowCount++;
      }
    }
     assertEquals(0,rowCount);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.handler.TestTableDeleteFamilyHandler </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteColumnFamilyTwice() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor beforehtd=admin.getTableDescriptor(TABLENAME);
  String cfToDelete="cf1";
  FileSystem fs=TEST_UTIL.getDFSCluster().getFileSystem();
  assertTrue(admin.isTableAvailable(TABLENAME));
  HColumnDescriptor[] families=beforehtd.getColumnFamilies();
  Boolean foundCF=false;
  int i;
  for (i=0; i < families.length; i++) {
    if (families[i].getNameAsString().equals(cfToDelete)) {
      foundCF=true;
      break;
    }
  }
  assertTrue(foundCF);
  Path tableDir=FSUtils.getTableDir(TEST_UTIL.getDefaultRootDirPath(),TABLENAME);
  assertTrue(fs.exists(tableDir));
  FileStatus[] fileStatus=fs.listStatus(tableDir);
  foundCF=false;
  for (i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (p.getName().contains(HConstants.RECOVERED_EDITS_DIR)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true && cf[j].getPath().getName().equals(cfToDelete)) {
          foundCF=true;
          break;
        }
      }
    }
    if (foundCF) {
      break;
    }
  }
  assertTrue(foundCF);
  if (admin.isTableEnabled(TABLENAME)) {
    admin.disableTable(TABLENAME);
  }
  admin.deleteColumnFamily(TABLENAME,Bytes.toBytes(cfToDelete));
  fileStatus=fs.listStatus(tableDir);
  for (i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (WALSplitter.isSequenceIdFile(p)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true) {
          assertFalse(cf[j].getPath().getName().equals(cfToDelete));
        }
      }
    }
  }
  try {
    admin.deleteColumnFamily(TABLENAME,Bytes.toBytes(cfToDelete));
    Assert.fail("Delete a non-exist column family should fail");
  }
 catch (  InvalidFamilyOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteColumnFamilyWithMultipleRegions() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor beforehtd=admin.getTableDescriptor(TABLENAME);
  FileSystem fs=TEST_UTIL.getDFSCluster().getFileSystem();
  assertTrue(admin.isTableAvailable(TABLENAME));
  assertEquals(3,beforehtd.getColumnFamilies().length);
  HColumnDescriptor[] families=beforehtd.getColumnFamilies();
  for (int i=0; i < families.length; i++) {
    assertTrue(families[i].getNameAsString().equals("cf" + (i + 1)));
  }
  Path tableDir=FSUtils.getTableDir(TEST_UTIL.getDefaultRootDirPath(),TABLENAME);
  assertTrue(fs.exists(tableDir));
  FileStatus[] fileStatus=fs.listStatus(tableDir);
  for (int i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (p.getName().contains(HConstants.RECOVERED_EDITS_DIR)) {
            return false;
          }
          return true;
        }
      }
);
      int k=1;
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true && cf[j].getPath().getName().startsWith(".") == false) {
          assertEquals(cf[j].getPath().getName(),"cf" + k);
          k++;
        }
      }
    }
  }
  admin.disableTable(TABLENAME);
  admin.deleteColumnFamily(TABLENAME,Bytes.toBytes("cf2"));
  HTableDescriptor afterhtd=admin.getTableDescriptor(TABLENAME);
  assertEquals(2,afterhtd.getColumnFamilies().length);
  HColumnDescriptor[] newFamilies=afterhtd.getColumnFamilies();
  assertTrue(newFamilies[0].getNameAsString().equals("cf1"));
  assertTrue(newFamilies[1].getNameAsString().equals("cf3"));
  fileStatus=fs.listStatus(tableDir);
  for (int i=0; i < fileStatus.length; i++) {
    if (fileStatus[i].isDirectory() == true) {
      FileStatus[] cf=fs.listStatus(fileStatus[i].getPath(),new PathFilter(){
        @Override public boolean accept(        Path p){
          if (WALSplitter.isSequenceIdFile(p)) {
            return false;
          }
          return true;
        }
      }
);
      for (int j=0; j < cf.length; j++) {
        if (cf[j].isDirectory() == true) {
          assertFalse(cf[j].getPath().getName().equals("cf2"));
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.normalizer.TestSimpleRegionNormalizer </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitOfLargeRegion() throws HBaseIOException {
  TableName testTable=TableName.valueOf("testSplitOfLargeRegion");
  List<HRegionInfo> hris=new ArrayList<>();
  Map<byte[],Integer> regionSizes=new HashMap<>();
  HRegionInfo hri1=new HRegionInfo(testTable,Bytes.toBytes("aaa"),Bytes.toBytes("bbb"));
  hris.add(hri1);
  regionSizes.put(hri1.getRegionName(),8);
  HRegionInfo hri2=new HRegionInfo(testTable,Bytes.toBytes("bbb"),Bytes.toBytes("ccc"));
  hris.add(hri2);
  regionSizes.put(hri2.getRegionName(),6);
  HRegionInfo hri3=new HRegionInfo(testTable,Bytes.toBytes("ccc"),Bytes.toBytes("ddd"));
  hris.add(hri3);
  regionSizes.put(hri3.getRegionName(),10);
  HRegionInfo hri4=new HRegionInfo(testTable,Bytes.toBytes("ddd"),Bytes.toBytes("eee"));
  hris.add(hri4);
  regionSizes.put(hri4.getRegionName(),30);
  setupMocksForNormalizer(regionSizes,hris);
  List<NormalizationPlan> plans=normalizer.computePlanForTable(testTable);
  NormalizationPlan plan=plans.get(0);
  assertTrue(plan instanceof SplitNormalizationPlan);
  assertEquals(hri4,((SplitNormalizationPlan)plan).getRegionInfo());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeOfSecondSmallestRegions() throws HBaseIOException {
  TableName testTable=TableName.valueOf("testMergeOfSmallRegions");
  List<HRegionInfo> hris=new ArrayList<>();
  Map<byte[],Integer> regionSizes=new HashMap<>();
  HRegionInfo hri1=new HRegionInfo(testTable,Bytes.toBytes("aaa"),Bytes.toBytes("bbb"));
  hris.add(hri1);
  regionSizes.put(hri1.getRegionName(),1);
  HRegionInfo hri2=new HRegionInfo(testTable,Bytes.toBytes("bbb"),Bytes.toBytes("ccc"));
  hris.add(hri2);
  regionSizes.put(hri2.getRegionName(),10000);
  HRegionInfo hri3=new HRegionInfo(testTable,Bytes.toBytes("ccc"),Bytes.toBytes("ddd"));
  hris.add(hri3);
  regionSizes.put(hri3.getRegionName(),10000);
  HRegionInfo hri4=new HRegionInfo(testTable,Bytes.toBytes("ddd"),Bytes.toBytes("eee"));
  hris.add(hri4);
  regionSizes.put(hri4.getRegionName(),10000);
  HRegionInfo hri5=new HRegionInfo(testTable,Bytes.toBytes("eee"),Bytes.toBytes("fff"));
  hris.add(hri5);
  regionSizes.put(hri5.getRegionName(),2700);
  HRegionInfo hri6=new HRegionInfo(testTable,Bytes.toBytes("fff"),Bytes.toBytes("ggg"));
  hris.add(hri6);
  regionSizes.put(hri6.getRegionName(),2700);
  setupMocksForNormalizer(regionSizes,hris);
  List<NormalizationPlan> plans=normalizer.computePlanForTable(testTable);
  NormalizationPlan plan=plans.get(0);
  assertTrue(plan instanceof MergeNormalizationPlan);
  assertEquals(hri5,((MergeNormalizationPlan)plan).getFirstRegion());
  assertEquals(hri6,((MergeNormalizationPlan)plan).getSecondRegion());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeOfSmallRegions() throws HBaseIOException {
  TableName testTable=TableName.valueOf("testMergeOfSmallRegions");
  List<HRegionInfo> hris=new ArrayList<>();
  Map<byte[],Integer> regionSizes=new HashMap<>();
  HRegionInfo hri1=new HRegionInfo(testTable,Bytes.toBytes("aaa"),Bytes.toBytes("bbb"));
  hris.add(hri1);
  regionSizes.put(hri1.getRegionName(),15);
  HRegionInfo hri2=new HRegionInfo(testTable,Bytes.toBytes("bbb"),Bytes.toBytes("ccc"));
  hris.add(hri2);
  regionSizes.put(hri2.getRegionName(),5);
  HRegionInfo hri3=new HRegionInfo(testTable,Bytes.toBytes("ccc"),Bytes.toBytes("ddd"));
  hris.add(hri3);
  regionSizes.put(hri3.getRegionName(),5);
  HRegionInfo hri4=new HRegionInfo(testTable,Bytes.toBytes("ddd"),Bytes.toBytes("eee"));
  hris.add(hri4);
  regionSizes.put(hri4.getRegionName(),15);
  HRegionInfo hri5=new HRegionInfo(testTable,Bytes.toBytes("eee"),Bytes.toBytes("fff"));
  hris.add(hri5);
  regionSizes.put(hri5.getRegionName(),16);
  setupMocksForNormalizer(regionSizes,hris);
  List<NormalizationPlan> plans=normalizer.computePlanForTable(testTable);
  NormalizationPlan plan=plans.get(0);
  assertTrue(plan instanceof MergeNormalizationPlan);
  assertEquals(hri2,((MergeNormalizationPlan)plan).getFirstRegion());
  assertEquals(hri3,((MergeNormalizationPlan)plan).getSecondRegion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDeleteTableProcedure </h4><pre class="type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,false);
  assertTrue("expected executor to be running",procExec.isRunning());
  nonceGroup=MasterProcedureTestingUtility.generateNonceGroup(UTIL.getHBaseCluster().getMaster());
  nonce=MasterProcedureTestingUtility.generateNonce(UTIL.getHBaseCluster().getMaster());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDisableTableProcedure </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testDisableTableMultipleTimes() throws Exception {
  final TableName tableName=TableName.valueOf("testDisableTableMultipleTimes");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2");
  long procId1=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId1);
  MasterProcedureTestingUtility.validateTableIsDisabled(UTIL.getHBaseCluster().getMaster(),tableName);
  long procId2=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup + 1,nonce + 1);
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  ProcedureInfo result=procExec.getResult(procId2);
  assertTrue(result.isFailed());
  LOG.debug("Disable failed with exception: " + result.getExceptionFullMessage());
  assertTrue(ProcedureTestingUtility.getExceptionCause(result) instanceof TableNotEnabledException);
  try {
    final ProcedurePrepareLatch prepareLatch=new ProcedurePrepareLatch.CompatibilityLatch();
    long procId3=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,false,prepareLatch),nonceGroup + 2,nonce + 2);
    prepareLatch.await();
    Assert.fail("Disable should throw exception through latch.");
  }
 catch (  TableNotEnabledException tnee) {
    LOG.debug("Disable failed with expected exception.");
  }
  long procId4=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,true));
  ProcedureTestingUtility.waitProcedure(procExec,procId4);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId4);
  MasterProcedureTestingUtility.validateTableIsDisabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestEnableTableProcedure </h4><pre class="type-11 type-7 type-8 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000,expected=TableNotDisabledException.class) public void testEnableNonDisabledTable() throws Exception {
  final TableName tableName=TableName.valueOf("testEnableNonExistingTable");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2");
  long procId1=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureInfo result=procExec.getResult(procId1);
  assertTrue(result.isFailed());
  LOG.debug("Enable failed with exception: " + result.getExceptionFullMessage());
  assertTrue(ProcedureTestingUtility.getExceptionCause(result) instanceof TableNotDisabledException);
  long procId2=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,true),nonceGroup + 1,nonce + 1);
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId2);
  final ProcedurePrepareLatch prepareLatch=new ProcedurePrepareLatch.CompatibilityLatch();
  long procId3=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,false,prepareLatch),nonceGroup + 2,nonce + 2);
  prepareLatch.await();
  Assert.fail("Enable should throw exception through latch.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestMasterProcedureEvents </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerCrashProcedureEvent() throws Exception {
  TableName tableName=TableName.valueOf("testServerCrashProcedureEventTb");
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  ProcedureExecutor<MasterProcedureEnv> procExec=master.getMasterProcedureExecutor();
  MasterProcedureScheduler procSched=procExec.getEnvironment().getProcedureQueue();
  while (!master.isServerCrashProcessingEnabled() || !master.isInitialized() || master.getAssignmentManager().getRegionStates().isRegionsInTransition()) {
    Thread.sleep(25);
  }
  UTIL.createTable(tableName,HBaseTestingUtility.COLUMNS[0]);
  try (Table t=UTIL.getConnection().getTable(tableName)){
    UTIL.loadTable(t,HBaseTestingUtility.COLUMNS[0]);
  }
   master.setServerCrashProcessingEnabled(false);
  long pollCalls=procSched.getPollCalls();
  long nullPollCalls=procSched.getNullPollCalls();
  HRegionServer hrs=getServerWithRegions();
  boolean carryingMeta=master.getAssignmentManager().isCarryingMeta(hrs.getServerName());
  UTIL.getHBaseCluster().killRegionServer(hrs.getServerName());
  hrs.join();
  while (!master.getServerManager().isServerDead(hrs.getServerName()))   Thread.sleep(10);
  master.getServerManager().moveFromOnelineToDeadServers(hrs.getServerName());
  long procId=procExec.submitProcedure(new ServerCrashProcedure(hrs.getServerName(),true,carryingMeta));
  for (int i=0; i < 10; ++i) {
    Thread.sleep(100);
    assertEquals(pollCalls + 1,procSched.getPollCalls());
    assertEquals(nullPollCalls,procSched.getNullPollCalls());
  }
  master.setServerCrashProcessingEnabled(true);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  LOG.debug("server crash processing poll calls: " + procSched.getPollCalls());
  assertTrue(procSched.getPollCalls() >= (pollCalls + 2));
  assertEquals(nullPollCalls,procSched.getNullPollCalls());
  UTIL.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestMasterProcedureScheduler </h4><pre class="type-3 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws IOException {
  assertEquals(0,queue.size());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the correct logic of RWLocks on the queue
 */
@Test public void testVerifyRwLocks() throws Exception {
  TableName tableName=TableName.valueOf("testtb");
  queue.addBack(new TestTableProcedure(1,tableName,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(2,tableName,TableProcedureInterface.TableOperationType.READ));
  queue.addBack(new TestTableProcedure(3,tableName,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(4,tableName,TableProcedureInterface.TableOperationType.READ));
  queue.addBack(new TestTableProcedure(5,tableName,TableProcedureInterface.TableOperationType.READ));
  Procedure proc=queue.poll();
  assertEquals(1,proc.getProcId());
  assertEquals(true,queue.tryAcquireTableExclusiveLock(proc,tableName));
  assertEquals(null,queue.poll(0));
  queue.releaseTableExclusiveLock(proc,tableName);
  Procedure rdProc=queue.poll();
  assertEquals(2,rdProc.getProcId());
  assertEquals(true,queue.tryAcquireTableSharedLock(rdProc,tableName));
  Procedure wrProc=queue.poll();
  assertEquals(3,wrProc.getProcId());
  assertEquals(false,queue.tryAcquireTableExclusiveLock(wrProc,tableName));
  queue.releaseTableSharedLock(rdProc,tableName);
  assertEquals(true,queue.tryAcquireTableExclusiveLock(wrProc,tableName));
  assertEquals(null,queue.poll(0));
  queue.releaseTableExclusiveLock(wrProc,tableName);
  rdProc=queue.poll();
  assertEquals(4,rdProc.getProcId());
  assertEquals(true,queue.tryAcquireTableSharedLock(rdProc,tableName));
  Procedure rdProc2=queue.poll();
  assertEquals(5,rdProc2.getProcId());
  assertEquals(true,queue.tryAcquireTableSharedLock(rdProc2,tableName));
  queue.releaseTableSharedLock(rdProc,tableName);
  queue.releaseTableSharedLock(rdProc2,tableName);
  assertEquals(0,queue.size());
  assertTrue("queue should be deleted",queue.markTableAsDeleted(tableName));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the table queue is not deletable until every procedure
 * in-progress is completed (this is a special case for read-locks).
 */
@Test public void testCreateDeleteTableOperationsWithReadLock() throws Exception {
  final TableName tableName=TableName.valueOf("testtb");
  final int nitems=2;
  for (int i=1; i <= nitems; ++i) {
    queue.addBack(new TestTableProcedure(i,tableName,TableProcedureInterface.TableOperationType.READ));
  }
  assertFalse(queue.markTableAsDeleted(tableName));
  Procedure[] procs=new Procedure[nitems];
  for (int i=0; i < nitems; ++i) {
    Procedure proc=procs[i]=queue.poll();
    assertEquals(i + 1,proc.getProcId());
    assertTrue(queue.tryAcquireTableSharedLock(proc,tableName));
    assertFalse(queue.markTableAsDeleted(tableName));
  }
  for (int i=0; i < nitems; ++i) {
    assertFalse(queue.markTableAsDeleted(tableName));
    queue.releaseTableSharedLock(procs[i],tableName);
  }
  assertEquals(0,queue.size());
  assertTrue(queue.markTableAsDeleted(tableName));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the table queue is not deletable until every procedure
 * in-progress is completed (this is a special case for write-locks).
 */
@Test public void testCreateDeleteTableOperationsWithWriteLock() throws Exception {
  TableName tableName=TableName.valueOf("testtb");
  queue.addBack(new TestTableProcedure(1,tableName,TableProcedureInterface.TableOperationType.EDIT));
  assertFalse(queue.markTableAsDeleted(tableName));
  Procedure proc=queue.poll();
  assertEquals(1,proc.getProcId());
  assertTrue(queue.tryAcquireTableExclusiveLock(proc,tableName));
  assertEquals(0,queue.size());
  assertFalse(queue.markTableAsDeleted(tableName));
  queue.releaseTableExclusiveLock(proc,tableName);
  assertTrue(queue.markTableAsDeleted(tableName));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify simple create/insert/fetch/delete of the table queue.
 */
@Test public void testSimpleTableOpsQueues() throws Exception {
  final int NUM_TABLES=10;
  final int NUM_ITEMS=10;
  int count=0;
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("test-%04d",i));
    for (int j=1; j <= NUM_ITEMS; ++j) {
      queue.addBack(new TestTableProcedure(i * 1000 + j,tableName,TableProcedureInterface.TableOperationType.EDIT));
      assertEquals(++count,queue.size());
    }
  }
  assertEquals(NUM_TABLES * NUM_ITEMS,queue.size());
  for (int j=1; j <= NUM_ITEMS; ++j) {
    for (int i=1; i <= NUM_TABLES; ++i) {
      Procedure proc=queue.poll();
      assertTrue(proc != null);
      TableName tableName=((TestTableProcedure)proc).getTableName();
      queue.tryAcquireTableExclusiveLock(proc,tableName);
      queue.releaseTableExclusiveLock(proc,tableName);
      queue.completionCleanup(proc);
      assertEquals(--count,queue.size());
      assertEquals(i * 1000 + j,proc.getProcId());
    }
  }
  assertEquals(0,queue.size());
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("test-%04d",i));
    assertTrue(queue.markTableAsDeleted(tableName));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that "write" operations for a single table are serialized,
 * but different tables can be executed in parallel.
 */
@Test(timeout=90000) public void testConcurrentWriteOps() throws Exception {
  final TestTableProcSet procSet=new TestTableProcSet(queue);
  final int NUM_ITEMS=10;
  final int NUM_TABLES=4;
  final AtomicInteger opsCount=new AtomicInteger(0);
  for (int i=0; i < NUM_TABLES; ++i) {
    TableName tableName=TableName.valueOf(String.format("testtb-%04d",i));
    for (int j=1; j < NUM_ITEMS; ++j) {
      procSet.addBack(new TestTableProcedure(i * 100 + j,tableName,TableProcedureInterface.TableOperationType.EDIT));
      opsCount.incrementAndGet();
    }
  }
  assertEquals(opsCount.get(),queue.size());
  final Thread[] threads=new Thread[NUM_TABLES * 2];
  final HashSet<TableName> concurrentTables=new HashSet<TableName>();
  final ArrayList<String> failures=new ArrayList<String>();
  final AtomicInteger concurrentCount=new AtomicInteger(0);
  for (int i=0; i < threads.length; ++i) {
    threads[i]=new Thread(){
      @Override public void run(){
        while (opsCount.get() > 0) {
          try {
            Procedure proc=procSet.acquire();
            if (proc == null) {
              queue.signalAll();
              if (opsCount.get() > 0) {
                continue;
              }
              break;
            }
            TableName tableId=procSet.getTableName(proc);
synchronized (concurrentTables) {
              assertTrue("unexpected concurrency on " + tableId,concurrentTables.add(tableId));
            }
            assertTrue(opsCount.decrementAndGet() >= 0);
            try {
              long procId=proc.getProcId();
              int concurrent=concurrentCount.incrementAndGet();
              assertTrue("inc-concurrent=" + concurrent + " 1 <= concurrent <= "+ NUM_TABLES,concurrent >= 1 && concurrent <= NUM_TABLES);
              LOG.debug("[S] tableId=" + tableId + " procId="+ procId+ " concurrent="+ concurrent);
              Thread.sleep(2000);
              concurrent=concurrentCount.decrementAndGet();
              LOG.debug("[E] tableId=" + tableId + " procId="+ procId+ " concurrent="+ concurrent);
              assertTrue("dec-concurrent=" + concurrent,concurrent < NUM_TABLES);
            }
  finally {
synchronized (concurrentTables) {
                assertTrue(concurrentTables.remove(tableId));
              }
              procSet.release(proc);
            }
          }
 catch (          Throwable e) {
            LOG.error("Failed " + e.getMessage(),e);
synchronized (failures) {
              failures.add(e.getMessage());
            }
          }
 finally {
            queue.signalAll();
          }
        }
      }
    }
;
    threads[i].start();
  }
  for (int i=0; i < threads.length; ++i) {
    threads[i].join();
  }
  assertTrue(failures.toString(),failures.isEmpty());
  assertEquals(0,opsCount.get());
  assertEquals(0,queue.size());
  for (int i=1; i <= NUM_TABLES; ++i) {
    TableName table=TableName.valueOf(String.format("testtb-%04d",i));
    assertTrue("queue should be deleted, table=" + table,queue.markTableAsDeleted(table));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestModifyNamespaceProcedure </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testModifyNamespace() throws Exception {
  final NamespaceDescriptor nsd=NamespaceDescriptor.create("testModifyNamespace").build();
  final String nsKey1="hbase.namespace.quota.maxregions";
  final String nsValue1before="1111";
  final String nsValue1after="9999";
  final String nsKey2="hbase.namespace.quota.maxtables";
  final String nsValue2="10";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  nsd.setConfiguration(nsKey1,nsValue1before);
  createNamespaceForTesting(nsd);
  NamespaceDescriptor currentNsDescriptor=UTIL.getHBaseAdmin().getNamespaceDescriptor(nsd.getName());
  assertEquals(currentNsDescriptor.getConfigurationValue(nsKey1),nsValue1before);
  assertNull(currentNsDescriptor.getConfigurationValue(nsKey2));
  nsd.setConfiguration(nsKey1,nsValue1after);
  nsd.setConfiguration(nsKey2,nsValue2);
  long procId1=procExec.submitProcedure(new ModifyNamespaceProcedure(procExec.getEnvironment(),nsd),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId1);
  currentNsDescriptor=UTIL.getHBaseAdmin().getNamespaceDescriptor(nsd.getName());
  assertEquals(nsd.getConfigurationValue(nsKey1),nsValue1after);
  assertEquals(currentNsDescriptor.getConfigurationValue(nsKey2),nsValue2);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testModifyNonExistNamespace() throws Exception {
  final String namespaceName="testModifyNonExistNamespace";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  try {
    NamespaceDescriptor nsDescriptor=UTIL.getHBaseAdmin().getNamespaceDescriptor(namespaceName);
    assertNull(nsDescriptor);
  }
 catch (  NamespaceNotFoundException nsnfe) {
    LOG.debug("The namespace " + namespaceName + " does not exist.  This is expected.");
  }
  final NamespaceDescriptor nsd=NamespaceDescriptor.create(namespaceName).build();
  long procId=procExec.submitProcedure(new ModifyNamespaceProcedure(procExec.getEnvironment(),nsd),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureInfo result=procExec.getResult(procId);
  assertTrue(result.isFailed());
  LOG.debug("modify namespace failed with exception: " + result.getExceptionFullMessage());
  assertTrue(ProcedureTestingUtility.getExceptionCause(result) instanceof NamespaceNotFoundException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestModifyTableProcedure </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testModifyTableAddCF() throws Exception {
  final TableName tableName=TableName.valueOf("testModifyTableAddCF");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"cf1");
  HTableDescriptor currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(1,currentHtd.getFamiliesKeys().size());
  String cf2="cf2";
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  htd.addFamily(new HColumnDescriptor(cf2));
  long procId=ProcedureTestingUtility.submitAndWait(procExec,new ModifyTableProcedure(procExec.getEnvironment(),htd));
  ProcedureTestingUtility.assertProcNotFailed(procExec.getResult(procId));
  currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(2,currentHtd.getFamiliesKeys().size());
  assertTrue(currentHtd.hasFamily(cf2.getBytes()));
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  String cf3="cf3";
  HTableDescriptor htd2=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  htd2.addFamily(new HColumnDescriptor(cf3));
  long procId2=ProcedureTestingUtility.submitAndWait(procExec,new ModifyTableProcedure(procExec.getEnvironment(),htd2));
  ProcedureTestingUtility.assertProcNotFailed(procExec.getResult(procId2));
  currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertTrue(currentHtd.hasFamily(cf3.getBytes()));
  assertEquals(3,currentHtd.getFamiliesKeys().size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOnline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOnline");
  final String cf2="cf2";
  final String cf3="cf3";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,"cf1",cf3);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  boolean newCompactionEnableOption=htd.isCompactionEnabled() ? false : true;
  htd.setCompactionEnabled(newCompactionEnableOption);
  htd.addFamily(new HColumnDescriptor(cf2));
  htd.removeFamily(cf3.getBytes());
  long procId=procExec.submitProcedure(new ModifyTableProcedure(procExec.getEnvironment(),htd),nonceGroup,nonce);
  int numberOfSteps=ModifyTableState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,ModifyTableState.values());
  HTableDescriptor currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(newCompactionEnableOption,currentHtd.isCompactionEnabled());
  assertEquals(2,currentHtd.getFamiliesKeys().size());
  assertTrue(currentHtd.hasFamily(cf2.getBytes()));
  assertFalse(currentHtd.hasFamily(cf3.getBytes()));
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,"cf1",cf2);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testModifyTableDeleteCF() throws Exception {
  final TableName tableName=TableName.valueOf("testModifyTableAddCF");
  final String cf2="cf2";
  final String cf3="cf3";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"cf1",cf2,cf3);
  HTableDescriptor currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(3,currentHtd.getFamiliesKeys().size());
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  htd.removeFamily(cf2.getBytes());
  long procId=ProcedureTestingUtility.submitAndWait(procExec,new ModifyTableProcedure(procExec.getEnvironment(),htd));
  ProcedureTestingUtility.assertProcNotFailed(procExec.getResult(procId));
  currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(2,currentHtd.getFamiliesKeys().size());
  assertFalse(currentHtd.hasFamily(cf2.getBytes()));
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  HTableDescriptor htd2=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  htd2.removeFamily(cf3.getBytes());
  long procId2=ProcedureTestingUtility.submitAndWait(procExec,new ModifyTableProcedure(procExec.getEnvironment(),htd2));
  ProcedureTestingUtility.assertProcNotFailed(procExec.getResult(procId2));
  currentHtd=UTIL.getHBaseAdmin().getTableDescriptor(tableName);
  assertEquals(1,currentHtd.getFamiliesKeys().size());
  assertFalse(currentHtd.hasFamily(cf3.getBytes()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestProcedureAdmin </h4><pre class="type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,false);
  assertTrue("expected executor to be running",procExec.isRunning());
  nonceGroup=MasterProcedureTestingUtility.generateNonceGroup(UTIL.getHBaseCluster().getMaster());
  nonce=MasterProcedureTestingUtility.generateNonce(UTIL.getHBaseCluster().getMaster());
}

</code></pre>

<br>
<pre class="type-3 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  assertTrue("expected executor to be running",getMasterProcedureExecutor().isRunning());
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(getMasterProcedureExecutor(),false);
  for (  HTableDescriptor htd : UTIL.getHBaseAdmin().listTables()) {
    LOG.info("Tear down, remove table=" + htd.getTableName());
    UTIL.deleteTable(htd.getTableName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestTruncateTableProcedure </h4><pre class="type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,false);
  assertTrue("expected executor to be running",procExec.isRunning());
  nonceGroup=MasterProcedureTestingUtility.generateNonceGroup(UTIL.getHBaseCluster().getMaster());
  nonce=MasterProcedureTestingUtility.generateNonce(UTIL.getHBaseCluster().getMaster());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testWalAbortOnLowReplicationWithQueuedWriters() throws Exception {
  initConfig(UTIL.getConfiguration());
  setup();
  try {
    assertEquals(3,UTIL.getDFSCluster().getDataNodes().size());
    store.registerListener(new ProcedureStore.ProcedureStoreListener(){
      @Override public void postSync(){
        Threads.sleepWithoutInterrupt(2000);
      }
      @Override public void abortProcess(){
      }
    }
);
    final AtomicInteger reCount=new AtomicInteger(0);
    Thread[] thread=new Thread[store.getNumThreads() * 2 + 1];
    for (int i=0; i < thread.length; ++i) {
      final long procId=i + 1;
      thread[i]=new Thread(){
        public void run(){
          try {
            LOG.debug("[S] INSERT " + procId);
            store.insert(new TestProcedure(procId,-1),null);
            LOG.debug("[E] INSERT " + procId);
          }
 catch (          RuntimeException e) {
            reCount.incrementAndGet();
            LOG.debug("[F] INSERT " + procId + ": "+ e.getMessage());
          }
        }
      }
;
      thread[i].start();
    }
    Thread.sleep(1000);
    LOG.info("Stop DataNode");
    UTIL.getDFSCluster().stopDataNode(0);
    assertEquals(2,UTIL.getDFSCluster().getDataNodes().size());
    for (int i=0; i < thread.length; ++i) {
      thread[i].join();
    }
    assertFalse(store.isRunning());
    assertTrue(reCount.toString(),reCount.get() >= store.getNumThreads() && reCount.get() < thread.length);
  }
  finally {
    tearDown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-7 type-8 type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000,expected=RuntimeException.class) public void testWalAbortOnLowReplication() throws Exception {
  initConfig(UTIL.getConfiguration());
  setup();
  try {
    assertEquals(3,UTIL.getDFSCluster().getDataNodes().size());
    LOG.info("Stop DataNode");
    UTIL.getDFSCluster().stopDataNode(0);
    assertEquals(2,UTIL.getDFSCluster().getDataNodes().size());
    store.insert(new TestProcedure(1,-1),null);
    for (long i=2; store.isRunning(); ++i) {
      assertEquals(2,UTIL.getDFSCluster().getDataNodes().size());
      store.insert(new TestProcedure(i,-1),null);
      Thread.sleep(100);
    }
    assertFalse(store.isRunning());
    fail("The store.insert() should throw an exeption");
  }
  finally {
    tearDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.snapshot.TestSnapshotFileCache </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWeNeverCacheTmpDirAndLoadIt() throws Exception {
  final AtomicInteger count=new AtomicInteger(0);
  long period=Long.MAX_VALUE;
  SnapshotFileCache cache=new SnapshotFileCache(fs,rootDir,period,10000000,"test-snapshot-file-cache-refresh",new SnapshotFiles()){
    @Override List<String> getSnapshotsInProgress() throws IOException {
      List<String> result=super.getSnapshotsInProgress();
      count.incrementAndGet();
      return result;
    }
    @Override public void triggerCacheRefreshForTesting(){
      super.triggerCacheRefreshForTesting();
    }
  }
;
  SnapshotMock.SnapshotBuilder complete=createAndTestSnapshotV1(cache,"snapshot",false,false);
  SnapshotMock.SnapshotBuilder inProgress=createAndTestSnapshotV1(cache,"snapshotInProgress",true,false);
  int countBeforeCheck=count.get();
  FSUtils.logFileSystemState(fs,rootDir,LOG);
  List<FileStatus> allStoreFiles=getStoreFilesForSnapshot(complete);
  Iterable<FileStatus> deletableFiles=cache.getUnreferencedFiles(allStoreFiles);
  assertTrue(Iterables.isEmpty(deletableFiles));
  assertEquals(0,count.get() - countBeforeCheck);
  FileStatus randomFile=mockStoreFile(UUID.randomUUID().toString());
  allStoreFiles.add(randomFile);
  deletableFiles=cache.getUnreferencedFiles(allStoreFiles);
  assertEquals(randomFile,Iterables.getOnlyElement(deletableFiles));
  assertEquals(1,count.get() - countBeforeCheck);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.snapshot.TestSnapshotManager </h4><pre class="type-4 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the snapshot support based on the configuration.
 */
@Test public void testSnapshotSupportConfiguration() throws Exception {
  Configuration conf=new Configuration();
  SnapshotManager manager=getNewManager(conf);
  assertFalse("Snapshot should be disabled with no configuration",isSnapshotSupported(manager));
  conf=new Configuration();
  conf.setBoolean(SnapshotManager.HBASE_SNAPSHOT_ENABLED,true);
  manager=getNewManager(conf);
  assertTrue("Snapshot should be enabled",isSnapshotSupported(manager));
  conf=new Configuration();
  conf.setBoolean(SnapshotManager.HBASE_SNAPSHOT_ENABLED,false);
  manager=getNewManager(conf);
  assertFalse("Snapshot should be disabled",isSnapshotSupported(manager));
  conf=new Configuration();
  conf.setStrings(HFileCleaner.MASTER_HFILE_CLEANER_PLUGINS,SnapshotHFileCleaner.class.getName(),HFileLinkCleaner.class.getName());
  conf.setBoolean(SnapshotManager.HBASE_SNAPSHOT_ENABLED,false);
  manager=getNewManager(conf);
  assertFalse("Snapshot should be disabled",isSnapshotSupported(manager));
  conf=new Configuration();
  conf.setStrings(HFileCleaner.MASTER_HFILE_CLEANER_PLUGINS,SnapshotHFileCleaner.class.getName(),HFileLinkCleaner.class.getName());
  manager=getNewManager(conf);
  assertTrue("Snapshot should be enabled, because cleaners are present",isSnapshotSupported(manager));
  Path rootDir=UTIL.getDataTestDir();
  Path testSnapshotDir=SnapshotDescriptionUtils.getCompletedSnapshotDir("testSnapshotSupportConfiguration",rootDir);
  fs.mkdirs(testSnapshotDir);
  try {
    conf=new Configuration();
    conf.setBoolean(SnapshotManager.HBASE_SNAPSHOT_ENABLED,false);
    manager=getNewManager(conf);
    fail("Master should not start when snapshot is disabled, but snapshots are present");
  }
 catch (  UnsupportedOperationException e) {
  }
 finally {
    fs.delete(testSnapshotDir,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.TestMobFile </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetScanner() throws Exception {
  Path testDir=TEST_UTIL.getDataTestDir();
  FileSystem fs=testDir.getFileSystem(conf);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,fs).withOutputDir(testDir).withFileContext(meta).build();
  MobTestUtil.writeStoreFile(writer,getName());
  MobFile mobFile=new MobFile(new StoreFile(fs,writer.getPath(),conf,cacheConf,BloomType.NONE));
  assertNotNull(mobFile.getScanner());
  assertTrue(mobFile.getScanner() instanceof StoreFileScanner);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.TestMobFileCache </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMobFileCache() throws Exception {
  FileSystem fs=FileSystem.get(conf);
  conf.set(MobConstants.MOB_FILE_CACHE_SIZE_KEY,TEST_CACHE_SIZE);
  mobFileCache=new MobFileCache(conf);
  Path file1Path=createMobStoreFile(FAMILY1);
  Path file2Path=createMobStoreFile(FAMILY2);
  Path file3Path=createMobStoreFile(FAMILY3);
  assertEquals(EXPECTED_CACHE_SIZE_ZERO,mobFileCache.getCacheSize());
  CachedMobFile cachedMobFile1=(CachedMobFile)mobFileCache.openFile(fs,file1Path,mobCacheConf);
  assertEquals(EXPECTED_CACHE_SIZE_ONE,mobFileCache.getCacheSize());
  assertNotNull(cachedMobFile1);
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile1.getReferenceCount());
  mobFileCache.evict();
  assertEquals(EXPECTED_CACHE_SIZE_ONE,mobFileCache.getCacheSize());
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile1.getReferenceCount());
  mobFileCache.evictFile(file1Path.getName());
  assertEquals(EXPECTED_CACHE_SIZE_ZERO,mobFileCache.getCacheSize());
  assertEquals(EXPECTED_REFERENCE_ONE,cachedMobFile1.getReferenceCount());
  cachedMobFile1.close();
  cachedMobFile1=(CachedMobFile)mobFileCache.openFile(fs,file1Path,mobCacheConf);
  assertEquals(EXPECTED_CACHE_SIZE_ONE,mobFileCache.getCacheSize());
  CachedMobFile cachedMobFile2=(CachedMobFile)mobFileCache.openFile(fs,file2Path,mobCacheConf);
  assertEquals(EXPECTED_CACHE_SIZE_TWO,mobFileCache.getCacheSize());
  CachedMobFile cachedMobFile3=(CachedMobFile)mobFileCache.openFile(fs,file3Path,mobCacheConf);
  assertEquals(EXPECTED_CACHE_SIZE_THREE,mobFileCache.getCacheSize());
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile1.getReferenceCount());
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile2.getReferenceCount());
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile3.getReferenceCount());
  mobFileCache.evict();
  assertEquals(EXPECTED_CACHE_SIZE_ONE,mobFileCache.getCacheSize());
  assertEquals(EXPECTED_REFERENCE_ONE,cachedMobFile1.getReferenceCount());
  assertEquals(EXPECTED_REFERENCE_ONE,cachedMobFile2.getReferenceCount());
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile3.getReferenceCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.TestMobFileName </h4><pre class="type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashCode(){
  assertEquals(MobFileName.create(startKey,dateStr,uuid).hashCode(),MobFileName.create(startKey,dateStr,uuid).hashCode());
  assertNotSame(MobFileName.create(startKey,dateStr,uuid).hashCode(),MobFileName.create(startKey,dateStr,uuid).hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.compactions.TestMobCompactor </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testMajorCompactionFromAdmin() throws Exception {
  resetConf();
  int mergeSize=5000;
  conf.setLong(MobConstants.MOB_COMPACTION_MERGEABLE_THRESHOLD,mergeSize);
  String tableNameAsString="testMajorCompactionFromAdmin";
  SecureRandom rng=new SecureRandom();
  byte[] keyBytes=new byte[AES.KEY_LENGTH];
  rng.nextBytes(keyBytes);
  String algorithm=conf.get(HConstants.CRYPTO_KEY_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  Key cfKey=new SecretKeySpec(keyBytes,algorithm);
  byte[] encryptionKey=EncryptionUtil.wrapKey(conf,conf.get(HConstants.CRYPTO_MASTERKEY_NAME_CONF_KEY,User.getCurrent().getShortName()),cfKey);
  TableName tableName=TableName.valueOf(tableNameAsString);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  HColumnDescriptor hcd1=new HColumnDescriptor(family1);
  hcd1.setMobEnabled(true);
  hcd1.setMobThreshold(0);
  hcd1.setEncryptionType(algorithm);
  hcd1.setEncryptionKey(encryptionKey);
  HColumnDescriptor hcd2=new HColumnDescriptor(family2);
  hcd2.setMobEnabled(true);
  hcd2.setMobThreshold(0);
  desc.addFamily(hcd1);
  desc.addFamily(hcd2);
  admin.createTable(desc,getSplitKeys());
  Table table=conn.getTable(tableName);
  BufferedMutator bufMut=conn.getBufferedMutator(tableName);
  int count=4;
  loadData(admin,bufMut,tableName,count,rowNumPerFile);
  int rowNumPerRegion=count * rowNumPerFile;
  assertEquals("Before deleting: mob rows count",regionNum * rowNumPerRegion,countMobRows(table));
  assertEquals("Before deleting: mob cells count",regionNum * cellNumPerRow * rowNumPerRegion,countMobCells(table));
  assertEquals("Before deleting: mob file count",regionNum * count,countFiles(tableName,true,family1));
  createDelFile(table,tableName,Bytes.toBytes(family1),Bytes.toBytes(qf1));
  assertEquals("Before compaction: mob rows count",regionNum * (rowNumPerRegion - delRowNum),countMobRows(table));
  assertEquals("Before compaction: mob cells count",regionNum * (cellNumPerRow * rowNumPerRegion - delCellNum),countMobCells(table));
  assertEquals("Before compaction: family1 mob file count",regionNum * count,countFiles(tableName,true,family1));
  assertEquals("Before compaction: family2 mob file count",regionNum * count,countFiles(tableName,true,family2));
  assertEquals("Before compaction: family1 del file count",regionNum,countFiles(tableName,false,family1));
  assertEquals("Before compaction: family2 del file count",regionNum,countFiles(tableName,false,family2));
  admin.majorCompact(tableName,hcd1.getName(),Admin.CompactType.MOB);
  waitUntilMobCompactionFinished(tableName);
  assertEquals("After compaction: mob rows count",regionNum * (rowNumPerRegion - delRowNum),countMobRows(table));
  assertEquals("After compaction: mob cells count",regionNum * (cellNumPerRow * rowNumPerRegion - delCellNum),countMobCells(table));
  assertEquals("After compaction: family1 mob file count",regionNum,countFiles(tableName,true,family1));
  assertEquals("After compaction: family2 mob file count",regionNum * count,countFiles(tableName,true,family2));
  assertEquals("After compaction: family1 del file count",0,countFiles(tableName,false,family1));
  assertEquals("After compaction: family2 del file count",regionNum,countFiles(tableName,false,family2));
  Assert.assertTrue(verifyEncryption(tableName,family1));
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.compactions.TestPartitionedMobCompactionRequest </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactedPartitionId(){
  String startKey1="startKey1";
  String startKey2="startKey2";
  String date1="date1";
  String date2="date2";
  CompactionPartitionId partitionId1=new CompactionPartitionId(startKey1,date1);
  CompactionPartitionId partitionId2=new CompactionPartitionId(startKey2,date2);
  CompactionPartitionId partitionId3=new CompactionPartitionId(startKey1,date2);
  Assert.assertTrue(partitionId1.equals(partitionId1));
  Assert.assertFalse(partitionId1.equals(partitionId2));
  Assert.assertFalse(partitionId1.equals(partitionId3));
  Assert.assertFalse(partitionId2.equals(partitionId3));
  Assert.assertEquals(startKey1,partitionId1.getStartKey());
  Assert.assertEquals(date1,partitionId1.getDate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.monitoring.TestTaskMonitor </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTasksGetAbortedOnLeak() throws InterruptedException {
  final TaskMonitor tm=new TaskMonitor();
  assertTrue("Task monitor should start empty",tm.getTasks().isEmpty());
  final AtomicBoolean threadSuccess=new AtomicBoolean(false);
  Thread t=new Thread(){
    @Override public void run(){
      MonitoredTask task=tm.createStatus("Test task");
      assertEquals(MonitoredTask.State.RUNNING,task.getState());
      threadSuccess.set(true);
    }
  }
;
  t.start();
  t.join();
  assertTrue(threadSuccess.get());
  System.gc();
  System.gc();
  System.gc();
  MonitoredTask taskFromTm=tm.getTasks().get(0);
  assertEquals(MonitoredTask.State.ABORTED,taskFromTm.getState());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTaskMonitorBasics(){
  TaskMonitor tm=new TaskMonitor();
  assertTrue("Task monitor should start empty",tm.getTasks().isEmpty());
  MonitoredTask task=tm.createStatus("Test task");
  MonitoredTask taskFromTm=tm.getTasks().get(0);
  assertEquals(task.getDescription(),taskFromTm.getDescription());
  assertEquals(-1,taskFromTm.getCompletionTimestamp());
  assertEquals(MonitoredTask.State.RUNNING,taskFromTm.getState());
  task.markComplete("Finished!");
  assertEquals(MonitoredTask.State.COMPLETE,task.getState());
  assertEquals(1,tm.getTasks().size());
  task.expireNow();
  assertEquals(0,tm.getTasks().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.namespace.TestNamespaceAuditor </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestoreSnapshot() throws Exception {
  String nsp=prefix + "_testRestoreSnapshot";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"10").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(nsp));
  TableName tableName1=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableName1);
  ADMIN.createTable(tableDescOne,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),4);
  NamespaceTableAndRegionInfo nstate=getNamespaceState(nsp);
  assertEquals("Intial region count should be 4.",4,nstate.getRegionCount());
  String snapshot="snapshot_testRestoreSnapshot";
  ADMIN.snapshot(snapshot,tableName1);
  List<HRegionInfo> regions=ADMIN.getTableRegions(tableName1);
  Collections.sort(regions);
  ADMIN.split(tableName1,Bytes.toBytes("JJJ"));
  Thread.sleep(2000);
  assertEquals("Total regions count should be 5.",5,nstate.getRegionCount());
  ADMIN.disableTable(tableName1);
  ADMIN.restoreSnapshot(snapshot);
  assertEquals("Total regions count should be 4 after restore.",4,nstate.getRegionCount());
  ADMIN.enableTable(tableName1);
  ADMIN.deleteSnapshot(snapshot);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=QuotaExceededException.class) public void testCloneSnapshotQuotaExceed() throws Exception {
  String nsp=prefix + "_testTableQuotaExceedWithCloneSnapshot";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"1").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(nsp));
  TableName tableName=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1");
  TableName cloneTableName=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table2");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableName);
  ADMIN.createTable(tableDescOne);
  String snapshot="snapshot_testTableQuotaExceedWithCloneSnapshot";
  ADMIN.snapshot(snapshot,tableName);
  ADMIN.cloneSnapshot(snapshot,cloneTableName);
  ADMIN.deleteSnapshot(snapshot);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=QuotaExceededException.class) public void testExceedTableQuotaInNamespace() throws Exception {
  String nsp=prefix + "_testExceedTableQuotaInNamespace";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"1").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(nsp));
  assertEquals(ADMIN.listNamespaceDescriptors().length,3);
  HTableDescriptor tableDescOne=new HTableDescriptor(TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1"));
  HTableDescriptor tableDescTwo=new HTableDescriptor(TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table2"));
  ADMIN.createTable(tableDescOne);
  ADMIN.createTable(tableDescTwo,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),4);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloneSnapshot() throws Exception {
  String nsp=prefix + "_testCloneSnapshot";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"2").addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"20").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(nsp));
  TableName tableName=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1");
  TableName cloneTableName=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table2");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableName);
  ADMIN.createTable(tableDescOne,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),4);
  String snapshot="snapshot_testCloneSnapshot";
  ADMIN.snapshot(snapshot,tableName);
  ADMIN.cloneSnapshot(snapshot,cloneTableName);
  int tableLength;
  try (RegionLocator locator=ADMIN.getConnection().getRegionLocator(tableName)){
    tableLength=locator.getStartKeys().length;
  }
   assertEquals(tableName.getNameAsString() + " should have four regions.",4,tableLength);
  try (RegionLocator locator=ADMIN.getConnection().getRegionLocator(cloneTableName)){
    tableLength=locator.getStartKeys().length;
  }
   assertEquals(cloneTableName.getNameAsString() + " should have four regions.",4,tableLength);
  NamespaceTableAndRegionInfo nstate=getNamespaceState(nsp);
  assertEquals("Total tables count should be 2.",2,nstate.getTables().size());
  assertEquals("Total regions count should be.",8,nstate.getRegionCount());
  ADMIN.deleteSnapshot(snapshot);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableOperations() throws Exception {
  String nsp=prefix + "_np2";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"5").addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"2").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(nsp));
  assertEquals(ADMIN.listNamespaceDescriptors().length,3);
  HTableDescriptor tableDescOne=new HTableDescriptor(TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1"));
  HTableDescriptor tableDescTwo=new HTableDescriptor(TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table2"));
  HTableDescriptor tableDescThree=new HTableDescriptor(TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table3"));
  ADMIN.createTable(tableDescOne);
  boolean constraintViolated=false;
  try {
    ADMIN.createTable(tableDescTwo,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),5);
  }
 catch (  Exception exp) {
    assertTrue(exp instanceof IOException);
    constraintViolated=true;
  }
 finally {
    assertTrue("Constraint not violated for table " + tableDescTwo.getTableName(),constraintViolated);
  }
  ADMIN.createTable(tableDescTwo,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),4);
  NamespaceTableAndRegionInfo nspState=getQuotaManager().getState(nsp);
  assertNotNull(nspState);
  assertTrue(nspState.getTables().size() == 2);
  assertTrue(nspState.getRegionCount() == 5);
  constraintViolated=false;
  try {
    ADMIN.createTable(tableDescThree);
  }
 catch (  Exception exp) {
    assertTrue(exp instanceof IOException);
    constraintViolated=true;
  }
 finally {
    assertTrue("Constraint not violated for table " + tableDescThree.getTableName(),constraintViolated);
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestoreSnapshotQuotaExceed() throws Exception {
  String nsp=prefix + "_testRestoreSnapshotQuotaExceed";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"10").build();
  ADMIN.createNamespace(nspDesc);
  NamespaceDescriptor ndesc=ADMIN.getNamespaceDescriptor(nsp);
  assertNotNull("Namespace descriptor found null.",ndesc);
  TableName tableName1=TableName.valueOf(nsp + TableName.NAMESPACE_DELIM + "table1");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableName1);
  ADMIN.createTable(tableDescOne,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),4);
  NamespaceTableAndRegionInfo nstate=getNamespaceState(nsp);
  assertEquals("Intial region count should be 4.",4,nstate.getRegionCount());
  String snapshot="snapshot_testRestoreSnapshotQuotaExceed";
  ADMIN.snapshot(snapshot,tableName1);
  List<HRegionInfo> regions=ADMIN.getTableRegions(tableName1);
  Collections.sort(regions);
  ADMIN.split(tableName1,Bytes.toBytes("JJJ"));
  Thread.sleep(2000);
  assertEquals("Total regions count should be 5.",5,nstate.getRegionCount());
  ndesc.setConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"2");
  ADMIN.modifyNamespace(ndesc);
  ADMIN.disableTable(tableName1);
  try {
    ADMIN.restoreSnapshot(snapshot);
    fail("Region quota is exceeded so QuotaExceededException should be thrown but HBaseAdmin" + " wraps IOException into RestoreSnapshotException");
  }
 catch (  RestoreSnapshotException ignore) {
  }
  ADMIN.enableTable(tableName1);
  ADMIN.deleteSnapshot(snapshot);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteTable() throws Exception {
  String namespace=prefix + "_dummy";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(namespace).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"100").addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"3").build();
  ADMIN.createNamespace(nspDesc);
  assertNotNull("Namespace descriptor found null.",ADMIN.getNamespaceDescriptor(namespace));
  NamespaceTableAndRegionInfo stateInfo=getNamespaceState(nspDesc.getName());
  assertNotNull("Namespace state found null for " + namespace,stateInfo);
  HTableDescriptor tableDescOne=new HTableDescriptor(TableName.valueOf(namespace + TableName.NAMESPACE_DELIM + "table1"));
  HTableDescriptor tableDescTwo=new HTableDescriptor(TableName.valueOf(namespace + TableName.NAMESPACE_DELIM + "table2"));
  ADMIN.createTable(tableDescOne);
  ADMIN.createTable(tableDescTwo,Bytes.toBytes("AAA"),Bytes.toBytes("ZZZ"),5);
  stateInfo=getNamespaceState(nspDesc.getName());
  assertNotNull("Namespace state found to be null.",stateInfo);
  assertEquals(2,stateInfo.getTables().size());
  assertEquals(5,stateInfo.getRegionCountOfTable(tableDescTwo.getTableName()));
  assertEquals(6,stateInfo.getRegionCount());
  ADMIN.disableTable(tableDescOne.getTableName());
  deleteTable(tableDescOne.getTableName());
  stateInfo=getNamespaceState(nspDesc.getName());
  assertNotNull("Namespace state found to be null.",stateInfo);
  assertEquals(5,stateInfo.getRegionCount());
  assertEquals(1,stateInfo.getTables().size());
  ADMIN.disableTable(tableDescTwo.getTableName());
  deleteTable(tableDescTwo.getTableName());
  ADMIN.deleteNamespace(namespace);
  stateInfo=getNamespaceState(namespace);
  assertNull("Namespace state not found to be null.",stateInfo);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegionOperations() throws Exception {
  String nsp1=prefix + "_regiontest";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp1).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"2").addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"2").build();
  ADMIN.createNamespace(nspDesc);
  boolean constraintViolated=false;
  final TableName tableOne=TableName.valueOf(nsp1 + TableName.NAMESPACE_DELIM + "table1");
  byte[] columnFamily=Bytes.toBytes("info");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableOne);
  tableDescOne.addFamily(new HColumnDescriptor(columnFamily));
  NamespaceTableAndRegionInfo stateInfo;
  try {
    ADMIN.createTable(tableDescOne,Bytes.toBytes("1"),Bytes.toBytes("1000"),7);
  }
 catch (  Exception exp) {
    assertTrue(exp instanceof DoNotRetryIOException);
    LOG.info(exp);
    constraintViolated=true;
  }
 finally {
    assertTrue(constraintViolated);
  }
  assertFalse(ADMIN.tableExists(tableOne));
  ADMIN.createTable(tableDescOne);
  Connection connection=ConnectionFactory.createConnection(UTIL.getConfiguration());
  Table htable=connection.getTable(tableOne);
  UTIL.loadNumericRows(htable,Bytes.toBytes("info"),1,1000);
  ADMIN.flush(tableOne);
  stateInfo=getNamespaceState(nsp1);
  assertEquals(1,stateInfo.getTables().size());
  assertEquals(1,stateInfo.getRegionCount());
  restartMaster();
  HRegion actualRegion=UTIL.getHBaseCluster().getRegions(tableOne).get(0);
  CustomObserver observer=(CustomObserver)actualRegion.getCoprocessorHost().findCoprocessor(CustomObserver.class.getName());
  assertNotNull(observer);
  ADMIN.split(tableOne,Bytes.toBytes("500"));
  observer.postSplit.await();
  assertEquals(2,ADMIN.getTableRegions(tableOne).size());
  actualRegion=UTIL.getHBaseCluster().getRegions(tableOne).get(0);
  observer=(CustomObserver)actualRegion.getCoprocessorHost().findCoprocessor(CustomObserver.class.getName());
  assertNotNull(observer);
  ADMIN.compact(tableOne);
  observer.postCompact.await();
  ADMIN.split(tableOne,getSplitKey(actualRegion.getRegionInfo().getStartKey(),actualRegion.getRegionInfo().getEndKey()));
  observer.postSplit.await();
  List<HRegionInfo> hris=ADMIN.getTableRegions(tableOne);
  assertEquals(2,hris.size());
  assertTrue("split completed",observer.preSplitBeforePONR.getCount() == 1);
  htable.close();
}

</code></pre>

<br>
<pre class="type-3 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void cleanup() throws Exception, KeeperException {
  for (  HTableDescriptor table : ADMIN.listTables()) {
    ADMIN.disableTable(table.getTableName());
    deleteTable(table.getTableName());
  }
  for (  NamespaceDescriptor ns : ADMIN.listNamespaceDescriptors()) {
    if (ns.getName().startsWith(prefix)) {
      ADMIN.deleteNamespace(ns.getName());
    }
  }
  assertTrue("Quota manager not enabled",UTIL.getHBaseCluster().getMaster().getMasterQuotaManager().isQuotaEnabled());
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecreateTableWithSameNameAfterFirstTimeFailure() throws Exception {
  String nsp1=prefix + "_testRecreateTable";
  NamespaceDescriptor nspDesc=NamespaceDescriptor.create(nsp1).addConfiguration(TableNamespaceManager.KEY_MAX_REGIONS,"20").addConfiguration(TableNamespaceManager.KEY_MAX_TABLES,"1").build();
  ADMIN.createNamespace(nspDesc);
  final TableName tableOne=TableName.valueOf(nsp1 + TableName.NAMESPACE_DELIM + "table1");
  byte[] columnFamily=Bytes.toBytes("info");
  HTableDescriptor tableDescOne=new HTableDescriptor(tableOne);
  tableDescOne.addFamily(new HColumnDescriptor(columnFamily));
  MasterSyncObserver.throwExceptionInPreCreateTableHandler=true;
  try {
    try {
      ADMIN.createTable(tableDescOne);
      fail("Table " + tableOne.toString() + "creation should fail.");
    }
 catch (    Exception exp) {
      LOG.error(exp);
    }
    assertFalse(ADMIN.tableExists(tableOne));
    NamespaceTableAndRegionInfo nstate=getNamespaceState(nsp1);
    assertEquals("First table creation failed in namespace so number of tables in namespace " + "should be 0.",0,nstate.getTables().size());
    MasterSyncObserver.throwExceptionInPreCreateTableHandler=false;
    try {
      ADMIN.createTable(tableDescOne);
    }
 catch (    Exception e) {
      fail("Table " + tableOne.toString() + "creation should succeed.");
      LOG.error(e);
    }
    assertTrue(ADMIN.tableExists(tableOne));
    nstate=getNamespaceState(nsp1);
    assertEquals("First table was created successfully so table size in namespace should " + "be one now.",1,nstate.getTables().size());
  }
  finally {
    MasterSyncObserver.throwExceptionInPreCreateTableHandler=false;
    if (ADMIN.tableExists(tableOne)) {
      ADMIN.disableTable(tableOne);
      deleteTable(tableOne);
    }
    ADMIN.deleteNamespace(nsp1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.nio.TestMultiByteBuff </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubBuffer(){
  ByteBuffer bb1=ByteBuffer.allocateDirect(10);
  ByteBuffer bb2=ByteBuffer.allocateDirect(10);
  MultiByteBuff multi=new MultiByteBuff(bb1,bb2);
  long l1=1234L, l2=100L;
  multi.putLong(l1);
  multi.putLong(l2);
  multi.rewind();
  ByteBuffer sub=multi.asSubByteBuffer(Bytes.SIZEOF_LONG);
  assertTrue(bb1 == sub);
  assertEquals(l1,ByteBufferUtils.toLong(sub,sub.position()));
  multi.skip(Bytes.SIZEOF_LONG);
  sub=multi.asSubByteBuffer(Bytes.SIZEOF_LONG);
  assertFalse(bb1 == sub);
  assertFalse(bb2 == sub);
  assertEquals(l2,ByteBufferUtils.toLong(sub,sub.position()));
  multi.rewind();
  ObjectIntPair<ByteBuffer> p=new ObjectIntPair<ByteBuffer>();
  multi.asSubByteBuffer(8,Bytes.SIZEOF_LONG,p);
  assertFalse(bb1 == p.getFirst());
  assertFalse(bb2 == p.getFirst());
  assertEquals(0,p.getSecond());
  assertEquals(l2,ByteBufferUtils.toLong(sub,p.getSecond()));
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArrayBasedMethods(){
  byte[] b=new byte[15];
  ByteBuffer bb1=ByteBuffer.wrap(b,1,10).slice();
  ByteBuffer bb2=ByteBuffer.allocate(15);
  ByteBuff mbb1=new MultiByteBuff(bb1,bb2);
  assertFalse(mbb1.hasArray());
  try {
    mbb1.array();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    mbb1.arrayOffset();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  mbb1=new SingleByteBuff(bb1);
  assertTrue(mbb1.hasArray());
  assertEquals(1,mbb1.arrayOffset());
  assertEquals(b,mbb1.array());
  mbb1=new SingleByteBuff(ByteBuffer.allocateDirect(10));
  assertFalse(mbb1.hasArray());
  try {
    mbb1.array();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    mbb1.arrayOffset();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWritesAndReads(){
  ByteBuffer bb1=ByteBuffer.allocate(15);
  ByteBuffer bb2=ByteBuffer.allocate(15);
  int i1=4;
  bb1.putInt(i1);
  long l1=45L, l2=100L, l3=12345L;
  bb1.putLong(l1);
  short s1=2;
  bb1.putShort(s1);
  byte[] b=Bytes.toBytes(l2);
  bb1.put(b,0,1);
  bb2.put(b,1,7);
  bb2.putLong(l3);
  MultiByteBuff mbb=new MultiByteBuff(bb1,bb2);
  assertEquals(l1,mbb.getLong(4));
  assertEquals(l2,mbb.getLong(14));
  assertEquals(l3,mbb.getLong(22));
  assertEquals(i1,mbb.getInt(0));
  assertEquals(s1,mbb.getShort(12));
  assertEquals(i1,mbb.getInt());
  assertEquals(l1,mbb.getLong());
  assertEquals(s1,mbb.getShort());
  assertEquals(l2,mbb.getLong());
  assertEquals(l3,mbb.getLong());
  bb1=ByteBuffer.allocate(15);
  bb2=ByteBuffer.allocate(15);
  mbb=new MultiByteBuff(bb1,bb2);
  byte b1=5, b2=31;
  mbb.put(b1);
  mbb.putLong(l1);
  mbb.putInt(i1);
  mbb.putLong(l2);
  mbb.put(b2);
  mbb.position(mbb.position() + 2);
  try {
    mbb.putLong(l3);
    fail("'Should have thrown BufferOverflowException");
  }
 catch (  BufferOverflowException e) {
  }
  mbb.position(mbb.position() - 2);
  mbb.putLong(l3);
  mbb.rewind();
  assertEquals(b1,mbb.get());
  assertEquals(l1,mbb.getLong());
  assertEquals(i1,mbb.getInt());
  assertEquals(l2,mbb.getLong());
  assertEquals(b2,mbb.get());
  assertEquals(l3,mbb.getLong());
  mbb.put(21,b1);
  mbb.position(21);
  assertEquals(b1,mbb.get());
  mbb.put(b);
  assertEquals(l2,mbb.getLong(22));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestProcedureExecution </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testBadSubprocList(){
  List<String> state=new ArrayList<String>();
  Procedure subProc2=new TestSequentialProcedure("subProc2",state);
  Procedure subProc1=new TestSequentialProcedure("subProc1",state,subProc2,NULL_PROC);
  Procedure rootProc=new TestSequentialProcedure("rootProc",state,subProc1);
  long rootId=ProcedureTestingUtility.submitAndWait(procExecutor,rootProc);
  LOG.info(state);
  ProcedureInfo result=procExecutor.getResult(rootId);
  assertTrue(state.toString(),result.isFailed());
  ProcedureTestingUtility.assertIsIllegalArgumentException(result);
  assertEquals(state.toString(),4,state.size());
  assertEquals("rootProc-execute",state.get(0));
  assertEquals("subProc1-execute",state.get(1));
  assertEquals("subProc1-rollback",state.get(2));
  assertEquals("rootProc-rollback",state.get(3));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testAbortTimeoutWithChildren(){
  List<String> state=new ArrayList<String>();
  Procedure proc=new TestWaitingProcedure("wproc",state,true);
  proc.setTimeout(2500);
  long rootId=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  LOG.info(state);
  ProcedureInfo result=procExecutor.getResult(rootId);
  assertTrue(state.toString(),result.isFailed());
  ProcedureTestingUtility.assertIsTimeoutException(result);
  assertEquals(state.toString(),4,state.size());
  assertEquals("wproc-execute",state.get(0));
  assertEquals("wproc-child-execute",state.get(1));
  assertEquals("wproc-child-rollback",state.get(2));
  assertEquals("wproc-rollback",state.get(3));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testAbortTimeout(){
  final int PROC_TIMEOUT_MSEC=2500;
  List<String> state=new ArrayList<String>();
  Procedure proc=new TestWaitingProcedure("wproc",state,false);
  proc.setTimeout(PROC_TIMEOUT_MSEC);
  long startTime=EnvironmentEdgeManager.currentTime();
  long rootId=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  long execTime=EnvironmentEdgeManager.currentTime() - startTime;
  LOG.info(state);
  assertTrue("we didn't wait enough execTime=" + execTime,execTime >= PROC_TIMEOUT_MSEC);
  ProcedureInfo result=procExecutor.getResult(rootId);
  assertTrue(state.toString(),result.isFailed());
  ProcedureTestingUtility.assertIsTimeoutException(result);
  assertEquals(state.toString(),2,state.size());
  assertEquals("wproc-execute",state.get(0));
  assertEquals("wproc-rollback",state.get(1));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testSingleSequentialProcRollback(){
  List<String> state=new ArrayList<String>();
  Procedure subProc2=new TestSequentialProcedure("subProc2",state,new TestProcedureException("fail test"));
  Procedure subProc1=new TestSequentialProcedure("subProc1",state,subProc2);
  Procedure rootProc=new TestSequentialProcedure("rootProc",state,subProc1);
  long rootId=ProcedureTestingUtility.submitAndWait(procExecutor,rootProc);
  LOG.info(state);
  ProcedureInfo result=procExecutor.getResult(rootId);
  assertTrue(state.toString(),result.isFailed());
  LOG.info(result.getExceptionFullMessage());
  Throwable cause=ProcedureTestingUtility.getExceptionCause(result);
  assertTrue("expected TestProcedureException, got " + cause,cause instanceof TestProcedureException);
  assertEquals(state.toString(),6,state.size());
  assertEquals("rootProc-execute",state.get(0));
  assertEquals("subProc1-execute",state.get(1));
  assertEquals("subProc2-execute",state.get(2));
  assertEquals("subProc2-rollback",state.get(3));
  assertEquals("subProc1-rollback",state.get(4));
  assertEquals("rootProc-rollback",state.get(5));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  htu=new HBaseCommonTestingUtility();
  testDir=htu.getDataTestDir();
  fs=testDir.getFileSystem(htu.getConfiguration());
  assertTrue(testDir.depth() > 1);
  logDir=new Path(testDir,"proc-logs");
  procStore=ProcedureTestingUtility.createWalStore(htu.getConfiguration(),fs,logDir);
  procExecutor=new ProcedureExecutor(htu.getConfiguration(),null,procStore);
  procStore.start(PROCEDURE_EXECUTOR_SLOTS);
  procExecutor.start(PROCEDURE_EXECUTOR_SLOTS,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestProcedureRecovery </h4><pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  htu=new HBaseCommonTestingUtility();
  testDir=htu.getDataTestDir();
  fs=testDir.getFileSystem(htu.getConfiguration());
  assertTrue(testDir.depth() > 1);
  logDir=new Path(testDir,"proc-logs");
  procEnv=new TestProcEnv();
  procStore=ProcedureTestingUtility.createStore(htu.getConfiguration(),fs,logDir);
  procExecutor=new ProcedureExecutor(htu.getConfiguration(),procEnv,procStore);
  procExecutor.testing=new ProcedureExecutor.Testing();
  procStore.start(PROCEDURE_EXECUTOR_SLOTS);
  procExecutor.start(PROCEDURE_EXECUTOR_SLOTS,true);
  procSleepInterval=0;
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testSingleStepProcRecovery() throws Exception {
  Procedure proc=new TestSingleStepProcedure();
  procExecutor.testing.killBeforeStoreUpdate=true;
  long procId=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  assertFalse(procExecutor.isRunning());
  procExecutor.testing.killBeforeStoreUpdate=false;
  long restartTs=EnvironmentEdgeManager.currentTime();
  restart();
  waitProcedure(procId);
  ProcedureInfo result=procExecutor.getResult(procId);
  assertTrue(result.getLastUpdate() > restartTs);
  ProcedureTestingUtility.assertProcNotFailed(result);
  assertEquals(1,Bytes.toInt(result.getResult()));
  long resultTs=result.getLastUpdate();
  restart();
  result=procExecutor.getResult(procId);
  ProcedureTestingUtility.assertProcNotFailed(result);
  assertEquals(resultTs,result.getLastUpdate());
  assertEquals(1,Bytes.toInt(result.getResult()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testStateMachineRecovery() throws Exception {
  ProcedureTestingUtility.setToggleKillBeforeStoreUpdate(procExecutor,true);
  ProcedureTestingUtility.setKillBeforeStoreUpdate(procExecutor,true);
  Procedure proc=new TestStateMachineProcedure();
  long procId=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  assertFalse(procExecutor.isRunning());
  restart();
  waitProcedure(procId);
  ProcedureTestingUtility.assertProcNotYetCompleted(procExecutor,procId);
  assertFalse(procExecutor.isRunning());
  restart();
  waitProcedure(procId);
  ProcedureTestingUtility.assertProcNotYetCompleted(procExecutor,procId);
  assertFalse(procExecutor.isRunning());
  restart();
  waitProcedure(procId);
  assertTrue(procExecutor.isRunning());
  ProcedureInfo result=procExecutor.getResult(procId);
  ProcedureTestingUtility.assertProcNotFailed(result);
  assertEquals(15,Bytes.toInt(result.getResult()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestProcedureReplayOrder </h4><pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  htu=new HBaseCommonTestingUtility();
  htu.getConfiguration().setInt("hbase.procedure.store.wal.sync.wait.msec",25);
  testDir=htu.getDataTestDir();
  fs=testDir.getFileSystem(htu.getConfiguration());
  assertTrue(testDir.depth() > 1);
  logDir=new Path(testDir,"proc-logs");
  procEnv=new TestProcedureEnv();
  procStore=ProcedureTestingUtility.createWalStore(htu.getConfiguration(),fs,logDir);
  procExecutor=new ProcedureExecutor(htu.getConfiguration(),procEnv,procStore);
  procStore.start(NUM_THREADS);
  procExecutor.start(1,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestYieldProcedures </h4><pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  htu=new HBaseCommonTestingUtility();
  testDir=htu.getDataTestDir();
  fs=testDir.getFileSystem(htu.getConfiguration());
  assertTrue(testDir.depth() > 1);
  logDir=new Path(testDir,"proc-logs");
  procStore=ProcedureTestingUtility.createWalStore(htu.getConfiguration(),fs,logDir);
  procExecutor=new ProcedureExecutor(htu.getConfiguration(),new TestProcEnv(),procStore);
  procStore.start(PROCEDURE_EXECUTOR_SLOTS);
  procExecutor.start(PROCEDURE_EXECUTOR_SLOTS,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.store.TestProcedureStoreTracker </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialTracker(){
  ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  tracker.setPartialFlag(true);
  assertTrue(tracker.isEmpty());
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(1));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(579));
  tracker.setDeleted(1,true);
  tracker.dump();
  assertEquals(ProcedureStoreTracker.DeleteState.YES,tracker.isDeleted(1));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(2));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(579));
  tracker.setDeleted(579,false);
  assertEquals(ProcedureStoreTracker.DeleteState.YES,tracker.isDeleted(1));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(2));
  assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(579));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(577));
  assertEquals(ProcedureStoreTracker.DeleteState.MAYBE,tracker.isDeleted(580));
  tracker.setDeleted(579,true);
  tracker.setPartialFlag(false);
  assertTrue(tracker.isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSeqInsertAndDelete(){
  ProcedureStoreTracker tracker=new ProcedureStoreTracker();
  assertTrue(tracker.isEmpty());
  final int MIN_PROC=1;
  final int MAX_PROC=1 << 10;
  for (int i=MIN_PROC; i < MAX_PROC; ++i) {
    tracker.insert(i);
    for (int j=MIN_PROC; j <= i; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(j));
    }
    for (int j=i + 1; j < MAX_PROC; ++j) {
      assertTrue(tracker.isDeleted(j) != ProcedureStoreTracker.DeleteState.NO);
    }
  }
  for (int i=MIN_PROC; i < MAX_PROC; ++i) {
    tracker.delete(i);
    for (int j=MIN_PROC; j <= i; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.YES,tracker.isDeleted(j));
    }
    for (int j=i + 1; j < MAX_PROC; ++j) {
      assertEquals(ProcedureStoreTracker.DeleteState.NO,tracker.isDeleted(j));
    }
  }
  assertTrue(tracker.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.store.wal.TestWALProcedureStore </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testWalReplayOrder_AB_A() throws Exception {
  TestProcedure a=new TestProcedure(1,0);
  TestProcedure b=new TestProcedure(2,1);
  procStore.insert(a,null);
  a.addStackId(0);
  procStore.update(a);
  procStore.insert(a,new Procedure[]{b});
  b.addStackId(1);
  procStore.update(b);
  procStore.rollWriterForTesting();
  a.addStackId(2);
  procStore.update(a);
  storeRestart(new ProcedureStore.ProcedureLoader(){
    @Override public void setMaxProcId(    long maxProcId){
      assertEquals(2,maxProcId);
    }
    @Override public void load(    ProcedureIterator procIter) throws IOException {
      assertTrue(procIter.hasNext());
      assertEquals(1,procIter.nextAsProcedureInfo().getProcId());
      assertTrue(procIter.hasNext());
      assertEquals(2,procIter.nextAsProcedureInfo().getProcId());
      assertFalse(procIter.hasNext());
    }
    @Override public void handleCorrupted(    ProcedureIterator procIter) throws IOException {
      assertFalse(procIter.hasNext());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  htu=new HBaseCommonTestingUtility();
  testDir=htu.getDataTestDir();
  fs=testDir.getFileSystem(htu.getConfiguration());
  assertTrue(testDir.depth() > 1);
  logDir=new Path(testDir,"proc-logs");
  procStore=ProcedureTestingUtility.createWalStore(htu.getConfiguration(),fs,logDir);
  procStore.start(PROCEDURE_STORE_SLOTS);
  procStore.recoverLease();
  procStore.load(new LoadCounter());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertUpdateDelete() throws Exception {
  final int NTHREAD=2;
  procStore.stop(false);
  fs.delete(logDir,true);
  org.apache.hadoop.conf.Configuration conf=new org.apache.hadoop.conf.Configuration(htu.getConfiguration());
  conf.setBoolean("hbase.procedure.store.wal.use.hsync",false);
  conf.setInt("hbase.procedure.store.wal.periodic.roll.msec",10000);
  conf.setInt("hbase.procedure.store.wal.roll.threshold",128 * 1024);
  fs.mkdirs(logDir);
  procStore=ProcedureTestingUtility.createWalStore(conf,fs,logDir);
  procStore.start(NTHREAD);
  procStore.recoverLease();
  LoadCounter loader=new LoadCounter();
  procStore.load(loader);
  assertEquals(0,loader.getMaxProcId());
  assertEquals(0,loader.getLoadedCount());
  assertEquals(0,loader.getCorruptedCount());
  final long LAST_PROC_ID=9999;
  final Thread[] thread=new Thread[NTHREAD];
  final AtomicLong procCounter=new AtomicLong((long)Math.round(Math.random() * 100));
  for (int i=0; i < thread.length; ++i) {
    thread[i]=new Thread(){
      @Override public void run(){
        Random rand=new Random();
        TestProcedure proc;
        do {
          proc=new TestProcedure(procCounter.addAndGet(1));
          procStore.insert(proc,null);
          for (int i=0, nupdates=rand.nextInt(10); i <= nupdates; ++i) {
            try {
              Thread.sleep(0,rand.nextInt(15));
            }
 catch (            InterruptedException e) {
            }
            procStore.update(proc);
          }
          procStore.delete(proc.getProcId());
        }
 while (proc.getProcId() < LAST_PROC_ID);
      }
    }
;
    thread[i].start();
  }
  for (int i=0; i < thread.length; ++i) {
    thread[i].join();
  }
  procStore.getStoreTracker().dump();
  assertTrue(procCounter.get() >= LAST_PROC_ID);
  assertTrue(procStore.getStoreTracker().isEmpty());
  assertEquals(1,procStore.getActiveLogs().size());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptedEntries() throws Exception {
  for (int i=0; i < 100; ++i) {
    procStore.insert(new TestSequentialProcedure(),null);
  }
  procStore.stop(false);
  FileStatus[] logs=fs.listStatus(logDir);
  assertEquals(1,logs.length);
  corruptLog(logs[0],1823);
  LoadCounter loader=new LoadCounter();
  storeRestart(loader);
  assertTrue(procStore.getCorruptedLogs() != null);
  assertEquals(1,procStore.getCorruptedLogs().size());
  assertEquals(85,loader.getLoadedCount());
  assertEquals(0,loader.getCorruptedCount());
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testWalReplayOrder_ABC_BAD() throws Exception {
  TestProcedure a=new TestProcedure(1,0);
  TestProcedure b=new TestProcedure(2,1);
  TestProcedure c=new TestProcedure(3,2);
  TestProcedure d=new TestProcedure(4,0);
  procStore.insert(a,null);
  a.addStackId(0);
  procStore.update(a);
  procStore.insert(a,new Procedure[]{b});
  b.addStackId(1);
  procStore.update(b);
  procStore.insert(b,new Procedure[]{c});
  b.addStackId(2);
  procStore.update(b);
  procStore.rollWriterForTesting();
  b.addStackId(3);
  procStore.update(b);
  a.addStackId(4);
  procStore.update(a);
  procStore.insert(d,null);
  d.addStackId(0);
  procStore.update(d);
  storeRestart(new ProcedureStore.ProcedureLoader(){
    @Override public void setMaxProcId(    long maxProcId){
      assertEquals(4,maxProcId);
    }
    @Override public void load(    ProcedureIterator procIter) throws IOException {
      assertTrue(procIter.hasNext());
      assertEquals(4,procIter.nextAsProcedureInfo().getProcId());
      assertTrue(procIter.hasNext());
      assertEquals(1,procIter.nextAsProcedureInfo().getProcId());
      assertTrue(procIter.hasNext());
      assertEquals(2,procIter.nextAsProcedureInfo().getProcId());
      assertTrue(procIter.hasNext());
      assertEquals(3,procIter.nextAsProcedureInfo().getProcId());
      assertFalse(procIter.hasNext());
    }
    @Override public void handleCorrupted(    ProcedureIterator procIter) throws IOException {
      assertFalse(procIter.hasNext());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptedProcedures() throws Exception {
  TestProcedure[] rootProcs=new TestProcedure[10];
  for (int i=1; i <= rootProcs.length; i++) {
    rootProcs[i - 1]=new TestProcedure(i,0);
    procStore.insert(rootProcs[i - 1],null);
    rootProcs[i - 1].addStackId(0);
    procStore.update(rootProcs[i - 1]);
  }
  procStore.rollWriterForTesting();
  for (int i=1; i <= rootProcs.length; i++) {
    TestProcedure b=new TestProcedure(rootProcs.length + i,i);
    rootProcs[i - 1].addStackId(1);
    procStore.insert(rootProcs[i - 1],new Procedure[]{b});
  }
  procStore.rollWriterForTesting();
  for (int i=1; i <= rootProcs.length; i++) {
    procStore.update(new TestProcedure(rootProcs.length + i,i));
  }
  procStore.stop(false);
  FileStatus[] logs=fs.listStatus(logDir);
  assertEquals(Arrays.toString(logs),2,logs.length);
  Arrays.sort(logs,new Comparator<FileStatus>(){
    @Override public int compare(    FileStatus o1,    FileStatus o2){
      return o1.getPath().getName().compareTo(o2.getPath().getName());
    }
  }
);
  LoadCounter loader=new LoadCounter();
  storeRestart(loader);
  assertEquals(rootProcs.length * 2,loader.getLoadedCount());
  assertEquals(0,loader.getCorruptedCount());
  fs.delete(logs[0].getPath(),false);
  loader.reset();
  storeRestart(loader);
  assertEquals(0,loader.getLoadedCount());
  assertEquals(rootProcs.length,loader.getCorruptedCount());
  for (  Procedure proc : loader.getCorrupted()) {
    assertTrue(proc.toString(),proc.getParentProcId() <= rootProcs.length);
    assertTrue(proc.toString(),proc.getProcId() > rootProcs.length && proc.getProcId() <= (rootProcs.length * 2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestQuotaAdmin </h4><pre class="type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThrottleType() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  String userName=User.getCurrent().getShortName();
  admin.setQuota(QuotaSettingsFactory.throttleUser(userName,ThrottleType.READ_NUMBER,6,TimeUnit.MINUTES));
  admin.setQuota(QuotaSettingsFactory.throttleUser(userName,ThrottleType.WRITE_NUMBER,12,TimeUnit.MINUTES));
  admin.setQuota(QuotaSettingsFactory.bypassGlobals(userName,true));
  try (QuotaRetriever scanner=QuotaRetriever.open(TEST_UTIL.getConfiguration())){
    int countThrottle=0;
    int countGlobalBypass=0;
    for (    QuotaSettings settings : scanner) {
switch (settings.getQuotaType()) {
case THROTTLE:
        ThrottleSettings throttle=(ThrottleSettings)settings;
      if (throttle.getSoftLimit() == 6) {
        assertEquals(ThrottleType.READ_NUMBER,throttle.getThrottleType());
      }
 else       if (throttle.getSoftLimit() == 12) {
        assertEquals(ThrottleType.WRITE_NUMBER,throttle.getThrottleType());
      }
 else {
        fail("should not come here, because don't set quota with this limit");
      }
    assertEquals(userName,throttle.getUserName());
  assertEquals(null,throttle.getTableName());
assertEquals(null,throttle.getNamespace());
assertEquals(TimeUnit.MINUTES,throttle.getTimeUnit());
countThrottle++;
break;
case GLOBAL_BYPASS:
countGlobalBypass++;
break;
default :
fail("unexpected settings type: " + settings.getQuotaType());
}
}
assertEquals(2,countThrottle);
assertEquals(1,countGlobalBypass);
}
 admin.setQuota(QuotaSettingsFactory.unthrottleUser(userName));
assertNumResults(1,null);
admin.setQuota(QuotaSettingsFactory.bypassGlobals(userName,false));
assertNumResults(0,null);
}

</code></pre>

<br>
<pre class="type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScan() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  String userName=User.getCurrent().getShortName();
  admin.setQuota(QuotaSettingsFactory.throttleUser(userName,ThrottleType.REQUEST_NUMBER,6,TimeUnit.MINUTES));
  admin.setQuota(QuotaSettingsFactory.bypassGlobals(userName,true));
  try (QuotaRetriever scanner=QuotaRetriever.open(TEST_UTIL.getConfiguration())){
    int countThrottle=0;
    int countGlobalBypass=0;
    for (    QuotaSettings settings : scanner) {
      LOG.debug(settings);
switch (settings.getQuotaType()) {
case THROTTLE:
        ThrottleSettings throttle=(ThrottleSettings)settings;
      assertEquals(userName,throttle.getUserName());
    assertEquals(null,throttle.getTableName());
  assertEquals(null,throttle.getNamespace());
assertEquals(6,throttle.getSoftLimit());
assertEquals(TimeUnit.MINUTES,throttle.getTimeUnit());
countThrottle++;
break;
case GLOBAL_BYPASS:
countGlobalBypass++;
break;
default :
fail("unexpected settings type: " + settings.getQuotaType());
}
}
assertEquals(1,countThrottle);
assertEquals(1,countGlobalBypass);
}
 admin.setQuota(QuotaSettingsFactory.unthrottleUser(userName));
assertNumResults(1,null);
admin.setQuota(QuotaSettingsFactory.bypassGlobals(userName,false));
assertNumResults(0,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestQuotaState </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testQuotaStateUpdateTableThrottle(){
  final TableName TABLE_A=TableName.valueOf("TableA");
  final TableName TABLE_B=TableName.valueOf("TableB");
  final TableName TABLE_C=TableName.valueOf("TableC");
  final int TABLE_A_THROTTLE_1=3;
  final int TABLE_A_THROTTLE_2=11;
  final int TABLE_B_THROTTLE=4;
  final int TABLE_C_THROTTLE=5;
  final long LAST_UPDATE_1=10;
  final long LAST_UPDATE_2=20;
  final long LAST_UPDATE_3=30;
  UserQuotaState quotaInfo=new UserQuotaState();
  assertEquals(0,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  UserQuotaState otherQuotaState=new UserQuotaState(LAST_UPDATE_1);
  otherQuotaState.setQuotas(TABLE_A,buildReqNumThrottle(TABLE_A_THROTTLE_1));
  otherQuotaState.setQuotas(TABLE_B,buildReqNumThrottle(TABLE_B_THROTTLE));
  assertEquals(LAST_UPDATE_1,otherQuotaState.getLastUpdate());
  assertFalse(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_1,quotaInfo.getLastUpdate());
  assertFalse(quotaInfo.isBypass());
  assertThrottleException(quotaInfo.getTableLimiter(TABLE_A),TABLE_A_THROTTLE_1);
  assertThrottleException(quotaInfo.getTableLimiter(TABLE_B),TABLE_B_THROTTLE);
  assertNoopLimiter(quotaInfo.getTableLimiter(TABLE_C));
  otherQuotaState=new UserQuotaState(LAST_UPDATE_2);
  otherQuotaState.setQuotas(TABLE_A,buildReqNumThrottle(TABLE_A_THROTTLE_2));
  otherQuotaState.setQuotas(TABLE_C,buildReqNumThrottle(TABLE_C_THROTTLE));
  assertEquals(LAST_UPDATE_2,otherQuotaState.getLastUpdate());
  assertFalse(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_2,quotaInfo.getLastUpdate());
  assertFalse(quotaInfo.isBypass());
  assertThrottleException(quotaInfo.getTableLimiter(TABLE_A),TABLE_A_THROTTLE_2 - TABLE_A_THROTTLE_1);
  assertThrottleException(quotaInfo.getTableLimiter(TABLE_C),TABLE_C_THROTTLE);
  assertNoopLimiter(quotaInfo.getTableLimiter(TABLE_B));
  otherQuotaState=new UserQuotaState(LAST_UPDATE_3);
  assertEquals(LAST_UPDATE_3,otherQuotaState.getLastUpdate());
  assertTrue(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_3,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  assertNoopLimiter(quotaInfo.getTableLimiter(UNKNOWN_TABLE_NAME));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testQuotaStateUpdateBypassThrottle(){
  final long LAST_UPDATE=10;
  UserQuotaState quotaInfo=new UserQuotaState();
  assertEquals(0,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  UserQuotaState otherQuotaState=new UserQuotaState(LAST_UPDATE);
  assertEquals(LAST_UPDATE,otherQuotaState.getLastUpdate());
  assertTrue(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  assertTrue(quotaInfo.getGlobalLimiter() == quotaInfo.getTableLimiter(UNKNOWN_TABLE_NAME));
  assertNoopLimiter(quotaInfo.getTableLimiter(UNKNOWN_TABLE_NAME));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testQuotaStateUpdateGlobalThrottle(){
  final int NUM_GLOBAL_THROTTLE_1=3;
  final int NUM_GLOBAL_THROTTLE_2=11;
  final long LAST_UPDATE_1=10;
  final long LAST_UPDATE_2=20;
  final long LAST_UPDATE_3=30;
  QuotaState quotaInfo=new QuotaState();
  assertEquals(0,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  QuotaState otherQuotaState=new QuotaState(LAST_UPDATE_1);
  otherQuotaState.setQuotas(buildReqNumThrottle(NUM_GLOBAL_THROTTLE_1));
  assertEquals(LAST_UPDATE_1,otherQuotaState.getLastUpdate());
  assertFalse(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_1,quotaInfo.getLastUpdate());
  assertFalse(quotaInfo.isBypass());
  assertThrottleException(quotaInfo.getGlobalLimiter(),NUM_GLOBAL_THROTTLE_1);
  otherQuotaState=new QuotaState(LAST_UPDATE_2);
  otherQuotaState.setQuotas(buildReqNumThrottle(NUM_GLOBAL_THROTTLE_2));
  assertEquals(LAST_UPDATE_2,otherQuotaState.getLastUpdate());
  assertFalse(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_2,quotaInfo.getLastUpdate());
  assertFalse(quotaInfo.isBypass());
  assertThrottleException(quotaInfo.getGlobalLimiter(),NUM_GLOBAL_THROTTLE_2 - NUM_GLOBAL_THROTTLE_1);
  otherQuotaState=new QuotaState(LAST_UPDATE_3);
  assertEquals(LAST_UPDATE_3,otherQuotaState.getLastUpdate());
  assertTrue(otherQuotaState.isBypass());
  quotaInfo.update(otherQuotaState);
  assertEquals(LAST_UPDATE_3,quotaInfo.getLastUpdate());
  assertTrue(quotaInfo.isBypass());
  assertNoopLimiter(quotaInfo.getGlobalLimiter());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestRateLimiter </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOverconsumptionAverageIntervalRefillStrategy(){
  RateLimiter limiter=new AverageIntervalRateLimiter();
  limiter.set(10,TimeUnit.SECONDS);
  assertTrue(limiter.canExecute());
  limiter.consume(20);
  assertEquals(100,limiter.waitInterval(1));
  assertEquals(1000,limiter.waitInterval(10));
  limiter.setNextRefillTime(limiter.getNextRefillTime() - 900);
  assertTrue(limiter.canExecute(1));
  limiter.setNextRefillTime(limiter.getNextRefillTime() - 100);
  assertTrue(limiter.canExecute());
  assertEquals(0,limiter.waitInterval());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOverconsumptionFixedIntervalRefillStrategy() throws InterruptedException {
  RateLimiter limiter=new FixedIntervalRateLimiter();
  limiter.set(10,TimeUnit.SECONDS);
  assertTrue(limiter.canExecute());
  limiter.consume(20);
  assertEquals(1000,limiter.waitInterval(1));
  assertEquals(1000,limiter.waitInterval(10));
  limiter.setNextRefillTime(limiter.getNextRefillTime() - 900);
  assertFalse(limiter.canExecute(1));
  limiter.setNextRefillTime(limiter.getNextRefillTime() - 100);
  assertTrue(limiter.canExecute());
  assertEquals(0,limiter.waitInterval());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFixedIntervalResourceAvailability() throws Exception {
  RateLimiter limiter=new FixedIntervalRateLimiter();
  limiter.set(10,TimeUnit.SECONDS);
  assertTrue(limiter.canExecute(10));
  limiter.consume(3);
  assertEquals(7,limiter.getAvailable());
  assertFalse(limiter.canExecute(10));
  limiter.setNextRefillTime(limiter.getNextRefillTime() - 1000);
  assertTrue(limiter.canExecute(10));
  assertEquals(10,limiter.getAvailable());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestAtomicOperation </h4><pre class="type-9 type-10 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test multi-threaded row mutations.
 */
@Test public void testRowMutationMultiThreads() throws IOException {
  LOG.info("Starting test testRowMutationMultiThreads");
  initHRegion(tableName,name.getMethodName(),fam1);
  int numThreads=10;
  int opsPerThread=250;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  AtomicLong timeStamps=new AtomicLong(0);
  AtomicInteger failures=new AtomicInteger(0);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,timeStamps,failures){
      @Override public void run(){
        boolean op=true;
        for (int i=0; i < numOps; i++) {
          try {
            if (i % 10 == 0) {
synchronized (region) {
                LOG.debug("flushing");
                region.flush(true);
                if (i % 100 == 0) {
                  region.compact(false);
                }
              }
            }
            long ts=timeStamps.incrementAndGet();
            RowMutations rm=new RowMutations(row);
            if (op) {
              Put p=new Put(row,ts);
              p.addColumn(fam1,qual1,value1);
              p.setDurability(Durability.ASYNC_WAL);
              rm.add(p);
              Delete d=new Delete(row);
              d.addColumns(fam1,qual2,ts);
              d.setDurability(Durability.ASYNC_WAL);
              rm.add(d);
            }
 else {
              Delete d=new Delete(row);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              rm.add(d);
              Put p=new Put(row,ts);
              p.addColumn(fam1,qual2,value2);
              p.setDurability(Durability.ASYNC_WAL);
              rm.add(p);
            }
            region.mutateRow(rm);
            op^=true;
            Get g=new Get(row);
            Result r=region.get(g);
            if (r.size() != 1) {
              LOG.debug(r);
              failures.incrementAndGet();
              fail();
            }
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendMultiThreads() throws IOException {
  LOG.info("Starting test testAppendMultiThreads");
  initHRegion(tableName,name.getMethodName(),new int[]{1,3},fam1,fam2);
  int numThreads=100;
  int opsPerThread=100;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  final byte[] val=new byte[]{1};
  AtomicInteger failures=new AtomicInteger(0);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,null,failures){
      @Override public void run(){
        for (int i=0; i < numOps; i++) {
          try {
            Append a=new Append(row);
            a.add(fam1,qual1,val);
            a.add(fam1,qual2,val);
            a.add(fam2,qual3,val);
            a.setDurability(Durability.ASYNC_WAL);
            region.append(a,HConstants.NO_NONCE,HConstants.NO_NONCE);
            Get g=new Get(row);
            Result result=region.get(g);
            assertEquals(result.getValue(fam1,qual1).length,result.getValue(fam1,qual2).length);
            assertEquals(result.getValue(fam1,qual1).length,result.getValue(fam2,qual3).length);
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
  Get g=new Get(row);
  Result result=region.get(g);
  assertEquals(result.getValue(fam1,qual1).length,10000);
  assertEquals(result.getValue(fam1,qual2).length,10000);
  assertEquals(result.getValue(fam2,qual3).length,10000);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test basic append operation.
 * More tests in
 * @see org.apache.hadoop.hbase.client.TestFromClientSide#testAppend()
 */
@Test public void testAppend() throws IOException {
  initHRegion(tableName,name.getMethodName(),fam1);
  String v1="Ultimate Answer to the Ultimate Question of Life," + " The Universe, and Everything";
  String v2=" is... 42.";
  Append a=new Append(row);
  a.setReturnResults(false);
  a.add(fam1,qual1,Bytes.toBytes(v1));
  a.add(fam1,qual2,Bytes.toBytes(v2));
  assertNull(region.append(a,HConstants.NO_NONCE,HConstants.NO_NONCE));
  a=new Append(row);
  a.add(fam1,qual1,Bytes.toBytes(v2));
  a.add(fam1,qual2,Bytes.toBytes(v1));
  Result result=region.append(a,HConstants.NO_NONCE,HConstants.NO_NONCE);
  assertEquals(0,Bytes.compareTo(Bytes.toBytes(v1 + v2),result.getValue(fam1,qual1)));
  assertEquals(0,Bytes.compareTo(Bytes.toBytes(v2 + v1),result.getValue(fam1,qual2)));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementWithNonExistingFamily() throws IOException {
  initHRegion(tableName,name.getMethodName(),fam1);
  final Increment inc=new Increment(row);
  inc.addColumn(fam1,qual1,1);
  inc.addColumn(fam2,qual2,1);
  inc.setDurability(Durability.ASYNC_WAL);
  try {
    region.increment(inc,HConstants.NO_NONCE,HConstants.NO_NONCE);
  }
 catch (  NoSuchColumnFamilyException e) {
    final Get g=new Get(row);
    final Result result=region.get(g);
    assertEquals(null,result.getValue(fam1,qual1));
    assertEquals(null,result.getValue(fam2,qual2));
  }
catch (  Exception e) {
    fail("Increment operation should fail with NoSuchColumnFamilyException.");
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-11 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test multi-threaded region mutations.
 */
@Test public void testMultiRowMutationMultiThreads() throws IOException {
  LOG.info("Starting test testMultiRowMutationMultiThreads");
  initHRegion(tableName,name.getMethodName(),fam1);
  int numThreads=10;
  int opsPerThread=250;
  AtomicOperation[] all=new AtomicOperation[numThreads];
  AtomicLong timeStamps=new AtomicLong(0);
  AtomicInteger failures=new AtomicInteger(0);
  final List<byte[]> rowsToLock=Arrays.asList(row,row2);
  for (int i=0; i < numThreads; i++) {
    all[i]=new AtomicOperation(region,opsPerThread,timeStamps,failures){
      @Override public void run(){
        boolean op=true;
        for (int i=0; i < numOps; i++) {
          try {
            if (i % 10 == 0) {
synchronized (region) {
                LOG.debug("flushing");
                region.flush(true);
                if (i % 100 == 0) {
                  region.compact(false);
                }
              }
            }
            long ts=timeStamps.incrementAndGet();
            List<Mutation> mrm=new ArrayList<Mutation>();
            if (op) {
              Put p=new Put(row2,ts);
              p.addColumn(fam1,qual1,value1);
              p.setDurability(Durability.ASYNC_WAL);
              mrm.add(p);
              Delete d=new Delete(row);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              mrm.add(d);
            }
 else {
              Delete d=new Delete(row2);
              d.addColumns(fam1,qual1,ts);
              d.setDurability(Durability.ASYNC_WAL);
              mrm.add(d);
              Put p=new Put(row,ts);
              p.setDurability(Durability.ASYNC_WAL);
              p.addColumn(fam1,qual1,value2);
              mrm.add(p);
            }
            region.mutateRowsWithLocks(mrm,rowsToLock,HConstants.NO_NONCE,HConstants.NO_NONCE);
            op^=true;
            Scan s=new Scan(row);
            RegionScanner rs=region.getScanner(s);
            List<Cell> r=new ArrayList<Cell>();
            while (rs.next(r))             ;
            rs.close();
            if (r.size() != 1) {
              LOG.debug(r);
              failures.incrementAndGet();
              fail();
            }
          }
 catch (          IOException e) {
            e.printStackTrace();
            failures.incrementAndGet();
            fail();
          }
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
    }
  }
  assertEquals(0,failures.get());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendWithNonExistingFamily() throws IOException {
  initHRegion(tableName,name.getMethodName(),fam1);
  final String v1="Value";
  final Append a=new Append(row);
  a.add(fam1,qual1,Bytes.toBytes(v1));
  a.add(fam2,qual2,Bytes.toBytes(v1));
  Result result=null;
  try {
    result=region.append(a,HConstants.NO_NONCE,HConstants.NO_NONCE);
    fail("Append operation should fail with NoSuchColumnFamilyException.");
  }
 catch (  NoSuchColumnFamilyException e) {
    assertEquals(null,result);
  }
catch (  Exception e) {
    fail("Append operation should fail with NoSuchColumnFamilyException.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestClusterId </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterId() throws Exception {
  TEST_UTIL.startMiniZKCluster();
  TEST_UTIL.startMiniDFSCluster(1);
  Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  CoordinatedStateManager cp=CoordinatedStateManagerFactory.getCoordinatedStateManager(conf);
  rst=JVMClusterUtil.createRegionServerThread(conf,cp,HRegionServer.class,0);
  rst.start();
  Thread.sleep(10000);
  TEST_UTIL.startMiniHBaseCluster(1,0);
  rst.waitForServerOnline();
  String clusterId=ZKClusterId.readClusterIdZNode(TEST_UTIL.getZooKeeperWatcher());
  assertNotNull(clusterId);
  assertEquals(clusterId,rst.getRegionServer().getClusterId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestColumnSeeking </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testReseeking() throws IOException {
  String family="Family";
  byte[] familyBytes=Bytes.toBytes("Family");
  TableName table=TableName.valueOf(name.getMethodName());
  HTableDescriptor htd=new HTableDescriptor(table);
  HColumnDescriptor hcd=new HColumnDescriptor(family);
  hcd.setMaxVersions(3);
  htd.addFamily(hcd);
  HRegionInfo info=new HRegionInfo(table,null,null,false);
  Region region=TEST_UTIL.createLocalHRegion(info,htd);
  List<String> rows=generateRandomWords(10,"row");
  List<String> allColumns=generateRandomWords(100,"column");
  long maxTimestamp=2;
  double selectPercent=0.5;
  int numberOfTests=5;
  double flushPercentage=0.2;
  double minorPercentage=0.2;
  double majorPercentage=0.2;
  double putPercentage=0.2;
  HashMap<String,KeyValue> allKVMap=new HashMap<String,KeyValue>();
  HashMap<String,KeyValue>[] kvMaps=new HashMap[numberOfTests];
  ArrayList<String>[] columnLists=new ArrayList[numberOfTests];
  String valueString="Value";
  for (int i=0; i < numberOfTests; i++) {
    kvMaps[i]=new HashMap<String,KeyValue>();
    columnLists[i]=new ArrayList<String>();
    for (    String column : allColumns) {
      if (Math.random() < selectPercent) {
        columnLists[i].add(column);
      }
    }
  }
  for (  String row : rows) {
    Put p=new Put(Bytes.toBytes(row));
    p.setDurability(Durability.SKIP_WAL);
    for (    String column : allColumns) {
      for (long timestamp=1; timestamp <= maxTimestamp; timestamp++) {
        KeyValue kv=KeyValueTestUtil.create(row,family,column,timestamp,valueString);
        if (Math.random() < putPercentage) {
          p.add(kv);
          allKVMap.put(kv.getKeyString(),kv);
          for (int i=0; i < numberOfTests; i++) {
            if (columnLists[i].contains(column)) {
              kvMaps[i].put(kv.getKeyString(),kv);
            }
          }
        }
      }
    }
    region.put(p);
    if (Math.random() < flushPercentage) {
      LOG.info("Flushing... ");
      region.flush(true);
    }
    if (Math.random() < minorPercentage) {
      LOG.info("Minor compacting... ");
      region.compact(false);
    }
    if (Math.random() < majorPercentage) {
      LOG.info("Major compacting... ");
      region.compact(true);
    }
  }
  for (int i=0; i < numberOfTests + 1; i++) {
    Collection<KeyValue> kvSet;
    Scan scan=new Scan();
    scan.setMaxVersions();
    if (i < numberOfTests) {
      if (columnLists[i].size() == 0)       continue;
      kvSet=kvMaps[i].values();
      for (      String column : columnLists[i]) {
        scan.addColumn(familyBytes,Bytes.toBytes(column));
      }
      LOG.info("ExplicitColumns scanner");
      LOG.info("Columns: " + columnLists[i].size() + "  Keys: "+ kvSet.size());
    }
 else {
      kvSet=allKVMap.values();
      LOG.info("Wildcard scanner");
      LOG.info("Columns: " + allColumns.size() + "  Keys: "+ kvSet.size());
    }
    InternalScanner scanner=region.getScanner(scan);
    List<Cell> results=new ArrayList<Cell>();
    while (scanner.next(results))     ;
    assertEquals(kvSet.size(),results.size());
    assertTrue(KeyValueTestUtil.containsIgnoreMvccVersion(results,kvSet));
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testDuplicateVersions() throws IOException {
  String family="Family";
  byte[] familyBytes=Bytes.toBytes("Family");
  TableName table=TableName.valueOf(name.getMethodName());
  HColumnDescriptor hcd=new HColumnDescriptor(familyBytes).setMaxVersions(1000);
  hcd.setMaxVersions(3);
  HTableDescriptor htd=new HTableDescriptor(table);
  htd.addFamily(hcd);
  HRegionInfo info=new HRegionInfo(table,null,null,false);
  Region region=TEST_UTIL.createLocalHRegion(info,htd);
  try {
    List<String> rows=generateRandomWords(10,"row");
    List<String> allColumns=generateRandomWords(10,"column");
    List<String> values=generateRandomWords(100,"value");
    long maxTimestamp=2;
    double selectPercent=0.5;
    int numberOfTests=5;
    double flushPercentage=0.2;
    double minorPercentage=0.2;
    double majorPercentage=0.2;
    double putPercentage=0.2;
    HashMap<String,KeyValue> allKVMap=new HashMap<String,KeyValue>();
    HashMap<String,KeyValue>[] kvMaps=new HashMap[numberOfTests];
    ArrayList<String>[] columnLists=new ArrayList[numberOfTests];
    for (int i=0; i < numberOfTests; i++) {
      kvMaps[i]=new HashMap<String,KeyValue>();
      columnLists[i]=new ArrayList<String>();
      for (      String column : allColumns) {
        if (Math.random() < selectPercent) {
          columnLists[i].add(column);
        }
      }
    }
    for (    String value : values) {
      for (      String row : rows) {
        Put p=new Put(Bytes.toBytes(row));
        p.setDurability(Durability.SKIP_WAL);
        for (        String column : allColumns) {
          for (long timestamp=1; timestamp <= maxTimestamp; timestamp++) {
            KeyValue kv=KeyValueTestUtil.create(row,family,column,timestamp,value);
            if (Math.random() < putPercentage) {
              p.add(kv);
              allKVMap.put(kv.getKeyString(),kv);
              for (int i=0; i < numberOfTests; i++) {
                if (columnLists[i].contains(column)) {
                  kvMaps[i].put(kv.getKeyString(),kv);
                }
              }
            }
          }
        }
        region.put(p);
        if (Math.random() < flushPercentage) {
          LOG.info("Flushing... ");
          region.flush(true);
        }
        if (Math.random() < minorPercentage) {
          LOG.info("Minor compacting... ");
          region.compact(false);
        }
        if (Math.random() < majorPercentage) {
          LOG.info("Major compacting... ");
          region.compact(true);
        }
      }
    }
    for (int i=0; i < numberOfTests + 1; i++) {
      Collection<KeyValue> kvSet;
      Scan scan=new Scan();
      scan.setMaxVersions();
      if (i < numberOfTests) {
        if (columnLists[i].size() == 0)         continue;
        kvSet=kvMaps[i].values();
        for (        String column : columnLists[i]) {
          scan.addColumn(familyBytes,Bytes.toBytes(column));
        }
        LOG.info("ExplicitColumns scanner");
        LOG.info("Columns: " + columnLists[i].size() + "  Keys: "+ kvSet.size());
      }
 else {
        kvSet=allKVMap.values();
        LOG.info("Wildcard scanner");
        LOG.info("Columns: " + allColumns.size() + "  Keys: "+ kvSet.size());
      }
      InternalScanner scanner=region.getScanner(scan);
      List<Cell> results=new ArrayList<Cell>();
      while (scanner.next(results))       ;
      assertEquals(kvSet.size(),results.size());
      assertTrue(KeyValueTestUtil.containsIgnoreMvccVersion(results,kvSet));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompactSplitThread </h4><pre class="type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreadPoolSizeTuning() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setInt(CompactSplitThread.LARGE_COMPACTION_THREADS,3);
  conf.setInt(CompactSplitThread.SMALL_COMPACTION_THREADS,4);
  conf.setInt(CompactSplitThread.SPLIT_THREADS,5);
  conf.setInt(CompactSplitThread.MERGE_THREADS,6);
  TEST_UTIL.startMiniCluster(1);
  Connection conn=ConnectionFactory.createConnection(conf);
  try {
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor(family));
    htd.setCompactionEnabled(false);
    TEST_UTIL.getHBaseAdmin().createTable(htd);
    TEST_UTIL.waitTableAvailable(tableName);
    HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(tableName);
    assertEquals(3,regionServer.compactSplitThread.getLargeCompactionThreadNum());
    assertEquals(4,regionServer.compactSplitThread.getSmallCompactionThreadNum());
    assertEquals(5,regionServer.compactSplitThread.getSplitThreadNum());
    assertEquals(6,regionServer.compactSplitThread.getMergeThreadNum());
    conf.setInt(CompactSplitThread.LARGE_COMPACTION_THREADS,4);
    conf.setInt(CompactSplitThread.SMALL_COMPACTION_THREADS,5);
    conf.setInt(CompactSplitThread.SPLIT_THREADS,6);
    conf.setInt(CompactSplitThread.MERGE_THREADS,7);
    try {
      regionServer.compactSplitThread.onConfigurationChange(conf);
    }
 catch (    IllegalArgumentException iae) {
      Assert.fail("Update bigger configuration failed!");
    }
    assertEquals(4,regionServer.compactSplitThread.getLargeCompactionThreadNum());
    assertEquals(5,regionServer.compactSplitThread.getSmallCompactionThreadNum());
    assertEquals(6,regionServer.compactSplitThread.getSplitThreadNum());
    assertEquals(7,regionServer.compactSplitThread.getMergeThreadNum());
    conf.setInt(CompactSplitThread.LARGE_COMPACTION_THREADS,2);
    conf.setInt(CompactSplitThread.SMALL_COMPACTION_THREADS,3);
    conf.setInt(CompactSplitThread.SPLIT_THREADS,4);
    conf.setInt(CompactSplitThread.MERGE_THREADS,5);
    try {
      regionServer.compactSplitThread.onConfigurationChange(conf);
    }
 catch (    IllegalArgumentException iae) {
      Assert.fail("Update smaller configuration failed!");
    }
    assertEquals(2,regionServer.compactSplitThread.getLargeCompactionThreadNum());
    assertEquals(3,regionServer.compactSplitThread.getSmallCompactionThreadNum());
    assertEquals(4,regionServer.compactSplitThread.getSplitThreadNum());
    assertEquals(5,regionServer.compactSplitThread.getMergeThreadNum());
  }
  finally {
    conn.close();
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompaction </h4><pre class="type-4 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that you can stop a long-running compaction
 * (used during RS shutdown)
 * @throws Exception
 */
@Test public void testInterruptCompaction() throws Exception {
  assertEquals(0,count());
  int origWI=HStore.closeCheckInterval;
  HStore.closeCheckInterval=10 * 1000;
  try {
    int jmax=(int)Math.ceil(15.0 / compactionThreshold);
    byte[] pad=new byte[1000];
    for (int i=0; i < compactionThreshold; i++) {
      Table loader=new RegionAsTable(r);
      Put p=new Put(Bytes.add(STARTROW,Bytes.toBytes(i)));
      p.setDurability(Durability.SKIP_WAL);
      for (int j=0; j < jmax; j++) {
        p.addColumn(COLUMN_FAMILY,Bytes.toBytes(j),pad);
      }
      HBaseTestCase.addContent(loader,Bytes.toString(COLUMN_FAMILY));
      loader.put(p);
      r.flush(true);
    }
    HRegion spyR=spy(r);
    doAnswer(new Answer(){
      public Object answer(      InvocationOnMock invocation) throws Throwable {
        r.writestate.writesEnabled=false;
        return invocation.callRealMethod();
      }
    }
).when(spyR).doRegionCompactionPrep();
    spyR.compactStores();
    Store s=r.stores.get(COLUMN_FAMILY);
    assertEquals(compactionThreshold,s.getStorefilesCount());
    assertTrue(s.getStorefilesSize() > 15 * 1000);
    FileStatus[] ls=r.getFilesystem().listStatus(r.getRegionFileSystem().getTempDir());
    assertEquals(0,ls.length);
  }
  finally {
    r.writestate.writesEnabled=true;
    HStore.closeCheckInterval=origWI;
    for (int i=0; i < compactionThreshold; i++) {
      Delete delete=new Delete(Bytes.add(STARTROW,Bytes.toBytes(i)));
      byte[][] famAndQf={COLUMN_FAMILY,null};
      delete.addFamily(famAndQf[0]);
      r.delete(delete);
    }
    r.flush(true);
    final int ttl=1000;
    for (    Store hstore : this.r.stores.values()) {
      HStore store=(HStore)hstore;
      ScanInfo old=store.getScanInfo();
      ScanInfo si=new ScanInfo(old.getConfiguration(),old.getFamily(),old.getMinVersions(),old.getMaxVersions(),ttl,old.getKeepDeletedCells(),0,old.getComparator());
      store.setScanInfo(si);
    }
    Thread.sleep(ttl);
    r.compact(true);
    assertEquals(0,count());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompoundBloomFilter </h4><pre class="type-2 type-7 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws IOException {
  conf=TEST_UTIL.getConfiguration();
  conf.setInt(HFile.FORMAT_VERSION_KEY,HFile.MAX_FORMAT_VERSION);
  fs=FileSystem.get(conf);
  cacheConf=new CacheConfig(conf);
  blockCache=cacheConf.getBlockCache();
  assertNotNull(blockCache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCorruptedRegionStoreFile </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testLosingFileDuringScan() throws Exception {
  assertEquals(rowCount,fullScanAndCount(TEST_TABLE.getTableName()));
  final FileSystem fs=getFileSystem();
  final Path tmpStoreFilePath=new Path(UTIL.getDataTestDir(),"corruptedHFile");
  int count=fullScanAndCount(TEST_TABLE.getTableName(),new ScanInjector(){
    private boolean hasFile=true;
    @Override public void beforeScanNext(    Table table) throws Exception {
      if (hasFile) {
        fs.copyToLocalFile(true,storeFiles.get(0),tmpStoreFilePath);
        LOG.info("Move file to local");
        evictHFileCache(storeFiles.get(0));
        hasFile=false;
      }
    }
  }
);
  assertTrue("expected one file lost: rowCount=" + count + " lostRows="+ (NUM_ROWS - count),count >= (NUM_ROWS - ROW_PER_FILE));
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testLosingFileAfterScannerInit() throws Exception {
  assertEquals(rowCount,fullScanAndCount(TEST_TABLE.getTableName()));
  final FileSystem fs=getFileSystem();
  final Path tmpStoreFilePath=new Path(UTIL.getDataTestDir(),"corruptedHFile");
  int count=fullScanAndCount(TEST_TABLE.getTableName(),new ScanInjector(){
    private boolean hasFile=true;
    @Override public void beforeScan(    Table table,    Scan scan) throws Exception {
      if (hasFile) {
        fs.copyToLocalFile(true,storeFiles.get(0),tmpStoreFilePath);
        LOG.info("Move file to local");
        evictHFileCache(storeFiles.get(0));
        hasFile=false;
      }
    }
  }
);
  assertTrue("expected one file lost: rowCount=" + count + " lostRows="+ (NUM_ROWS - count),count >= (NUM_ROWS - ROW_PER_FILE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestDeleteMobTable </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteNonMobTable() throws Exception {
  TableName tn=TableName.valueOf("testDeleteNonMobTable");
  HTableDescriptor htd=createTableDescriptor(tn,false);
  HColumnDescriptor hcd=htd.getFamily(FAMILY);
  Table table=createTableWithOneFile(htd);
  try {
    Assert.assertEquals(0,countMobFiles(tn,hcd.getNameAsString()));
    Assert.assertEquals(0,countArchiveMobFiles(tn,hcd.getNameAsString()));
    Assert.assertFalse(mobTableDirExist(tn));
  }
  finally {
    table.close();
    TEST_UTIL.deleteTable(tn);
  }
  Assert.assertFalse(TEST_UTIL.getHBaseAdmin().tableExists(tn));
  Assert.assertEquals(0,countMobFiles(tn,hcd.getNameAsString()));
  Assert.assertEquals(0,countArchiveMobFiles(tn,hcd.getNameAsString()));
  Assert.assertFalse(mobTableDirExist(tn));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMobFamilyDelete() throws Exception {
  TableName tn=TableName.valueOf("testMobFamilyDelete");
  HTableDescriptor htd=createTableDescriptor(tn,true);
  HColumnDescriptor hcd=htd.getFamily(FAMILY);
  htd.addFamily(new HColumnDescriptor(Bytes.toBytes("family2")));
  Table table=createTableWithOneFile(htd);
  try {
    Assert.assertEquals(1,countMobFiles(tn,hcd.getNameAsString()));
    Assert.assertEquals(0,countArchiveMobFiles(tn,hcd.getNameAsString()));
    String fileName=assertHasOneMobRow(table,tn,hcd.getNameAsString());
    Assert.assertFalse(mobArchiveExist(tn,hcd.getNameAsString(),fileName));
    Assert.assertTrue(mobTableDirExist(tn));
    TEST_UTIL.getHBaseAdmin().deleteColumnFamily(tn,FAMILY);
    Assert.assertEquals(0,countMobFiles(tn,hcd.getNameAsString()));
    Assert.assertEquals(1,countArchiveMobFiles(tn,hcd.getNameAsString()));
    Assert.assertTrue(mobArchiveExist(tn,hcd.getNameAsString(),fileName));
    Assert.assertFalse(mobColumnFamilyDirExist(tn,hcd.getNameAsString()));
  }
  finally {
    table.close();
    TEST_UTIL.deleteTable(tn);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteMobTable() throws Exception {
  TableName tn=TableName.valueOf("testDeleteMobTable");
  HTableDescriptor htd=createTableDescriptor(tn,true);
  HColumnDescriptor hcd=htd.getFamily(FAMILY);
  String fileName=null;
  Table table=createTableWithOneFile(htd);
  try {
    Assert.assertEquals(1,countMobFiles(tn,hcd.getNameAsString()));
    Assert.assertEquals(0,countArchiveMobFiles(tn,hcd.getNameAsString()));
    fileName=assertHasOneMobRow(table,tn,hcd.getNameAsString());
    Assert.assertFalse(mobArchiveExist(tn,hcd.getNameAsString(),fileName));
    Assert.assertTrue(mobTableDirExist(tn));
  }
  finally {
    table.close();
    TEST_UTIL.deleteTable(tn);
  }
  Assert.assertFalse(TEST_UTIL.getHBaseAdmin().tableExists(tn));
  Assert.assertEquals(0,countMobFiles(tn,hcd.getNameAsString()));
  Assert.assertEquals(1,countArchiveMobFiles(tn,hcd.getNameAsString()));
  Assert.assertTrue(mobArchiveExist(tn,hcd.getNameAsString(),fileName));
  Assert.assertFalse(mobTableDirExist(tn));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestEncryptionRandomKeying </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomKeying() throws Exception {
  final List<Path> initialPaths=findStorefilePaths(htd.getTableName());
  assertTrue(initialPaths.size() > 0);
  for (  Path path : initialPaths) {
    assertNotNull("Store file " + path + " is not encrypted",extractHFileKey(path));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestFSErrorsExposed </h4><pre class="type-4 type-11 type-7 type-8 type-13 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Injects errors into the pread calls of an on-disk file, and makes
 * sure those bubble up to the HFile scanner
 */
@Test public void testHFileScannerThrowsErrors() throws IOException {
  Path hfilePath=new Path(new Path(util.getDataTestDir("internalScannerExposesErrors"),"regionname"),"familyname");
  HFileSystem hfs=(HFileSystem)util.getTestFileSystem();
  FaultyFileSystem faultyfs=new FaultyFileSystem(hfs.getBackingFs());
  FileSystem fs=new HFileSystem(faultyfs);
  CacheConfig cacheConf=new CacheConfig(util.getConfiguration());
  HFileContext meta=new HFileContextBuilder().withBlockSize(2 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(util.getConfiguration(),cacheConf,hfs).withOutputDir(hfilePath).withFileContext(meta).build();
  TestStoreFile.writeStoreFile(writer,Bytes.toBytes("cf"),Bytes.toBytes("qual"));
  StoreFile sf=new StoreFile(fs,writer.getPath(),util.getConfiguration(),cacheConf,BloomType.NONE);
  StoreFile.Reader reader=sf.createReader();
  HFileScanner scanner=reader.getScanner(false,true);
  FaultyInputStream inStream=faultyfs.inStreams.get(0).get();
  assertNotNull(inStream);
  scanner.seekTo();
  assertTrue(scanner.next());
  faultyfs.startFaults();
  try {
    int scanned=0;
    while (scanner.next()) {
      scanned++;
    }
    fail("Scanner didn't throw after faults injected");
  }
 catch (  IOException ioe) {
    LOG.info("Got expected exception",ioe);
    assertTrue(ioe.getMessage().contains("Fault"));
  }
  reader.close(true);
}

</code></pre>

<br>
<pre class="type-11 type-8 type-21 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cluster test which starts a region server with a region, then
 * removes the data from HDFS underneath it, and ensures that
 * errors are bubbled to the client.
 */
@Test(timeout=5 * 60 * 1000) public void testFullSystemBubblesFSErrors() throws Exception {
  Assume.assumeTrue(!util.isReadShortCircuitOn());
  try {
    util.getConfiguration().setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,1);
    util.startMiniCluster(1);
    TableName tableName=TableName.valueOf("table");
    byte[] fam=Bytes.toBytes("fam");
    Admin admin=util.getHBaseAdmin();
    HTableDescriptor desc=new HTableDescriptor(tableName);
    desc.addFamily(new HColumnDescriptor(fam).setMaxVersions(1).setBlockCacheEnabled(false));
    admin.createTable(desc);
    try (Table table=util.getConnection().getTable(tableName)){
      util.loadTable(table,fam,false);
      util.flush();
      util.countRows(table);
      util.getDFSCluster().shutdownDataNodes();
      try {
        util.countRows(table);
        fail("Did not fail to count after removing data");
      }
 catch (      Exception e) {
        LOG.info("Got expected error",e);
        assertTrue(e.getMessage().contains("Could not seek"));
      }
    }
     util.getDFSCluster().restartDataNodes();
  }
  finally {
    MiniHBaseCluster cluster=util.getMiniHBaseCluster();
    if (cluster != null)     cluster.killAll();
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-13 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Injects errors into the pread calls of an on-disk file, and makes
 * sure those bubble up to the StoreFileScanner
 */
@Test public void testStoreFileScannerThrowsErrors() throws IOException {
  Path hfilePath=new Path(new Path(util.getDataTestDir("internalScannerExposesErrors"),"regionname"),"familyname");
  HFileSystem hfs=(HFileSystem)util.getTestFileSystem();
  FaultyFileSystem faultyfs=new FaultyFileSystem(hfs.getBackingFs());
  HFileSystem fs=new HFileSystem(faultyfs);
  CacheConfig cacheConf=new CacheConfig(util.getConfiguration());
  HFileContext meta=new HFileContextBuilder().withBlockSize(2 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(util.getConfiguration(),cacheConf,hfs).withOutputDir(hfilePath).withFileContext(meta).build();
  TestStoreFile.writeStoreFile(writer,Bytes.toBytes("cf"),Bytes.toBytes("qual"));
  StoreFile sf=new StoreFile(fs,writer.getPath(),util.getConfiguration(),cacheConf,BloomType.NONE);
  List<StoreFileScanner> scanners=StoreFileScanner.getScannersForStoreFiles(Collections.singletonList(sf),false,true,false,false,0);
  KeyValueScanner scanner=scanners.get(0);
  FaultyInputStream inStream=faultyfs.inStreams.get(0).get();
  assertNotNull(inStream);
  scanner.seek(KeyValue.LOWESTKEY);
  assertNotNull(scanner.next());
  faultyfs.startFaults();
  try {
    int scanned=0;
    while (scanner.next() != null) {
      scanned++;
    }
    fail("Scanner didn't throw after faults injected");
  }
 catch (  IOException ioe) {
    LOG.info("Got expected exception",ioe);
    assertTrue(ioe.getMessage().contains("Could not iterate"));
  }
  scanner.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestFailedAppendAndSync </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Reproduce locking up that happens when we get an exceptions appending and syncing.
 * See HBASE-14317.
 * First I need to set up some mocks for Server and RegionServerServices. I also need to
 * set up a dodgy WAL that will throw an exception when we go to append to it.
 */
@Test(timeout=300000) public void testLockupAroundBadAssignSync() throws IOException {
  final AtomicLong rolls=new AtomicLong(0);
class DodgyFSLog extends FSHLog {
    volatile boolean throwSyncException=false;
    volatile boolean throwAppendException=false;
    public DodgyFSLog(    FileSystem fs,    Path root,    String logDir,    Configuration conf) throws IOException {
      super(fs,root,logDir,conf);
    }
    @Override public byte[][] rollWriter(    boolean force) throws FailedLogCloseException, IOException {
      byte[][] regions=super.rollWriter(force);
      rolls.getAndIncrement();
      return regions;
    }
    @Override protected Writer createWriterInstance(    Path path) throws IOException {
      final Writer w=super.createWriterInstance(path);
      return new Writer(){
        @Override public void close() throws IOException {
          w.close();
        }
        @Override public void sync() throws IOException {
          if (throwSyncException) {
            throw new IOException("FAKE! Failed to replace a bad datanode...");
          }
          w.sync();
        }
        @Override public void append(        Entry entry) throws IOException {
          if (throwAppendException) {
            throw new IOException("FAKE! Failed to replace a bad datanode...");
          }
          w.append(entry);
        }
        @Override public long getLength() throws IOException {
          return w.getLength();
        }
      }
;
    }
  }
  Server server=mock(Server.class);
  when(server.getConfiguration()).thenReturn(CONF);
  when(server.isStopped()).thenReturn(false);
  when(server.isAborted()).thenReturn(false);
  RegionServerServices services=mock(RegionServerServices.class);
  FileSystem fs=FileSystem.get(CONF);
  Path rootDir=new Path(dir + getName());
  DodgyFSLog dodgyWAL=new DodgyFSLog(fs,rootDir,getName(),CONF);
  LogRoller logRoller=new LogRoller(server,services);
  logRoller.addWAL(dodgyWAL);
  logRoller.start();
  boolean threwOnSync=false;
  boolean threwOnAppend=false;
  boolean threwOnBoth=false;
  HRegion region=initHRegion(tableName,null,null,dodgyWAL);
  try {
    byte[] value=Bytes.toBytes(getName());
    try {
      Put put=new Put(value);
      put.addColumn(COLUMN_FAMILY_BYTES,Bytes.toBytes("1"),value);
      region.put(put);
    }
 catch (    IOException ioe) {
      fail();
    }
    long rollsCount=rolls.get();
    try {
      dodgyWAL.throwAppendException=true;
      dodgyWAL.throwSyncException=false;
      Put put=new Put(value);
      put.addColumn(COLUMN_FAMILY_BYTES,Bytes.toBytes("3"),value);
      region.put(put);
    }
 catch (    IOException ioe) {
      threwOnAppend=true;
    }
    while (rollsCount == rolls.get())     Threads.sleep(100);
    rollsCount=rolls.get();
    try {
      dodgyWAL.throwAppendException=true;
      dodgyWAL.throwSyncException=true;
      Put put=new Put(value);
      put.addColumn(COLUMN_FAMILY_BYTES,Bytes.toBytes("4"),value);
      region.put(put);
    }
 catch (    IOException ioe) {
      threwOnBoth=true;
    }
    while (rollsCount == rolls.get())     Threads.sleep(100);
    Mockito.verify(server,Mockito.atLeast(0)).abort(Mockito.anyString(),(Throwable)Mockito.anyObject());
    try {
      dodgyWAL.throwAppendException=false;
      dodgyWAL.throwSyncException=true;
      Put put=new Put(value);
      put.addColumn(COLUMN_FAMILY_BYTES,Bytes.toBytes("2"),value);
      region.put(put);
    }
 catch (    IOException ioe) {
      threwOnSync=true;
    }
    while (true) {
      try {
        Mockito.verify(server,Mockito.atLeast(1)).abort(Mockito.anyString(),(Throwable)Mockito.anyObject());
        break;
      }
 catch (      WantedButNotInvoked t) {
        Threads.sleep(1);
      }
    }
  }
  finally {
    Mockito.when(server.isStopped()).thenReturn(true);
    if (logRoller != null)     logRoller.interrupt();
    if (region != null) {
      try {
        region.close(true);
      }
 catch (      DroppedSnapshotException e) {
        LOG.info("On way out; expected!",e);
      }
    }
    if (dodgyWAL != null)     dodgyWAL.close();
    assertTrue("The regionserver should have thrown an exception",threwOnBoth);
    assertTrue("The regionserver should have thrown an exception",threwOnAppend);
    assertTrue("The regionserver should have thrown an exception",threwOnSync);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHMobStore </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Getting the reference data from files
 * @throws IOException
 */
@Test public void testGetReferencesFromFiles() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  init(name.getMethodName(),conf,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(3);
  Scan scan=new Scan(get);
  scan.setAttribute(MobConstants.MOB_SCAN_RAW,Bytes.toBytes(Boolean.TRUE));
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Cell cell=results.get(i);
    Assert.assertTrue(MobUtils.isMobReferenceCell(cell));
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Getting data from memstore and files
 * @throws IOException
 */
@Test public void testMobCellSizeThreshold() throws IOException {
  final Configuration conf=HBaseConfiguration.create();
  HColumnDescriptor hcd;
  hcd=new HColumnDescriptor(family);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(100);
  hcd.setMaxVersions(4);
  init(name.getMethodName(),conf,hcd,false);
  this.store.add(new KeyValue(row,family,qf1,1,value));
  this.store.add(new KeyValue(row,family,qf2,1,value));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,value));
  this.store.add(new KeyValue(row,family,qf4,1,value));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,value));
  this.store.add(new KeyValue(row,family,qf6,1,value));
  flush(3);
  Scan scan=new Scan(get);
  scan.setAttribute(MobConstants.MOB_SCAN_RAW,Bytes.toBytes(Boolean.TRUE));
  InternalScanner scanner=(InternalScanner)store.getScanner(scan,scan.getFamilyMap().get(store.getFamily().getName()),0);
  List<Cell> results=new ArrayList<Cell>();
  scanner.next(results);
  Collections.sort(results,KeyValue.COMPARATOR);
  scanner.close();
  Assert.assertEquals(expected.size(),results.size());
  for (int i=0; i < results.size(); i++) {
    Cell cell=results.get(i);
    Assert.assertFalse(MobUtils.isMobReferenceCell(cell));
    Assert.assertEquals(expected.get(i),results.get(i));
    Assert.assertEquals(100,store.getFamily().getMobThreshold());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegion </h4><pre class="type-10 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testcase to check state of region initialization task set to ABORTED or not
 * if any exceptions during initialization
 * @throws Exception
 */
@Test public void testStatusSettingToAbortIfAnyExceptionDuringRegionInitilization() throws Exception {
  TableName tableName=TableName.valueOf(name.getMethodName());
  HRegionInfo info=null;
  try {
    FileSystem fs=Mockito.mock(FileSystem.class);
    Mockito.when(fs.exists((Path)Mockito.anyObject())).thenThrow(new IOException());
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor("cf"));
    info=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY,false);
    Path path=new Path(dir + "testStatusSettingToAbortIfAnyExceptionDuringRegionInitilization");
    region=HRegion.newHRegion(path,null,fs,CONF,info,htd,null);
    region.initialize();
    fail("Region initialization should fail due to IOException");
  }
 catch (  IOException io) {
    List<MonitoredTask> tasks=TaskMonitor.get().getTasks();
    for (    MonitoredTask monitoredTask : tasks) {
      if (!(monitoredTask instanceof MonitoredRPCHandler) && monitoredTask.getDescription().contains(region.toString())) {
        assertTrue("Region state should be ABORTED.",monitoredTask.getState().equals(MonitoredTask.State.ABORTED));
        break;
      }
    }
  }
 finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_FromMemStore_SingleCF_FullScan() throws IOException {
  byte[] rowC=Bytes.toBytes("rowC");
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] cf=Bytes.toBytes("CF");
  byte[][] families={cf};
  byte[] col=Bytes.toBytes("C");
  long ts=1;
  String method=this.getName();
  this.region=initHRegion(tableName,method,families);
  try {
    KeyValue kv1=new KeyValue(rowC,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(rowC,cf,col,ts + 1,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(rowA,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(rowB,cf,col,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(rowC);
    put.add(kv1);
    put.add(kv11);
    region.put(put);
    put=new Put(rowA);
    put.add(kv2);
    region.put(put);
    put=new Put(rowB);
    put.add(kv3);
    region.put(put);
    Scan scan=new Scan();
    List<Cell> currRow=new ArrayList<Cell>();
    scan.setReversed(true);
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowC,0,rowC.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowB,0,rowB.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowA,0,rowA.length));
    assertFalse(hasNext);
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpenRegionWrittenToWAL() throws Exception {
  final ServerName serverName=ServerName.valueOf("testOpenRegionWrittenToWAL",100,42);
  final RegionServerServices rss=spy(TEST_UTIL.createMockRegionServerService(serverName));
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testOpenRegionWrittenToWAL"));
  htd.addFamily(new HColumnDescriptor(fam1));
  htd.addFamily(new HColumnDescriptor(fam2));
  HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY);
  HRegion region=HBaseTestingUtility.createRegionAndWAL(hri,TEST_UTIL.getDataTestDir(),TEST_UTIL.getConfiguration(),htd);
  assertNotNull(region);
  region.put(new Put(Bytes.toBytes("a")).addColumn(fam1,fam1,fam1));
  region.flush(true);
  HBaseTestingUtility.closeRegionAndWAL(region);
  ArgumentCaptor<WALEdit> editCaptor=ArgumentCaptor.forClass(WALEdit.class);
  WAL wal=mockWAL();
  when(rss.getWAL((HRegionInfo)any())).thenReturn(wal);
  try {
    region=HRegion.openHRegion(hri,htd,rss.getWAL(hri),TEST_UTIL.getConfiguration(),rss,null);
    verify(wal,times(1)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),editCaptor.capture(),anyBoolean());
    WALEdit edit=editCaptor.getValue();
    assertNotNull(edit);
    assertNotNull(edit.getCells());
    assertEquals(1,edit.getCells().size());
    RegionEventDescriptor desc=WALEdit.getRegionEventDescriptor(edit.getCells().get(0));
    assertNotNull(desc);
    LOG.info("RegionEventDescriptor from WAL: " + desc);
    assertEquals(RegionEventDescriptor.EventType.REGION_OPEN,desc.getEventType());
    assertTrue(Bytes.equals(desc.getTableName().toByteArray(),htd.getName()));
    assertTrue(Bytes.equals(desc.getEncodedRegionName().toByteArray(),hri.getEncodedNameAsBytes()));
    assertTrue(desc.getLogSequenceNumber() > 0);
    assertEquals(serverName,ProtobufUtil.toServerName(desc.getServer()));
    assertEquals(2,desc.getStoresCount());
    StoreDescriptor store=desc.getStores(0);
    assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam1));
    assertEquals(store.getStoreHomeDir(),Bytes.toString(fam1));
    assertEquals(1,store.getStoreFileCount());
    assertFalse(store.getStoreFile(0).contains("/"));
    store=desc.getStores(1);
    assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam2));
    assertEquals(store.getStoreHomeDir(),Bytes.toString(fam2));
    assertEquals(0,store.getStoreFileCount());
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_ExplicitColumns_FromFilesOnly_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    region.flush(true);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addColumn(fam1,qf1);
    scan.addColumn(fam1,qf2);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndRowMutateTimestampsAreMonotonic() throws IOException {
  HRegion region=initHRegion(tableName,name.getMethodName(),CONF,fam1);
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  edge.setValue(10);
  Put p=new Put(row);
  p.setDurability(Durability.SKIP_WAL);
  p.addColumn(fam1,qual1,qual1);
  region.put(p);
  Result result=region.get(new Get(row));
  Cell c=result.getColumnLatestCell(fam1,qual1);
  assertNotNull(c);
  assertEquals(c.getTimestamp(),10L);
  edge.setValue(1);
  p=new Put(row);
  p.setDurability(Durability.SKIP_WAL);
  p.addColumn(fam1,qual1,qual2);
  RowMutations rm=new RowMutations(row);
  rm.add(p);
  assertTrue(region.checkAndRowMutate(row,fam1,qual1,CompareOp.EQUAL,new BinaryComparator(qual1),rm,false));
  result=region.get(new Get(row));
  c=result.getColumnLatestCell(fam1,qual1);
  assertEquals(c.getTimestamp(),10L);
  LOG.info("c value " + Bytes.toStringBinary(c.getValueArray(),c.getValueOffset(),c.getValueLength()));
  assertTrue(Bytes.equals(c.getValueArray(),c.getValueOffset(),c.getValueLength(),qual2,0,qual2.length));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Writes very wide records and scans for the latest every time.. Flushes and
 * compacts the region every now and then to keep things realistic.
 * @throws IOExceptionby flush / scan / compaction
 * @throws InterruptedExceptionwhen joining threads
 */
@Test public void testWritesWhileScanning() throws IOException, InterruptedException {
  int testCount=100;
  int numRows=1;
  int numFamilies=10;
  int numQualifiers=100;
  int flushInterval=7;
  int compactInterval=5 * flushInterval;
  byte[][] families=new byte[numFamilies][];
  for (int i=0; i < numFamilies; i++) {
    families[i]=Bytes.toBytes("family" + i);
  }
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++) {
    qualifiers[i]=Bytes.toBytes("qual" + i);
  }
  String method="testWritesWhileScanning";
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    PutThread putThread=new PutThread(numRows,families,qualifiers);
    putThread.start();
    putThread.waitForFirstPut();
    FlushThread flushThread=new FlushThread();
    flushThread.start();
    Scan scan=new Scan(Bytes.toBytes("row0"),Bytes.toBytes("row1"));
    int expectedCount=numFamilies * numQualifiers;
    List<Cell> res=new ArrayList<Cell>();
    long prevTimestamp=0L;
    for (int i=0; i < testCount; i++) {
      if (i != 0 && i % compactInterval == 0) {
        region.compact(true);
      }
      if (i != 0 && i % flushInterval == 0) {
        flushThread.flush();
      }
      boolean previousEmpty=res.isEmpty();
      res.clear();
      InternalScanner scanner=region.getScanner(scan);
      while (scanner.next(res))       ;
      if (!res.isEmpty() || !previousEmpty || i > compactInterval) {
        assertEquals("i=" + i,expectedCount,res.size());
        long timestamp=res.get(0).getTimestamp();
        assertTrue("Timestamps were broke: " + timestamp + " prev: "+ prevTimestamp,timestamp >= prevTimestamp);
        prevTimestamp=timestamp;
      }
    }
    putThread.done();
    region.flush(true);
    putThread.join();
    putThread.checkNoError();
    flushThread.done();
    flushThread.join();
    flushThread.checkNoError();
  }
  finally {
    try {
      HBaseTestingUtility.closeRegionAndWAL(this.region);
    }
 catch (    DroppedSnapshotException dse) {
    }
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet_Basic() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] col1=Bytes.toBytes("col1");
  byte[] col2=Bytes.toBytes("col2");
  byte[] col3=Bytes.toBytes("col3");
  byte[] col4=Bytes.toBytes("col4");
  byte[] col5=Bytes.toBytes("col5");
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    Put put=new Put(row1);
    put.addColumn(fam1,col1,null);
    put.addColumn(fam1,col2,null);
    put.addColumn(fam1,col3,null);
    put.addColumn(fam1,col4,null);
    put.addColumn(fam1,col5,null);
    region.put(put);
    Get get=new Get(row1);
    get.addColumn(fam1,col2);
    get.addColumn(fam1,col4);
    KeyValue kv1=new KeyValue(row1,fam1,col2);
    KeyValue kv2=new KeyValue(row1,fam1,col4);
    KeyValue[] expected={kv1,kv2};
    Result res=region.get(get);
    assertEquals(expected.length,res.size());
    for (int i=0; i < res.size(); i++) {
      assertTrue(CellUtil.matchingRow(expected[i],res.rawCells()[i]));
      assertTrue(CellUtil.matchingFamily(expected[i],res.rawCells()[i]));
      assertTrue(CellUtil.matchingQualifier(expected[i],res.rawCells()[i]));
    }
    Get g=new Get(row1);
    final int count=2;
    g.setFilter(new ColumnCountGetFilter(count));
    res=region.get(g);
    assertEquals(count,res.size());
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Added for HBASE-5416
 * Here we test scan optimization when only subset of CFs are used in filter
 * conditions.
 */
@Test public void testScanner_JoinedScanners() throws IOException {
  byte[] cf_essential=Bytes.toBytes("essential");
  byte[] cf_joined=Bytes.toBytes("joined");
  byte[] cf_alpha=Bytes.toBytes("alpha");
  this.region=initHRegion(tableName,getName(),CONF,cf_essential,cf_joined,cf_alpha);
  try {
    byte[] row1=Bytes.toBytes("row1");
    byte[] row2=Bytes.toBytes("row2");
    byte[] row3=Bytes.toBytes("row3");
    byte[] col_normal=Bytes.toBytes("d");
    byte[] col_alpha=Bytes.toBytes("a");
    byte[] filtered_val=Bytes.toBytes(3);
    Put put=new Put(row1);
    put.addColumn(cf_essential,col_normal,Bytes.toBytes(1));
    put.addColumn(cf_joined,col_alpha,Bytes.toBytes(1));
    region.put(put);
    put=new Put(row2);
    put.addColumn(cf_essential,col_alpha,Bytes.toBytes(2));
    put.addColumn(cf_joined,col_normal,Bytes.toBytes(2));
    put.addColumn(cf_alpha,col_alpha,Bytes.toBytes(2));
    region.put(put);
    put=new Put(row3);
    put.addColumn(cf_essential,col_normal,filtered_val);
    put.addColumn(cf_joined,col_normal,filtered_val);
    region.put(put);
    Scan scan=new Scan();
    Filter filter=new SingleColumnValueExcludeFilter(cf_essential,col_normal,CompareOp.NOT_EQUAL,filtered_val);
    scan.setFilter(filter);
    scan.setLoadColumnFamiliesOnDemand(true);
    InternalScanner s=region.getScanner(scan);
    List<Cell> results=new ArrayList<Cell>();
    assertTrue(s.next(results));
    assertEquals(results.size(),1);
    results.clear();
    assertTrue(s.next(results));
    assertEquals(results.size(),3);
    assertTrue("orderCheck",CellUtil.matchingFamily(results.get(0),cf_alpha));
    assertTrue("orderCheck",CellUtil.matchingFamily(results.get(1),cf_essential));
    assertTrue("orderCheck",CellUtil.matchingFamily(results.get(2),cf_joined));
    results.clear();
    assertFalse(s.next(results));
    assertEquals(results.size(),0);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_smaller_blocksize() throws IOException {
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] rowC=Bytes.toBytes("rowC");
  byte[] rowD=Bytes.toBytes("rowD");
  byte[] rowE=Bytes.toBytes("rowE");
  byte[] cf=Bytes.toBytes("CF");
  byte[][] families={cf};
  byte[] col1=Bytes.toBytes("col1");
  byte[] col2=Bytes.toBytes("col2");
  long ts=1;
  String method=this.getName();
  HBaseConfiguration config=new HBaseConfiguration();
  config.setInt("test.block.size",1);
  this.region=initHRegion(tableName,method,config,families);
  try {
    KeyValue kv1=new KeyValue(rowA,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(rowB,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(rowC,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv4_1=new KeyValue(rowD,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv4_2=new KeyValue(rowD,cf,col2,ts,KeyValue.Type.Put,null);
    KeyValue kv5=new KeyValue(rowE,cf,col1,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(rowA);
    put.add(kv1);
    region.put(put);
    put=new Put(rowB);
    put.add(kv2);
    region.put(put);
    put=new Put(rowC);
    put.add(kv3);
    region.put(put);
    put=new Put(rowD);
    put.add(kv4_1);
    region.put(put);
    put=new Put(rowD);
    put.add(kv4_2);
    region.put(put);
    put=new Put(rowE);
    put.add(kv5);
    region.put(put);
    region.flush(true);
    Scan scan=new Scan(rowD,rowA);
    scan.addColumn(families[0],col1);
    scan.setReversed(true);
    List<Cell> currRow=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowD,0,rowD.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowC,0,rowC.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowB,0,rowB.length));
    assertFalse(hasNext);
    scanner.close();
    scan=new Scan(rowD,rowA);
    scan.addColumn(families[0],col2);
    scan.setReversed(true);
    currRow.clear();
    scanner=region.getScanner(scan);
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowD,0,rowD.length));
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendTimestampsAreMonotonic() throws IOException {
  HRegion region=initHRegion(tableName,name.getMethodName(),CONF,fam1);
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  edge.setValue(10);
  Append a=new Append(row);
  a.setDurability(Durability.SKIP_WAL);
  a.add(fam1,qual1,qual1);
  region.append(a);
  Result result=region.get(new Get(row));
  Cell c=result.getColumnLatestCell(fam1,qual1);
  assertNotNull(c);
  assertEquals(c.getTimestamp(),10L);
  edge.setValue(1);
  region.append(a);
  result=region.get(new Get(row));
  c=result.getColumnLatestCell(fam1,qual1);
  assertEquals(c.getTimestamp(),10L);
  byte[] expected=new byte[qual1.length * 2];
  System.arraycopy(qual1,0,expected,0,qual1.length);
  System.arraycopy(qual1,0,expected,qual1.length,qual1.length);
  assertTrue(Bytes.equals(c.getValueArray(),c.getValueOffset(),c.getValueLength(),expected,0,expected.length));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_ExplicitColumns_FromMemStoreAndFiles_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[][] families={fam1};
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  long ts4=ts1 + 3;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    KeyValue kv14=new KeyValue(row1,fam1,qf1,ts4,KeyValue.Type.Put,null);
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv24=new KeyValue(row1,fam1,qf2,ts4,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(row1);
    put.add(kv14);
    put.add(kv24);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv23);
    put.add(kv13);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv22);
    put.add(kv12);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv21);
    put.add(kv11);
    region.put(put);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv14);
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv24);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addColumn(fam1,qf1);
    scan.addColumn(fam1,qf2);
    int versions=3;
    scan.setMaxVersions(versions);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Writes very wide records and gets the latest row every time.. Flushes and
 * compacts the region aggressivly to catch issues.
 * @throws IOExceptionby flush / scan / compaction
 * @throws InterruptedExceptionwhen joining threads
 */
@Test public void testWritesWhileGetting() throws Exception {
  int testCount=50;
  int numRows=1;
  int numFamilies=10;
  int numQualifiers=100;
  int compactInterval=100;
  byte[][] families=new byte[numFamilies][];
  for (int i=0; i < numFamilies; i++) {
    families[i]=Bytes.toBytes("family" + i);
  }
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++) {
    qualifiers[i]=Bytes.toBytes("qual" + i);
  }
  String method="testWritesWhileGetting";
  Configuration conf=HBaseConfiguration.create(CONF);
  conf.setInt("hbase.hstore.compaction.min",1);
  conf.setInt("hbase.hstore.compaction.max",1000);
  this.region=initHRegion(tableName,method,conf,families);
  PutThread putThread=null;
  MultithreadedTestUtil.TestContext ctx=new MultithreadedTestUtil.TestContext(conf);
  try {
    putThread=new PutThread(numRows,families,qualifiers);
    putThread.start();
    putThread.waitForFirstPut();
    ctx.addThread(new RepeatingTestThread(ctx){
      private int flushesSinceCompact=0;
      private final int maxFlushesSinceCompact=20;
      @Override public void doAnAction() throws Exception {
        if (region.flush(true).isCompactionNeeded()) {
          ++flushesSinceCompact;
        }
        if (flushesSinceCompact == maxFlushesSinceCompact) {
          region.compact(false);
          flushesSinceCompact=0;
        }
      }
    }
);
    ctx.startThreads();
    Get get=new Get(Bytes.toBytes("row0"));
    Result result=null;
    int expectedCount=numFamilies * numQualifiers;
    long prevTimestamp=0L;
    for (int i=0; i < testCount; i++) {
      LOG.info("testWritesWhileGetting verify turn " + i);
      boolean previousEmpty=result == null || result.isEmpty();
      result=region.get(get);
      if (!result.isEmpty() || !previousEmpty || i > compactInterval) {
        assertEquals("i=" + i,expectedCount,result.size());
        long timestamp=0;
        for (        Cell kv : result.rawCells()) {
          if (CellUtil.matchingFamily(kv,families[0]) && CellUtil.matchingQualifier(kv,qualifiers[0])) {
            timestamp=kv.getTimestamp();
          }
        }
        assertTrue(timestamp >= prevTimestamp);
        prevTimestamp=timestamp;
        Cell previousKV=null;
        for (        Cell kv : result.rawCells()) {
          byte[] thisValue=CellUtil.cloneValue(kv);
          if (previousKV != null) {
            if (Bytes.compareTo(CellUtil.cloneValue(previousKV),thisValue) != 0) {
              LOG.warn("These two KV should have the same value." + " Previous KV:" + previousKV + "(memStoreTS:"+ previousKV.getSequenceId()+ ")"+ ", New KV: "+ kv+ "(memStoreTS:"+ kv.getSequenceId()+ ")");
              assertEquals(0,Bytes.compareTo(CellUtil.cloneValue(previousKV),thisValue));
            }
          }
          previousKV=kv;
        }
      }
    }
  }
  finally {
    if (putThread != null)     putThread.done();
    region.flush(true);
    if (putThread != null) {
      putThread.join();
      putThread.checkNoError();
    }
    ctx.stop();
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies that the .regioninfo file is written on region creation and that
 * is recreated if missing during region opening.
 */
@Test public void testRegionInfoFileCreation() throws IOException {
  Path rootDir=new Path(dir + "testRegionInfoFileCreation");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testtb"));
  htd.addFamily(new HColumnDescriptor("cf"));
  HRegionInfo hri=new HRegionInfo(htd.getTableName());
  HRegion region=HBaseTestingUtility.createRegionAndWAL(hri,rootDir,CONF,htd,false);
  Path regionDir=region.getRegionFileSystem().getRegionDir();
  FileSystem fs=region.getRegionFileSystem().getFileSystem();
  HBaseTestingUtility.closeRegionAndWAL(region);
  Path regionInfoFile=new Path(regionDir,HRegionFileSystem.REGION_INFO_FILE);
  assertTrue(HRegionFileSystem.REGION_INFO_FILE + " should be present in the region dir",fs.exists(regionInfoFile));
  region=HRegion.openHRegion(rootDir,hri,htd,null,CONF);
  assertEquals(regionDir,region.getRegionFileSystem().getRegionDir());
  HBaseTestingUtility.closeRegionAndWAL(region);
  assertTrue(HRegionFileSystem.REGION_INFO_FILE + " should be present in the region dir",fs.exists(regionInfoFile));
  fs.delete(regionInfoFile,true);
  assertFalse(HRegionFileSystem.REGION_INFO_FILE + " should be removed from the region dir",fs.exists(regionInfoFile));
  region=HRegion.openHRegion(rootDir,hri,htd,null,CONF);
  assertEquals(regionDir,region.getRegionFileSystem().getRegionDir());
  HBaseTestingUtility.closeRegionAndWAL(region);
  assertTrue(HRegionFileSystem.REGION_INFO_FILE + " should be present in the region dir",fs.exists(new Path(regionDir,HRegionFileSystem.REGION_INFO_FILE)));
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test we do not lose data if we fail a flush and then close.
 * Part of HBase-10466.  Tests the following from the issue description:
 * "Bug 1: Wrong calculation of HRegion.memstoreSize: When a flush fails, data to be flushed is
 * kept in each MemStore's snapshot and wait for next flush attempt to continue on it. But when
 * the next flush succeeds, the counter of total memstore size in HRegion is always deduced by
 * the sum of current memstore sizes instead of snapshots left from previous failed flush. This
 * calculation is problematic that almost every time there is failed flush, HRegion.memstoreSize
 * gets reduced by a wrong value. If region flush could not proceed for a couple cycles, the size
 * in current memstore could be much larger than the snapshot. It's likely to drift memstoreSize
 * much smaller than expected. In extreme case, if the error accumulates to even bigger than
 * HRegion's memstore size limit, any further flush is skipped because flush does not do anything
 * if memstoreSize is not larger than 0."
 * @throws Exception
 */
@Test(timeout=60000) public void testFlushSizeAccounting() throws Exception {
  final Configuration conf=HBaseConfiguration.create(CONF);
  final String callingMethod=name.getMethodName();
  final WAL wal=createWALCompatibleWithFaultyFileSystem(callingMethod,conf,tableName);
  conf.setInt("hbase.hstore.flush.retries.number",1);
  final User user=User.createUserForTesting(conf,this.name.getMethodName(),new String[]{"foo"});
  conf.setClass("fs.file.impl",FaultyFileSystem.class,FileSystem.class);
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      FileSystem fs=FileSystem.get(conf);
      Assert.assertEquals(FaultyFileSystem.class,fs.getClass());
      FaultyFileSystem ffs=(FaultyFileSystem)fs;
      HRegion region=null;
      try {
        region=initHRegion(tableName,null,null,callingMethod,conf,false,Durability.SYNC_WAL,wal,COLUMN_FAMILY_BYTES);
        long size=region.getMemstoreSize();
        Assert.assertEquals(0,size);
        Put p1=new Put(row);
        p1.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual1,1,(byte[])null));
        region.put(p1);
        final long sizeOfOnePut=region.getMemstoreSize();
        try {
          LOG.info("Flushing");
          region.flush(true);
          Assert.fail("Didn't bubble up IOE!");
        }
 catch (        DroppedSnapshotException dse) {
          region.closing.set(false);
        }
        ffs.fault.set(false);
        Assert.assertEquals(sizeOfOnePut,region.getMemstoreSize());
        Put p2=new Put(row);
        p2.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual2,2,(byte[])null));
        p2.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual3,3,(byte[])null));
        region.put(p2);
        Assert.assertEquals(sizeOfOnePut * 3,region.getMemstoreSize());
        region.flush(true);
        Assert.assertEquals(sizeOfOnePut * 2,region.getMemstoreSize());
      }
  finally {
        HBaseTestingUtility.closeRegionAndWAL(region);
      }
      return null;
    }
  }
);
  FileSystem.closeAllForUGI(user.getUGI());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseRegionWrittenToWAL() throws Exception {
  final ServerName serverName=ServerName.valueOf("testCloseRegionWrittenToWAL",100,42);
  final RegionServerServices rss=spy(TEST_UTIL.createMockRegionServerService(serverName));
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testOpenRegionWrittenToWAL"));
  htd.addFamily(new HColumnDescriptor(fam1));
  htd.addFamily(new HColumnDescriptor(fam2));
  final HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY);
  ArgumentCaptor<WALEdit> editCaptor=ArgumentCaptor.forClass(WALEdit.class);
  WAL wal=mockWAL();
  when(rss.getWAL((HRegionInfo)any())).thenReturn(wal);
  region=HRegion.openHRegion(hri,htd,rss.getWAL(hri),TEST_UTIL.getConfiguration(),rss,null);
  region.close(false);
  verify(wal,times(2)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),editCaptor.capture(),anyBoolean());
  WALEdit edit=editCaptor.getAllValues().get(1);
  assertNotNull(edit);
  assertNotNull(edit.getCells());
  assertEquals(1,edit.getCells().size());
  RegionEventDescriptor desc=WALEdit.getRegionEventDescriptor(edit.getCells().get(0));
  assertNotNull(desc);
  LOG.info("RegionEventDescriptor from WAL: " + desc);
  assertEquals(RegionEventDescriptor.EventType.REGION_CLOSE,desc.getEventType());
  assertTrue(Bytes.equals(desc.getTableName().toByteArray(),htd.getName()));
  assertTrue(Bytes.equals(desc.getEncodedRegionName().toByteArray(),hri.getEncodedNameAsBytes()));
  assertTrue(desc.getLogSequenceNumber() > 0);
  assertEquals(serverName,ProtobufUtil.toServerName(desc.getServer()));
  assertEquals(2,desc.getStoresCount());
  StoreDescriptor store=desc.getStores(0);
  assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam1));
  assertEquals(store.getStoreHomeDir(),Bytes.toString(fam1));
  assertEquals(0,store.getStoreFileCount());
  store=desc.getStores(1);
  assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam2));
  assertEquals(store.getStoreHomeDir(),Bytes.toString(fam2));
  assertEquals(0,store.getStoreFileCount());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndMutateTimestampsAreMonotonic() throws IOException {
  HRegion region=initHRegion(tableName,name.getMethodName(),CONF,fam1);
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  edge.setValue(10);
  Put p=new Put(row);
  p.setDurability(Durability.SKIP_WAL);
  p.addColumn(fam1,qual1,qual1);
  region.put(p);
  Result result=region.get(new Get(row));
  Cell c=result.getColumnLatestCell(fam1,qual1);
  assertNotNull(c);
  assertEquals(c.getTimestamp(),10L);
  edge.setValue(1);
  p=new Put(row);
  p.setDurability(Durability.SKIP_WAL);
  p.addColumn(fam1,qual1,qual2);
  region.checkAndMutate(row,fam1,qual1,CompareOp.EQUAL,new BinaryComparator(qual1),p,false);
  result=region.get(new Get(row));
  c=result.getColumnLatestCell(fam1,qual1);
  assertEquals(c.getTimestamp(),10L);
  assertTrue(Bytes.equals(c.getValueArray(),c.getValueOffset(),c.getValueLength(),qual2,0,qual2.length));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for HBASE-14229: Flushing canceled by coprocessor still leads to memstoreSize set down
 */
@Test public void testMemstoreSizeWithFlushCanceling() throws IOException {
  FileSystem fs=FileSystem.get(CONF);
  Path rootDir=new Path(dir + "testMemstoreSizeWithFlushCanceling");
  FSHLog hLog=new FSHLog(fs,rootDir,"testMemstoreSizeWithFlushCanceling",CONF);
  HRegion region=initHRegion(tableName,null,null,name.getMethodName(),CONF,false,Durability.SYNC_WAL,hLog,COLUMN_FAMILY_BYTES);
  Store store=region.getStore(COLUMN_FAMILY_BYTES);
  assertEquals(0,region.getMemstoreSize());
  byte[] value=Bytes.toBytes(name.getMethodName());
  Put put=new Put(value);
  put.addColumn(COLUMN_FAMILY_BYTES,Bytes.toBytes("abc"),value);
  region.put(put);
  long onePutSize=region.getMemstoreSize();
  assertTrue(onePutSize > 0);
  region.flush(true);
  assertEquals("memstoreSize should be zero",0,region.getMemstoreSize());
  assertEquals("flushable size should be zero",0,store.getFlushableSize());
  RegionCoprocessorHost normalCPHost=region.getCoprocessorHost();
  RegionCoprocessorHost mockedCPHost=Mockito.mock(RegionCoprocessorHost.class);
  when(mockedCPHost.preFlush(Mockito.isA(HStore.class),Mockito.isA(InternalScanner.class))).thenReturn(null);
  region.setCoprocessorHost(mockedCPHost);
  region.put(put);
  region.flush(true);
  assertEquals("memstoreSize should NOT be zero",onePutSize,region.getMemstoreSize());
  assertEquals("flushable size should NOT be zero",onePutSize,store.getFlushableSize());
  region.setCoprocessorHost(normalCPHost);
  region.flush(true);
  assertEquals("memstoreSize should be zero",0,region.getMemstoreSize());
  assertEquals("flushable size should be zero",0,store.getFlushableSize());
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCellTTLs() throws IOException {
  IncrementingEnvironmentEdge edge=new IncrementingEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  final byte[] row=Bytes.toBytes("testRow");
  final byte[] q1=Bytes.toBytes("q1");
  final byte[] q2=Bytes.toBytes("q2");
  final byte[] q3=Bytes.toBytes("q3");
  final byte[] q4=Bytes.toBytes("q4");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testCellTTLs"));
  HColumnDescriptor hcd=new HColumnDescriptor(fam1);
  hcd.setTimeToLive(10);
  htd.addFamily(hcd);
  Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  conf.setInt(HFile.FORMAT_VERSION_KEY,HFile.MIN_FORMAT_VERSION_WITH_TAGS);
  HRegion region=HBaseTestingUtility.createRegionAndWAL(new HRegionInfo(htd.getTableName(),HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY),TEST_UTIL.getDataTestDir(),conf,htd);
  assertNotNull(region);
  try {
    long now=EnvironmentEdgeManager.currentTime();
    region.put(new Put(row).add(new KeyValue(row,fam1,q1,now,HConstants.EMPTY_BYTE_ARRAY,new ArrayBackedTag[]{new ArrayBackedTag(TagType.TTL_TAG_TYPE,Bytes.toBytes(5000L))})));
    region.put(new Put(row).addColumn(fam1,q2,now,HConstants.EMPTY_BYTE_ARRAY));
    region.put(new Put(row).add(new KeyValue(row,fam1,q3,now + 10000 - 1,HConstants.EMPTY_BYTE_ARRAY,new ArrayBackedTag[]{new ArrayBackedTag(TagType.TTL_TAG_TYPE,Bytes.toBytes(5000L))})));
    region.put(new Put(row).addColumn(fam1,q4,now + 10000 - 1,HConstants.EMPTY_BYTE_ARRAY));
    region.flush(true);
    Result r=region.get(new Get(row));
    assertNotNull(r.getValue(fam1,q1));
    assertNotNull(r.getValue(fam1,q2));
    assertNotNull(r.getValue(fam1,q3));
    assertNotNull(r.getValue(fam1,q4));
    edge.incrementTime(5000);
    r=region.get(new Get(row));
    assertNull(r.getValue(fam1,q1));
    assertNotNull(r.getValue(fam1,q2));
    assertNotNull(r.getValue(fam1,q3));
    assertNotNull(r.getValue(fam1,q4));
    edge.incrementTime(5000);
    r=region.get(new Get(row));
    assertNull(r.getValue(fam1,q1));
    assertNull(r.getValue(fam1,q2));
    assertNotNull(r.getValue(fam1,q3));
    assertNotNull(r.getValue(fam1,q4));
    edge.incrementTime(5000);
    r=region.get(new Get(row));
    assertNull(r.getValue(fam1,q1));
    assertNull(r.getValue(fam1,q2));
    assertNull(r.getValue(fam1,q3));
    assertNotNull(r.getValue(fam1,q4));
    edge.incrementTime(10000);
    r=region.get(new Get(row));
    assertNull(r.getValue(fam1,q1));
    assertNull(r.getValue(fam1,q2));
    assertNull(r.getValue(fam1,q3));
    assertNull(r.getValue(fam1,q4));
    region.put(new Put(row).addColumn(fam1,q1,Bytes.toBytes(1L)));
    r=region.get(new Get(row));
    byte[] val=r.getValue(fam1,q1);
    assertNotNull(val);
    assertEquals(Bytes.toLong(val),1L);
    Increment incr=new Increment(row).addColumn(fam1,q1,1L);
    incr.setTTL(5000);
    region.increment(incr);
    r=region.get(new Get(row));
    val=r.getValue(fam1,q1);
    assertNotNull(val);
    assertEquals(Bytes.toLong(val),2L);
    edge.incrementTime(5000);
    r=region.get(new Get(row));
    val=r.getValue(fam1,q1);
    assertNotNull(val);
    assertEquals(Bytes.toLong(val),1L);
    edge.incrementTime(5000);
    r=region.get(new Get(row));
    assertNull(r.getValue(fam1,q1));
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_Wildcard_FromFilesOnly_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("qualifier2");
  byte[] fam1=Bytes.toBytes("fam1");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    Put put=null;
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    put=new Put(row1);
    put.add(kv13);
    put.add(kv12);
    put.add(kv11);
    put.add(kv23);
    put.add(kv22);
    put.add(kv21);
    region.put(put);
    region.flush(true);
    List<Cell> expected=new ArrayList<Cell>();
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    scan.addFamily(fam1);
    scan.setMaxVersions(MAX_VERSIONS);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the special LATEST_TIMESTAMP option for puts gets replaced by
 * the actual timestamp
 */
@Test public void testPutWithLatestTS() throws IOException {
  byte[] fam=Bytes.toBytes("info");
  byte[][] families={fam};
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,families);
  try {
    byte[] row=Bytes.toBytes("row1");
    byte[] qual=Bytes.toBytes("qual");
    Put put=new Put(row);
    put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,Bytes.toBytes("value"));
    region.put(put);
    Get get=new Get(row).addColumn(fam,qual);
    Result result=region.get(get);
    assertEquals(1,result.size());
    Cell kv=result.rawCells()[0];
    LOG.info("Got: " + kv);
    assertTrue("LATEST_TIMESTAMP was not replaced with real timestamp",kv.getTimestamp() != HConstants.LATEST_TIMESTAMP);
    row=Bytes.toBytes("row2");
    put=new Put(row);
    put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,Bytes.toBytes("value"));
    region.put(put);
    get=new Get(row).addColumn(fam,qual);
    result=region.get(get);
    assertEquals(1,result.size());
    kv=result.rawCells()[0];
    LOG.info("Got: " + kv);
    assertTrue("LATEST_TIMESTAMP was not replaced with real timestamp",kv.getTimestamp() != HConstants.LATEST_TIMESTAMP);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_FromMemStore_SingleCF_Normal() throws IOException {
  byte[] rowC=Bytes.toBytes("rowC");
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] cf=Bytes.toBytes("CF");
  byte[][] families={cf};
  byte[] col=Bytes.toBytes("C");
  long ts=1;
  String method=this.getName();
  this.region=initHRegion(tableName,method,families);
  try {
    KeyValue kv1=new KeyValue(rowC,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(rowC,cf,col,ts + 1,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(rowA,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(rowB,cf,col,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(rowC);
    put.add(kv1);
    put.add(kv11);
    region.put(put);
    put=new Put(rowA);
    put.add(kv2);
    region.put(put);
    put=new Put(rowB);
    put.add(kv3);
    region.put(put);
    Scan scan=new Scan(rowC);
    scan.setMaxVersions(5);
    scan.setReversed(true);
    InternalScanner scanner=region.getScanner(scan);
    List<Cell> currRow=new ArrayList<Cell>();
    boolean hasNext=scanner.next(currRow);
    assertEquals(2,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowC,0,rowC.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowB,0,rowB.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowA,0,rowA.length));
    assertFalse(hasNext);
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_FromMemStoreAndHFiles_MultiCFs1() throws IOException {
  byte[] row0=Bytes.toBytes("row0");
  byte[] row1=Bytes.toBytes("row1");
  byte[] row2=Bytes.toBytes("row2");
  byte[] row3=Bytes.toBytes("row3");
  byte[] row4=Bytes.toBytes("row4");
  byte[] row5=Bytes.toBytes("row5");
  byte[] cf1=Bytes.toBytes("CF1");
  byte[] cf2=Bytes.toBytes("CF2");
  byte[] cf3=Bytes.toBytes("CF3");
  byte[][] families={cf1,cf2,cf3};
  byte[] col=Bytes.toBytes("C");
  long ts=1;
  String method=this.getName();
  HBaseConfiguration conf=new HBaseConfiguration();
  conf.setInt("hbase.hstore.compactionThreshold",10000);
  this.region=initHRegion(tableName,method,conf,families);
  try {
    KeyValue kv0_1_1=new KeyValue(row0,cf1,col,ts,KeyValue.Type.Put,null);
    KeyValue kv1_2_1=new KeyValue(row1,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv1_2_2=new KeyValue(row1,cf1,col,ts + 1,KeyValue.Type.Put,null);
    KeyValue kv2_4_1=new KeyValue(row2,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv2_4_2=new KeyValue(row2,cf1,col,ts,KeyValue.Type.Put,null);
    KeyValue kv2_4_3=new KeyValue(row2,cf3,col,ts,KeyValue.Type.Put,null);
    KeyValue kv2_4_4=new KeyValue(row2,cf1,col,ts + 4,KeyValue.Type.Put,null);
    KeyValue kv3_2_1=new KeyValue(row3,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv3_2_2=new KeyValue(row3,cf1,col,ts + 4,KeyValue.Type.Put,null);
    KeyValue kv4_5_1=new KeyValue(row4,cf1,col,ts,KeyValue.Type.Put,null);
    KeyValue kv4_5_2=new KeyValue(row4,cf3,col,ts,KeyValue.Type.Put,null);
    KeyValue kv4_5_3=new KeyValue(row4,cf3,col,ts + 5,KeyValue.Type.Put,null);
    KeyValue kv4_5_4=new KeyValue(row4,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv4_5_5=new KeyValue(row4,cf1,col,ts + 3,KeyValue.Type.Put,null);
    KeyValue kv5_2_1=new KeyValue(row5,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv5_2_2=new KeyValue(row5,cf3,col,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(row1);
    put.add(kv1_2_1);
    region.put(put);
    put=new Put(row2);
    put.add(kv2_4_1);
    region.put(put);
    put=new Put(row4);
    put.add(kv4_5_4);
    put.add(kv4_5_5);
    region.put(put);
    region.flush(true);
    put=new Put(row4);
    put.add(kv4_5_1);
    put.add(kv4_5_3);
    region.put(put);
    put=new Put(row1);
    put.add(kv1_2_2);
    region.put(put);
    put=new Put(row2);
    put.add(kv2_4_4);
    region.put(put);
    region.flush(true);
    put=new Put(row4);
    put.add(kv4_5_2);
    region.put(put);
    put=new Put(row2);
    put.add(kv2_4_2);
    put.add(kv2_4_3);
    region.put(put);
    put=new Put(row3);
    put.add(kv3_2_2);
    region.put(put);
    region.flush(true);
    put=new Put(row0);
    put.add(kv0_1_1);
    region.put(put);
    put=new Put(row3);
    put.add(kv3_2_1);
    region.put(put);
    put=new Put(row5);
    put.add(kv5_2_1);
    put.add(kv5_2_2);
    region.put(put);
    Scan scan=new Scan(row4);
    scan.setMaxVersions(5);
    scan.setBatch(3);
    scan.setReversed(true);
    InternalScanner scanner=region.getScanner(scan);
    List<Cell> currRow=new ArrayList<Cell>();
    boolean hasNext=false;
    hasNext=scanner.next(currRow);
    assertEquals(3,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row4,0,row4.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(2,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row4,0,row4.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(2,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row3,0,row3.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(3,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row2,0,row2.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row2,0,row2.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(2,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row1,0,row1.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row0,0,row0.length));
    assertFalse(hasNext);
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_moreRowsMayExistAfter() throws IOException {
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] rowC=Bytes.toBytes("rowC");
  byte[] rowD=Bytes.toBytes("rowD");
  byte[] rowE=Bytes.toBytes("rowE");
  byte[] cf=Bytes.toBytes("CF");
  byte[][] families={cf};
  byte[] col1=Bytes.toBytes("col1");
  byte[] col2=Bytes.toBytes("col2");
  long ts=1;
  String method=this.getName();
  this.region=initHRegion(tableName,method,families);
  try {
    KeyValue kv1=new KeyValue(rowA,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(rowB,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(rowC,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv4_1=new KeyValue(rowD,cf,col1,ts,KeyValue.Type.Put,null);
    KeyValue kv4_2=new KeyValue(rowD,cf,col2,ts,KeyValue.Type.Put,null);
    KeyValue kv5=new KeyValue(rowE,cf,col1,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(rowA);
    put.add(kv1);
    region.put(put);
    put=new Put(rowB);
    put.add(kv2);
    region.put(put);
    put=new Put(rowC);
    put.add(kv3);
    region.put(put);
    put=new Put(rowD);
    put.add(kv4_1);
    region.put(put);
    put=new Put(rowD);
    put.add(kv4_2);
    region.put(put);
    put=new Put(rowE);
    put.add(kv5);
    region.put(put);
    region.flush(true);
    Scan scan=new Scan(rowD,rowA);
    scan.addColumn(families[0],col1);
    scan.setReversed(true);
    List<Cell> currRow=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowD,0,rowD.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowC,0,rowC.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowB,0,rowB.length));
    assertFalse(hasNext);
    scanner.close();
    scan=new Scan(rowD,rowA);
    scan.addColumn(families[0],col2);
    scan.setReversed(true);
    currRow.clear();
    scanner=region.getScanner(scan);
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowD,0,rowD.length));
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_FromMemStore_SingleCF_LargerKey() throws IOException {
  byte[] rowC=Bytes.toBytes("rowC");
  byte[] rowA=Bytes.toBytes("rowA");
  byte[] rowB=Bytes.toBytes("rowB");
  byte[] rowD=Bytes.toBytes("rowD");
  byte[] cf=Bytes.toBytes("CF");
  byte[][] families={cf};
  byte[] col=Bytes.toBytes("C");
  long ts=1;
  String method=this.getName();
  this.region=initHRegion(tableName,method,families);
  try {
    KeyValue kv1=new KeyValue(rowC,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(rowC,cf,col,ts + 1,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(rowA,cf,col,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(rowB,cf,col,ts,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(rowC);
    put.add(kv1);
    put.add(kv11);
    region.put(put);
    put=new Put(rowA);
    put.add(kv2);
    region.put(put);
    put=new Put(rowB);
    put.add(kv3);
    region.put(put);
    Scan scan=new Scan(rowD);
    List<Cell> currRow=new ArrayList<Cell>();
    scan.setReversed(true);
    scan.setMaxVersions(5);
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(currRow);
    assertEquals(2,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowC,0,rowC.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowB,0,rowB.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),rowA,0,rowA.length));
    assertFalse(hasNext);
    scanner.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanner_Wildcard_FromMemStoreAndFiles_EnforceVersions() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] qf1=Bytes.toBytes("qualifier1");
  byte[] qf2=Bytes.toBytes("quateslifier2");
  long ts1=1;
  long ts2=ts1 + 1;
  long ts3=ts1 + 2;
  long ts4=ts1 + 3;
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1);
  try {
    KeyValue kv14=new KeyValue(row1,fam1,qf1,ts4,KeyValue.Type.Put,null);
    KeyValue kv13=new KeyValue(row1,fam1,qf1,ts3,KeyValue.Type.Put,null);
    KeyValue kv12=new KeyValue(row1,fam1,qf1,ts2,KeyValue.Type.Put,null);
    KeyValue kv11=new KeyValue(row1,fam1,qf1,ts1,KeyValue.Type.Put,null);
    KeyValue kv24=new KeyValue(row1,fam1,qf2,ts4,KeyValue.Type.Put,null);
    KeyValue kv23=new KeyValue(row1,fam1,qf2,ts3,KeyValue.Type.Put,null);
    KeyValue kv22=new KeyValue(row1,fam1,qf2,ts2,KeyValue.Type.Put,null);
    KeyValue kv21=new KeyValue(row1,fam1,qf2,ts1,KeyValue.Type.Put,null);
    Put put=null;
    put=new Put(row1);
    put.add(kv14);
    put.add(kv24);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv23);
    put.add(kv13);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv22);
    put.add(kv12);
    region.put(put);
    region.flush(true);
    put=new Put(row1);
    put.add(kv21);
    put.add(kv11);
    region.put(put);
    List<KeyValue> expected=new ArrayList<KeyValue>();
    expected.add(kv14);
    expected.add(kv13);
    expected.add(kv12);
    expected.add(kv24);
    expected.add(kv23);
    expected.add(kv22);
    Scan scan=new Scan(row1);
    int versions=3;
    scan.setMaxVersions(versions);
    List<Cell> actual=new ArrayList<Cell>();
    InternalScanner scanner=region.getScanner(scan);
    boolean hasNext=scanner.next(actual);
    assertEquals(false,hasNext);
    for (int i=0; i < expected.size(); i++) {
      assertTrue(CellUtil.equalsIgnoreMvccVersion(expected.get(i),actual.get(i)));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearForceSplit() throws IOException {
  byte[] qualifier=Bytes.toBytes("qualifier");
  Configuration hc=initSplit();
  int numRows=10;
  byte[][] families={fam1,fam3};
  String method=this.getName();
  this.region=initHRegion(tableName,method,hc,families);
  int startRow=100;
  putData(startRow,numRows,qualifier,families);
  int splitRow=startRow + numRows;
  byte[] splitRowBytes=Bytes.toBytes("" + splitRow);
  putData(splitRow,numRows,qualifier,families);
  region.flush(true);
  HRegion[] regions=null;
  try {
    region.forceSplit(splitRowBytes);
    assertTrue(region.shouldForceSplit());
    assertTrue(Bytes.equals(splitRowBytes,region.checkSplit()));
    HStore storeMock=Mockito.mock(HStore.class);
    when(storeMock.hasReferences()).thenReturn(true);
    when(storeMock.getFamily()).thenReturn(new HColumnDescriptor("cf"));
    when(storeMock.close()).thenReturn(ImmutableList.<StoreFile>of());
    when(storeMock.getColumnFamilyName()).thenReturn("cf");
    region.stores.put(Bytes.toBytes(storeMock.getColumnFamilyName()),storeMock);
    assertTrue(region.hasReferences());
    regions=splitRegion(region,splitRowBytes);
    assertNull(regions);
    assertFalse(region.shouldForceSplit());
    region.stores.remove(Bytes.toBytes(storeMock.getColumnFamilyName()));
    assertFalse(region.hasReferences());
    regions=splitRegion(region,splitRowBytes);
    for (int i=0; i < regions.length; i++) {
      regions[i]=HRegion.openHRegion(regions[i],null);
    }
    assertEquals(2,regions.length);
    verifyData(regions[0],startRow,numRows,qualifier,families);
    verifyData(regions[1],splitRow,numRows,qualifier,families);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testCloseWithFailingFlush() throws Exception {
  final Configuration conf=HBaseConfiguration.create(CONF);
  final String callingMethod=name.getMethodName();
  final WAL wal=createWALCompatibleWithFaultyFileSystem(callingMethod,conf,tableName);
  conf.setInt("hbase.hstore.flush.retries.number",1);
  final User user=User.createUserForTesting(conf,this.name.getMethodName(),new String[]{"foo"});
  conf.setClass("fs.file.impl",FaultyFileSystem.class,FileSystem.class);
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      FileSystem fs=FileSystem.get(conf);
      Assert.assertEquals(FaultyFileSystem.class,fs.getClass());
      FaultyFileSystem ffs=(FaultyFileSystem)fs;
      HRegion region=null;
      try {
        region=initHRegion(tableName,null,null,callingMethod,conf,false,Durability.SYNC_WAL,wal,COLUMN_FAMILY_BYTES);
        long size=region.getMemstoreSize();
        Assert.assertEquals(0,size);
        Put p1=new Put(row);
        p1.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual1,1,(byte[])null));
        region.put(p1);
        Store store=region.getStore(COLUMN_FAMILY_BYTES);
        StoreFlushContext storeFlushCtx=store.createFlushContext(12345);
        storeFlushCtx.prepare();
        Put p2=new Put(row);
        p2.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual2,2,(byte[])null));
        p2.add(new KeyValue(row,COLUMN_FAMILY_BYTES,qual3,3,(byte[])null));
        region.put(p2);
        region.close();
        fail();
      }
 catch (      DroppedSnapshotException dse) {
        LOG.info("Expected DroppedSnapshotException");
      }
 finally {
        ffs.fault.set(false);
        HBaseTestingUtility.closeRegionAndWAL(region);
      }
      return null;
    }
  }
);
  FileSystem.closeAllForUGI(user.getUGI());
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelete_CheckFamily() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] fam2=Bytes.toBytes("fam2");
  byte[] fam3=Bytes.toBytes("fam3");
  byte[] fam4=Bytes.toBytes("fam4");
  String method=this.getName();
  this.region=initHRegion(tableName,method,CONF,fam1,fam2,fam3);
  try {
    List<Cell> kvs=new ArrayList<Cell>();
    kvs.add(new KeyValue(row1,fam4,null,null));
    byte[] family=fam2;
    try {
      NavigableMap<byte[],List<Cell>> deleteMap=new TreeMap<byte[],List<Cell>>(Bytes.BYTES_COMPARATOR);
      deleteMap.put(family,kvs);
      region.delete(deleteMap,Durability.SYNC_WAL);
    }
 catch (    Exception e) {
      assertTrue("Family " + new String(family) + " does not exist",false);
    }
    boolean ok=false;
    family=fam4;
    try {
      NavigableMap<byte[],List<Cell>> deleteMap=new TreeMap<byte[],List<Cell>>(Bytes.BYTES_COMPARATOR);
      deleteMap.put(family,kvs);
      region.delete(deleteMap,Durability.SYNC_WAL);
    }
 catch (    Exception e) {
      ok=true;
    }
    assertEquals("Family " + new String(family) + " does exist",true,ok);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushMarkers() throws Exception {
  String method=name.getMethodName();
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  Path logDir=TEST_UTIL.getDataTestDirOnTestFS(method + ".log");
  final Configuration walConf=new Configuration(TEST_UTIL.getConfiguration());
  FSUtils.setRootDir(walConf,logDir);
  final WALFactory wals=new WALFactory(walConf,null,method);
  final WAL wal=wals.getWAL(tableName.getName(),tableName.getNamespace());
  this.region=initHRegion(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,method,CONF,false,Durability.USE_DEFAULT,wal,family);
  try {
    Path regiondir=region.getRegionFileSystem().getRegionDir();
    FileSystem fs=region.getRegionFileSystem().getFileSystem();
    byte[] regionName=region.getRegionInfo().getEncodedNameAsBytes();
    long maxSeqId=3;
    long minSeqId=0;
    for (long i=minSeqId; i < maxSeqId; i++) {
      Put put=new Put(Bytes.toBytes(i));
      put.addColumn(family,Bytes.toBytes(i),Bytes.toBytes(i));
      region.put(put);
      region.flush(true);
    }
    assertEquals(3,region.getStore(family).getStorefilesCount());
    List<String> storeFiles=new ArrayList<String>(3);
    for (    StoreFile sf : region.getStore(family).getStorefiles()) {
      storeFiles.add(sf.getPath().getName());
    }
    wal.shutdown();
    WAL.Reader reader=WALFactory.createReader(fs,DefaultWALProvider.getCurrentFileName(wal),TEST_UTIL.getConfiguration());
    try {
      List<WAL.Entry> flushDescriptors=new ArrayList<WAL.Entry>();
      long lastFlushSeqId=-1;
      while (true) {
        WAL.Entry entry=reader.next();
        if (entry == null) {
          break;
        }
        Cell cell=entry.getEdit().getCells().get(0);
        if (WALEdit.isMetaEditFamily(cell)) {
          FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(cell);
          assertNotNull(flushDesc);
          assertArrayEquals(tableName.getName(),flushDesc.getTableName().toByteArray());
          if (flushDesc.getAction() == FlushAction.START_FLUSH) {
            assertTrue(flushDesc.getFlushSequenceNumber() > lastFlushSeqId);
          }
 else           if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
            assertTrue(flushDesc.getFlushSequenceNumber() == lastFlushSeqId);
          }
          lastFlushSeqId=flushDesc.getFlushSequenceNumber();
          assertArrayEquals(regionName,flushDesc.getEncodedRegionName().toByteArray());
          assertEquals(1,flushDesc.getStoreFlushesCount());
          StoreFlushDescriptor storeFlushDesc=flushDesc.getStoreFlushes(0);
          assertArrayEquals(family,storeFlushDesc.getFamilyName().toByteArray());
          assertEquals("family",storeFlushDesc.getStoreHomeDir());
          if (flushDesc.getAction() == FlushAction.START_FLUSH) {
            assertEquals(0,storeFlushDesc.getFlushOutputCount());
          }
 else {
            assertEquals(1,storeFlushDesc.getFlushOutputCount());
            assertTrue(storeFiles.contains(storeFlushDesc.getFlushOutput(0)));
          }
          flushDescriptors.add(entry);
        }
      }
      assertEquals(3 * 2,flushDescriptors.size());
      Path recoveredEditsDir=WALSplitter.getRegionDirRecoveredEditsDir(regiondir);
      Path recoveredEdits=new Path(recoveredEditsDir,String.format("%019d",1000));
      fs.create(recoveredEdits);
      WALProvider.Writer writer=wals.createRecoveredEditsWriter(fs,recoveredEdits);
      for (      WAL.Entry entry : flushDescriptors) {
        writer.append(entry);
      }
      writer.close();
    }
  finally {
      if (null != reader) {
        try {
          reader.close();
        }
 catch (        IOException exception) {
          LOG.warn("Problem closing wal: " + exception.getMessage());
          LOG.debug("exception details",exception);
        }
      }
    }
    region.close();
    region=HRegion.openHRegion(region,null);
    for (long i=minSeqId; i < maxSeqId; i++) {
      Get get=new Get(Bytes.toBytes(i));
      Result result=region.get(get);
      byte[] value=result.getValue(family,Bytes.toBytes(i));
      assertArrayEquals(Bytes.toBytes(i),value);
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
    wals.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that there is server-side filtering for invalid timestamp upper
 * bound. Note that the timestamp lower bound is automatically handled for us
 * by the TTL field.
 */
@Test public void testPutWithTsSlop() throws IOException {
  byte[] fam=Bytes.toBytes("info");
  byte[][] families={fam};
  String method=this.getName();
  CONF.setInt("hbase.hregion.keyvalue.timestamp.slop.millisecs",1000);
  this.region=initHRegion(tableName,method,CONF,families);
  boolean caughtExcep=false;
  try {
    try {
      region.put(new Put(row).addColumn(fam,Bytes.toBytes("qual"),Bytes.toBytes("value")));
      region.put(new Put(row).addColumn(fam,Bytes.toBytes("qual"),System.currentTimeMillis() + 2000,Bytes.toBytes("value")));
      fail("Expected IOE for TS out of configured timerange");
    }
 catch (    FailedSanityCheckException ioe) {
      LOG.debug("Received expected exception",ioe);
      caughtExcep=true;
    }
    assertTrue("Should catch FailedSanityCheckException",caughtExcep);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpenRegionWrittenToWALForLogReplay() throws Exception {
  final ServerName serverName=ServerName.valueOf("testOpenRegionWrittenToWALForLogReplay",100,42);
  final RegionServerServices rss=spy(TEST_UTIL.createMockRegionServerService(serverName));
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testOpenRegionWrittenToWALForLogReplay"));
  htd.addFamily(new HColumnDescriptor(fam1));
  htd.addFamily(new HColumnDescriptor(fam2));
  HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_BYTE_ARRAY,HConstants.EMPTY_BYTE_ARRAY);
  HRegion region=HBaseTestingUtility.createRegionAndWAL(hri,TEST_UTIL.getDataTestDir(),TEST_UTIL.getConfiguration(),htd);
  assertNotNull(region);
  region.put(new Put(Bytes.toBytes("a")).addColumn(fam1,fam1,fam1));
  region.flush(true);
  HBaseTestingUtility.closeRegionAndWAL(region);
  ArgumentCaptor<WALEdit> editCaptor=ArgumentCaptor.forClass(WALEdit.class);
  WAL wal=mockWAL();
  when(rss.getWAL((HRegionInfo)any())).thenReturn(wal);
  HashMap<String,Region> recoveringRegions=Maps.newHashMap();
  recoveringRegions.put(region.getRegionInfo().getEncodedName(),null);
  when(rss.getRecoveringRegions()).thenReturn(recoveringRegions);
  try {
    Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
    conf.set(HConstants.REGION_IMPL,HRegionWithSeqId.class.getName());
    region=HRegion.openHRegion(hri,htd,rss.getWAL(hri),conf,rss,null);
    verify(wal,times(0)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),editCaptor.capture(),anyBoolean());
    new FinishRegionRecoveringHandler(rss,region.getRegionInfo().getEncodedName(),"/foo").prepare().process();
    verify(wal,times(1)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),editCaptor.capture(),anyBoolean());
    WALEdit edit=editCaptor.getValue();
    assertNotNull(edit);
    assertNotNull(edit.getCells());
    assertEquals(1,edit.getCells().size());
    RegionEventDescriptor desc=WALEdit.getRegionEventDescriptor(edit.getCells().get(0));
    assertNotNull(desc);
    LOG.info("RegionEventDescriptor from WAL: " + desc);
    assertEquals(RegionEventDescriptor.EventType.REGION_OPEN,desc.getEventType());
    assertTrue(Bytes.equals(desc.getTableName().toByteArray(),htd.getName()));
    assertTrue(Bytes.equals(desc.getEncodedRegionName().toByteArray(),hri.getEncodedNameAsBytes()));
    assertTrue(desc.getLogSequenceNumber() > 0);
    assertEquals(serverName,ProtobufUtil.toServerName(desc.getServer()));
    assertEquals(2,desc.getStoresCount());
    StoreDescriptor store=desc.getStores(0);
    assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam1));
    assertEquals(store.getStoreHomeDir(),Bytes.toString(fam1));
    assertEquals(1,store.getStoreFileCount());
    assertFalse(store.getStoreFile(0).contains("/"));
    store=desc.getStores(1);
    assertTrue(Bytes.equals(store.getFamilyName().toByteArray(),fam2));
    assertEquals(store.getStoreHomeDir(),Bytes.toString(fam2));
    assertEquals(0,store.getStoreFileCount());
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testReverseScanner_FromMemStoreAndHFiles_MultiCFs2() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] row2=Bytes.toBytes("row2");
  byte[] row3=Bytes.toBytes("row3");
  byte[] row4=Bytes.toBytes("row4");
  byte[] cf1=Bytes.toBytes("CF1");
  byte[] cf2=Bytes.toBytes("CF2");
  byte[] cf3=Bytes.toBytes("CF3");
  byte[] cf4=Bytes.toBytes("CF4");
  byte[][] families={cf1,cf2,cf3,cf4};
  byte[] col=Bytes.toBytes("C");
  long ts=1;
  String method=this.getName();
  HBaseConfiguration conf=new HBaseConfiguration();
  conf.setInt("hbase.hstore.compactionThreshold",10000);
  this.region=initHRegion(tableName,method,conf,families);
  try {
    KeyValue kv1=new KeyValue(row1,cf1,col,ts,KeyValue.Type.Put,null);
    KeyValue kv2=new KeyValue(row2,cf2,col,ts,KeyValue.Type.Put,null);
    KeyValue kv3=new KeyValue(row3,cf3,col,ts,KeyValue.Type.Put,null);
    KeyValue kv4=new KeyValue(row4,cf4,col,ts,KeyValue.Type.Put,null);
    Put put=new Put(row1);
    put.add(kv1);
    region.put(put);
    region.flush(true);
    put=new Put(row2);
    put.add(kv2);
    region.put(put);
    region.flush(true);
    put=new Put(row3);
    put.add(kv3);
    region.put(put);
    region.flush(true);
    put=new Put(row4);
    put.add(kv4);
    region.put(put);
    Scan scan=new Scan(row4);
    scan.setReversed(true);
    scan.setBatch(10);
    InternalScanner scanner=region.getScanner(scan);
    List<Cell> currRow=new ArrayList<Cell>();
    boolean hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row4,0,row4.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row3,0,row3.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row2,0,row2.length));
    assertTrue(hasNext);
    currRow.clear();
    hasNext=scanner.next(currRow);
    assertEquals(1,currRow.size());
    assertTrue(Bytes.equals(currRow.get(0).getRowArray(),currRow.get(0).getRowOffset(),currRow.get(0).getRowLength(),row1,0,row1.length));
    assertFalse(hasNext);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementTimestampsAreMonotonic() throws IOException {
  HRegion region=initHRegion(tableName,name.getMethodName(),CONF,fam1);
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  edge.setValue(10);
  Increment inc=new Increment(row);
  inc.setDurability(Durability.SKIP_WAL);
  inc.addColumn(fam1,qual1,1L);
  region.increment(inc);
  Result result=region.get(new Get(row));
  Cell c=result.getColumnLatestCell(fam1,qual1);
  assertNotNull(c);
  assertEquals(c.getTimestamp(),10L);
  edge.setValue(1);
  region.increment(inc);
  result=region.get(new Get(row));
  c=result.getColumnLatestCell(fam1,qual1);
  assertEquals(c.getTimestamp(),10L);
  assertEquals(Bytes.toLong(c.getValueArray(),c.getValueOffset(),c.getValueLength()),2L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegionFileSystem </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempAndCommit() throws IOException {
  Path rootDir=TEST_UTIL.getDataTestDirOnTestFS("testTempAndCommit");
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  Configuration conf=TEST_UTIL.getConfiguration();
  String familyName="cf";
  HRegionInfo hri=new HRegionInfo(TableName.valueOf("TestTable"));
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(conf,fs,rootDir,hri);
  Collection<StoreFileInfo> storeFiles=regionFs.getStoreFiles(familyName);
  assertEquals(0,storeFiles != null ? storeFiles.size() : 0);
  Path buildPath=regionFs.createTempName();
  fs.createNewFile(buildPath);
  storeFiles=regionFs.getStoreFiles(familyName);
  assertEquals(0,storeFiles != null ? storeFiles.size() : 0);
  Path dstPath=regionFs.commitStoreFile(familyName,buildPath);
  storeFiles=regionFs.getStoreFiles(familyName);
  assertEquals(0,storeFiles != null ? storeFiles.size() : 0);
  assertFalse(fs.exists(buildPath));
  fs.delete(rootDir,true);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnDiskRegionCreation() throws IOException {
  Path rootDir=TEST_UTIL.getDataTestDirOnTestFS("testOnDiskRegionCreation");
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  Configuration conf=TEST_UTIL.getConfiguration();
  HRegionInfo hri=new HRegionInfo(TableName.valueOf("TestTable"));
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(conf,fs,FSUtils.getTableDir(rootDir,hri.getTable()),hri);
  Path regionDir=regionFs.getRegionDir();
  assertTrue("The region folder should be created",fs.exists(regionDir));
  HRegionInfo hriVerify=HRegionFileSystem.loadRegionInfoFileContent(fs,regionDir);
  assertEquals(hri,hriVerify);
  regionFs=HRegionFileSystem.openRegionFromFileSystem(conf,fs,FSUtils.getTableDir(rootDir,hri.getTable()),hri,false);
  assertEquals(regionDir,regionFs.getRegionDir());
  HRegionFileSystem.deleteRegionFromFileSystem(conf,fs,FSUtils.getTableDir(rootDir,hri.getTable()),hri);
  assertFalse("The region folder should be removed",fs.exists(regionDir));
  fs.delete(rootDir,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegionInfo </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAndWriteHRegionInfoFile() throws IOException, InterruptedException {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  HRegionInfo hri=HRegionInfo.FIRST_META_REGIONINFO;
  Path basedir=htu.getDataTestDir();
  FSTableDescriptors fsTableDescriptors=new FSTableDescriptors(htu.getConfiguration());
  HRegion r=HBaseTestingUtility.createRegionAndWAL(hri,basedir,htu.getConfiguration(),fsTableDescriptors.get(TableName.META_TABLE_NAME));
  long modtime=getModTime(r);
  HBaseTestingUtility.closeRegionAndWAL(r);
  Thread.sleep(1001);
  r=HRegion.openHRegion(basedir,hri,fsTableDescriptors.get(TableName.META_TABLE_NAME),null,htu.getConfiguration());
  long modtime2=getModTime(r);
  assertEquals(modtime,modtime2);
  HRegionInfo deserializedHri=HRegionFileSystem.loadRegionInfoFileContent(r.getRegionFileSystem().getFileSystem(),r.getRegionFileSystem().getRegionDir());
  assertTrue(hri.equals(deserializedHri));
  HBaseTestingUtility.closeRegionAndWAL(r);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainsRange(){
  HTableDescriptor tableDesc=new HTableDescriptor(TableName.valueOf("testtable"));
  HRegionInfo hri=new HRegionInfo(tableDesc.getTableName(),Bytes.toBytes("a"),Bytes.toBytes("g"));
  assertTrue(hri.containsRange(Bytes.toBytes("a"),Bytes.toBytes("a")));
  assertTrue(hri.containsRange(Bytes.toBytes("b"),Bytes.toBytes("c")));
  assertTrue(hri.containsRange(Bytes.toBytes("a"),Bytes.toBytes("c")));
  assertTrue(hri.containsRange(Bytes.toBytes("c"),Bytes.toBytes("c")));
  assertFalse(hri.containsRange(Bytes.toBytes("a"),Bytes.toBytes("g")));
  assertFalse(hri.containsRange(Bytes.toBytes("g"),Bytes.toBytes("g")));
  assertFalse(hri.containsRange(Bytes.toBytes("z"),Bytes.toBytes("z")));
  try {
    hri.containsRange(Bytes.toBytes("z"),Bytes.toBytes("a"));
    fail("Invalid range did not throw IAE");
  }
 catch (  IllegalArgumentException iae) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegionReplayEvents </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshStoreFiles() throws IOException {
  assertEquals(0,primaryRegion.getStoreFileList(families).size());
  assertEquals(0,secondaryRegion.getStoreFileList(families).size());
  secondaryRegion.refreshStoreFiles();
  assertEquals(0,secondaryRegion.getStoreFileList(families).size());
  putDataWithFlushes(primaryRegion,100,100,0);
  int numRows=100;
  secondaryRegion.refreshStoreFiles();
  assertPathListsEqual(primaryRegion.getStoreFileList(families),secondaryRegion.getStoreFileList(families));
  assertEquals(families.length,secondaryRegion.getStoreFileList(families).size());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  putDataWithFlushes(primaryRegion,100,300,0);
  numRows=300;
  secondaryRegion.refreshStoreFiles();
  assertPathListsEqual(primaryRegion.getStoreFileList(families),secondaryRegion.getStoreFileList(families));
  assertEquals(families.length * 4,secondaryRegion.getStoreFileList(families).size());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  if (FSUtils.WINDOWS) {
    return;
  }
  primaryRegion.compactStores();
  List<Region> regions=new ArrayList<Region>();
  regions.add(primaryRegion);
  when(rss.getOnlineRegions()).thenReturn(regions);
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(100,null,rss,false);
  cleaner.chore();
  secondaryRegion.refreshStoreFiles();
  assertPathListsEqual(primaryRegion.getStoreFileList(families),secondaryRegion.getStoreFileList(families));
  assertEquals(families.length,secondaryRegion.getStoreFileList(families).size());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Replaying edits in secondary");
  assertTrue(secondaryRegion.getMemstoreSize() == 0);
  putDataWithFlushes(primaryRegion,400,400,0);
  numRows=400;
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flush=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flush != null) {
    }
 else {
      replayEdit(secondaryRegion,entry);
    }
  }
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  secondaryRegion.refreshStoreFiles();
  assertTrue(secondaryRegion.getMemstoreSize() == 0);
  LOG.info("-- Verifying edits from primary");
  verifyData(primaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests replaying region open markers from primary region. Checks whether the files are picked up
 */
@Test public void testReplayBulkLoadEvent() throws IOException {
  LOG.info("testReplayBulkLoadEvent starts");
  putDataWithFlushes(primaryRegion,100,0,100);
  primaryRegion.close();
  primaryRegion=HRegion.openHRegion(rootDir,primaryHri,htd,walPrimary,CONF,rss,null);
  Random random=new Random();
  byte[] randomValues=new byte[20];
  random.nextBytes(randomValues);
  Path testPath=TEST_UTIL.getDataTestDirOnTestFS();
  List<Pair<byte[],String>> familyPaths=new ArrayList<Pair<byte[],String>>();
  int expectedLoadFileCount=0;
  for (  byte[] family : families) {
    familyPaths.add(new Pair<byte[],String>(family,createHFileForFamilies(testPath,family,randomValues)));
    expectedLoadFileCount++;
  }
  primaryRegion.bulkLoadHFiles(familyPaths,false,null);
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and region events in secondary");
  BulkLoadDescriptor bulkloadEvent=null;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    bulkloadEvent=WALEdit.getBulkLoadDescriptor(entry.getEdit().getCells().get(0));
    if (bulkloadEvent != null) {
      break;
    }
  }
  assertTrue(bulkloadEvent != null);
  assertEquals(expectedLoadFileCount,bulkloadEvent.getStoresCount());
  secondaryRegion.replayWALBulkLoadEventMarker(bulkloadEvent);
  List<String> storeFileName=new ArrayList<String>();
  for (  StoreDescriptor storeDesc : bulkloadEvent.getStoresList()) {
    storeFileName.addAll(storeDesc.getStoreFileList());
  }
  for (  Store s : secondaryRegion.getStores()) {
    for (    StoreFile sf : s.getStorefiles()) {
      storeFileName.remove(sf.getPath().getName());
    }
  }
  assertTrue("Found some store file isn't loaded:" + storeFileName,storeFileName.isEmpty());
  LOG.info("-- Verifying edits from secondary");
  for (  byte[] family : families) {
    assertGet(secondaryRegion,family,randomValues);
  }
}

</code></pre>

<br>
<pre class="type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where a request for flush cache is sent to the region, but region cannot flush.
 * It should write the flush request marker instead.
 */
@Test public void testWriteFlushRequestMarker() throws IOException {
  FlushResultImpl result=(FlushResultImpl)((HRegion)primaryRegion).flushcache(true,false);
  assertNotNull(result);
  assertEquals(result.result,FlushResultImpl.Result.CANNOT_FLUSH_MEMSTORE_EMPTY);
  assertFalse(result.wroteFlushWalMarker);
  result=(FlushResultImpl)((HRegion)primaryRegion).flushcache(true,true);
  assertNotNull(result);
  assertEquals(result.result,FlushResultImpl.Result.CANNOT_FLUSH_MEMSTORE_EMPTY);
  assertTrue(result.wroteFlushWalMarker);
  List<FlushDescriptor> flushes=Lists.newArrayList();
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flush=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flush != null) {
      flushes.add(flush);
    }
  }
  assertEquals(1,flushes.size());
  assertNotNull(flushes.get(0));
  assertEquals(FlushDescriptor.FlushAction.CANNOT_FLUSH,flushes.get(0).getAction());
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where we prepare a flush with some seqId and we receive a flush commit marker
 * larger than the previous flush start marker.
 */
@Test public void testReplayFlushCommitMarkerLargerThanFlushStartMarker() throws IOException {
  putDataWithFlushes(primaryRegion,100,100,100);
  int numRows=200;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  FlushDescriptor commitFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        if (startFlushDesc == null) {
          LOG.info("-- Replaying flush start in secondary");
          startFlushDesc=flushDesc;
          PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
          assertNull(result.result);
        }
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        commitFlushDesc=FlushDescriptor.newBuilder(flushDesc).setFlushSequenceNumber(flushDesc.getFlushSequenceNumber() + 50).build();
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  long regionMemstoreSize=secondaryRegion.getMemstoreSize();
  LOG.info("Testing replaying flush COMMIT " + commitFlushDesc + " on top of flush START"+ startFlushDesc);
  assertTrue(commitFlushDesc.getFlushSequenceNumber() > startFlushDesc.getFlushSequenceNumber());
  LOG.info("-- Replaying flush commit in secondary" + commitFlushDesc);
  secondaryRegion.replayWALFlushCommitMarker(commitFlushDesc);
  expectedStoreFileCount++;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newFlushableSize=store.getFlushableSize();
  assertTrue(newFlushableSize > 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertTrue(newRegionMemstoreSize > 0);
  assertTrue(regionMemstoreSize > newRegionMemstoreSize);
  assertNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests cases where we prepare a flush with some seqId and we receive other flush start markers
 * equal to, greater or less than the previous flush start marker.
 */
@Test public void testReplayFlushStartMarkers() throws IOException {
  putDataWithFlushes(primaryRegion,100,100,100);
  int numRows=200;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
      long storeMemstoreSize=store.getMemStoreSize();
      long regionMemstoreSize=secondaryRegion.getMemstoreSize();
      long storeFlushableSize=store.getFlushableSize();
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        startFlushDesc=flushDesc;
        LOG.info("-- Replaying flush start in secondary");
        PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
        assertNull(result.result);
        assertEquals(result.flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
        assertTrue(regionMemstoreSize > 0);
        assertTrue(storeFlushableSize > 0);
        long newStoreMemstoreSize=store.getMemStoreSize();
        LOG.info("Memstore size reduced by:" + StringUtils.humanReadableInt(newStoreMemstoreSize - storeMemstoreSize));
        assertTrue(storeMemstoreSize > newStoreMemstoreSize);
        verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Replaying same flush start in secondary again");
  PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  FlushDescriptor startFlushDescSmallerSeqId=clone(startFlushDesc,startFlushDesc.getFlushSequenceNumber() - 50);
  LOG.info("-- Replaying same flush start in secondary again " + startFlushDescSmallerSeqId);
  result=secondaryRegion.replayWALFlushStartMarker(startFlushDescSmallerSeqId);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  FlushDescriptor startFlushDescLargerSeqId=clone(startFlushDesc,startFlushDesc.getFlushSequenceNumber() + 50);
  LOG.info("-- Replaying same flush start in secondary again " + startFlushDescLargerSeqId);
  result=secondaryRegion.replayWALFlushStartMarker(startFlushDescLargerSeqId);
  assertNull(result);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  assertEquals(secondaryRegion.getPrepareFlushResult().flushOpSeqId,startFlushDesc.getFlushSequenceNumber());
  assertTrue(secondaryRegion.getMemstoreSize() > 0);
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests a case where we replay only a flush start marker, then the region is closed. This region
 * should not block indefinitely
 */
@Test(timeout=60000) public void testOnlyReplayingFlushStartDoesNotHoldUpRegionClose() throws IOException {
  int start=0;
  LOG.info("-- Writing some data to primary from " + start + " to "+ (start + 100));
  putData(primaryRegion,Durability.SYNC_WAL,start,100,cq,families);
  LOG.info("-- Flushing primary, creating 3 files for 3 stores");
  primaryRegion.flush(true);
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        LOG.info("-- Replaying flush start in secondary");
        secondaryRegion.replayWALFlushStartMarker(flushDesc);
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        LOG.info("-- NOT Replaying flush commit in secondary");
      }
    }
 else {
      replayEdit(secondaryRegion,entry);
    }
  }
  assertTrue(rss.getRegionServerAccounting().getGlobalMemstoreSize() > 0);
  secondaryRegion.close();
  assertEquals(0,rss.getRegionServerAccounting().getGlobalMemstoreSize());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where we replay a region open event after a flush start but before receiving
 * flush commit
 */
@Test public void testReplayRegionOpenEventAfterFlushStart() throws IOException {
  putDataWithFlushes(primaryRegion,100,100,100);
  int numRows=200;
  primaryRegion.close();
  primaryRegion=HRegion.openHRegion(rootDir,primaryHri,htd,walPrimary,CONF,rss,null);
  reader=createWALReaderForPrimary();
  List<RegionEventDescriptor> regionEvents=Lists.newArrayList();
  LOG.info("-- Replaying edits and region events in secondary");
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    RegionEventDescriptor regionEventDesc=WALEdit.getRegionEventDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        secondaryRegion.replayWALFlushStartMarker(flushDesc);
      }
    }
 else     if (regionEventDesc != null) {
      regionEvents.add(regionEventDesc);
    }
 else {
      replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  assertEquals(3,regionEvents.size());
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  LOG.info("Testing replaying region open event " + regionEvents.get(2));
  secondaryRegion.replayWALRegionEventMarker(regionEvents.get(2));
  expectedStoreFileCount=2;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newSnapshotSize=store.getSnapshotSize();
  assertTrue(newSnapshotSize == 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertTrue(newRegionMemstoreSize == 0);
  assertNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplayFlushesAndCompactions() throws IOException {
  putDataWithFlushes(primaryRegion,100,300,100);
  LOG.info("-- Compacting primary, only 1 store");
  primaryRegion.compactStore(Bytes.toBytes("cf1"),NoLimitThroughputController.INSTANCE);
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  int lastReplayed=0;
  int expectedStoreFileCount=0;
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    CompactionDescriptor compactionDesc=WALEdit.getCompaction(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      verifyData(secondaryRegion,0,lastReplayed,cq,families);
      Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
      long storeMemstoreSize=store.getMemStoreSize();
      long regionMemstoreSize=secondaryRegion.getMemstoreSize();
      long storeFlushableSize=store.getFlushableSize();
      long storeSize=store.getSize();
      long storeSizeUncompressed=store.getStoreSizeUncompressed();
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        LOG.info("-- Replaying flush start in secondary");
        PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(flushDesc);
        assertNull(result.result);
        assertEquals(result.flushOpSeqId,flushDesc.getFlushSequenceNumber());
        long newStoreMemstoreSize=store.getMemStoreSize();
        LOG.info("Memstore size reduced by:" + StringUtils.humanReadableInt(newStoreMemstoreSize - storeMemstoreSize));
        assertTrue(storeMemstoreSize > newStoreMemstoreSize);
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        LOG.info("-- Replaying flush commit in secondary");
        secondaryRegion.replayWALFlushCommitMarker(flushDesc);
        expectedStoreFileCount++;
        for (        Store s : secondaryRegion.getStores()) {
          assertEquals(expectedStoreFileCount,s.getStorefilesCount());
        }
        long newFlushableSize=store.getFlushableSize();
        assertTrue(storeFlushableSize > newFlushableSize);
        long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
        assertTrue(regionMemstoreSize > newRegionMemstoreSize);
        assertTrue(store.getSize() > storeSize);
        assertTrue(store.getStoreSizeUncompressed() > storeSizeUncompressed);
        assertEquals(store.getSize(),store.getStorefilesSize());
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else     if (compactionDesc != null) {
      secondaryRegion.replayWALCompactionMarker(compactionDesc,true,false,Long.MAX_VALUE);
      for (      Store store : secondaryRegion.getStores()) {
        if (store.getColumnFamilyName().equals("cf1")) {
          assertEquals(1,store.getStorefilesCount());
        }
 else {
          assertEquals(expectedStoreFileCount,store.getStorefilesCount());
        }
      }
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
      ;
    }
  }
  assertEquals(400 - 1,lastReplayed);
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,400,cq,families);
  LOG.info("-- Verifying edits from primary. Ensuring that files are not deleted");
  verifyData(primaryRegion,0,lastReplayed,cq,families);
  for (  Store store : primaryRegion.getStores()) {
    if (store.getColumnFamilyName().equals("cf1")) {
      assertEquals(1,store.getStorefilesCount());
    }
 else {
      assertEquals(expectedStoreFileCount,store.getStorefilesCount());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests replaying region open markers from primary region. Checks whether the files are picked up
 */
@Test public void testReplayRegionOpenEvent() throws IOException {
  putDataWithFlushes(primaryRegion,100,0,100);
  int numRows=100;
  primaryRegion.close();
  primaryRegion=HRegion.openHRegion(rootDir,primaryHri,htd,walPrimary,CONF,rss,null);
  reader=createWALReaderForPrimary();
  List<RegionEventDescriptor> regionEvents=Lists.newArrayList();
  LOG.info("-- Replaying edits and region events in secondary");
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    RegionEventDescriptor regionEventDesc=WALEdit.getRegionEventDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
    }
 else     if (regionEventDesc != null) {
      regionEvents.add(regionEventDesc);
    }
 else {
    }
  }
  assertEquals(3,regionEvents.size());
  secondaryRegion.replayWALRegionEventMarker(regionEvents.get(0));
  secondaryRegion.replayWALRegionEventMarker(regionEvents.get(1));
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  long regionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertTrue(regionMemstoreSize == 0);
  LOG.info("Testing replaying region open event " + regionEvents.get(2));
  secondaryRegion.replayWALRegionEventMarker(regionEvents.get(2));
  expectedStoreFileCount++;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newFlushableSize=store.getFlushableSize();
  assertTrue(newFlushableSize == 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertTrue(newRegionMemstoreSize == 0);
  assertNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where we prepare a flush with some seqId and we receive a flush commit marker
 * less than the previous flush start marker.
 */
@Test public void testReplayFlushCommitMarkerSmallerThanFlushStartMarker() throws IOException {
  putDataWithFlushes(primaryRegion,100,200,100);
  int numRows=300;
  reader=createWALReaderForPrimary();
  LOG.info("-- Replaying edits and flush events in secondary");
  FlushDescriptor startFlushDesc=null;
  FlushDescriptor commitFlushDesc=null;
  int lastReplayed=0;
  while (true) {
    System.out.println(lastReplayed);
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flushDesc=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flushDesc != null) {
      if (flushDesc.getAction() == FlushAction.START_FLUSH) {
        if (startFlushDesc == null) {
          startFlushDesc=flushDesc;
        }
 else {
          LOG.info("-- Replaying flush start in secondary");
          startFlushDesc=flushDesc;
          PrepareFlushResult result=secondaryRegion.replayWALFlushStartMarker(startFlushDesc);
          assertNull(result.result);
        }
      }
 else       if (flushDesc.getAction() == FlushAction.COMMIT_FLUSH) {
        if (commitFlushDesc == null) {
          commitFlushDesc=flushDesc;
        }
      }
      verifyData(secondaryRegion,0,lastReplayed + 1,cq,families);
    }
 else {
      lastReplayed=replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,numRows,cq,families);
  int expectedStoreFileCount=0;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  long regionMemstoreSize=secondaryRegion.getMemstoreSize();
  LOG.info("Testing replaying flush COMMIT " + commitFlushDesc + " on top of flush START"+ startFlushDesc);
  assertTrue(commitFlushDesc.getFlushSequenceNumber() < startFlushDesc.getFlushSequenceNumber());
  LOG.info("-- Replaying flush commit in secondary" + commitFlushDesc);
  secondaryRegion.replayWALFlushCommitMarker(commitFlushDesc);
  expectedStoreFileCount++;
  for (  Store s : secondaryRegion.getStores()) {
    assertEquals(expectedStoreFileCount,s.getStorefilesCount());
  }
  Store store=secondaryRegion.getStore(Bytes.toBytes("cf1"));
  long newFlushableSize=store.getFlushableSize();
  assertTrue(newFlushableSize > 0);
  long newRegionMemstoreSize=secondaryRegion.getMemstoreSize();
  assertEquals(regionMemstoreSize,newRegionMemstoreSize);
  assertNotNull(secondaryRegion.getPrepareFlushResult());
  LOG.info("-- Verifying edits from secondary");
  verifyData(secondaryRegion,0,numRows,cq,families);
  LOG.info("-- Verifying edits from primary.");
  verifyData(primaryRegion,0,numRows,cq,families);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegionReplicaSecondaryCannotFlush() throws IOException {
  putDataByReplay(secondaryRegion,0,1000,cq,families);
  verifyData(secondaryRegion,0,1000,cq,families);
  FlushResultImpl flush=(FlushResultImpl)secondaryRegion.flush(true);
  assertEquals(flush.result,FlushResultImpl.Result.CANNOT_FLUSH);
  verifyData(secondaryRegion,0,1000,cq,families);
  Map<byte[],List<StoreFile>> files=secondaryRegion.close(false);
  for (  List<StoreFile> f : files.values()) {
    assertTrue(f.isEmpty());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHeapMemoryManager </h4><pre class="type-11 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWhenL2BlockCacheIsOnHeap() throws Exception {
  HeapMemoryManager heapMemoryManager=null;
  BlockCacheStub blockCache=new BlockCacheStub((long)(maxHeapSize * 0.4));
  MemstoreFlusherStub memStoreFlusher=new MemstoreFlusherStub((long)(maxHeapSize * 0.3));
  Configuration conf=HBaseConfiguration.create();
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MIN_RANGE_KEY,0.1f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MIN_RANGE_KEY,0.1f);
  conf.setInt(DefaultHeapMemoryTuner.NUM_PERIODS_TO_IGNORE,0);
  conf.setFloat(HeapMemorySizeUtil.MEMSTORE_SIZE_KEY,0.4F);
  conf.setFloat(HConstants.HFILE_BLOCK_CACHE_SIZE_KEY,0.3F);
  conf.setFloat(HConstants.BUCKET_CACHE_SIZE_KEY,0.1F);
  conf.set(HConstants.BUCKET_CACHE_IOENGINE_KEY,"heap");
  conf.setLong(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_PERIOD,1000);
  conf.setClass(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_CLASS,CustomHeapMemoryTuner.class,HeapMemoryTuner.class);
  try {
    heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),new RegionServerAccountingStub());
    fail("Should have failed as the collective heap memory need is above 80%");
  }
 catch (  Exception e) {
  }
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.6f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.6f);
  heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),new RegionServerAccountingStub());
  long oldMemstoreSize=memStoreFlusher.memstoreSize;
  long oldBlockCacheSize=blockCache.maxSize;
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  heapMemoryManager.start(choreService);
  CustomHeapMemoryTuner.memstoreSize=0.4f;
  CustomHeapMemoryTuner.blockCacheSize=0.4f;
  Thread.sleep(1500);
  assertEquals(oldMemstoreSize,memStoreFlusher.memstoreSize);
  assertEquals(oldBlockCacheSize,blockCache.maxSize);
  CustomHeapMemoryTuner.memstoreSize=0.1f;
  CustomHeapMemoryTuner.blockCacheSize=0.5f;
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.1f,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.5f,blockCache.maxSize);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestKeepDeletes </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that deleted rows are retained.
 * Family delete markers are deleted.
 * Column Delete markers are versioned
 * Time range scan of deleted rows are possible
 */
@Test public void testBasicScenario() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),0,3,HConstants.FOREVER,KeepDeletedCells.TRUE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime();
  Put p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  region.put(p);
  p=new Put(T1,ts + 1);
  p.addColumn(c0,c0,T2);
  region.put(p);
  p=new Put(T1,ts + 2);
  p.addColumn(c0,c0,T3);
  region.put(p);
  p=new Put(T1,ts + 4);
  p.addColumn(c0,c0,T4);
  region.put(p);
  Delete d=new Delete(T1,ts + 2);
  region.delete(d);
  assertEquals(3,countDeleteMarkers(region));
  Get g=new Get(T1);
  g.setMaxVersions();
  g.setTimeRange(0L,ts + 2);
  Result r=region.get(g);
  checkResult(r,c0,c0,T2,T1);
  region.flush(true);
  r=region.get(g);
  checkResult(r,c0,c0,T2);
  region.compact(true);
  region.compact(true);
  assertEquals(1,countDeleteMarkers(region));
  r=region.get(g);
  checkResult(r,c0,c0,T2);
  g.setTimeRange(0L,ts + 4);
  r=region.get(g);
  assertTrue(r.isEmpty());
  p=new Put(T1,ts + 5);
  p.addColumn(c0,c0,T5);
  region.put(p);
  p=new Put(T1,ts + 6);
  p.addColumn(c0,c0,T6);
  region.put(p);
  p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  region.put(p);
  r=region.get(g);
  assertTrue(r.isEmpty());
  region.flush(true);
  region.compact(true);
  region.compact(true);
  region.put(p);
  r=region.get(g);
  checkResult(r,c0,c0,T1);
  assertEquals(0,countDeleteMarkers(region));
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that "raw" scanning mode return delete markers and deletes rows.
 */
@Test public void testRawScan() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),0,3,HConstants.FOREVER,KeepDeletedCells.TRUE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime();
  Put p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  region.put(p);
  p=new Put(T1,ts + 2);
  p.addColumn(c0,c0,T2);
  region.put(p);
  p=new Put(T1,ts + 4);
  p.addColumn(c0,c0,T3);
  region.put(p);
  Delete d=new Delete(T1,ts + 1);
  region.delete(d);
  d=new Delete(T1,ts + 2);
  d.addColumn(c0,c0,ts + 2);
  region.delete(d);
  d=new Delete(T1,ts + 3);
  d.addColumns(c0,c0,ts + 3);
  region.delete(d);
  Scan s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  InternalScanner scan=region.getScanner(s);
  List<Cell> kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertEquals(8,kvs.size());
  assertTrue(CellUtil.isDeleteFamily(kvs.get(0)));
  assertArrayEquals(CellUtil.cloneValue(kvs.get(1)),T3);
  assertTrue(CellUtil.isDelete(kvs.get(2)));
  assertTrue(CellUtil.isDelete(kvs.get(3)));
  assertArrayEquals(CellUtil.cloneValue(kvs.get(4)),T2);
  assertArrayEquals(CellUtil.cloneValue(kvs.get(5)),T1);
  assertTrue(CellUtil.isDeleteFamily(kvs.get(6)));
  assertTrue(CellUtil.isDeleteFamily(kvs.get(7)));
  s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  s.setTimeRange(0,1);
  scan=region.getScanner(s);
  kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertTrue(kvs.isEmpty());
  s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  s.setTimeRange(0,ts + 2);
  scan=region.getScanner(s);
  kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertEquals(4,kvs.size());
  assertTrue(CellUtil.isDeleteFamily(kvs.get(0)));
  assertArrayEquals(CellUtil.cloneValue(kvs.get(1)),T1);
  assertTrue(CellUtil.isDeleteFamily(kvs.get(2)));
  assertTrue(CellUtil.isDeleteFamily(kvs.get(3)));
  s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  s.setTimeRange(ts + 3,ts + 5);
  scan=region.getScanner(s);
  kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertEquals(2,kvs.size());
  assertArrayEquals(CellUtil.cloneValue(kvs.get(0)),T3);
  assertTrue(CellUtil.isDelete(kvs.get(1)));
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Even when the store does not keep deletes a "raw" scan will
 * return everything it can find (unless discarding cells is guaranteed
 * to have no effect).
 * Assuming this the desired behavior. Could also disallow "raw" scanning
 * if the store does not have KEEP_DELETED_CELLS enabled.
 * (can be changed easily)
 */
@Test public void testRawScanWithoutKeepingDeletes() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),0,3,HConstants.FOREVER,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime();
  Put p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  region.put(p);
  Delete d=new Delete(T1,ts);
  d.addColumn(c0,c0,ts);
  region.delete(d);
  Scan s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  InternalScanner scan=region.getScanner(s);
  List<Cell> kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertEquals(2,kvs.size());
  region.flush(true);
  region.compact(true);
  s=new Scan();
  s.setRaw(true);
  s.setMaxVersions();
  scan=region.getScanner(s);
  kvs=new ArrayList<Cell>();
  scan.next(kvs);
  assertTrue(kvs.isEmpty());
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * basic verification of existing behavior
 */
@Test public void testWithoutKeepingDeletes() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),0,3,HConstants.FOREVER,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime();
  Put p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  region.put(p);
  Get gOne=new Get(T1);
  gOne.setMaxVersions();
  gOne.setTimeRange(0L,ts + 1);
  Result rOne=region.get(gOne);
  assertFalse(rOne.isEmpty());
  Delete d=new Delete(T1,ts + 2);
  d.addColumn(c0,c0,ts);
  region.delete(d);
  Get g=new Get(T1);
  g.setMaxVersions();
  g.setTimeRange(0L,ts + 1);
  Result r=region.get(g);
  assertTrue(r.isEmpty());
  Scan s=new Scan();
  s.setMaxVersions();
  s.setTimeRange(0L,ts + 1);
  InternalScanner scanner=region.getScanner(s);
  List<Cell> kvs=new ArrayList<Cell>();
  while (scanner.next(kvs))   ;
  assertTrue(kvs.isEmpty());
  region.flush(true);
  region.compact(false);
  assertEquals(1,countDeleteMarkers(region));
  region.compact(true);
  assertEquals(0,countDeleteMarkers(region));
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestKeyValueHeap </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSorted() throws IOException {
  List<Cell> l1=new ArrayList<Cell>();
  l1.add(new KeyValue(row1,fam1,col5,data));
  l1.add(new KeyValue(row2,fam1,col1,data));
  l1.add(new KeyValue(row2,fam1,col2,data));
  scanners.add(new Scanner(l1));
  List<Cell> l2=new ArrayList<Cell>();
  l2.add(new KeyValue(row1,fam1,col1,data));
  l2.add(new KeyValue(row1,fam1,col2,data));
  scanners.add(new Scanner(l2));
  List<Cell> l3=new ArrayList<Cell>();
  l3.add(new KeyValue(row1,fam1,col3,data));
  l3.add(new KeyValue(row1,fam1,col4,data));
  l3.add(new KeyValue(row1,fam2,col1,data));
  l3.add(new KeyValue(row1,fam2,col2,data));
  l3.add(new KeyValue(row2,fam1,col3,data));
  scanners.add(new Scanner(l3));
  List<KeyValue> expected=new ArrayList<KeyValue>();
  expected.add(new KeyValue(row1,fam1,col1,data));
  expected.add(new KeyValue(row1,fam1,col2,data));
  expected.add(new KeyValue(row1,fam1,col3,data));
  expected.add(new KeyValue(row1,fam1,col4,data));
  expected.add(new KeyValue(row1,fam1,col5,data));
  expected.add(new KeyValue(row1,fam2,col1,data));
  expected.add(new KeyValue(row1,fam2,col2,data));
  expected.add(new KeyValue(row2,fam1,col1,data));
  expected.add(new KeyValue(row2,fam1,col2,data));
  expected.add(new KeyValue(row2,fam1,col3,data));
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparator.COMPARATOR);
  List<Cell> actual=new ArrayList<Cell>();
  while (kvh.peek() != null) {
    actual.add(kvh.next());
  }
  assertEquals(expected.size(),actual.size());
  for (int i=0; i < expected.size(); i++) {
    assertEquals(expected.get(i),actual.get(i));
    if (PRINT) {
      System.out.println("expected " + expected.get(i) + "\nactual   "+ actual.get(i)+ "\n");
    }
  }
  for (int i=0; i < actual.size() - 1; i++) {
    int ret=CellComparator.COMPARATOR.compare(actual.get(i),actual.get(i + 1));
    assertTrue(ret < 0);
  }
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScannerException() throws IOException {
  List<Cell> l1=new ArrayList<Cell>();
  l1.add(new KeyValue(row1,fam1,col5,data));
  l1.add(new KeyValue(row2,fam1,col1,data));
  l1.add(new KeyValue(row2,fam1,col2,data));
  SeekScanner s1=new SeekScanner(l1);
  scanners.add(s1);
  List<Cell> l2=new ArrayList<Cell>();
  l2.add(new KeyValue(row1,fam1,col1,data));
  l2.add(new KeyValue(row1,fam1,col2,data));
  SeekScanner s2=new SeekScanner(l2);
  scanners.add(s2);
  List<Cell> l3=new ArrayList<Cell>();
  l3.add(new KeyValue(row1,fam1,col3,data));
  l3.add(new KeyValue(row1,fam1,col4,data));
  l3.add(new KeyValue(row1,fam2,col1,data));
  l3.add(new KeyValue(row1,fam2,col2,data));
  l3.add(new KeyValue(row2,fam1,col3,data));
  SeekScanner s3=new SeekScanner(l3);
  scanners.add(s3);
  List<Cell> l4=new ArrayList<Cell>();
  SeekScanner s4=new SeekScanner(l4);
  scanners.add(s4);
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparator.COMPARATOR);
  try {
    for (    KeyValueScanner scanner : scanners) {
      ((SeekScanner)scanner).setRealSeekDone(false);
    }
    while (kvh.next() != null)     ;
    assertTrue(false);
  }
 catch (  IOException ioe) {
    kvh.close();
  }
  for (  KeyValueScanner scanner : scanners) {
    assertTrue(((SeekScanner)scanner).isClosed());
    assertEquals(((SeekScanner)scanner).getClosedNum(),1);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScannerLeak() throws IOException {
  List<Cell> l1=new ArrayList<Cell>();
  l1.add(new KeyValue(row1,fam1,col5,data));
  l1.add(new KeyValue(row2,fam1,col1,data));
  l1.add(new KeyValue(row2,fam1,col2,data));
  Scanner s1=new Scanner(l1);
  scanners.add(s1);
  List<Cell> l2=new ArrayList<Cell>();
  l2.add(new KeyValue(row1,fam1,col1,data));
  l2.add(new KeyValue(row1,fam1,col2,data));
  Scanner s2=new Scanner(l2);
  scanners.add(s2);
  List<Cell> l3=new ArrayList<Cell>();
  l3.add(new KeyValue(row1,fam1,col3,data));
  l3.add(new KeyValue(row1,fam1,col4,data));
  l3.add(new KeyValue(row1,fam2,col1,data));
  l3.add(new KeyValue(row1,fam2,col2,data));
  l3.add(new KeyValue(row2,fam1,col3,data));
  Scanner s3=new Scanner(l3);
  scanners.add(s3);
  List<Cell> l4=new ArrayList<Cell>();
  Scanner s4=new Scanner(l4);
  scanners.add(s4);
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparator.COMPARATOR);
  while (kvh.next() != null)   ;
  assertEquals(4,kvh.scannersForDelayedClose.size());
  assertTrue(kvh.scannersForDelayedClose.contains(s1));
  assertTrue(kvh.scannersForDelayedClose.contains(s2));
  assertTrue(kvh.scannersForDelayedClose.contains(s3));
  assertTrue(kvh.scannersForDelayedClose.contains(s4));
  kvh.close();
  for (  KeyValueScanner scanner : scanners) {
    assertTrue(((Scanner)scanner).isClosed());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMajorCompaction </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for HBASE-5920
 */
@Test public void testUserMajorCompactionRequest() throws IOException {
  Store store=r.getStore(COLUMN_FAMILY);
  createStoreFile(r);
  for (int i=0; i < MAX_FILES_TO_COMPACT + 1; i++) {
    createStoreFile(r);
  }
  store.triggerMajorCompaction();
  CompactionRequest request=store.requestCompaction(Store.PRIORITY_USER,null).getRequest();
  assertNotNull("Expected to receive a compaction request",request);
  assertEquals("User-requested major compaction should always occur, even if there are too many store files",true,request.isMajor());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeBasedMajorCompaction() throws Exception {
  int delay=10 * 1000;
  float jitterPct=0.20f;
  conf.setLong(HConstants.MAJOR_COMPACTION_PERIOD,delay);
  conf.setFloat("hbase.hregion.majorcompaction.jitter",jitterPct);
  HStore s=((HStore)r.getStore(COLUMN_FAMILY));
  s.storeEngine.getCompactionPolicy().setConf(conf);
  try {
    createStoreFile(r);
    createStoreFile(r);
    r.compact(true);
    createStoreFile(r);
    r.compact(false);
    assertEquals(2,s.getStorefilesCount());
    RatioBasedCompactionPolicy c=(RatioBasedCompactionPolicy)s.storeEngine.getCompactionPolicy();
    Collection<StoreFile> storeFiles=s.getStorefiles();
    long mcTime=c.getNextMajorCompactTime(storeFiles);
    for (int i=0; i < 10; ++i) {
      assertEquals(mcTime,c.getNextMajorCompactTime(storeFiles));
    }
    long jitter=Math.round(delay * jitterPct);
    assertTrue(delay - jitter <= mcTime && mcTime <= delay + jitter);
    Thread.sleep(mcTime);
    r.compact(false);
    assertEquals(1,s.getStorefilesCount());
  }
  finally {
    conf.setLong(HConstants.MAJOR_COMPACTION_PERIOD,1000 * 60 * 60* 24);
    conf.setFloat("hbase.hregion.majorcompaction.jitter",0.20F);
    createStoreFile(r);
    r.compact(true);
    assertEquals(1,s.getStorefilesCount());
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for HBASE-5920 - Test user requested major compactions always occurring
 */
@Test public void testNonUserMajorCompactionRequest() throws Exception {
  Store store=r.getStore(COLUMN_FAMILY);
  createStoreFile(r);
  for (int i=0; i < MAX_FILES_TO_COMPACT + 1; i++) {
    createStoreFile(r);
  }
  store.triggerMajorCompaction();
  CompactionRequest request=store.requestCompaction(Store.NO_PRIORITY,null).getRequest();
  assertNotNull("Expected to receive a compaction request",request);
  assertEquals("System-requested major compaction should not occur if there are too many store files",false,request.isMajor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMasterAddressTracker </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoBackups() throws Exception {
  final ServerName sn=ServerName.valueOf("localhost",1234,System.currentTimeMillis());
  final MasterAddressTracker addressTracker=setupMasterTracker(sn,1772);
  try {
    assertEquals("Should receive 0 for backup not found.",0,addressTracker.getBackupMasterInfoPort(ServerName.valueOf("doesnotexist.example.com",1234,System.currentTimeMillis())));
  }
  finally {
    assertTrue("Couldn't clean up master",MasterAddressTracker.deleteIfEquals(addressTracker.getWatcher(),sn.toString()));
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Unit tests that uses ZooKeeper but does not use the master-side methods
 * but rather acts directly on ZK.
 * @throws Exception
 */
@Test public void testMasterAddressTrackerFromZK() throws Exception {
  final int infoPort=1235;
  final ServerName sn=ServerName.valueOf("localhost",1234,System.currentTimeMillis());
  final MasterAddressTracker addressTracker=setupMasterTracker(sn,infoPort);
  try {
    assertTrue(addressTracker.hasMaster());
    ServerName pulledAddress=addressTracker.getMasterAddress();
    assertTrue(pulledAddress.equals(sn));
    assertEquals(infoPort,addressTracker.getMasterInfoPort());
  }
  finally {
    assertTrue("Couldn't clean up master",MasterAddressTracker.deleteIfEquals(addressTracker.getWatcher(),sn.toString()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMaster() throws Exception {
  final MasterAddressTracker addressTracker=setupMasterTracker(null,1772);
  assertFalse(addressTracker.hasMaster());
  assertNull("should get null master when none active.",addressTracker.getMasterAddress());
  assertEquals("Should receive 0 for backup not found.",0,addressTracker.getMasterInfoPort());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMemStoreChunkPool </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusingChunks(){
  Random rand=new Random();
  MemStoreLAB mslab=new HeapMemStoreLAB(conf);
  int expectedOff=0;
  byte[] lastBuffer=null;
  for (int i=0; i < 100; i++) {
    int size=rand.nextInt(1000);
    ByteRange alloc=mslab.allocateBytes(size);
    if (alloc.getBytes() != lastBuffer) {
      expectedOff=0;
      lastBuffer=alloc.getBytes();
    }
    assertEquals(expectedOff,alloc.getOffset());
    assertTrue("Allocation overruns buffer",alloc.getOffset() + size <= alloc.getBytes().length);
    expectedOff+=size;
  }
  mslab.close();
  int chunkCount=chunkPool.getPoolSize();
  assertTrue(chunkCount > 0);
  mslab=new HeapMemStoreLAB(conf);
  mslab.allocateBytes(1000);
  assertEquals(chunkCount - 1,chunkPool.getPoolSize());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPuttingBackChunksAfterFlushing() throws UnexpectedStateException {
  byte[] row=Bytes.toBytes("testrow");
  byte[] fam=Bytes.toBytes("testfamily");
  byte[] qf1=Bytes.toBytes("testqualifier1");
  byte[] qf2=Bytes.toBytes("testqualifier2");
  byte[] qf3=Bytes.toBytes("testqualifier3");
  byte[] qf4=Bytes.toBytes("testqualifier4");
  byte[] qf5=Bytes.toBytes("testqualifier5");
  byte[] val=Bytes.toBytes("testval");
  DefaultMemStore memstore=new DefaultMemStore();
  memstore.add(new KeyValue(row,fam,qf1,val));
  memstore.add(new KeyValue(row,fam,qf2,val));
  memstore.add(new KeyValue(row,fam,qf3,val));
  MemStoreSnapshot snapshot=memstore.snapshot();
  assertEquals(3,memstore.snapshot.size());
  assertEquals(0,memstore.cellSet.size());
  memstore.add(new KeyValue(row,fam,qf4,val));
  memstore.add(new KeyValue(row,fam,qf5,val));
  assertEquals(2,memstore.cellSet.size());
  memstore.clearSnapshot(snapshot.getId());
  int chunkCount=chunkPool.getPoolSize();
  assertTrue(chunkCount > 0);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPuttingBackChunksWithOpeningScanner() throws UnexpectedStateException {
  byte[] row=Bytes.toBytes("testrow");
  byte[] fam=Bytes.toBytes("testfamily");
  byte[] qf1=Bytes.toBytes("testqualifier1");
  byte[] qf2=Bytes.toBytes("testqualifier2");
  byte[] qf3=Bytes.toBytes("testqualifier3");
  byte[] qf4=Bytes.toBytes("testqualifier4");
  byte[] qf5=Bytes.toBytes("testqualifier5");
  byte[] qf6=Bytes.toBytes("testqualifier6");
  byte[] qf7=Bytes.toBytes("testqualifier7");
  byte[] val=Bytes.toBytes("testval");
  DefaultMemStore memstore=new DefaultMemStore();
  memstore.add(new KeyValue(row,fam,qf1,val));
  memstore.add(new KeyValue(row,fam,qf2,val));
  memstore.add(new KeyValue(row,fam,qf3,val));
  MemStoreSnapshot snapshot=memstore.snapshot();
  assertEquals(3,memstore.snapshot.size());
  assertEquals(0,memstore.cellSet.size());
  memstore.add(new KeyValue(row,fam,qf4,val));
  memstore.add(new KeyValue(row,fam,qf5,val));
  assertEquals(2,memstore.cellSet.size());
  List<KeyValueScanner> scanners=memstore.getScanners(0);
  memstore.clearSnapshot(snapshot.getId());
  assertTrue(chunkPool.getPoolSize() == 0);
  for (  KeyValueScanner scanner : scanners) {
    scanner.close();
  }
  assertTrue(chunkPool.getPoolSize() > 0);
  chunkPool.clearChunks();
  snapshot=memstore.snapshot();
  memstore.add(new KeyValue(row,fam,qf6,val));
  memstore.add(new KeyValue(row,fam,qf7,val));
  scanners=memstore.getScanners(0);
  for (  KeyValueScanner scanner : scanners) {
    scanner.close();
  }
  memstore.clearSnapshot(snapshot.getId());
  assertTrue(chunkPool.getPoolSize() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMemStoreLAB </h4><pre class="type-4 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test allocation from lots of threads, making sure the results don't
 * overlap in any way
 */
@Test public void testLABThreading() throws Exception {
  Configuration conf=new Configuration();
  MultithreadedTestUtil.TestContext ctx=new MultithreadedTestUtil.TestContext(conf);
  final AtomicInteger totalAllocated=new AtomicInteger();
  final MemStoreLAB mslab=new HeapMemStoreLAB();
  List<List<AllocRecord>> allocations=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    final List<AllocRecord> allocsByThisThread=Lists.newLinkedList();
    allocations.add(allocsByThisThread);
    TestThread t=new MultithreadedTestUtil.RepeatingTestThread(ctx){
      private Random r=new Random();
      @Override public void doAnAction() throws Exception {
        int size=r.nextInt(1000);
        ByteRange alloc=mslab.allocateBytes(size);
        totalAllocated.addAndGet(size);
        allocsByThisThread.add(new AllocRecord(alloc,size));
      }
    }
;
    ctx.addThread(t);
  }
  ctx.startThreads();
  while (totalAllocated.get() < 50 * 1024 * 1024 && ctx.shouldRun()) {
    Thread.sleep(10);
  }
  ctx.stop();
  Map<byte[],Map<Integer,AllocRecord>> mapsByChunk=Maps.newHashMap();
  int sizeCounted=0;
  for (  AllocRecord rec : Iterables.concat(allocations)) {
    sizeCounted+=rec.size;
    if (rec.size == 0)     continue;
    Map<Integer,AllocRecord> mapForThisByteArray=mapsByChunk.get(rec.alloc.getBytes());
    if (mapForThisByteArray == null) {
      mapForThisByteArray=Maps.newTreeMap();
      mapsByChunk.put(rec.alloc.getBytes(),mapForThisByteArray);
    }
    AllocRecord oldVal=mapForThisByteArray.put(rec.alloc.getOffset(),rec);
    assertNull("Already had an entry " + oldVal + " for allocation "+ rec,oldVal);
  }
  assertEquals("Sanity check test",sizeCounted,totalAllocated.get());
  for (  Map<Integer,AllocRecord> allocsInChunk : mapsByChunk.values()) {
    int expectedOff=0;
    for (    AllocRecord alloc : allocsInChunk.values()) {
      assertEquals(expectedOff,alloc.alloc.getOffset());
      assertTrue("Allocation overruns buffer",alloc.alloc.getOffset() + alloc.size <= alloc.alloc.getBytes().length);
      expectedOff+=alloc.size;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a bunch of random allocations
 */
@Test public void testLABRandomAllocation(){
  Random rand=new Random();
  MemStoreLAB mslab=new HeapMemStoreLAB();
  int expectedOff=0;
  byte[] lastBuffer=null;
  for (int i=0; i < 100000; i++) {
    int size=rand.nextInt(1000);
    ByteRange alloc=mslab.allocateBytes(size);
    if (alloc.getBytes() != lastBuffer) {
      expectedOff=0;
      lastBuffer=alloc.getBytes();
    }
    assertEquals(expectedOff,alloc.getOffset());
    assertTrue("Allocation overruns buffer",alloc.getOffset() + size <= alloc.getBytes().length);
    expectedOff+=size;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionServerSourceImpl </h4><pre class="type-7 type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstance() throws Exception {
  MetricsRegionServerSourceFactory metricsRegionServerSourceFactory=CompatibilitySingletonFactory.getInstance(MetricsRegionServerSourceFactory.class);
  MetricsRegionServerSource serverSource=metricsRegionServerSourceFactory.createServer(null);
  assertTrue(serverSource instanceof MetricsRegionServerSourceImpl);
  assertSame(metricsRegionServerSourceFactory,CompatibilitySingletonFactory.getInstance(MetricsRegionServerSourceFactory.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionSourceImpl </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareToHashCodeEquals() throws Exception {
  MetricsRegionServerSourceFactory fact=CompatibilitySingletonFactory.getInstance(MetricsRegionServerSourceFactory.class);
  MetricsRegionSource one=fact.createRegion(new RegionWrapperStub("TEST"));
  MetricsRegionSource oneClone=fact.createRegion(new RegionWrapperStub("TEST"));
  MetricsRegionSource two=fact.createRegion(new RegionWrapperStub("TWO"));
  assertEquals(0,one.compareTo(oneClone));
  assertEquals(one.hashCode(),oneClone.hashCode());
  assertNotEquals(one,two);
  assertTrue(one.compareTo(two) != 0);
  assertTrue(two.compareTo(one) != 0);
  assertTrue(two.compareTo(one) != one.compareTo(two));
  assertTrue(two.compareTo(two) == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMiniBatchOperationInProgress </h4><pre class="type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniBatchOperationInProgressMethods(){
  Pair<Mutation,Integer>[] operations=new Pair[10];
  OperationStatus[] retCodeDetails=new OperationStatus[10];
  WALEdit[] walEditsFromCoprocessors=new WALEdit[10];
  for (int i=0; i < 10; i++) {
    operations[i]=new Pair<Mutation,Integer>(new Put(Bytes.toBytes(i)),null);
  }
  MiniBatchOperationInProgress<Pair<Mutation,Integer>> miniBatch=new MiniBatchOperationInProgress<Pair<Mutation,Integer>>(operations,retCodeDetails,walEditsFromCoprocessors,0,5);
  assertEquals(5,miniBatch.size());
  assertTrue(Bytes.equals(Bytes.toBytes(0),miniBatch.getOperation(0).getFirst().getRow()));
  assertTrue(Bytes.equals(Bytes.toBytes(2),miniBatch.getOperation(2).getFirst().getRow()));
  assertTrue(Bytes.equals(Bytes.toBytes(4),miniBatch.getOperation(4).getFirst().getRow()));
  try {
    miniBatch.getOperation(5);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  miniBatch.setOperationStatus(1,OperationStatus.FAILURE);
  assertEquals(OperationStatus.FAILURE,retCodeDetails[1]);
  try {
    miniBatch.setOperationStatus(6,OperationStatus.FAILURE);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  try {
    miniBatch.setWalEdit(5,new WALEdit());
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  miniBatch=new MiniBatchOperationInProgress<Pair<Mutation,Integer>>(operations,retCodeDetails,walEditsFromCoprocessors,7,10);
  try {
    miniBatch.setWalEdit(-1,new WALEdit());
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  try {
    miniBatch.getOperation(-1);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  try {
    miniBatch.getOperation(3);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  try {
    miniBatch.getOperationStatus(9);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  try {
    miniBatch.setOperationStatus(3,OperationStatus.FAILURE);
    fail("Should throw Exception while accessing out of range");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  assertTrue(Bytes.equals(Bytes.toBytes(7),miniBatch.getOperation(0).getFirst().getRow()));
  assertTrue(Bytes.equals(Bytes.toBytes(9),miniBatch.getOperation(2).getFirst().getRow()));
  miniBatch.setOperationStatus(1,OperationStatus.SUCCESS);
  assertEquals(OperationStatus.SUCCESS,retCodeDetails[8]);
  WALEdit wal=new WALEdit();
  miniBatch.setWalEdit(0,wal);
  assertEquals(wal,walEditsFromCoprocessors[7]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMobStoreCompaction </h4><pre class="type-4 type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMajorCompactionAfterDelete() throws Exception {
  init(UTIL.getConfiguration(),100);
  byte[] dummyData=makeDummyData(200);
  Table loader=new RegionAsTable(region);
  int numHfiles=compactionThreshold - 1;
  byte[] deleteRow=Bytes.add(STARTROW,Bytes.toBytes(0));
  for (int i=0; i < numHfiles; i++) {
    Put p=createPut(i,dummyData);
    loader.put(p);
    region.flush(true);
  }
  assertEquals("Before compaction: store files",numHfiles,countStoreFiles());
  assertEquals("Before compaction: mob file count",numHfiles,countMobFiles());
  assertEquals("Before compaction: rows",numHfiles,countRows());
  assertEquals("Before compaction: mob rows",numHfiles,countMobRows());
  assertEquals("Before compaction: number of mob cells",numHfiles,countMobCellsInMetadata());
  Delete delete=new Delete(deleteRow);
  delete.addFamily(COLUMN_FAMILY);
  region.delete(delete);
  region.flush(true);
  assertEquals("Before compaction: store files",numHfiles + 1,countStoreFiles());
  assertEquals("Before compaction: mob files",numHfiles,countMobFiles());
  region.compact(true);
  assertEquals("After compaction: store files",1,countStoreFiles());
  assertEquals("After compaction: mob files",numHfiles + 1,countMobFiles());
  Scan scan=new Scan();
  scan.setRaw(true);
  InternalScanner scanner=region.getScanner(scan);
  List<Cell> results=new ArrayList<>();
  scanner.next(results);
  int deleteCount=0;
  while (!results.isEmpty()) {
    for (    Cell c : results) {
      if (c.getTypeByte() == KeyValue.Type.DeleteFamily.getCode()) {
        deleteCount++;
        assertTrue(Bytes.equals(CellUtil.cloneRow(c),deleteRow));
      }
    }
    results.clear();
    scanner.next(results);
  }
  assertEquals(0,deleteCount);
  scanner.close();
  assertEquals("The cells in mob files",numHfiles - 1,countMobCellsInMobFiles(1));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test will first generate store files, then bulk load them and trigger the compaction.
 * When compaction, the cell value will be larger than the threshold.
 */
@Test public void testMobCompactionWithBulkload() throws Exception {
  init(UTIL.getConfiguration(),300);
  byte[] dummyData=makeDummyData(600);
  Path hbaseRootDir=FSUtils.getRootDir(conf);
  Path basedir=new Path(hbaseRootDir,htd.getNameAsString());
  List<Pair<byte[],String>> hfiles=new ArrayList<>(1);
  for (int i=0; i < compactionThreshold; i++) {
    Path hpath=new Path(basedir,"hfile" + i);
    hfiles.add(Pair.newPair(COLUMN_FAMILY,hpath.toString()));
    createHFile(hpath,i,dummyData);
  }
  boolean result=region.bulkLoadHFiles(hfiles,true,null);
  assertTrue("Bulkload result:",result);
  assertEquals("Before compaction: store files",compactionThreshold,countStoreFiles());
  assertEquals("Before compaction: mob file count",0,countMobFiles());
  assertEquals("Before compaction: rows",compactionThreshold,countRows());
  assertEquals("Before compaction: mob rows",0,countMobRows());
  assertEquals("Before compaction: referenced mob file count",0,countReferencedMobFiles());
  region.compactStores();
  assertEquals("After compaction: store files",1,countStoreFiles());
  assertEquals("After compaction: mob file count:",1,countMobFiles());
  assertEquals("After compaction: rows",compactionThreshold,countRows());
  assertEquals("After compaction: mob rows",compactionThreshold,countMobRows());
  assertEquals("After compaction: referenced mob file count",1,countReferencedMobFiles());
  assertEquals("After compaction: number of mob cells",compactionThreshold,countMobCellsInMetadata());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMobStoreScanner </h4><pre class="type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFromCorruptMobFiles() throws Exception {
  TableName tn=TableName.valueOf("testReadFromCorruptMobFiles");
  setUp(0,tn);
  createRecordAndCorruptMobFile(tn,row1,family,qf1,Bytes.toBytes("value1"));
  Get get=new Get(row1);
  IOException ioe=null;
  try {
    table.get(get);
  }
 catch (  IOException e) {
    ioe=e;
  }
  Assert.assertNotNull(ioe);
  Assert.assertEquals(CorruptHFileException.class.getName(),ioe.getClass().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMultiColumnScanner </h4><pre class="type-4 type-9 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColumnScanner() throws IOException {
  Region region=TEST_UTIL.createTestRegion(TABLE_NAME,new HColumnDescriptor(FAMILY).setCompressionType(comprAlgo).setBloomFilterType(bloomType).setMaxVersions(MAX_VERSIONS).setDataBlockEncoding(dataBlockEncoding));
  List<String> rows=sequentialStrings("row",NUM_ROWS);
  List<String> qualifiers=sequentialStrings("qual",NUM_COLUMNS);
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  Set<String> keySet=new HashSet<String>();
  Map<String,Long> lastDelTimeMap=new HashMap<String,Long>();
  Random rand=new Random(29372937L);
  Set<String> rowQualSkip=new HashSet<String>();
  for (  String row : rows)   for (  String qual : qualifiers)   if (rand.nextDouble() < COLUMN_SKIP_IN_ROW_PROB) {
    LOG.info("Skipping " + qual + " in row "+ row);
    rowQualSkip.add(rowQualKey(row,qual));
  }
  for (  String qual : qualifiers)   if (rand.nextDouble() < COLUMN_SKIP_EVERYWHERE_PROB) {
    LOG.info("Skipping " + qual + " in all rows");
    for (    String row : rows)     rowQualSkip.add(rowQualKey(row,qual));
  }
  for (int iFlush=0; iFlush < NUM_FLUSHES; ++iFlush) {
    for (    String qual : qualifiers) {
      if (rand.nextDouble() < COLUMN_SKIP_IN_STORE_FILE_PROB)       continue;
      byte[] qualBytes=Bytes.toBytes(qual);
      for (      String row : rows) {
        Put p=new Put(Bytes.toBytes(row));
        for (        long ts : TIMESTAMPS) {
          String value=createValue(row,qual,ts);
          KeyValue kv=KeyValueTestUtil.create(row,FAMILY,qual,ts,value);
          assertEquals(kv.getTimestamp(),ts);
          p.add(kv);
          String keyAsString=kv.toString();
          if (!keySet.contains(keyAsString)) {
            keySet.add(keyAsString);
            kvs.add(kv);
          }
        }
        region.put(p);
        Delete d=new Delete(Bytes.toBytes(row));
        boolean deletedSomething=false;
        for (        long ts : TIMESTAMPS)         if (rand.nextDouble() < DELETE_PROBABILITY) {
          d.addColumns(FAMILY_BYTES,qualBytes,ts);
          String rowAndQual=row + "_" + qual;
          Long whenDeleted=lastDelTimeMap.get(rowAndQual);
          lastDelTimeMap.put(rowAndQual,whenDeleted == null ? ts : Math.max(ts,whenDeleted));
          deletedSomething=true;
        }
        if (deletedSomething)         region.delete(d);
      }
    }
    region.flush(true);
  }
  Collections.sort(kvs,CellComparator.COMPARATOR);
  for (int maxVersions=1; maxVersions <= TIMESTAMPS.length; ++maxVersions) {
    for (int columnBitMask=1; columnBitMask <= MAX_COLUMN_BIT_MASK; ++columnBitMask) {
      Scan scan=new Scan();
      scan.setMaxVersions(maxVersions);
      Set<String> qualSet=new TreeSet<String>();
{
        int columnMaskTmp=columnBitMask;
        for (        String qual : qualifiers) {
          if ((columnMaskTmp & 1) != 0) {
            scan.addColumn(FAMILY_BYTES,Bytes.toBytes(qual));
            qualSet.add(qual);
          }
          columnMaskTmp>>=1;
        }
        assertEquals(0,columnMaskTmp);
      }
      InternalScanner scanner=region.getScanner(scan);
      List<Cell> results=new ArrayList<Cell>();
      int kvPos=0;
      int numResults=0;
      String queryInfo="columns queried: " + qualSet + " (columnBitMask="+ columnBitMask+ "), maxVersions="+ maxVersions;
      while (scanner.next(results) || results.size() > 0) {
        for (        Cell kv : results) {
          while (kvPos < kvs.size() && !matchesQuery(kvs.get(kvPos),qualSet,maxVersions,lastDelTimeMap)) {
            ++kvPos;
          }
          String rowQual=getRowQualStr(kv);
          String deleteInfo="";
          Long lastDelTS=lastDelTimeMap.get(rowQual);
          if (lastDelTS != null) {
            deleteInfo="; last timestamp when row/column " + rowQual + " was deleted: "+ lastDelTS;
          }
          assertTrue("Scanner returned additional key/value: " + kv + ", "+ queryInfo+ deleteInfo+ ";",kvPos < kvs.size());
          assertTrue("Scanner returned wrong key/value; " + queryInfo + deleteInfo+ ";",CellUtil.equalsIgnoreMvccVersion(kvs.get(kvPos),(kv)));
          ++kvPos;
          ++numResults;
        }
        results.clear();
      }
      for (; kvPos < kvs.size(); ++kvPos) {
        KeyValue remainingKV=kvs.get(kvPos);
        assertFalse("Matching column not returned by scanner: " + remainingKV + ", "+ queryInfo+ ", results returned: "+ numResults,matchesQuery(remainingKV,qualSet,maxVersions,lastDelTimeMap));
      }
    }
  }
  assertTrue("This test is supposed to delete at least some row/column " + "pairs",lastDelTimeMap.size() > 0);
  LOG.info("Number of row/col pairs deleted at least once: " + lastDelTimeMap.size());
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testSelectiveFlushWhenNotEnabled() throws IOException {
  Configuration conf=HBaseConfiguration.create();
  conf.setLong(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,200 * 1024);
  conf.set(FlushPolicyFactory.HBASE_FLUSH_POLICY_KEY,FlushAllStoresPolicy.class.getName());
  HRegion region=initHRegion("testSelectiveFlushWhenNotEnabled",conf);
  for (int i=1; i <= 1200; i++) {
    region.put(createPut(1,i));
    if (i <= 100) {
      region.put(createPut(2,i));
      if (i <= 50) {
        region.put(createPut(3,i));
      }
    }
  }
  long totalMemstoreSize=region.getMemstoreSize();
  long cf1MemstoreSize=region.getStore(FAMILY1).getMemStoreSize();
  long cf2MemstoreSize=region.getStore(FAMILY2).getMemStoreSize();
  long cf3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  assertTrue(cf1MemstoreSize > 0);
  assertTrue(cf2MemstoreSize > 0);
  assertTrue(cf3MemstoreSize > 0);
  assertEquals(totalMemstoreSize + 3 * DefaultMemStore.DEEP_OVERHEAD,cf1MemstoreSize + cf2MemstoreSize + cf3MemstoreSize);
  region.flush(false);
  cf1MemstoreSize=region.getStore(FAMILY1).getMemStoreSize();
  cf2MemstoreSize=region.getStore(FAMILY2).getMemStoreSize();
  cf3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  totalMemstoreSize=region.getMemstoreSize();
  long smallestSeqInRegionCurrentMemstore=region.getWAL().getEarliestMemstoreSeqNum(region.getRegionInfo().getEncodedNameAsBytes());
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf1MemstoreSize);
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf2MemstoreSize);
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf3MemstoreSize);
  assertEquals(0,totalMemstoreSize);
  assertEquals(HConstants.NO_SEQNUM,smallestSeqInRegionCurrentMemstore);
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When a log roll is about to happen, we do a flush of the regions who will be affected by the
 * log roll. These flushes cannot be a selective flushes, otherwise we cannot roll the logs. This
 * test ensures that we do a full-flush in that scenario.
 * @throws IOException
 */
@Test(timeout=180000) public void testFlushingWhenLogRolling() throws Exception {
  TableName tableName=TableName.valueOf("testFlushingWhenLogRolling");
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setLong(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,128 * 1024 * 1024);
  conf.set(FlushPolicyFactory.HBASE_FLUSH_POLICY_KEY,FlushLargeStoresPolicy.class.getName());
  long cfFlushSizeLowerBound=2048;
  conf.setLong(FlushLargeStoresPolicy.HREGION_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND_MIN,cfFlushSizeLowerBound);
  conf.setLong("hbase.regionserver.logroll.period",60L * 60 * 1000);
  conf.setLong("hbase.regionserver.hlog.blocksize",128L * 1024 * 1024);
  final int maxLogs=10;
  conf.setInt("hbase.regionserver.maxlogs",maxLogs);
  final int numRegionServers=1;
  TEST_UTIL.startMiniCluster(numRegionServers);
  try {
    Table table=TEST_UTIL.createTable(tableName,FAMILIES);
    try (Admin admin=TEST_UTIL.getConnection().getAdmin()){
      admin.flush(TableName.NAMESPACE_TABLE_NAME);
    }
     Pair<Region,HRegionServer> desiredRegionAndServer=getRegionWithName(tableName);
    final Region desiredRegion=desiredRegionAndServer.getFirst();
    assertTrue("Could not find a region which hosts the new region.",desiredRegion != null);
    LOG.info("Writing to region=" + desiredRegion);
    for (int i=1; i <= 3; i++) {
      table.put(createPut(i,0));
    }
    for (int i=0; i < maxLogs; i++) {
      for (int j=0; j < 100; j++) {
        table.put(createPut(1,i * 100 + j));
      }
      int currentNumRolledLogFiles=getNumRolledLogFiles(desiredRegion);
      assertNull(getWAL(desiredRegion).rollWriter());
      while (getNumRolledLogFiles(desiredRegion) <= currentNumRolledLogFiles) {
        Thread.sleep(100);
      }
    }
    table.close();
    assertEquals(maxLogs,getNumRolledLogFiles(desiredRegion));
    assertTrue(desiredRegion.getStore(FAMILY1).getMemStoreSize() > cfFlushSizeLowerBound);
    assertTrue(desiredRegion.getStore(FAMILY2).getMemStoreSize() < cfFlushSizeLowerBound);
    assertTrue(desiredRegion.getStore(FAMILY3).getMemStoreSize() < cfFlushSizeLowerBound);
    table.put(createPut(1,12345678));
    desiredRegionAndServer.getSecond().walRoller.requestRollAll();
    TEST_UTIL.waitFor(30000,new Waiter.ExplainingPredicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return desiredRegion.getMemstoreSize() == 0;
      }
      @Override public String explainFailure() throws Exception {
        long memstoreSize=desiredRegion.getMemstoreSize();
        if (memstoreSize > 0) {
          return "Still have unflushed entries in memstore, memstore size is " + memstoreSize;
        }
        return "Unknown";
      }
    }
);
    LOG.info("Finished waiting on flush after too many WALs...");
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY1).getMemStoreSize());
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY2).getMemStoreSize());
    assertEquals(DefaultMemStore.DEEP_OVERHEAD,desiredRegion.getStore(FAMILY3).getMemStoreSize());
    assertNull(getWAL(desiredRegion).rollWriter(true));
    assertTrue(getNumRolledLogFiles(desiredRegion) < maxLogs);
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testSelectiveFlushWhenEnabled() throws IOException {
  Configuration conf=HBaseConfiguration.create();
  conf.setLong(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,200 * 1024);
  conf.set(FlushPolicyFactory.HBASE_FLUSH_POLICY_KEY,FlushLargeStoresPolicy.class.getName());
  conf.setLong(FlushLargeStoresPolicy.HREGION_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND_MIN,100 * 1024);
  Region region=initHRegion("testSelectiveFlushWhenEnabled",conf);
  for (int i=1; i <= 1200; i++) {
    region.put(createPut(1,i));
    if (i <= 100) {
      region.put(createPut(2,i));
      if (i <= 50) {
        region.put(createPut(3,i));
      }
    }
  }
  long totalMemstoreSize=region.getMemstoreSize();
  long smallestSeqCF1=region.getOldestSeqIdOfStore(FAMILY1);
  long smallestSeqCF2=region.getOldestSeqIdOfStore(FAMILY2);
  long smallestSeqCF3=region.getOldestSeqIdOfStore(FAMILY3);
  long cf1MemstoreSize=region.getStore(FAMILY1).getMemStoreSize();
  long cf2MemstoreSize=region.getStore(FAMILY2).getMemStoreSize();
  long cf3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  long smallestSeqInRegionCurrentMemstore=getWAL(region).getEarliestMemstoreSeqNum(region.getRegionInfo().getEncodedNameAsBytes());
  assertEquals(smallestSeqCF1,smallestSeqInRegionCurrentMemstore);
  assertTrue(smallestSeqCF1 < smallestSeqCF2);
  assertTrue(smallestSeqCF2 < smallestSeqCF3);
  assertTrue(cf1MemstoreSize > 0);
  assertTrue(cf2MemstoreSize > 0);
  assertTrue(cf3MemstoreSize > 0);
  assertEquals(totalMemstoreSize + 3 * DefaultMemStore.DEEP_OVERHEAD,cf1MemstoreSize + cf2MemstoreSize + cf3MemstoreSize);
  region.flush(false);
  long oldCF2MemstoreSize=cf2MemstoreSize;
  long oldCF3MemstoreSize=cf3MemstoreSize;
  cf1MemstoreSize=region.getStore(FAMILY1).getMemStoreSize();
  cf2MemstoreSize=region.getStore(FAMILY2).getMemStoreSize();
  cf3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  totalMemstoreSize=region.getMemstoreSize();
  smallestSeqInRegionCurrentMemstore=getWAL(region).getEarliestMemstoreSeqNum(region.getRegionInfo().getEncodedNameAsBytes());
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf1MemstoreSize);
  assertEquals(cf2MemstoreSize,oldCF2MemstoreSize);
  assertEquals(cf3MemstoreSize,oldCF3MemstoreSize);
  assertEquals(smallestSeqInRegionCurrentMemstore,smallestSeqCF2);
  assertEquals(totalMemstoreSize + 2 * DefaultMemStore.DEEP_OVERHEAD,cf2MemstoreSize + cf3MemstoreSize);
  for (int i=1200; i < 2400; i++) {
    region.put(createPut(2,i));
    if (i - 1200 < 100) {
      region.put(createPut(3,i));
    }
  }
  oldCF3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  region.flush(false);
  cf1MemstoreSize=region.getStore(FAMILY1).getMemStoreSize();
  cf2MemstoreSize=region.getStore(FAMILY2).getMemStoreSize();
  cf3MemstoreSize=region.getStore(FAMILY3).getMemStoreSize();
  totalMemstoreSize=region.getMemstoreSize();
  smallestSeqInRegionCurrentMemstore=getWAL(region).getEarliestMemstoreSeqNum(region.getRegionInfo().getEncodedNameAsBytes());
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf1MemstoreSize);
  assertEquals(DefaultMemStore.DEEP_OVERHEAD,cf2MemstoreSize);
  assertEquals(cf3MemstoreSize,oldCF3MemstoreSize);
  assertEquals(totalMemstoreSize + DefaultMemStore.DEEP_OVERHEAD,cf3MemstoreSize);
  assertEquals(smallestSeqInRegionCurrentMemstore,smallestSeqCF3);
  region.flush(true);
  for (int i=1; i <= 300; i++) {
    region.put(createPut(1,i));
    region.put(createPut(2,i));
    region.put(createPut(3,i));
    region.put(createPut(4,i));
    region.put(createPut(5,i));
  }
  region.flush(false);
  assertEquals(0,region.getMemstoreSize());
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestPriorityRpc </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQosFunctionForScanMethod() throws IOException {
  RequestHeader.Builder headerBuilder=RequestHeader.newBuilder();
  headerBuilder.setMethodName("Scan");
  RequestHeader header=headerBuilder.build();
  ScanRequest.Builder scanBuilder=ScanRequest.newBuilder();
  ScanRequest scanRequest=scanBuilder.build();
  HRegion mockRegion=Mockito.mock(HRegion.class);
  HRegionServer mockRS=Mockito.mock(HRegionServer.class);
  RSRpcServices mockRpc=Mockito.mock(RSRpcServices.class);
  Mockito.when(mockRS.getRSRpcServices()).thenReturn(mockRpc);
  HRegionInfo mockRegionInfo=Mockito.mock(HRegionInfo.class);
  Mockito.when(mockRpc.getRegion((RegionSpecifier)Mockito.any())).thenReturn(mockRegion);
  Mockito.when(mockRegion.getRegionInfo()).thenReturn(mockRegionInfo);
  Mockito.when(mockRegionInfo.isSystemTable()).thenReturn(false);
  ((AnnotationReadingPriorityFunction)priority).setRegionServer(mockRS);
  int qos=priority.getPriority(header,scanRequest,User.createUserForTesting(regionServer.conf,"someuser",new String[]{"somegroup"}));
  assertTrue("" + qos,qos == HConstants.NORMAL_QOS);
  scanBuilder=ScanRequest.newBuilder();
  scanBuilder.setScannerId(12345);
  scanRequest=scanBuilder.build();
  RegionScanner mockRegionScanner=Mockito.mock(RegionScanner.class);
  Mockito.when(mockRpc.getScanner(12345)).thenReturn(mockRegionScanner);
  Mockito.when(mockRegionScanner.getRegionInfo()).thenReturn(mockRegionInfo);
  Mockito.when(mockRpc.getRegion((RegionSpecifier)Mockito.any())).thenReturn(mockRegion);
  Mockito.when(mockRegion.getRegionInfo()).thenReturn(mockRegionInfo);
  Mockito.when(mockRegionInfo.isSystemTable()).thenReturn(true);
  ((AnnotationReadingPriorityFunction)priority).setRegionServer(mockRS);
  assertEquals(HConstants.SYSTEMTABLE_QOS,priority.getPriority(header,scanRequest,User.createUserForTesting(regionServer.conf,"someuser",new String[]{"somegroup"})));
  Mockito.when(mockRegionInfo.isSystemTable()).thenReturn(false);
  assertEquals(HConstants.NORMAL_QOS,priority.getPriority(header,scanRequest,User.createUserForTesting(regionServer.conf,"someuser",new String[]{"somegroup"})));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRecoveredEdits </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * HBASE-12782 ITBLL fails for me if generator does anything but 5M per maptask.
 * Create a region. Close it. Then copy into place a file to replay, one that is bigger than
 * configured flush size so we bring on lots of flushes.  Then reopen and confirm all edits
 * made it in.
 * @throws IOException
 */
@Test(timeout=60000) public void testReplayWorksThoughLotsOfFlushing() throws IOException {
  Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  conf.setInt(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,1024 * 1024);
  final String encodedRegionName="4823016d8fca70b25503ee07f4c6d79f";
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(testName.getMethodName()));
  final String columnFamily="meta";
  byte[][] columnFamilyAsByteArray=new byte[][]{Bytes.toBytes(columnFamily)};
  htd.addFamily(new HColumnDescriptor(columnFamily));
  HRegionInfo hri=new HRegionInfo(htd.getTableName()){
    @Override public synchronized String getEncodedName(){
      return encodedRegionName;
    }
    private byte[] encodedRegionNameAsBytes=null;
    @Override public synchronized byte[] getEncodedNameAsBytes(){
      if (encodedRegionNameAsBytes == null) {
        this.encodedRegionNameAsBytes=Bytes.toBytes(getEncodedName());
      }
      return this.encodedRegionNameAsBytes;
    }
  }
;
  Path hbaseRootDir=TEST_UTIL.getDataTestDir();
  FileSystem fs=FileSystem.get(TEST_UTIL.getConfiguration());
  Path tableDir=FSUtils.getTableDir(hbaseRootDir,htd.getTableName());
  HRegionFileSystem hrfs=new HRegionFileSystem(TEST_UTIL.getConfiguration(),fs,tableDir,hri);
  if (fs.exists(hrfs.getRegionDir())) {
    LOG.info("Region directory already exists. Deleting.");
    fs.delete(hrfs.getRegionDir(),true);
  }
  HRegion region=HRegion.createHRegion(hri,hbaseRootDir,conf,htd,null);
  assertEquals(encodedRegionName,region.getRegionInfo().getEncodedName());
  List<String> storeFiles=region.getStoreFileList(columnFamilyAsByteArray);
  assertTrue(storeFiles.isEmpty());
  region.close();
  Path regionDir=region.getRegionDir(hbaseRootDir,hri);
  Path recoveredEditsDir=WALSplitter.getRegionDirRecoveredEditsDir(regionDir);
  Path recoveredEditsFile=new Path(System.getProperty("test.build.classes","target/test-classes"),"0000000000000016310");
  Path destination=new Path(recoveredEditsDir,recoveredEditsFile.getName());
  fs.copyToLocalFile(recoveredEditsFile,destination);
  assertTrue(fs.exists(destination));
  region=HRegion.openHRegion(region,null);
  assertEquals(encodedRegionName,region.getRegionInfo().getEncodedName());
  storeFiles=region.getStoreFileList(columnFamilyAsByteArray);
  assertTrue("Files count=" + storeFiles.size(),storeFiles.size() > 10);
  int count=verifyAllEditsMadeItIn(fs,conf,recoveredEditsFile,region);
  LOG.info("Checked " + count + " edits made it in");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionFavoredNodes </h4><pre class="type-9 type-11 type-21 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFavoredNodes() throws Exception {
  Assume.assumeTrue(createWithFavoredNode != null);
  InetSocketAddress[] nodes=new InetSocketAddress[REGION_SERVERS];
  List<DataNode> datanodes=TEST_UTIL.getDFSCluster().getDataNodes();
  Method selfAddress;
  try {
    selfAddress=DataNode.class.getMethod("getSelfAddr");
  }
 catch (  NoSuchMethodException ne) {
    selfAddress=DataNode.class.getMethod("getXferAddress");
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    nodes[i]=(InetSocketAddress)selfAddress.invoke(datanodes.get(i));
  }
  String[] nodeNames=new String[REGION_SERVERS];
  for (int i=0; i < REGION_SERVERS; i++) {
    nodeNames[i]=nodes[i].getAddress().getHostAddress() + ":" + nodes[i].getPort();
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    HRegionServer server=TEST_UTIL.getHBaseCluster().getRegionServer(i);
    List<Region> regions=server.getOnlineRegions(TABLE_NAME);
    for (    Region region : regions) {
      List<org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName> favoredNodes=new ArrayList<org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName>(3);
      String encodedRegionName=region.getRegionInfo().getEncodedName();
      for (int j=0; j < FAVORED_NODES_NUM; j++) {
        org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName.Builder b=org.apache.hadoop.hbase.protobuf.generated.HBaseProtos.ServerName.newBuilder();
        b.setHostName(nodes[(i + j) % REGION_SERVERS].getAddress().getHostAddress());
        b.setPort(nodes[(i + j) % REGION_SERVERS].getPort());
        b.setStartCode(-1);
        favoredNodes.add(b.build());
      }
      server.updateRegionFavoredNodesMapping(encodedRegionName,favoredNodes);
    }
  }
  for (int i=0; i < FLUSHES; i++) {
    TEST_UTIL.loadTable(table,COLUMN_FAMILY,false);
    TEST_UTIL.flush();
  }
  for (int i=0; i < REGION_SERVERS; i++) {
    HRegionServer server=TEST_UTIL.getHBaseCluster().getRegionServer(i);
    List<Region> regions=server.getOnlineRegions(TABLE_NAME);
    for (    Region region : regions) {
      List<String> files=region.getStoreFileList(new byte[][]{COLUMN_FAMILY});
      for (      String file : files) {
        FileStatus status=TEST_UTIL.getDFSCluster().getFileSystem().getFileStatus(new Path(new URI(file).getPath()));
        BlockLocation[] lbks=((DistributedFileSystem)TEST_UTIL.getDFSCluster().getFileSystem()).getFileBlockLocations(status,0,Long.MAX_VALUE);
        for (        BlockLocation lbk : lbks) {
          locations:           for (          String info : lbk.getNames()) {
            for (int j=0; j < FAVORED_NODES_NUM; j++) {
              if (info.equals(nodeNames[(i + j) % REGION_SERVERS])) {
                continue locations;
              }
            }
            fail("Block location " + info + " not a favored node");
          }
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionMergeTransaction </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWholesomeMerge() throws IOException, InterruptedException {
  final int rowCountOfRegionA=loadRegion(this.region_a,CF,true);
  final int rowCountOfRegionB=loadRegion(this.region_b,CF,true);
  assertTrue(rowCountOfRegionA > 0 && rowCountOfRegionB > 0);
  assertEquals(rowCountOfRegionA,countRows(this.region_a));
  assertEquals(rowCountOfRegionB,countRows(this.region_b));
  RegionMergeTransactionImpl mt=prepareOnGoodRegions();
  TEST_UTIL.getConfiguration().setInt(HConstants.REGIONSERVER_PORT,0);
  CoordinatedStateManager cp=CoordinatedStateManagerFactory.getCoordinatedStateManager(TEST_UTIL.getConfiguration());
  Server mockServer=new HRegionServer(TEST_UTIL.getConfiguration(),cp);
  HRegion mergedRegion=(HRegion)mt.execute(mockServer,null);
  assertTrue(this.fs.exists(mt.getMergesDir()));
  assertTrue(region_a.isClosed());
  assertTrue(region_b.isClosed());
  assertEquals(0,this.fs.listStatus(mt.getMergesDir()).length);
  assertTrue(Bytes.equals(this.region_a.getRegionInfo().getStartKey(),mergedRegion.getRegionInfo().getStartKey()));
  assertTrue(Bytes.equals(this.region_b.getRegionInfo().getEndKey(),mergedRegion.getRegionInfo().getEndKey()));
  try {
    int mergedRegionRowCount=countRows(mergedRegion);
    assertEquals((rowCountOfRegionA + rowCountOfRegionB),mergedRegionRowCount);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(mergedRegion);
  }
  assertTrue(!this.region_a.lock.writeLock().isHeldByCurrentThread());
  assertTrue(!this.region_b.lock.writeLock().isHeldByCurrentThread());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailAfterPONR() throws IOException, KeeperException, InterruptedException {
  final int rowCountOfRegionA=loadRegion(this.region_a,CF,true);
  final int rowCountOfRegionB=loadRegion(this.region_b,CF,true);
  assertTrue(rowCountOfRegionA > 0 && rowCountOfRegionB > 0);
  assertEquals(rowCountOfRegionA,countRows(this.region_a));
  assertEquals(rowCountOfRegionB,countRows(this.region_b));
  RegionMergeTransactionImpl mt=prepareOnGoodRegions();
  Mockito.doThrow(new MockedFailedMergedRegionOpen()).when(mt).openMergedRegion((Server)Mockito.anyObject(),(RegionServerServices)Mockito.anyObject(),(HRegion)Mockito.anyObject());
  boolean expectedException=false;
  TEST_UTIL.getConfiguration().setInt(HConstants.REGIONSERVER_PORT,0);
  CoordinatedStateManager cp=CoordinatedStateManagerFactory.getCoordinatedStateManager(TEST_UTIL.getConfiguration());
  Server mockServer=new HRegionServer(TEST_UTIL.getConfiguration(),cp);
  try {
    mt.execute(mockServer,null);
  }
 catch (  MockedFailedMergedRegionOpen e) {
    expectedException=true;
  }
  assertTrue(expectedException);
  assertFalse(mt.rollback(null,null));
  Path tableDir=this.region_a.getRegionFileSystem().getRegionDir().getParent();
  Path mergedRegionDir=new Path(tableDir,mt.getMergedRegionInfo().getEncodedName());
  assertTrue(TEST_UTIL.getTestFileSystem().exists(mergedRegionDir));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollback() throws IOException, InterruptedException {
  final int rowCountOfRegionA=loadRegion(this.region_a,CF,true);
  final int rowCountOfRegionB=loadRegion(this.region_b,CF,true);
  assertTrue(rowCountOfRegionA > 0 && rowCountOfRegionB > 0);
  assertEquals(rowCountOfRegionA,countRows(this.region_a));
  assertEquals(rowCountOfRegionB,countRows(this.region_b));
  RegionMergeTransactionImpl mt=prepareOnGoodRegions();
  when(mt.createMergedRegionFromMerges(region_a,region_b,mt.getMergedRegionInfo())).thenThrow(new MockedFailedMergedRegionCreation());
  boolean expectedException=false;
  TEST_UTIL.getConfiguration().setInt(HConstants.REGIONSERVER_PORT,0);
  CoordinatedStateManager cp=CoordinatedStateManagerFactory.getCoordinatedStateManager(TEST_UTIL.getConfiguration());
  Server mockServer=new HRegionServer(TEST_UTIL.getConfiguration(),cp);
  try {
    mt.execute(mockServer,null);
  }
 catch (  MockedFailedMergedRegionCreation e) {
    expectedException=true;
  }
  assertTrue(expectedException);
  assertTrue(mt.rollback(null,null));
  int rowCountOfRegionA2=countRows(this.region_a);
  assertEquals(rowCountOfRegionA,rowCountOfRegionA2);
  int rowCountOfRegionB2=countRows(this.region_b);
  assertEquals(rowCountOfRegionB,rowCountOfRegionB2);
  assertTrue(!this.fs.exists(HRegion.getRegionDir(this.testdir,mt.getMergedRegionInfo())));
  assertTrue(!this.region_a.lock.writeLock().isHeldByCurrentThread());
  assertTrue(!this.region_b.lock.writeLock().isHeldByCurrentThread());
  assertTrue(mt.prepare(null));
  HRegion mergedRegion=(HRegion)mt.execute(mockServer,null);
  try {
    int mergedRegionRowCount=countRows(mergedRegion);
    assertEquals((rowCountOfRegionA + rowCountOfRegionB),mergedRegionRowCount);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(mergedRegion);
  }
  assertTrue(!this.region_a.lock.writeLock().isHeldByCurrentThread());
  assertTrue(!this.region_b.lock.writeLock().isHeldByCurrentThread());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionMergeTransactionOnCluster </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test tests 1, merging region not online;
 * 2, merging same two regions; 3, merging unknown regions.
 * They are in one test case so that we don't have to create
 * many tables, and these tests are simple.
 */
@Test public void testMerge() throws Exception {
  LOG.info("Starting testMerge");
  final TableName tableName=TableName.valueOf("testMerge");
  try {
    Table table=createTableAndLoadData(master,tableName);
    RegionStates regionStates=master.getAssignmentManager().getRegionStates();
    List<HRegionInfo> regions=regionStates.getRegionsOfTable(tableName);
    HRegionInfo a=regions.get(0);
    HRegionInfo b=regions.get(1);
    regionStates.regionOffline(a);
    try {
      admin.mergeRegions(a.getEncodedNameAsBytes(),b.getEncodedNameAsBytes(),false);
      fail("Offline regions should not be able to merge");
    }
 catch (    IOException ie) {
      System.out.println(ie);
      assertTrue("Exception should mention regions not online",StringUtils.stringifyException(ie).contains("regions not online") && ie instanceof MergeRegionException);
    }
    try {
      admin.mergeRegions(b.getEncodedNameAsBytes(),b.getEncodedNameAsBytes(),true);
      fail("A region should not be able to merge with itself, even forcifully");
    }
 catch (    IOException ie) {
      assertTrue("Exception should mention regions not online",StringUtils.stringifyException(ie).contains("region to itself") && ie instanceof MergeRegionException);
    }
    try {
      admin.mergeRegions(Bytes.toBytes("-f1"),Bytes.toBytes("-f2"),true);
      fail("Unknown region could not be merged");
    }
 catch (    IOException ie) {
      assertTrue("UnknownRegionException should be thrown",ie instanceof UnknownRegionException);
    }
    table.close();
  }
  finally {
    TEST_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionReplicaFailover </h4><pre class="type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case where there are 3 region replicas and the primary is continuously accepting
 * new writes while one of the secondaries is killed. Verification is done for both of the
 * secondary replicas.
 */
@Test(timeout=120000) public void testSecondaryRegionKillWhilePrimaryIsAcceptingWrites() throws Exception {
  try (Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());Table table=connection.getTable(htd.getTableName());Admin admin=connection.getAdmin()){
    HTU.loadNumericRows(table,fam,0,1000);
    admin.flush(table.getName());
    HTU.loadNumericRows(table,fam,1000,2000);
    final AtomicReference<Throwable> ex=new AtomicReference<Throwable>(null);
    final AtomicBoolean done=new AtomicBoolean(false);
    final AtomicInteger key=new AtomicInteger(2000);
    Thread loader=new Thread(){
      @Override public void run(){
        while (!done.get()) {
          try {
            HTU.loadNumericRows(table,fam,key.get(),key.get() + 1000);
            key.addAndGet(1000);
          }
 catch (          Throwable e) {
            ex.compareAndSet(null,e);
          }
        }
      }
    }
;
    loader.start();
    Thread aborter=new Thread(){
      @Override public void run(){
        try {
          boolean aborted=false;
          for (          RegionServerThread rs : HTU.getMiniHBaseCluster().getRegionServerThreads()) {
            for (            Region r : rs.getRegionServer().getOnlineRegions(htd.getTableName())) {
              if (r.getRegionInfo().getReplicaId() == 1) {
                LOG.info("Aborting region server hosting secondary region replica");
                rs.getRegionServer().abort("for test");
                aborted=true;
              }
            }
          }
          assertTrue(aborted);
        }
 catch (        Throwable e) {
          ex.compareAndSet(null,e);
        }
      }
    }
;
    aborter.start();
    aborter.join();
    done.set(true);
    loader.join();
    assertNull(ex.get());
    assertTrue(key.get() > 1000);
    LOG.info("Loaded up to key :" + key.get());
    verifyNumericRowsWithTimeout(table,fam,0,key.get(),0,30000);
    verifyNumericRowsWithTimeout(table,fam,0,key.get(),1,30000);
    verifyNumericRowsWithTimeout(table,fam,0,key.get(),2,30000);
  }
   HTU.getMiniHBaseCluster().startRegionServer();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionReplicas </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testVerifySecondaryAbilityToReadWithOnFiles() throws Exception {
  HTU.getConfiguration().setInt(StorefileRefresherChore.REGIONSERVER_STOREFILE_REFRESH_PERIOD,0);
  restartRegionServer();
  try {
    LOG.info("Opening the secondary region " + hriSecondary.getEncodedName());
    openRegion(HTU,getRS(),hriSecondary);
    LOG.info("Loading data to primary region");
    for (int i=0; i < 3; ++i) {
      HTU.loadNumericRows(table,f,i * 1000,(i + 1) * 1000);
      Region region=getRS().getRegionByEncodedName(hriPrimary.getEncodedName());
      region.flush(true);
    }
    Region primaryRegion=getRS().getFromOnlineRegions(hriPrimary.getEncodedName());
    Assert.assertEquals(3,primaryRegion.getStore(f).getStorefilesCount());
    Region secondaryRegion=getRS().getFromOnlineRegions(hriSecondary.getEncodedName());
    secondaryRegion.getStore(f).refreshStoreFiles();
    Assert.assertEquals(3,secondaryRegion.getStore(f).getStorefilesCount());
    LOG.info("Force Major compaction on primary region " + hriPrimary);
    primaryRegion.compact(true);
    Assert.assertEquals(1,primaryRegion.getStore(f).getStorefilesCount());
    List<RegionServerThread> regionServerThreads=HTU.getMiniHBaseCluster().getRegionServerThreads();
    HRegionServer hrs=null;
    for (    RegionServerThread rs : regionServerThreads) {
      if (rs.getRegionServer().getOnlineRegion(primaryRegion.getRegionInfo().getRegionName()) != null) {
        hrs=rs.getRegionServer();
        break;
      }
    }
    CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(100,null,hrs,false);
    cleaner.chore();
    int keys=0;
    int sum=0;
    for (    StoreFile sf : secondaryRegion.getStore(f).getStorefiles()) {
      LOG.debug(getRS().getFileSystem().exists(sf.getPath()));
      Assert.assertFalse(getRS().getFileSystem().exists(sf.getPath()));
      HFileScanner scanner=sf.getReader().getScanner(false,false);
      scanner.seekTo();
      do {
        keys++;
        Cell cell=scanner.getCell();
        sum+=Integer.parseInt(Bytes.toString(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength()));
      }
 while (scanner.next());
    }
    Assert.assertEquals(3000,keys);
    Assert.assertEquals(4498500,sum);
  }
  finally {
    HTU.deleteNumericRows(table,HConstants.CATALOG_FAMILY,0,1000);
    closeRegion(HTU,getRS(),hriSecondary);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerMetrics </h4><pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanNextForSmallScan() throws IOException {
  String tableNameString="testScanNextSmall";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("One");
  List<Put> puts=new ArrayList<>();
  for (int insertCount=0; insertCount < 100; insertCount++) {
    Put p=new Put(Bytes.toBytes("" + insertCount + "row"));
    p.addColumn(cf,qualifier,val);
    puts.add(p);
  }
  try (Table t=TEST_UTIL.createTable(tableName,cf)){
    t.put(puts);
    Scan s=new Scan();
    s.setSmall(true);
    s.setCaching(1);
    ResultScanner resultScanners=t.getScanner(s);
    for (int nextCount=0; nextCount < NUM_SCAN_NEXT; nextCount++) {
      Result result=resultScanners.next();
      assertNotNull(result);
      assertEquals(1,result.size());
    }
  }
   numScanNext+=NUM_SCAN_NEXT;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    for (    HRegionLocation location : locator.getAllRegionLocations()) {
      HRegionInfo i=location.getRegionInfo();
      MetricsRegionAggregateSource agg=rs.getRegion(i.getRegionName()).getMetrics().getSource().getAggregateSource();
      String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ i.getEncodedName()+ "_metric";
      metricsHelper.assertCounter(prefix + "_scanNextNumOps",NUM_SCAN_NEXT,agg);
    }
    metricsHelper.assertCounter("ScanNext_num_ops",numScanNext,serverSource);
  }
   try (Admin admin=TEST_UTIL.getHBaseAdmin()){
    admin.disableTable(tableName);
    admin.deleteTable(tableName);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanNext() throws IOException {
  String tableNameString="testScanNext";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("One");
  List<Put> puts=new ArrayList<>();
  for (int insertCount=0; insertCount < 100; insertCount++) {
    Put p=new Put(Bytes.toBytes("" + insertCount + "row"));
    p.addColumn(cf,qualifier,val);
    puts.add(p);
  }
  try (Table t=TEST_UTIL.createTable(tableName,cf)){
    t.put(puts);
    Scan s=new Scan();
    s.setBatch(1);
    s.setCaching(1);
    ResultScanner resultScanners=t.getScanner(s);
    for (int nextCount=0; nextCount < NUM_SCAN_NEXT; nextCount++) {
      Result result=resultScanners.next();
      assertNotNull(result);
      assertEquals(1,result.size());
    }
  }
   numScanNext+=NUM_SCAN_NEXT;
  try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
    for (    HRegionLocation location : locator.getAllRegionLocations()) {
      HRegionInfo i=location.getRegionInfo();
      MetricsRegionAggregateSource agg=rs.getRegion(i.getRegionName()).getMetrics().getSource().getAggregateSource();
      String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ i.getEncodedName()+ "_metric";
      metricsHelper.assertCounter(prefix + "_scanNextNumOps",NUM_SCAN_NEXT,agg);
    }
    metricsHelper.assertCounter("ScanNext_num_ops",numScanNext,serverSource);
  }
   try (Admin admin=TEST_UTIL.getHBaseAdmin()){
    admin.disableTable(tableName);
    admin.deleteTable(tableName);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerNoMaster </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests an on-the-fly RPC that was scheduled for the earlier RS on the same port
 * for openRegion. The region server should reject this RPC. (HBASE-9721)
 */
@Test public void testOpenCloseRegionRPCIntendedForPreviousServer() throws Exception {
  Assert.assertTrue(getRS().getRegion(regionName).isAvailable());
  ServerName sn=getRS().getServerName();
  ServerName earlierServerName=ServerName.valueOf(sn.getHostname(),sn.getPort(),1);
  try {
    CloseRegionRequest request=RequestConverter.buildCloseRegionRequest(earlierServerName,regionName);
    getRS().getRSRpcServices().closeRegion(null,request);
    Assert.fail("The closeRegion should have been rejected");
  }
 catch (  ServiceException se) {
    Assert.assertTrue(se.getCause() instanceof IOException);
    Assert.assertTrue(se.getCause().getMessage().contains("This RPC was intended for a different server"));
  }
  closeRegionNoZK();
  try {
    AdminProtos.OpenRegionRequest orr=RequestConverter.buildOpenRegionRequest(earlierServerName,hri,null,null);
    getRS().getRSRpcServices().openRegion(null,orr);
    Assert.fail("The openRegion should have been rejected");
  }
 catch (  ServiceException se) {
    Assert.assertTrue(se.getCause() instanceof IOException);
    Assert.assertTrue(se.getCause().getMessage().contains("This RPC was intended for a different server"));
  }
 finally {
    openRegion(HTU,getRS(),hri);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that if we do a close while opening it stops the opening.
 */
@Test(timeout=60000) public void testCancelOpeningWithoutZK() throws Exception {
  closeRegionNoZK();
  checkRegionIsClosed(HTU,getRS(),hri);
  getRS().getRegionsInTransitionInRS().put(hri.getEncodedNameAsBytes(),Boolean.TRUE);
  AdminProtos.CloseRegionRequest crr=RequestConverter.buildCloseRegionRequest(getRS().getServerName(),regionName);
  try {
    getRS().rpcServices.closeRegion(null,crr);
    Assert.assertTrue(false);
  }
 catch (  ServiceException expected) {
  }
  Assert.assertEquals(Boolean.FALSE,getRS().getRegionsInTransitionInRS().get(hri.getEncodedNameAsBytes()));
  HTableDescriptor htd=getRS().tableDescriptors.get(hri.getTable());
  getRS().service.submit(new OpenRegionHandler(getRS(),getRS(),hri,htd,-1));
  checkRegionIsClosed(HTU,getRS(),hri);
  openRegion(HTU,getRS(),hri);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerOnlineConfigChange </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check if the number of compaction threads changes online
 * @throws IOException
 */
@Test public void testNumCompactionThreadsOnlineChange() throws IOException {
  assertTrue(rs1.compactSplitThread != null);
  int newNumSmallThreads=rs1.compactSplitThread.getSmallCompactionThreadNum() + 1;
  int newNumLargeThreads=rs1.compactSplitThread.getLargeCompactionThreadNum() + 1;
  conf.setInt("hbase.regionserver.thread.compaction.small",newNumSmallThreads);
  conf.setInt("hbase.regionserver.thread.compaction.large",newNumLargeThreads);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newNumSmallThreads,rs1.compactSplitThread.getSmallCompactionThreadNum());
  assertEquals(newNumLargeThreads,rs1.compactSplitThread.getLargeCompactionThreadNum());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the configurations in the CompactionConfiguration class change
 * properly.
 * @throws IOException
 */
@Test public void testCompactionConfigurationOnlineChange() throws IOException {
  String strPrefix="hbase.hstore.compaction.";
  Store s=r1.getStore(COLUMN_FAMILY1);
  if (!(s instanceof HStore)) {
    LOG.error("Can't test the compaction configuration of HStore class. " + "Got a different implementation other than HStore");
    return;
  }
  HStore hstore=(HStore)s;
  double newCompactionRatio=hstore.getStoreEngine().getCompactionPolicy().getConf().getCompactionRatio() + 0.1;
  conf.setFloat(strPrefix + "ratio",(float)newCompactionRatio);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newCompactionRatio,hstore.getStoreEngine().getCompactionPolicy().getConf().getCompactionRatio(),0.00001);
  double newOffPeakCompactionRatio=hstore.getStoreEngine().getCompactionPolicy().getConf().getCompactionRatioOffPeak() + 0.1;
  conf.setFloat(strPrefix + "ratio.offpeak",(float)newOffPeakCompactionRatio);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newOffPeakCompactionRatio,hstore.getStoreEngine().getCompactionPolicy().getConf().getCompactionRatioOffPeak(),0.00001);
  long newThrottlePoint=hstore.getStoreEngine().getCompactionPolicy().getConf().getThrottlePoint() + 10;
  conf.setLong("hbase.regionserver.thread.compaction.throttle",newThrottlePoint);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newThrottlePoint,hstore.getStoreEngine().getCompactionPolicy().getConf().getThrottlePoint());
  int newMinFilesToCompact=hstore.getStoreEngine().getCompactionPolicy().getConf().getMinFilesToCompact() + 1;
  conf.setLong(strPrefix + "min",newMinFilesToCompact);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMinFilesToCompact,hstore.getStoreEngine().getCompactionPolicy().getConf().getMinFilesToCompact());
  int newMaxFilesToCompact=hstore.getStoreEngine().getCompactionPolicy().getConf().getMaxFilesToCompact() + 1;
  conf.setLong(strPrefix + "max",newMaxFilesToCompact);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMaxFilesToCompact,hstore.getStoreEngine().getCompactionPolicy().getConf().getMaxFilesToCompact());
  conf.setLong(CompactionConfiguration.HBASE_HSTORE_OFFPEAK_START_HOUR,6);
  conf.setLong(CompactionConfiguration.HBASE_HSTORE_OFFPEAK_END_HOUR,7);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertFalse(hstore.getOffPeakHours().isOffPeakHour(4));
  long newMinCompactSize=hstore.getStoreEngine().getCompactionPolicy().getConf().getMinCompactSize() + 1;
  conf.setLong(strPrefix + "min.size",newMinCompactSize);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMinCompactSize,hstore.getStoreEngine().getCompactionPolicy().getConf().getMinCompactSize());
  long newMaxCompactSize=hstore.getStoreEngine().getCompactionPolicy().getConf().getMaxCompactSize() - 1;
  conf.setLong(strPrefix + "max.size",newMaxCompactSize);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMaxCompactSize,hstore.getStoreEngine().getCompactionPolicy().getConf().getMaxCompactSize());
  long newOffpeakMaxCompactSize=hstore.getStoreEngine().getCompactionPolicy().getConf().getOffPeakMaxCompactSize() - 1;
  conf.setLong(CompactionConfiguration.HBASE_HSTORE_COMPACTION_MAX_SIZE_OFFPEAK_KEY,newOffpeakMaxCompactSize);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newOffpeakMaxCompactSize,hstore.getStoreEngine().getCompactionPolicy().getConf().getOffPeakMaxCompactSize());
  long newMajorCompactionPeriod=hstore.getStoreEngine().getCompactionPolicy().getConf().getMajorCompactionPeriod() + 10;
  conf.setLong(HConstants.MAJOR_COMPACTION_PERIOD,newMajorCompactionPeriod);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMajorCompactionPeriod,hstore.getStoreEngine().getCompactionPolicy().getConf().getMajorCompactionPeriod());
  float newMajorCompactionJitter=hstore.getStoreEngine().getCompactionPolicy().getConf().getMajorCompactionJitter() + 0.02F;
  conf.setFloat("hbase.hregion.majorcompaction.jitter",newMajorCompactionJitter);
  rs1.getConfigurationManager().notifyAllObservers(conf);
  assertEquals(newMajorCompactionJitter,hstore.getStoreEngine().getCompactionPolicy().getConf().getMajorCompactionJitter(),0.00001);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerReportForDuty </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests region sever reportForDuty with backup master becomes primary master after
 * the first master goes away.
 */
@Test(timeout=180000) public void testReportForDutyWithMasterChange() throws Exception {
  cluster.getConfiguration().setInt(HConstants.MASTER_PORT,HBaseTestingUtility.randomFreePort());
  cluster.getConfiguration().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,2);
  cluster.getConfiguration().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MAXTOSTART,2);
  master=cluster.addMaster();
  rs=cluster.addRegionServer();
  LOG.debug("Starting master: " + master.getMaster().getServerName());
  master.start();
  rs.start();
  waitForClusterOnline(master);
  cluster.getConfiguration().set(HConstants.REGION_SERVER_IMPL,MyRegionServer.class.getName());
  rs2=cluster.addRegionServer();
  LOG.debug("Starting 2nd region server: " + rs2.getRegionServer().getServerName());
  rs2.start();
  waitForSecondRsStarted();
  master.getMaster().stop("Stopping master");
  cluster.getConfiguration().setInt(HConstants.MASTER_PORT,HBaseTestingUtility.randomFreePort());
  cluster.getConfiguration().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MINTOSTART,3);
  cluster.getConfiguration().setInt(ServerManager.WAIT_ON_REGIONSERVERS_MAXTOSTART,3);
  backupMaster=cluster.addMaster();
  LOG.debug("Starting new master: " + backupMaster.getMaster().getServerName());
  backupMaster.start();
  waitForClusterOnline(backupMaster);
  assertTrue(backupMaster.getMaster().isActiveMaster());
  assertTrue(backupMaster.getMaster().isInitialized());
  assertEquals(backupMaster.getMaster().getServerManager().getOnlineServersList().size(),3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionSplitPolicy </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSplitPoint() throws IOException {
  ConstantSizeRegionSplitPolicy policy=(ConstantSizeRegionSplitPolicy)RegionSplitPolicy.create(mockRegion,conf);
  assertFalse(policy.shouldSplit());
  assertNull(policy.getSplitPoint());
  HStore mockStore=Mockito.mock(HStore.class);
  Mockito.doReturn(2000L).when(mockStore).getSize();
  Mockito.doReturn(true).when(mockStore).canSplit();
  Mockito.doReturn(Bytes.toBytes("store 1 split")).when(mockStore).getSplitPoint();
  stores.add(mockStore);
  assertEquals("store 1 split",Bytes.toString(policy.getSplitPoint()));
  HStore mockStore2=Mockito.mock(HStore.class);
  Mockito.doReturn(4000L).when(mockStore2).getSize();
  Mockito.doReturn(true).when(mockStore2).canSplit();
  Mockito.doReturn(Bytes.toBytes("store 2 split")).when(mockStore2).getSplitPoint();
  stores.add(mockStore2);
  assertEquals("store 2 split",Bytes.toString(policy.getSplitPoint()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestResettingCounters </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResettingCounters() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  Configuration conf=htu.getConfiguration();
  FileSystem fs=FileSystem.get(conf);
  byte[] table=Bytes.toBytes("table");
  byte[][] families=new byte[][]{Bytes.toBytes("family1"),Bytes.toBytes("family2"),Bytes.toBytes("family3")};
  int numQualifiers=10;
  byte[][] qualifiers=new byte[numQualifiers][];
  for (int i=0; i < numQualifiers; i++)   qualifiers[i]=Bytes.toBytes("qf" + i);
  int numRows=10;
  byte[][] rows=new byte[numRows][];
  for (int i=0; i < numRows; i++)   rows[i]=Bytes.toBytes("r" + i);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(table));
  for (  byte[] family : families)   htd.addFamily(new HColumnDescriptor(family));
  HRegionInfo hri=new HRegionInfo(htd.getTableName(),null,null,false);
  String testDir=htu.getDataTestDir() + "/TestResettingCounters/";
  Path path=new Path(testDir);
  if (fs.exists(path)) {
    if (!fs.delete(path,true)) {
      throw new IOException("Failed delete of " + path);
    }
  }
  Region region=HBaseTestingUtility.createRegionAndWAL(hri,path,conf,htd);
  try {
    Increment odd=new Increment(rows[0]);
    odd.setDurability(Durability.SKIP_WAL);
    Increment even=new Increment(rows[0]);
    even.setDurability(Durability.SKIP_WAL);
    Increment all=new Increment(rows[0]);
    all.setDurability(Durability.SKIP_WAL);
    for (int i=0; i < numQualifiers; i++) {
      if (i % 2 == 0)       even.addColumn(families[0],qualifiers[i],1);
 else       odd.addColumn(families[0],qualifiers[i],1);
      all.addColumn(families[0],qualifiers[i],1);
    }
    for (int i=0; i < 5; i++)     region.increment(odd,HConstants.NO_NONCE,HConstants.NO_NONCE);
    region.flush(true);
    for (int i=0; i < 5; i++)     region.increment(even,HConstants.NO_NONCE,HConstants.NO_NONCE);
    Result result=region.increment(all,HConstants.NO_NONCE,HConstants.NO_NONCE);
    assertEquals(numQualifiers,result.size());
    Cell[] kvs=result.rawCells();
    for (int i=0; i < kvs.length; i++) {
      System.out.println(kvs[i].toString());
      assertTrue(CellUtil.matchingQualifier(kvs[i],qualifiers[i]));
      assertEquals(6,Bytes.toLong(CellUtil.cloneValue(kvs[i])));
    }
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScanner </h4><pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test basic stop row filter works.
 * @throws Exception
 */
@Test public void testStopRow() throws Exception {
  byte[] startrow=Bytes.toBytes("bbb");
  byte[] stoprow=Bytes.toBytes("ccc");
  try {
    this.region=TEST_UTIL.createLocalHRegion(TESTTABLEDESC,null,null);
    HBaseTestCase.addContent(this.region,HConstants.CATALOG_FAMILY);
    List<Cell> results=new ArrayList<Cell>();
    Scan scan=new Scan(Bytes.toBytes("abc"),Bytes.toBytes("abd"));
    scan.addFamily(HConstants.CATALOG_FAMILY);
    InternalScanner s=region.getScanner(scan);
    int count=0;
    while (s.next(results)) {
      count++;
    }
    s.close();
    assertEquals(0,count);
    scan=new Scan(startrow,stoprow);
    scan.addFamily(HConstants.CATALOG_FAMILY);
    s=region.getScanner(scan);
    count=0;
    Cell kv=null;
    results=new ArrayList<Cell>();
    for (boolean first=true; s.next(results); ) {
      kv=results.get(0);
      if (first) {
        assertTrue(CellUtil.matchingRow(kv,startrow));
        first=false;
      }
      count++;
    }
    assertTrue(Bytes.BYTES_COMPARATOR.compare(stoprow,CellUtil.cloneRow(kv)) > 0);
    assertTrue(count > 10);
    s.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowRange() throws Throwable {
  try (Table table=util.getConnection().getTable(TEST_TABLE);RegionLocator locator=util.getConnection().getRegionLocator(TEST_TABLE)){
    for (    HRegionLocation e : locator.getAllRegionLocations()) {
      LOG.info("Region " + e.getRegionInfo().getRegionNameAsString() + ", servername="+ e.getServerName());
    }
    Map<byte[],String> results=ping(table,null,ROW_A);
    assertEquals(1,results.size());
    verifyRegionResults(locator,results,ROW_A);
    results=ping(table,ROW_BC,null);
    assertEquals(2,results.size());
    HRegionLocation loc=locator.getRegionLocation(ROW_A,true);
    assertNull("Should be missing region for row aaa (prior to start row)",results.get(loc.getRegionInfo().getRegionName()));
    verifyRegionResults(locator,results,ROW_B);
    verifyRegionResults(locator,results,ROW_C);
    results=ping(table,null,ROW_BC);
    assertEquals(2,results.size());
    verifyRegionResults(locator,results,ROW_A);
    verifyRegionResults(locator,results,ROW_B);
    loc=locator.getRegionLocation(ROW_C,true);
    assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
    results=ping(table,ROW_AB,ROW_BC);
    assertEquals(2,results.size());
    verifyRegionResults(locator,results,ROW_A);
    verifyRegionResults(locator,results,ROW_B);
    loc=locator.getRegionLocation(ROW_C,true);
    assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
    results=ping(table,ROW_B,ROW_BC);
    assertEquals(1,results.size());
    verifyRegionResults(locator,results,ROW_B);
    loc=locator.getRegionLocation(ROW_A,true);
    assertNull("Should be missing region for row aaa (prior to start)",results.get(loc.getRegionInfo().getRegionName()));
    loc=locator.getRegionLocation(ROW_C,true);
    assertNull("Should be missing region for row ccc (past stop row)",results.get(loc.getRegionInfo().getRegionName()));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyReturnType() throws Throwable {
  try (Table table=util.getConnection().getTable(TEST_TABLE)){
    Map<byte[],String> results=noop(table,ROW_A,ROW_C);
    assertEquals("Should have results from three regions",3,results.size());
    for (    Object v : results.values()) {
      assertNull(v);
    }
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleProxy() throws Throwable {
  Table table=util.getConnection().getTable(TEST_TABLE);
  Map<byte[],String> results=ping(table,null,null);
  assertEquals(3,results.size());
  for (  Map.Entry<byte[],String> e : results.entrySet()) {
    assertEquals("Invalid custom protocol response","pong",e.getValue());
  }
  hello(table,"George",HELLO + "George");
  LOG.info("Did george");
  hello(table,null,"Who are you?");
  LOG.info("Who are you");
  hello(table,NOBODY,null);
  LOG.info(NOBODY);
  Map<byte[],Integer> intResults=table.coprocessorService(PingProtos.PingService.class,null,null,new Batch.Call<PingProtos.PingService,Integer>(){
    @Override public Integer call(    PingProtos.PingService instance) throws IOException {
      BlockingRpcCallback<PingProtos.CountResponse> rpcCallback=new BlockingRpcCallback<PingProtos.CountResponse>();
      instance.count(null,PingProtos.CountRequest.newBuilder().build(),rpcCallback);
      return rpcCallback.get().getCount();
    }
  }
);
  int count=-1;
  for (  Map.Entry<byte[],Integer> e : intResults.entrySet()) {
    assertTrue(e.getValue() > 0);
    count=e.getValue();
  }
  final int diff=5;
  intResults=table.coprocessorService(PingProtos.PingService.class,null,null,new Batch.Call<PingProtos.PingService,Integer>(){
    @Override public Integer call(    PingProtos.PingService instance) throws IOException {
      BlockingRpcCallback<PingProtos.IncrementCountResponse> rpcCallback=new BlockingRpcCallback<PingProtos.IncrementCountResponse>();
      instance.increment(null,PingProtos.IncrementCountRequest.newBuilder().setDiff(diff).build(),rpcCallback);
      return rpcCallback.get().getCount();
    }
  }
);
  assertEquals(3,results.size());
  for (  Map.Entry<byte[],Integer> e : intResults.entrySet()) {
    assertEquals(e.getValue().intValue(),count + diff);
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestServerNonceManager </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalStartEnd() throws Exception {
  final long[] numbers=new long[]{NO_NONCE,1,2,Long.MAX_VALUE,Long.MIN_VALUE};
  ServerNonceManager nm=createManager();
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      assertTrue(nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
  for (int i=0; i < numbers.length; ++i) {
    assertTrue(nm.startOperation(numbers[i],NO_NONCE,createStoppable()));
  }
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      nm.endOperation(numbers[i],numbers[j],false);
      assertTrue(nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
  for (int i=0; i < numbers.length; ++i) {
    for (int j=0; j < numbers.length; ++j) {
      nm.endOperation(numbers[i],numbers[j],true);
      assertEquals(numbers[j] == NO_NONCE,nm.startOperation(numbers[i],numbers[j],createStoppable()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitLogWorker </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testMultipleTasks() throws Exception {
  LOG.info("testMultipleTasks");
  SplitLogCounters.resetCounters();
  final ServerName SRV=ServerName.valueOf("tmt_svr,1,1");
  final String PATH1=ZKSplitLog.getEncodedNodeName(zkw,"tmt_task");
  RegionServerServices mockedRS=getRegionServer(SRV);
  SplitLogWorker slw=new SplitLogWorker(ds,TEST_UTIL.getConfiguration(),mockedRS,neverEndingTask);
  slw.start();
  try {
    Thread.yield();
    Thread.sleep(100);
    waitForCounter(SplitLogCounters.tot_wkr_task_grabing,0,1,WAIT_TIME);
    SplitLogTask unassignedManager=new SplitLogTask.Unassigned(MANAGER,this.mode);
    zkw.getRecoverableZooKeeper().create(PATH1,unassignedManager.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    waitForCounter(SplitLogCounters.tot_wkr_task_acquired,0,1,WAIT_TIME);
    final String PATH2=ZKSplitLog.getEncodedNodeName(zkw,"tmt_task_2");
    zkw.getRecoverableZooKeeper().create(PATH2,unassignedManager.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    final ServerName anotherWorker=ServerName.valueOf("another-worker,1,1");
    SplitLogTask slt=new SplitLogTask.Owned(anotherWorker,this.mode);
    ZKUtil.setData(zkw,PATH1,slt.toByteArray());
    waitForCounter(SplitLogCounters.tot_wkr_preempt_task,0,1,WAIT_TIME);
    waitForCounter(SplitLogCounters.tot_wkr_task_acquired,1,2,WAIT_TIME);
    assertEquals(2,slw.getTaskReadySeq());
    byte[] bytes=ZKUtil.getData(zkw,PATH2);
    slt=SplitLogTask.parseFrom(bytes);
    assertTrue(slt.isOwned(SRV));
  }
  finally {
    stopSplitLogWorker(slw);
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRescan() throws Exception {
  LOG.info("testRescan");
  SplitLogCounters.resetCounters();
  final ServerName SRV=ServerName.valueOf("svr,1,1");
  RegionServerServices mockedRS=getRegionServer(SRV);
  slw=new SplitLogWorker(ds,TEST_UTIL.getConfiguration(),mockedRS,neverEndingTask);
  slw.start();
  Thread.yield();
  Thread.sleep(100);
  String task=ZKSplitLog.getEncodedNodeName(zkw,"task");
  SplitLogTask slt=new SplitLogTask.Unassigned(MANAGER,this.mode);
  zkw.getRecoverableZooKeeper().create(task,slt.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  waitForCounter(SplitLogCounters.tot_wkr_task_acquired,0,1,WAIT_TIME);
  ZKUtil.setData(zkw,task,slt.toByteArray());
  waitForCounter(SplitLogCounters.tot_wkr_preempt_task,0,1,WAIT_TIME);
  String rescan=ZKSplitLog.getEncodedNodeName(zkw,"RESCAN");
  rescan=zkw.getRecoverableZooKeeper().create(rescan,slt.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
  waitForCounter(SplitLogCounters.tot_wkr_task_acquired,1,2,WAIT_TIME);
  ZKUtil.setData(zkw,task,slt.toByteArray());
  waitForCounter(SplitLogCounters.tot_wkr_preempt_task,1,2,WAIT_TIME);
  waitForCounter(SplitLogCounters.tot_wkr_task_acquired_rescan,0,1,WAIT_TIME);
  List<String> nodes=ZKUtil.listChildrenNoWatch(zkw,zkw.splitLogZNode);
  LOG.debug(nodes);
  int num=0;
  for (  String node : nodes) {
    num++;
    if (node.startsWith("RESCAN")) {
      String name=ZKSplitLog.getEncodedNodeName(zkw,node);
      String fn=ZKSplitLog.getFileName(name);
      byte[] data=ZKUtil.getData(zkw,ZKUtil.joinZNode(zkw.splitLogZNode,fn));
      slt=SplitLogTask.parseFrom(data);
      assertTrue(slt.toString(),slt.isDone(SRV));
    }
  }
  assertEquals(2,num);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-20 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  TEST_UTIL.startMiniZKCluster();
  Configuration conf=TEST_UTIL.getConfiguration();
  zkw=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"split-log-worker-tests",null);
  ds=new DummyServer(zkw,conf);
  ZKUtil.deleteChildrenRecursively(zkw,zkw.baseZNode);
  ZKUtil.createAndFailSilent(zkw,zkw.baseZNode);
  assertThat(ZKUtil.checkExists(zkw,zkw.baseZNode),not(is(-1)));
  LOG.debug(zkw.baseZNode + " created");
  ZKUtil.createAndFailSilent(zkw,zkw.splitLogZNode);
  assertThat(ZKUtil.checkExists(zkw,zkw.splitLogZNode),not(is(-1)));
  LOG.debug(zkw.splitLogZNode + " created");
  ZKUtil.createAndFailSilent(zkw,zkw.rsZNode);
  assertThat(ZKUtil.checkExists(zkw,zkw.rsZNode),not(is(-1)));
  SplitLogCounters.resetCounters();
  executorService=new ExecutorService("TestSplitLogWorker");
  executorService.startExecutorService(ExecutorType.RS_LOG_REPLAY_OPS,10);
  this.mode=(conf.getBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,false) ? RecoveryMode.LOG_REPLAY : RecoveryMode.LOG_SPLITTING);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testPreemptTask() throws Exception {
  LOG.info("testPreemptTask");
  SplitLogCounters.resetCounters();
  final ServerName SRV=ServerName.valueOf("tpt_svr,1,1");
  final String PATH=ZKSplitLog.getEncodedNodeName(zkw,"tpt_task");
  RegionServerServices mockedRS=getRegionServer(SRV);
  SplitLogWorker slw=new SplitLogWorker(ds,TEST_UTIL.getConfiguration(),mockedRS,neverEndingTask);
  slw.start();
  try {
    Thread.yield();
    Thread.sleep(1000);
    waitForCounter(SplitLogCounters.tot_wkr_task_grabing,0,1,WAIT_TIME);
    zkw.getRecoverableZooKeeper().create(PATH,new SplitLogTask.Unassigned(MANAGER,this.mode).toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    waitForCounter(SplitLogCounters.tot_wkr_task_acquired,0,1,WAIT_TIME);
    assertEquals(1,slw.getTaskReadySeq());
    byte[] bytes=ZKUtil.getData(zkw,PATH);
    SplitLogTask slt=SplitLogTask.parseFrom(bytes);
    assertTrue(slt.isOwned(SRV));
    slt=new SplitLogTask.Owned(MANAGER,this.mode);
    ZKUtil.setData(zkw,PATH,slt.toByteArray());
    waitForCounter(SplitLogCounters.tot_wkr_preempt_task,0,1,WAIT_TIME);
  }
  finally {
    stopSplitLogWorker(slw);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitTransaction </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollback() throws IOException {
  final int rowcount=TEST_UTIL.loadRegion(this.parent,CF);
  assertTrue(rowcount > 0);
  int parentRowCount=countRows(this.parent);
  assertEquals(rowcount,parentRowCount);
  HRegion spiedRegion=spy(this.parent);
  SplitTransactionImpl st=prepareGOOD_SPLIT_ROW(spiedRegion);
  SplitTransactionImpl spiedUponSt=spy(st);
  doNothing().when(spiedUponSt).assertReferenceFileCount(anyInt(),eq(parent.getRegionFileSystem().getSplitsDir(st.getFirstDaughter())));
  when(spiedRegion.createDaughterRegionFromSplits(spiedUponSt.getSecondDaughter())).thenThrow(new MockedFailedDaughterCreation());
  boolean expectedException=false;
  Server mockServer=Mockito.mock(Server.class);
  when(mockServer.getConfiguration()).thenReturn(TEST_UTIL.getConfiguration());
  try {
    spiedUponSt.execute(mockServer,null);
  }
 catch (  MockedFailedDaughterCreation e) {
    expectedException=true;
  }
  assertTrue(expectedException);
  assertTrue(spiedUponSt.rollback(null,null));
  int parentRowCount2=countRows(this.parent);
  assertEquals(parentRowCount,parentRowCount2);
  assertTrue(!this.fs.exists(HRegion.getRegionDir(this.testdir,st.getFirstDaughter())));
  assertTrue(!this.fs.exists(HRegion.getRegionDir(this.testdir,st.getSecondDaughter())));
  assertTrue(!this.parent.lock.writeLock().isHeldByCurrentThread());
  assertTrue(st.prepare());
  PairOfSameType<Region> daughters=st.execute(mockServer,null);
  int daughtersRowCount=0;
  for (  Region openRegion : daughters) {
    try {
      int count=countRows(openRegion);
      assertTrue(count > 0 && count != rowcount);
      daughtersRowCount+=count;
    }
  finally {
      HBaseTestingUtility.closeRegionAndWAL(openRegion);
    }
  }
  assertEquals(rowcount,daughtersRowCount);
  assertTrue(!this.parent.lock.writeLock().isHeldByCurrentThread());
  assertTrue("Rollback hooks should be called.",wasRollBackHookCalled());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCountReferencesFailsSplit() throws IOException {
  final int rowcount=TEST_UTIL.loadRegion(this.parent,CF);
  assertTrue(rowcount > 0);
  int parentRowCount=countRows(this.parent);
  assertEquals(rowcount,parentRowCount);
  HRegion spiedRegion=spy(this.parent);
  SplitTransactionImpl st=prepareGOOD_SPLIT_ROW(spiedRegion);
  SplitTransactionImpl spiedUponSt=spy(st);
  doThrow(new IOException("Failing split. Expected reference file count isn't equal.")).when(spiedUponSt).assertReferenceFileCount(anyInt(),eq(new Path(this.parent.getRegionFileSystem().getTableDir(),st.getSecondDaughter().getEncodedName())));
  boolean expectedException=false;
  Server mockServer=Mockito.mock(Server.class);
  when(mockServer.getConfiguration()).thenReturn(TEST_UTIL.getConfiguration());
  try {
    spiedUponSt.execute(mockServer,null);
  }
 catch (  IOException e) {
    expectedException=true;
  }
  assertTrue(expectedException);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWholesomeSplit() throws IOException {
  final int rowcount=TEST_UTIL.loadRegion(this.parent,CF,true);
  assertTrue(rowcount > 0);
  int parentRowCount=countRows(this.parent);
  assertEquals(rowcount,parentRowCount);
  CacheConfig cacheConf=new CacheConfig(TEST_UTIL.getConfiguration());
  ((LruBlockCache)cacheConf.getBlockCache()).clearCache();
  SplitTransactionImpl st=prepareGOOD_SPLIT_ROW();
  Server mockServer=Mockito.mock(Server.class);
  when(mockServer.getConfiguration()).thenReturn(TEST_UTIL.getConfiguration());
  PairOfSameType<Region> daughters=st.execute(mockServer,null);
  assertTrue(this.fs.exists(this.parent.getRegionFileSystem().getSplitsDir()));
  assertTrue(this.parent.isClosed());
  assertEquals(0,this.fs.listStatus(this.parent.getRegionFileSystem().getSplitsDir()).length);
  assertTrue(Bytes.equals(parent.getRegionInfo().getStartKey(),daughters.getFirst().getRegionInfo().getStartKey()));
  assertTrue(Bytes.equals(GOOD_SPLIT_ROW,daughters.getFirst().getRegionInfo().getEndKey()));
  assertTrue(Bytes.equals(daughters.getSecond().getRegionInfo().getStartKey(),GOOD_SPLIT_ROW));
  assertTrue(Bytes.equals(parent.getRegionInfo().getEndKey(),daughters.getSecond().getRegionInfo().getEndKey()));
  int daughtersRowCount=0;
  for (  Region openRegion : daughters) {
    try {
      int count=countRows(openRegion);
      assertTrue(count > 0 && count != rowcount);
      daughtersRowCount+=count;
    }
  finally {
      HBaseTestingUtility.closeRegionAndWAL(openRegion);
    }
  }
  assertEquals(rowcount,daughtersRowCount);
  assertTrue(!this.parent.lock.writeLock().isHeldByCurrentThread());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailAfterPONR() throws IOException, KeeperException {
  final int rowcount=TEST_UTIL.loadRegion(this.parent,CF);
  assertTrue(rowcount > 0);
  int parentRowCount=countRows(this.parent);
  assertEquals(rowcount,parentRowCount);
  SplitTransactionImpl st=prepareGOOD_SPLIT_ROW();
  SplitTransactionImpl spiedUponSt=spy(st);
  Mockito.doThrow(new MockedFailedDaughterOpen()).when(spiedUponSt).openDaughterRegion((Server)Mockito.anyObject(),(HRegion)Mockito.anyObject());
  boolean expectedException=false;
  Server mockServer=Mockito.mock(Server.class);
  when(mockServer.getConfiguration()).thenReturn(TEST_UTIL.getConfiguration());
  try {
    spiedUponSt.execute(mockServer,null);
  }
 catch (  IOException e) {
    if (e.getCause() != null && e.getCause() instanceof MockedFailedDaughterOpen) {
      expectedException=true;
    }
  }
  assertTrue(expectedException);
  assertFalse(spiedUponSt.rollback(null,null));
  Path tableDir=this.parent.getRegionFileSystem().getTableDir();
  Path daughterADir=new Path(tableDir,spiedUponSt.getFirstDaughter().getEncodedName());
  Path daughterBDir=new Path(tableDir,spiedUponSt.getSecondDaughter().getEncodedName());
  assertTrue(TEST_UTIL.getTestFileSystem().exists(daughterADir));
  assertTrue(TEST_UTIL.getTestFileSystem().exists(daughterBDir));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster </h4><pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitWithRegionReplicas() throws Exception {
  final TableName tableName=TableName.valueOf("foobar");
  HTableDescriptor htd=TESTING_UTIL.createTableDescriptor("foobar");
  htd.setRegionReplication(2);
  htd.addCoprocessor(SlowMeCopro.class.getName());
  Table t=TESTING_UTIL.createTable(htd,new byte[][]{Bytes.toBytes("cf")},null);
  List<HRegion> oldRegions;
  do {
    oldRegions=cluster.getRegions(tableName);
    Thread.sleep(10);
  }
 while (oldRegions.size() != 2);
  for (  HRegion h : oldRegions)   LOG.debug("OLDREGION " + h.getRegionInfo());
  try {
    int regionServerIndex=cluster.getServerWith(oldRegions.get(0).getRegionInfo().getRegionName());
    HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
    insertData(tableName,admin,t);
    admin.setBalancerRunning(false,true);
    cluster.getMaster().setCatalogJanitorEnabled(false);
    boolean tableExists=MetaTableAccessor.tableExists(regionServer.getConnection(),tableName);
    assertEquals("The specified table should be present.",true,tableExists);
    final HRegion region=findSplittableRegion(oldRegions);
    regionServerIndex=cluster.getServerWith(region.getRegionInfo().getRegionName());
    regionServer=cluster.getRegionServer(regionServerIndex);
    assertTrue("not able to find a splittable region",region != null);
    SplitTransactionImpl st=new SplitTransactionImpl(region,Bytes.toBytes("row2"));
    try {
      st.prepare();
      st.execute(regionServer,regionServer);
    }
 catch (    IOException e) {
      e.printStackTrace();
      fail("Split execution should have succeeded with no exceptions thrown " + e);
    }
    List<HRegion> newRegions;
    do {
      newRegions=cluster.getRegions(tableName);
      for (      HRegion h : newRegions)       LOG.debug("NEWREGION " + h.getRegionInfo());
      Thread.sleep(1000);
    }
 while ((newRegions.contains(oldRegions.get(0)) || newRegions.contains(oldRegions.get(1))) || newRegions.size() != 4);
    tableExists=MetaTableAccessor.tableExists(regionServer.getConnection(),tableName);
    assertEquals("The specified table should be present.",true,tableExists);
    byte[] b1="row1".getBytes();
    Get g=new Get(b1);
    g.setConsistency(Consistency.STRONG);
    Result r=t.get(g);
    Assert.assertFalse(r.isStale());
    LOG.info("exists stale after flush done");
    SlowMeCopro.getCdl().set(new CountDownLatch(1));
    g=new Get(b1);
    g.setConsistency(Consistency.TIMELINE);
    r=t.get(g);
    Assert.assertTrue(r.isStale());
    SlowMeCopro.getCdl().get().countDown();
  }
  finally {
    SlowMeCopro.getCdl().get().countDown();
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    t.close();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testSplitFailedCompactionAndSplit() throws Exception {
  final TableName tableName=TableName.valueOf("testSplitFailedCompactionAndSplit");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  byte[] cf=Bytes.toBytes("cf");
  htd.addFamily(new HColumnDescriptor(cf));
  admin.createTable(htd);
  for (int i=0; cluster.getRegions(tableName).size() == 0 && i < 100; i++) {
    Thread.sleep(100);
  }
  assertEquals(1,cluster.getRegions(tableName).size());
  HRegion region=cluster.getRegions(tableName).get(0);
  Store store=region.getStore(cf);
  int regionServerIndex=cluster.getServerWith(region.getRegionInfo().getRegionName());
  HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
  Table t=TESTING_UTIL.getConnection().getTable(tableName);
  insertData(tableName,admin,t);
  insertData(tableName,admin,t);
  int fileNum=store.getStorefiles().size();
  store.triggerMajorCompaction();
  CompactionContext cc=store.requestCompaction();
  assertNotNull(cc);
  assertEquals(2,region.close(false).get(cf).size());
  region.initialize();
  assertFalse(region.compact(cc,store,NoLimitThroughputController.INSTANCE));
  assertTrue(fileNum > store.getStorefiles().size());
  SplitTransactionImpl st=new SplitTransactionImpl(region,Bytes.toBytes("row3"));
  assertTrue(st.prepare());
  st.execute(regionServer,regionServer);
  assertEquals(2,cluster.getRegions(tableName).size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testTableExistsIfTheSpecifiedTableRegionIsSplitParent() throws Exception {
  final TableName tableName=TableName.valueOf("testTableExistsIfTheSpecifiedTableRegionIsSplitParent");
  Table t=createTableAndWait(tableName,Bytes.toBytes("cf"));
  List<HRegion> regions=null;
  try {
    regions=cluster.getRegions(tableName);
    int regionServerIndex=cluster.getServerWith(regions.get(0).getRegionInfo().getRegionName());
    HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
    insertData(tableName,admin,t);
    admin.setBalancerRunning(false,true);
    cluster.getMaster().setCatalogJanitorEnabled(false);
    boolean tableExists=MetaTableAccessor.tableExists(regionServer.getConnection(),tableName);
    assertEquals("The specified table should present.",true,tableExists);
    final HRegion region=findSplittableRegion(regions);
    assertTrue("not able to find a splittable region",region != null);
    SplitTransactionImpl st=new SplitTransactionImpl(region,Bytes.toBytes("row2"));
    try {
      st.prepare();
      st.createDaughters(regionServer,regionServer,null);
    }
 catch (    IOException e) {
    }
    tableExists=MetaTableAccessor.tableExists(regionServer.getConnection(),tableName);
    assertEquals("The specified table should present.",true,tableExists);
    Map<String,RegionState> rit=cluster.getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition();
    assertTrue(rit.size() == 3);
    cluster.getMaster().getAssignmentManager().regionOffline(st.getFirstDaughter());
    cluster.getMaster().getAssignmentManager().regionOffline(st.getSecondDaughter());
    cluster.getMaster().getAssignmentManager().regionOffline(region.getRegionInfo());
    rit=cluster.getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition();
    assertTrue(rit.size() == 0);
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    t.close();
    TESTING_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRITStateForRollback() throws Exception {
  final TableName tableName=TableName.valueOf("testRITStateForRollback");
  try {
    Table t=createTableAndWait(tableName,Bytes.toBytes("cf"));
    final List<HRegion> regions=cluster.getRegions(tableName);
    final HRegionInfo hri=getAndCheckSingleTableRegion(regions);
    insertData(tableName,admin,t);
    t.close();
    this.admin.setBalancerRunning(false,true);
    cluster.getMaster().setCatalogJanitorEnabled(false);
    final HRegion region=findSplittableRegion(regions);
    assertTrue("not able to find a splittable region",region != null);
    region.getCoprocessorHost().load(FailingSplitRegionObserver.class,Coprocessor.PRIORITY_USER,region.getBaseConf());
    this.admin.splitRegion(region.getRegionInfo().getRegionName(),new byte[]{42});
    FailingSplitRegionObserver observer=(FailingSplitRegionObserver)region.getCoprocessorHost().findCoprocessor(FailingSplitRegionObserver.class.getName());
    assertNotNull(observer);
    observer.latch.await();
    LOG.info("Waiting for region to come out of RIT");
    TESTING_UTIL.waitFor(60000,1000,new Waiter.Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        RegionStates regionStates=cluster.getMaster().getAssignmentManager().getRegionStates();
        Map<String,RegionState> rit=regionStates.getRegionsInTransition();
        return !rit.containsKey(hri.getEncodedName());
      }
    }
);
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    TESTING_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * If a table has regions that have no store files in a region, they should split successfully
 * into two regions with no store files.
 */
@Test(timeout=60000) public void testSplitRegionWithNoStoreFiles() throws Exception {
  final TableName tableName=TableName.valueOf("testSplitRegionWithNoStoreFiles");
  createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  int regionServerIndex=cluster.getServerWith(regions.get(0).getRegionInfo().getRegionName());
  HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    printOutRegions(regionServer,"Initial regions: ");
    Configuration conf=cluster.getConfiguration();
    HBaseFsck.debugLsr(conf,new Path("/"));
    Path rootDir=FSUtils.getRootDir(conf);
    FileSystem fs=TESTING_UTIL.getDFSCluster().getFileSystem();
    Map<String,Path> storefiles=FSUtils.getTableStoreFilePathMap(null,fs,rootDir,tableName);
    assertEquals("Expected nothing but found " + storefiles.toString(),storefiles.size(),0);
    regions=cluster.getRegions(tableName);
    final HRegion region=findSplittableRegion(regions);
    assertTrue("not able to find a splittable region",region != null);
    SplitTransactionImpl st=new MockedSplitTransaction(region,Bytes.toBytes("row2"));
    try {
      st.prepare();
      st.execute(regionServer,regionServer);
    }
 catch (    IOException e) {
      fail("Split execution should have succeeded with no exceptions thrown");
    }
    List<HRegion> daughters=cluster.getRegions(tableName);
    assertTrue(daughters.size() == 2);
    HBaseFsck.debugLsr(conf,new Path("/"));
    Map<String,Path> storefilesAfter=FSUtils.getTableStoreFilePathMap(null,fs,rootDir,tableName);
    assertEquals("Expected nothing but found " + storefilesAfter.toString(),storefilesAfter.size(),0);
    hri=region.getRegionInfo();
    AssignmentManager am=cluster.getMaster().getAssignmentManager();
    RegionStates regionStates=am.getRegionStates();
    long start=EnvironmentEdgeManager.currentTime();
    while (!regionStates.isRegionInState(hri,State.SPLIT)) {
      assertFalse("Timed out in waiting split parent to be in state SPLIT",EnvironmentEdgeManager.currentTime() - start > 60000);
      Thread.sleep(500);
    }
    am.assign(hri,true);
    assertFalse("Split region can't be assigned",regionStates.isRegionInTransition(hri));
    assertTrue(regionStates.isRegionInState(hri,State.SPLIT));
    am.unassign(hri,null);
    assertFalse("Split region can't be unassigned",regionStates.isRegionInTransition(hri));
    assertTrue(regionStates.isRegionInState(hri,State.SPLIT));
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Not really restarting the master. Simulate it by clear of new region
 * state since it is not persisted, will be lost after master restarts.
 */
@Test(timeout=180000) public void testSplitAndRestartingMaster() throws Exception {
  LOG.info("Starting testSplitAndRestartingMaster");
  final TableName tableName=TableName.valueOf("testSplitAndRestartingMaster");
  createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  int regionServerIndex=cluster.getServerWith(regions.get(0).getRegionInfo().getRegionName());
  HRegionServer regionServer=cluster.getRegionServer(regionServerIndex);
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    MyMasterRpcServices.enabled.set(true);
    regions=cluster.getRegions(tableName);
    final HRegion region=findSplittableRegion(regions);
    assertTrue("not able to find a splittable region",region != null);
    SplitTransactionImpl st=new SplitTransactionImpl(region,Bytes.toBytes("row2"));
    try {
      st.prepare();
      st.execute(regionServer,regionServer);
    }
 catch (    IOException e) {
      fail("Split execution should have succeeded with no exceptions thrown");
    }
    List<HRegion> daughters=cluster.getRegions(tableName);
    LOG.info("xxx " + regions.size() + AssignmentManager.TEST_SKIP_SPLIT_HANDLING);
    assertTrue(daughters.size() == 2);
  }
  finally {
    MyMasterRpcServices.enabled.set(false);
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that if daughter split on us, we won't do the shutdown handler fixup
 * just because we can't find the immediate daughter of an offlined parent.
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=300000) public void testShutdownFixupWhenDaughterHasSplit() throws IOException, InterruptedException {
  final TableName tableName=TableName.valueOf("testShutdownFixupWhenDaughterHasSplit");
  Table t=createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  int tableRegionIndex=ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    TESTING_UTIL.loadTable(t,HConstants.CATALOG_FAMILY);
    HRegionServer server=cluster.getRegionServer(tableRegionIndex);
    printOutRegions(server,"Initial regions: ");
    int regionCount=ProtobufUtil.getOnlineRegions(server.getRSRpcServices()).size();
    split(hri,server,regionCount);
    List<HRegion> daughters=checkAndGetDaughters(tableName);
    regionCount=ProtobufUtil.getOnlineRegions(server.getRSRpcServices()).size();
    HRegionInfo daughter=daughters.get(0).getRegionInfo();
    LOG.info("Daughter we are going to split: " + daughter);
    this.admin.compactRegion(daughter.getRegionName());
    daughters=cluster.getRegions(tableName);
    HRegion daughterRegion=null;
    for (    HRegion r : daughters) {
      if (r.getRegionInfo().equals(daughter)) {
        daughterRegion=r;
        LOG.info("Found matching HRI: " + daughterRegion);
        break;
      }
    }
    assertTrue(daughterRegion != null);
    for (int i=0; i < 100; i++) {
      if (!daughterRegion.hasReferences())       break;
      Threads.sleep(100);
    }
    assertFalse("Waiting for reference to be compacted",daughterRegion.hasReferences());
    LOG.info("Daughter hri before split (has been compacted): " + daughter);
    split(daughter,server,regionCount);
    daughters=cluster.getRegions(tableName);
    for (    HRegion d : daughters) {
      LOG.info("Regions before crash: " + d);
    }
    cluster.abortRegionServer(tableRegionIndex);
    waitUntilRegionServerDead();
    awaitDaughters(tableName,daughters.size());
    regions=cluster.getRegions(tableName);
    for (    HRegion d : daughters) {
      LOG.info("Regions after crash: " + d);
    }
    assertEquals(daughters.size(),regions.size());
    for (    HRegion r : regions) {
      LOG.info("Regions post crash " + r);
      assertTrue("Missing region post crash " + r,daughters.contains(r));
    }
  }
  finally {
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    t.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testSplitHooksBeforeAndAfterPONR() throws Exception {
  TableName firstTable=TableName.valueOf("testSplitHooksBeforeAndAfterPONR_1");
  TableName secondTable=TableName.valueOf("testSplitHooksBeforeAndAfterPONR_2");
  HColumnDescriptor hcd=new HColumnDescriptor("cf");
  HTableDescriptor desc=new HTableDescriptor(firstTable);
  desc.addCoprocessor(MockedRegionObserver.class.getName());
  desc.addFamily(hcd);
  admin.createTable(desc);
  TESTING_UTIL.waitUntilAllRegionsAssigned(firstTable);
  desc=new HTableDescriptor(secondTable);
  desc.addFamily(hcd);
  admin.createTable(desc);
  TESTING_UTIL.waitUntilAllRegionsAssigned(secondTable);
  List<HRegion> firstTableRegions=cluster.getRegions(firstTable);
  List<HRegion> secondTableRegions=cluster.getRegions(secondTable);
  if (firstTableRegions.size() == 0 || secondTableRegions.size() == 0) {
    fail("Each table should have at least one region.");
  }
  ServerName serverName=cluster.getServerHoldingRegion(firstTable,firstTableRegions.get(0).getRegionInfo().getRegionName());
  admin.move(secondTableRegions.get(0).getRegionInfo().getEncodedNameAsBytes(),Bytes.toBytes(serverName.getServerName()));
  Table table1=null;
  Table table2=null;
  try {
    table1=TESTING_UTIL.getConnection().getTable(firstTable);
    table2=TESTING_UTIL.getConnection().getTable(firstTable);
    insertData(firstTable,admin,table1);
    insertData(secondTable,admin,table2);
    admin.split(firstTable,"row2".getBytes());
    firstTableRegions=cluster.getRegions(firstTable);
    while (firstTableRegions.size() != 2) {
      Thread.sleep(1000);
      firstTableRegions=cluster.getRegions(firstTable);
    }
    assertEquals("Number of regions after split should be 2.",2,firstTableRegions.size());
    secondTableRegions=cluster.getRegions(secondTable);
    assertEquals("Number of regions after split should be 2.",2,secondTableRegions.size());
  }
  finally {
    if (table1 != null) {
      table1.close();
    }
    if (table2 != null) {
      table2.close();
    }
    TESTING_UTIL.deleteTable(firstTable);
    TESTING_UTIL.deleteTable(secondTable);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFileReferenceCreationWhenSplitPolicySaysToSkipRangeCheck() throws Exception {
  final TableName tableName=TableName.valueOf("testStoreFileReferenceCreationWhenSplitPolicySaysToSkipRangeCheck");
  try {
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor("f"));
    htd.addFamily(new HColumnDescriptor("i_f"));
    htd.setRegionSplitPolicyClassName(CustomSplitPolicy.class.getName());
    admin.createTable(htd);
    List<HRegion> regions=awaitTableRegions(tableName);
    HRegion region=regions.get(0);
    for (int i=3; i < 9; i++) {
      Put p=new Put(Bytes.toBytes("row" + i));
      p.addColumn(Bytes.toBytes("f"),Bytes.toBytes("q"),Bytes.toBytes("value" + i));
      p.addColumn(Bytes.toBytes("i_f"),Bytes.toBytes("q"),Bytes.toBytes("value" + i));
      region.put(p);
    }
    region.flush(true);
    Store store=region.getStore(Bytes.toBytes("f"));
    Collection<StoreFile> storefiles=store.getStorefiles();
    assertEquals(storefiles.size(),1);
    assertFalse(region.hasReferences());
    Path referencePath=region.getRegionFileSystem().splitStoreFile(region.getRegionInfo(),"f",storefiles.iterator().next(),Bytes.toBytes("row1"),false,region.getSplitPolicy());
    assertNull(referencePath);
    referencePath=region.getRegionFileSystem().splitStoreFile(region.getRegionInfo(),"i_f",storefiles.iterator().next(),Bytes.toBytes("row1"),false,region.getSplitPolicy());
    assertNotNull(referencePath);
  }
  finally {
    TESTING_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitWalDataLoss </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws IOException, InterruptedException {
  final HRegionServer rs=testUtil.getRSForFirstRegionInTable(tableName);
  final HRegion region=(HRegion)rs.getOnlineRegions(tableName).get(0);
  HRegion spiedRegion=spy(region);
  final MutableBoolean flushed=new MutableBoolean(false);
  final MutableBoolean reported=new MutableBoolean(false);
  doAnswer(new Answer<FlushResult>(){
    @Override public FlushResult answer(    InvocationOnMock invocation) throws Throwable {
synchronized (flushed) {
        flushed.setValue(true);
        flushed.notifyAll();
      }
synchronized (reported) {
        while (!reported.booleanValue()) {
          reported.wait();
        }
      }
      rs.getWAL(region.getRegionInfo()).abortCacheFlush(region.getRegionInfo().getEncodedNameAsBytes());
      throw new DroppedSnapshotException("testcase");
    }
  }
).when(spiedRegion).internalFlushCacheAndCommit(Matchers.<WAL>any(),Matchers.<MonitoredTask>any(),Matchers.<PrepareFlushResult>any(),Matchers.<Collection<Store>>any());
  String key=null;
  for (  Map.Entry<String,Region> entry : rs.onlineRegions.entrySet()) {
    if (entry.getValue().getRegionInfo().getTable().equals(this.tableName)) {
      key=entry.getKey();
      break;
    }
  }
  rs.onlineRegions.put(key,spiedRegion);
  Connection conn=testUtil.getConnection();
  try (Table table=conn.getTable(tableName)){
    table.put(new Put(Bytes.toBytes("row0")).addColumn(family,qualifier,Bytes.toBytes("val0")));
  }
   long oldestSeqIdOfStore=region.getOldestSeqIdOfStore(family);
  LOG.info("CHANGE OLDEST " + oldestSeqIdOfStore);
  assertTrue(oldestSeqIdOfStore > HConstants.NO_SEQNUM);
  rs.cacheFlusher.requestFlush(spiedRegion,false);
synchronized (flushed) {
    while (!flushed.booleanValue()) {
      flushed.wait();
    }
  }
  try (Table table=conn.getTable(tableName)){
    table.put(new Put(Bytes.toBytes("row1")).addColumn(family,qualifier,Bytes.toBytes("val1")));
  }
   long now=EnvironmentEdgeManager.currentTime();
  rs.tryRegionServerReport(now - 500,now);
synchronized (reported) {
    reported.setValue(true);
    reported.notifyAll();
  }
  while (testUtil.getRSForFirstRegionInTable(tableName) == rs) {
    Thread.sleep(100);
  }
  try (Table table=conn.getTable(tableName)){
    Result result=table.get(new Get(Bytes.toBytes("row0")));
    assertArrayEquals(Bytes.toBytes("val0"),result.getValue(family,qualifier));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStore </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementColumnValue_ICVDuringFlush() throws IOException, InterruptedException {
  init(this.name.getMethodName());
  long oldValue=1L;
  long newValue=3L;
  this.store.add(new KeyValue(row,family,qf1,System.currentTimeMillis(),Bytes.toBytes(oldValue)));
  this.store.snapshot();
  this.store.add(new KeyValue(row,family,qf2,System.currentTimeMillis(),Bytes.toBytes(oldValue)));
  long ret=this.store.updateColumnValue(row,family,qf1,newValue);
  Assert.assertTrue(ret > 0);
  flushStore(store,id++);
  Assert.assertEquals(1,this.store.getStorefiles().size());
  Assert.assertEquals(2,((DefaultMemStore)this.store.memstore).cellSet.size());
  Get get=new Get(row);
  get.addColumn(family,qf1);
  get.setMaxVersions();
  List<Cell> results=new ArrayList<Cell>();
  results=HBaseTestingUtility.getFromStoreFile(store,get);
  Assert.assertEquals(2,results.size());
  long ts1=results.get(0).getTimestamp();
  long ts2=results.get(1).getTimestamp();
  Assert.assertTrue(ts1 > ts2);
  Assert.assertEquals(newValue,Bytes.toLong(CellUtil.cloneValue(results.get(0))));
  Assert.assertEquals(oldValue,Bytes.toLong(CellUtil.cloneValue(results.get(1))));
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleErrorsInFlush() throws Exception {
  LOG.info("Setting up a faulty file system that cannot write");
  final Configuration conf=HBaseConfiguration.create();
  User user=User.createUserForTesting(conf,"testhandleerrorsinflush",new String[]{"foo"});
  conf.setClass("fs.file.impl",FaultyFileSystem.class,FileSystem.class);
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      FileSystem fs=FileSystem.get(conf);
      Assert.assertEquals(FaultyFileSystem.class,fs.getClass());
      init(name.getMethodName(),conf);
      LOG.info("Adding some data");
      store.add(new KeyValue(row,family,qf1,1,(byte[])null));
      store.add(new KeyValue(row,family,qf2,1,(byte[])null));
      store.add(new KeyValue(row,family,qf3,1,(byte[])null));
      LOG.info("Before flush, we should have no files");
      Collection<StoreFileInfo> files=store.getRegionFileSystem().getStoreFiles(store.getColumnFamilyName());
      Assert.assertEquals(0,files != null ? files.size() : 0);
      try {
        LOG.info("Flushing");
        flush(1);
        Assert.fail("Didn't bubble up IOE!");
      }
 catch (      IOException ioe) {
        Assert.assertTrue(ioe.getMessage().contains("Fault injected"));
      }
      LOG.info("After failed flush, we should still have no files!");
      files=store.getRegionFileSystem().getStoreFiles(store.getColumnFamilyName());
      Assert.assertEquals(0,files != null ? files.size() : 0);
      store.getHRegion().getWAL().close();
      return null;
    }
  }
);
  FileSystem.closeAllForUGI(user.getUGI());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncrementColumnValue_SnapshotFlushCombo() throws Exception {
  ManualEnvironmentEdge mee=new ManualEnvironmentEdge();
  EnvironmentEdgeManagerTestHelper.injectEdge(mee);
  init(this.name.getMethodName());
  long oldValue=1L;
  long newValue=3L;
  this.store.add(new KeyValue(row,family,qf1,EnvironmentEdgeManager.currentTime(),Bytes.toBytes(oldValue)));
  this.store.snapshot();
  long ret=this.store.updateColumnValue(row,family,qf1,newValue);
  Assert.assertTrue(ret > 0);
  flushStore(store,id++);
  Assert.assertEquals(1,this.store.getStorefiles().size());
  Assert.assertEquals(1,((DefaultMemStore)this.store.memstore).cellSet.size());
  newValue+=1;
  this.store.updateColumnValue(row,family,qf1,newValue);
  newValue+=1;
  this.store.updateColumnValue(row,family,qf1,newValue);
  Get get=new Get(row);
  get.addColumn(family,qf1);
  get.setMaxVersions();
  List<Cell> results=new ArrayList<Cell>();
  results=HBaseTestingUtility.getFromStoreFile(store,get);
  Assert.assertEquals(2,results.size());
  long ts1=results.get(0).getTimestamp();
  long ts2=results.get(1).getTimestamp();
  Assert.assertTrue(ts1 > ts2);
  Assert.assertEquals(newValue,Bytes.toLong(CellUtil.cloneValue(results.get(0))));
  Assert.assertEquals(oldValue,Bytes.toLong(CellUtil.cloneValue(results.get(1))));
  mee.setValue(2);
  newValue+=1;
  this.store.updateColumnValue(row,family,qf1,newValue);
  results=HBaseTestingUtility.getFromStoreFile(store,get);
  Assert.assertEquals(2,results.size());
  ts1=results.get(0).getTimestamp();
  ts2=results.get(1).getTimestamp();
  Assert.assertTrue(ts1 > ts2);
  Assert.assertEquals(newValue,Bytes.toLong(CellUtil.cloneValue(results.get(0))));
  Assert.assertEquals(oldValue,Bytes.toLong(CellUtil.cloneValue(results.get(1))));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testICV_negMemstoreSize() throws IOException {
  init(this.name.getMethodName());
  long time=100;
  ManualEnvironmentEdge ee=new ManualEnvironmentEdge();
  ee.setValue(time);
  EnvironmentEdgeManagerTestHelper.injectEdge(ee);
  long newValue=3L;
  long size=0;
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091000"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091200"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091300"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091400"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  size+=this.store.add(new KeyValue(Bytes.toBytes("200909091500"),family,qf1,System.currentTimeMillis(),Bytes.toBytes(newValue)));
  for (int i=0; i < 10000; ++i) {
    newValue++;
    long ret=this.store.updateColumnValue(row,family,qf1,newValue);
    long ret2=this.store.updateColumnValue(row2,family,qf1,newValue);
    if (ret != 0)     System.out.println("ret: " + ret);
    if (ret2 != 0)     System.out.println("ret2: " + ret2);
    Assert.assertTrue("ret: " + ret,ret >= 0);
    size+=ret;
    Assert.assertTrue("ret2: " + ret2,ret2 >= 0);
    size+=ret2;
    if (i % 1000 == 0)     ee.setValue(++time);
  }
  long computedSize=0;
  for (  Cell cell : ((DefaultMemStore)this.store.memstore).cellSet) {
    long kvsize=DefaultMemStore.heapSizeChange(cell,true);
    computedSize+=kvsize;
  }
  Assert.assertEquals(computedSize,size);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test we do not lose data if we fail a flush and then close.
 * Part of HBase-10466
 * @throws Exception
 */
@Test public void testFlushSizeAccounting() throws Exception {
  LOG.info("Setting up a faulty file system that cannot write in " + this.name.getMethodName());
  final Configuration conf=HBaseConfiguration.create();
  conf.setInt("hbase.hstore.flush.retries.number",1);
  User user=User.createUserForTesting(conf,this.name.getMethodName(),new String[]{"foo"});
  conf.setClass("fs.file.impl",FaultyFileSystem.class,FileSystem.class);
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      FileSystem fs=FileSystem.get(conf);
      Assert.assertEquals(FaultyFileSystem.class,fs.getClass());
      FaultyFileSystem ffs=(FaultyFileSystem)fs;
      init(name.getMethodName(),conf);
      long size=store.memstore.getFlushableSize();
      Assert.assertEquals(0,size);
      LOG.info("Adding some data");
      long kvSize=store.add(new KeyValue(row,family,qf1,1,(byte[])null));
      size=store.memstore.getFlushableSize();
      Assert.assertEquals(kvSize,size);
      try {
        LOG.info("Flushing");
        flushStore(store,id++);
        Assert.fail("Didn't bubble up IOE!");
      }
 catch (      IOException ioe) {
        Assert.assertTrue(ioe.getMessage().contains("Fault injected"));
      }
      size=store.memstore.getFlushableSize();
      Assert.assertEquals(kvSize,size);
      store.add(new KeyValue(row,family,qf2,2,(byte[])null));
      Assert.assertEquals(kvSize,size);
      ffs.fault.set(false);
      flushStore(store,id++);
      size=store.memstore.getFlushableSize();
      Assert.assertEquals(kvSize,size);
      flushStore(store,id++);
      size=store.memstore.getFlushableSize();
      Assert.assertEquals(0,size);
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStoreFile </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates an hfile and then the dir structures and files to verify that references
 * to hfilelinks (created by snapshot clones) can be properly interpreted.
 */
@Test public void testReferenceToHFileLink() throws IOException {
  Configuration testConf=new Configuration(this.conf);
  FSUtils.setRootDir(testConf,testDir);
  HRegionInfo hri=new HRegionInfo(TableName.valueOf("_original-evil-name"));
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(testConf,fs,FSUtils.getTableDir(testDir,hri.getTable()),hri);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(testConf,cacheConf,this.fs).withFilePath(regionFs.createTempName()).withFileContext(meta).build();
  writeStoreFile(writer);
  Path storeFilePath=regionFs.commitStoreFile(TEST_FAMILY,writer.getPath());
  HRegionInfo hriClone=new HRegionInfo(TableName.valueOf("clone"));
  HRegionFileSystem cloneRegionFs=HRegionFileSystem.createRegionOnFileSystem(testConf,fs,FSUtils.getTableDir(testDir,hri.getTable()),hriClone);
  Path dstPath=cloneRegionFs.getStoreDir(TEST_FAMILY);
  HFileLink.create(testConf,this.fs,dstPath,hri,storeFilePath.getName());
  Path linkFilePath=new Path(dstPath,HFileLink.createHFileLinkName(hri,storeFilePath.getName()));
  HRegionInfo splitHriA=new HRegionInfo(hri.getTable(),null,SPLITKEY);
  HRegionInfo splitHriB=new HRegionInfo(hri.getTable(),SPLITKEY,null);
  StoreFile f=new StoreFile(fs,linkFilePath,testConf,cacheConf,BloomType.NONE);
  f.createReader();
  Path pathA=splitStoreFile(cloneRegionFs,splitHriA,TEST_FAMILY,f,SPLITKEY,true);
  Path pathB=splitStoreFile(cloneRegionFs,splitHriB,TEST_FAMILY,f,SPLITKEY,false);
  f.closeReader(true);
  FSUtils.logFileSystemState(fs,testDir,LOG);
  StoreFile hsfA=new StoreFile(this.fs,pathA,testConf,cacheConf,BloomType.NONE);
  int count=1;
  HFileScanner s=hsfA.createReader().getScanner(false,false);
  s.seekTo();
  while (s.next()) {
    count++;
  }
  assertTrue(count > 0);
  StoreFile hsfB=new StoreFile(this.fs,pathB,testConf,cacheConf,BloomType.NONE);
  HFileScanner sB=hsfB.createReader().getScanner(false,false);
  sB.seekTo();
  count++;
  while (sB.next()) {
    count++;
  }
  assertEquals((LAST_CHAR - FIRST_CHAR + 1) * (LAST_CHAR - FIRST_CHAR + 1),count);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHFileLink() throws IOException {
  final HRegionInfo hri=new HRegionInfo(TableName.valueOf("testHFileLinkTb"));
  Configuration testConf=new Configuration(this.conf);
  FSUtils.setRootDir(testConf,testDir);
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(testConf,fs,FSUtils.getTableDir(testDir,hri.getTable()),hri);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(regionFs.createTempName()).withFileContext(meta).build();
  writeStoreFile(writer);
  Path storeFilePath=regionFs.commitStoreFile(TEST_FAMILY,writer.getPath());
  Path dstPath=new Path(regionFs.getTableDir(),new Path("test-region",TEST_FAMILY));
  HFileLink.create(testConf,this.fs,dstPath,hri,storeFilePath.getName());
  Path linkFilePath=new Path(dstPath,HFileLink.createHFileLinkName(hri,storeFilePath.getName()));
  StoreFileInfo storeFileInfo=new StoreFileInfo(testConf,this.fs,linkFilePath);
  StoreFile hsf=new StoreFile(this.fs,storeFileInfo,testConf,cacheConf,BloomType.NONE);
  assertTrue(storeFileInfo.isLink());
  int count=1;
  HFileScanner s=hsf.createReader().getScanner(false,false);
  s.seekTo();
  while (s.next()) {
    count++;
  }
  assertEquals((LAST_CHAR - FIRST_CHAR + 1) * (LAST_CHAR - FIRST_CHAR + 1),count);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomTypes() throws Exception {
  float err=(float)0.01;
  FileSystem fs=FileSystem.getLocal(conf);
  conf.setFloat(BloomFilterFactory.IO_STOREFILE_BLOOM_ERROR_RATE,err);
  conf.setBoolean(BloomFilterFactory.IO_STOREFILE_BLOOM_ENABLED,true);
  int rowCount=50;
  int colCount=10;
  int versions=2;
  BloomType[] bt={BloomType.ROWCOL,BloomType.ROW};
  int[] expKeys={rowCount * colCount,rowCount};
  float[] expErr={2 * rowCount * colCount* err,2 * rowCount * 2* colCount* err};
  for (  int x : new int[]{0,1}) {
    Path f=new Path(ROOT_DIR,getName() + x);
    HFileContext meta=new HFileContextBuilder().withBlockSize(BLOCKSIZE_SMALL).withChecksumType(CKTYPE).withBytesPerCheckSum(CKBYTES).build();
    StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(f).withBloomType(bt[x]).withMaxKeyCount(expKeys[x]).withFileContext(meta).build();
    long now=System.currentTimeMillis();
    for (int i=0; i < rowCount * 2; i+=2) {
      for (int j=0; j < colCount * 2; j+=2) {
        String row=String.format(localFormatter,i);
        String col=String.format(localFormatter,j);
        for (int k=0; k < versions; ++k) {
          KeyValue kv=new KeyValue(row.getBytes(),"family".getBytes(),("col" + col).getBytes(),now - k,Bytes.toBytes((long)-1));
          writer.append(kv);
        }
      }
    }
    writer.close();
    StoreFile.Reader reader=new StoreFile.Reader(fs,f,cacheConf,conf);
    reader.loadFileInfo();
    reader.loadBloomfilter();
    StoreFileScanner scanner=reader.getStoreFileScanner(false,false);
    assertEquals(expKeys[x],reader.generalBloomFilter.getKeyCount());
    Store store=mock(Store.class);
    HColumnDescriptor hcd=mock(HColumnDescriptor.class);
    when(hcd.getName()).thenReturn(Bytes.toBytes("family"));
    when(store.getFamily()).thenReturn(hcd);
    int falsePos=0;
    int falseNeg=0;
    for (int i=0; i < rowCount * 2; ++i) {
      for (int j=0; j < colCount * 2; ++j) {
        String row=String.format(localFormatter,i);
        String col=String.format(localFormatter,j);
        TreeSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
        columns.add(("col" + col).getBytes());
        Scan scan=new Scan(row.getBytes(),row.getBytes());
        scan.addColumn("family".getBytes(),("col" + col).getBytes());
        boolean exists=scanner.shouldUseScanner(scan,store,Long.MIN_VALUE);
        boolean shouldRowExist=i % 2 == 0;
        boolean shouldColExist=j % 2 == 0;
        shouldColExist=shouldColExist || bt[x] == BloomType.ROW;
        if (shouldRowExist && shouldColExist) {
          if (!exists)           falseNeg++;
        }
 else {
          if (exists)           falsePos++;
        }
      }
    }
    reader.close(true);
    fs.delete(f,true);
    System.out.println(bt[x].toString());
    System.out.println("  False negatives: " + falseNeg);
    System.out.println("  False positives: " + falsePos);
    assertEquals(0,falseNeg);
    assertTrue(falsePos < 2 * expErr[x]);
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheOnWriteEvictOnClose() throws Exception {
  Configuration conf=this.conf;
  Path baseDir=new Path(new Path(testDir,"7e0102"),"twoCOWEOC");
  BlockCache bc=new CacheConfig(conf).getBlockCache();
  assertNotNull(bc);
  CacheStats cs=bc.getStats();
  long startHit=cs.getHitCount();
  long startMiss=cs.getMissCount();
  long startEvicted=cs.getEvictedCount();
  conf.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,false);
  CacheConfig cacheConf=new CacheConfig(conf);
  Path pathCowOff=new Path(baseDir,"123456789");
  StoreFile.Writer writer=writeStoreFile(conf,cacheConf,pathCowOff,3);
  StoreFile hsf=new StoreFile(this.fs,writer.getPath(),conf,cacheConf,BloomType.NONE);
  LOG.debug(hsf.getPath().toString());
  StoreFile.Reader reader=hsf.createReader();
  reader.loadFileInfo();
  StoreFileScanner scanner=reader.getStoreFileScanner(true,true);
  scanner.seek(KeyValue.LOWESTKEY);
  while (scanner.next() != null)   ;
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss + 3,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startMiss+=3;
  scanner.close();
  reader.close(cacheConf.shouldEvictOnClose());
  conf.setBoolean(CacheConfig.CACHE_BLOCKS_ON_WRITE_KEY,true);
  cacheConf=new CacheConfig(conf);
  Path pathCowOn=new Path(baseDir,"123456788");
  writer=writeStoreFile(conf,cacheConf,pathCowOn,3);
  hsf=new StoreFile(this.fs,writer.getPath(),conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  scanner=reader.getStoreFileScanner(true,true);
  scanner.seek(KeyValue.LOWESTKEY);
  while (scanner.next() != null)   ;
  assertEquals(startHit + 3,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startHit+=3;
  scanner.close();
  reader.close(cacheConf.shouldEvictOnClose());
  hsf=new StoreFile(this.fs,pathCowOff,conf,cacheConf,BloomType.NONE);
  StoreFile.Reader readerOne=hsf.createReader();
  readerOne.loadFileInfo();
  StoreFileScanner scannerOne=readerOne.getStoreFileScanner(true,true);
  scannerOne.seek(KeyValue.LOWESTKEY);
  hsf=new StoreFile(this.fs,pathCowOn,conf,cacheConf,BloomType.NONE);
  StoreFile.Reader readerTwo=hsf.createReader();
  readerTwo.loadFileInfo();
  StoreFileScanner scannerTwo=readerTwo.getStoreFileScanner(true,true);
  scannerTwo.seek(KeyValue.LOWESTKEY);
  Cell kv1=null;
  Cell kv2=null;
  while ((kv1=scannerOne.next()) != null) {
    kv2=scannerTwo.next();
    assertTrue(kv1.equals(kv2));
    KeyValue keyv1=KeyValueUtil.ensureKeyValue(kv1);
    KeyValue keyv2=KeyValueUtil.ensureKeyValue(kv2);
    assertTrue(Bytes.compareTo(keyv1.getBuffer(),keyv1.getKeyOffset(),keyv1.getKeyLength(),keyv2.getBuffer(),keyv2.getKeyOffset(),keyv2.getKeyLength()) == 0);
    assertTrue(Bytes.compareTo(kv1.getValueArray(),kv1.getValueOffset(),kv1.getValueLength(),kv2.getValueArray(),kv2.getValueOffset(),kv2.getValueLength()) == 0);
  }
  assertNull(scannerTwo.next());
  assertEquals(startHit + 6,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
  startHit+=6;
  scannerOne.close();
  readerOne.close(cacheConf.shouldEvictOnClose());
  scannerTwo.close();
  readerTwo.close(cacheConf.shouldEvictOnClose());
  conf.setBoolean("hbase.rs.evictblocksonclose",true);
  cacheConf=new CacheConfig(conf);
  hsf=new StoreFile(this.fs,pathCowOff,conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  reader.close(cacheConf.shouldEvictOnClose());
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted + 3,cs.getEvictedCount());
  startEvicted+=3;
  conf.setBoolean("hbase.rs.evictblocksonclose",false);
  cacheConf=new CacheConfig(conf);
  hsf=new StoreFile(this.fs,pathCowOn,conf,cacheConf,BloomType.NONE);
  reader=hsf.createReader();
  reader.close(cacheConf.shouldEvictOnClose());
  assertEquals(startHit,cs.getHitCount());
  assertEquals(startMiss,cs.getMissCount());
  assertEquals(startEvicted,cs.getEvictedCount());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilyBloomFilter() throws Exception {
  FileSystem fs=FileSystem.getLocal(conf);
  conf.setFloat(BloomFilterFactory.IO_STOREFILE_BLOOM_ERROR_RATE,(float)0.01);
  conf.setBoolean(BloomFilterFactory.IO_STOREFILE_BLOOM_ENABLED,true);
  float err=conf.getFloat(BloomFilterFactory.IO_STOREFILE_BLOOM_ERROR_RATE,0);
  Path f=new Path(ROOT_DIR,getName());
  HFileContext meta=new HFileContextBuilder().withBlockSize(BLOCKSIZE_SMALL).withChecksumType(CKTYPE).withBytesPerCheckSum(CKBYTES).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(f).withMaxKeyCount(2000).withFileContext(meta).build();
  long now=System.currentTimeMillis();
  for (int i=0; i < 2000; i+=2) {
    String row=String.format(localFormatter,i);
    KeyValue kv=new KeyValue(row.getBytes(),"family".getBytes(),"col".getBytes(),now,KeyValue.Type.DeleteFamily,"value".getBytes());
    writer.append(kv);
  }
  writer.close();
  StoreFile.Reader reader=new StoreFile.Reader(fs,f,cacheConf,conf);
  reader.loadFileInfo();
  reader.loadBloomfilter();
  int falsePos=0;
  int falseNeg=0;
  for (int i=0; i < 2000; i++) {
    String row=String.format(localFormatter,i);
    byte[] rowKey=Bytes.toBytes(row);
    boolean exists=reader.passesDeleteFamilyBloomFilter(rowKey,0,rowKey.length);
    if (i % 2 == 0) {
      if (!exists)       falseNeg++;
    }
 else {
      if (exists)       falsePos++;
    }
  }
  assertEquals(1000,reader.getDeleteFamilyCnt());
  reader.close(true);
  fs.delete(f,true);
  assertEquals("False negatives: " + falseNeg,0,falseNeg);
  int maxFalsePos=(int)(2 * 2000 * err);
  assertTrue("Too many false positives: " + falsePos + " (err="+ err+ ", expected no more than "+ maxFalsePos,falsePos <= maxFalsePos);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStoreFileScannerWithTagCompression </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReseek() throws Exception {
  Path f=new Path(ROOT_DIR,"testReseek");
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).withIncludesTags(true).withCompressTags(true).withDataBlockEncoding(DataBlockEncoding.PREFIX).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,fs).withFilePath(f).withFileContext(meta).build();
  writeStoreFile(writer);
  writer.close();
  StoreFile.Reader reader=new StoreFile.Reader(fs,f,cacheConf,conf);
  StoreFileScanner s=reader.getStoreFileScanner(false,false);
  try {
    KeyValue k=KeyValueUtil.createFirstOnRow(Bytes.toBytes("k2"));
    s.reseek(k);
    Cell kv=s.next();
    kv=s.next();
    kv=s.next();
    byte[] key5=Bytes.toBytes("k5");
    assertTrue(Bytes.equals(key5,0,key5.length,kv.getRowArray(),kv.getRowOffset(),kv.getRowLength()));
    List<Tag> tags=KeyValueUtil.ensureKeyValue(kv).getTags();
    assertEquals(1,tags.size());
    assertEquals("tag3",Bytes.toString(TagUtil.cloneValue(tags.get(0))));
  }
  finally {
    s.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStripeStoreEngine </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionContextForceSelect() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  int targetCount=2;
  conf.setInt(StripeStoreConfig.INITIAL_STRIPE_COUNT_KEY,targetCount);
  conf.setInt(StripeStoreConfig.MIN_FILES_L0_KEY,2);
  conf.set(StoreEngine.STORE_ENGINE_CLASS_KEY,TestStoreEngine.class.getName());
  TestStoreEngine se=createEngine(conf);
  StripeCompactor mockCompactor=mock(StripeCompactor.class);
  se.setCompactorOverride(mockCompactor);
  when(mockCompactor.compact(any(CompactionRequest.class),anyInt(),anyLong(),any(byte[].class),any(byte[].class),any(byte[].class),any(byte[].class),any(ThroughputController.class),any(User.class))).thenReturn(new ArrayList<Path>());
  StoreFile sf=createFile();
  ArrayList<StoreFile> compactUs=al(sf,createFile(),createFile());
  se.getStoreFileManager().loadFiles(compactUs);
  CompactionContext compaction=se.createCompaction();
  compaction.select(al(),false,false,false);
  assertEquals(3,compaction.getRequest().getFiles().size());
  compactUs.remove(sf);
  CompactionRequest req=new CompactionRequest(compactUs);
  compaction.forceSelect(req);
  assertEquals(2,compaction.getRequest().getFiles().size());
  assertFalse(compaction.getRequest().getFiles().contains(sf));
  compaction.compact(NoLimitThroughputController.INSTANCE);
  verify(mockCompactor,times(1)).compact(compaction.getRequest(),targetCount,0L,StripeStoreFileManager.OPEN_KEY,StripeStoreFileManager.OPEN_KEY,null,null,NoLimitThroughputController.INSTANCE,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStripeStoreFileManager </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowKeyBefore() throws Exception {
  StripeStoreFileManager manager=createManager();
  StoreFile l0File=createFile(), l0File2=createFile();
  manager.insertNewFiles(al(l0File));
  manager.insertNewFiles(al(l0File2));
  Iterator<StoreFile> sfs=manager.getCandidateFilesForRowKeyBefore(KV_B);
  sfs.next();
  sfs.remove();
  sfs=manager.updateCandidateFilesForRowKeyBefore(sfs,KV_B,KV_A);
  assertTrue(sfs.hasNext());
  MockStoreFile stripe0a=createFile(0,100,OPEN_KEY,KEY_B), stripe1=createFile(KEY_B,OPEN_KEY);
  manager.addCompactionResults(al(l0File),al(stripe0a,stripe1));
  manager.removeCompactedFiles(al(l0File));
  ArrayList<StoreFile> sfsDump=dumpIterator(manager.getCandidateFilesForRowKeyBefore(KV_A));
  assertEquals(2,sfsDump.size());
  assertTrue(sfsDump.contains(stripe0a));
  assertFalse(sfsDump.contains(stripe1));
  sfsDump=dumpIterator(manager.getCandidateFilesForRowKeyBefore(KV_B));
  assertEquals(3,sfsDump.size());
  assertTrue(sfsDump.contains(stripe1));
  sfsDump=dumpIterator(manager.getCandidateFilesForRowKeyBefore(KV_D));
  assertEquals(3,sfsDump.size());
  sfs=manager.getCandidateFilesForRowKeyBefore(KV_D);
  sfs.next();
  sfs.remove();
  sfs=manager.updateCandidateFilesForRowKeyBefore(sfs,KV_D,KV_C);
  assertEquals(stripe1,sfs.next());
  assertFalse(sfs.hasNext());
  StoreFile stripe0b=createFile(0,101,OPEN_KEY,KEY_B);
  manager.addCompactionResults(al(l0File2),al(stripe0b));
  manager.removeCompactedFiles(al(l0File2));
  sfs=manager.getCandidateFilesForRowKeyBefore(KV_A);
  assertEquals(stripe0b,sfs.next());
  sfs.remove();
  sfs=manager.updateCandidateFilesForRowKeyBefore(sfs,KV_A,KV_A);
  assertEquals(stripe0a,sfs.next());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testLoadFilesWithRecoverableBadFiles() throws Exception {
  ArrayList<StoreFile> validStripeFiles=al(createFile(OPEN_KEY,KEY_B),createFile(KEY_B,KEY_C),createFile(KEY_C,OPEN_KEY),createFile(KEY_C,OPEN_KEY));
  ArrayList<StoreFile> filesToGoToL0=al(createFile(),createFile(null,KEY_A),createFile(KEY_D,null),createFile(KEY_D,KEY_A),createFile(keyAfter(KEY_A),KEY_C),createFile(OPEN_KEY,KEY_D),createFile(KEY_D,keyAfter(KEY_D)));
  ArrayList<StoreFile> allFilesToGo=flattenLists(validStripeFiles,filesToGoToL0);
  Collections.shuffle(allFilesToGo);
  StripeStoreFileManager manager=createManager(allFilesToGo);
  List<StoreFile> l0Files=manager.getLevel0Files();
  assertEquals(filesToGoToL0.size(),l0Files.size());
  for (  StoreFile sf : filesToGoToL0) {
    assertTrue(l0Files.contains(sf));
  }
  verifyAllFiles(manager,allFilesToGo);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSplitPointEdgeCases() throws Exception {
  StripeStoreFileManager manager=createManager();
  assertNull(manager.getSplitPoint());
  MockStoreFile sf5=createFile(5,0);
  sf5.splitPoint=new byte[1];
  manager.insertNewFiles(al(sf5));
  manager.insertNewFiles(al(createFile(1,0)));
  assertEquals(sf5.splitPoint,manager.getSplitPoint());
  manager.addCompactionResults(al(),al(createFile(2,0,OPEN_KEY,OPEN_KEY)));
  assertEquals(sf5.splitPoint,manager.getSplitPoint());
  MockStoreFile sf6=createFile(6,0,OPEN_KEY,OPEN_KEY);
  sf6.splitPoint=new byte[1];
  manager.addCompactionResults(al(),al(sf6));
  assertEquals(sf6.splitPoint,manager.getSplitPoint());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertFilesIntoL0() throws Exception {
  StripeStoreFileManager manager=createManager();
  MockStoreFile sf=createFile();
  manager.insertNewFiles(al(sf));
  assertEquals(1,manager.getStorefileCount());
  Collection<StoreFile> filesForGet=manager.getFilesForScanOrGet(true,KEY_A,KEY_A);
  assertEquals(1,filesForGet.size());
  assertTrue(filesForGet.contains(sf));
  manager.addCompactionResults(al(),al(createFile(OPEN_KEY,KEY_B),createFile(KEY_B,OPEN_KEY)));
  assertTrue(manager.getFilesForScanOrGet(true,KEY_A,KEY_A).contains(sf));
  assertTrue(manager.getFilesForScanOrGet(true,KEY_C,KEY_C).contains(sf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestTags </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTagsWithAppendAndIncrement() throws Exception {
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  byte[] f=Bytes.toBytes("f");
  byte[] q=Bytes.toBytes("q");
  byte[] row1=Bytes.toBytes("r1");
  byte[] row2=Bytes.toBytes("r2");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  HColumnDescriptor colDesc=new HColumnDescriptor(f);
  desc.addFamily(colDesc);
  TEST_UTIL.getHBaseAdmin().createTable(desc);
  Table table=null;
  try {
    table=TEST_UTIL.getConnection().getTable(tableName);
    Put put=new Put(row1);
    byte[] v=Bytes.toBytes(2L);
    put.addColumn(f,q,v);
    put.setAttribute("visibility",Bytes.toBytes("tag1"));
    table.put(put);
    Increment increment=new Increment(row1);
    increment.addColumn(f,q,1L);
    table.increment(increment);
    TestCoprocessorForTags.checkTagPresence=true;
    ResultScanner scanner=table.getScanner(new Scan());
    Result result=scanner.next();
    KeyValue kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    List<Tag> tags=TestCoprocessorForTags.tags;
    assertEquals(3L,Bytes.toLong(kv.getValueArray(),kv.getValueOffset(),kv.getValueLength()));
    assertEquals(1,tags.size());
    assertEquals("tag1",Bytes.toString(TagUtil.cloneValue(tags.get(0))));
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    increment=new Increment(row1);
    increment.add(new KeyValue(row1,f,q,1234L,v));
    increment.setAttribute("visibility",Bytes.toBytes("tag2"));
    table.increment(increment);
    TestCoprocessorForTags.checkTagPresence=true;
    scanner=table.getScanner(new Scan());
    result=scanner.next();
    kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    tags=TestCoprocessorForTags.tags;
    assertEquals(5L,Bytes.toLong(kv.getValueArray(),kv.getValueOffset(),kv.getValueLength()));
    assertEquals(2,tags.size());
    List<String> tagValues=new ArrayList<String>();
    for (    Tag tag : tags) {
      tagValues.add(Bytes.toString(TagUtil.cloneValue(tag)));
    }
    assertTrue(tagValues.contains("tag1"));
    assertTrue(tagValues.contains("tag2"));
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    put=new Put(row2);
    v=Bytes.toBytes(2L);
    put.addColumn(f,q,v);
    table.put(put);
    increment=new Increment(row2);
    increment.add(new KeyValue(row2,f,q,1234L,v));
    increment.setAttribute("visibility",Bytes.toBytes("tag2"));
    table.increment(increment);
    Scan scan=new Scan();
    scan.setStartRow(row2);
    TestCoprocessorForTags.checkTagPresence=true;
    scanner=table.getScanner(scan);
    result=scanner.next();
    kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    tags=TestCoprocessorForTags.tags;
    assertEquals(4L,Bytes.toLong(kv.getValueArray(),kv.getValueOffset(),kv.getValueLength()));
    assertEquals(1,tags.size());
    assertEquals("tag2",Bytes.toString(TagUtil.cloneValue(tags.get(0))));
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    byte[] row3=Bytes.toBytes("r3");
    put=new Put(row3);
    put.addColumn(f,q,Bytes.toBytes("a"));
    put.setAttribute("visibility",Bytes.toBytes("tag1"));
    table.put(put);
    Append append=new Append(row3);
    append.add(f,q,Bytes.toBytes("b"));
    table.append(append);
    scan=new Scan();
    scan.setStartRow(row3);
    TestCoprocessorForTags.checkTagPresence=true;
    scanner=table.getScanner(scan);
    result=scanner.next();
    kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    tags=TestCoprocessorForTags.tags;
    assertEquals(1,tags.size());
    assertEquals("tag1",Bytes.toString(TagUtil.cloneValue(tags.get(0))));
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    append=new Append(row3);
    append.add(new KeyValue(row3,f,q,1234L,v));
    append.setAttribute("visibility",Bytes.toBytes("tag2"));
    table.append(append);
    TestCoprocessorForTags.checkTagPresence=true;
    scanner=table.getScanner(scan);
    result=scanner.next();
    kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    tags=TestCoprocessorForTags.tags;
    assertEquals(2,tags.size());
    tagValues.clear();
    for (    Tag tag : tags) {
      tagValues.add(Bytes.toString(TagUtil.cloneValue(tag)));
    }
    assertTrue(tagValues.contains("tag1"));
    assertTrue(tagValues.contains("tag2"));
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    byte[] row4=Bytes.toBytes("r4");
    put=new Put(row4);
    put.addColumn(f,q,Bytes.toBytes("a"));
    table.put(put);
    append=new Append(row4);
    append.add(new KeyValue(row4,f,q,1234L,v));
    append.setAttribute("visibility",Bytes.toBytes("tag2"));
    table.append(append);
    scan=new Scan();
    scan.setStartRow(row4);
    TestCoprocessorForTags.checkTagPresence=true;
    scanner=table.getScanner(scan);
    result=scanner.next();
    kv=KeyValueUtil.ensureKeyValue(result.getColumnLatestCell(f,q));
    tags=TestCoprocessorForTags.tags;
    assertEquals(1,tags.size());
    assertEquals("tag2",Bytes.toString(TagUtil.cloneValue(tags.get(0))));
  }
  finally {
    TestCoprocessorForTags.checkTagPresence=false;
    TestCoprocessorForTags.tags=null;
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestWideScanner </h4><pre class="type-4 type-9 type-10 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWideScanBatching() throws IOException {
  final int batch=256;
  try {
    this.r=createNewHRegion(TESTTABLEDESC,null,null);
    int inserted=addWideContent(this.r);
    List<Cell> results=new ArrayList<Cell>();
    Scan scan=new Scan();
    scan.addFamily(A);
    scan.addFamily(B);
    scan.addFamily(C);
    scan.setMaxVersions(100);
    scan.setBatch(batch);
    InternalScanner s=r.getScanner(scan);
    int total=0;
    int i=0;
    boolean more;
    do {
      more=s.next(results);
      i++;
      LOG.info("iteration #" + i + ", results.size="+ results.size());
      assertTrue(results.size() <= batch);
      total+=results.size();
      if (results.size() > 0) {
        byte[] row=CellUtil.cloneRow(results.get(0));
        for (        Cell kv : results) {
          assertTrue(Bytes.equals(row,CellUtil.cloneRow(kv)));
        }
      }
      results.clear();
      Iterator<KeyValueScanner> scanners=((HRegion.RegionScannerImpl)s).storeHeap.getHeap().iterator();
      while (scanners.hasNext()) {
        StoreScanner ss=(StoreScanner)scanners.next();
        ss.updateReaders(new ArrayList<StoreFile>());
      }
    }
 while (more);
    LOG.info("inserted " + inserted + ", scanned "+ total);
    assertEquals(total,inserted);
    s.close();
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.r);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.compactions.TestCompactedHFilesDischarger </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCleanerWithParallelScannersAfterCompaction() throws Exception {
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(1000,(Stoppable)null,rss,false);
  for (int i=1; i < 10; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=11; i < 20; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=21; i < 30; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  Store store=region.getStore(fam);
  assertEquals(3,store.getStorefilesCount());
  Collection<StoreFile> storefiles=store.getStorefiles();
  Collection<StoreFile> compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  region.compact(true);
  startScannerThreads();
  storefiles=store.getStorefiles();
  int usedReaderCount=0;
  int unusedReaderCount=0;
  for (  StoreFile file : storefiles) {
    if (file.getRefCount() == 3) {
      usedReaderCount++;
    }
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : compactedfiles) {
    assertEquals("Refcount should be 3",0,file.getRefCount());
    unusedReaderCount++;
  }
  assertEquals("unused reader count should be 3",3,unusedReaderCount);
  assertEquals("used reader count should be 1",1,usedReaderCount);
  cleaner.chore();
  countDown();
  assertEquals(1,store.getStorefilesCount());
  storefiles=store.getStorefiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  assertTrue(compactedfiles.size() == 0);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCleanerWithParallelScanners() throws Exception {
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(1000,(Stoppable)null,rss,false);
  for (int i=1; i < 10; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=11; i < 20; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=21; i < 30; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  Store store=region.getStore(fam);
  assertEquals(3,store.getStorefilesCount());
  Collection<StoreFile> storefiles=store.getStorefiles();
  Collection<StoreFile> compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  startScannerThreads();
  region.compact(true);
  storefiles=store.getStorefiles();
  int usedReaderCount=0;
  int unusedReaderCount=0;
  for (  StoreFile file : storefiles) {
    if (file.getRefCount() == 0) {
      unusedReaderCount++;
    }
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : compactedfiles) {
    assertEquals("Refcount should be 3",3,file.getRefCount());
    usedReaderCount++;
  }
  assertEquals("unused reader count should be 1",1,unusedReaderCount);
  assertEquals("used reader count should be 3",3,usedReaderCount);
  cleaner.chore();
  countDown();
  assertEquals(1,store.getStorefilesCount());
  assertEquals(3,((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles().size());
  while (scanCompletedCounter.get() != 3) {
    Thread.sleep(100);
  }
  latch=new CountDownLatch(3);
  scanCompletedCounter.set(0);
  counter.set(0);
  startScannerThreads();
  storefiles=store.getStorefiles();
  usedReaderCount=0;
  unusedReaderCount=0;
  for (  StoreFile file : storefiles) {
    if (file.getRefCount() == 3) {
      usedReaderCount++;
    }
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : compactedfiles) {
    assertEquals("Refcount should be 0",0,file.getRefCount());
    unusedReaderCount++;
  }
  assertEquals("unused reader count should be 3",3,unusedReaderCount);
  assertEquals("used reader count should be 1",1,usedReaderCount);
  countDown();
  while (scanCompletedCounter.get() != 3) {
    Thread.sleep(100);
  }
  cleaner.chore();
  assertEquals(1,store.getStorefilesCount());
  storefiles=store.getStorefiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  assertTrue(compactedfiles.size() == 0);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactedHFilesCleaner() throws Exception {
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(1000,(Stoppable)null,rss,false);
  for (int i=1; i < 10; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=11; i < 20; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  for (int i=21; i < 30; i++) {
    Put p=new Put(Bytes.toBytes("row" + i));
    p.addColumn(fam,qual1,val);
    region.put(p);
  }
  region.flush(true);
  Store store=region.getStore(fam);
  assertEquals(3,store.getStorefilesCount());
  Collection<StoreFile> storefiles=store.getStorefiles();
  Collection<StoreFile> compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  cleaner.chore();
  storefiles=store.getStorefiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  region.compact(true);
  assertEquals(1,store.getStorefilesCount());
  assertEquals(3,((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles().size());
  cleaner.chore();
  assertEquals(1,store.getStorefilesCount());
  storefiles=store.getStorefiles();
  for (  StoreFile file : storefiles) {
    assertFalse(file.isCompactedAway());
  }
  compactedfiles=((HStore)store).getStoreEngine().getStoreFileManager().getCompactedfiles();
  assertTrue(compactedfiles.size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.compactions.TestFIFOCompactionPolicy </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeExpiredFiles() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setInt(HStore.BLOCKING_STOREFILES_KEY,10000);
  TEST_UTIL.startMiniCluster(1);
  try {
    Store store=prepareData();
    assertEquals(10,store.getStorefilesCount());
    TEST_UTIL.getHBaseAdmin().majorCompact(tableName);
    while (store.getStorefilesCount() > 1) {
      Thread.sleep(100);
    }
    assertTrue(store.getStorefilesCount() == 1);
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.compactions.TestStripeCompactionPolicy </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleStripeCompaction() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.unset("hbase.hstore.compaction.min.size");
  conf.setFloat(CompactionConfiguration.HBASE_HSTORE_COMPACTION_RATIO_KEY,1.0F);
  conf.setInt(StripeStoreConfig.MIN_FILES_KEY,3);
  conf.setInt(StripeStoreConfig.MAX_FILES_KEY,4);
  conf.setLong(StripeStoreConfig.SIZE_TO_SPLIT_KEY,1000);
  StoreConfigInformation sci=mock(StoreConfigInformation.class);
  StripeStoreConfig ssc=new StripeStoreConfig(conf,sci);
  StripeCompactionPolicy policy=new StripeCompactionPolicy(conf,sci,ssc){
    @Override public StripeCompactionRequest selectCompaction(    StripeInformationProvider si,    List<StoreFile> filesCompacting,    boolean isOffpeak) throws IOException {
      if (!filesCompacting.isEmpty())       return null;
      return selectSingleStripeCompaction(si,false,false,isOffpeak);
    }
    @Override public boolean needsCompactions(    StripeInformationProvider si,    List<StoreFile> filesCompacting){
      if (!filesCompacting.isEmpty())       return false;
      return needsSingleStripeCompaction(si);
    }
  }
;
  StripeInformationProvider si=createStripesWithSizes(0,0,new Long[]{2L},new Long[]{3L,3L},new Long[]{5L,1L});
  verifyNoCompaction(policy,si);
  si=createStripesWithSizes(0,0,new Long[]{2L},new Long[]{3L,3L},new Long[]{5L,1L,1L});
  assertNull(policy.selectCompaction(si,al(),false));
  assertTrue(policy.needsCompactions(si,al()));
  si=createStripesWithSizes(0,0,new Long[]{2L},new Long[]{3L,3L},new Long[]{5L,4L,3L});
  verifySingleStripeCompaction(policy,si,2,null);
  si=createStripesWithSizes(0,0,new Long[]{3L,2L,2L},new Long[]{2L,2L,1L},new Long[]{3L,2L,2L,1L});
  verifySingleStripeCompaction(policy,si,2,null);
  si=createStripesWithSizes(0,0,new Long[]{5L},new Long[]{3L,2L,2L,1L},new Long[]{3L,2L,2L});
  verifySingleStripeCompaction(policy,si,1,null);
  si=createStripesWithSizes(0,0,new Long[]{3L,3L,3L},new Long[]{3L,1L,2L},new Long[]{3L,2L,2L});
  verifySingleStripeCompaction(policy,si,1,null);
  si=createStripesWithSizes(0,0,new Long[]{5L},new Long[]{5L,4L,4L,4L,4L});
  List<StoreFile> sfs=si.getStripes().get(1).subList(1,5);
  verifyCompaction(policy,si,sfs,null,1,null,si.getStartRow(1),si.getEndRow(1),true);
  si=createStripesWithSizes(0,0,new Long[]{5L},new Long[]{50L,4L,4L,4L,4L});
  sfs=si.getStripes().get(1).subList(1,5);
  verifyCompaction(policy,si,sfs,null,1,null,si.getStartRow(1),si.getEndRow(1),true);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithReferences() throws Exception {
  StripeCompactionPolicy policy=createPolicy(HBaseConfiguration.create());
  StripeCompactor sc=mock(StripeCompactor.class);
  StoreFile ref=createFile();
  when(ref.isReference()).thenReturn(true);
  StripeInformationProvider si=mock(StripeInformationProvider.class);
  Collection<StoreFile> sfs=al(ref,createFile());
  when(si.getStorefiles()).thenReturn(sfs);
  assertTrue(policy.needsCompactions(si,al()));
  StripeCompactionPolicy.StripeCompactionRequest scr=policy.selectCompaction(si,al(),false);
  assertEquals(si.getStorefiles(),scr.getRequest().getFiles());
  scr.execute(sc,NoLimitThroughputController.INSTANCE,null);
  verify(sc,only()).compact(eq(scr.getRequest()),anyInt(),anyLong(),aryEq(OPEN_KEY),aryEq(OPEN_KEY),aryEq(OPEN_KEY),aryEq(OPEN_KEY),any(NoLimitThroughputController.class),any(User.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.throttle.TestCompactionWithThroughputController </h4><pre class="type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the tuning task of {@link PressureAwareCompactionThroughputController}
 */
@Test public void testThroughputTuning() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(StoreEngine.STORE_ENGINE_CLASS_KEY,DefaultStoreEngine.class.getName());
  conf.setLong(PressureAwareCompactionThroughputController.HBASE_HSTORE_COMPACTION_MAX_THROUGHPUT_HIGHER_BOUND,20L * 1024 * 1024);
  conf.setLong(PressureAwareCompactionThroughputController.HBASE_HSTORE_COMPACTION_MAX_THROUGHPUT_LOWER_BOUND,10L * 1024 * 1024);
  conf.setInt(CompactionConfiguration.HBASE_HSTORE_COMPACTION_MIN_KEY,4);
  conf.setInt(HStore.BLOCKING_STOREFILES_KEY,6);
  conf.set(CompactionThroughputControllerFactory.HBASE_THROUGHPUT_CONTROLLER_KEY,PressureAwareCompactionThroughputController.class.getName());
  conf.setInt(PressureAwareCompactionThroughputController.HBASE_HSTORE_COMPACTION_THROUGHPUT_TUNE_PERIOD,1000);
  TEST_UTIL.startMiniCluster(1);
  Connection conn=ConnectionFactory.createConnection(conf);
  try {
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor(family));
    htd.setCompactionEnabled(false);
    TEST_UTIL.getHBaseAdmin().createTable(htd);
    TEST_UTIL.waitTableAvailable(tableName);
    HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(tableName);
    PressureAwareCompactionThroughputController throughputController=(PressureAwareCompactionThroughputController)regionServer.compactSplitThread.getCompactionThroughputController();
    assertEquals(10L * 1024 * 1024,throughputController.getMaxThroughput(),EPSILON);
    Table table=conn.getTable(tableName);
    for (int i=0; i < 5; i++) {
      byte[] value=new byte[0];
      table.put(new Put(Bytes.toBytes(i)).addColumn(family,qualifier,value));
      TEST_UTIL.flush(tableName);
    }
    Thread.sleep(2000);
    assertEquals(15L * 1024 * 1024,throughputController.getMaxThroughput(),EPSILON);
    byte[] value1=new byte[0];
    table.put(new Put(Bytes.toBytes(5)).addColumn(family,qualifier,value1));
    TEST_UTIL.flush(tableName);
    Thread.sleep(2000);
    assertEquals(20L * 1024 * 1024,throughputController.getMaxThroughput(),EPSILON);
    byte[] value=new byte[0];
    table.put(new Put(Bytes.toBytes(6)).addColumn(family,qualifier,value));
    TEST_UTIL.flush(tableName);
    Thread.sleep(2000);
    assertEquals(Double.MAX_VALUE,throughputController.getMaxThroughput(),EPSILON);
    conf.set(CompactionThroughputControllerFactory.HBASE_THROUGHPUT_CONTROLLER_KEY,NoLimitThroughputController.class.getName());
    regionServer.compactSplitThread.onConfigurationChange(conf);
    assertTrue(throughputController.isStopped());
    assertTrue(regionServer.compactSplitThread.getCompactionThroughputController() instanceof NoLimitThroughputController);
  }
  finally {
    conn.close();
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.throttle.TestFlushWithThroughputController </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the tuning task of {@link PressureAwareFlushThroughputController}
 */
@Test public void testFlushThroughputTuning() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.set(StoreEngine.STORE_ENGINE_CLASS_KEY,DefaultStoreEngine.class.getName());
  conf.setLong(PressureAwareFlushThroughputController.HBASE_HSTORE_FLUSH_MAX_THROUGHPUT_UPPER_BOUND,20L * 1024 * 1024);
  conf.setLong(PressureAwareFlushThroughputController.HBASE_HSTORE_FLUSH_MAX_THROUGHPUT_LOWER_BOUND,10L * 1024 * 1024);
  conf.set(FlushThroughputControllerFactory.HBASE_FLUSH_THROUGHPUT_CONTROLLER_KEY,PressureAwareFlushThroughputController.class.getName());
  conf.setInt(PressureAwareFlushThroughputController.HBASE_HSTORE_FLUSH_THROUGHPUT_TUNE_PERIOD,3000);
  TEST_UTIL.startMiniCluster(1);
  Connection conn=ConnectionFactory.createConnection(conf);
  try {
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor(family));
    htd.setCompactionEnabled(false);
    TEST_UTIL.getHBaseAdmin().createTable(htd);
    TEST_UTIL.waitTableAvailable(tableName);
    HRegionServer regionServer=TEST_UTIL.getRSForFirstRegionInTable(tableName);
    PressureAwareFlushThroughputController throughputController=(PressureAwareFlushThroughputController)regionServer.getFlushThroughputController();
    for (    Region region : regionServer.getOnlineRegions()) {
      region.flush(true);
    }
    assertEquals(0.0,regionServer.getFlushPressure(),EPSILON);
    Thread.sleep(5000);
    assertEquals(10L * 1024 * 1024,throughputController.getMaxThroughput(),EPSILON);
    Table table=conn.getTable(tableName);
    Random rand=new Random();
    for (int i=0; i < 10; i++) {
      for (int j=0; j < 10; j++) {
        byte[] value=new byte[256 * 1024];
        rand.nextBytes(value);
        table.put(new Put(Bytes.toBytes(i * 10 + j)).addColumn(family,qualifier,value));
      }
    }
    Thread.sleep(5000);
    double expectedThroughPut=10L * 1024 * 1024* (1 + regionServer.getFlushPressure());
    assertEquals(expectedThroughPut,throughputController.getMaxThroughput(),EPSILON);
    conf.set(FlushThroughputControllerFactory.HBASE_FLUSH_THROUGHPUT_CONTROLLER_KEY,NoLimitThroughputController.class.getName());
    regionServer.onConfigurationChange(conf);
    assertTrue(throughputController.isStopped());
    assertTrue(regionServer.getFlushThroughputController() instanceof NoLimitThroughputController);
  }
  finally {
    conn.close();
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestFSHLog </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test flush for sure has a sequence id that is beyond the last edit appended.  We do this
 * by slowing appends in the background ring buffer thread while in foreground we call
 * flush.  The addition of the sync over HRegion in flush should fix an issue where flush was
 * returning before all of its appends had made it out to the WAL (HBASE-11109).
 * @throws IOException
 * @see <a href="https://issues.apache.org/jira/browse/HBASE-11109">HBASE-11109</a>
 */
@Test public void testFlushSequenceIdIsGreaterThanAllEditsInHFile() throws IOException {
  String testName="testFlushSequenceIdIsGreaterThanAllEditsInHFile";
  final TableName tableName=TableName.valueOf(testName);
  final HRegionInfo hri=new HRegionInfo(tableName);
  final byte[] rowName=tableName.getName();
  final HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor("f"));
  HRegion r=HBaseTestingUtility.createRegionAndWAL(hri,TEST_UTIL.getDefaultRootDirPath(),TEST_UTIL.getConfiguration(),htd);
  HBaseTestingUtility.closeRegionAndWAL(r);
  final int countPerFamily=10;
  final MutableBoolean goslow=new MutableBoolean(false);
  FSHLog wal=new FSHLog(FileSystem.get(conf),TEST_UTIL.getDefaultRootDirPath(),testName,conf){
    @Override void atHeadOfRingBufferEventHandlerAppend(){
      if (goslow.isTrue()) {
        Threads.sleep(100);
        LOG.debug("Sleeping before appending 100ms");
      }
      super.atHeadOfRingBufferEventHandlerAppend();
    }
  }
;
  HRegion region=HRegion.openHRegion(TEST_UTIL.getConfiguration(),TEST_UTIL.getTestFileSystem(),TEST_UTIL.getDefaultRootDirPath(),hri,htd,wal);
  EnvironmentEdge ee=EnvironmentEdgeManager.getDelegate();
  try {
    List<Put> puts=null;
    for (    HColumnDescriptor hcd : htd.getFamilies()) {
      puts=TestWALReplay.addRegionEdits(rowName,hcd.getName(),countPerFamily,ee,region,"x");
    }
    final Get g=new Get(rowName);
    Result result=region.get(g);
    assertEquals(countPerFamily * htd.getFamilies().size(),result.size());
    WALEdit edits=new WALEdit();
    for (    Put p : puts) {
      CellScanner cs=p.cellScanner();
      while (cs.advance()) {
        edits.add(cs.current());
      }
    }
    List<UUID> clusterIds=new ArrayList<UUID>();
    clusterIds.add(UUID.randomUUID());
    goslow.setValue(true);
    for (int i=0; i < countPerFamily; i++) {
      final HRegionInfo info=region.getRegionInfo();
      final WALKey logkey=new WALKey(info.getEncodedNameAsBytes(),tableName,System.currentTimeMillis(),clusterIds,-1,-1,region.getMVCC());
      wal.append(htd,info,logkey,edits,true);
    }
    region.flush(true);
    long currentSequenceId=region.getReadPoint(null);
    goslow.setValue(false);
synchronized (goslow) {
      goslow.notifyAll();
    }
    assertTrue(currentSequenceId >= region.getReadPoint(null));
  }
  finally {
    region.close(true);
    wal.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * On rolling a wal after reaching the threshold, {@link WAL#rollWriter()} returns the
 * list of regions which should be flushed in order to archive the oldest wal file.
 * <p>
 * This method tests this behavior by inserting edits and rolling the wal enough times to reach
 * the max number of logs threshold. It checks whether we get the "right regions" for flush on
 * rolling the wal.
 * @throws Exception
 */
@Test public void testFindMemStoresEligibleForFlush() throws Exception {
  LOG.debug("testFindMemStoresEligibleForFlush");
  Configuration conf1=HBaseConfiguration.create(conf);
  conf1.setInt("hbase.regionserver.maxlogs",1);
  FSHLog wal=new FSHLog(fs,FSUtils.getRootDir(conf1),dir.toString(),HConstants.HREGION_OLDLOGDIR_NAME,conf1,null,true,null,null);
  HTableDescriptor t1=new HTableDescriptor(TableName.valueOf("t1")).addFamily(new HColumnDescriptor("row"));
  HTableDescriptor t2=new HTableDescriptor(TableName.valueOf("t2")).addFamily(new HColumnDescriptor("row"));
  HRegionInfo hri1=new HRegionInfo(t1.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
  HRegionInfo hri2=new HRegionInfo(t2.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
  MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
  try {
    addEdits(wal,hri1,t1,2,mvcc);
    wal.rollWriter();
    addEdits(wal,hri1,t1,2,mvcc);
    wal.rollWriter();
    assertTrue(wal.getNumRolledLogFiles() == 2);
    byte[][] regionsToFlush=wal.findRegionsToForceFlush();
    assertEquals(1,regionsToFlush.length);
    assertEquals(hri1.getEncodedNameAsBytes(),regionsToFlush[0]);
    addEdits(wal,hri2,t2,2,mvcc);
    regionsToFlush=wal.findRegionsToForceFlush();
    assertEquals(regionsToFlush.length,1);
    assertEquals(hri1.getEncodedNameAsBytes(),regionsToFlush[0]);
    flushRegion(wal,hri1.getEncodedNameAsBytes(),t1.getFamiliesKeys());
    wal.rollWriter();
    assertEquals(1,wal.getNumRolledLogFiles());
    flushRegion(wal,hri2.getEncodedNameAsBytes(),t2.getFamiliesKeys());
    wal.rollWriter(true);
    assertEquals(0,wal.getNumRolledLogFiles());
    addEdits(wal,hri1,t1,2,mvcc);
    addEdits(wal,hri2,t2,2,mvcc);
    wal.rollWriter();
    assertEquals(1,wal.getNumRolledLogFiles());
    addEdits(wal,hri1,t1,2,mvcc);
    wal.rollWriter();
    regionsToFlush=wal.findRegionsToForceFlush();
    assertEquals(2,regionsToFlush.length);
    flushRegion(wal,hri1.getEncodedNameAsBytes(),t1.getFamiliesKeys());
    flushRegion(wal,hri2.getEncodedNameAsBytes(),t2.getFamiliesKeys());
    wal.rollWriter(true);
    assertEquals(0,wal.getNumRolledLogFiles());
    addEdits(wal,hri1,t1,2,mvcc);
    wal.startCacheFlush(hri1.getEncodedNameAsBytes(),t1.getFamiliesKeys());
    wal.rollWriter();
    wal.completeCacheFlush(hri1.getEncodedNameAsBytes());
    assertEquals(1,wal.getNumRolledLogFiles());
  }
  finally {
    if (wal != null) {
      wal.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IOException.class) public void testFailedToCreateWALIfParentRenamed() throws IOException {
  final String name="testFailedToCreateWALIfParentRenamed";
  FSHLog log=new FSHLog(fs,FSUtils.getRootDir(conf),name,HConstants.HREGION_OLDLOGDIR_NAME,conf,null,true,null,null);
  long filenum=System.currentTimeMillis();
  Path path=log.computeFilename(filenum);
  log.createWriterInstance(path);
  Path parent=path.getParent();
  path=log.computeFilename(filenum + 1);
  Path newPath=new Path(parent.getParent(),parent.getName() + "-splitting");
  fs.rename(parent,newPath);
  log.createWriterInstance(path);
  fail("It should fail to create the new WAL");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestLogRolling </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that logs are deleted when some region has a compaction
 * record in WAL and no other records. See HBASE-8597.
 */
@Test public void testCompactionRecordDoesntBlockRolling() throws Exception {
  Table table=null;
  Table t=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
  try {
    table=createTestTable(getName());
    server=TEST_UTIL.getRSForFirstRegionInTable(table.getName());
    Region region=server.getOnlineRegions(table.getName()).get(0);
    final WAL log=server.getWAL(region.getRegionInfo());
    Store s=region.getStore(HConstants.CATALOG_FAMILY);
    admin.flush(TableName.NAMESPACE_TABLE_NAME);
    for (int i=1; i <= 2; ++i) {
      doPut(table,i);
      admin.flush(table.getName());
    }
    doPut(table,3);
    assertEquals("Should have no WAL after initial writes",0,DefaultWALProvider.getNumRolledLogFiles(log));
    assertEquals(2,s.getStorefilesCount());
    log.rollWriter();
    assertEquals("Should have WAL; one table is not flushed",1,DefaultWALProvider.getNumRolledLogFiles(log));
    admin.flush(table.getName());
    region.compact(false);
    Assert.assertNotNull(s);
    for (int waitTime=3000; s.getStorefilesCount() > 1 && waitTime > 0; waitTime-=200) {
      Threads.sleepWithoutInterrupt(200);
    }
    assertEquals("Compaction didn't happen",1,s.getStorefilesCount());
    doPut(table,0);
    log.rollWriter();
    assertEquals("Should have WAL; one table is not flushed",1,DefaultWALProvider.getNumRolledLogFiles(log));
    admin.flush(table.getName());
    doPut(table,1);
    log.rollWriter();
    assertEquals("Should have 1 WALs at the end",1,DefaultWALProvider.getNumRolledLogFiles(log));
  }
  finally {
    if (t != null)     t.close();
    if (table != null)     table.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that WAL is rolled when all data nodes in the pipeline have been
 * restarted.
 * @throws Exception
 */
@Test public void testLogRollOnPipelineRestart() throws Exception {
  LOG.info("Starting testLogRollOnPipelineRestart");
  assertTrue("This test requires WAL file replication.",fs.getDefaultReplication(TEST_UTIL.getDataTestDirOnTestFS()) > 1);
  LOG.info("Replication=" + fs.getDefaultReplication(TEST_UTIL.getDataTestDirOnTestFS()));
  Table t=TEST_UTIL.getConnection().getTable(TableName.META_TABLE_NAME);
  try {
    this.server=cluster.getRegionServer(0);
    HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(getName()));
    desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
    admin.createTable(desc);
    Table table=TEST_UTIL.getConnection().getTable(desc.getTableName());
    server=TEST_UTIL.getRSForFirstRegionInTable(desc.getTableName());
    HRegionInfo region=server.getOnlineRegions(desc.getTableName()).get(0).getRegionInfo();
    final WAL log=server.getWAL(region);
    final List<Path> paths=new ArrayList<Path>();
    final List<Integer> preLogRolledCalled=new ArrayList<Integer>();
    paths.add(DefaultWALProvider.getCurrentFileName(log));
    log.registerWALActionsListener(new WALActionsListener.Base(){
      @Override public void preLogRoll(      Path oldFile,      Path newFile){
        LOG.debug("preLogRoll: oldFile=" + oldFile + " newFile="+ newFile);
        preLogRolledCalled.add(new Integer(1));
      }
      @Override public void postLogRoll(      Path oldFile,      Path newFile){
        paths.add(newFile);
      }
    }
);
    assertTrue("Need append support for this test",FSUtils.isAppendSupported(TEST_UTIL.getConfiguration()));
    writeData(table,1002);
    long curTime=System.currentTimeMillis();
    LOG.info("log.getCurrentFileName()): " + DefaultWALProvider.getCurrentFileName(log));
    long oldFilenum=DefaultWALProvider.extractFileNumFromWAL(log);
    assertTrue("Log should have a timestamp older than now",curTime > oldFilenum && oldFilenum != -1);
    assertTrue("The log shouldn't have rolled yet",oldFilenum == DefaultWALProvider.extractFileNumFromWAL(log));
    dfsCluster.restartDataNodes();
    Thread.sleep(1000);
    dfsCluster.waitActive();
    LOG.info("Data Nodes restarted");
    validateData(table,1002);
    writeData(table,1003);
    long newFilenum=DefaultWALProvider.extractFileNumFromWAL(log);
    assertTrue("Missing datanode should've triggered a log roll",newFilenum > oldFilenum && newFilenum > curTime);
    validateData(table,1003);
    writeData(table,1004);
    dfsCluster.restartDataNodes();
    Thread.sleep(1000);
    dfsCluster.waitActive();
    LOG.info("Data Nodes restarted");
    validateData(table,1004);
    writeData(table,1005);
    log.rollWriter(true);
    assertTrue("preLogRolledCalled has size of " + preLogRolledCalled.size(),preLogRolledCalled.size() >= 1);
    Set<String> loggedRows=new HashSet<String>();
    FSUtils fsUtils=FSUtils.getInstance(fs,TEST_UTIL.getConfiguration());
    for (    Path p : paths) {
      LOG.debug("recovering lease for " + p);
      fsUtils.recoverFileLease(((HFileSystem)fs).getBackingFs(),p,TEST_UTIL.getConfiguration(),null);
      LOG.debug("Reading WAL " + FSUtils.getPath(p));
      WAL.Reader reader=null;
      try {
        reader=WALFactory.createReader(fs,p,TEST_UTIL.getConfiguration());
        WAL.Entry entry;
        while ((entry=reader.next()) != null) {
          LOG.debug("#" + entry.getKey().getLogSeqNum() + ": "+ entry.getEdit().getCells());
          for (          Cell cell : entry.getEdit().getCells()) {
            loggedRows.add(Bytes.toStringBinary(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength()));
          }
        }
      }
 catch (      EOFException e) {
        LOG.debug("EOF reading file " + FSUtils.getPath(p));
      }
 finally {
        if (reader != null)         reader.close();
      }
    }
    assertTrue(loggedRows.contains("row1002"));
    assertTrue(loggedRows.contains("row1003"));
    assertTrue(loggedRows.contains("row1004"));
    assertTrue(loggedRows.contains("row1005"));
    for (    Region r : server.getOnlineRegionsLocalContext()) {
      try {
        r.flush(true);
      }
 catch (      Exception e) {
        LOG.info(e);
      }
    }
    ResultScanner scanner=table.getScanner(new Scan());
    try {
      for (int i=2; i <= 5; i++) {
        Result r=scanner.next();
        assertNotNull(r);
        assertFalse(r.isEmpty());
        assertEquals("row100" + i,Bytes.toString(r.getRow()));
      }
    }
  finally {
      scanner.close();
    }
    for (    JVMClusterUtil.RegionServerThread rsThread : TEST_UTIL.getHBaseCluster().getRegionServerThreads()) {
      assertFalse(rsThread.getRegionServer().isAborted());
    }
  }
  finally {
    if (t != null)     t.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestMetricsWALSourceImpl </h4><pre class="type-8 type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstance() throws Exception {
  MetricsWALSource walSource=CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
  assertTrue(walSource instanceof MetricsWALSourceImpl);
  assertSame(walSource,CompatibilitySingletonFactory.getInstance(MetricsWALSource.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestReadOldRootAndMetaEdits </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Inserts three waledits in the wal file, and reads them back. The first edit is of a regular
 * table, second waledit is for the ROOT table (it will be ignored while reading),
 * and last waledit is for the hbase:meta table, which will be linked to the new system:meta table.
 * @throws IOException
 */
@Test public void testReadOldRootAndMetaEdits() throws IOException {
  LOG.debug("testReadOldRootAndMetaEdits");
  byte[] row=Bytes.toBytes("row");
  KeyValue kv=new KeyValue(row,row,row,row);
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  kvs.add(kv);
  WALProvider.Writer writer=null;
  WAL.Reader reader=null;
  TableName t=TableName.valueOf("t");
  HRegionInfo tRegionInfo=null;
  int logCount=0;
  long timestamp=System.currentTimeMillis();
  Path path=new Path(dir,"t");
  try {
    tRegionInfo=new HRegionInfo(t,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
    WAL.Entry tEntry=createAEntry(new HLogKey(tRegionInfo.getEncodedNameAsBytes(),t,++logCount,timestamp,HConstants.DEFAULT_CLUSTER_ID),kvs);
    WAL.Entry rootEntry=createAEntry(new HLogKey(Bytes.toBytes(TableName.OLD_ROOT_STR),TableName.OLD_ROOT_TABLE_NAME,++logCount,timestamp,HConstants.DEFAULT_CLUSTER_ID),kvs);
    WAL.Entry oldMetaEntry=createAEntry(new HLogKey(Bytes.toBytes(TableName.OLD_META_STR),TableName.OLD_META_TABLE_NAME,++logCount,timestamp,HConstants.DEFAULT_CLUSTER_ID),kvs);
    writer=WALFactory.createWALWriter(fs,path,conf);
    writer.append(tEntry);
    writer.append(rootEntry);
    writer.append(oldMetaEntry);
    writer.sync();
    writer.close();
    reader=WALFactory.createReader(fs,path,conf);
    WAL.Entry entry=reader.next();
    assertNotNull(entry);
    assertTrue(entry.getKey().getTablename().equals(t));
    assertEquals(Bytes.toString(entry.getKey().getEncodedRegionName()),Bytes.toString(tRegionInfo.getEncodedNameAsBytes()));
    entry=reader.next();
    assertEquals(entry.getKey().getTablename(),TableName.META_TABLE_NAME);
    assertNull(reader.next());
  }
  finally {
    if (writer != null) {
      writer.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestSequenceIdAccounting </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAreAllLower(){
  SequenceIdAccounting sida=new SequenceIdAccounting();
  sida.getOrCreateLowestSequenceIds(ENCODED_REGION_NAME);
  Map<byte[],Long> m=new HashMap<byte[],Long>();
  m.put(ENCODED_REGION_NAME,HConstants.NO_SEQNUM);
  assertTrue(sida.areAllLower(m));
  long sequenceid=1;
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid++,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid++,true);
  assertTrue(sida.areAllLower(m));
  m.put(ENCODED_REGION_NAME,sequenceid);
  assertFalse(sida.areAllLower(m));
  long lowest=sida.getLowestSequenceId(ENCODED_REGION_NAME);
  assertEquals("Lowest should be first sequence id inserted",1,lowest);
  m.put(ENCODED_REGION_NAME,lowest);
  assertFalse(sida.areAllLower(m));
  sida.startCacheFlush(ENCODED_REGION_NAME,FAMILIES);
  assertFalse(sida.areAllLower(m));
  m.put(ENCODED_REGION_NAME,HConstants.NO_SEQNUM);
  assertTrue(sida.areAllLower(m));
  sida.completeCacheFlush(ENCODED_REGION_NAME);
  m.put(ENCODED_REGION_NAME,sequenceid);
  assertTrue(sida.areAllLower(m));
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid++,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid++,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,sequenceid++,true);
  lowest=sida.getLowestSequenceId(ENCODED_REGION_NAME);
  m.put(ENCODED_REGION_NAME,lowest);
  assertFalse(sida.areAllLower(m));
  sida.startCacheFlush(ENCODED_REGION_NAME,FAMILIES);
  assertEquals(HConstants.NO_SEQNUM,sida.getLowestSequenceId(ENCODED_REGION_NAME));
  sida.completeCacheFlush(ENCODED_REGION_NAME);
  assertEquals(HConstants.NO_SEQNUM,sida.getLowestSequenceId(ENCODED_REGION_NAME));
  m.put(ENCODED_REGION_NAME,sequenceid);
  sida.update(ENCODED_REGION_NAME,FAMILIES,++sequenceid,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,++sequenceid,true);
  sida.update(ENCODED_REGION_NAME,FAMILIES,++sequenceid,true);
  assertTrue(sida.areAllLower(m));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestWALReplay </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequentialEditLogSeqNum() throws IOException {
  final TableName tableName=TableName.valueOf(currentTest.getMethodName());
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=FSUtils.getTableDir(this.hbaseRootDir,tableName);
  deleteDir(basedir);
  final byte[] rowName=tableName.getName();
  final int countPerFamily=10;
  final HTableDescriptor htd=createBasic1FamilyHTD(tableName);
  MockWAL wal=createMockWAL();
  HRegion region=HRegion.openHRegion(this.conf,this.fs,hbaseRootDir,hri,htd,wal);
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addRegionEdits(rowName,hcd.getName(),countPerFamily,this.ee,region,"x");
  }
  region.flush(true);
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addRegionEdits(rowName,hcd.getName(),5,this.ee,region,"x");
  }
  long lastestSeqNumber=region.getReadPoint(null);
  wal.doCompleteCacheFlush=true;
  wal.completeCacheFlush(hri.getEncodedNameAsBytes());
  wal.shutdown();
  FileStatus[] listStatus=wal.getFiles();
  assertNotNull(listStatus);
  assertTrue(listStatus.length > 0);
  WALSplitter.splitLogFile(hbaseRootDir,listStatus[0],this.fs,this.conf,null,null,null,mode,wals);
  FileStatus[] listStatus1=this.fs.listStatus(new Path(FSUtils.getTableDir(hbaseRootDir,tableName),new Path(hri.getEncodedName(),"recovered.edits")),new PathFilter(){
    @Override public boolean accept(    Path p){
      if (WALSplitter.isSequenceIdFile(p)) {
        return false;
      }
      return true;
    }
  }
);
  int editCount=0;
  for (  FileStatus fileStatus : listStatus1) {
    editCount=Integer.parseInt(fileStatus.getPath().getName());
  }
  assertEquals("The sequence number of the recoverd.edits and the current edit seq should be same",lastestSeqNumber,editCount);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testReplayEditsAfterRegionMovedWithMultiCF() throws Exception {
  final TableName tableName=TableName.valueOf("testReplayEditsAfterRegionMovedWithMultiCF");
  byte[] family1=Bytes.toBytes("cf1");
  byte[] family2=Bytes.toBytes("cf2");
  byte[] qualifier=Bytes.toBytes("q");
  byte[] value=Bytes.toBytes("testV");
  byte[][] familys={family1,family2};
  TEST_UTIL.createTable(tableName,familys);
  Table htable=TEST_UTIL.getConnection().getTable(tableName);
  Put put=new Put(Bytes.toBytes("r1"));
  put.addColumn(family1,qualifier,value);
  htable.put(put);
  ResultScanner resultScanner=htable.getScanner(new Scan());
  int count=0;
  while (resultScanner.next() != null) {
    count++;
  }
  resultScanner.close();
  assertEquals(1,count);
  MiniHBaseCluster hbaseCluster=TEST_UTIL.getMiniHBaseCluster();
  List<HRegion> regions=hbaseCluster.getRegions(tableName);
  assertEquals(1,regions.size());
  Region destRegion=regions.get(0);
  int originServerNum=hbaseCluster.getServerWith(destRegion.getRegionInfo().getRegionName());
  assertTrue("Please start more than 1 regionserver",hbaseCluster.getRegionServerThreads().size() > 1);
  int destServerNum=0;
  while (destServerNum == originServerNum) {
    destServerNum++;
  }
  HRegionServer originServer=hbaseCluster.getRegionServer(originServerNum);
  HRegionServer destServer=hbaseCluster.getRegionServer(destServerNum);
  moveRegionAndWait(destRegion,destServer);
  Delete del=new Delete(Bytes.toBytes("r1"));
  htable.delete(del);
  resultScanner=htable.getScanner(new Scan());
  count=0;
  while (resultScanner.next() != null) {
    count++;
  }
  resultScanner.close();
  assertEquals(0,count);
  Region region=destServer.getOnlineRegion(destRegion.getRegionInfo().getRegionName());
  region.flush(true);
  for (  Store store : region.getStores()) {
    store.triggerMajorCompaction();
  }
  region.compact(true);
  moveRegionAndWait(destRegion,originServer);
  originServer.abort("testing");
  Result result=htable.get(new Get(Bytes.toBytes("r1")));
  if (result != null) {
    assertTrue("Row is deleted, but we get" + result.toString(),(result == null) || result.isEmpty());
  }
  resultScanner.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create an HRegion with the result of a WAL split and test we only see the
 * good edits
 * @throws Exception
 */
@Test public void testReplayEditsWrittenIntoWAL() throws Exception {
  final TableName tableName=TableName.valueOf("testReplayEditsWrittenIntoWAL");
  final MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=FSUtils.getTableDir(hbaseRootDir,tableName);
  deleteDir(basedir);
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  HRegion region2=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region2);
  final WAL wal=createWAL(this.conf);
  final byte[] rowName=tableName.getName();
  final byte[] regionName=hri.getEncodedNameAsBytes();
  final int countPerFamily=1000;
  Set<byte[]> familyNames=new HashSet<byte[]>();
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addWALEdits(tableName,hri,rowName,hcd.getName(),countPerFamily,ee,wal,htd,mvcc);
    familyNames.add(hcd.getName());
  }
  wal.startCacheFlush(regionName,familyNames);
  wal.completeCacheFlush(regionName);
  WALEdit edit=new WALEdit();
  long now=ee.currentTime();
  edit.add(new KeyValue(rowName,Bytes.toBytes("another family"),rowName,now,rowName));
  wal.append(htd,hri,new WALKey(hri.getEncodedNameAsBytes(),tableName,now,mvcc),edit,true);
  edit=new WALEdit();
  now=ee.currentTime();
  edit.add(new KeyValue(rowName,Bytes.toBytes("c"),null,now,KeyValue.Type.DeleteFamily));
  wal.append(htd,hri,new WALKey(hri.getEncodedNameAsBytes(),tableName,now,mvcc),edit,true);
  wal.sync();
  final Configuration newConf=HBaseConfiguration.create(this.conf);
  User user=HBaseTestingUtility.getDifferentUser(newConf,".replay.wal.secondtime");
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      runWALSplit(newConf);
      FileSystem newFS=FileSystem.get(newConf);
      newConf.setInt(HConstants.HREGION_MEMSTORE_FLUSH_SIZE,1024 * 100);
      WAL newWal=createWAL(newConf);
      final AtomicInteger flushcount=new AtomicInteger(0);
      try {
        final HRegion region=new HRegion(basedir,newWal,newFS,newConf,hri,htd,null){
          @Override protected FlushResult internalFlushcache(          final WAL wal,          final long myseqid,          final Collection<Store> storesToFlush,          MonitoredTask status,          boolean writeFlushWalMarker) throws IOException {
            LOG.info("InternalFlushCache Invoked");
            FlushResult fs=super.internalFlushcache(wal,myseqid,storesToFlush,Mockito.mock(MonitoredTask.class),writeFlushWalMarker);
            flushcount.incrementAndGet();
            return fs;
          }
        }
;
        long seqid=region.initialize();
        long writePoint=mvcc.getWritePoint();
        assertTrue("Flushcount=" + flushcount.get(),flushcount.get() > 0);
        assertTrue((seqid - 1) == writePoint);
        Get get=new Get(rowName);
        Result result=region.get(get);
        assertEquals(countPerFamily * (htd.getFamilies().size() - 1),result.size());
        region.close();
      }
  finally {
        newWal.close();
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case of HRegion that is only made out of bulk loaded files.  Assert
 * that we don't 'crash'.
 * @throws IOException
 * @throws IllegalAccessException
 * @throws NoSuchFieldException
 * @throws IllegalArgumentException
 * @throws SecurityException
 */
@Test public void testRegionMadeOfBulkLoadedFilesOnly() throws IOException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException, InterruptedException {
  final TableName tableName=TableName.valueOf("testRegionMadeOfBulkLoadedFilesOnly");
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=new Path(this.hbaseRootDir,tableName.getNameAsString());
  deleteDir(basedir);
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  Region region2=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region2);
  WAL wal=createWAL(this.conf);
  Region region=HRegion.openHRegion(hri,htd,wal,this.conf);
  byte[] family=htd.getFamilies().iterator().next().getName();
  Path f=new Path(basedir,"hfile");
  HFileTestUtil.createHFile(this.conf,fs,f,family,family,Bytes.toBytes(""),Bytes.toBytes("z"),10);
  List<Pair<byte[],String>> hfs=new ArrayList<Pair<byte[],String>>(1);
  hfs.add(Pair.newPair(family,f.toString()));
  region.bulkLoadHFiles(hfs,true,null);
  byte[] row=tableName.getName();
  region.put((new Put(row)).addColumn(family,family,family));
  wal.sync();
  final int rowsInsertedCount=11;
  assertEquals(rowsInsertedCount,getScannedCount(region.getScanner(new Scan())));
  final Configuration newConf=HBaseConfiguration.create(this.conf);
  User user=HBaseTestingUtility.getDifferentUser(newConf,tableName.getNameAsString());
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      runWALSplit(newConf);
      WAL wal2=createWAL(newConf);
      HRegion region2=HRegion.openHRegion(newConf,FileSystem.get(newConf),hbaseRootDir,hri,htd,wal2);
      long seqid2=region2.getOpenSeqNum();
      assertTrue(seqid2 > -1);
      assertEquals(rowsInsertedCount,getScannedCount(region2.getScanner(new Scan())));
      region2.close();
      wal2.close();
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we could recover the data correctly after aborting flush. In the
 * test, first we abort flush after writing some data, then writing more data
 * and flush again, at last verify the data.
 * @throws IOException
 */
@Test public void testReplayEditsAfterAbortingFlush() throws IOException {
  final TableName tableName=TableName.valueOf("testReplayEditsAfterAbortingFlush");
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=FSUtils.getTableDir(this.hbaseRootDir,tableName);
  deleteDir(basedir);
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  HRegion region3=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region3);
  WAL wal=createWAL(this.conf);
  RegionServerServices rsServices=Mockito.mock(RegionServerServices.class);
  Mockito.doReturn(false).when(rsServices).isAborted();
  when(rsServices.getServerName()).thenReturn(ServerName.valueOf("foo",10,10));
  Configuration customConf=new Configuration(this.conf);
  customConf.set(DefaultStoreEngine.DEFAULT_STORE_FLUSHER_CLASS_KEY,CustomStoreFlusher.class.getName());
  HRegion region=HRegion.openHRegion(this.hbaseRootDir,hri,htd,wal,customConf,rsServices,null);
  int writtenRowCount=10;
  List<HColumnDescriptor> families=new ArrayList<HColumnDescriptor>(htd.getFamilies());
  for (int i=0; i < writtenRowCount; i++) {
    Put put=new Put(Bytes.toBytes(tableName + Integer.toString(i)));
    put.addColumn(families.get(i % families.size()).getName(),Bytes.toBytes("q"),Bytes.toBytes("val"));
    region.put(put);
  }
  RegionScanner scanner=region.getScanner(new Scan());
  assertEquals(writtenRowCount,getScannedCount(scanner));
  CustomStoreFlusher.throwExceptionWhenFlushing.set(true);
  try {
    region.flush(true);
    fail("Injected exception hasn't been thrown");
  }
 catch (  Throwable t) {
    LOG.info("Expected simulated exception when flushing region," + t.getMessage());
    Mockito.doReturn(true).when(rsServices).isAborted();
    region.setClosing(false);
  }
  int moreRow=10;
  for (int i=writtenRowCount; i < writtenRowCount + moreRow; i++) {
    Put put=new Put(Bytes.toBytes(tableName + Integer.toString(i)));
    put.addColumn(families.get(i % families.size()).getName(),Bytes.toBytes("q"),Bytes.toBytes("val"));
    region.put(put);
  }
  writtenRowCount+=moreRow;
  CustomStoreFlusher.throwExceptionWhenFlushing.set(false);
  try {
    region.flush(true);
  }
 catch (  IOException t) {
    LOG.info("Expected exception when flushing region because server is stopped," + t.getMessage());
  }
  region.close(true);
  wal.shutdown();
  runWALSplit(this.conf);
  WAL wal2=createWAL(this.conf);
  Mockito.doReturn(false).when(rsServices).isAborted();
  HRegion region2=HRegion.openHRegion(this.hbaseRootDir,hri,htd,wal2,this.conf,rsServices,null);
  scanner=region2.getScanner(new Scan());
  assertEquals(writtenRowCount,getScannedCount(scanner));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we recover correctly when there is a failure in between the
 * flushes. i.e. Some stores got flushed but others did not.
 * Unfortunately, there is no easy hook to flush at a store level. The way
 * we get around this is by flushing at the region level, and then deleting
 * the recently flushed store file for one of the Stores. This would put us
 * back in the situation where all but that store got flushed and the region
 * died.
 * We restart Region again, and verify that the edits were replayed.
 * @throws IOException
 * @throws IllegalAccessException
 * @throws NoSuchFieldException
 * @throws IllegalArgumentException
 * @throws SecurityException
 */
@Test public void testReplayEditsAfterPartialFlush() throws IOException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException, InterruptedException {
  final TableName tableName=TableName.valueOf("testReplayEditsWrittenViaHRegion");
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=FSUtils.getTableDir(this.hbaseRootDir,tableName);
  deleteDir(basedir);
  final byte[] rowName=tableName.getName();
  final int countPerFamily=10;
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  HRegion region3=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region3);
  WAL wal=createWAL(this.conf);
  HRegion region=HRegion.openHRegion(this.conf,this.fs,hbaseRootDir,hri,htd,wal);
  long seqid=region.getOpenSeqNum();
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addRegionEdits(rowName,hcd.getName(),countPerFamily,this.ee,region,"x");
  }
  final Get g=new Get(rowName);
  Result result=region.get(g);
  assertEquals(countPerFamily * htd.getFamilies().size(),result.size());
  region.flush(true);
  region.close(true);
  wal.shutdown();
  int cf_count=0;
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    cf_count++;
    if (cf_count == 2) {
      region.getRegionFileSystem().deleteFamily(hcd.getNameAsString());
    }
  }
  runWALSplit(this.conf);
  WAL wal2=createWAL(this.conf);
  HRegion region2=HRegion.openHRegion(this.conf,this.fs,hbaseRootDir,hri,htd,wal2);
  long seqid2=region2.getOpenSeqNum();
  assertTrue(seqid + result.size() < seqid2);
  final Result result1b=region2.get(g);
  assertEquals(result.size(),result1b.size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests for hbase-2727.
 * @throws Exception
 * @see <a href="https://issues.apache.org/jira/browse/HBASE-2727">HBASE-2727</a>
 */
@Test public void test2727() throws Exception {
  final TableName tableName=TableName.valueOf("test2727");
  MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
  HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  Path basedir=FSUtils.getTableDir(hbaseRootDir,tableName);
  deleteDir(basedir);
  HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  Region region2=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region2);
  final byte[] rowName=tableName.getName();
  WAL wal1=createWAL(this.conf);
  final int countPerFamily=1000;
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addWALEdits(tableName,hri,rowName,hcd.getName(),countPerFamily,ee,wal1,htd,mvcc);
  }
  wal1.shutdown();
  runWALSplit(this.conf);
  WAL wal2=createWAL(this.conf);
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addWALEdits(tableName,hri,rowName,hcd.getName(),countPerFamily,ee,wal2,htd,mvcc);
  }
  wal2.shutdown();
  runWALSplit(this.conf);
  WAL wal3=createWAL(this.conf);
  try {
    HRegion region=HRegion.openHRegion(this.conf,this.fs,hbaseRootDir,hri,htd,wal3);
    long seqid=region.getOpenSeqNum();
    assertTrue(seqid > mvcc.getWritePoint());
    assertEquals(seqid - 1,mvcc.getWritePoint());
    LOG.debug("region.getOpenSeqNum(): " + region.getOpenSeqNum() + ", wal3.id: "+ mvcc.getReadPoint());
    region.close();
  }
  finally {
    wal3.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test writing edits into an HRegion, closing it, splitting logs, opening
 * Region again.  Verify seqids.
 * @throws IOException
 * @throws IllegalAccessException
 * @throws NoSuchFieldException
 * @throws IllegalArgumentException
 * @throws SecurityException
 */
@Test public void testReplayEditsWrittenViaHRegion() throws IOException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException, InterruptedException {
  final TableName tableName=TableName.valueOf("testReplayEditsWrittenViaHRegion");
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=FSUtils.getTableDir(this.hbaseRootDir,tableName);
  deleteDir(basedir);
  final byte[] rowName=tableName.getName();
  final int countPerFamily=10;
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  HRegion region3=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region3);
  WAL wal=createWAL(this.conf);
  HRegion region=HRegion.openHRegion(this.conf,this.fs,hbaseRootDir,hri,htd,wal);
  long seqid=region.getOpenSeqNum();
  boolean first=true;
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addRegionEdits(rowName,hcd.getName(),countPerFamily,this.ee,region,"x");
    if (first) {
      region.flush(true);
      first=false;
    }
  }
  final Get g=new Get(rowName);
  Result result=region.get(g);
  assertEquals(countPerFamily * htd.getFamilies().size(),result.size());
  region.close(true);
  wal.shutdown();
  runWALSplit(this.conf);
  WAL wal2=createWAL(this.conf);
  HRegion region2=HRegion.openHRegion(conf,this.fs,hbaseRootDir,hri,htd,wal2);
  long seqid2=region2.getOpenSeqNum();
  assertTrue(seqid + result.size() < seqid2);
  final Result result1b=region2.get(g);
  assertEquals(result.size(),result1b.size());
  for (  HColumnDescriptor hcd : htd.getFamilies()) {
    addRegionEdits(rowName,hcd.getName(),countPerFamily,this.ee,region2,"y");
  }
  final Result result2=region2.get(g);
  assertEquals(2 * result.size(),result2.size());
  wal2.sync();
  final Configuration newConf=HBaseConfiguration.create(this.conf);
  User user=HBaseTestingUtility.getDifferentUser(newConf,tableName.getNameAsString());
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      runWALSplit(newConf);
      FileSystem newFS=FileSystem.get(newConf);
      WAL wal3=createWAL(newConf);
      final AtomicInteger countOfRestoredEdits=new AtomicInteger(0);
      HRegion region3=new HRegion(basedir,wal3,newFS,newConf,hri,htd,null){
        @Override protected boolean restoreEdit(        Store s,        Cell cell){
          boolean b=super.restoreEdit(s,cell);
          countOfRestoredEdits.incrementAndGet();
          return b;
        }
      }
;
      long seqid3=region3.initialize();
      Result result3=region3.get(g);
      assertEquals(result2.size(),result3.size());
      assertEquals(htd.getFamilies().size() * countPerFamily,countOfRestoredEdits.get());
      region3.close();
      wal3.close();
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * HRegion test case that is made of a major compacted HFile (created with three bulk loaded
 * files) and an edit in the memstore.
 * This is for HBASE-10958 "[dataloss] Bulk loading with seqids can prevent some log entries
 * from being replayed"
 * @throws IOException
 * @throws IllegalAccessException
 * @throws NoSuchFieldException
 * @throws IllegalArgumentException
 * @throws SecurityException
 */
@Test public void testCompactedBulkLoadedFiles() throws IOException, SecurityException, IllegalArgumentException, NoSuchFieldException, IllegalAccessException, InterruptedException {
  final TableName tableName=TableName.valueOf("testCompactedBulkLoadedFiles");
  final HRegionInfo hri=createBasic3FamilyHRegionInfo(tableName);
  final Path basedir=new Path(this.hbaseRootDir,tableName.getNameAsString());
  deleteDir(basedir);
  final HTableDescriptor htd=createBasic3FamilyHTD(tableName);
  HRegion region2=HBaseTestingUtility.createRegionAndWAL(hri,hbaseRootDir,this.conf,htd);
  HBaseTestingUtility.closeRegionAndWAL(region2);
  WAL wal=createWAL(this.conf);
  HRegion region=HRegion.openHRegion(hri,htd,wal,this.conf);
  byte[] row=tableName.getName();
  byte[] family=htd.getFamilies().iterator().next().getName();
  region.put((new Put(row)).addColumn(family,family,family));
  wal.sync();
  List<Pair<byte[],String>> hfs=new ArrayList<Pair<byte[],String>>(1);
  for (int i=0; i < 3; i++) {
    Path f=new Path(basedir,"hfile" + i);
    HFileTestUtil.createHFile(this.conf,fs,f,family,family,Bytes.toBytes(i + "00"),Bytes.toBytes(i + "50"),10);
    hfs.add(Pair.newPair(family,f.toString()));
  }
  region.bulkLoadHFiles(hfs,true,null);
  final int rowsInsertedCount=31;
  assertEquals(rowsInsertedCount,getScannedCount(region.getScanner(new Scan())));
  region.compact(true);
  assertEquals(rowsInsertedCount,getScannedCount(region.getScanner(new Scan())));
  final Configuration newConf=HBaseConfiguration.create(this.conf);
  User user=HBaseTestingUtility.getDifferentUser(newConf,tableName.getNameAsString());
  user.runAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      runWALSplit(newConf);
      WAL wal2=createWAL(newConf);
      HRegion region2=HRegion.openHRegion(newConf,FileSystem.get(newConf),hbaseRootDir,hri,htd,wal2);
      long seqid2=region2.getOpenSeqNum();
      assertTrue(seqid2 > -1);
      assertEquals(rowsInsertedCount,getScannedCount(region2.getScanner(new Scan())));
      region2.close();
      wal2.close();
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestPerTableCFReplication </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseTableCFsFromConfig(){
  Map<TableName,List<String>> tabCFsMap=null;
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig(null);
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("");
  assertEquals(null,tabCFsMap);
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("   ");
  assertEquals(null,tabCFsMap);
  TableName tab1=TableName.valueOf("tab1");
  TableName tab2=TableName.valueOf("tab2");
  TableName tab3=TableName.valueOf("tab3");
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertFalse(tabCFsMap.containsKey(tab2));
  assertEquals(null,tabCFsMap.get(tab1));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab2:cf1");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab2));
  assertFalse(tabCFsMap.containsKey(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab3 : cf1 , cf3");
  assertEquals(1,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab3));
  assertFalse(tabCFsMap.containsKey(tab1));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1 ; tab2:cf1 ; tab3:cf1,cf3");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertTrue(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(null,tabCFsMap.get(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1 ; ; tab2:cf1 ; tab3:cf1,,cf3 ;");
  assertEquals(3,tabCFsMap.size());
  assertTrue(tabCFsMap.containsKey(tab1));
  assertTrue(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(null,tabCFsMap.get(tab1));
  assertEquals(1,tabCFsMap.get(tab2).size());
  assertEquals("cf1",tabCFsMap.get(tab2).get(0));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
  tabCFsMap=ReplicationAdmin.parseTableCFsFromConfig("tab1:tt:cf1 ; tab2::cf1 ; tab3:cf1,cf3");
  assertEquals(1,tabCFsMap.size());
  assertFalse(tabCFsMap.containsKey(tab1));
  assertFalse(tabCFsMap.containsKey(tab2));
  assertTrue(tabCFsMap.containsKey(tab3));
  assertEquals(2,tabCFsMap.get(tab3).size());
  assertTrue(tabCFsMap.get(tab3).contains("cf1"));
  assertTrue(tabCFsMap.get(tab3).contains("cf3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationChangingPeerRegionservers </h4><pre class="type-9 type-2 type-10 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@Before public void setUp() throws Exception {
  for (  JVMClusterUtil.RegionServerThread r : utility1.getHBaseCluster().getRegionServerThreads()) {
    utility1.getHBaseAdmin().rollWALWriter(r.getRegionServer().getServerName());
  }
  utility1.deleteTableData(tableName);
  Scan scan=new Scan();
  int lastCount=0;
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for truncate");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != 0) {
      if (res.length < lastCount) {
        i--;
      }
      lastCount=res.length;
      LOG.info("Still got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationDisableInactivePeer </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disabling an inactive peer. Add a peer which is inactive, trying to
 * insert, disable the peer, then activate the peer and make sure nothing is
 * replicated. In Addition, enable the peer and check the updates are
 * replicated.
 * @throws Exception
 */
@Test(timeout=600000) public void testDisableInactivePeer() throws Exception {
  admin.enablePeer("2");
  utility2.shutdownMiniHBaseCluster();
  byte[] rowkey=Bytes.toBytes("disable inactive peer");
  Put put=new Put(rowkey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Thread.sleep(SLEEP_TIME * NB_RETRIES);
  admin.disablePeer("2");
  utility2.startMiniHBaseCluster(1,2);
  Get get=new Get(rowkey);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Replication wasn't disabled");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.enablePeer("2");
  Thread.sleep(SLEEP_TIME * NB_RETRIES);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME * NB_RETRIES);
    }
 else {
      assertArrayEquals(res.value(),row);
      return;
    }
  }
  fail("Waited too much time for put replication");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationEndpoint </h4><pre class="type-3 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  TestReplicationBase.tearDownAfterClass();
  Assert.assertTrue(ReplicationEndpointForTest.stoppedCount.get() > 0);
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testReplicationEndpointReturnsFalseOnReplicate() throws Exception {
  Assert.assertEquals(0,ReplicationEndpointForTest.replicateCount.get());
  Assert.assertTrue(!ReplicationEndpointReturningFalse.replicated.get());
  int peerCount=admin.getPeersCount();
  final String id="testReplicationEndpointReturnsFalseOnReplicate";
  admin.addPeer(id,new ReplicationPeerConfig().setClusterKey(ZKConfig.getZooKeeperClusterKey(conf1)).setReplicationEndpointImpl(ReplicationEndpointReturningFalse.class.getName()),null);
  if (admin.getPeersCount() <= peerCount) {
    LOG.info("Waiting on peercount to go up from " + peerCount);
    Threads.sleep(100);
  }
  doPut(row);
  Waiter.waitFor(conf1,60000,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      int count=ReplicationEndpointForTest.replicateCount.get();
      LOG.info("count=" + count);
      return ReplicationEndpointReturningFalse.replicated.get();
    }
  }
);
  if (ReplicationEndpointReturningFalse.ex.get() != null) {
    throw ReplicationEndpointReturningFalse.ex.get();
  }
  admin.removePeer("testReplicationEndpointReturnsFalseOnReplicate");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationSmallTests </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Integration test for TestReplicationAdmin, removes and re-add a peer
 * cluster
 * @throws Exception
 */
@Test(timeout=300000) public void testAddAndRemoveClusters() throws Exception {
  LOG.info("testAddAndRemoveClusters");
  admin.removePeer("2");
  Thread.sleep(SLEEP_TIME);
  byte[] rowKey=Bytes.toBytes("Won't be replicated");
  Put put=new Put(rowKey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Get get=new Get(rowKey);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      break;
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Not supposed to be replicated");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.addPeer("2",utility2.getClusterKey());
  Thread.sleep(SLEEP_TIME);
  rowKey=Bytes.toBytes("do rep");
  put=new Put(rowKey);
  put.addColumn(famName,row,row);
  LOG.info("Adding new row");
  htable1.put(put);
  get=new Get(rowKey);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME * i);
    }
 else {
      assertArrayEquals(res.value(),row);
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that version and column delete marker types are replicated
 * correctly.
 * @throws Exception
 */
@Test(timeout=300000) public void testDeleteTypes() throws Exception {
  LOG.info("testDeleteTypes");
  final byte[] v1=Bytes.toBytes("v1");
  final byte[] v2=Bytes.toBytes("v2");
  final byte[] v3=Bytes.toBytes("v3");
  htable1=utility1.getConnection().getTable(tableName);
  long t=EnvironmentEdgeManager.currentTime();
  Put put=new Put(row);
  put.addColumn(famName,row,t,v1);
  htable1.put(put);
  put=new Put(row);
  put.addColumn(famName,row,t + 1,v2);
  htable1.put(put);
  put=new Put(row);
  put.addColumn(famName,row,t + 2,v3);
  htable1.put(put);
  Get get=new Get(row);
  get.setMaxVersions();
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() < 3) {
      LOG.info("Rows not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[0]),v3);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[1]),v2);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[2]),v1);
      break;
    }
  }
  Delete d=new Delete(row);
  d.addColumn(famName,row,t);
  htable1.delete(d);
  get=new Get(row);
  get.setMaxVersions();
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() > 2) {
      LOG.info("Version not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[0]),v3);
      assertArrayEquals(CellUtil.cloneValue(res.rawCells()[1]),v2);
      break;
    }
  }
  d=new Delete(row);
  d.addColumns(famName,row,t + 2);
  htable1.delete(d);
  get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for del replication");
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      LOG.info("Rows not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Do a more intense version testSmallBatch, one  that will trigger
 * wal rolling and other non-trivial code paths
 * @throws Exception
 */
@Test(timeout=300000) public void testLoading() throws Exception {
  LOG.info("Writing out rows to table1 in testLoading");
  List<Put> puts=new ArrayList<Put>();
  for (int i=0; i < NB_ROWS_IN_BIG_BATCH; i++) {
    Put put=new Put(Bytes.toBytes(i));
    put.addColumn(famName,row,row);
    puts.add(put);
  }
  htable1.setWriteBufferSize(1024);
  htable1.put(puts);
  Scan scan=new Scan();
  ResultScanner scanner=htable1.getScanner(scan);
  Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
  scanner.close();
  assertEquals(NB_ROWS_IN_BIG_BATCH,res.length);
  LOG.info("Looking in table2 for replicated rows in testLoading");
  long start=System.currentTimeMillis();
  final long retries=NB_RETRIES * 10;
  for (int i=0; i < retries; i++) {
    scan=new Scan();
    scanner=htable2.getScanner(scan);
    res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != NB_ROWS_IN_BIG_BATCH) {
      if (i == retries - 1) {
        int lastRow=-1;
        for (        Result result : res) {
          int currentRow=Bytes.toInt(result.getRow());
          for (int row=lastRow + 1; row < currentRow; row++) {
            LOG.error("Row missing: " + row);
          }
          lastRow=currentRow;
        }
        LOG.error("Last row: " + lastRow);
        fail("Waited too much time for normal batch replication, " + res.length + " instead of "+ NB_ROWS_IN_BIG_BATCH+ "; waited="+ (System.currentTimeMillis() - start)+ "ms");
      }
 else {
        LOG.info("Only got " + res.length + " rows... retrying");
        Thread.sleep(SLEEP_TIME);
      }
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test disable/enable replication, trying to insert, make sure nothing's
 * replicated, enable it, the insert should be replicated
 * @throws Exception
 */
@Test(timeout=300000) public void testDisableEnable() throws Exception {
  admin.disablePeer("2");
  byte[] rowkey=Bytes.toBytes("disable enable");
  Put put=new Put(rowkey);
  put.addColumn(famName,row,row);
  htable1.put(put);
  Get get=new Get(rowkey);
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      fail("Replication wasn't disabled");
    }
 else {
      LOG.info("Row not replicated, let's wait a bit more...");
      Thread.sleep(SLEEP_TIME);
    }
  }
  admin.enablePeer("2");
  for (int i=0; i < NB_RETRIES; i++) {
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(res.value(),row);
      return;
    }
  }
  fail("Waited too much time for put replication");
}

</code></pre>

<br>
<pre class="type-4 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Do a small loading into a table, make sure the data is really the same,
 * then run the VerifyReplication job to check the results. Do a second
 * comparison where all the cells are different.
 * @throws Exception
 */
@Test(timeout=300000) public void testVerifyRepJob() throws Exception {
  testSmallBatch();
  String[] args=new String[]{"2",tableName.getNameAsString()};
  Job job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
  if (job == null) {
    fail("Job wasn't created, see the log");
  }
  if (!job.waitForCompletion(true)) {
    fail("Job failed, see the log");
  }
  assertEquals(NB_ROWS_IN_BATCH,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
  assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
  Scan scan=new Scan();
  ResultScanner rs=htable2.getScanner(scan);
  Put put=null;
  for (  Result result : rs) {
    put=new Put(result.getRow());
    Cell firstVal=result.rawCells()[0];
    put.addColumn(CellUtil.cloneFamily(firstVal),CellUtil.cloneQualifier(firstVal),Bytes.toBytes("diff data"));
    htable2.put(put);
  }
  Delete delete=new Delete(put.getRow());
  htable2.delete(delete);
  job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
  if (job == null) {
    fail("Job wasn't created, see the log");
  }
  if (!job.waitForCompletion(true)) {
    fail("Job failed, see the log");
  }
  assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
  assertEquals(NB_ROWS_IN_BATCH,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Try a small batch upload using the write buffer, check it's replicated
 * @throws Exception
 */
@Test(timeout=300000) public void testSmallBatch() throws Exception {
  LOG.info("testSmallBatch");
  List<Put> puts=new ArrayList<>();
  for (int i=0; i < NB_ROWS_IN_BATCH; i++) {
    Put put=new Put(Bytes.toBytes(i));
    put.addColumn(famName,row,row);
    puts.add(put);
  }
  htable1.put(puts);
  Scan scan=new Scan();
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(NB_ROWS_IN_BATCH);
  scanner1.close();
  assertEquals(NB_ROWS_IN_BATCH,res1.length);
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BATCH);
    scanner.close();
    if (res.length != NB_ROWS_IN_BATCH) {
      LOG.info("Only got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Add a row, check it's replicated, delete it, check's gone
 * @throws Exception
 */
@Test(timeout=300000) public void testSimplePutDelete() throws Exception {
  LOG.info("testSimplePutDelete");
  Put put=new Put(row);
  put.addColumn(famName,row,row);
  htable1=utility1.getConnection().getTable(tableName);
  htable1.put(put);
  Get get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for put replication");
    }
    Result res=htable2.get(get);
    if (res.size() == 0) {
      LOG.info("Row not available");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      assertArrayEquals(res.value(),row);
      break;
    }
  }
  Delete del=new Delete(row);
  htable1.delete(del);
  get=new Get(row);
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for del replication");
    }
    Result res=htable2.get(get);
    if (res.size() >= 1) {
      LOG.info("Row not deleted");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testVersionMismatchHBase14905() throws Exception {
  byte[] qualifierName=Bytes.toBytes("f1");
  Put put=new Put(Bytes.toBytes("r1"));
  long ts=System.currentTimeMillis();
  put.addColumn(famName,qualifierName,ts + 1,Bytes.toBytes("v1"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,ts + 2,Bytes.toBytes("v2"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,ts + 3,Bytes.toBytes("v3"));
  htable1.put(put);
  Scan scan=new Scan();
  scan.setMaxVersions(100);
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(1);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(1);
    scanner1.close();
    if (res1.length != 1) {
      LOG.info("Only got " + res1.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      int cellNumber=res1[0].getColumnCells(famName,Bytes.toBytes("f1")).size();
      if (cellNumber != 3) {
        LOG.info("Only got " + cellNumber + " cells");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        break;
      }
    }
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
  }
  try {
    admin.disablePeer("2");
    Put put2=new Put(Bytes.toBytes("r1"));
    put2.addColumn(famName,qualifierName,ts + 2,Bytes.toBytes("v99"));
    htable2.put(put2);
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(NB_ROWS_IN_BATCH);
    scanner1.close();
    assertEquals(1,res1.length);
    assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
    String[] args=new String[]{"--versions=100","2",tableName.getNameAsString()};
    Job job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
    if (job == null) {
      fail("Job wasn't created, see the log");
    }
    if (!job.waitForCompletion(true)) {
      fail("Job failed, see the log");
    }
    assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
    assertEquals(1,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
  }
  finally {
    admin.enablePeer("2");
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testHBase14905() throws Exception {
  byte[] qualifierName=Bytes.toBytes("f1");
  Put put=new Put(Bytes.toBytes("r1"));
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1002"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1001"));
  htable1.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1112"));
  htable1.put(put);
  Scan scan=new Scan();
  scan.setMaxVersions(100);
  ResultScanner scanner1=htable1.getScanner(scan);
  Result[] res1=scanner1.next(1);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(3,res1[0].getColumnCells(famName,qualifierName).size());
  for (int i=0; i < NB_RETRIES; i++) {
    scan=new Scan();
    scan.setMaxVersions(100);
    scanner1=htable2.getScanner(scan);
    res1=scanner1.next(1);
    scanner1.close();
    if (res1.length != 1) {
      LOG.info("Only got " + res1.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      int cellNumber=res1[0].getColumnCells(famName,Bytes.toBytes("f1")).size();
      if (cellNumber != 3) {
        LOG.info("Only got " + cellNumber + " cells");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        break;
      }
    }
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for normal batch replication");
    }
  }
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1111"));
  htable2.put(put);
  put.addColumn(famName,qualifierName,Bytes.toBytes("v1112"));
  htable2.put(put);
  scan=new Scan();
  scan.setMaxVersions(100);
  scanner1=htable2.getScanner(scan);
  res1=scanner1.next(NB_ROWS_IN_BATCH);
  scanner1.close();
  assertEquals(1,res1.length);
  assertEquals(5,res1[0].getColumnCells(famName,qualifierName).size());
  String[] args=new String[]{"--versions=100","2",tableName.getNameAsString()};
  Job job=VerifyReplication.createSubmittableJob(CONF_WITH_LOCALFS,args);
  if (job == null) {
    fail("Job wasn't created, see the log");
  }
  if (!job.waitForCompletion(true)) {
    fail("Job failed, see the log");
  }
  assertEquals(0,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.GOODROWS).getValue());
  assertEquals(1,job.getCounters().findCounter(VerifyReplication.Verifier.Counters.BADROWS).getValue());
}

</code></pre>

<br>
<pre class="type-9 type-2 type-10 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@Before public void setUp() throws Exception {
  for (  JVMClusterUtil.RegionServerThread r : utility1.getHBaseCluster().getRegionServerThreads()) {
    utility1.getHBaseAdmin().rollWALWriter(r.getRegionServer().getServerName());
  }
  utility1.deleteTableData(tableName);
  Scan scan=new Scan();
  int lastCount=0;
  for (int i=0; i < NB_RETRIES; i++) {
    if (i == NB_RETRIES - 1) {
      fail("Waited too much time for truncate");
    }
    ResultScanner scanner=htable2.getScanner(scan);
    Result[] res=scanner.next(NB_ROWS_IN_BIG_BATCH);
    scanner.close();
    if (res.length != 0) {
      if (res.length < lastCount) {
        i--;
      }
      lastCount=res.length;
      LOG.info("Still got " + res.length + " rows");
      Thread.sleep(SLEEP_TIME);
    }
 else {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationStateBasic </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemovePeerForHFileRefs() throws ReplicationException, KeeperException {
  rq1.init(server1);
  rqc.init();
  rp.init();
  rp.addPeer(ID_ONE,new ReplicationPeerConfig().setClusterKey(KEY_ONE),null);
  rp.addPeer(ID_TWO,new ReplicationPeerConfig().setClusterKey(KEY_TWO),null);
  List<String> files1=new ArrayList<String>(3);
  files1.add("file_1");
  files1.add("file_2");
  files1.add("file_3");
  rq1.addHFileRefs(ID_ONE,files1);
  rq1.addHFileRefs(ID_TWO,files1);
  assertEquals(2,rqc.getAllPeersFromHFileRefsQueue().size());
  assertEquals(3,rqc.getReplicableHFiles(ID_ONE).size());
  assertEquals(3,rqc.getReplicableHFiles(ID_TWO).size());
  rp.removePeer(ID_ONE);
  assertEquals(1,rqc.getAllPeersFromHFileRefsQueue().size());
  assertNull(rqc.getReplicableHFiles(ID_ONE));
  assertEquals(3,rqc.getReplicableHFiles(ID_TWO).size());
  rp.removePeer(ID_TWO);
  assertEquals(0,rqc.getAllPeersFromHFileRefsQueue().size());
  assertNull(rqc.getReplicableHFiles(ID_TWO));
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplicationQueues() throws ReplicationException {
  rq1.init(server1);
  rq2.init(server2);
  rq3.init(server3);
  rp.init();
  assertEquals(3,rq1.getListOfReplicators().size());
  rq1.removeQueue("bogus");
  rq1.removeLog("bogus","bogus");
  rq1.removeAllQueues();
  assertNull(rq1.getAllQueues());
  assertEquals(0,rq1.getLogPosition("bogus","bogus"));
  assertNull(rq1.getLogsInQueue("bogus"));
  assertEquals(0,rq1.claimQueues(ServerName.valueOf("bogus",1234,-1L).toString()).size());
  rq1.setLogPosition("bogus","bogus",5L);
  populateQueues();
  assertEquals(3,rq1.getListOfReplicators().size());
  assertEquals(0,rq2.getLogsInQueue("qId1").size());
  assertEquals(5,rq3.getLogsInQueue("qId5").size());
  assertEquals(0,rq3.getLogPosition("qId1","filename0"));
  rq3.setLogPosition("qId5","filename4",354L);
  assertEquals(354L,rq3.getLogPosition("qId5","filename4"));
  assertEquals(5,rq3.getLogsInQueue("qId5").size());
  assertEquals(0,rq2.getLogsInQueue("qId1").size());
  assertEquals(0,rq1.getAllQueues().size());
  assertEquals(1,rq2.getAllQueues().size());
  assertEquals(5,rq3.getAllQueues().size());
  assertEquals(0,rq3.claimQueues(server1).size());
  assertEquals(2,rq3.getListOfReplicators().size());
  SortedMap<String,SortedSet<String>> queues=rq2.claimQueues(server3);
  assertEquals(5,queues.size());
  assertEquals(1,rq2.getListOfReplicators().size());
  assertEquals(0,rq2.claimQueues(server2).size());
  assertEquals(6,rq2.getAllQueues().size());
  rq2.removeAllQueues();
  assertEquals(0,rq2.getListOfReplicators().size());
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHfileRefsReplicationQueues() throws ReplicationException, KeeperException {
  rp.init();
  rq1.init(server1);
  rqc.init();
  List<String> files1=new ArrayList<String>(3);
  files1.add("file_1");
  files1.add("file_2");
  files1.add("file_3");
  assertNull(rqc.getReplicableHFiles(ID_ONE));
  assertEquals(0,rqc.getAllPeersFromHFileRefsQueue().size());
  rp.addPeer(ID_ONE,new ReplicationPeerConfig().setClusterKey(KEY_ONE),null);
  rq1.addHFileRefs(ID_ONE,files1);
  assertEquals(1,rqc.getAllPeersFromHFileRefsQueue().size());
  assertEquals(3,rqc.getReplicableHFiles(ID_ONE).size());
  List<String> files2=new ArrayList<>(files1);
  String removedString=files2.remove(0);
  rq1.removeHFileRefs(ID_ONE,files2);
  assertEquals(1,rqc.getReplicableHFiles(ID_ONE).size());
  files2=new ArrayList<>(1);
  files2.add(removedString);
  rq1.removeHFileRefs(ID_ONE,files2);
  assertEquals(0,rqc.getReplicableHFiles(ID_ONE).size());
  rp.removePeer(ID_ONE);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplicationPeers() throws Exception {
  rp.init();
  try {
    rp.removePeer("bogus");
    fail("Should have thrown an IllegalArgumentException when passed a bogus peerId");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    rp.enablePeer("bogus");
    fail("Should have thrown an IllegalArgumentException when passed a bogus peerId");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    rp.disablePeer("bogus");
    fail("Should have thrown an IllegalArgumentException when passed a bogus peerId");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    rp.getStatusOfPeer("bogus");
    fail("Should have thrown an IllegalArgumentException when passed a bogus peerId");
  }
 catch (  IllegalArgumentException e) {
  }
  assertFalse(rp.peerAdded("bogus"));
  rp.peerRemoved("bogus");
  assertNull(rp.getPeerConf("bogus"));
  assertNumberOfPeers(0);
  rp.addPeer(ID_ONE,new ReplicationPeerConfig().setClusterKey(KEY_ONE),null);
  assertNumberOfPeers(1);
  rp.addPeer(ID_TWO,new ReplicationPeerConfig().setClusterKey(KEY_TWO),null);
  assertNumberOfPeers(2);
  try {
    rp.getStatusOfPeer(ID_ONE);
    fail("There are no connected peers, should have thrown an IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(KEY_ONE,ZKConfig.getZooKeeperClusterKey(rp.getPeerConf(ID_ONE).getSecond()));
  rp.removePeer(ID_ONE);
  rp.peerRemoved(ID_ONE);
  assertNumberOfPeers(1);
  rp.addPeer(ID_ONE,new ReplicationPeerConfig().setClusterKey(KEY_ONE),null);
  rp.peerAdded(ID_ONE);
  assertNumberOfPeers(2);
  assertTrue(rp.getStatusOfPeer(ID_ONE));
  rp.disablePeer(ID_ONE);
  assertConnectedPeerStatus(false,ID_ONE);
  rp.enablePeer(ID_ONE);
  assertConnectedPeerStatus(true,ID_ONE);
  rp.peerRemoved(ID_ONE);
  assertNumberOfPeers(2);
  try {
    rp.getStatusOfPeer(ID_ONE);
    fail("There are no connected peers, should have thrown an IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplicationQueuesClient() throws ReplicationException, KeeperException {
  rqc.init();
  assertEquals(0,rqc.getListOfReplicators().size());
  assertNull(rqc.getLogsInQueue(server1,"qId1"));
  assertNull(rqc.getAllQueues(server1));
  rq1.init(server1);
  rq2.init(server2);
  rq1.addLog("qId1","trash");
  rq1.removeLog("qId1","trash");
  rq1.addLog("qId2","filename1");
  rq1.addLog("qId3","filename2");
  rq1.addLog("qId3","filename3");
  rq2.addLog("trash","trash");
  rq2.removeQueue("trash");
  List<String> reps=rqc.getListOfReplicators();
  assertEquals(2,reps.size());
  assertTrue(server1,reps.contains(server1));
  assertTrue(server2,reps.contains(server2));
  assertNull(rqc.getLogsInQueue("bogus","bogus"));
  assertNull(rqc.getLogsInQueue(server1,"bogus"));
  assertEquals(0,rqc.getLogsInQueue(server1,"qId1").size());
  assertEquals(1,rqc.getLogsInQueue(server1,"qId2").size());
  assertEquals("filename1",rqc.getLogsInQueue(server1,"qId2").get(0));
  assertNull(rqc.getAllQueues("bogus"));
  assertEquals(0,rqc.getAllQueues(server2).size());
  List<String> list=rqc.getAllQueues(server1);
  assertEquals(3,list.size());
  assertTrue(list.contains("qId2"));
  assertTrue(list.contains("qId3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationTrackerZKImpl </h4><pre class="type-2 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  zkw=HBaseTestingUtility.getZooKeeperWatcher(utility);
  String fakeRs1=ZKUtil.joinZNode(zkw.rsZNode,"hostname1.example.org:1234");
  try {
    ZKClusterId.setClusterId(zkw,new ClusterId());
    rp=ReplicationFactory.getReplicationPeers(zkw,conf,zkw);
    rp.init();
    rt=ReplicationFactory.getReplicationTracker(zkw,rp,conf,zkw,new DummyServer(fakeRs1));
  }
 catch (  Exception e) {
    fail("Exception during test setup: " + e);
  }
  rsRemovedCount=new AtomicInteger(0);
  rsRemovedData="";
  plChangedCount=new AtomicInteger(0);
  plChangedData=new ArrayList<String>();
  peerRemovedCount=new AtomicInteger(0);
  peerRemovedData="";
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testPeerListChangedEvent() throws Exception {
  rp.addPeer("5",new ReplicationPeerConfig().setClusterKey(utility.getClusterKey()),null);
  zkw.getRecoverableZooKeeper().getZooKeeper().getChildren("/hbase/replication/peers/5",true);
  rt.registerListener(new DummyReplicationListener());
  rp.disablePeer("5");
  int tmp=plChangedCount.get();
  LOG.info("Peer count=" + tmp);
  ZKUtil.deleteNode(zkw,"/hbase/replication/peers/5/peer-state");
  while (plChangedCount.get() <= tmp) {
    Thread.sleep(100);
    LOG.info("Peer count=" + tmp);
  }
  assertEquals(1,plChangedData.size());
  assertTrue(plChangedData.contains("5"));
  rp.removePeer("5");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationWALEntryFilters </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSystemTableWALEntryFilter(){
  SystemTableWALEntryFilter filter=new SystemTableWALEntryFilter();
  WALKey key1=new WALKey(HRegionInfo.FIRST_META_REGIONINFO.getEncodedNameAsBytes(),TableName.META_TABLE_NAME);
  Entry metaEntry=new Entry(key1,null);
  assertNull(filter.filter(metaEntry));
  WALKey key2=new WALKey(new byte[]{},TableName.NAMESPACE_TABLE_NAME);
  Entry nsEntry=new Entry(key2,null);
  assertNull(filter.filter(nsEntry));
  WALKey key3=new WALKey(new byte[]{},TableName.valueOf("foo"));
  Entry userEntry=new Entry(key3,null);
  assertEquals(userEntry,filter.filter(userEntry));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationWithTags </h4><pre class="type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testReplicationWithCellTags() throws Exception {
  LOG.info("testSimplePutDelete");
  Put put=new Put(ROW);
  put.setAttribute("visibility",Bytes.toBytes("myTag3"));
  put.addColumn(FAMILY,ROW,ROW);
  htable1=utility1.getConnection().getTable(TABLE_NAME);
  htable1.put(put);
  Get get=new Get(ROW);
  try {
    for (int i=0; i < NB_RETRIES; i++) {
      if (i == NB_RETRIES - 1) {
        fail("Waited too much time for put replication");
      }
      Result res=htable2.get(get);
      if (res.size() == 0) {
        LOG.info("Row not available");
        Thread.sleep(SLEEP_TIME);
      }
 else {
        assertArrayEquals(res.value(),ROW);
        assertEquals(1,TestCoprocessorForTagsAtSink.tags.size());
        Tag tag=TestCoprocessorForTagsAtSink.tags.get(0);
        assertEquals(TAG_TYPE,tag.getType());
        break;
      }
    }
  }
  finally {
    TestCoprocessorForTagsAtSink.tags=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestRegionReplicaReplicationEndpoint </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationPeerIsCreatedForModifyTable() throws Exception {
  ReplicationAdmin admin=new ReplicationAdmin(HTU.getConfiguration());
  String peerId="region_replica_replication";
  if (admin.getPeerConfig(peerId) != null) {
    admin.removePeer(peerId);
  }
  HTableDescriptor htd=HTU.createTableDescriptor("testRegionReplicaReplicationPeerIsCreatedForModifyTable");
  HTU.getHBaseAdmin().createTable(htd);
  ReplicationPeerConfig peerConfig=admin.getPeerConfig(peerId);
  assertNull(peerConfig);
  HTU.getHBaseAdmin().disableTable(htd.getTableName());
  htd.setRegionReplication(2);
  HTU.getHBaseAdmin().modifyTable(htd.getTableName(),htd);
  HTU.getHBaseAdmin().enableTable(htd.getTableName());
  peerConfig=admin.getPeerConfig(peerId);
  assertNotNull(peerConfig);
  assertEquals(peerConfig.getClusterKey(),ZKConfig.getZooKeeperClusterKey(HTU.getConfiguration()));
  assertEquals(peerConfig.getReplicationEndpointImpl(),RegionReplicaReplicationEndpoint.class.getName());
  admin.close();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegionReplicaReplicationPeerIsCreated() throws IOException, ReplicationException {
  ReplicationAdmin admin=new ReplicationAdmin(HTU.getConfiguration());
  String peerId="region_replica_replication";
  if (admin.getPeerConfig(peerId) != null) {
    admin.removePeer(peerId);
  }
  HTableDescriptor htd=HTU.createTableDescriptor("testReplicationPeerIsCreated_no_region_replicas");
  HTU.getHBaseAdmin().createTable(htd);
  ReplicationPeerConfig peerConfig=admin.getPeerConfig(peerId);
  assertNull(peerConfig);
  htd=HTU.createTableDescriptor("testReplicationPeerIsCreated");
  htd.setRegionReplication(2);
  HTU.getHBaseAdmin().createTable(htd);
  peerConfig=admin.getPeerConfig(peerId);
  assertNotNull(peerConfig);
  assertEquals(peerConfig.getClusterKey(),ZKConfig.getZooKeeperClusterKey(HTU.getConfiguration()));
  assertEquals(peerConfig.getReplicationEndpointImpl(),RegionReplicaReplicationEndpoint.class.getName());
  admin.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestReplicationThrottler </h4><pre class="type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * unit test for throttling
 */
@Test(timeout=10000) public void testThrottling(){
  LOG.info("testThrottling");
  ReplicationThrottler throttler1=new ReplicationThrottler(100);
  ReplicationThrottler throttler2=new ReplicationThrottler(10);
  long ticks1=throttler1.getNextSleepInterval(1000);
  long ticks2=throttler2.getNextSleepInterval(1000);
  assertEquals(0,ticks1);
  assertEquals(0,ticks2);
  throttler1.addPushSize(1000);
  throttler2.addPushSize(1000);
  ticks1=throttler1.getNextSleepInterval(5);
  ticks2=throttler2.getNextSleepInterval(5);
  if (ticks1 != 1000 && ticks1 != 999) {
    assertTrue(ticks1 >= 750 && ticks1 <= 1000);
  }
  if (ticks2 != 10000 && ticks2 != 9999) {
    assertTrue(ticks1 >= 7500 && ticks1 <= 10000);
  }
  throttler1.resetStartTick();
  throttler2.resetStartTick();
  throttler1.addPushSize(5);
  throttler2.addPushSize(5);
  ticks1=throttler1.getNextSleepInterval(45);
  ticks2=throttler2.getNextSleepInterval(45);
  assertTrue(ticks1 == 0);
  if (ticks2 != 100 && ticks2 != 99) {
    assertTrue(ticks1 >= 75 && ticks1 <= 100);
  }
  throttler2.resetStartTick();
  throttler1.addPushSize(45);
  throttler2.addPushSize(45);
  ticks1=throttler1.getNextSleepInterval(60);
  ticks2=throttler2.getNextSleepInterval(60);
  if (ticks1 != 100 && ticks1 != 99) {
    assertTrue(ticks1 >= 75 && ticks1 <= 100);
  }
  if (ticks2 != 500 && ticks2 != 499) {
    assertTrue(ticks1 >= 375 && ticks1 <= 500);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestReplicationWALReaderManager </h4><pre class="type-9 type-10 type-11 type-7 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Path path=pathWatcher.currentPath;
  assertEquals(0,logManager.getPosition());
  appendToLog();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  WAL.Entry entry=logManager.readNextAndSetPosition();
  assertNotNull(entry);
  entry=logManager.readNextAndSetPosition();
  assertNull(entry);
  logManager.closeReader();
  long oldPos=logManager.getPosition();
  appendToLog();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  entry=logManager.readNextAndSetPosition();
  assertNotEquals(oldPos,logManager.getPosition());
  assertNotNull(entry);
  logManager.closeReader();
  oldPos=logManager.getPosition();
  log.rollWriter();
  assertNotNull(logManager.openReader(path));
  logManager.seek();
  entry=logManager.readNextAndSetPosition();
  assertEquals(oldPos,logManager.getPosition());
  assertNull(entry);
  logManager.finishCurrentFile();
  path=pathWatcher.currentPath;
  for (int i=0; i < nbRows; i++) {
    appendToLogPlus(walEditKVs);
  }
  log.rollWriter();
  logManager.openReader(path);
  logManager.seek();
  for (int i=0; i < nbRows; i++) {
    WAL.Entry e=logManager.readNextAndSetPosition();
    if (e == null) {
      fail("Should have enough entries");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestGZIPResponseWrapper </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResetBuffer() throws IOException {
  when(response.isCommitted()).thenReturn(false);
  ServletOutputStream out=mock(ServletOutputStream.class);
  when(response.getOutputStream()).thenReturn(out);
  ServletOutputStream servletOutput=wrapper.getOutputStream();
  assertEquals(GZIPResponseStream.class,servletOutput.getClass());
  wrapper.resetBuffer();
  verify(response).setHeader("Content-Encoding",null);
  when(response.isCommitted()).thenReturn(true);
  servletOutput=wrapper.getOutputStream();
  assertEquals(out.getClass(),servletOutput.getClass());
  assertNotNull(wrapper.getWriter());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestGetAndPutResource </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSuffixGlobbingXML() throws IOException, JAXBException {
  String path="/" + TABLE + "/fakerow";
  CellSetModel cellSetModel=new CellSetModel();
  RowModel rowModel=new RowModel(ROW_1);
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_1),Bytes.toBytes(VALUE_1)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_2),Bytes.toBytes(VALUE_2)));
  cellSetModel.addRow(rowModel);
  rowModel=new RowModel(ROW_2);
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_1),Bytes.toBytes(VALUE_3)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_2),Bytes.toBytes(VALUE_4)));
  cellSetModel.addRow(rowModel);
  StringWriter writer=new StringWriter();
  xmlMarshaller.marshal(cellSetModel,writer);
  Response response=client.put(path,Constants.MIMETYPE_XML,Bytes.toBytes(writer.toString()));
  Thread.yield();
  response=client.get(path,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),404);
  StringBuilder query=new StringBuilder();
  query.append('/');
  query.append(TABLE);
  query.append('/');
  query.append("testrow*");
  query.append('/');
  query.append(COLUMN_1);
  response=client.get(query.toString(),Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  CellSetModel cellSet=(CellSetModel)xmlUnmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  List<RowModel> rows=cellSet.getRows();
  assertTrue(rows.size() == 2);
  for (  RowModel row : rows) {
    assertTrue(row.getCells().size() == 1);
    assertEquals(COLUMN_1,Bytes.toString(row.getCells().get(0).getColumn()));
  }
  response=deleteRow(TABLE,ROW_1);
  assertEquals(response.getCode(),200);
  response=deleteRow(TABLE,ROW_2);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLatestCellGetJSON() throws IOException, JAXBException {
  final String path="/" + TABLE + "/"+ ROW_4+ "/"+ COLUMN_1;
  CellSetModel cellSetModel=new CellSetModel();
  RowModel rowModel=new RowModel(ROW_4);
  CellModel cellOne=new CellModel(Bytes.toBytes(COLUMN_1),1L,Bytes.toBytes(VALUE_1));
  CellModel cellTwo=new CellModel(Bytes.toBytes(COLUMN_1),2L,Bytes.toBytes(VALUE_2));
  rowModel.addCell(cellOne);
  rowModel.addCell(cellTwo);
  cellSetModel.addRow(rowModel);
  String jsonString=jsonMapper.writeValueAsString(cellSetModel);
  Response response=client.put(path,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(response.getCode(),200);
  Thread.yield();
  response=client.get(path,Constants.MIMETYPE_JSON);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  CellSetModel cellSet=jsonMapper.readValue(response.getBody(),CellSetModel.class);
  assertTrue(cellSet.getRows().size() == 1);
  assertTrue(cellSet.getRows().get(0).getCells().size() == 1);
  CellModel cell=cellSet.getRows().get(0).getCells().get(0);
  assertEquals(VALUE_2,Bytes.toString(cell.getValue()));
  assertEquals(2L,cell.getTimestamp());
  response=deleteRow(TABLE,ROW_4);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleCellGetPutBinary() throws IOException {
  final String path="/" + TABLE + "/"+ ROW_3+ "/"+ COLUMN_1;
  final byte[] body=Bytes.toBytes(VALUE_3);
  Response response=client.put(path,Constants.MIMETYPE_BINARY,body);
  assertEquals(response.getCode(),200);
  Thread.yield();
  response=client.get(path,Constants.MIMETYPE_BINARY);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_BINARY,response.getHeader("content-type"));
  assertTrue(Bytes.equals(response.getBody(),body));
  boolean foundTimestampHeader=false;
  for (  Header header : response.getHeaders()) {
    if (header.getName().equals("X-Timestamp")) {
      foundTimestampHeader=true;
      break;
    }
  }
  assertTrue(foundTimestampHeader);
  response=deleteRow(TABLE,ROW_3);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColumnGetXML() throws Exception {
  String path="/" + TABLE + "/fakerow";
  CellSetModel cellSetModel=new CellSetModel();
  RowModel rowModel=new RowModel(ROW_1);
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_1),Bytes.toBytes(VALUE_1)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_2),Bytes.toBytes(VALUE_2)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_3),Bytes.toBytes(VALUE_2)));
  cellSetModel.addRow(rowModel);
  StringWriter writer=new StringWriter();
  xmlMarshaller.marshal(cellSetModel,writer);
  Response response=client.put(path,Constants.MIMETYPE_XML,Bytes.toBytes(writer.toString()));
  Thread.yield();
  response=client.get(path,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),404);
  path="/" + TABLE + "/"+ ROW_1+ "/"+ COLUMN_1+ ","+ COLUMN_2+ ","+ COLUMN_3;
  response=client.get(path,Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  CellSetModel cellSet=(CellSetModel)xmlUnmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  assertTrue(cellSet.getRows().size() == 1);
  assertTrue(cellSet.getRows().get(0).getCells().size() == 3);
  List<CellModel> cells=cellSet.getRows().get(0).getCells();
  assertTrue(containsCellModel(cells,COLUMN_1,VALUE_1));
  assertTrue(containsCellModel(cells,COLUMN_2,VALUE_2));
  assertTrue(containsCellModel(cells,COLUMN_3,VALUE_2));
  response=deleteRow(TABLE,ROW_1);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSuffixGlobbingXMLWithNewScanner() throws IOException, JAXBException {
  String path="/" + TABLE + "/fakerow";
  CellSetModel cellSetModel=new CellSetModel();
  RowModel rowModel=new RowModel(ROW_1);
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_1),Bytes.toBytes(VALUE_1)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_2),Bytes.toBytes(VALUE_2)));
  cellSetModel.addRow(rowModel);
  rowModel=new RowModel(ROW_2);
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_1),Bytes.toBytes(VALUE_3)));
  rowModel.addCell(new CellModel(Bytes.toBytes(COLUMN_2),Bytes.toBytes(VALUE_4)));
  cellSetModel.addRow(rowModel);
  StringWriter writer=new StringWriter();
  xmlMarshaller.marshal(cellSetModel,writer);
  Response response=client.put(path,Constants.MIMETYPE_XML,Bytes.toBytes(writer.toString()));
  Thread.yield();
  response=client.get(path,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),404);
  StringBuilder query=new StringBuilder();
  query.append('/');
  query.append(TABLE);
  query.append('/');
  query.append("testrow*");
  response=client.get(query.toString(),Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  CellSetModel cellSet=(CellSetModel)xmlUnmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  assertTrue(cellSet.getRows().size() == 2);
  response=deleteRow(TABLE,ROW_1);
  assertEquals(response.getCode(),200);
  response=deleteRow(TABLE,ROW_2);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestGzipFilter </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorNotGzipped() throws Exception {
  Header[] headers=new Header[2];
  headers[0]=new Header("Accept",Constants.MIMETYPE_BINARY);
  headers[1]=new Header("Accept-Encoding","gzip");
  Response response=client.get("/" + TABLE + "/"+ ROW_1+ "/"+ COLUMN_2,headers);
  assertEquals(response.getCode(),404);
  String contentEncoding=response.getHeader("Content-Encoding");
  assertTrue(contentEncoding == null || !contentEncoding.contains("gzip"));
  response=client.get("/" + TABLE,headers);
  assertEquals(response.getCode(),405);
  contentEncoding=response.getHeader("Content-Encoding");
  assertTrue(contentEncoding == null || !contentEncoding.contains("gzip"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGzipFilter() throws Exception {
  String path="/" + TABLE + "/"+ ROW_1+ "/"+ COLUMN_1;
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  GZIPOutputStream os=new GZIPOutputStream(bos);
  os.write(VALUE_1);
  os.close();
  byte[] value_1_gzip=bos.toByteArray();
  Header[] headers=new Header[2];
  headers[0]=new Header("Content-Type",Constants.MIMETYPE_BINARY);
  headers[1]=new Header("Content-Encoding","gzip");
  Response response=client.put(path,headers,value_1_gzip);
  assertEquals(response.getCode(),200);
  Table table=TEST_UTIL.getConnection().getTable(TABLE);
  Get get=new Get(Bytes.toBytes(ROW_1));
  get.addColumn(Bytes.toBytes(CFA),Bytes.toBytes("1"));
  Result result=table.get(get);
  byte[] value=result.getValue(Bytes.toBytes(CFA),Bytes.toBytes("1"));
  assertNotNull(value);
  assertTrue(Bytes.equals(value,VALUE_1));
  headers[0]=new Header("Accept",Constants.MIMETYPE_BINARY);
  headers[1]=new Header("Accept-Encoding","gzip");
  response=client.get(path,headers);
  assertEquals(response.getCode(),200);
  ByteArrayInputStream bis=new ByteArrayInputStream(response.getBody());
  GZIPInputStream is=new GZIPInputStream(bis);
  value=new byte[VALUE_1.length];
  is.read(value,0,VALUE_1.length);
  assertTrue(Bytes.equals(value,VALUE_1));
  is.close();
  table.close();
  testScannerResultCodes();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestMetricsRESTSourceImpl </h4><pre class="type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void ensureCompatRegistered() throws Exception {
  assertNotNull(CompatibilitySingletonFactory.getInstance(MetricsRESTSource.class));
  assertTrue(CompatibilitySingletonFactory.getInstance(MetricsRESTSource.class) instanceof MetricsRESTSourceImpl);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestNamespacesInstanceResource </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamespaceCreateAndDeletePBAndNoBody() throws IOException, JAXBException {
  String namespacePath3="/namespaces/" + NAMESPACE3;
  String namespacePath4="/namespaces/" + NAMESPACE4;
  NamespacesInstanceModel model3;
  NamespacesInstanceModel model4;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertNull(findNamespace(admin,NAMESPACE3));
  assertNull(findNamespace(admin,NAMESPACE4));
  model3=testNamespacesInstanceModel.buildTestModel(NAMESPACE3,NAMESPACE3_PROPS);
  testNamespacesInstanceModel.checkModel(model3,NAMESPACE3,NAMESPACE3_PROPS);
  model4=testNamespacesInstanceModel.buildTestModel(NAMESPACE4,NAMESPACE4_PROPS);
  testNamespacesInstanceModel.checkModel(model4,NAMESPACE4,NAMESPACE4_PROPS);
  response=client.put(namespacePath3,Constants.MIMETYPE_BINARY,new byte[]{});
  assertEquals(403,response.getCode());
  response=client.put(namespacePath4,Constants.MIMETYPE_PROTOBUF,model4.createProtobufOutput());
  assertEquals(403,response.getCode());
  conf.set("hbase.rest.readonly","true");
  response=client.post(namespacePath3,Constants.MIMETYPE_BINARY,new byte[]{});
  assertEquals(403,response.getCode());
  response=client.put(namespacePath4,Constants.MIMETYPE_PROTOBUF,model4.createProtobufOutput());
  assertEquals(403,response.getCode());
  NamespaceDescriptor nd3=findNamespace(admin,NAMESPACE3);
  NamespaceDescriptor nd4=findNamespace(admin,NAMESPACE4);
  assertNull(nd3);
  assertNull(nd4);
  conf.set("hbase.rest.readonly","false");
  response=client.post(namespacePath3,Constants.MIMETYPE_BINARY,new byte[]{});
  assertEquals(201,response.getCode());
  response=client.post(namespacePath4,Constants.MIMETYPE_PROTOBUF,model4.createProtobufOutput());
  assertEquals(201,response.getCode());
  nd3=findNamespace(admin,NAMESPACE3);
  nd4=findNamespace(admin,NAMESPACE4);
  assertNotNull(nd3);
  assertNotNull(nd4);
  checkNamespaceProperties(nd3,new HashMap<String,String>());
  checkNamespaceProperties(nd4,NAMESPACE4_PROPS);
  response=client.post(namespacePath3,Constants.MIMETYPE_BINARY,new byte[]{});
  assertEquals(403,response.getCode());
  response=client.post(namespacePath4,Constants.MIMETYPE_PROTOBUF,model4.createProtobufOutput());
  assertEquals(403,response.getCode());
  conf.set("hbase.rest.readonly","true");
  response=client.delete(namespacePath3);
  assertEquals(403,response.getCode());
  response=client.delete(namespacePath4);
  assertEquals(403,response.getCode());
  nd3=findNamespace(admin,NAMESPACE3);
  nd4=findNamespace(admin,NAMESPACE4);
  assertNotNull(nd3);
  assertNotNull(nd4);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(namespacePath3);
  assertEquals(200,response.getCode());
  response=client.delete(namespacePath4);
  assertEquals(200,response.getCode());
  nd3=findNamespace(admin,NAMESPACE3);
  nd4=findNamespace(admin,NAMESPACE4);
  assertNull(nd3);
  assertNull(nd4);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidNamespacePostsAndPuts() throws IOException, JAXBException {
  String namespacePath1="/namespaces/" + NAMESPACE1;
  String namespacePath2="/namespaces/" + NAMESPACE2;
  String namespacePath3="/namespaces/" + NAMESPACE3;
  NamespacesInstanceModel model1;
  NamespacesInstanceModel model2;
  NamespacesInstanceModel model3;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertNull(findNamespace(admin,NAMESPACE1));
  assertNull(findNamespace(admin,NAMESPACE2));
  assertNull(findNamespace(admin,NAMESPACE3));
  model1=testNamespacesInstanceModel.buildTestModel(NAMESPACE1,NAMESPACE1_PROPS);
  testNamespacesInstanceModel.checkModel(model1,NAMESPACE1,NAMESPACE1_PROPS);
  model2=testNamespacesInstanceModel.buildTestModel(NAMESPACE2,NAMESPACE2_PROPS);
  testNamespacesInstanceModel.checkModel(model2,NAMESPACE2,NAMESPACE2_PROPS);
  model3=testNamespacesInstanceModel.buildTestModel(NAMESPACE3,NAMESPACE3_PROPS);
  testNamespacesInstanceModel.checkModel(model3,NAMESPACE3,NAMESPACE3_PROPS);
  response=client.post(namespacePath1,Constants.MIMETYPE_JSON,toXML(model1));
  assertEquals(500,response.getCode());
  String jsonString=jsonMapper.writeValueAsString(model2);
  response=client.put(namespacePath2,Constants.MIMETYPE_XML,Bytes.toBytes(jsonString));
  assertEquals(400,response.getCode());
  response=client.post(namespacePath3,Constants.MIMETYPE_PROTOBUF,toXML(model1));
  assertEquals(500,response.getCode());
  NamespaceDescriptor nd1=findNamespace(admin,NAMESPACE1);
  NamespaceDescriptor nd2=findNamespace(admin,NAMESPACE2);
  NamespaceDescriptor nd3=findNamespace(admin,NAMESPACE3);
  assertNull(nd1);
  assertNull(nd2);
  assertNull(nd3);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamespaceCreateAndDeleteXMLAndJSON() throws IOException, JAXBException {
  String namespacePath1="/namespaces/" + NAMESPACE1;
  String namespacePath2="/namespaces/" + NAMESPACE2;
  NamespacesInstanceModel model1;
  NamespacesInstanceModel model2;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertNull(findNamespace(admin,NAMESPACE1));
  assertNull(findNamespace(admin,NAMESPACE2));
  model1=testNamespacesInstanceModel.buildTestModel(NAMESPACE1,NAMESPACE1_PROPS);
  testNamespacesInstanceModel.checkModel(model1,NAMESPACE1,NAMESPACE1_PROPS);
  model2=testNamespacesInstanceModel.buildTestModel(NAMESPACE2,NAMESPACE2_PROPS);
  testNamespacesInstanceModel.checkModel(model2,NAMESPACE2,NAMESPACE2_PROPS);
  response=client.put(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(403,response.getCode());
  String jsonString=jsonMapper.writeValueAsString(model2);
  response=client.put(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(403,response.getCode());
  conf.set("hbase.rest.readonly","true");
  response=client.post(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(403,response.getCode());
  jsonString=jsonMapper.writeValueAsString(model2);
  response=client.post(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(403,response.getCode());
  NamespaceDescriptor nd1=findNamespace(admin,NAMESPACE1);
  NamespaceDescriptor nd2=findNamespace(admin,NAMESPACE2);
  assertNull(nd1);
  assertNull(nd2);
  conf.set("hbase.rest.readonly","false");
  response=client.post(namespacePath1,Constants.MIMETYPE_XML,toXML(model1));
  assertEquals(201,response.getCode());
  jsonString=jsonMapper.writeValueAsString(model2);
  response=client.post(namespacePath2,Constants.MIMETYPE_JSON,Bytes.toBytes(jsonString));
  assertEquals(201,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNotNull(nd1);
  assertNotNull(nd2);
  checkNamespaceProperties(nd1,NAMESPACE1_PROPS);
  checkNamespaceProperties(nd1,NAMESPACE1_PROPS);
  conf.set("hbase.rest.readonly","true");
  response=client.delete(namespacePath1);
  assertEquals(403,response.getCode());
  response=client.delete(namespacePath2);
  assertEquals(403,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNotNull(nd1);
  assertNotNull(nd2);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(namespacePath1);
  assertEquals(200,response.getCode());
  response=client.delete(namespacePath2);
  assertEquals(200,response.getCode());
  nd1=findNamespace(admin,NAMESPACE1);
  nd2=findNamespace(admin,NAMESPACE2);
  assertNull(nd1);
  assertNull(nd2);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCannotDeleteDefaultAndHbaseNamespaces() throws IOException {
  String defaultPath="/namespaces/default";
  String hbasePath="/namespaces/hbase";
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertNotNull(findNamespace(admin,"default"));
  assertNotNull(findNamespace(admin,"hbase"));
  response=client.delete(defaultPath);
  assertEquals(503,response.getCode());
  response=client.delete(hbasePath);
  assertEquals(503,response.getCode());
  assertNotNull(findNamespace(admin,"default"));
  assertNotNull(findNamespace(admin,"hbase"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestNamespacesResource </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamespaceListPBandDefault() throws IOException, JAXBException {
  String schemaPath="/namespaces/";
  NamespacesModel model;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertFalse(doesNamespaceExist(admin,NAMESPACE1));
  model=testNamespacesModel.buildTestModel();
  testNamespacesModel.checkModel(model);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  createNamespaceViaAdmin(admin,NAMESPACE1);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  createNamespaceViaAdmin(admin,NAMESPACE2);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,NAMESPACE2,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  admin.deleteNamespace(NAMESPACE1);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(200,response.getCode());
  model.getObjectFromMessage(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE2,"hbase","default");
  response=client.get(schemaPath);
  assertEquals(200,response.getCode());
  admin.deleteNamespace(NAMESPACE2);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamespaceListXMLandJSON() throws IOException, JAXBException {
  String namespacePath="/namespaces/";
  NamespacesModel model;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertFalse(doesNamespaceExist(admin,NAMESPACE1));
  model=testNamespacesModel.buildTestModel();
  testNamespacesModel.checkModel(model);
  response=client.get(namespacePath,Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  model=fromXML(response.getBody());
  testNamespacesModel.checkModel(model,"hbase","default");
  response=client.get(namespacePath,Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  model=testNamespacesModel.fromJSON(Bytes.toString(response.getBody()));
  testNamespacesModel.checkModel(model,"hbase","default");
  createNamespaceViaAdmin(admin,NAMESPACE1);
  response=client.get(namespacePath,Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  model=fromXML(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,"hbase","default");
  response=client.get(namespacePath,Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  model=testNamespacesModel.fromJSON(Bytes.toString(response.getBody()));
  testNamespacesModel.checkModel(model,NAMESPACE1,"hbase","default");
  createNamespaceViaAdmin(admin,NAMESPACE2);
  response=client.get(namespacePath,Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  model=fromXML(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE1,NAMESPACE2,"hbase","default");
  response=client.get(namespacePath,Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  model=testNamespacesModel.fromJSON(Bytes.toString(response.getBody()));
  testNamespacesModel.checkModel(model,NAMESPACE1,NAMESPACE2,"hbase","default");
  admin.deleteNamespace(NAMESPACE1);
  response=client.get(namespacePath,Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  model=fromXML(response.getBody());
  testNamespacesModel.checkModel(model,NAMESPACE2,"hbase","default");
  response=client.get(namespacePath,Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  model=testNamespacesModel.fromJSON(Bytes.toString(response.getBody()));
  testNamespacesModel.checkModel(model,NAMESPACE2,"hbase","default");
  admin.deleteNamespace(NAMESPACE2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestScannerResource </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScannerXML() throws IOException, JAXBException {
  final int BATCH_SIZE=5;
  ScannerModel model=new ScannerModel();
  model.setBatch(BATCH_SIZE);
  model.addColumn(Bytes.toBytes(COLUMN_1));
  StringWriter writer=new StringWriter();
  marshaller.marshal(model,writer);
  byte[] body=Bytes.toBytes(writer.toString());
  conf.set("hbase.rest.readonly","true");
  Response response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_XML,body);
  assertEquals(response.getCode(),403);
  String scannerURI=response.getLocation();
  assertNull(scannerURI);
  conf.set("hbase.rest.readonly","false");
  response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_XML,body);
  assertEquals(response.getCode(),201);
  scannerURI=response.getLocation();
  assertNotNull(scannerURI);
  response=client.get(scannerURI,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  CellSetModel cellSet=(CellSetModel)unmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  assertEquals(countCellSet(cellSet),BATCH_SIZE);
  conf.set("hbase.rest.readonly","true");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),403);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScannerBinary() throws IOException {
  ScannerModel model=new ScannerModel();
  model.setBatch(1);
  model.addColumn(Bytes.toBytes(COLUMN_1));
  conf.set("hbase.rest.readonly","true");
  Response response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),403);
  String scannerURI=response.getLocation();
  assertNull(scannerURI);
  conf.set("hbase.rest.readonly","false");
  response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),201);
  scannerURI=response.getLocation();
  assertNotNull(scannerURI);
  response=client.get(scannerURI,Constants.MIMETYPE_BINARY);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_BINARY,response.getHeader("content-type"));
  assertTrue(response.getBody().length > 0);
  boolean foundRowHeader=false, foundColumnHeader=false, foundTimestampHeader=false;
  for (  Header header : response.getHeaders()) {
    if (header.getName().equals("X-Row")) {
      foundRowHeader=true;
    }
 else     if (header.getName().equals("X-Column")) {
      foundColumnHeader=true;
    }
 else     if (header.getName().equals("X-Timestamp")) {
      foundTimestampHeader=true;
    }
  }
  assertTrue(foundRowHeader);
  assertTrue(foundColumnHeader);
  assertTrue(foundTimestampHeader);
  conf.set("hbase.rest.readonly","true");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),403);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScannerPB() throws IOException {
  final int BATCH_SIZE=10;
  ScannerModel model=new ScannerModel();
  model.setBatch(BATCH_SIZE);
  model.addColumn(Bytes.toBytes(COLUMN_1));
  conf.set("hbase.rest.readonly","true");
  Response response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),403);
  String scannerURI=response.getLocation();
  assertNull(scannerURI);
  conf.set("hbase.rest.readonly","false");
  response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),201);
  scannerURI=response.getLocation();
  assertNotNull(scannerURI);
  response=client.get(scannerURI,Constants.MIMETYPE_PROTOBUF);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_PROTOBUF,response.getHeader("content-type"));
  CellSetModel cellSet=new CellSetModel();
  cellSet.getObjectFromMessage(response.getBody());
  assertEquals(countCellSet(cellSet),BATCH_SIZE);
  conf.set("hbase.rest.readonly","true");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),403);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(scannerURI);
  assertEquals(response.getCode(),200);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestScannersWithLabels </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScannerXMLWithLabelsThatReceivesData() throws IOException, JAXBException {
  ScannerModel model=new ScannerModel();
  model.setBatch(5);
  model.addColumn(Bytes.toBytes(COLUMN_1));
  model.addLabel(SECRET);
  StringWriter writer=new StringWriter();
  marshaller.marshal(model,writer);
  byte[] body=Bytes.toBytes(writer.toString());
  conf.set("hbase.rest.readonly","false");
  Response response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_XML,body);
  assertEquals(response.getCode(),201);
  String scannerURI=response.getLocation();
  assertNotNull(scannerURI);
  response=client.get(scannerURI,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  CellSetModel cellSet=(CellSetModel)unmarshaller.unmarshal(new ByteArrayInputStream(response.getBody()));
  assertEquals(countCellSet(cellSet),5);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleScannerXMLWithLabelsThatReceivesNoData() throws IOException, JAXBException {
  final int BATCH_SIZE=5;
  ScannerModel model=new ScannerModel();
  model.setBatch(BATCH_SIZE);
  model.addColumn(Bytes.toBytes(COLUMN_1));
  model.addLabel(PUBLIC);
  StringWriter writer=new StringWriter();
  marshaller.marshal(model,writer);
  byte[] body=Bytes.toBytes(writer.toString());
  conf.set("hbase.rest.readonly","false");
  Response response=client.put("/" + TABLE + "/scanner",Constants.MIMETYPE_XML,body);
  assertEquals(response.getCode(),201);
  String scannerURI=response.getLocation();
  assertNotNull(scannerURI);
  response=client.get(scannerURI,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),204);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestSchemaResource </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateAndDeletePB() throws IOException, JAXBException {
  String schemaPath="/" + TABLE2 + "/schema";
  TableSchemaModel model;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertFalse(admin.tableExists(TableName.valueOf(TABLE2)));
  model=testTableSchemaModel.buildTestModel(TABLE2);
  testTableSchemaModel.checkModel(model,TABLE2);
  response=client.put(schemaPath,Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),201);
  conf.set("hbase.rest.readonly","true");
  response=client.put(schemaPath,Constants.MIMETYPE_PROTOBUF,model.createProtobufOutput());
  assertEquals(response.getCode(),403);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_PROTOBUF,response.getHeader("content-type"));
  model=new TableSchemaModel();
  model.getObjectFromMessage(response.getBody());
  testTableSchemaModel.checkModel(model,TABLE2);
  response=client.get(schemaPath,Constants.MIMETYPE_PROTOBUF_IETF);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_PROTOBUF_IETF,response.getHeader("content-type"));
  model=new TableSchemaModel();
  model.getObjectFromMessage(response.getBody());
  testTableSchemaModel.checkModel(model,TABLE2);
  response=client.delete(schemaPath);
  assertEquals(response.getCode(),403);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(schemaPath);
  assertEquals(response.getCode(),200);
  assertFalse(admin.tableExists(TableName.valueOf(TABLE2)));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateAndDeleteXML() throws IOException, JAXBException {
  String schemaPath="/" + TABLE1 + "/schema";
  TableSchemaModel model;
  Response response;
  Admin admin=TEST_UTIL.getHBaseAdmin();
  assertFalse(admin.tableExists(TableName.valueOf(TABLE1)));
  model=testTableSchemaModel.buildTestModel(TABLE1);
  testTableSchemaModel.checkModel(model,TABLE1);
  response=client.put(schemaPath,Constants.MIMETYPE_XML,toXML(model));
  assertEquals(response.getCode(),201);
  conf.set("hbase.rest.readonly","true");
  response=client.put(schemaPath,Constants.MIMETYPE_XML,toXML(model));
  assertEquals(response.getCode(),403);
  response=client.get(schemaPath,Constants.MIMETYPE_XML);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  model=fromXML(response.getBody());
  testTableSchemaModel.checkModel(model,TABLE1);
  response=client.get(schemaPath,Constants.MIMETYPE_JSON);
  assertEquals(response.getCode(),200);
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  model=testTableSchemaModel.fromJSON(Bytes.toString(response.getBody()));
  testTableSchemaModel.checkModel(model,TABLE1);
  response=client.delete(schemaPath);
  assertEquals(response.getCode(),403);
  conf.set("hbase.rest.readonly","false");
  response=client.delete(schemaPath);
  assertEquals(response.getCode(),200);
  assertFalse(admin.tableExists(TableName.valueOf(TABLE1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestTableScan </h4><pre class="type-4 type-9 type-10 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStreamingJSON() throws Exception {
  StringBuilder builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_1);
  builder.append("&");
  builder.append(Constants.SCAN_LIMIT + "=20");
  Response response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  ObjectMapper mapper=new JacksonProvider().locateMapper(CellSetModel.class,MediaType.APPLICATION_JSON_TYPE);
  CellSetModel model=mapper.readValue(response.getStream(),CellSetModel.class);
  int count=TestScannerResource.countCellSet(model);
  assertEquals(20,count);
  checkRowsNotNull(model);
  builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_2);
  response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
  model=mapper.readValue(response.getStream(),CellSetModel.class);
  count=TestScannerResource.countCellSet(model);
  assertEquals(expectedRows2,count);
  checkRowsNotNull(model);
  builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_1);
  builder.append("&");
  builder.append(Constants.SCAN_START_ROW + "=aaa");
  builder.append("&");
  builder.append(Constants.SCAN_END_ROW + "=aay");
  response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_JSON);
  assertEquals(200,response.getCode());
  count=0;
  JsonFactory jfactory=new JsonFactory(mapper);
  JsonParser jParser=jfactory.createJsonParser(response.getStream());
  boolean found=false;
  while (jParser.nextToken() != JsonToken.END_OBJECT) {
    if (jParser.getCurrentToken() == JsonToken.START_OBJECT && found) {
      RowModel row=jParser.readValueAs(RowModel.class);
      assertNotNull(row.getKey());
      for (int i=0; i < row.getCells().size(); i++) {
        if (count == 0) {
          assertEquals("aaa",Bytes.toString(row.getKey()));
        }
        if (count == 23) {
          assertEquals("aax",Bytes.toString(row.getKey()));
        }
        count++;
      }
      jParser.skipChildren();
    }
 else {
      found=jParser.getCurrentToken() == JsonToken.START_ARRAY;
    }
  }
  assertEquals(24,count);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * An example to scan using listener in unmarshaller for XML.
 * @throws Exception the exception
 */
@Test public void testScanUsingListenerUnmarshallerXML() throws Exception {
  StringBuilder builder=new StringBuilder();
  builder.append("/*");
  builder.append("?");
  builder.append(Constants.SCAN_COLUMN + "=" + COLUMN_1);
  builder.append("&");
  builder.append(Constants.SCAN_LIMIT + "=10");
  Response response=client.get("/" + TABLE + builder.toString(),Constants.MIMETYPE_XML);
  assertEquals(200,response.getCode());
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  JAXBContext context=JAXBContext.newInstance(ClientSideCellSetModel.class,RowModel.class,CellModel.class);
  Unmarshaller unmarshaller=context.createUnmarshaller();
  final ClientSideCellSetModel.Listener listener=new ClientSideCellSetModel.Listener(){
    @Override public void handleRowModel(    ClientSideCellSetModel helper,    RowModel row){
      assertTrue(row.getKey() != null);
      assertTrue(row.getCells().size() > 0);
    }
  }
;
  unmarshaller.setListener(new Unmarshaller.Listener(){
    public void beforeUnmarshal(    Object target,    Object parent){
      if (target instanceof ClientSideCellSetModel) {
        ((ClientSideCellSetModel)target).setCellSetModelListener(listener);
      }
    }
    public void afterUnmarshal(    Object target,    Object parent){
      if (target instanceof ClientSideCellSetModel) {
        ((ClientSideCellSetModel)target).setCellSetModelListener(null);
      }
    }
  }
);
  SAXParserFactory factory=SAXParserFactory.newInstance();
  factory.setNamespaceAware(true);
  XMLReader reader=factory.newSAXParser().getXMLReader();
  reader.setContentHandler(unmarshaller.getUnmarshallerHandler());
  assertFalse(ClientSideCellSetModel.listenerInvoked);
  reader.parse(new InputSource(response.getStream()));
  assertTrue(ClientSideCellSetModel.listenerInvoked);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestVersionResource </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStorageClusterVersionXML() throws IOException, JAXBException {
  Response response=client.get("/version/cluster",Constants.MIMETYPE_XML);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  StorageClusterVersionModel clusterVersionModel=(StorageClusterVersionModel)context.createUnmarshaller().unmarshal(new ByteArrayInputStream(response.getBody()));
  assertNotNull(clusterVersionModel);
  assertNotNull(clusterVersionModel.getVersion());
  LOG.info("success retrieving storage cluster version as XML");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStargateVersionJSON() throws IOException {
  Response response=client.get("/version",Constants.MIMETYPE_JSON);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStargateVersionText() throws IOException {
  Response response=client.get("/version",Constants.MIMETYPE_TEXT);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_TEXT,response.getHeader("content-type"));
  String body=Bytes.toString(response.getBody());
  assertTrue(body.length() > 0);
  assertTrue(body.contains(RESTServlet.VERSION_STRING));
  assertTrue(body.contains(System.getProperty("java.vm.vendor")));
  assertTrue(body.contains(System.getProperty("java.version")));
  assertTrue(body.contains(System.getProperty("java.vm.version")));
  assertTrue(body.contains(System.getProperty("os.name")));
  assertTrue(body.contains(System.getProperty("os.version")));
  assertTrue(body.contains(System.getProperty("os.arch")));
  assertTrue(body.contains(ServletContainer.class.getPackage().getImplementationVersion()));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStargateVersionXML() throws IOException, JAXBException {
  Response response=client.get("/version",Constants.MIMETYPE_XML);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_XML,response.getHeader("content-type"));
  VersionModel model=(VersionModel)context.createUnmarshaller().unmarshal(new ByteArrayInputStream(response.getBody()));
  validate(model);
  LOG.info("success retrieving Stargate version as XML");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStorageClusterVersionText() throws IOException {
  Response response=client.get("/version/cluster",Constants.MIMETYPE_TEXT);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_TEXT,response.getHeader("content-type"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStargateVersionPB() throws IOException {
  Response response=client.get("/version",Constants.MIMETYPE_PROTOBUF);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_PROTOBUF,response.getHeader("content-type"));
  VersionModel model=new VersionModel();
  model.getObjectFromMessage(response.getBody());
  validate(model);
  response=client.get("/version",Constants.MIMETYPE_PROTOBUF_IETF);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_PROTOBUF_IETF,response.getHeader("content-type"));
  model=new VersionModel();
  model.getObjectFromMessage(response.getBody());
  validate(model);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doTestGetStorageClusterVersionJSON() throws IOException {
  Response response=client.get("/version/cluster",Constants.MIMETYPE_JSON);
  assertTrue(response.getCode() == 200);
  assertEquals(Constants.MIMETYPE_JSON,response.getHeader("content-type"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.client.TestRemoteTable </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a some methods of class Response.
 */
@Test public void testResponse(){
  Response response=new Response(200);
  assertEquals(200,response.getCode());
  Header[] headers=new Header[2];
  headers[0]=new Header("header1","value1");
  headers[1]=new Header("header2","value2");
  response=new Response(200,headers);
  assertEquals("value1",response.getHeader("header1"));
  assertFalse(response.hasBody());
  response.setCode(404);
  assertEquals(404,response.getCode());
  headers=new Header[2];
  headers[0]=new Header("header1","value1.1");
  headers[1]=new Header("header2","value2");
  response.setHeaders(headers);
  assertEquals("value1.1",response.getHeader("header1"));
  response.setBody(Bytes.toBytes("body"));
  assertTrue(response.hasBody());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test RemoteHable.Scanner.iterator method  
 */
@Test public void testIteratorScaner() throws IOException {
  List<Put> puts=new ArrayList<Put>();
  Put put=new Put(ROW_1);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_2);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_3);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_4);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  remoteTable.put(puts);
  ResultScanner scanner=remoteTable.getScanner(new Scan());
  Iterator<Result> iterator=scanner.iterator();
  assertTrue(iterator.hasNext());
  int counter=0;
  while (iterator.hasNext()) {
    iterator.next();
    counter++;
  }
  assertEquals(4,counter);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPut() throws IOException {
  Put put=new Put(ROW_3);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  remoteTable.put(put);
  Get get=new Get(ROW_3);
  get.addFamily(COLUMN_1);
  Result result=remoteTable.get(get);
  byte[] value=result.getValue(COLUMN_1,QUALIFIER_1);
  assertNotNull(value);
  assertTrue(Bytes.equals(VALUE_1,value));
  List<Put> puts=new ArrayList<Put>();
  put=new Put(ROW_3);
  put.addColumn(COLUMN_2,QUALIFIER_2,VALUE_2);
  puts.add(put);
  put=new Put(ROW_4);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_4);
  put.addColumn(COLUMN_2,QUALIFIER_2,VALUE_2);
  puts.add(put);
  remoteTable.put(puts);
  get=new Get(ROW_3);
  get.addFamily(COLUMN_2);
  result=remoteTable.get(get);
  value=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value);
  assertTrue(Bytes.equals(VALUE_2,value));
  get=new Get(ROW_4);
  result=remoteTable.get(get);
  value=result.getValue(COLUMN_1,QUALIFIER_1);
  assertNotNull(value);
  assertTrue(Bytes.equals(VALUE_1,value));
  value=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value);
  assertTrue(Bytes.equals(VALUE_2,value));
  assertTrue(Bytes.equals(Bytes.toBytes("TestRemoteTable"),remoteTable.getTableName()));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test RemoteHTable.Scanner 
 */
@Test public void testScanner() throws IOException {
  List<Put> puts=new ArrayList<Put>();
  Put put=new Put(ROW_1);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_2);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_3);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  put=new Put(ROW_4);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  puts.add(put);
  remoteTable.put(puts);
  ResultScanner scanner=remoteTable.getScanner(new Scan());
  Result[] results=scanner.next(1);
  assertNotNull(results);
  assertEquals(1,results.length);
  assertTrue(Bytes.equals(ROW_1,results[0].getRow()));
  Result result=scanner.next();
  assertNotNull(result);
  assertTrue(Bytes.equals(ROW_2,result.getRow()));
  results=scanner.next(2);
  assertNotNull(results);
  assertEquals(2,results.length);
  assertTrue(Bytes.equals(ROW_3,results[0].getRow()));
  assertTrue(Bytes.equals(ROW_4,results[1].getRow()));
  results=scanner.next(1);
  assertNull(results);
  scanner.close();
  scanner=remoteTable.getScanner(COLUMN_1);
  results=scanner.next(4);
  assertNotNull(results);
  assertEquals(4,results.length);
  assertTrue(Bytes.equals(ROW_1,results[0].getRow()));
  assertTrue(Bytes.equals(ROW_2,results[1].getRow()));
  assertTrue(Bytes.equals(ROW_3,results[2].getRow()));
  assertTrue(Bytes.equals(ROW_4,results[3].getRow()));
  scanner.close();
  scanner=remoteTable.getScanner(COLUMN_1,QUALIFIER_1);
  results=scanner.next(4);
  assertNotNull(results);
  assertEquals(4,results.length);
  assertTrue(Bytes.equals(ROW_1,results[0].getRow()));
  assertTrue(Bytes.equals(ROW_2,results[1].getRow()));
  assertTrue(Bytes.equals(ROW_3,results[2].getRow()));
  assertTrue(Bytes.equals(ROW_4,results[3].getRow()));
  scanner.close();
  assertTrue(remoteTable.isAutoFlush());
}

</code></pre>

<br>
<pre class="type-10 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet() throws IOException {
  Get get=new Get(ROW_1);
  Result result=remoteTable.get(get);
  byte[] value1=result.getValue(COLUMN_1,QUALIFIER_1);
  byte[] value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  get=new Get(ROW_1);
  get.addFamily(COLUMN_3);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNull(value1);
  assertNull(value2);
  get=new Get(ROW_1);
  get.addColumn(COLUMN_1,QUALIFIER_1);
  get.addColumn(COLUMN_2,QUALIFIER_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  get=new Get(ROW_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_2,value1));
  assertNotNull(value2);
  assertTrue(Bytes.equals(VALUE_2,value2));
  get=new Get(ROW_2);
  get.addFamily(COLUMN_1);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_2,value1));
  assertNull(value2);
  get=new Get(ROW_2);
  get.addColumn(COLUMN_1,QUALIFIER_1);
  get.addColumn(COLUMN_2,QUALIFIER_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_2,value1));
  assertNotNull(value2);
  assertTrue(Bytes.equals(VALUE_2,value2));
  get=new Get(ROW_2);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  get.setTimeStamp(TS_1);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  get=new Get(ROW_2);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  get.setTimeRange(0,TS_1 + 1);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  get=new Get(ROW_2);
  get.addFamily(COLUMN_1);
  get.setMaxVersions(2);
  result=remoteTable.get(get);
  int count=0;
  for (  Cell kv : result.listCells()) {
    if (CellUtil.matchingFamily(kv,COLUMN_1) && TS_1 == kv.getTimestamp()) {
      assertTrue(CellUtil.matchingValue(kv,VALUE_1));
      count++;
    }
    if (CellUtil.matchingFamily(kv,COLUMN_1) && TS_2 == kv.getTimestamp()) {
      assertTrue(CellUtil.matchingValue(kv,VALUE_2));
      count++;
    }
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiGet() throws Exception {
  ArrayList<Get> gets=new ArrayList<Get>();
  gets.add(new Get(ROW_1));
  gets.add(new Get(ROW_2));
  Result[] results=remoteTable.get(gets);
  assertNotNull(results);
  assertEquals(2,results.length);
  assertEquals(1,results[0].size());
  assertEquals(2,results[1].size());
  gets=new ArrayList<Get>();
  Get g=new Get(ROW_1);
  g.setMaxVersions(3);
  gets.add(g);
  gets.add(new Get(ROW_2));
  results=remoteTable.get(gets);
  assertNotNull(results);
  assertEquals(2,results.length);
  assertEquals(1,results[0].size());
  assertEquals(3,results[1].size());
  gets=new ArrayList<Get>();
  gets.add(new Get(Bytes.toBytes("RESALLYREALLYNOTTHERE")));
  results=remoteTable.get(gets);
  assertNotNull(results);
  assertEquals(0,results.length);
  gets=new ArrayList<Get>();
  gets.add(new Get(Bytes.toBytes("RESALLYREALLYNOTTHERE")));
  gets.add(new Get(ROW_1));
  gets.add(new Get(ROW_2));
  results=remoteTable.get(gets);
  assertNotNull(results);
  assertEquals(2,results.length);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelete() throws IOException {
  Put put=new Put(ROW_3);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  put.addColumn(COLUMN_2,QUALIFIER_2,VALUE_2);
  remoteTable.put(put);
  Get get=new Get(ROW_3);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  Result result=remoteTable.get(get);
  byte[] value1=result.getValue(COLUMN_1,QUALIFIER_1);
  byte[] value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNotNull(value2);
  assertTrue(Bytes.equals(VALUE_2,value2));
  Delete delete=new Delete(ROW_3);
  delete.addColumn(COLUMN_2,QUALIFIER_2);
  remoteTable.delete(delete);
  get=new Get(ROW_3);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  delete=new Delete(ROW_3);
  delete.setTimestamp(1L);
  remoteTable.delete(delete);
  get=new Get(ROW_3);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  delete=new Delete(ROW_3);
  remoteTable.delete(delete);
  get=new Get(ROW_3);
  get.addFamily(COLUMN_1);
  get.addFamily(COLUMN_2);
  result=remoteTable.get(get);
  value1=result.getValue(COLUMN_1,QUALIFIER_1);
  value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNull(value1);
  assertNull(value2);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndDelete() throws IOException {
  Get get=new Get(ROW_1);
  Result result=remoteTable.get(get);
  byte[] value1=result.getValue(COLUMN_1,QUALIFIER_1);
  byte[] value2=result.getValue(COLUMN_2,QUALIFIER_2);
  assertNotNull(value1);
  assertTrue(Bytes.equals(VALUE_1,value1));
  assertNull(value2);
  assertTrue(remoteTable.exists(get));
  assertEquals(1,remoteTable.existsAll(Collections.singletonList(get)).length);
  Delete delete=new Delete(ROW_1);
  remoteTable.checkAndDelete(ROW_1,COLUMN_1,QUALIFIER_1,VALUE_1,delete);
  assertFalse(remoteTable.exists(get));
  Put put=new Put(ROW_1);
  put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
  remoteTable.put(put);
  assertTrue(remoteTable.checkAndPut(ROW_1,COLUMN_1,QUALIFIER_1,VALUE_1,put));
  assertFalse(remoteTable.checkAndPut(ROW_1,COLUMN_1,QUALIFIER_1,VALUE_2,put));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.AbstractTestSecureIPC </h4><pre class="type-7 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRpcCallWithEnabledKerberosSaslAuth() throws Exception {
  UserGroupInformation ugi2=UserGroupInformation.getCurrentUser();
  assertSame(ugi,ugi2);
  assertEquals(AuthenticationMethod.KERBEROS,ugi.getAuthenticationMethod());
  assertEquals(krbPrincipal,ugi.getUserName());
  callRpcService(User.create(ugi2));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRpcFallbackToSimpleAuth() throws Exception {
  String clientUsername="testuser";
  UserGroupInformation clientUgi=UserGroupInformation.createUserForTesting(clientUsername,new String[]{clientUsername});
  assertNotSame(ugi,clientUgi);
  assertEquals(AuthenticationMethod.SIMPLE,clientUgi.getAuthenticationMethod());
  assertEquals(clientUsername,clientUgi.getUserName());
  clientConf.set(User.HBASE_SECURITY_CONF_KEY,"simple");
  serverConf.setBoolean(RpcServer.FALLBACK_TO_INSECURE_CLIENT_AUTH,true);
  callRpcService(User.create(clientUgi));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestEncryptionUtil </h4><pre class="type-4 type-11 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyWrapping() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HConstants.CRYPTO_KEYPROVIDER_CONF_KEY,KeyProviderForTesting.class.getName());
  byte[] keyBytes=new byte[AES.KEY_LENGTH];
  new SecureRandom().nextBytes(keyBytes);
  String algorithm=conf.get(HConstants.CRYPTO_KEY_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  Key key=new SecretKeySpec(keyBytes,algorithm);
  byte[] wrappedKeyBytes=EncryptionUtil.wrapKey(conf,"hbase",key);
  assertNotNull(wrappedKeyBytes);
  Key unwrappedKey=EncryptionUtil.unwrapKey(conf,"hbase",wrappedKeyBytes);
  assertNotNull(unwrappedKey);
  assertTrue(unwrappedKey instanceof SecretKeySpec);
  assertTrue("Unwrapped key bytes do not match original",Bytes.equals(keyBytes,unwrappedKey.getEncoded()));
  try {
    EncryptionUtil.unwrapKey(conf,"other",wrappedKeyBytes);
    fail("Unwrap with incorrect key did not throw KeyException");
  }
 catch (  KeyException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=KeyException.class) public void testWALKeyWrappingWithIncorrectKey() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HConstants.CRYPTO_KEYPROVIDER_CONF_KEY,KeyProviderForTesting.class.getName());
  byte[] keyBytes=new byte[AES.KEY_LENGTH];
  new SecureRandom().nextBytes(keyBytes);
  String algorithm=conf.get(HConstants.CRYPTO_WAL_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  Key key=new SecretKeySpec(keyBytes,algorithm);
  byte[] wrappedKeyBytes=EncryptionUtil.wrapKey(conf,"hbase",key);
  assertNotNull(wrappedKeyBytes);
  EncryptionUtil.unwrapWALKey(conf,"other",wrappedKeyBytes);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWALKeyWrapping() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HConstants.CRYPTO_KEYPROVIDER_CONF_KEY,KeyProviderForTesting.class.getName());
  byte[] keyBytes=new byte[AES.KEY_LENGTH];
  new SecureRandom().nextBytes(keyBytes);
  String algorithm=conf.get(HConstants.CRYPTO_WAL_ALGORITHM_CONF_KEY,HConstants.CIPHER_AES);
  Key key=new SecretKeySpec(keyBytes,algorithm);
  byte[] wrappedKeyBytes=EncryptionUtil.wrapKey(conf,"hbase",key);
  assertNotNull(wrappedKeyBytes);
  Key unwrappedKey=EncryptionUtil.unwrapWALKey(conf,"hbase",wrappedKeyBytes);
  assertNotNull(unwrappedKey);
  assertTrue(unwrappedKey instanceof SecretKeySpec);
  assertTrue("Unwrapped key bytes do not match original",Bytes.equals(keyBytes,unwrappedKey.getEncoded()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestUser </h4><pre class="type-4 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheGetGroupsRoot() throws Exception {
  if (!SystemUtils.IS_OS_WINDOWS) {
    Configuration conf=HBaseConfiguration.create();
    UserProvider up=UserProvider.instantiate(conf);
    String rootUserName="root";
    UserGroupInformation ugiOne=UserGroupInformation.createRemoteUser(rootUserName);
    UserGroupInformation ugiTwo=UserGroupInformation.createRemoteUser(rootUserName);
    User uOne=up.create(ugiOne);
    User uTwo=up.create(ugiTwo);
    assertArrayEquals(uOne.getGroupNames(),uTwo.getGroupNames());
    String[] groupNames=ugiOne.getGroupNames();
    assertTrue(groupNames.length > 0);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that we're returning a result for the current user.
 * Previously getCurrent() was returning null if not initialized on
 * non-secure Hadoop variants.
 */
@Test public void testGetCurrent() throws Exception {
  User user1=User.getCurrent();
  assertNotNull(user1.ugi);
  LOG.debug("User1 is " + user1.getName());
  for (int i=0; i < 100; i++) {
    User u=User.getCurrent();
    assertNotNull(u);
    assertEquals(user1.getName(),u.getName());
    assertEquals(user1,u);
    assertEquals(user1.hashCode(),u.hashCode());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheGetGroups() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  UserProvider up=UserProvider.instantiate(conf);
  String nonUser="kklvfnvhdhcenfnniilggljhdecjhidkle";
  UserGroupInformation ugiOne=UserGroupInformation.createRemoteUser(nonUser);
  UserGroupInformation ugiTwo=UserGroupInformation.createRemoteUser(nonUser);
  User uOne=up.create(ugiOne);
  User uTwo=up.create(ugiTwo);
  assertArrayEquals(uOne.getGroupNames(),uTwo.getGroupNames());
  assertTrue(uOne.getGroupNames() == uTwo.getGroupNames());
  assertEquals(0,ugiOne.getGroupNames().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestUsersOperationsWithSecureHadoop </h4><pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test login with security enabled configuration To run this test, we must specify the following
 * system properties:
 * <p>
 * <b> hbase.regionserver.kerberos.principal </b>
 * <p>
 * <b> hbase.regionserver.keytab.file </b>
 * @throws IOException
 */
@Test public void testUserLoginInSecureHadoop() throws Exception {
  UserGroupInformation defaultLogin=UserGroupInformation.getLoginUser();
  Configuration conf=getConfigurationWoPrincipal();
  User.login(conf,HBaseKerberosUtils.KRB_KEYTAB_FILE,HBaseKerberosUtils.KRB_PRINCIPAL,"localhost");
  UserGroupInformation failLogin=UserGroupInformation.getLoginUser();
  assertTrue("ugi should be the same in case fail login",defaultLogin.equals(failLogin));
  String nnKeyTab=getKeytabFileForTesting();
  String dnPrincipal=getPrincipalForTesting();
  assertNotNull("KerberosKeytab was not specified",nnKeyTab);
  assertNotNull("KerberosPrincipal was not specified",dnPrincipal);
  conf=getSecuredConfiguration();
  UserGroupInformation.setConfiguration(conf);
  User.login(conf,HBaseKerberosUtils.KRB_KEYTAB_FILE,HBaseKerberosUtils.KRB_PRINCIPAL,"localhost");
  UserGroupInformation successLogin=UserGroupInformation.getLoginUser();
  assertFalse("ugi should be different in in case success login",defaultLogin.equals(successLogin));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController </h4><pre class="type-3 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  cleanUp();
  TEST_UTIL.shutdownMiniCluster();
  int total=TableAuthManager.getTotalRefCount();
  assertTrue("Unexpected reference count: " + total,total == 0);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testAccessControlClientUserPerms() throws Exception {
  TableName tname=TableName.valueOf("testAccessControlClientUserPerms");
  createTestTable(tname);
  try {
    final String regex=tname.getNameWithNamespaceInclAsString();
    User testUserPerms=User.createUserForTesting(conf,"testUserPerms",new String[0]);
    assertEquals(0,testUserPerms.runAs(getPrivilegedAction(regex)).size());
    grantOnTable(TEST_UTIL,testUserPerms.getShortName(),tname,null,null,Action.ADMIN);
    List<UserPermission> perms=testUserPerms.runAs(getPrivilegedAction(regex));
    assertNotNull(perms);
    assertEquals(2,perms.size());
  }
  finally {
    deleteTable(TEST_UTIL,tname);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testTruncatePerms() throws Exception {
  try {
    List<UserPermission> existingPerms=AccessControlClient.getUserPermissions(systemUserConnection,TEST_TABLE.getNameAsString());
    assertTrue(existingPerms != null);
    assertTrue(existingPerms.size() > 1);
    TEST_UTIL.getHBaseAdmin().disableTable(TEST_TABLE);
    TEST_UTIL.truncateTable(TEST_TABLE);
    TEST_UTIL.waitTableAvailable(TEST_TABLE);
    List<UserPermission> perms=AccessControlClient.getUserPermissions(systemUserConnection,TEST_TABLE.getNameAsString());
    assertTrue(perms != null);
    assertEquals(existingPerms.size(),perms.size());
  }
 catch (  Throwable e) {
    throw new HBaseIOException(e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController2 </h4><pre class="type-3 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    deleteTable(TEST_UTIL,tableName);
  }
 catch (  TableNotFoundException ex) {
    LOG.info("Test deleted table " + tableName);
  }
  deleteNamespace(TEST_UTIL,namespace);
  assertEquals(0,AccessControlLists.getTablePermissions(conf,tableName).size());
  assertEquals(0,AccessControlLists.getNamespacePermissions(conf,namespace).size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testCreateWithCorrectOwner() throws Exception {
  final User testUser=User.createUserForTesting(TEST_UTIL.getConfiguration(),"TestUser",new String[0]);
  SecureTestUtil.grantGlobal(TEST_UTIL,testUser.getShortName(),Action.CREATE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor desc=new HTableDescriptor(TEST_TABLE.getTableName());
      desc.addFamily(new HColumnDescriptor(TEST_FAMILY));
      try (Connection connection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration(),testUser)){
        try (Admin admin=connection.getAdmin()){
          createTable(TEST_UTIL,admin,desc);
        }
       }
       return null;
    }
  }
,testUser);
  TEST_UTIL.waitTableAvailable(TEST_TABLE.getTableName());
  List<TablePermission> perms=AccessControlLists.getTablePermissions(conf,TEST_TABLE.getTableName()).get(testUser.getShortName());
  assertNotNull(perms);
  assertFalse(perms.isEmpty());
  assertTrue(perms.get(0).implies(Permission.Action.READ));
  assertTrue(perms.get(0).implies(Permission.Action.WRITE));
  assertTrue(perms.get(0).implies(Permission.Action.EXEC));
  assertTrue(perms.get(0).implies(Permission.Action.CREATE));
  assertTrue(perms.get(0).implies(Permission.Action.ADMIN));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  createNamespace(TEST_UTIL,NamespaceDescriptor.create(namespace).build());
  try (Table table=createTable(TEST_UTIL,tableName,new byte[][]{TEST_FAMILY,TEST_FAMILY_2})){
    TEST_UTIL.waitTableEnabled(tableName);
    table.put(Arrays.asList(new Put(TEST_ROW).addColumn(TEST_FAMILY,Q1,value1),new Put(TEST_ROW_2).addColumn(TEST_FAMILY,Q2,value2),new Put(TEST_ROW_3).addColumn(TEST_FAMILY_2,Q1,value1)));
  }
   assertEquals(1,AccessControlLists.getTablePermissions(conf,tableName).size());
  try {
    assertEquals(1,AccessControlClient.getUserPermissions(systemUserConnection,tableName.toString()).size());
  }
 catch (  Throwable e) {
    LOG.error("Error during call of AccessControlClient.getUserPermissions. ",e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController3 </h4><pre class="type-3 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  HRegionServer rs=null;
  for (  JVMClusterUtil.RegionServerThread thread : TEST_UTIL.getMiniHBaseCluster().getRegionServerThreads()) {
    rs=thread.getRegionServer();
  }
  cleanUp();
  TEST_UTIL.shutdownMiniCluster();
  assertTrue("region server should have aborted due to FaultyAccessController",rs.isAborted());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestCellACLWithMultipleVersions </h4><pre class="type-3 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    TEST_UTIL.deleteTable(TEST_TABLE.getTableName());
  }
 catch (  TableNotFoundException ex) {
    LOG.info("Test deleted table " + TEST_TABLE.getTableName());
  }
  assertEquals(0,AccessControlLists.getTablePermissions(conf,TEST_TABLE.getTableName()).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestCellACLs </h4><pre class="type-3 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    TEST_UTIL.deleteTable(TEST_TABLE.getTableName());
  }
 catch (  TableNotFoundException ex) {
    LOG.info("Test deleted table " + TEST_TABLE.getTableName());
  }
  assertEquals(0,AccessControlLists.getTablePermissions(conf,TEST_TABLE.getTableName()).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestNamespaceCommands </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAclTableEntries() throws Exception {
  String userTestNamespace="userTestNsp";
  Table acl=UTIL.getConnection().getTable(AccessControlLists.ACL_TABLE_NAME);
  try {
    ListMultimap<String,TablePermission> perms=AccessControlLists.getNamespacePermissions(conf,TEST_NAMESPACE);
    perms=AccessControlLists.getNamespacePermissions(conf,TEST_NAMESPACE);
    for (    Map.Entry<String,TablePermission> entry : perms.entries()) {
      LOG.debug(entry);
    }
    assertEquals(6,perms.size());
    grantOnNamespace(UTIL,userTestNamespace,TEST_NAMESPACE,Permission.Action.WRITE);
    Result result=acl.get(new Get(Bytes.toBytes(userTestNamespace)));
    assertTrue(result != null);
    perms=AccessControlLists.getNamespacePermissions(conf,TEST_NAMESPACE);
    assertEquals(7,perms.size());
    List<TablePermission> namespacePerms=perms.get(userTestNamespace);
    assertTrue(perms.containsKey(userTestNamespace));
    assertEquals(1,namespacePerms.size());
    assertEquals(TEST_NAMESPACE,namespacePerms.get(0).getNamespace());
    assertEquals(null,namespacePerms.get(0).getFamily());
    assertEquals(null,namespacePerms.get(0).getQualifier());
    assertEquals(1,namespacePerms.get(0).getActions().length);
    assertEquals(Permission.Action.WRITE,namespacePerms.get(0).getActions()[0]);
    revokeFromNamespace(UTIL,userTestNamespace,TEST_NAMESPACE,Permission.Action.WRITE);
    perms=AccessControlLists.getNamespacePermissions(conf,TEST_NAMESPACE);
    assertEquals(6,perms.size());
  }
  finally {
    acl.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestScanEarlyTermination </h4><pre class="type-3 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    TEST_UTIL.deleteTable(TEST_TABLE.getTableName());
  }
 catch (  TableNotFoundException ex) {
    LOG.info("Test deleted table " + TEST_TABLE.getTableName());
  }
  assertEquals(0,AccessControlLists.getTablePermissions(conf,TEST_TABLE.getTableName()).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestTablePermissions </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicWrite() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("george"),TEST_TABLE,null,(byte[])null,UserPermission.Action.READ,UserPermission.Action.WRITE));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("hubert"),TEST_TABLE,null,(byte[])null,UserPermission.Action.READ));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("humphrey"),TEST_TABLE,TEST_FAMILY,TEST_QUALIFIER,UserPermission.Action.READ));
  ListMultimap<String,TablePermission> perms=AccessControlLists.getTablePermissions(conf,TEST_TABLE);
  List<TablePermission> userPerms=perms.get("george");
  assertNotNull("Should have permissions for george",userPerms);
  assertEquals("Should have 1 permission for george",1,userPerms.size());
  TablePermission permission=userPerms.get(0);
  assertEquals("Permission should be for " + TEST_TABLE,TEST_TABLE,permission.getTableName());
  assertNull("Column family should be empty",permission.getFamily());
  assertNotNull(permission.getActions());
  assertEquals(2,permission.getActions().length);
  List<TablePermission.Action> actions=Arrays.asList(permission.getActions());
  assertTrue(actions.contains(TablePermission.Action.READ));
  assertTrue(actions.contains(TablePermission.Action.WRITE));
  userPerms=perms.get("hubert");
  assertNotNull("Should have permissions for hubert",userPerms);
  assertEquals("Should have 1 permission for hubert",1,userPerms.size());
  permission=userPerms.get(0);
  assertEquals("Permission should be for " + TEST_TABLE,TEST_TABLE,permission.getTableName());
  assertNull("Column family should be empty",permission.getFamily());
  assertNotNull(permission.getActions());
  assertEquals(1,permission.getActions().length);
  actions=Arrays.asList(permission.getActions());
  assertTrue(actions.contains(TablePermission.Action.READ));
  assertFalse(actions.contains(TablePermission.Action.WRITE));
  userPerms=perms.get("humphrey");
  assertNotNull("Should have permissions for humphrey",userPerms);
  assertEquals("Should have 1 permission for humphrey",1,userPerms.size());
  permission=userPerms.get(0);
  assertEquals("Permission should be for " + TEST_TABLE,TEST_TABLE,permission.getTableName());
  assertTrue("Permission should be for family " + TEST_FAMILY,Bytes.equals(TEST_FAMILY,permission.getFamily()));
  assertTrue("Permission should be for qualifier " + TEST_QUALIFIER,Bytes.equals(TEST_QUALIFIER,permission.getQualifier()));
  assertNotNull(permission.getActions());
  assertEquals(1,permission.getActions().length);
  actions=Arrays.asList(permission.getActions());
  assertTrue(actions.contains(TablePermission.Action.READ));
  assertFalse(actions.contains(TablePermission.Action.WRITE));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("hubert"),TEST_TABLE2,null,(byte[])null,TablePermission.Action.READ,TablePermission.Action.WRITE));
  Map<byte[],ListMultimap<String,TablePermission>> allPerms=AccessControlLists.loadAll(conf);
  assertEquals("Full permission map should have entries for both test tables",2,allPerms.size());
  userPerms=allPerms.get(TEST_TABLE.getName()).get("hubert");
  assertNotNull(userPerms);
  assertEquals(1,userPerms.size());
  permission=userPerms.get(0);
  assertEquals(TEST_TABLE,permission.getTableName());
  assertEquals(1,permission.getActions().length);
  assertEquals(TablePermission.Action.READ,permission.getActions()[0]);
  userPerms=allPerms.get(TEST_TABLE2.getName()).get("hubert");
  assertNotNull(userPerms);
  assertEquals(1,userPerms.size());
  permission=userPerms.get(0);
  assertEquals(TEST_TABLE2,permission.getTableName());
  assertEquals(2,permission.getActions().length);
  actions=Arrays.asList(permission.getActions());
  assertTrue(actions.contains(TablePermission.Action.READ));
  assertTrue(actions.contains(TablePermission.Action.WRITE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization </h4><pre class="type-2 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
  HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY);
  hcd.setMaxVersions(100);
  htd.addFamily(hcd);
  htd.setOwner(USER_OWNER);
  admin.createTable(htd,new byte[][]{Bytes.toBytes("s")});
  TEST_UTIL.waitUntilAllRegionsAssigned(TEST_TABLE.getTableName());
  Region region=TEST_UTIL.getHBaseCluster().getRegions(TEST_TABLE.getTableName()).get(0);
  RegionCoprocessorHost rcpHost=region.getCoprocessorHost();
  RCP_ENV=rcpHost.createEnvironment(AccessController.class,ACCESS_CONTROLLER,Coprocessor.PRIORITY_HIGHEST,1,TEST_UTIL.getConfiguration());
  grantGlobal(TEST_UTIL,USER_ADMIN.getShortName(),Permission.Action.ADMIN,Permission.Action.CREATE,Permission.Action.READ,Permission.Action.WRITE);
  grantOnTable(TEST_UTIL,USER_RW.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ,Permission.Action.WRITE);
  grantOnTable(TEST_UTIL,USER_CREATE.getShortName(),TEST_TABLE.getTableName(),null,null,Permission.Action.CREATE,Permission.Action.READ,Permission.Action.WRITE);
  grantOnTable(TEST_UTIL,USER_RO.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
  grantOnTable(TEST_UTIL,USER_QUAL.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q1,Permission.Action.READ,Permission.Action.WRITE);
  assertEquals(5,AccessControlLists.getTablePermissions(TEST_UTIL.getConfiguration(),TEST_TABLE.getTableName()).size());
}

</code></pre>

<br>
<pre class="type-3 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  try {
    deleteTable(TEST_UTIL,TEST_TABLE.getTableName());
  }
 catch (  TableNotFoundException ex) {
    LOG.info("Test deleted table " + TEST_TABLE.getTableName());
  }
  assertEquals(0,AccessControlLists.getTablePermissions(TEST_UTIL.getConfiguration(),TEST_TABLE.getTableName()).size());
  assertEquals(0,AccessControlLists.getNamespacePermissions(TEST_UTIL.getConfiguration(),TEST_TABLE.getTableName().getNamespaceAsString()).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.token.TestTokenAuthentication </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenCreation() throws Exception {
  Token<AuthenticationTokenIdentifier> token=secretManager.generateToken("testuser");
  AuthenticationTokenIdentifier ident=new AuthenticationTokenIdentifier();
  Writables.getWritable(token.getIdentifier(),ident);
  assertEquals("Token username should match","testuser",ident.getUsername());
  byte[] passwd=secretManager.retrievePassword(ident);
  assertTrue("Token password and password from secret manager should match",Bytes.equals(token.getPassword(),passwd));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUseExistingToken() throws Exception {
  User user=User.createUserForTesting(TEST_UTIL.getConfiguration(),"testuser2",new String[]{"testgroup"});
  Token<AuthenticationTokenIdentifier> token=secretManager.generateToken(user.getName());
  assertNotNull(token);
  user.addToken(token);
  Token<AuthenticationTokenIdentifier> firstToken=new AuthenticationTokenSelector().selectToken(token.getService(),user.getTokens());
  assertNotNull(firstToken);
  assertEquals(token,firstToken);
  Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
  try {
    assertFalse(TokenUtil.addTokenIfMissing(conn,user));
    Token<AuthenticationTokenIdentifier> secondToken=new AuthenticationTokenSelector().selectToken(token.getService(),user.getTokens());
    assertEquals(firstToken,secondToken);
  }
  finally {
    conn.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.token.TestZKSecretWatcher </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyUpdate() throws Exception {
  assertTrue(KEY_MASTER.isMaster());
  assertFalse(KEY_SLAVE.isMaster());
  int maxKeyId=0;
  KEY_MASTER.rollCurrentKey();
  AuthenticationKey key1=KEY_MASTER.getCurrentKey();
  assertNotNull(key1);
  LOG.debug("Master current key: " + key1.getKeyId());
  Thread.sleep(1000);
  AuthenticationKey slaveCurrent=KEY_SLAVE.getCurrentKey();
  assertNotNull(slaveCurrent);
  assertEquals(key1,slaveCurrent);
  LOG.debug("Slave current key: " + slaveCurrent.getKeyId());
  KEY_MASTER.rollCurrentKey();
  AuthenticationKey key2=KEY_MASTER.getCurrentKey();
  LOG.debug("Master new current key: " + key2.getKeyId());
  KEY_MASTER.rollCurrentKey();
  AuthenticationKey key3=KEY_MASTER.getCurrentKey();
  LOG.debug("Master new current key: " + key3.getKeyId());
  key1.setExpiration(EnvironmentEdgeManager.currentTime() - 1000);
  KEY_MASTER.removeExpiredKeys();
  assertNull(KEY_MASTER.getKey(key1.getKeyId()));
  KEY_SLAVE.getLatch().await();
  AuthenticationKey slave2=KEY_SLAVE.getKey(key2.getKeyId());
  assertNotNull(slave2);
  assertEquals(key2,slave2);
  AuthenticationKey slave3=KEY_SLAVE.getKey(key3.getKeyId());
  assertNotNull(slave3);
  assertEquals(key3,slave3);
  slaveCurrent=KEY_SLAVE.getCurrentKey();
  assertEquals(key3,slaveCurrent);
  LOG.debug("Slave current key: " + slaveCurrent.getKeyId());
  assertNull(KEY_SLAVE.getKey(key1.getKeyId()));
  Configuration conf=TEST_UTIL.getConfiguration();
  ZooKeeperWatcher zk=newZK(conf,"server3",new MockAbortable());
  KEY_SLAVE2=new AuthenticationTokenSecretManager(conf,zk,"server3",60 * 60 * 1000,60 * 1000);
  KEY_SLAVE2.start();
  Thread.sleep(1000);
  slave2=KEY_SLAVE2.getKey(key2.getKeyId());
  assertNotNull(slave2);
  assertEquals(key2,slave2);
  slave3=KEY_SLAVE2.getKey(key3.getKeyId());
  assertNotNull(slave3);
  assertEquals(key3,slave3);
  slaveCurrent=KEY_SLAVE2.getCurrentKey();
  assertEquals(key3,slaveCurrent);
  assertNull(KEY_SLAVE2.getKey(key1.getKeyId()));
  KEY_MASTER.stop();
  Thread.sleep(1000);
  assertFalse(KEY_MASTER.isMaster());
  AuthenticationTokenSecretManager[] mgrs=new AuthenticationTokenSecretManager[]{KEY_SLAVE,KEY_SLAVE2};
  AuthenticationTokenSecretManager newMaster=null;
  int tries=0;
  while (newMaster == null && tries++ < 5) {
    for (    AuthenticationTokenSecretManager mgr : mgrs) {
      if (mgr.isMaster()) {
        newMaster=mgr;
        break;
      }
    }
    if (newMaster == null) {
      Thread.sleep(500);
    }
  }
  assertNotNull(newMaster);
  AuthenticationKey current=newMaster.getCurrentKey();
  assertTrue(current.getKeyId() >= slaveCurrent.getKeyId());
  LOG.debug("New master, current key: " + current.getKeyId());
  newMaster.rollCurrentKey();
  AuthenticationKey newCurrent=newMaster.getCurrentKey();
  LOG.debug("New master, rolled new current key: " + newCurrent.getKeyId());
  assertTrue(newCurrent.getKeyId() > current.getKeyId());
  ZooKeeperWatcher zk3=newZK(conf,"server4",new MockAbortable());
  KEY_SLAVE3=new AuthenticationTokenSecretManager(conf,zk3,"server4",60 * 60 * 1000,60 * 1000);
  KEY_SLAVE3.start();
  Thread.sleep(5000);
  newMaster.stop();
  Thread.sleep(5000);
  assertFalse(newMaster.isMaster());
  mgrs=new AuthenticationTokenSecretManager[]{KEY_SLAVE,KEY_SLAVE2,KEY_SLAVE3};
  newMaster=null;
  tries=0;
  while (newMaster == null && tries++ < 5) {
    for (    AuthenticationTokenSecretManager mgr : mgrs) {
      if (mgr.isMaster()) {
        newMaster=mgr;
        break;
      }
    }
    if (newMaster == null) {
      Thread.sleep(500);
    }
  }
  assertNotNull(newMaster);
  AuthenticationKey current2=newMaster.getCurrentKey();
  assertTrue(current2.getKeyId() >= newCurrent.getKeyId());
  LOG.debug("New master 2, current key: " + current2.getKeyId());
  newMaster.rollCurrentKey();
  AuthenticationKey newCurrent2=newMaster.getCurrentKey();
  LOG.debug("New master 2, rolled new current key: " + newCurrent2.getKeyId());
  assertTrue(newCurrent2.getKeyId() > current2.getKeyId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestExpressionExpander </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPositiveCases() throws Exception {
  ExpressionExpander expander=new ExpressionExpander();
  NonLeafExpressionNode exp1=new NonLeafExpressionNode(Operator.NOT,new LeafExpressionNode("a"));
  ExpressionNode result=expander.expand(exp1);
  assertTrue(result instanceof NonLeafExpressionNode);
  NonLeafExpressionNode nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.NOT,nlResult.getOperator());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  NonLeafExpressionNode exp2=new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b"));
  result=expander.expand(exp2);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp3=new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("a"),new LeafExpressionNode("b"));
  result=expander.expand(exp3);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.AND,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp4=new NonLeafExpressionNode(Operator.OR,new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")),new LeafExpressionNode("c"));
  result=expander.expand(exp4);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(3,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)nlResult.getChildExps().get(2)).getIdentifier());
  NonLeafExpressionNode exp5=new NonLeafExpressionNode(Operator.AND,new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("a"),new LeafExpressionNode("b")),new LeafExpressionNode("c"));
  result=expander.expand(exp5);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.AND,nlResult.getOperator());
  assertEquals(3,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)nlResult.getChildExps().get(2)).getIdentifier());
  NonLeafExpressionNode exp6=new NonLeafExpressionNode(Operator.AND,new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")),new LeafExpressionNode("c"));
  result=expander.expand(exp6);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  NonLeafExpressionNode temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp7=new NonLeafExpressionNode(Operator.OR,new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("a"),new LeafExpressionNode("b")),new LeafExpressionNode("c"));
  result=expander.expand(exp7);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  nlResult=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp8=new NonLeafExpressionNode(Operator.AND);
  exp8.addChildExp(new NonLeafExpressionNode(Operator.OR,new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("a"),new LeafExpressionNode("b")),new LeafExpressionNode("c")));
  exp8.addChildExp(new LeafExpressionNode("d"));
  result=expander.expand(exp8);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp9=new NonLeafExpressionNode(Operator.OR);
  exp9.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")));
  exp9.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("c"),new LeafExpressionNode("d")));
  result=expander.expand(exp9);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(4,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)nlResult.getChildExps().get(2)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)nlResult.getChildExps().get(3)).getIdentifier());
  NonLeafExpressionNode exp10=new NonLeafExpressionNode(Operator.AND);
  exp10.addChildExp(new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("a"),new LeafExpressionNode("b")));
  exp10.addChildExp(new NonLeafExpressionNode(Operator.AND,new LeafExpressionNode("c"),new LeafExpressionNode("d")));
  result=expander.expand(exp10);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.AND,nlResult.getOperator());
  assertEquals(4,nlResult.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlResult.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlResult.getChildExps().get(1)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)nlResult.getChildExps().get(2)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)nlResult.getChildExps().get(3)).getIdentifier());
  NonLeafExpressionNode exp11=new NonLeafExpressionNode(Operator.AND);
  exp11.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")));
  exp11.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("c"),new LeafExpressionNode("d")));
  result=expander.expand(exp11);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(4,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(2);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(3);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp12=new NonLeafExpressionNode(Operator.AND);
  NonLeafExpressionNode tempExp1=new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b"));
  NonLeafExpressionNode tempExp2=new NonLeafExpressionNode(Operator.OR,tempExp1,new LeafExpressionNode("c"));
  NonLeafExpressionNode tempExp3=new NonLeafExpressionNode(Operator.OR,tempExp2,new LeafExpressionNode("d"));
  exp12.addChildExp(tempExp3);
  exp12.addChildExp(new LeafExpressionNode("e"));
  result=expander.expand(exp12);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(4,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(2);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(3);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp13=new NonLeafExpressionNode(Operator.AND,new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b"),new LeafExpressionNode("c")),new LeafExpressionNode("d"));
  result=expander.expand(exp13);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(3,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(2);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp15=new NonLeafExpressionNode(Operator.AND);
  NonLeafExpressionNode temp1=new NonLeafExpressionNode(Operator.AND);
  temp1.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")));
  temp1.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("c"),new LeafExpressionNode("d")));
  exp15.addChildExp(temp1);
  exp15.addChildExp(new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("e"),new LeafExpressionNode("f")));
  result=expander.expand(exp15);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.OR,nlResult.getOperator());
  assertEquals(8,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("f",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(2);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(3);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("f",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(4);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(5);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("f",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("c",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(6);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("e",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(7);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("f",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  temp=(NonLeafExpressionNode)temp.getChildExps().get(0);
  assertEquals(Operator.AND,temp.getOperator());
  assertEquals(2,temp.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)temp.getChildExps().get(1)).getIdentifier());
  NonLeafExpressionNode exp16=new NonLeafExpressionNode(Operator.NOT,new NonLeafExpressionNode(Operator.OR,new LeafExpressionNode("a"),new LeafExpressionNode("b")));
  result=expander.expand(exp16);
  assertTrue(result instanceof NonLeafExpressionNode);
  nlResult=(NonLeafExpressionNode)result;
  assertEquals(Operator.AND,nlResult.getOperator());
  assertEquals(2,nlResult.getChildExps().size());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(0);
  assertEquals(Operator.NOT,temp.getOperator());
  assertEquals("a",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
  temp=(NonLeafExpressionNode)nlResult.getChildExps().get(1);
  assertEquals(Operator.NOT,temp.getOperator());
  assertEquals("b",((LeafExpressionNode)temp.getChildExps().get(0)).getIdentifier());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestExpressionParser </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPositiveCases() throws Exception {
  ExpressionNode node=parser.parse("abc");
  assertTrue(node instanceof LeafExpressionNode);
  assertEquals("abc",((LeafExpressionNode)node).getIdentifier());
  node=parser.parse("a&b|c&d");
  assertTrue(node instanceof NonLeafExpressionNode);
  NonLeafExpressionNode nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("d",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("(a)");
  assertTrue(node instanceof LeafExpressionNode);
  assertEquals("a",((LeafExpressionNode)node).getIdentifier());
  node=parser.parse(" ( a & b )");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("((((a&b))))");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("( a | b ) & (cc|def)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  NonLeafExpressionNode nlNodeLeft=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  NonLeafExpressionNode nlNodeRight=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.OR,nlNodeLeft.getOperator());
  assertEquals(2,nlNodeLeft.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNodeLeft.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNodeLeft.getChildExps().get(1)).getIdentifier());
  assertEquals(Operator.OR,nlNodeRight.getOperator());
  assertEquals(2,nlNodeRight.getChildExps().size());
  assertEquals("cc",((LeafExpressionNode)nlNodeRight.getChildExps().get(0)).getIdentifier());
  assertEquals("def",((LeafExpressionNode)nlNodeRight.getChildExps().get(1)).getIdentifier());
  node=parser.parse("a&(cc|de)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("cc",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("de",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("(a&b)|c");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("(a&b&c)|d");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("d",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("a&(b|(c|d))");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("d",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("(!a)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("a&(!b)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals(1,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("!a&b");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals(1,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("!a&(!b)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNodeLeft=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  nlNodeRight=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.NOT,nlNodeLeft.getOperator());
  assertEquals(1,nlNodeLeft.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNodeLeft.getChildExps().get(0)).getIdentifier());
  assertEquals(Operator.NOT,nlNodeRight.getOperator());
  assertEquals(1,nlNodeRight.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNodeRight.getChildExps().get(0)).getIdentifier());
  node=parser.parse("!a&!b");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNodeLeft=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  nlNodeRight=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.NOT,nlNodeLeft.getOperator());
  assertEquals(1,nlNodeLeft.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNodeLeft.getChildExps().get(0)).getIdentifier());
  assertEquals(Operator.NOT,nlNodeRight.getOperator());
  assertEquals(1,nlNodeRight.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNodeRight.getChildExps().get(0)).getIdentifier());
  node=parser.parse("!(a&b)");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals(1,nlNode.getChildExps().size());
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  node=parser.parse("a&!b");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("a",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals(1,nlNode.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse("!((a | b) & !(c & !b))");
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.NOT,nlNode.getOperator());
  assertEquals(1,nlNode.getChildExps().size());
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  assertTrue(nlNode.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNodeLeft=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  nlNodeRight=(NonLeafExpressionNode)nlNode.getChildExps().get(1);
  assertEquals(Operator.OR,nlNodeLeft.getOperator());
  assertEquals("a",((LeafExpressionNode)nlNodeLeft.getChildExps().get(0)).getIdentifier());
  assertEquals("b",((LeafExpressionNode)nlNodeLeft.getChildExps().get(1)).getIdentifier());
  assertEquals(Operator.NOT,nlNodeRight.getOperator());
  assertEquals(1,nlNodeRight.getChildExps().size());
  nlNodeRight=(NonLeafExpressionNode)nlNodeRight.getChildExps().get(0);
  assertEquals(Operator.AND,nlNodeRight.getOperator());
  assertEquals(2,nlNodeRight.getChildExps().size());
  assertEquals("c",((LeafExpressionNode)nlNodeRight.getChildExps().get(0)).getIdentifier());
  assertTrue(nlNodeRight.getChildExps().get(1) instanceof NonLeafExpressionNode);
  nlNodeRight=(NonLeafExpressionNode)nlNodeRight.getChildExps().get(1);
  assertEquals(Operator.NOT,nlNodeRight.getOperator());
  assertEquals(1,nlNodeRight.getChildExps().size());
  assertEquals("b",((LeafExpressionNode)nlNodeRight.getChildExps().get(0)).getIdentifier());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCasesSeperatedByDoubleQuotes() throws Exception {
  ExpressionNode node=null;
  try {
    node=parser.parse("\u0027&\"|\u002b&\u003f");
    fail("Excpetion must be thrown as there are special characters without quotes");
  }
 catch (  ParseException e) {
  }
  node=parser.parse(CellVisibility.quote("\u0027") + "&" + CellVisibility.quote("\"")+ "|"+ CellVisibility.quote("\u002b" + "&" + "\u003f"));
  assertTrue(node instanceof NonLeafExpressionNode);
  NonLeafExpressionNode nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u002b" + "&" + "\u003f",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\"",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertEquals("\u0027",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  try {
    node=parser.parse(CellVisibility.quote("\u0027&\\") + "|" + CellVisibility.quote("\u002b" + "&" + "\\")+ CellVisibility.quote("$$\""));
    fail("Excpetion must be thrown as there is not operator");
  }
 catch (  ParseException e) {
  }
  node=parser.parse(CellVisibility.quote("\u0027" + "&" + "\\") + "|" + CellVisibility.quote("\u003f" + "&" + "\\")+ "&"+ CellVisibility.quote("$$\""));
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("$$\"",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u0027" + "&" + "\\",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  assertEquals("\u003f" + "&" + "\\",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  try {
    node=parser.parse(CellVisibility.quote("\u002b&\\") + "|" + CellVisibility.quote("\u0027&\\")+ "&"+ "\"$$");
    fail("Excpetion must be thrown as there is no end quote");
  }
 catch (  ParseException e) {
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonAsciiCases() throws Exception {
  ExpressionNode node=parser.parse(CellVisibility.quote("\u0027") + "&" + CellVisibility.quote("\u002b")+ "|"+ CellVisibility.quote("\u002d")+ "&"+ CellVisibility.quote("\u003f"));
  assertTrue(node instanceof NonLeafExpressionNode);
  NonLeafExpressionNode nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u003f",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u002d",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u002b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertEquals("\u0027",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
  node=parser.parse(CellVisibility.quote("\u0027") + "&" + CellVisibility.quote("\u002b")+ "|"+ CellVisibility.quote("\u002d")+ "&"+ CellVisibility.quote("\u003f"));
  assertTrue(node instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)node;
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u003f",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.OR,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u002d",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertTrue(nlNode.getChildExps().get(0) instanceof NonLeafExpressionNode);
  nlNode=(NonLeafExpressionNode)nlNode.getChildExps().get(0);
  assertEquals(Operator.AND,nlNode.getOperator());
  assertEquals(2,nlNode.getChildExps().size());
  assertEquals("\u002b",((LeafExpressionNode)nlNode.getChildExps().get(1)).getIdentifier());
  assertEquals("\u0027",((LeafExpressionNode)nlNode.getChildExps().get(0)).getIdentifier());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabels </h4><pre class="type-4 type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAndGetUserAuths() throws Throwable {
  final String user="user1";
  PrivilegedExceptionAction<Void> action=new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      String[] auths={SECRET,CONFIDENTIAL};
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.setAuths(conn,auths,user);
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
  try (Table ht=TEST_UTIL.getConnection().getTable(LABELS_TABLE_NAME)){
    Scan scan=new Scan();
    scan.setAuthorizations(new Authorizations(VisibilityUtils.SYSTEM_LABEL));
    ResultScanner scanner=ht.getScanner(scan);
    Result result=null;
    List<Result> results=new ArrayList<Result>();
    while ((result=scanner.next()) != null) {
      results.add(result);
    }
    List<String> auths=extractAuths(user,results);
    assertTrue(auths.contains(SECRET));
    assertTrue(auths.contains(CONFIDENTIAL));
    assertEquals(2,auths.size());
  }
   action=new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        authsResponse=VisibilityClient.getAuths(conn,user);
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      assertEquals(2,authsList.size());
      assertTrue(authsList.contains(SECRET));
      assertTrue(authsList.contains(CONFIDENTIAL));
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
  action=new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      String[] auths1={SECRET,CONFIDENTIAL};
      GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.setAuths(conn,auths1,user);
        try {
          authsResponse=VisibilityClient.getAuths(conn,user);
        }
 catch (        Throwable e) {
          fail("Should not have failed");
        }
      }
 catch (      Throwable e) {
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      assertEquals(2,authsList.size());
      assertTrue(authsList.contains(SECRET));
      assertTrue(authsList.contains(CONFIDENTIAL));
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearUserAuths() throws Throwable {
  PrivilegedExceptionAction<Void> action=new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      String[] auths={SECRET,CONFIDENTIAL,PRIVATE};
      String user="testUser";
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.setAuths(conn,auths,user);
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      auths=new String[]{SECRET,PUBLIC,CONFIDENTIAL};
      VisibilityLabelsResponse response=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        response=VisibilityClient.clearAuths(conn,auths,user);
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      List<RegionActionResult> resultList=response.getResultList();
      assertEquals(3,resultList.size());
      assertTrue(resultList.get(0).getException().getValue().isEmpty());
      assertEquals("org.apache.hadoop.hbase.DoNotRetryIOException",resultList.get(1).getException().getName());
      assertTrue(Bytes.toString(resultList.get(1).getException().getValue().toByteArray()).contains("org.apache.hadoop.hbase.security.visibility.InvalidLabelException: " + "Label 'public' is not set for the user testUser"));
      assertTrue(resultList.get(2).getException().getValue().isEmpty());
      try (Connection connection=ConnectionFactory.createConnection(conf);Table ht=connection.getTable(LABELS_TABLE_NAME)){
        ResultScanner scanner=ht.getScanner(new Scan());
        Result result=null;
        List<Result> results=new ArrayList<Result>();
        while ((result=scanner.next()) != null) {
          results.add(result);
        }
        List<String> curAuths=extractAuths(user,results);
        assertTrue(curAuths.contains(PRIVATE));
        assertEquals(1,curAuths.size());
      }
       GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        authsResponse=VisibilityClient.getAuths(conn,user);
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      assertEquals(1,authsList.size());
      assertTrue(authsList.contains(PRIVATE));
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLabelsWithCheckAndPut() throws Throwable {
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=TEST_UTIL.createTable(tableName,fam)){
    byte[] row1=Bytes.toBytes("row1");
    Put put=new Put(row1);
    put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value);
    put.setCellVisibility(new CellVisibility(SECRET + " & " + CONFIDENTIAL));
    table.checkAndPut(row1,fam,qual,null,put);
    byte[] row2=Bytes.toBytes("row2");
    put=new Put(row2);
    put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value);
    put.setCellVisibility(new CellVisibility(SECRET));
    table.checkAndPut(row2,fam,qual,null,put);
    Scan scan=new Scan();
    scan.setAuthorizations(new Authorizations(SECRET));
    ResultScanner scanner=table.getScanner(scan);
    Result result=scanner.next();
    assertTrue(!result.isEmpty());
    assertTrue(Bytes.equals(row2,result.getRow()));
    result=scanner.next();
    assertNull(result);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleVersions() throws Exception {
  final byte[] r1=Bytes.toBytes("row1");
  final byte[] r2=Bytes.toBytes("row2");
  final byte[] v1=Bytes.toBytes("100");
  final byte[] v2=Bytes.toBytes("101");
  final byte[] fam2=Bytes.toBytes("info2");
  final byte[] qual2=Bytes.toBytes("qual2");
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  HTableDescriptor desc=new HTableDescriptor(tableName);
  HColumnDescriptor col=new HColumnDescriptor(fam);
  desc.addFamily(col);
  col=new HColumnDescriptor(fam2);
  col.setMaxVersions(5);
  desc.addFamily(col);
  TEST_UTIL.getHBaseAdmin().createTable(desc);
  try (Table table=TEST_UTIL.getConnection().getTable(tableName)){
    Put put=new Put(r1);
    put.addColumn(fam,qual,3l,v1);
    put.addColumn(fam,qual2,3l,v1);
    put.addColumn(fam2,qual,3l,v1);
    put.addColumn(fam2,qual2,3l,v1);
    put.setCellVisibility(new CellVisibility(SECRET));
    table.put(put);
    put=new Put(r1);
    put.addColumn(fam,qual,4l,v2);
    put.addColumn(fam,qual2,4l,v2);
    put.addColumn(fam2,qual,4l,v2);
    put.addColumn(fam2,qual2,4l,v2);
    put.setCellVisibility(new CellVisibility(PRIVATE));
    table.put(put);
    put=new Put(r2);
    put.addColumn(fam,qual,3l,v1);
    put.addColumn(fam,qual2,3l,v1);
    put.addColumn(fam2,qual,3l,v1);
    put.addColumn(fam2,qual2,3l,v1);
    put.setCellVisibility(new CellVisibility(SECRET));
    table.put(put);
    put=new Put(r2);
    put.addColumn(fam,qual,4l,v2);
    put.addColumn(fam,qual2,4l,v2);
    put.addColumn(fam2,qual,4l,v2);
    put.addColumn(fam2,qual2,4l,v2);
    put.setCellVisibility(new CellVisibility(SECRET));
    table.put(put);
    Scan s=new Scan();
    s.setMaxVersions(1);
    s.setAuthorizations(new Authorizations(SECRET));
    ResultScanner scanner=table.getScanner(s);
    Result result=scanner.next();
    assertTrue(Bytes.equals(r1,result.getRow()));
    assertNull(result.getColumnLatestCell(fam,qual));
    assertNull(result.getColumnLatestCell(fam,qual2));
    Cell cell=result.getColumnLatestCell(fam2,qual);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v1,0,v1.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
    cell=result.getColumnLatestCell(fam2,qual2);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v1,0,v1.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
    result=scanner.next();
    assertTrue(Bytes.equals(r2,result.getRow()));
    cell=result.getColumnLatestCell(fam,qual);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v2,0,v2.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
    cell=result.getColumnLatestCell(fam,qual2);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v2,0,v2.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
    cell=result.getColumnLatestCell(fam2,qual);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v2,0,v2.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
    cell=result.getColumnLatestCell(fam2,qual2);
    assertNotNull(cell);
    assertTrue(Bytes.equals(v2,0,v2.length,cell.getValueArray(),cell.getValueOffset(),cell.getValueLength()));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisibilityLabelsWithComplexLabels() throws Exception {
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=createTableAndWriteDataWithLabels(tableName,"(" + SECRET + "|"+ CONFIDENTIAL+ ")"+ "&"+ "!"+ TOPSECRET,"(" + PRIVATE + "&"+ CONFIDENTIAL+ "&"+ SECRET+ ")","(" + PRIVATE + "&"+ CONFIDENTIAL+ "&"+ SECRET+ ")","(" + PRIVATE + "&"+ CONFIDENTIAL+ "&"+ SECRET+ ")")){
    Scan s=new Scan();
    s.setAuthorizations(new Authorizations(TOPSECRET,CONFIDENTIAL,PRIVATE,PUBLIC,SECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(4);
    assertEquals(3,next.length);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row3,0,row3.length));
    cellScanner=next[2].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row4,0,row4.length));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsOpWithDifferentUsersNoACL </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLabelsTableOpsWithDifferentUsers() throws Throwable {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  VisibilityLabelsResponse response=SUPERUSER.runAs(action);
  assertTrue(response.getResult(0).getException().getValue().isEmpty());
  assertTrue(response.getResult(1).getException().getValue().isEmpty());
  action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user3");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  response=NORMAL_USER1.runAs(action);
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(0).getException().getName());
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(1).getException().getName());
  PrivilegedExceptionAction<GetAuthsResponse> action1=new PrivilegedExceptionAction<GetAuthsResponse>(){
    public GetAuthsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.getAuths(conn,"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  GetAuthsResponse authsResponse=NORMAL_USER.runAs(action1);
  assertTrue(authsResponse.getAuthList().isEmpty());
  authsResponse=NORMAL_USER1.runAs(action1);
  assertTrue(authsResponse.getAuthList().isEmpty());
  authsResponse=SUPERUSER.runAs(action1);
  List<String> authsList=new ArrayList<String>();
  for (  ByteString authBS : authsResponse.getAuthList()) {
    authsList.add(Bytes.toString(authBS.toByteArray()));
  }
  assertEquals(2,authsList.size());
  assertTrue(authsList.contains(CONFIDENTIAL));
  assertTrue(authsList.contains(PRIVATE));
  PrivilegedExceptionAction<VisibilityLabelsResponse> action2=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.clearAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  response=NORMAL_USER1.runAs(action2);
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(0).getException().getName());
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(1).getException().getName());
  response=SUPERUSER.runAs(action2);
  assertTrue(response.getResult(0).getException().getValue().isEmpty());
  assertTrue(response.getResult(1).getException().getValue().isEmpty());
  authsResponse=SUPERUSER.runAs(action1);
  assertTrue(authsResponse.getAuthList().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithACL </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanForUserWithFewerLabelAuthsThanLabelsInScanAuthorizations() throws Throwable {
  String[] auths={SECRET};
  String user="user2";
  VisibilityClient.setAuths(TEST_UTIL.getConnection(),auths,user);
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  final Table table=createTableAndWriteDataWithLabels(tableName,SECRET + "&" + CONFIDENTIAL+ "&!"+ PRIVATE,SECRET + "&!" + PRIVATE);
  SecureTestUtil.grantOnTable(TEST_UTIL,NORMAL_USER2.getShortName(),tableName,null,null,Permission.Action.READ);
  PrivilegedExceptionAction<Void> scanAction=new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      Scan s=new Scan();
      s.setAuthorizations(new Authorizations(SECRET,CONFIDENTIAL));
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(table.getName())){
        ResultScanner scanner=t.getScanner(s);
        Result result=scanner.next();
        assertTrue(!result.isEmpty());
        assertTrue(Bytes.equals(Bytes.toBytes("row2"),result.getRow()));
        result=scanner.next();
        assertNull(result);
      }
       return null;
    }
  }
;
  NORMAL_USER2.runAs(scanAction);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLabelsTableOpsWithDifferentUsers() throws Throwable {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.addLabels(conn,new String[]{"l1","l2"});
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  VisibilityLabelsResponse response=NORMAL_USER1.runAs(action);
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(0).getException().getName());
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(1).getException().getName());
  action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  response=NORMAL_USER1.runAs(action);
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(0).getException().getName());
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(1).getException().getName());
  action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  response=SUPERUSER.runAs(action);
  assertTrue(response.getResult(0).getException().getValue().isEmpty());
  assertTrue(response.getResult(1).getException().getValue().isEmpty());
  action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.clearAuths(conn,new String[]{CONFIDENTIAL,PRIVATE},"user1");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  response=NORMAL_USER1.runAs(action);
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(0).getException().getName());
  assertEquals("org.apache.hadoop.hbase.security.AccessDeniedException",response.getResult(1).getException().getName());
  response=VisibilityClient.clearAuths(TEST_UTIL.getConnection(),new String[]{CONFIDENTIAL,PRIVATE},"user1");
  assertTrue(response.getResult(0).getException().getValue().isEmpty());
  assertTrue(response.getResult(1).getException().getValue().isEmpty());
  VisibilityClient.setAuths(TEST_UTIL.getConnection(),new String[]{CONFIDENTIAL,PRIVATE},"user3");
  PrivilegedExceptionAction<GetAuthsResponse> action1=new PrivilegedExceptionAction<GetAuthsResponse>(){
    public GetAuthsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.getAuths(conn,"user3");
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  GetAuthsResponse authsResponse=NORMAL_USER1.runAs(action1);
  assertNull(authsResponse);
  authsResponse=SUPERUSER.runAs(action1);
  List<String> authsList=new ArrayList<String>();
  for (  ByteString authBS : authsResponse.getAuthList()) {
    authsList.add(Bytes.toString(authBS.toByteArray()));
  }
  assertEquals(2,authsList.size());
  assertTrue(authsList.contains(CONFIDENTIAL));
  assertTrue(authsList.contains(PRIVATE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithDefaultVisLabelService </h4><pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddLabels() throws Throwable {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    public VisibilityLabelsResponse run() throws Exception {
      String[] labels={"L1",SECRET,"L2","invalid~","L3"};
      VisibilityLabelsResponse response=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        response=VisibilityClient.addLabels(conn,labels);
      }
 catch (      Throwable e) {
        fail("Should not have thrown exception");
      }
      List<RegionActionResult> resultList=response.getResultList();
      assertEquals(5,resultList.size());
      assertTrue(resultList.get(0).getException().getValue().isEmpty());
      assertEquals("org.apache.hadoop.hbase.DoNotRetryIOException",resultList.get(1).getException().getName());
      assertTrue(Bytes.toString(resultList.get(1).getException().getValue().toByteArray()).contains("org.apache.hadoop.hbase.security.visibility.LabelAlreadyExistsException: " + "Label 'secret' already exists"));
      assertTrue(resultList.get(2).getException().getValue().isEmpty());
      assertTrue(resultList.get(3).getException().getValue().isEmpty());
      assertTrue(resultList.get(4).getException().getValue().isEmpty());
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListLabelsWithRegEx() throws Throwable {
  PrivilegedExceptionAction<ListLabelsResponse> action=new PrivilegedExceptionAction<ListLabelsResponse>(){
    public ListLabelsResponse run() throws Exception {
      ListLabelsResponse response=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        response=VisibilityClient.listLabels(conn,".*secret");
      }
 catch (      Throwable e) {
        fail("Should not have thrown exception");
      }
      List<ByteString> labels=response.getLabelList();
      assertEquals(2,labels.size());
      assertTrue(labels.contains(ByteString.copyFrom(SECRET.getBytes())));
      assertTrue(labels.contains(ByteString.copyFrom(TOPSECRET.getBytes())));
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListLabels() throws Throwable {
  PrivilegedExceptionAction<ListLabelsResponse> action=new PrivilegedExceptionAction<ListLabelsResponse>(){
    public ListLabelsResponse run() throws Exception {
      ListLabelsResponse response=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        response=VisibilityClient.listLabels(conn,null);
      }
 catch (      Throwable e) {
        fail("Should not have thrown exception");
      }
      List<ByteString> labels=response.getLabelList();
      assertEquals(12,labels.size());
      assertTrue(labels.contains(ByteString.copyFrom(SECRET.getBytes())));
      assertTrue(labels.contains(ByteString.copyFrom(TOPSECRET.getBytes())));
      assertTrue(labels.contains(ByteString.copyFrom(CONFIDENTIAL.getBytes())));
      assertTrue(labels.contains(ByteString.copyFrom("ABC".getBytes())));
      assertTrue(labels.contains(ByteString.copyFrom("XYZ".getBytes())));
      assertFalse(labels.contains(ByteString.copyFrom(SYSTEM_LABEL.getBytes())));
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithDeletes </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilySpecificTimeStampWithMulipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d.addFamily(fam,126l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(6);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnWithSpecificTimeStampUsingMultipleVersionsUnMatchingVisExpression() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d.addColumn(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnSpecificTimeStampWithMulipleVersionsDoneTwice2() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    assertEquals(current.getTimestamp(),127l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisibilityLabelsWithDeleteColumnsWithMultipleVersionsNoTimestamp() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d1=new Delete(row1);
          d1.setCellVisibility(new CellVisibility(CONFIDENTIAL));
          d1.addColumns(fam,qual);
          table.delete(d1);
          Delete d2=new Delete(row1);
          d2.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d2.addColumns(fam,qual);
          table.delete(d2);
          Delete d3=new Delete(row1);
          d3.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d3.addColumns(fam,qual);
          table.delete(d3);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertEquals(1,next.length);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnWithLatestTimeStampUsingMultipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addColumn(fam,qual);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnSpecificTimeStampWithMulipleVersionsDoneTwice1() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")"+ "|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addColumn(fam,qual,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    assertEquals(current.getTimestamp(),127l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilySpecificTimeStampWithMulipleVersionsDoneTwice() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addFamily(fam,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addFamily(fam,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    assertEquals(current.getTimestamp(),127l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilyAndDeleteColumnsWithAndWithoutVisibilityExp() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        Delete d1=new Delete(row1);
        d1.addFamily(fam);
        Delete d2=new Delete(row1);
        d2.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
        d2.addColumns(fam,qual);
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          table.delete(createList(d1,d2));
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    scanner.close();
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnSpecificTimeStampWithMulipleVersionsDoneTwice() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addColumn(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    assertEquals(current.getTimestamp(),127l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisibilityLabelsWithDeleteColumnsWithMultipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d.addColumns(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisibilityLabelsWithDeleteFamilyWithMultipleVersionsNoTimestamp() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d1=new Delete(row1);
          d1.setCellVisibility(new CellVisibility(CONFIDENTIAL));
          d1.addFamily(fam);
          table.delete(d1);
          Delete d2=new Delete(row1);
          d2.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d2.addFamily(fam);
          table.delete(d2);
          Delete d3=new Delete(row1);
          d3.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d3.addFamily(fam);
          table.delete(d3);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertEquals(1,next.length);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilyLatestTimeStampWithMulipleVersionsWithoutCellVisibilityInPuts() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPutsWithoutVisibility(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addFamily(fam);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanAfterCompaction() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ SECRET+ "&"+ TOPSECRET+ ")"));
          d.addFamily(fam,126l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Put put=new Put(Bytes.toBytes("row3"));
    put.addColumn(fam,qual,127l,value);
    put.setCellVisibility(new CellVisibility(CONFIDENTIAL + "&" + PRIVATE));
    table.put(put);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    TEST_UTIL.getHBaseAdmin().compact(tableName);
    Thread.sleep(5000);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 3);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testSpecificDeletesFollowedByDeleteFamily() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,126l);
          table.delete(d);
          d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addFamilyVersion(fam,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(5);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(CONFIDENTIAL));
          d.addFamily(fam);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(5);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnWithLatestTimeStampUsingMultipleVersionsAfterCompaction() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addColumn(fam,qual);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Put put=new Put(Bytes.toBytes("row3"));
    put.addColumn(fam,qual,127l,value);
    put.setCellVisibility(new CellVisibility(CONFIDENTIAL + "&" + PRIVATE));
    table.put(put);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    TEST_UTIL.getHBaseAdmin().majorCompact(tableName);
    Thread.sleep(5000);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 3);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testDeleteColumnWithLatestTimeStampWhenNoVersionMatches() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Put put=new Put(Bytes.toBytes("row1"));
    put.addColumn(fam,qual,128l,value);
    put.setCellVisibility(new CellVisibility(TOPSECRET));
    table.put(put);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET));
          d.addColumn(fam,qual);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),128l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    put=new Put(Bytes.toBytes("row1"));
    put.addColumn(fam,qual,129l,value);
    put.setCellVisibility(new CellVisibility(SECRET));
    table.put(put);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),129l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testSpecificDeletesFollowedByDeleteFamily1() throws Exception {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    @Override public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE,SECRET},SUPERUSER.getShortName());
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  VisibilityLabelsResponse response=SUPERUSER.runAs(action);
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual);
          table.delete(d);
          d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addFamilyVersion(fam,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(5);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(CONFIDENTIAL));
          d.addFamily(fam);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(5);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeleteFamilyVersionWithDiffLabels() throws Exception {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    @Override public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{CONFIDENTIAL,PRIVATE,SECRET},SUPERUSER.getShortName());
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  VisibilityLabelsResponse response=SUPERUSER.runAs(action);
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(CONFIDENTIAL));
          d.addFamilyVersion(fam,123l);
          table.delete(d);
          d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addFamilyVersion(fam,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(5);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteFamilyLatestTimeStampWithMulipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addFamily(fam);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisibilityExpressionWithNotEqualORCondition() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  Admin hBaseAdmin=TEST_UTIL.getHBaseAdmin();
  HColumnDescriptor colDesc=new HColumnDescriptor(fam);
  colDesc.setMaxVersions(5);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(colDesc);
  hBaseAdmin.createTable(desc);
  try (Table table=TEST_UTIL.getConnection().getTable(tableName)){
    Put put=new Put(Bytes.toBytes("row1"));
    put.addColumn(fam,qual,123l,value);
    put.setCellVisibility(new CellVisibility(CONFIDENTIAL));
    table.put(put);
    put=new Put(Bytes.toBytes("row1"));
    put.addColumn(fam,qual,124l,value);
    put.setCellVisibility(new CellVisibility(CONFIDENTIAL + "|" + PRIVATE));
    table.put(put);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.addColumn(fam,qual,124l);
          d.setCellVisibility(new CellVisibility(PRIVATE));
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 1);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnAndDeleteFamilylSpecificTimeStampWithMulipleVersion() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
          d.addColumn(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addFamily(fam,124l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    assertEquals(current.getTimestamp(),127l);
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteColumnswithMultipleColumnsWithMultipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPutsWithDiffCols(tableName)){
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        Delete d=new Delete(row1);
        d.setCellVisibility(new CellVisibility(SECRET + "&" + TOPSECRET));
        d.addColumns(fam,qual,125l);
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 1);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),124l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),qual1,0,qual1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),qual2,0,qual2.length));
  }
 }

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiffDeleteTypesForTheSameCellUsingMultipleVersions() throws Exception {
  setAuths();
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=doPuts(tableName)){
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + PRIVATE + "&"+ CONFIDENTIAL+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumns(fam,qual,125l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    Scan s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    ResultScanner scanner=table.getScanner(s);
    Result[] next=scanner.next(3);
    assertTrue(next.length == 2);
    CellScanner cellScanner=next[0].cellScanner();
    cellScanner.advance();
    Cell current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),127l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Delete d=new Delete(row1);
          d.setCellVisibility(new CellVisibility("(" + CONFIDENTIAL + "&"+ PRIVATE+ ")|("+ TOPSECRET+ "&"+ SECRET+ ")"));
          d.addColumn(fam,qual,127l);
          table.delete(d);
        }
 catch (        Throwable t) {
          throw new IOException(t);
        }
        return null;
      }
    }
;
    SUPERUSER.runAs(actiona);
    s=new Scan();
    s.setMaxVersions(5);
    s.setAuthorizations(new Authorizations(SECRET,PRIVATE,CONFIDENTIAL,TOPSECRET));
    scanner=table.getScanner(s);
    next=scanner.next(3);
    assertTrue(next.length == 2);
    cellScanner=next[0].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),126l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),125l);
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row1,0,row1.length));
    assertEquals(current.getTimestamp(),123l);
    cellScanner=next[1].cellScanner();
    cellScanner.advance();
    current=cellScanner.current();
    assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),row2,0,row2.length));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLablesWithGroups </h4><pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupAuths() throws Exception {
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  TEST_UTIL.createTable(tableName,CF);
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
        Put put=new Put(ROW_1);
        put.addColumn(CF,Q1,HConstants.LATEST_TIMESTAMP,value1);
        put.setCellVisibility(new CellVisibility(SECRET));
        table.put(put);
        put=new Put(ROW_1);
        put.addColumn(CF,Q2,HConstants.LATEST_TIMESTAMP,value2);
        put.setCellVisibility(new CellVisibility(CONFIDENTIAL));
        table.put(put);
        put=new Put(ROW_1);
        put.addColumn(CF,Q3,HConstants.LATEST_TIMESTAMP,value3);
        table.put(put);
      }
       return null;
    }
  }
);
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
        Scan s=new Scan();
        ResultScanner scanner=table.getScanner(s);
        Result[] next=scanner.next(1);
        assertTrue(next.length == 1);
        CellScanner cellScanner=next[0].cellScanner();
        cellScanner.advance();
        Cell current=cellScanner.current();
        assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),Q1,0,Q1.length));
        assertTrue(Bytes.equals(current.getValueArray(),current.getValueOffset(),current.getValueLength(),value1,0,value1.length));
        cellScanner.advance();
        current=cellScanner.current();
        assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),Q2,0,Q2.length));
        assertTrue(Bytes.equals(current.getValueArray(),current.getValueOffset(),current.getValueLength(),value2,0,value2.length));
        cellScanner.advance();
        current=cellScanner.current();
        assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),Q3,0,Q3.length));
        assertTrue(Bytes.equals(current.getValueArray(),current.getValueOffset(),current.getValueLength(),value3,0,value3.length));
      }
       return null;
    }
  }
);
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        authsResponse=VisibilityClient.getAuths(conn,"@testgroup");
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      assertEquals(1,authsList.size());
      assertTrue(authsList.contains(CONFIDENTIAL));
      return null;
    }
  }
);
  TESTUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
        Scan s=new Scan();
        ResultScanner scanner=table.getScanner(s);
        Result[] next=scanner.next(1);
        assertTrue(next.length == 1);
        CellScanner cellScanner=next[0].cellScanner();
        cellScanner.advance();
        Cell current=cellScanner.current();
        assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),Q2,0,Q2.length));
        assertTrue(Bytes.equals(current.getValueArray(),current.getValueOffset(),current.getValueLength(),value2,0,value2.length));
        cellScanner.advance();
        current=cellScanner.current();
        assertTrue(Bytes.equals(current.getRowArray(),current.getRowOffset(),current.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current.getQualifierArray(),current.getQualifierOffset(),current.getQualifierLength(),Q3,0,Q3.length));
        assertTrue(Bytes.equals(current.getValueArray(),current.getValueOffset(),current.getValueLength(),value3,0,value3.length));
        Scan s1=new Scan();
        s1.setAuthorizations(new Authorizations(new String[]{SECRET,CONFIDENTIAL}));
        ResultScanner scanner1=table.getScanner(s1);
        Result[] next1=scanner1.next(1);
        assertTrue(next1.length == 1);
        CellScanner cellScanner1=next1[0].cellScanner();
        cellScanner1.advance();
        Cell current1=cellScanner1.current();
        assertTrue(Bytes.equals(current1.getRowArray(),current1.getRowOffset(),current1.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current1.getQualifierArray(),current1.getQualifierOffset(),current1.getQualifierLength(),Q2,0,Q2.length));
        assertTrue(Bytes.equals(current1.getValueArray(),current1.getValueOffset(),current1.getValueLength(),value2,0,value2.length));
        cellScanner1.advance();
        current1=cellScanner1.current();
        assertTrue(Bytes.equals(current1.getRowArray(),current1.getRowOffset(),current1.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current1.getQualifierArray(),current1.getQualifierOffset(),current1.getQualifierLength(),Q3,0,Q3.length));
        assertTrue(Bytes.equals(current1.getValueArray(),current1.getValueOffset(),current1.getValueLength(),value3,0,value3.length));
        Scan s2=new Scan();
        s2.setAuthorizations(new Authorizations(new String[]{SECRET}));
        ResultScanner scanner2=table.getScanner(s2);
        Result next2=scanner2.next();
        CellScanner cellScanner2=next2.cellScanner();
        cellScanner2.advance();
        Cell current2=cellScanner2.current();
        assertTrue(Bytes.equals(current2.getRowArray(),current2.getRowOffset(),current2.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current2.getQualifierArray(),current2.getQualifierOffset(),current2.getQualifierLength(),Q3,0,Q3.length));
        assertTrue(Bytes.equals(current2.getValueArray(),current2.getValueOffset(),current2.getValueLength(),value3,0,value3.length));
        assertFalse(cellScanner2.advance());
      }
       return null;
    }
  }
);
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      VisibilityLabelsResponse response=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        response=VisibilityClient.clearAuths(conn,new String[]{CONFIDENTIAL},"@testgroup");
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      return null;
    }
  }
);
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        authsResponse=VisibilityClient.getAuths(conn,"@testgroup");
      }
 catch (      Throwable e) {
        fail("Should not have failed");
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      assertEquals(0,authsList.size());
      return null;
    }
  }
);
  TESTUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
        Scan s1=new Scan();
        s1.setAuthorizations(new Authorizations(new String[]{SECRET,CONFIDENTIAL}));
        ResultScanner scanner1=table.getScanner(s1);
        Result[] next1=scanner1.next(1);
        assertTrue(next1.length == 1);
        CellScanner cellScanner1=next1[0].cellScanner();
        cellScanner1.advance();
        Cell current1=cellScanner1.current();
        assertTrue(Bytes.equals(current1.getRowArray(),current1.getRowOffset(),current1.getRowLength(),ROW_1,0,ROW_1.length));
        assertTrue(Bytes.equals(current1.getQualifierArray(),current1.getQualifierOffset(),current1.getQualifierLength(),Q3,0,Q3.length));
        assertTrue(Bytes.equals(current1.getValueArray(),current1.getValueOffset(),current1.getValueLength(),value3,0,value3.length));
        assertFalse(cellScanner1.advance());
      }
       return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityWithCheckAuths </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLabelsWithAppend() throws Throwable {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    @Override public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{TOPSECRET},USER.getShortName());
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  try (Table table=TEST_UTIL.createTable(tableName,fam)){
    final byte[] row1=Bytes.toBytes("row1");
    final byte[] val=Bytes.toBytes("a");
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Put put=new Put(row1);
          put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,val);
          put.setCellVisibility(new CellVisibility(TOPSECRET));
          table.put(put);
        }
         return null;
      }
    }
;
    USER.runAs(actiona);
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Append append=new Append(row1);
          append.add(fam,qual,Bytes.toBytes("b"));
          table.append(append);
        }
         return null;
      }
    }
;
    USER.runAs(actiona);
    actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Append append=new Append(row1);
          append.add(fam,qual,Bytes.toBytes("c"));
          append.setCellVisibility(new CellVisibility(PUBLIC));
          table.append(append);
          Assert.fail("Testcase should fail with AccesDeniedException");
        }
 catch (        Throwable t) {
          assertTrue(t.getMessage().contains("AccessDeniedException"));
        }
        return null;
      }
    }
;
    USER.runAs(actiona);
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVerifyAccessDeniedForInvalidUserAuths() throws Exception {
  PrivilegedExceptionAction<VisibilityLabelsResponse> action=new PrivilegedExceptionAction<VisibilityLabelsResponse>(){
    @Override public VisibilityLabelsResponse run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        return VisibilityClient.setAuths(conn,new String[]{TOPSECRET},USER.getShortName());
      }
 catch (      Throwable e) {
      }
      return null;
    }
  }
;
  SUPERUSER.runAs(action);
  final TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  Admin hBaseAdmin=TEST_UTIL.getHBaseAdmin();
  HColumnDescriptor colDesc=new HColumnDescriptor(fam);
  colDesc.setMaxVersions(5);
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(colDesc);
  hBaseAdmin.createTable(desc);
  try {
    TEST_UTIL.getHBaseAdmin().flush(tableName);
    PrivilegedExceptionAction<Void> actiona=new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
          Put p=new Put(row1);
          p.setCellVisibility(new CellVisibility(PUBLIC + "&" + TOPSECRET));
          p.addColumn(fam,qual,125l,value);
          table.put(p);
          Assert.fail("Testcase should fail with AccesDeniedException");
        }
 catch (        Throwable t) {
          assertTrue(t.getMessage().contains("AccessDeniedException"));
        }
        return null;
      }
    }
;
    USER.runAs(actiona);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestWithDisabledAuthorization </h4><pre class="type-4 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testManageUserAuths() throws Throwable {
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.setAuths(conn,new String[]{SECRET,CONFIDENTIAL},USER_RW.getShortName());
      }
 catch (      Throwable t) {
        fail("Should not have failed");
      }
      return null;
    }
  }
);
  PrivilegedExceptionAction<List<String>> getAuths=new PrivilegedExceptionAction<List<String>>(){
    public List<String> run() throws Exception {
      GetAuthsResponse authsResponse=null;
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        authsResponse=VisibilityClient.getAuths(conn,USER_RW.getShortName());
      }
 catch (      Throwable t) {
        fail("Should not have failed");
      }
      List<String> authsList=new ArrayList<String>();
      for (      ByteString authBS : authsResponse.getAuthList()) {
        authsList.add(Bytes.toString(authBS.toByteArray()));
      }
      return authsList;
    }
  }
;
  List<String> authsList=SUPERUSER.runAs(getAuths);
  assertEquals(2,authsList.size());
  assertTrue(authsList.contains(SECRET));
  assertTrue(authsList.contains(CONFIDENTIAL));
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.clearAuths(conn,new String[]{SECRET},USER_RW.getShortName());
      }
 catch (      Throwable t) {
        fail("Should not have failed");
      }
      return null;
    }
  }
);
  authsList=SUPERUSER.runAs(getAuths);
  assertEquals(1,authsList.size());
  assertTrue(authsList.contains(CONFIDENTIAL));
  SUPERUSER.runAs(new PrivilegedExceptionAction<Void>(){
    public Void run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf)){
        VisibilityClient.clearAuths(conn,new String[]{CONFIDENTIAL},USER_RW.getShortName());
      }
 catch (      Throwable t) {
        fail("Should not have failed");
      }
      return null;
    }
  }
);
  authsList=SUPERUSER.runAs(getAuths);
  assertEquals(0,authsList.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestSnapshotDescriptionUtils </h4><pre class="type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we throw an exception if there is no working snapshot directory when we attempt to
 * 'complete' the snapshot
 * @throws Exception on failure
 */
@Test public void testCompleteSnapshotWithNoSnapshotDirectoryFailure() throws Exception {
  Path snapshotDir=new Path(root,HConstants.SNAPSHOT_DIR_NAME);
  Path tmpDir=new Path(snapshotDir,".tmp");
  Path workingDir=new Path(tmpDir,"not_a_snapshot");
  assertFalse("Already have working snapshot dir: " + workingDir + " but shouldn't. Test file leak?",fs.exists(workingDir));
  SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("snapshot").build();
  try {
    SnapshotDescriptionUtils.completeSnapshot(snapshot,root,workingDir,fs);
    fail("Shouldn't successfully complete move of a non-existent directory.");
  }
 catch (  IOException e) {
    LOG.info("Correctly failed to move non-existant directory: " + e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestMetricsThriftServerSourceFactoryImpl </h4><pre class="type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompatabilityRegistered() throws Exception {
  assertNotNull(CompatibilitySingletonFactory.getInstance(MetricsThriftServerSourceFactory.class));
  assertTrue(CompatibilitySingletonFactory.getInstance(MetricsThriftServerSourceFactory.class) instanceof MetricsThriftServerSourceFactoryImpl);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestThriftServerCmdLine </h4><pre class="type-10 type-7 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=600000) public void testRunThriftServer() throws Exception {
  List<String> args=new ArrayList<String>();
  if (implType != null) {
    String serverTypeOption=implType.toString();
    assertTrue(serverTypeOption.startsWith("-"));
    args.add(serverTypeOption);
  }
  port=HBaseTestingUtility.randomFreePort();
  args.add("-" + ThriftServer.PORT_OPTION);
  args.add(String.valueOf(port));
  if (specifyFramed) {
    args.add("-" + ThriftServer.FRAMED_OPTION);
  }
  if (specifyBindIP) {
    args.add("-" + ThriftServer.BIND_OPTION);
    args.add(InetAddress.getLocalHost().getHostName());
  }
  if (specifyCompact) {
    args.add("-" + ThriftServer.COMPACT_OPTION);
  }
  args.add("start");
  thriftServer=new ThriftServer(TEST_UTIL.getConfiguration());
  startCmdLineThread(args.toArray(new String[args.size()]));
  for (int i=0; i < 100 && (thriftServer.serverRunner == null || thriftServer.serverRunner.tserver == null); i++) {
    Thread.sleep(100);
  }
  Class<? extends TServer> expectedClass=implType != null ? implType.serverClass : TBoundedThreadPoolServer.class;
  assertEquals(expectedClass,thriftServer.serverRunner.tserver.getClass());
  try {
    talkToThriftServer();
  }
 catch (  Exception ex) {
    clientSideException=ex;
  }
 finally {
    stopCmdLineThread();
  }
  if (clientSideException != null) {
    LOG.error("Thrift client threw an exception. Parameters:" + getParametersString(),clientSideException);
    throw new Exception(clientSideException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandler </h4><pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithFilter() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScanWithFilter" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithFilter".getBytes());
  scan.setStopRow("testScanWithFilter\uffff".getBytes());
  scan.setFilterString(wrap(("KeyOnlyFilter()").getBytes()));
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScanWithFilter" + i).getBytes(),results.get(i).getRow());
    assertEquals(0,results.get(i).getColumnValues().get(0).getValue().length);
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithBatchSize() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  for (int i=0; i < 100; i++) {
    String colNum=pad(i,(byte)3);
    TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(("col" + colNum).getBytes()),wrap(("val" + colNum).getBytes()));
    columnValues.add(columnValue);
  }
  TPut put=new TPut(wrap(("testScanWithBatchSize").getBytes()),columnValues);
  handler.put(table,put);
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScanWithBatchSize".getBytes());
  scan.setStopRow("testScanWithBatchSize\uffff".getBytes());
  scan.setBatchSize(10);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=null;
  for (int i=0; i < 10; i++) {
    results=handler.getScannerRows(scanId,1);
    assertEquals(1,results.size());
    List<TColumnValue> cols=results.get(0).getColumnValues();
    assertEquals(10,cols.size());
    for (int y=0; y < 10; y++) {
      int colNum=y + (10 * i);
      String colNumPad=pad(colNum,(byte)3);
      assertArrayEquals(("col" + colNumPad).getBytes(),cols.get(y).getQualifier());
    }
  }
  results=handler.getScannerRows(scanId,1);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,1);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAllTimestamps() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testDeleteAllTimestamps".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValueA.setTimestamp(System.currentTimeMillis() - 10);
  columnValues.add(columnValueA);
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  columnValueA.setTimestamp(System.currentTimeMillis());
  handler.put(table,put);
  TGet get=new TGet(wrap(rowName));
  get.setMaxVersions(2);
  TResult result=handler.get(table,get);
  assertEquals(2,result.getColumnValuesSize());
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<TColumn>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumn.setQualifier(qualifierAname);
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  delete.setDeleteType(TDeleteType.DELETE_COLUMNS);
  handler.deleteSingle(table,delete);
  get=new TGet(wrap(rowName));
  result=handler.get(table,get);
  assertNull(result.getRow());
  assertEquals(0,result.getColumnValuesSize());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckAndMutate() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  ByteBuffer row=wrap("row".getBytes());
  ByteBuffer family=wrap(familyAname);
  ByteBuffer qualifier=wrap(qualifierAname);
  ByteBuffer value=wrap(valueAname);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(family,wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(row,columnValuesB);
  putB.setColumnValues(columnValuesB);
  TRowMutations tRowMutations=new TRowMutations(row,Arrays.<TMutation>asList(TMutation.put(putB)));
  TResult result=handler.get(table,new TGet(row));
  assertEquals(0,result.getColumnValuesSize());
  assertFalse("Expected condition to not pass",handler.checkAndMutate(table,row,family,qualifier,TCompareOp.EQUAL,value,tRowMutations));
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(family,qualifier,value);
  columnValuesA.add(columnValueA);
  handler.put(table,new TPut(row,columnValuesA));
  result=handler.get(table,new TGet(row));
  assertEquals(1,result.getColumnValuesSize());
  assertTColumnValueEqual(columnValueA,result.getColumnValues().get(0));
  assertTrue("Expected condition to pass",handler.checkAndMutate(table,row,family,qualifier,TCompareOp.EQUAL,value,tRowMutations));
  result=handler.get(table,new TGet(row));
  assertEquals(2,result.getColumnValuesSize());
  assertTColumnValueEqual(columnValueA,result.getColumnValues().get(0));
  assertTColumnValueEqual(columnValueB,result.getColumnValues().get(1));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteMultiple() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  byte[] rowName1="testDeleteMultiple1".getBytes();
  byte[] rowName2="testDeleteMultiple2".getBytes();
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  List<TPut> puts=new ArrayList<TPut>();
  puts.add(new TPut(wrap(rowName1),columnValues));
  puts.add(new TPut(wrap(rowName2),columnValues));
  handler.putMultiple(table,puts);
  List<TDelete> deletes=new ArrayList<TDelete>();
  deletes.add(new TDelete(wrap(rowName1)));
  deletes.add(new TDelete(wrap(rowName2)));
  List<TDelete> deleteResults=handler.deleteMultiple(table,deletes);
  assertEquals(0,deleteResults.size());
  assertFalse(handler.exists(table,new TGet(wrap(rowName1))));
  assertFalse(handler.exists(table,new TGet(wrap(rowName2))));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * check that checkAndPut fails if the cell does not exist, then put in the cell, then check
 * that the checkAndPut succeeds.
 * @throws Exception
 */
@Test public void testCheckAndPut() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testCheckAndPut".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValuesA.add(columnValueA);
  TPut putA=new TPut(wrap(rowName),columnValuesA);
  putA.setColumnValues(columnValuesA);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(wrap(rowName),columnValuesB);
  putB.setColumnValues(columnValuesB);
  assertFalse(handler.checkAndPut(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),putB));
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertEquals(0,result.getColumnValuesSize());
  handler.put(table,putA);
  assertTrue(handler.checkAndPut(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),putB));
  result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  List<TColumnValue> returnedColumnValues=result.getColumnValues();
  List<TColumnValue> expectedColumnValues=new ArrayList<TColumnValue>();
  expectedColumnValues.add(columnValueA);
  expectedColumnValues.add(columnValueB);
  assertTColumnValuesEqual(expectedColumnValues,returnedColumnValues);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutTTL() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testPutTTL".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(Bytes.toBytes(1L))));
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  Map<ByteBuffer,ByteBuffer> attributes=new HashMap<>();
  long ttlTimeMs=2000L;
  attributes.put(wrap(Bytes.toBytes("_ttl")),wrap(Bytes.toBytes(ttlTimeMs)));
  put.setAttributes(attributes);
  handler.put(table,put);
  TGet getOne=new TGet(wrap(rowName));
  TResult resultOne=handler.get(table,getOne);
  assertArrayEquals(rowName,resultOne.getRow());
  assertEquals(1,resultOne.getColumnValuesSize());
  Thread.sleep(ttlTimeMs * 15);
  TGet getTwo=new TGet(wrap(rowName));
  TResult resultTwo=handler.get(table,getTwo);
  assertNull(resultTwo.getRow());
  assertEquals(0,resultTwo.getColumnValuesSize());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * check that checkAndDelete fails if the cell does not exist, then put in the cell, then
 * check that the checkAndDelete succeeds.
 * @throws Exception
 */
@Test public void testCheckAndDelete() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName="testCheckAndDelete".getBytes();
  ByteBuffer table=wrap(tableAname);
  List<TColumnValue> columnValuesA=new ArrayList<TColumnValue>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValuesA.add(columnValueA);
  TPut putA=new TPut(wrap(rowName),columnValuesA);
  putA.setColumnValues(columnValuesA);
  List<TColumnValue> columnValuesB=new ArrayList<TColumnValue>();
  TColumnValue columnValueB=new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname));
  columnValuesB.add(columnValueB);
  TPut putB=new TPut(wrap(rowName),columnValuesB);
  putB.setColumnValues(columnValuesB);
  handler.put(table,putB);
  TDelete delete=new TDelete(wrap(rowName));
  assertFalse(handler.checkAndDelete(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),delete));
  TGet get=new TGet(wrap(rowName));
  TResult result=handler.get(table,get);
  assertArrayEquals(rowName,result.getRow());
  assertTColumnValuesEqual(columnValuesB,result.getColumnValues());
  handler.put(table,putA);
  assertTrue(handler.checkAndDelete(table,wrap(rowName),wrap(familyAname),wrap(qualifierAname),wrap(valueAname),delete));
  result=handler.get(table,get);
  assertFalse(result.isSetRow());
  assertEquals(0,result.getColumnValuesSize());
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScan".getBytes());
  scan.setStopRow("testScan\uffff".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testScan" + i).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReverseScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testReverseScan" + i).getBytes()),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  scan.setReversed(true);
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testReverseScan\uffff".getBytes());
  scan.setStopRow("testReverseScan".getBytes());
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(("testReverseScan" + (9 - i)).getBytes(),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandlerWithLabels </h4><pre class="type-4 type-9 type-10 type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanWithVisibilityLabels() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<TColumnValue>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(("testScan" + i).getBytes()),columnValues);
    if (i == 5) {
      put.setCellVisibility(new TCellVisibility().setExpression(PUBLIC));
    }
 else {
      put.setCellVisibility(new TCellVisibility().setExpression("(" + SECRET + "|"+ CONFIDENTIAL+ ")"+ "&"+ "!"+ TOPSECRET));
    }
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<TColumn>();
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow("testScan".getBytes());
  scan.setStopRow("testScan\uffff".getBytes());
  TAuthorization tauth=new TAuthorization();
  List<String> labels=new ArrayList<String>();
  labels.add(SECRET);
  labels.add(PRIVATE);
  tauth.setLabels(labels);
  scan.setAuthorizations(tauth);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(9,results.size());
  Assert.assertFalse(Bytes.equals(results.get(5).getRow(),("testScan" + 5).getBytes()));
  for (int i=0; i < 9; i++) {
    if (i < 5) {
      assertArrayEquals(("testScan" + i).getBytes(),results.get(i).getRow());
    }
 else     if (i == 5) {
      continue;
    }
 else {
      assertArrayEquals(("testScan" + (i + 1)).getBytes(),results.get(i).getRow());
    }
  }
  results=handler.getScannerRows(scanId,9);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,9);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.trace.TestHTraceHooks </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTraceCreateTable() throws Exception {
  TraceScope tableCreationSpan=Trace.startSpan("creating table",Sampler.ALWAYS);
  Table table;
  try {
    table=TEST_UTIL.createTable(TableName.valueOf("table"),FAMILY_BYTES);
  }
  finally {
    tableCreationSpan.close();
  }
  TEST_UTIL.waitFor(1000,new Waiter.Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return rcvr.getSpans().size() >= 5;
    }
  }
);
  Collection<Span> spans=rcvr.getSpans();
  TraceTree traceTree=new TraceTree(spans);
  Collection<Span> roots=traceTree.getSpansByParent().find(ROOT_SPAN_ID);
  assertEquals(1,roots.size());
  Span createTableRoot=roots.iterator().next();
  assertEquals("creating table",createTableRoot.getDescription());
  int createTableCount=0;
  for (  Span s : traceTree.getSpansByParent().find(createTableRoot.getSpanId())) {
    if (s.getDescription().startsWith("MasterService.CreateTable")) {
      createTableCount++;
    }
  }
  assertTrue(createTableCount >= 1);
  assertTrue(traceTree.getSpansByParent().find(createTableRoot.getSpanId()).size() > 3);
  assertTrue(spans.size() > 5);
  Put put=new Put("row".getBytes());
  put.addColumn(FAMILY_BYTES,"col".getBytes(),"value".getBytes());
  TraceScope putSpan=Trace.startSpan("doing put",Sampler.ALWAYS);
  try {
    table.put(put);
  }
  finally {
    putSpan.close();
  }
  spans=rcvr.getSpans();
  traceTree=new TraceTree(spans);
  roots=traceTree.getSpansByParent().find(ROOT_SPAN_ID);
  assertEquals(2,roots.size());
  Span putRoot=null;
  for (  Span root : roots) {
    if (root.getDescription().equals("doing put")) {
      putRoot=root;
    }
  }
  assertNotNull(putRoot);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestCopyOnWriteMaps </h4><pre class="type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindOnEmpty() throws Exception {
  m.clear();
  assertTrue(m.isEmpty());
  assertNull(m.get(100L));
  assertFalse(m.containsKey(100L));
  assertEquals(0,m.tailMap(100L).entrySet().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestFixedLengthWrapper </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite(){
  for (  int limit : limits) {
    PositionedByteRange buff=new SimplePositionedMutableByteRange(limit);
    for (    Order ord : new Order[]{Order.ASCENDING,Order.DESCENDING}) {
      for (      byte[] val : VALUES) {
        buff.setPosition(0);
        DataType<byte[]> type=new FixedLengthWrapper<byte[]>(new RawBytes(ord),limit);
        assertEquals(limit,type.encode(buff,val));
        buff.setPosition(0);
        byte[] actual=type.decode(buff);
        assertTrue("Decoding output differs from expected",Bytes.equals(val,0,val.length,actual,0,val.length));
        buff.setPosition(0);
        assertEquals(limit,type.skip(buff));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestPBCell </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic test to verify utility methods in {@link PBType} and delegation to protobuf works.
 */
@Test public void testRoundTrip(){
  final Cell cell=new KeyValue(Bytes.toBytes("row"),Bytes.toBytes("fam"),Bytes.toBytes("qual"),Bytes.toBytes("val"));
  CellProtos.Cell c=ProtobufUtil.toCell(cell), decoded;
  PositionedByteRange pbr=new SimplePositionedByteRange(c.getSerializedSize());
  pbr.setPosition(0);
  int encodedLength=CODEC.encode(pbr,c);
  pbr.setPosition(0);
  decoded=CODEC.decode(pbr);
  assertEquals(encodedLength,pbr.getPosition());
  assertTrue(CellUtil.equals(cell,ProtobufUtil.toCell(decoded)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestStructNullExtension </h4><pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Positive cases for null extension.
 */
@Test public void testNullableNullExtension(){
  StructBuilder builder=new StructBuilder().add(OrderedNumeric.ASCENDING).add(OrderedString.ASCENDING);
  Struct shorter=builder.toStruct();
  Struct longer=builder.add(new TerminatedWrapper<String>(OrderedString.ASCENDING,"/")).add(OrderedNumeric.ASCENDING).toStruct();
  PositionedByteRange buf1=new SimplePositionedMutableByteRange(7);
  Object[] val1=new Object[]{BigDecimal.ONE,"foo"};
  assertEquals("Encoding shorter value wrote a surprising number of bytes.",buf1.getLength(),shorter.encode(buf1,val1));
  int shortLen=buf1.getLength();
  buf1.setPosition(0);
  StructIterator it=longer.iterator(buf1);
  it.skip();
  it.skip();
  assertEquals("Position should be at end. Broken test.",buf1.getLength(),buf1.getPosition());
  assertEquals("Failed to skip null element with extended struct.",0,it.skip());
  assertEquals("Failed to skip null element with extended struct.",0,it.skip());
  buf1.setPosition(0);
  it=longer.iterator(buf1);
  assertEquals(BigDecimal.ONE,it.next());
  assertEquals("foo",it.next());
  assertEquals("Position should be at end. Broken test.",buf1.getLength(),buf1.getPosition());
  assertNull("Failed to skip null element with extended struct.",it.next());
  assertNull("Failed to skip null element with extended struct.",it.next());
  buf1.setPosition(0);
  assertArrayEquals("Simple struct decoding is broken.",val1,shorter.decode(buf1));
  buf1.setPosition(0);
  assertArrayEquals("Decoding short value with extended struct should append null elements.",Arrays.copyOf(val1,4),longer.decode(buf1));
  PositionedByteRange buf2=new SimplePositionedMutableByteRange(7);
  buf1.setPosition(0);
  assertEquals("Encoding a short value with extended struct should have same result as using short struct.",shortLen,longer.encode(buf2,val1));
  assertArrayEquals("Encoding a short value with extended struct should have same result as using short struct",buf1.getBytes(),buf2.getBytes());
  val1=new Object[]{null,null,null,null};
  buf1.set(0);
  buf2.set(0);
  assertEquals("Encoding null-truncated value wrote a surprising number of bytes.",buf1.getLength(),longer.encode(buf1,new Object[0]));
  assertEquals("Encoding null-extended value wrote a surprising number of bytes.",buf1.getLength(),longer.encode(buf1,val1));
  assertArrayEquals("Encoded unexpected result.",buf1.getBytes(),buf2.getBytes());
  assertArrayEquals("Decoded unexpected result.",val1,longer.decode(buf2));
  Object[] val2=new Object[]{BigDecimal.ONE,null,null,null};
  buf1.set(2);
  buf2.set(2);
  assertEquals("Encoding null-truncated value wrote a surprising number of bytes.",buf1.getLength(),longer.encode(buf1,Arrays.copyOf(val2,1)));
  assertEquals("Encoding null-extended value wrote a surprising number of bytes.",buf2.getLength(),longer.encode(buf2,val2));
  assertArrayEquals("Encoded unexpected result.",buf1.getBytes(),buf2.getBytes());
  buf2.setPosition(0);
  assertArrayEquals("Decoded unexpected result.",val2,longer.decode(buf2));
  Object[] val3=new Object[]{BigDecimal.ONE,null,"foo",null};
  buf1.set(9);
  buf2.set(9);
  assertEquals("Encoding null-truncated value wrote a surprising number of bytes.",buf1.getLength(),longer.encode(buf1,Arrays.copyOf(val3,3)));
  assertEquals("Encoding null-extended value wrote a surprising number of bytes.",buf2.getLength(),longer.encode(buf2,val3));
  assertArrayEquals("Encoded unexpected result.",buf1.getBytes(),buf2.getBytes());
  buf2.setPosition(0);
  assertArrayEquals("Decoded unexpected result.",val3,longer.decode(buf2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestBoundedArrayQueue </h4><pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBoundedArrayQueueOperations() throws Exception {
  assertEquals(0,queue.size());
  assertNull(queue.poll());
  assertNull(queue.peek());
  for (int i=0; i < qMaxElements; i++) {
    assertTrue(queue.offer(i));
  }
  assertEquals(qMaxElements,queue.size());
  assertFalse(queue.offer(0));
  assertEquals(0,queue.peek().intValue());
  assertEquals(0,queue.peek().intValue());
  for (int i=0; i < qMaxElements; i++) {
    assertEquals(i,queue.poll().intValue());
  }
  assertEquals(0,queue.size());
  assertNull(queue.poll());
  assertTrue(queue.offer(100));
  assertTrue(queue.offer(1000));
  assertEquals(100,queue.peek().intValue());
  assertEquals(100,queue.poll().intValue());
  assertEquals(1000,queue.poll().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestBoundedPriorityBlockingQueue </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsert() throws Exception {
  for (int i=1; i <= CAPACITY; i+=2) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals((1 + i) / 2,queue.size());
  }
  for (int i=2; i <= CAPACITY; i+=2) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals(CAPACITY / 2 + (i / 2),queue.size());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-16 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testPollInExecutor() throws InterruptedException {
  final TestObject testObj=new TestObject(0,0);
  final CyclicBarrier threadsStarted=new CyclicBarrier(2);
  ExecutorService executor=Executors.newFixedThreadPool(2);
  executor.execute(new Runnable(){
    public void run(){
      try {
        assertNull(queue.poll(1000,TimeUnit.MILLISECONDS));
        threadsStarted.await();
        assertSame(testObj,queue.poll(1000,TimeUnit.MILLISECONDS));
        assertTrue(queue.isEmpty());
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  executor.execute(new Runnable(){
    public void run(){
      try {
        threadsStarted.await();
        queue.offer(testObj);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  executor.shutdown();
  assertTrue(executor.awaitTermination(8000,TimeUnit.MILLISECONDS));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPoll(){
  assertNull(queue.poll());
  PriorityQueue<TestObject> testList=new PriorityQueue<TestObject>(CAPACITY,new TestObjectComparator());
  for (int i=0; i < CAPACITY; ++i) {
    TestObject obj=new TestObject(i,i);
    testList.add(obj);
    queue.offer(obj);
  }
  for (int i=0; i < CAPACITY; ++i) {
    assertEquals(testList.poll(),queue.poll());
  }
  assertNull(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFifoSamePriority() throws Exception {
  assertTrue(CAPACITY >= 6);
  for (int i=0; i < 6; ++i) {
    assertTrue(queue.offer(new TestObject((1 + (i % 2)) * 10,i)));
  }
  for (int i=0; i < 6; i+=2) {
    TestObject obj=queue.poll();
    assertEquals(10,obj.getPriority());
    assertEquals(i,obj.getSeqId());
  }
  for (int i=1; i < 6; i+=2) {
    TestObject obj=queue.poll();
    assertEquals(20,obj.getPriority());
    assertEquals(i,obj.getSeqId());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesAppend() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(i,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesAppendSamePriority() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(0,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  assertFalse(queue.offer(new TestObject(0,-1),5,TimeUnit.MILLISECONDS));
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(i,obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepend() throws Exception {
  for (int i=1; i <= CAPACITY; ++i) {
    assertTrue(queue.offer(new TestObject(CAPACITY - i,i)));
    assertEquals(i,queue.size());
    assertEquals(CAPACITY - i,queue.remainingCapacity());
  }
  for (int i=1; i <= CAPACITY; ++i) {
    TestObject obj=queue.poll();
    assertEquals(CAPACITY - (i - 1),obj.getSeqId());
    assertEquals(CAPACITY - i,queue.size());
    assertEquals(i,queue.remainingCapacity());
  }
  assertEquals(null,queue.poll());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestByteBufferUtils </h4><pre class="type-4 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareTo(){
  ByteBuffer bb1=ByteBuffer.allocate(135);
  ByteBuffer bb2=ByteBuffer.allocate(135);
  byte[] b=new byte[71];
  fillBB(bb1,(byte)5);
  fillBB(bb2,(byte)5);
  fillArray(b,(byte)5);
  assertEquals(0,ByteBufferUtils.compareTo(bb1,0,bb1.remaining(),bb2,0,bb2.remaining()));
  assertTrue(ByteBufferUtils.compareTo(bb1,0,bb1.remaining(),b,0,b.length) > 0);
  bb2.put(134,(byte)6);
  assertTrue(ByteBufferUtils.compareTo(bb1,0,bb1.remaining(),bb2,0,bb2.remaining()) < 0);
  bb2.put(6,(byte)4);
  assertTrue(ByteBufferUtils.compareTo(bb1,0,bb1.remaining(),bb2,0,bb2.remaining()) > 0);
  ByteBuffer bb3=ByteBuffer.allocate(135);
  fillBB(bb3,(byte)0);
  byte[] b3=new byte[135];
  fillArray(b3,(byte)1);
  int result=ByteBufferUtils.compareTo(b3,0,b3.length,bb3,0,bb3.remaining());
  assertTrue(result > 0);
  result=ByteBufferUtils.compareTo(bb3,0,bb3.remaining(),b3,0,b3.length);
  assertTrue(result < 0);
}

</code></pre>

<br>
<pre class="type-4 type-11 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test copying to stream from buffer.
 */
@Test public void testMoveBufferToStream(){
  final int arrayOffset=7;
  final int initialPosition=10;
  final int endPadding=5;
  byte[] arrayWrapper=new byte[arrayOffset + initialPosition + array.length+ endPadding];
  System.arraycopy(array,0,arrayWrapper,arrayOffset + initialPosition,array.length);
  ByteBuffer buffer=ByteBuffer.wrap(arrayWrapper,arrayOffset,initialPosition + array.length).slice();
  assertEquals(initialPosition + array.length,buffer.limit());
  assertEquals(0,buffer.position());
  buffer.position(initialPosition);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  try {
    ByteBufferUtils.moveBufferToStream(bos,buffer,array.length);
  }
 catch (  IOException e) {
    fail("IOException in testCopyToStream()");
  }
  assertArrayEquals(array,bos.toByteArray());
  assertEquals(initialPosition + array.length,buffer.position());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestByteRangeWithKVSerialization </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWritingAndReadingCells() throws Exception {
  final byte[] FAMILY=Bytes.toBytes("f1");
  final byte[] QUALIFIER=Bytes.toBytes("q1");
  final byte[] VALUE=Bytes.toBytes("v");
  int kvCount=1000000;
  List<KeyValue> kvs=new ArrayList<KeyValue>(kvCount);
  int totalSize=0;
  Tag[] tags=new Tag[]{new ArrayBackedTag((byte)1,"tag1")};
  for (int i=0; i < kvCount; i++) {
    KeyValue kv=new KeyValue(Bytes.toBytes(i),FAMILY,QUALIFIER,i,VALUE,tags);
    kv.setSequenceId(i);
    kvs.add(kv);
    totalSize+=kv.getLength() + Bytes.SIZEOF_LONG;
  }
  PositionedByteRange pbr=new SimplePositionedMutableByteRange(totalSize);
  for (  KeyValue kv : kvs) {
    writeCell(pbr,kv);
  }
  PositionedByteRange pbr1=new SimplePositionedMutableByteRange(pbr.getBytes(),0,pbr.getPosition());
  for (int i=0; i < kvCount; i++) {
    KeyValue kv=readCell(pbr1);
    KeyValue kv1=kvs.get(i);
    Assert.assertTrue(kv.equals(kv1));
    Assert.assertTrue(Bytes.equals(kv.getValueArray(),kv.getValueOffset(),kv.getValueLength(),kv1.getValueArray(),kv1.getValueOffset(),kv1.getValueLength()));
    Assert.assertTrue(Bytes.equals(kv.getTagsArray(),kv.getTagsOffset(),kv.getTagsLength(),kv1.getTagsArray(),kv1.getTagsOffset(),kv1.getTagsLength()));
    Assert.assertEquals(kv1.getSequenceId(),kv.getSequenceId());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestCompressionTest </h4><pre class="type-11 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExceptionCaching(){
  try {
    CompressionTest.testCompression(Compression.Algorithm.LZO);
    fail();
  }
 catch (  IOException e) {
    assertNotNull(e.getCause());
  }
  try {
    CompressionTest.testCompression(Compression.Algorithm.LZO);
    fail();
  }
 catch (  IOException e) {
    assertNull(e.getCause());
  }
  assertFalse(CompressionTest.testCompression("LZO"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestCoprocessorClassLoader </h4><pre class="type-4 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCleanupOldJars() throws Exception {
  String className="TestCleanupOldJars";
  String folder=TEST_UTIL.getDataTestDir().toString();
  File jarFile=ClassLoaderTestHelper.buildJar(folder,className,null,ClassLoaderTestHelper.localDirPath(conf));
  File tmpJarFile=new File(jarFile.getParent(),"/tmp/" + className + ".test.jar");
  if (tmpJarFile.exists())   tmpJarFile.delete();
  assertFalse("tmp jar file should not exist",tmpJarFile.exists());
  IOUtils.copyBytes(new FileInputStream(jarFile),new FileOutputStream(tmpJarFile),conf,true);
  assertTrue("tmp jar file should be created",tmpJarFile.exists());
  Path path=new Path(jarFile.getAbsolutePath());
  ClassLoader parent=TestCoprocessorClassLoader.class.getClassLoader();
  CoprocessorClassLoader.parentDirLockSet.clear();
  ClassLoader classLoader=CoprocessorClassLoader.getClassLoader(path,parent,"111",conf);
  assertNotNull("Classloader should be created",classLoader);
  assertFalse("tmp jar file should be removed",tmpJarFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestDefaultEnvironmentEdge </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCurrentTimeUsesSystemClock(){
  DefaultEnvironmentEdge edge=new DefaultEnvironmentEdge();
  long systemTime=System.currentTimeMillis();
  long edgeTime=edge.currentTime();
  assertTrue("System time must be either the same or less than the edge time",systemTime < edgeTime || systemTime == edgeTime);
  try {
    Thread.sleep(1);
  }
 catch (  InterruptedException e) {
    fail(e.getMessage());
  }
  long secondEdgeTime=edge.currentTime();
  assertTrue("Second time must be greater than the first",secondEdgeTime > edgeTime);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestDrainBarrier </h4><pre class="type-11 type-7 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStopIsBlockedByOps() throws Exception {
  final DrainBarrier barrier=new DrainBarrier();
  barrier.beginOp();
  barrier.beginOp();
  barrier.beginOp();
  barrier.endOp();
  Thread stoppingThread=new Thread(new Runnable(){
    @Override public void run(){
      try {
        barrier.stopAndDrainOpsOnce();
      }
 catch (      InterruptedException e) {
        fail("Should not have happened");
      }
    }
  }
);
  stoppingThread.start();
  barrier.endOp();
  stoppingThread.join(1000);
  assertTrue(stoppingThread.isAlive());
  barrier.endOp();
  stoppingThread.join(30000);
  assertFalse(stoppingThread.isAlive());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestEnvironmentEdgeManager </h4><pre class="type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManageSingleton(){
  EnvironmentEdgeManager.reset();
  EnvironmentEdge edge=EnvironmentEdgeManager.getDelegate();
  assertNotNull(edge);
  assertTrue(edge instanceof DefaultEnvironmentEdge);
  EnvironmentEdgeManager.reset();
  EnvironmentEdge edge2=EnvironmentEdgeManager.getDelegate();
  assertFalse(edge == edge2);
  IncrementingEnvironmentEdge newEdge=new IncrementingEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(newEdge);
  assertEquals(newEdge,EnvironmentEdgeManager.getDelegate());
  EnvironmentEdgeManager.injectEdge(null);
  EnvironmentEdge nullResult=EnvironmentEdgeManager.getDelegate();
  assertTrue(nullResult instanceof DefaultEnvironmentEdge);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFSTableDescriptors </h4><pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableDescriptors() throws IOException, InterruptedException {
  final String name="testHTableDescriptors";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  FSTableDescriptors htds=new FSTableDescriptors(UTIL.getConfiguration(),fs,rootdir){
    @Override public HTableDescriptor get(    TableName tablename) throws TableExistsException, FileNotFoundException, IOException {
      LOG.info(tablename + ", cachehits=" + this.cachehits);
      return super.get(tablename);
    }
  }
;
  final int count=10;
  for (int i=0; i < count; i++) {
    TableDescriptor htd=new TableDescriptor(new HTableDescriptor(TableName.valueOf(name + i)));
    htds.createTableDescriptor(htd);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name + i));
    htd.addFamily(new HColumnDescriptor("" + i));
    htds.updateTableDescriptor(new TableDescriptor(htd));
  }
  Thread.sleep(100);
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  for (int i=0; i < count; i++) {
    assertTrue(htds.get(TableName.valueOf(name + i)) != null);
  }
  assertEquals(count * 4,htds.invocations);
  assertTrue("expected=" + (count * 2) + ", actual="+ htds.cachehits,htds.cachehits >= (count * 2));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTableDescriptorUpdatesIfExistsAlready() throws IOException {
  Path testdir=UTIL.getDataTestDir("testCreateTableDescriptorUpdatesIfThereExistsAlready");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testCreateTableDescriptorUpdatesIfThereExistsAlready"));
  TableDescriptor td=new TableDescriptor(htd);
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  FSTableDescriptors fstd=new FSTableDescriptors(UTIL.getConfiguration(),fs,testdir);
  assertTrue(fstd.createTableDescriptor(td));
  assertFalse(fstd.createTableDescriptor(td));
  htd.setValue(Bytes.toBytes("mykey"),Bytes.toBytes("myValue"));
  assertTrue(fstd.createTableDescriptor(td));
  Path tableDir=fstd.getTableDir(htd.getTableName());
  Path tmpTableDir=new Path(tableDir,FSTableDescriptors.TMP_DIR);
  FileStatus[] statuses=fs.listStatus(tmpTableDir);
  assertTrue(statuses.length == 0);
  assertEquals(td,FSTableDescriptors.getTableDescriptorFromFs(fs,tableDir));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFormatTableInfoSequenceId(){
  Path p0=assertWriteAndReadSequenceId(0);
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < FSTableDescriptors.WIDTH_OF_SEQUENCE_ID; i++) {
    sb.append("0");
  }
  assertEquals(FSTableDescriptors.TABLEINFO_FILE_PREFIX + "." + sb.toString(),p0.getName());
  Path p2=assertWriteAndReadSequenceId(2);
  Path p10000=assertWriteAndReadSequenceId(10000);
  Path p=new Path(p0.getParent(),FSTableDescriptors.TABLEINFO_FILE_PREFIX);
  FileStatus fs=new FileStatus(0,false,0,0,0,p);
  FileStatus fs0=new FileStatus(0,false,0,0,0,p0);
  FileStatus fs2=new FileStatus(0,false,0,0,0,p2);
  FileStatus fs10000=new FileStatus(0,false,0,0,0,p10000);
  Comparator<FileStatus> comparator=FSTableDescriptors.TABLEINFO_FILESTATUS_COMPARATOR;
  assertTrue(comparator.compare(fs,fs0) > 0);
  assertTrue(comparator.compare(fs0,fs2) > 0);
  assertTrue(comparator.compare(fs2,fs10000) > 0);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testRegexAgainstOldStyleTableInfo(){
  Path p=new Path("/tmp",FSTableDescriptors.TABLEINFO_FILE_PREFIX);
  int i=FSTableDescriptors.getTableInfoSequenceId(p);
  assertEquals(0,i);
  p=new Path("/tmp","abc");
  FSTableDescriptors.getTableInfoSequenceId(p);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceIdAdvancesOnTableInfo() throws IOException {
  Path testdir=UTIL.getDataTestDir("testSequenceidAdvancesOnTableInfo");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testSequenceidAdvancesOnTableInfo"));
  TableDescriptor td=new TableDescriptor(htd);
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  FSTableDescriptors fstd=new FSTableDescriptors(UTIL.getConfiguration(),fs,testdir);
  Path p0=fstd.updateTableDescriptor(td);
  int i0=FSTableDescriptors.getTableInfoSequenceId(p0);
  Path p1=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p0));
  int i1=FSTableDescriptors.getTableInfoSequenceId(p1);
  assertTrue(i1 == i0 + 1);
  Path p2=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p1));
  int i2=FSTableDescriptors.getTableInfoSequenceId(p2);
  assertTrue(i2 == i1 + 1);
  td=new TableDescriptor(htd);
  Path p3=fstd.updateTableDescriptor(td);
  assertTrue(!fs.exists(p2));
  int i3=FSTableDescriptors.getTableInfoSequenceId(p3);
  assertTrue(i3 == i2 + 1);
  TableDescriptor descriptor=fstd.getDescriptor(htd.getTableName());
  assertEquals(descriptor,td);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHTableDescriptorsNoCache() throws IOException, InterruptedException {
  final String name="testHTableDescriptorsNoCache";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  FSTableDescriptors htds=new FSTableDescriptorsTest(UTIL.getConfiguration(),fs,rootdir,false,false);
  final int count=10;
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(name + i);
    htds.createTableDescriptor(htd);
  }
  for (int i=0; i < 2 * count; i++) {
    assertNotNull("Expected HTD, got null instead",htds.get(TableName.valueOf(name + i % 2)));
  }
  for (int i=0; i < count; i++) {
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name + i));
    htd.addFamily(new HColumnDescriptor("" + i));
    htds.updateTableDescriptor(new TableDescriptor(htd));
  }
  for (int i=0; i < count; i++) {
    assertNotNull("Expected HTD, got null instead",htds.get(TableName.valueOf(name + i)));
    assertTrue("Column Family " + i + " missing",htds.get(TableName.valueOf(name + i)).hasFamily(Bytes.toBytes("" + i)));
  }
  assertEquals(count * 4,htds.invocations);
  assertEquals("expected=0, actual=" + htds.cachehits,0,htds.cachehits);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFSUtils </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenameAndSetModifyTime() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  Configuration conf=htu.getConfiguration();
  MiniDFSCluster cluster=htu.startMiniDFSCluster(1);
  assertTrue(FSUtils.isHDFS(conf));
  FileSystem fs=FileSystem.get(conf);
  Path testDir=htu.getDataTestDirOnTestFS("testArchiveFile");
  String file=UUID.randomUUID().toString();
  Path p=new Path(testDir,file);
  FSDataOutputStream out=fs.create(p);
  out.close();
  assertTrue("The created file should be present",FSUtils.isExists(fs,p));
  long expect=System.currentTimeMillis() + 1000;
  assertNotEquals(expect,fs.getFileStatus(p).getModificationTime());
  ManualEnvironmentEdge mockEnv=new ManualEnvironmentEdge();
  mockEnv.setValue(expect);
  EnvironmentEdgeManager.injectEdge(mockEnv);
  try {
    String dstFile=UUID.randomUUID().toString();
    Path dst=new Path(testDir,dstFile);
    assertTrue(FSUtils.renameAndSetModifyTime(fs,p,dst));
    assertFalse("The moved file should not be present",FSUtils.isExists(fs,p));
    assertTrue("The dst file should be present",FSUtils.isExists(fs,dst));
    assertEquals(expect,fs.getFileStatus(dst).getModificationTime());
    cluster.shutdown();
  }
  finally {
    EnvironmentEdgeManager.reset();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ugly test that ensures we can get at the hedged read counters in dfsclient.
 * Does a bit of preading with hedged reads enabled using code taken from hdfs TestPread.
 * @throws Exception
 */
@Test public void testDFSHedgedReadMetrics() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  Configuration conf=htu.getConfiguration();
  conf.setInt(DFSConfigKeys.DFS_DFSCLIENT_HEDGED_READ_THREADPOOL_SIZE,5);
  conf.setLong(DFSConfigKeys.DFS_DFSCLIENT_HEDGED_READ_THRESHOLD_MILLIS,0);
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,4096);
  conf.setLong(DFSConfigKeys.DFS_CLIENT_READ_PREFETCH_SIZE_KEY,4096);
  conf.setInt(DFSConfigKeys.DFS_CLIENT_RETRY_WINDOW_BASE,0);
  conf.setBoolean("dfs.datanode.transferTo.allowed",false);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(3).build();
  DFSHedgedReadMetrics metrics=FSUtils.getDFSHedgedReadMetrics(conf);
  assertEquals(0,metrics.getHedgedReadOps());
  FileSystem fileSys=cluster.getFileSystem();
  try {
    Path p=new Path("preadtest.dat");
    DFSTestUtil.createFile(fileSys,p,12 * blockSize,12 * blockSize,blockSize,(short)3,seed);
    pReadFile(fileSys,p);
    cleanupFile(fileSys,p);
    assertTrue(metrics.getHedgedReadOps() > 0);
  }
  finally {
    fileSys.close();
    cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVersion() throws DeserializationException, IOException {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  final FileSystem fs=htu.getTestFileSystem();
  final Path rootdir=htu.getDataTestDir();
  assertNull(FSUtils.getVersion(fs,rootdir));
  Path versionFile=new Path(rootdir,HConstants.VERSION_FILE_NAME);
  FSDataOutputStream s=fs.create(versionFile);
  final String version=HConstants.FILE_SYSTEM_VERSION;
  s.writeUTF(version);
  s.close();
  assertTrue(fs.exists(versionFile));
  FileStatus[] status=fs.listStatus(versionFile);
  assertNotNull(status);
  assertTrue(status.length > 0);
  String newVersion=FSUtils.getVersion(fs,rootdir);
  assertEquals(version.length(),newVersion.length());
  assertEquals(version,newVersion);
  assertEquals(version,FSUtils.getVersion(fs,rootdir));
  FSUtils.checkVersion(fs,rootdir,true);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testcomputeHDFSBlocksDistribution() throws Exception {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  final int DEFAULT_BLOCK_SIZE=1024;
  htu.getConfiguration().setLong("dfs.blocksize",DEFAULT_BLOCK_SIZE);
  MiniDFSCluster cluster=null;
  Path testFile=null;
  try {
    String hosts[]=new String[]{"host1","host2","host3"};
    cluster=htu.startMiniDFSCluster(hosts);
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    testFile=new Path("/test1.txt");
    WriteDataToHDFS(fs,testFile,2 * DEFAULT_BLOCK_SIZE);
    final long maxTime=System.currentTimeMillis() + 2000;
    boolean ok;
    do {
      ok=true;
      FileStatus status=fs.getFileStatus(testFile);
      HDFSBlocksDistribution blocksDistribution=FSUtils.computeHDFSBlocksDistribution(fs,status,0,status.getLen());
      long uniqueBlocksTotalWeight=blocksDistribution.getUniqueBlocksTotalWeight();
      for (      String host : hosts) {
        long weight=blocksDistribution.getWeight(host);
        ok=(ok && uniqueBlocksTotalWeight == weight);
      }
    }
 while (!ok && System.currentTimeMillis() < maxTime);
    assertTrue(ok);
  }
  finally {
    htu.shutdownMiniDFSCluster();
  }
  try {
    String hosts[]=new String[]{"host1","host2","host3","host4"};
    cluster=htu.startMiniDFSCluster(hosts);
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    testFile=new Path("/test2.txt");
    WriteDataToHDFS(fs,testFile,3 * DEFAULT_BLOCK_SIZE);
    final long maxTime=System.currentTimeMillis() + 2000;
    long weight;
    long uniqueBlocksTotalWeight;
    do {
      FileStatus status=fs.getFileStatus(testFile);
      HDFSBlocksDistribution blocksDistribution=FSUtils.computeHDFSBlocksDistribution(fs,status,0,status.getLen());
      uniqueBlocksTotalWeight=blocksDistribution.getUniqueBlocksTotalWeight();
      String tophost=blocksDistribution.getTopHosts().get(0);
      weight=blocksDistribution.getWeight(tophost);
    }
 while (uniqueBlocksTotalWeight != weight && System.currentTimeMillis() < maxTime);
    assertTrue(uniqueBlocksTotalWeight == weight);
  }
  finally {
    htu.shutdownMiniDFSCluster();
  }
  try {
    String hosts[]=new String[]{"host1","host2","host3","host4"};
    cluster=htu.startMiniDFSCluster(hosts);
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    testFile=new Path("/test3.txt");
    WriteDataToHDFS(fs,testFile,DEFAULT_BLOCK_SIZE);
    final long maxTime=System.currentTimeMillis() + 2000;
    HDFSBlocksDistribution blocksDistribution;
    do {
      FileStatus status=fs.getFileStatus(testFile);
      blocksDistribution=FSUtils.computeHDFSBlocksDistribution(fs,status,0,status.getLen());
    }
 while (blocksDistribution.getTopHosts().size() != 3 && System.currentTimeMillis() < maxTime);
    assertEquals("Wrong number of hosts distributing blocks.",3,blocksDistribution.getTopHosts().size());
  }
  finally {
    htu.shutdownMiniDFSCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckEncryption </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsckWithEncryption() throws Exception {
  Table table=TEST_UTIL.getConnection().getTable(htd.getTableName());
  try {
    byte[] values={'A','B','C','D'};
    for (int i=0; i < values.length; i++) {
      for (int j=0; j < values.length; j++) {
        Put put=new Put(new byte[]{values[i],values[j]});
        put.addColumn(Bytes.toBytes("cf"),new byte[]{},new byte[]{values[i],values[j]});
        table.put(put);
      }
    }
  }
  finally {
    table.close();
  }
  TEST_UTIL.getHBaseAdmin().flush(htd.getTableName());
  final List<Path> paths=findStorefilePaths(htd.getTableName());
  assertTrue(paths.size() > 0);
  for (  Path path : paths) {
    assertTrue("Store file " + path + " has incorrect key",Bytes.equals(cfKey.getEncoded(),extractHFileKey(path)));
  }
  HBaseFsck res=HbckTestingUtil.doHFileQuarantine(conf,htd.getTableName());
  assertEquals(res.getRetCode(),0);
  HFileCorruptionChecker hfcc=res.getHFilecorruptionChecker();
  assertEquals(hfcc.getCorrupted().size(),0);
  assertEquals(hfcc.getFailures().size(),0);
  assertEquals(hfcc.getQuarantined().size(),0);
  assertEquals(hfcc.getMissing().size(),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckOneRS </h4><pre class="type-9 type-10 type-11 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testHbckAfterRegionMerge() throws Exception {
  TableName table=TableName.valueOf("testMergeRegionFilesInHdfs");
  Table meta=null;
  try {
    TEST_UTIL.getHBaseCluster().getMaster().setCatalogJanitorEnabled(false);
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    try (RegionLocator rl=connection.getRegionLocator(tbl.getName())){
      admin.flush(table);
      HRegionInfo region1=rl.getRegionLocation(Bytes.toBytes("A")).getRegionInfo();
      HRegionInfo region2=rl.getRegionLocation(Bytes.toBytes("B")).getRegionInfo();
      int regionCountBeforeMerge=rl.getAllRegionLocations().size();
      assertNotEquals(region1,region2);
      admin.mergeRegions(region1.getEncodedNameAsBytes(),region2.getEncodedNameAsBytes(),false);
      long timeout=System.currentTimeMillis() + 30 * 1000;
      while (true) {
        if (rl.getAllRegionLocations().size() < regionCountBeforeMerge) {
          break;
        }
 else         if (System.currentTimeMillis() > timeout) {
          fail("Time out waiting on region " + region1.getEncodedName() + " and "+ region2.getEncodedName()+ " be merged");
        }
        Thread.sleep(10);
      }
      assertEquals(ROWKEYS.length,countRows());
      HBaseFsck hbck=doFsck(conf,false);
      assertNoErrors(hbck);
    }
   }
  finally {
    TEST_UTIL.getHBaseCluster().getMaster().setCatalogJanitorEnabled(true);
    cleanupTable(table);
    IOUtils.closeQuietly(meta);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test -fixHdfsHoles doesn't work with -noHdfsChecking option,
 * and -noHdfsChecking can't detect orphan Hdfs region.
 */
@Test(timeout=180000) public void testFixHdfsHolesNotWorkingWithNoHdfsChecking() throws Exception {
  TableName table=TableName.valueOf("testFixHdfsHolesNotWorkingWithNoHdfsChecking");
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    admin.disableTable(table);
    deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("B"),true,true,false,true,HRegionInfo.DEFAULT_REPLICA_ID);
    admin.enableTable(table);
    HRegionInfo hriOverlap=createRegion(tbl.getTableDescriptor(),Bytes.toBytes("A2"),Bytes.toBytes("B"));
    TEST_UTIL.getHBaseCluster().getMaster().assignRegion(hriOverlap);
    TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().waitForAssignment(hriOverlap);
    ServerName server=regionStates.getRegionServerOfRegion(hriOverlap);
    TEST_UTIL.assertRegionOnServer(hriOverlap,server,REGION_ONLINE_TIMEOUT);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_HDFS_REGION,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    HBaseFsck fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.onlineHbck();
    assertErrors(fsck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    fsck.close();
    fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.setFixHdfsHoles(true);
    fsck.setFixHdfsOverlaps(true);
    fsck.setFixHdfsOrphans(true);
    fsck.onlineHbck();
    assertFalse(fsck.shouldRerun());
    assertErrors(fsck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    fsck.close();
  }
  finally {
    if (admin.isTableDisabled(table)) {
      admin.enableTable(table);
    }
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test -noHdfsChecking option can detect and fix assignments issue.
 */
@Test(timeout=180000) public void testFixAssignmentsAndNoHdfsChecking() throws Exception {
  TableName table=TableName.valueOf("testFixAssignmentsAndNoHdfsChecking");
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("B"),true,false,false,false,HRegionInfo.DEFAULT_REPLICA_ID);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    HBaseFsck fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.onlineHbck();
    assertErrors(fsck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    fsck.close();
    fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.setFixAssignments(true);
    fsck.onlineHbck();
    assertTrue(fsck.shouldRerun());
    fsck.onlineHbck();
    assertNoErrors(fsck);
    assertEquals(ROWKEYS.length,countRows());
    fsck.close();
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Split crashed after write to hbase:meta finished for the parent region, but
 * failed to write daughters (pre HBASE-7721 codebase)
 */
@Test(timeout=75000) public void testSplitDaughtersNotInMeta() throws Exception {
  TableName table=TableName.valueOf("testSplitdaughtersNotInMeta");
  Table meta=connection.getTable(TableName.META_TABLE_NAME,tableExecutorService);
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    admin.flush(table);
    try (RegionLocator rl=connection.getRegionLocator(tbl.getName())){
      HRegionLocation location=rl.getRegionLocation(Bytes.toBytes("B"));
      HRegionInfo hri=location.getRegionInfo();
      admin.enableCatalogJanitor(false);
      byte[] regionName=location.getRegionInfo().getRegionName();
      admin.splitRegion(location.getRegionInfo().getRegionName(),Bytes.toBytes("BM"));
      TestEndToEndSplitTransaction.blockUntilRegionSplit(conf,60000,regionName,true);
      PairOfSameType<HRegionInfo> daughters=MetaTableAccessor.getDaughterRegions(meta.get(new Get(regionName)));
      ServerName firstSN=rl.getRegionLocation(daughters.getFirst().getStartKey()).getServerName();
      ServerName secondSN=rl.getRegionLocation(daughters.getSecond().getStartKey()).getServerName();
      undeployRegion(connection,firstSN,daughters.getFirst());
      undeployRegion(connection,secondSN,daughters.getSecond());
      List<Delete> deletes=new ArrayList<>();
      deletes.add(new Delete(daughters.getFirst().getRegionName()));
      deletes.add(new Delete(daughters.getSecond().getRegionName()));
      meta.delete(deletes);
      RegionStates regionStates=TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates();
      regionStates.deleteRegion(daughters.getFirst());
      regionStates.deleteRegion(daughters.getSecond());
      HBaseFsck hbck=doFsck(conf,false);
      assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
      hbck=doFsck(conf,true,true,false,false,false,false,false,false,false,false,false,null);
      assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
      Get get=new Get(hri.getRegionName());
      Result result=meta.get(get);
      assertNotNull(result);
      assertNotNull(MetaTableAccessor.getHRegionInfo(result));
      assertEquals(ROWKEYS.length,countRows());
      assertEquals(rl.getStartKeys().length,SPLITS.length + 1 + 1);
      assertNoErrors(doFsck(conf,false));
    }
   }
  finally {
    admin.enableCatalogJanitor(true);
    meta.close();
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This creates entries in hbase:meta with no hdfs data.  This should cleanly
 * remove the table.
 */
@Test(timeout=180000) public void testNoHdfsTable() throws Exception {
  TableName table=TableName.valueOf("NoHdfsTable");
  setupTable(table);
  assertEquals(ROWKEYS.length,countRows());
  admin.flush(table);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes(""),Bytes.toBytes("A"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("B"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("C"),false,false,true);
  deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("C"),Bytes.toBytes(""),false,false,true);
  deleteTableDir(table);
  HBaseFsck hbck=doFsck(conf,false);
  assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_TABLE_STATE});
  assertEquals(0,hbck.getOverlapGroups(table).size());
  doFsck(conf,true);
  assertNoErrors(doFsck(conf,false));
  assertFalse("Table " + table + " should have been deleted",admin.tableExists(table));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test -noHdfsChecking option can detect region is not in meta but deployed.
 * However, it can not fix it without checking Hdfs because we need to get
 * the region info from Hdfs in this case, then to patch the meta.
 */
@Test(timeout=180000) public void testFixMetaNotWorkingWithNoHdfsChecking() throws Exception {
  TableName table=TableName.valueOf("testFixMetaNotWorkingWithNoHdfsChecking");
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("B"),false,true,false,false,HRegionInfo.DEFAULT_REPLICA_ID);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    HBaseFsck fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.onlineHbck();
    assertErrors(fsck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    fsck.close();
    fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setCheckHdfs(false);
    fsck.setFixAssignments(true);
    fsck.setFixMeta(true);
    fsck.onlineHbck();
    assertFalse(fsck.shouldRerun());
    assertErrors(fsck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    fsck.close();
    fsck=doFsck(conf,true);
    assertTrue(fsck.shouldRerun());
    fsck=doFsck(conf,true);
    assertNoErrors(fsck);
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-10 type-8 type-6 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This creates a table and simulates the race situation where a concurrent compaction or split
 * has removed an colfam dir before the corruption checker got to it.
 */
@Ignore @Test(timeout=180000) public void testQuarantineMissingFamdir() throws Exception {
  TableName table=TableName.valueOf(name.getMethodName());
  final FileSystem fs=FileSystem.get(conf);
  HBaseFsck hbck=new HBaseFsck(conf,hbfsckExecutorService){
    @Override public HFileCorruptionChecker createHFileCorruptionChecker(    boolean sidelineCorruptHFiles) throws IOException {
      return new HFileCorruptionChecker(conf,executor,sidelineCorruptHFiles){
        AtomicBoolean attemptedFirstHFile=new AtomicBoolean(false);
        @Override protected void checkColFamDir(        Path p) throws IOException {
          if (attemptedFirstHFile.compareAndSet(false,true)) {
            assertTrue(fs.delete(p,true));
          }
          super.checkColFamDir(p);
        }
      }
;
    }
  }
;
  doQuarantineTest(table,hbck,3,0,0,0,1);
  hbck.close();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testCheckReplication() throws Exception {
  HBaseFsck hbck=doFsck(conf,false);
  assertNoErrors(hbck);
  ReplicationAdmin replicationAdmin=new ReplicationAdmin(conf);
  Assert.assertEquals(0,replicationAdmin.getPeersCount());
  int zkPort=conf.getInt(HConstants.ZOOKEEPER_CLIENT_PORT,HConstants.DEFAULT_ZOOKEPER_CLIENT_PORT);
  replicationAdmin.addPeer("1","127.0.0.1:" + zkPort + ":/hbase");
  replicationAdmin.getPeersCount();
  Assert.assertEquals(1,replicationAdmin.getPeersCount());
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(conf,"Test Hbase Fsck",connection);
  ReplicationQueues repQueues=ReplicationFactory.getReplicationQueues(zkw,conf,connection);
  repQueues.init("server1");
  repQueues.addLog("1","file1");
  repQueues.addLog("1-server2","file1");
  Assert.assertEquals(2,repQueues.getAllQueues().size());
  hbck=doFsck(conf,false);
  assertNoErrors(hbck);
  repQueues.addLog("2","file1");
  repQueues.addLog("2-server2","file1");
  Assert.assertEquals(4,repQueues.getAllQueues().size());
  hbck=doFsck(conf,false);
  assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.UNDELETED_REPLICATION_QUEUE,HBaseFsck.ErrorReporter.ERROR_CODE.UNDELETED_REPLICATION_QUEUE});
  hbck=doFsck(conf,true);
  hbck=doFsck(conf,false);
  assertNoErrors(hbck);
  Assert.assertEquals(2,repQueues.getAllQueues().size());
  Assert.assertNull(repQueues.getLogsInQueue("2"));
  Assert.assertNull(repQueues.getLogsInQueue("2-sever2"));
  replicationAdmin.removePeer("1");
  repQueues.removeAllQueues();
  zkw.close();
  replicationAdmin.close();
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A split parent in meta, in hdfs, and not deployed
 */
@Test(timeout=180000) public void testLingeringSplitParent() throws Exception {
  TableName table=TableName.valueOf("testLingeringSplitParent");
  Table meta=null;
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    admin.flush(table);
    HRegionLocation location;
    try (RegionLocator rl=connection.getRegionLocator(tbl.getName())){
      location=rl.getRegionLocation(Bytes.toBytes("B"));
    }
     deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("C"),true,true,false);
    meta=connection.getTable(TableName.META_TABLE_NAME,tableExecutorService);
    HRegionInfo hri=location.getRegionInfo();
    HRegionInfo a=new HRegionInfo(tbl.getName(),Bytes.toBytes("B"),Bytes.toBytes("BM"));
    HRegionInfo b=new HRegionInfo(tbl.getName(),Bytes.toBytes("BM"),Bytes.toBytes("C"));
    hri.setOffline(true);
    hri.setSplit(true);
    MetaTableAccessor.addRegionToMeta(meta,hri,a,b);
    meta.close();
    admin.flush(TableName.META_TABLE_NAME);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.LINGERING_SPLIT_PARENT,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    hbck=doFsck(conf,true);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.LINGERING_SPLIT_PARENT,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    assertFalse(hbck.shouldRerun());
    hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.LINGERING_SPLIT_PARENT,HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN});
    hbck=new HBaseFsck(conf,hbfsckExecutorService);
    hbck.connect();
    HBaseFsck.setDisplayFullReport();
    hbck.setTimeLag(0);
    hbck.setFixSplitParents(true);
    hbck.onlineHbck();
    assertTrue(hbck.shouldRerun());
    hbck.close();
    Get get=new Get(hri.getRegionName());
    Result result=meta.get(get);
    assertTrue(result.getColumnCells(HConstants.CATALOG_FAMILY,HConstants.SPLITA_QUALIFIER).isEmpty());
    assertTrue(result.getColumnCells(HConstants.CATALOG_FAMILY,HConstants.SPLITB_QUALIFIER).isEmpty());
    admin.flush(TableName.META_TABLE_NAME);
    doFsck(conf,true);
    assertNoErrors(doFsck(conf,false));
    assertEquals(ROWKEYS.length,countRows());
  }
  finally {
    cleanupTable(table);
    IOUtils.closeQuietly(meta);
  }
}

</code></pre>

<br>
<pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test pluggable error reporter. It can be plugged in
 * from system property or configuration.
 */
@Test(timeout=180000) public void testErrorReporter() throws Exception {
  try {
    MockErrorReporter.calledCount=0;
    doFsck(conf,false);
    assertEquals(MockErrorReporter.calledCount,0);
    conf.set("hbasefsck.errorreporter",MockErrorReporter.class.getName());
    doFsck(conf,false);
    assertTrue(MockErrorReporter.calledCount > 20);
  }
  finally {
    conf.set("hbasefsck.errorreporter",HBaseFsck.PrintingErrorReporter.class.getName());
    MockErrorReporter.calledCount=0;
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testHbckFixOrphanTable() throws Exception {
  TableName table=TableName.valueOf("tableInfo");
  FileSystem fs=null;
  Path tableinfo=null;
  try {
    setupTable(table);
    Path hbaseTableDir=FSUtils.getTableDir(FSUtils.getRootDir(conf),table);
    fs=hbaseTableDir.getFileSystem(conf);
    FileStatus status=FSTableDescriptors.getTableInfoPath(fs,hbaseTableDir);
    tableinfo=status.getPath();
    fs.rename(tableinfo,new Path("/.tableinfo"));
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NO_TABLEINFO_FILE});
    hbck=doFsck(conf,true);
    assertNoErrors(hbck);
    status=null;
    status=FSTableDescriptors.getTableInfoPath(fs,hbaseTableDir);
    assertNotNull(status);
    HTableDescriptor htd=admin.getTableDescriptor(table);
    htd.setValue("NOT_DEFAULT","true");
    admin.disableTable(table);
    admin.modifyTable(table,htd);
    admin.enableTable(table);
    fs.delete(status.getPath(),true);
    htd=admin.getTableDescriptor(table);
    hbck=doFsck(conf,true);
    assertNoErrors(hbck);
    status=FSTableDescriptors.getTableInfoPath(fs,hbaseTableDir);
    assertNotNull(status);
    htd=admin.getTableDescriptor(table);
    assertEquals(htd.getValue("NOT_DEFAULT"),"true");
  }
  finally {
    if (fs != null) {
      fs.rename(new Path("/.tableinfo"),tableinfo);
    }
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that LINGERING_SPLIT_PARENT is not erroneously reported for
 * valid cases where the daughters are there.
 */
@Test(timeout=180000) public void testValidLingeringSplitParent() throws Exception {
  TableName table=TableName.valueOf("testLingeringSplitParent");
  Table meta=null;
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    admin.flush(table);
    try (RegionLocator rl=connection.getRegionLocator(tbl.getName())){
      HRegionLocation location=rl.getRegionLocation(Bytes.toBytes("B"));
      meta=connection.getTable(TableName.META_TABLE_NAME,tableExecutorService);
      HRegionInfo hri=location.getRegionInfo();
      byte[] regionName=location.getRegionInfo().getRegionName();
      admin.splitRegion(location.getRegionInfo().getRegionName(),Bytes.toBytes("BM"));
      TestEndToEndSplitTransaction.blockUntilRegionSplit(conf,60000,regionName,true);
      HBaseFsck hbck=doFsck(conf,true,true,false,false,false,true,true,true,false,false,false,null);
      assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{});
      Get get=new Get(hri.getRegionName());
      Result result=meta.get(get);
      assertNotNull(result);
      assertNotNull(MetaTableAccessor.getHRegionInfo(result));
      assertEquals(ROWKEYS.length,countRows());
      assertEquals(rl.getStartKeys().length,SPLITS.length + 1 + 1);
      assertNoErrors(doFsck(conf,false));
    }
   }
  finally {
    cleanupTable(table);
    IOUtils.closeQuietly(meta);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckReplicas </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This creates and fixes a bad table with a region that is in meta but has
 * no deployment or data hdfs. The table has region_replication set to 2.
 */
@Test(timeout=180000) public void testNotInHdfsWithReplicas() throws Exception {
  TableName table=TableName.valueOf("tableNotInHdfs");
  try {
    HRegionInfo[] oldHris=new HRegionInfo[2];
    setupTableWithRegionReplica(table,2);
    assertEquals(ROWKEYS.length,countRows());
    NavigableMap<HRegionInfo,ServerName> map=MetaTableAccessor.allTableRegions(TEST_UTIL.getConnection(),tbl.getName());
    int i=0;
    for (    Map.Entry<HRegionInfo,ServerName> m : map.entrySet()) {
      if (m.getKey().getStartKey().length > 0 && m.getKey().getStartKey()[0] == Bytes.toBytes("B")[0]) {
        LOG.debug("Initially server hosting " + m.getKey() + " is "+ m.getValue());
        oldHris[i++]=m.getKey();
      }
    }
    admin.flush(table);
    deleteRegion(conf,tbl.getTableDescriptor(),Bytes.toBytes("B"),Bytes.toBytes("C"),false,false,true);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS});
    doFsck(conf,true);
    assertNoErrors(doFsck(conf,false));
    assertEquals(ROWKEYS.length - 2,countRows());
    i=0;
    HRegionInfo[] newHris=new HRegionInfo[2];
    map=MetaTableAccessor.allTableRegions(TEST_UTIL.getConnection(),tbl.getName());
    for (    Map.Entry<HRegionInfo,ServerName> m : map.entrySet()) {
      if (m.getKey().getStartKey().length > 0 && m.getKey().getStartKey()[0] == Bytes.toBytes("B")[0]) {
        newHris[i++]=m.getKey();
      }
    }
    Collection<ServerName> servers=admin.getClusterStatus().getServers();
    Set<HRegionInfo> onlineRegions=new HashSet<HRegionInfo>();
    for (    ServerName s : servers) {
      List<HRegionInfo> list=admin.getOnlineRegions(s);
      onlineRegions.addAll(list);
    }
    assertTrue(onlineRegions.containsAll(Arrays.asList(newHris)));
    assertFalse(onlineRegions.removeAll(Arrays.asList(oldHris)));
  }
  finally {
    cleanupTable(table);
    admin.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckTwoRS </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This creates and fixes a bad table where an overlap group of
 * 3 regions. Set HBaseFsck.maxMerge to 2 to trigger sideline overlapped
 * region. Mess around the meta data so that closeRegion/offlineRegion
 * throws exceptions.
 */
@Test(timeout=180000) public void testSidelineOverlapRegion() throws Exception {
  TableName table=TableName.valueOf("testSidelineOverlapRegion");
  try {
    setupTable(table);
    assertEquals(ROWKEYS.length,countRows());
    MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
    HMaster master=cluster.getMaster();
    HRegionInfo hriOverlap1=createRegion(tbl.getTableDescriptor(),Bytes.toBytes("A"),Bytes.toBytes("AB"));
    master.assignRegion(hriOverlap1);
    master.getAssignmentManager().waitForAssignment(hriOverlap1);
    HRegionInfo hriOverlap2=createRegion(tbl.getTableDescriptor(),Bytes.toBytes("AB"),Bytes.toBytes("B"));
    master.assignRegion(hriOverlap2);
    master.getAssignmentManager().waitForAssignment(hriOverlap2);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.DUPE_STARTKEYS,HBaseFsck.ErrorReporter.ERROR_CODE.DUPE_STARTKEYS,HBaseFsck.ErrorReporter.ERROR_CODE.OVERLAP_IN_REGION_CHAIN});
    assertEquals(3,hbck.getOverlapGroups(table).size());
    assertEquals(ROWKEYS.length,countRows());
    Multimap<byte[],HBaseFsck.HbckInfo> overlapGroups=hbck.getOverlapGroups(table);
    ServerName serverName=null;
    byte[] regionName=null;
    for (    HBaseFsck.HbckInfo hbi : overlapGroups.values()) {
      if ("A".equals(Bytes.toString(hbi.getStartKey())) && "B".equals(Bytes.toString(hbi.getEndKey()))) {
        regionName=hbi.getRegionName();
        int k=cluster.getServerWith(regionName);
        for (int i=0; i < 3; i++) {
          if (i != k) {
            HRegionServer rs=cluster.getRegionServer(i);
            serverName=rs.getServerName();
            break;
          }
        }
        HBaseFsckRepair.closeRegionSilentlyAndWait((HConnection)connection,cluster.getRegionServer(k).getServerName(),hbi.getHdfsHRI());
        admin.offline(regionName);
        break;
      }
    }
    assertNotNull(regionName);
    assertNotNull(serverName);
    try (Table meta=connection.getTable(TableName.META_TABLE_NAME,tableExecutorService)){
      Put put=new Put(regionName);
      put.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER,Bytes.toBytes(serverName.getHostAndPort()));
      meta.put(put);
    }
     HBaseFsck fsck=new HBaseFsck(conf,hbfsckExecutorService);
    fsck.connect();
    HBaseFsck.setDisplayFullReport();
    fsck.setTimeLag(0);
    fsck.setFixAssignments(true);
    fsck.setFixMeta(true);
    fsck.setFixHdfsHoles(true);
    fsck.setFixHdfsOverlaps(true);
    fsck.setFixHdfsOrphans(true);
    fsck.setFixVersionFile(true);
    fsck.setSidelineBigOverlaps(true);
    fsck.setMaxMerge(2);
    fsck.onlineHbck();
    fsck.close();
    HBaseFsck hbck2=doFsck(conf,false);
    assertNoErrors(hbck2);
    assertEquals(0,hbck2.getOverlapGroups(table).size());
    assertTrue(ROWKEYS.length > countRows());
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestIdReadWriteLock </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testMultipleClients() throws Exception {
  ExecutorService exec=Executors.newFixedThreadPool(NUM_THREADS);
  try {
    ExecutorCompletionService<Boolean> ecs=new ExecutorCompletionService<Boolean>(exec);
    for (int i=0; i < NUM_THREADS; ++i)     ecs.submit(new IdLockTestThread("client_" + i));
    for (int i=0; i < NUM_THREADS; ++i) {
      Future<Boolean> result=ecs.take();
      assertTrue(result.get());
    }
    int entryPoolSize=idLock.purgeAndGetEntryPoolSize();
    LOG.debug("Size of entry pool after gc and purge: " + entryPoolSize);
    assertEquals(0,entryPoolSize);
  }
  finally {
    exec.shutdown();
    exec.awaitTermination(5000,TimeUnit.MILLISECONDS);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestKeyLocker </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLocker(){
  KeyLocker<String> locker=new KeyLocker<String>();
  ReentrantLock lock1=locker.acquireLock("l1");
  Assert.assertTrue(lock1.isHeldByCurrentThread());
  ReentrantLock lock2=locker.acquireLock("l2");
  Assert.assertTrue(lock2.isHeldByCurrentThread());
  Assert.assertTrue(lock1 != lock2);
  ReentrantLock lock20=locker.acquireLock("l2");
  Assert.assertTrue(lock20 == lock2);
  Assert.assertTrue(lock2.isHeldByCurrentThread());
  Assert.assertTrue(lock20.isHeldByCurrentThread());
  lock20.unlock();
  Assert.assertTrue(lock20.isHeldByCurrentThread());
  lock2.unlock();
  Assert.assertFalse(lock20.isHeldByCurrentThread());
  int lock2Hash=System.identityHashCode(lock2);
  lock2=null;
  lock20=null;
  System.gc();
  System.gc();
  System.gc();
  ReentrantLock lock200=locker.acquireLock("l2");
  Assert.assertNotEquals(lock2Hash,System.identityHashCode(lock200));
  lock200.unlock();
  Assert.assertFalse(lock200.isHeldByCurrentThread());
  Assert.assertTrue(lock1.isHeldByCurrentThread());
  lock1.unlock();
  Assert.assertFalse(lock1.isHeldByCurrentThread());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestMergeTool </h4><pre class="type-4 type-9 type-7 type-8 type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test merge tool.
 * @throws Exception
 */
@Test public void testMergeTool() throws Exception {
  for (int i=0; i < regions.length; i++) {
    for (int j=0; j < rows[i].length; j++) {
      Get get=new Get(rows[i][j]);
      get.addFamily(FAMILY);
      Result result=regions[i].get(get);
      byte[] bytes=CellUtil.cloneValue(result.rawCells()[0]);
      assertNotNull(bytes);
      assertTrue(Bytes.equals(bytes,rows[i][j]));
    }
    HBaseTestingUtility.closeRegionAndWAL(regions[i]);
  }
  WAL log=wals.getWAL(new byte[]{},null);
  HRegion merged=mergeAndVerify("merging regions 0 and 1 ",this.sourceRegions[0].getRegionNameAsString(),this.sourceRegions[1].getRegionNameAsString(),log,2);
  merged=mergeAndVerify("merging regions 0+1 and 2",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[2].getRegionNameAsString(),log,3);
  merged=mergeAndVerify("merging regions 0+1+2 and 3",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[3].getRegionNameAsString(),log,4);
  merged=mergeAndVerify("merging regions 0+1+2+3 and 4",merged.getRegionInfo().getRegionNameAsString(),this.sourceRegions[4].getRegionNameAsString(),log,rows.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestOrderedBytes </h4><pre class="type-11 type-5 type-17 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert invalid input byte[] are rejected by BlobCopy
 */
@Test(expected=IllegalArgumentException.class) public void testBlobCopyNoZeroBytes(){
  byte[] val={0x01,0x02,0x00,0x03};
  byte[] ascExpected={0x38,0x01,0x02,0x00,0x03};
  PositionedByteRange buf=new SimplePositionedMutableByteRange(val.length + 1);
  OrderedBytes.encodeBlobCopy(buf,val,Order.ASCENDING);
  assertArrayEquals(ascExpected,buf.getBytes());
  buf.set(val.length + 2);
  OrderedBytes.encodeBlobCopy(buf,val,Order.DESCENDING);
  fail("test should never get here.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestRegionSplitCalculator </h4><pre class="type-4 type-8 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBigRanges(){
  SimpleRange ai=new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("I"));
  SimpleRange ae=new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("E"));
  SimpleRange ac=new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("C"));
  Collection<SimpleRange> bigOverlap=new ArrayList<SimpleRange>();
  bigOverlap.add(new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("E")));
  bigOverlap.add(new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("C")));
  bigOverlap.add(new SimpleRange(Bytes.toBytes("A"),Bytes.toBytes("B")));
  bigOverlap.add(new SimpleRange(Bytes.toBytes("B"),Bytes.toBytes("C")));
  bigOverlap.add(new SimpleRange(Bytes.toBytes("E"),Bytes.toBytes("H")));
  bigOverlap.add(ai);
  bigOverlap.add(ae);
  bigOverlap.add(ac);
  List<SimpleRange> bigRanges=RegionSplitCalculator.findBigRanges(bigOverlap,1);
  assertEquals(1,bigRanges.size());
  assertEquals(ai,bigRanges.get(0));
  bigRanges=RegionSplitCalculator.findBigRanges(bigOverlap,3);
  assertEquals(3,bigRanges.size());
  assertEquals(ai,bigRanges.get(0));
  SimpleRange r1=bigRanges.get(1);
  SimpleRange r2=bigRanges.get(2);
  assertEquals("A",Bytes.toString(r1.start));
  assertEquals("A",Bytes.toString(r2.start));
  String r1e=Bytes.toString(r1.end);
  String r2e=Bytes.toString(r2.end);
  assertTrue((r1e.equals("C") && r2e.equals("E")) || (r1e.equals("E") && r2e.equals("C")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestSimpleMutableByteRange </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmpty(){
  Assert.assertTrue(SimpleMutableByteRange.isEmpty(null));
  ByteRange r=new SimpleMutableByteRange();
  Assert.assertTrue(SimpleMutableByteRange.isEmpty(r));
  Assert.assertTrue(r.isEmpty());
  r.set(new byte[0]);
  Assert.assertEquals(0,r.getBytes().length);
  Assert.assertEquals(0,r.getOffset());
  Assert.assertEquals(0,r.getLength());
  Assert.assertTrue(Bytes.equals(new byte[0],r.deepCopyToNewArray()));
  Assert.assertEquals(0,r.compareTo(new SimpleMutableByteRange(new byte[0],0,0)));
  Assert.assertEquals(0,r.hashCode());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-16 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasics(){
  ByteRange r=new SimpleMutableByteRange(new byte[]{1,3,2});
  Assert.assertFalse(SimpleMutableByteRange.isEmpty(r));
  Assert.assertNotNull(r.getBytes());
  Assert.assertEquals(3,r.getBytes().length);
  Assert.assertEquals(0,r.getOffset());
  Assert.assertEquals(3,r.getLength());
  Assert.assertTrue(Bytes.equals(new byte[]{1,3,2},r.deepCopyToNewArray()));
  Assert.assertNotSame(r.getBytes(),r.deepCopyToNewArray());
  Assert.assertTrue(r.hashCode() > 0);
  Assert.assertEquals(r.hashCode(),r.deepCopy().hashCode());
  byte[] destination=new byte[]{-59};
  r.deepCopySubRangeTo(2,1,destination,0);
  Assert.assertTrue(Bytes.equals(new byte[]{2},destination));
  r.setLength(1);
  Assert.assertTrue(Bytes.equals(new byte[]{1},r.deepCopyToNewArray()));
  r.setLength(2);
  Assert.assertTrue(Bytes.equals(new byte[]{1,3},r.deepCopyToNewArray()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestSortedCopyOnWriteSet </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorIsolation() throws Exception {
  SortedCopyOnWriteSet<String> set=new SortedCopyOnWriteSet<String>(Lists.newArrayList("a","b","c","d","e"));
  Iterator<String> iter=set.iterator();
  set.remove("c");
  boolean found=false;
  while (iter.hasNext() && !found) {
    found="c".equals(iter.next());
  }
  assertTrue(found);
  iter=set.iterator();
  found=false;
  while (iter.hasNext() && !found) {
    found="c".equals(iter.next());
  }
  assertFalse(found);
  iter=set.iterator();
  set.add("f");
  found=false;
  while (iter.hasNext() && !found) {
    String next=iter.next();
    found="f".equals(next);
  }
  assertFalse(found);
  iter=set.iterator();
  set.addAll(Lists.newArrayList("g","h","i"));
  found=false;
  while (iter.hasNext() && !found) {
    String next=iter.next();
    found="g".equals(next) || "h".equals(next) || "i".equals(next);
  }
  assertFalse(found);
  iter=set.iterator();
  set.clear();
  assertEquals(0,set.size());
  int size=0;
  while (iter.hasNext()) {
    iter.next();
    size++;
  }
  assertTrue(size > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestSortedList </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorIsolation() throws Exception {
  SortedList<String> list=new SortedList<String>(Lists.newArrayList("a","b","c","d","e"),new StringComparator());
  Iterator<String> iter=list.iterator();
  list.remove("c");
  boolean found=false;
  while (iter.hasNext() && !found) {
    found="c".equals(iter.next());
  }
  assertTrue(found);
  iter=list.iterator();
  found=false;
  while (iter.hasNext() && !found) {
    found="c".equals(iter.next());
  }
  assertFalse(found);
  iter=list.iterator();
  list.add("f");
  found=false;
  while (iter.hasNext() && !found) {
    String next=iter.next();
    found="f".equals(next);
  }
  assertFalse(found);
  iter=list.iterator();
  list.addAll(Lists.newArrayList("g","h","i"));
  found=false;
  while (iter.hasNext() && !found) {
    String next=iter.next();
    found="g".equals(next) || "h".equals(next) || "i".equals(next);
  }
  assertFalse(found);
  iter=list.iterator();
  list.clear();
  assertEquals(0,list.size());
  int size=0;
  while (iter.hasNext()) {
    iter.next();
    size++;
  }
  assertTrue(size > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestStealJobQueue </h4><pre class="type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPoll() throws InterruptedException {
  stealJobQueue.offer(3);
  stealFromQueue.offer(10);
  stealJobQueue.offer(15);
  stealJobQueue.offer(4);
  assertEquals(3,stealJobQueue.poll(1,TimeUnit.SECONDS).intValue());
  assertEquals(4,stealJobQueue.poll(1,TimeUnit.SECONDS).intValue());
  assertEquals("always take from the main queue before trying to steal",15,stealJobQueue.poll(1,TimeUnit.SECONDS).intValue());
  assertEquals(10,stealJobQueue.poll(1,TimeUnit.SECONDS).intValue());
  assertTrue(stealFromQueue.isEmpty());
  assertTrue(stealJobQueue.isEmpty());
  assertNull(stealJobQueue.poll(10,TimeUnit.MILLISECONDS));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTake() throws InterruptedException {
  stealJobQueue.offer(3);
  stealFromQueue.offer(10);
  stealJobQueue.offer(15);
  stealJobQueue.offer(4);
  assertEquals(3,stealJobQueue.take().intValue());
  assertEquals(4,stealJobQueue.take().intValue());
  assertEquals("always take from the main queue before trying to steal",15,stealJobQueue.take().intValue());
  assertEquals(10,stealJobQueue.take().intValue());
  assertTrue(stealFromQueue.isEmpty());
  assertTrue(stealJobQueue.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestTableName </h4><pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testEmptyTableName(){
  for (  String tn : emptyNames) {
    TableName.isLegalFullyQualifiedTableName(Bytes.toBytes(tn));
    fail("invalid tablename " + tn + " should have failed with IllegalArgumentException");
  }
}

</code></pre>

<br>
<pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidNamespace(){
  for (  String tn : invalidNamespace) {
    TableName.isLegalFullyQualifiedTableName(Bytes.toBytes(tn));
    fail("invalid namespace " + tn + " should have failed with IllegalArgumentException for namespace");
  }
}

</code></pre>

<br>
<pre class="type-11 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testEmptyNamespaceName(){
  for (  String nn : emptyNames) {
    TableName.isLegalNamespaceName(Bytes.toBytes(nn));
    fail("invalid Namespace name " + nn + " should have failed with IllegalArgumentException");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestWeakObjectPool </h4><pre class="type-4 type-7 type-16 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWeakReference() throws Exception {
  Object obj1=pool.get("a");
  int hash1=System.identityHashCode(obj1);
  System.gc();
  System.gc();
  System.gc();
  Thread.sleep(10);
  pool.purge();
  Assert.assertEquals(1,pool.size());
  Object obj2=pool.get("a");
  Assert.assertSame(obj1,obj2);
  obj1=null;
  obj2=null;
  System.gc();
  System.gc();
  System.gc();
  Thread.sleep(10);
  pool.purge();
  Assert.assertEquals(0,pool.size());
  Object obj3=pool.get("a");
  Assert.assertNotEquals(hash1,System.identityHashCode(obj3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.hbck.OfflineMetaRebuildTestCore </h4><pre class="type-2 type-7 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUpBefore() throws Exception {
  TEST_UTIL=new HBaseTestingUtility();
  TEST_UTIL.getConfiguration().setInt("dfs.datanode.max.xceivers",9192);
  TEST_UTIL.startMiniCluster(3);
  conf=TEST_UTIL.getConfiguration();
  this.connection=ConnectionFactory.createConnection(conf);
  assertEquals(0,TEST_UTIL.getHBaseAdmin().listTables().length);
  table=TableName.valueOf(TABLE_BASE + "-" + tableIdx);
  tableIdx++;
  htbl=setupTable(table);
  populateTable(htbl);
  assertEquals(5,scanMeta());
  LOG.info("Table " + table + " has "+ tableRowCount(conf,table)+ " entries.");
  assertEquals(16,tableRowCount(conf,table));
  TEST_UTIL.getHBaseAdmin().disableTable(table);
  assertEquals(1,TEST_UTIL.getHBaseAdmin().listTables().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test(timeout=120000) public void testMetaRebuild() throws Exception {
  wipeOutMeta();
  assertEquals(1,scanMeta());
  assertErrors(doFsck(conf,false),new ERROR_CODE[]{ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED});
  TEST_UTIL.shutdownMiniHBaseCluster();
  TEST_UTIL.shutdownMiniZKCluster();
  HBaseFsck fsck=new HBaseFsck(conf);
  assertTrue(fsck.rebuildMeta(false));
  TEST_UTIL.startMiniZKCluster();
  TEST_UTIL.restartHBaseCluster(3);
  try (Connection connection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration())){
    Admin admin=connection.getAdmin();
    if (admin.isTableDisabled(table))     admin.enableTable(table);
    LOG.info("Waiting for no more RIT");
    TEST_UTIL.waitUntilNoRegionsInTransition(60000);
    LOG.info("No more RIT in ZK, now doing final test verification");
    assertEquals(5,scanMeta());
    TableName[] tableNames=TEST_UTIL.getHBaseAdmin().listTableNames();
    for (    TableName tableName : tableNames) {
      HTableDescriptor tableDescriptor=TEST_UTIL.getHBaseAdmin().getTableDescriptor(tableName);
      assertNotNull(tableDescriptor);
      assertTrue(TEST_UTIL.getHBaseAdmin().isTableEnabled(tableName));
    }
    HTableDescriptor[] htbls=admin.listTables();
    LOG.info("Tables present after restart: " + Arrays.toString(htbls));
    assertEquals(1,htbls.length);
  }
   assertErrors(doFsck(conf,false),new ERROR_CODE[]{});
  LOG.info("Table " + table + " has "+ tableRowCount(conf,table)+ " entries.");
  assertEquals(16,tableRowCount(conf,table));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildHole </h4><pre class="type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testMetaRebuildHoleFail() throws Exception {
  byte[] startKey=splits[1];
  byte[] endKey=splits[2];
  deleteRegion(conf,htbl,startKey,endKey);
  wipeOutMeta();
  assertEquals(1,scanMeta());
  assertErrors(doFsck(conf,false),new ERROR_CODE[]{ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED});
  TEST_UTIL.shutdownMiniHBaseCluster();
  TEST_UTIL.shutdownMiniZKCluster();
  HBaseFsck fsck=new HBaseFsck(conf);
  assertFalse(fsck.rebuildMeta(false));
  fsck.close();
  TEST_UTIL.startMiniZKCluster();
  TEST_UTIL.restartHBaseCluster(3);
  LOG.info("Waiting for no more RIT");
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  LOG.info("No more RIT in ZK, now doing final test verification");
  int tries=60;
  while (TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition().size() > 0 && tries-- > 0) {
    LOG.info("Waiting for RIT: " + TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition());
    Thread.sleep(1000);
  }
  assertEquals(1,scanMeta());
  HTableDescriptor[] htbls=getTables(TEST_UTIL.getConfiguration());
  LOG.info("Tables present after restart: " + Arrays.toString(htbls));
  assertEquals(1,htbls.length);
  assertErrors(doFsck(conf,false),new ERROR_CODE[]{ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildOverlap </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testMetaRebuildOverlapFail() throws Exception {
  byte[] startKey=splits[0];
  byte[] endKey=splits[2];
  createRegion(conf,htbl,startKey,endKey);
  wipeOutMeta();
  assertEquals(1,scanMeta());
  assertErrors(doFsck(conf,false),new ERROR_CODE[]{ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED});
  TEST_UTIL.shutdownMiniHBaseCluster();
  TEST_UTIL.shutdownMiniZKCluster();
  HBaseFsck fsck=new HBaseFsck(conf);
  assertFalse(fsck.rebuildMeta(false));
  Multimap<byte[],HbckInfo> problems=fsck.getOverlapGroups(table);
  assertEquals(1,problems.keySet().size());
  assertEquals(3,problems.size());
  TEST_UTIL.startMiniZKCluster();
  TEST_UTIL.restartHBaseCluster(3);
  LOG.info("Waiting for no more RIT");
  TEST_UTIL.waitUntilNoRegionsInTransition(60000);
  LOG.info("No more RIT in ZK, now doing final test verification");
  int tries=60;
  while (TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition().size() > 0 && tries-- > 0) {
    LOG.info("Waiting for RIT: " + TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsInTransition());
    Thread.sleep(1000);
  }
  assertEquals(1,scanMeta());
  HTableDescriptor[] htbls=getTables(TEST_UTIL.getConfiguration());
  LOG.info("Tables present after restart: " + Arrays.toString(htbls));
  assertEquals(1,htbls.length);
  assertErrors(doFsck(conf,false),new ERROR_CODE[]{ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED,ERROR_CODE.NOT_IN_META_OR_DEPLOYED});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestDefaultWALProvider </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServerNameFromWALDirectoryName() throws IOException {
  ServerName sn=ServerName.valueOf("hn",450,1398);
  String hl=FSUtils.getRootDir(conf) + "/" + DefaultWALProvider.getWALDirectoryName(sn.toString());
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,null));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,FSUtils.getRootDir(conf).toUri().toString()));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,""));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,"                  "));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,hl));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,hl + "qdf"));
  assertNull(DefaultWALProvider.getServerNameFromWALDirectoryName(conf,"sfqf" + hl + "qdf"));
  final String wals="/WALs/";
  ServerName parsed=DefaultWALProvider.getServerNameFromWALDirectoryName(conf,FSUtils.getRootDir(conf).toUri().toString() + wals + sn+ "/localhost%2C32984%2C1343316388997.1343316390417");
  assertEquals("standard",sn,parsed);
  parsed=DefaultWALProvider.getServerNameFromWALDirectoryName(conf,hl + "/qdf");
  assertEquals("subdir",sn,parsed);
  parsed=DefaultWALProvider.getServerNameFromWALDirectoryName(conf,FSUtils.getRootDir(conf).toUri().toString() + wals + sn+ "-splitting/localhost%3A57020.1340474893931");
  assertEquals("split",sn,parsed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestSecureWAL </h4><pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecureWAL() throws Exception {
  TableName tableName=TableName.valueOf("TestSecureWAL");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(tableName.getName()));
  HRegionInfo regioninfo=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false);
  final int total=10;
  final byte[] row=Bytes.toBytes("row");
  final byte[] family=Bytes.toBytes("family");
  final byte[] value=Bytes.toBytes("Test value");
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  final WALFactory wals=new WALFactory(TEST_UTIL.getConfiguration(),null,"TestSecureWAL");
  final WAL wal=wals.getWAL(regioninfo.getEncodedNameAsBytes(),regioninfo.getTable().getNamespace());
  for (int i=0; i < total; i++) {
    WALEdit kvs=new WALEdit();
    kvs.add(new KeyValue(row,family,Bytes.toBytes(i),value));
    wal.append(htd,regioninfo,new WALKey(regioninfo.getEncodedNameAsBytes(),tableName,System.currentTimeMillis()),kvs,true);
  }
  wal.sync();
  final Path walPath=DefaultWALProvider.getCurrentFileName(wal);
  wals.shutdown();
  long length=fs.getFileStatus(walPath).getLen();
  FSDataInputStream in=fs.open(walPath);
  byte[] fileData=new byte[(int)length];
  IOUtils.readFully(in,fileData);
  in.close();
  assertFalse("Cells appear to be plaintext",Bytes.contains(fileData,value));
  WAL.Reader reader=wals.createReader(TEST_UTIL.getTestFileSystem(),walPath);
  int count=0;
  WAL.Entry entry=new WAL.Entry();
  while (reader.next(entry) != null) {
    count++;
    List<Cell> cells=entry.getEdit().getCells();
    assertTrue("Should be one KV per WALEdit",cells.size() == 1);
    for (    Cell cell : cells) {
      assertTrue("Incorrect row",Bytes.equals(cell.getRowArray(),cell.getRowOffset(),cell.getRowLength(),row,0,row.length));
      assertTrue("Incorrect family",Bytes.equals(cell.getFamilyArray(),cell.getFamilyOffset(),cell.getFamilyLength(),family,0,family.length));
      assertTrue("Incorrect value",Bytes.equals(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength(),value,0,value.length));
    }
  }
  assertEquals("Should have read back as many KVs as written",total,count);
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestWALFactory </h4><pre class="type-11 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test new HDFS-265 sync.
 * @throws Exception
 */
@Test public void Broken_testSync() throws Exception {
  TableName tableName=TableName.valueOf(currentTest.getMethodName());
  MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl(1);
  Path p=new Path(dir,currentTest.getMethodName() + ".fsdos");
  FSDataOutputStream out=fs.create(p);
  out.write(tableName.getName());
  Method syncMethod=null;
  try {
    syncMethod=out.getClass().getMethod("hflush",new Class<?>[]{});
  }
 catch (  NoSuchMethodException e) {
    try {
      syncMethod=out.getClass().getMethod("sync",new Class<?>[]{});
    }
 catch (    NoSuchMethodException ex) {
      fail("This version of Hadoop supports neither Syncable.sync() " + "nor Syncable.hflush().");
    }
  }
  syncMethod.invoke(out,new Object[]{});
  FSDataInputStream in=fs.open(p);
  assertTrue(in.available() > 0);
  byte[] buffer=new byte[1024];
  int read=in.read(buffer);
  assertEquals(tableName.getName().length,read);
  out.close();
  in.close();
  final int total=20;
  WAL.Reader reader=null;
  try {
    HRegionInfo info=new HRegionInfo(tableName,null,null,false);
    HTableDescriptor htd=new HTableDescriptor(tableName);
    htd.addFamily(new HColumnDescriptor(tableName.getName()));
    final WAL wal=wals.getWAL(info.getEncodedNameAsBytes(),info.getTable().getNamespace());
    for (int i=0; i < total; i++) {
      WALEdit kvs=new WALEdit();
      kvs.add(new KeyValue(Bytes.toBytes(i),tableName.getName(),tableName.getName()));
      wal.append(htd,info,new WALKey(info.getEncodedNameAsBytes(),tableName,System.currentTimeMillis(),mvcc),kvs,true);
    }
    wal.sync();
    Path walPath=DefaultWALProvider.getCurrentFileName(wal);
    reader=wals.createReader(fs,walPath);
    int count=0;
    WAL.Entry entry=new WAL.Entry();
    while ((entry=reader.next(entry)) != null)     count++;
    assertEquals(total,count);
    reader.close();
    for (int i=0; i < total; i++) {
      WALEdit kvs=new WALEdit();
      kvs.add(new KeyValue(Bytes.toBytes(i),tableName.getName(),tableName.getName()));
      wal.append(htd,info,new WALKey(info.getEncodedNameAsBytes(),tableName,System.currentTimeMillis(),mvcc),kvs,true);
    }
    wal.sync();
    reader=wals.createReader(fs,walPath);
    count=0;
    while ((entry=reader.next(entry)) != null)     count++;
    assertTrue(count >= total);
    reader.close();
    wal.sync();
    reader=wals.createReader(fs,walPath);
    count=0;
    while ((entry=reader.next(entry)) != null)     count++;
    assertEquals(total * 2,count);
    reader.close();
    final byte[] value=new byte[1025 * 1024];
    for (int i=0; i < total; i++) {
      WALEdit kvs=new WALEdit();
      kvs.add(new KeyValue(Bytes.toBytes(i),tableName.getName(),value));
      wal.append(htd,info,new WALKey(info.getEncodedNameAsBytes(),tableName,System.currentTimeMillis(),mvcc),kvs,true);
    }
    wal.sync();
    reader=wals.createReader(fs,walPath);
    count=0;
    while ((entry=reader.next(entry)) != null)     count++;
    assertEquals(total * 3,count);
    reader.close();
    wal.shutdown();
    reader=wals.createReader(fs,walPath);
    count=0;
    while ((entry=reader.next(entry)) != null)     count++;
    assertEquals(total * 3,count);
    reader.close();
  }
  finally {
    if (reader != null)     reader.close();
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOException
 */
@Test public void testAppend() throws IOException {
  final int COL_COUNT=10;
  final HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("tablename")).addFamily(new HColumnDescriptor("column"));
  final byte[] row=Bytes.toBytes("row");
  WAL.Reader reader=null;
  final MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl(1);
  try {
    long timestamp=System.currentTimeMillis();
    WALEdit cols=new WALEdit();
    for (int i=0; i < COL_COUNT; i++) {
      cols.add(new KeyValue(row,Bytes.toBytes("column"),Bytes.toBytes(Integer.toString(i)),timestamp,new byte[]{(byte)(i + '0')}));
    }
    HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
    final WAL log=wals.getWAL(hri.getEncodedNameAsBytes(),hri.getTable().getNamespace());
    final long txid=log.append(htd,hri,new WALKey(hri.getEncodedNameAsBytes(),htd.getTableName(),System.currentTimeMillis(),mvcc),cols,true);
    log.sync(txid);
    log.startCacheFlush(hri.getEncodedNameAsBytes(),htd.getFamiliesKeys());
    log.completeCacheFlush(hri.getEncodedNameAsBytes());
    log.shutdown();
    Path filename=DefaultWALProvider.getCurrentFileName(log);
    reader=wals.createReader(fs,filename);
    WAL.Entry entry=reader.next();
    assertEquals(COL_COUNT,entry.getEdit().size());
    int idx=0;
    for (    Cell val : entry.getEdit().getCells()) {
      assertTrue(Bytes.equals(hri.getEncodedNameAsBytes(),entry.getKey().getEncodedRegionName()));
      assertTrue(htd.getTableName().equals(entry.getKey().getTablename()));
      assertTrue(Bytes.equals(row,0,row.length,val.getRowArray(),val.getRowOffset(),val.getRowLength()));
      assertEquals((byte)(idx + '0'),CellUtil.cloneValue(val)[0]);
      System.out.println(entry.getKey() + " " + val);
      idx++;
    }
  }
  finally {
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we can write out an edit, close, and then read it back in again.
 * @throws IOException
 */
@Test public void testEditAdd() throws IOException {
  final int COL_COUNT=10;
  final HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("tablename")).addFamily(new HColumnDescriptor("column"));
  final byte[] row=Bytes.toBytes("row");
  WAL.Reader reader=null;
  try {
    final MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl(1);
    long timestamp=System.currentTimeMillis();
    WALEdit cols=new WALEdit();
    for (int i=0; i < COL_COUNT; i++) {
      cols.add(new KeyValue(row,Bytes.toBytes("column"),Bytes.toBytes(Integer.toString(i)),timestamp,new byte[]{(byte)(i + '0')}));
    }
    HRegionInfo info=new HRegionInfo(htd.getTableName(),row,Bytes.toBytes(Bytes.toString(row) + "1"),false);
    final WAL log=wals.getWAL(info.getEncodedNameAsBytes(),info.getTable().getNamespace());
    final long txid=log.append(htd,info,new WALKey(info.getEncodedNameAsBytes(),htd.getTableName(),System.currentTimeMillis(),mvcc),cols,true);
    log.sync(txid);
    log.startCacheFlush(info.getEncodedNameAsBytes(),htd.getFamiliesKeys());
    log.completeCacheFlush(info.getEncodedNameAsBytes());
    log.shutdown();
    Path filename=DefaultWALProvider.getCurrentFileName(log);
    reader=wals.createReader(fs,filename);
    for (int i=0; i < 1; i++) {
      WAL.Entry entry=reader.next(null);
      if (entry == null)       break;
      WALKey key=entry.getKey();
      WALEdit val=entry.getEdit();
      assertTrue(Bytes.equals(info.getEncodedNameAsBytes(),key.getEncodedRegionName()));
      assertTrue(htd.getTableName().equals(key.getTablename()));
      Cell cell=val.getCells().get(0);
      assertTrue(Bytes.equals(row,0,row.length,cell.getRowArray(),cell.getRowOffset(),cell.getRowLength()));
      assertEquals((byte)(i + '0'),CellUtil.cloneValue(cell)[0]);
      System.out.println(key + " " + val);
    }
  }
  finally {
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testAppendClose() throws Exception {
  TableName tableName=TableName.valueOf(currentTest.getMethodName());
  HRegionInfo regioninfo=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false);
  final WAL wal=wals.getWAL(regioninfo.getEncodedNameAsBytes(),regioninfo.getTable().getNamespace());
  final int total=20;
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(tableName.getName()));
  for (int i=0; i < total; i++) {
    WALEdit kvs=new WALEdit();
    kvs.add(new KeyValue(Bytes.toBytes(i),tableName.getName(),tableName.getName()));
    wal.append(htd,regioninfo,new WALKey(regioninfo.getEncodedNameAsBytes(),tableName,System.currentTimeMillis()),kvs,true);
  }
  wal.sync();
  int namenodePort=cluster.getNameNodePort();
  final Path walPath=DefaultWALProvider.getCurrentFileName(wal);
  try {
    DistributedFileSystem dfs=(DistributedFileSystem)cluster.getFileSystem();
    dfs.setSafeMode(HdfsConstants.SafeModeAction.SAFEMODE_ENTER);
    TEST_UTIL.shutdownMiniDFSCluster();
    try {
      wal.shutdown();
    }
 catch (    IOException e) {
      LOG.info(e);
    }
    fs.close();
    LOG.info("STOPPED first instance of the cluster");
  }
  finally {
    while (cluster.isClusterUp()) {
      LOG.error("Waiting for cluster to go down");
      Thread.sleep(1000);
    }
    assertFalse(cluster.isClusterUp());
    cluster=null;
    for (int i=0; i < 100; i++) {
      try {
        cluster=TEST_UTIL.startMiniDFSClusterForTestWAL(namenodePort);
        break;
      }
 catch (      BindException e) {
        LOG.info("Sleeping.  BindException bringing up new cluster");
        Threads.sleep(1000);
      }
    }
    cluster.waitActive();
    fs=cluster.getFileSystem();
    LOG.info("STARTED second instance.");
  }
  Method setLeasePeriod=cluster.getClass().getDeclaredMethod("setLeasePeriod",new Class[]{Long.TYPE,Long.TYPE});
  setLeasePeriod.setAccessible(true);
  setLeasePeriod.invoke(cluster,1000L,1000L);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
    LOG.info(e);
  }
  final FileSystem recoveredFs=fs;
  final Configuration rlConf=conf;
class RecoverLogThread extends Thread {
    public Exception exception=null;
    public void run(){
      try {
        FSUtils.getInstance(fs,rlConf).recoverFileLease(recoveredFs,walPath,rlConf,null);
      }
 catch (      IOException e) {
        exception=e;
      }
    }
  }
  RecoverLogThread t=new RecoverLogThread();
  t.start();
  t.join(60 * 1000);
  if (t.isAlive()) {
    t.interrupt();
    throw new Exception("Timed out waiting for WAL.recoverLog()");
  }
  if (t.exception != null)   throw t.exception;
  WAL.Reader reader=wals.createReader(fs,walPath);
  int count=0;
  WAL.Entry entry=new WAL.Entry();
  while (reader.next(entry) != null) {
    count++;
    assertTrue("Should be one KeyValue per WALEdit",entry.getEdit().getCells().size() == 1);
  }
  assertEquals(total,count);
  reader.close();
  setLeasePeriod.invoke(cluster,new Object[]{new Long(60000),new Long(3600000)});
}

</code></pre>

<br>
<pre class="type-9 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOException
 */
@Test public void testReadLegacyLog() throws IOException {
  final int columnCount=5;
  final int recordCount=5;
  final TableName tableName=TableName.valueOf("tablename");
  final byte[] row=Bytes.toBytes("row");
  long timestamp=System.currentTimeMillis();
  Path path=new Path(dir,"tempwal");
  SequenceFileLogWriter sflw=null;
  WAL.Reader reader=null;
  try {
    HRegionInfo hri=new HRegionInfo(tableName,HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
    HTableDescriptor htd=new HTableDescriptor(tableName);
    fs.mkdirs(dir);
    sflw=new SequenceFileLogWriter();
    sflw.init(fs,path,conf,false);
    for (int i=0; i < recordCount; ++i) {
      WALKey key=new HLogKey(hri.getEncodedNameAsBytes(),tableName,i,timestamp,HConstants.DEFAULT_CLUSTER_ID);
      WALEdit edit=new WALEdit();
      for (int j=0; j < columnCount; ++j) {
        if (i == 0) {
          htd.addFamily(new HColumnDescriptor("column" + j));
        }
        String value=i + "" + j;
        edit.add(new KeyValue(row,row,row,timestamp,Bytes.toBytes(value)));
      }
      sflw.append(new WAL.Entry(key,edit));
    }
    sflw.sync();
    sflw.close();
    reader=wals.createReader(fs,path);
    assertTrue(reader instanceof SequenceFileLogReader);
    for (int i=0; i < recordCount; ++i) {
      WAL.Entry entry=reader.next();
      assertNotNull(entry);
      assertEquals(columnCount,entry.getEdit().size());
      assertArrayEquals(hri.getEncodedNameAsBytes(),entry.getKey().getEncodedRegionName());
      assertEquals(tableName,entry.getKey().getTablename());
      int idx=0;
      for (      Cell val : entry.getEdit().getCells()) {
        assertTrue(Bytes.equals(row,0,row.length,val.getRowArray(),val.getRowOffset(),val.getRowLength()));
        String value=i + "" + idx;
        assertArrayEquals(Bytes.toBytes(value),CellUtil.cloneValue(val));
        idx++;
      }
    }
    WAL.Entry entry=reader.next();
    assertNull(entry);
  }
  finally {
    if (sflw != null) {
      sflw.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestWALMethods </h4><pre class="type-7 type-8 type-16 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEntrySink() throws Exception {
  Configuration conf=new Configuration();
  RecoveryMode mode=(conf.getBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,false) ? RecoveryMode.LOG_REPLAY : RecoveryMode.LOG_SPLITTING);
  EntryBuffers sink=new EntryBuffers(new PipelineController(),1 * 1024 * 1024);
  for (int i=0; i < 1000; i++) {
    WAL.Entry entry=createTestLogEntry(i);
    sink.appendEntry(entry);
  }
  assertTrue(sink.totalBuffered > 0);
  long amountInChunk=sink.totalBuffered;
  RegionEntryBuffer chunk=sink.getChunkToWrite();
  assertEquals(chunk.heapSize(),amountInChunk);
  assertTrue(sink.isRegionCurrentlyWriting(TEST_REGION));
  for (int i=0; i < 500; i++) {
    WAL.Entry entry=createTestLogEntry(i);
    sink.appendEntry(entry);
  }
  assertNull(sink.getChunkToWrite());
  sink.doneWriting(chunk);
  RegionEntryBuffer chunk2=sink.getChunkToWrite();
  assertNotNull(chunk2);
  assertNotSame(chunk,chunk2);
  long amountInChunk2=sink.totalBuffered;
  assertTrue(amountInChunk2 < amountInChunk);
  sink.doneWriting(chunk2);
  assertEquals(0,sink.totalBuffered);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegionEntryBuffer() throws Exception {
  WALSplitter.RegionEntryBuffer reb=new WALSplitter.RegionEntryBuffer(TEST_TABLE,TEST_REGION);
  assertEquals(0,reb.heapSize());
  reb.appendEntry(createTestLogEntry(1));
  assertTrue(reb.heapSize() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestHQuorumPeer </h4><pre class="type-4 type-7 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAssignDefaultZookeeperClientPort(){
  Configuration config=HBaseConfiguration.create();
  config.clear();
  Properties p=ZKConfig.makeZKProps(config);
  assertNotNull(p);
  assertEquals(2181,p.get("clientPort"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZKConfig </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetZooKeeperClusterKey(){
  Configuration conf=HBaseConfiguration.create();
  conf.set(HConstants.ZOOKEEPER_QUORUM,"\tlocalhost\n");
  conf.set(HConstants.ZOOKEEPER_CLIENT_PORT,"3333");
  conf.set(HConstants.ZOOKEEPER_ZNODE_PARENT,"hbase");
  String clusterKey=ZKConfig.getZooKeeperClusterKey(conf,"test");
  assertTrue(!clusterKey.contains("\t") && !clusterKey.contains("\n"));
  assertEquals("localhost:3333:hbase,test",clusterKey);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZKLeaderManager </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeaderSelection() throws Exception {
  MockLeader currentLeader=getCurrentLeader();
  assertNotNull("Leader should exist",currentLeader);
  LOG.debug("Current leader index is " + currentLeader.getIndex());
  byte[] znodeData=ZKUtil.getData(currentLeader.getWatcher(),LEADER_ZNODE);
  assertNotNull("Leader znode should contain leader index",znodeData);
  assertTrue("Leader znode should not be empty",znodeData.length > 0);
  int storedIndex=Bytes.toInt(znodeData);
  LOG.debug("Stored leader index in ZK is " + storedIndex);
  assertEquals("Leader znode should match leader index",currentLeader.getIndex(),storedIndex);
  currentLeader.abdicate();
  assertFalse(currentLeader.isMaster());
  currentLeader=getCurrentLeader();
  assertNotNull("New leader should exist after abdication",currentLeader);
  LOG.debug("New leader index is " + currentLeader.getIndex());
  znodeData=ZKUtil.getData(currentLeader.getWatcher(),LEADER_ZNODE);
  assertNotNull("Leader znode should contain leader index",znodeData);
  assertTrue("Leader znode should not be empty",znodeData.length > 0);
  storedIndex=Bytes.toInt(znodeData);
  LOG.debug("Stored leader index in ZK is " + storedIndex);
  assertEquals("Leader znode should match leader index",currentLeader.getIndex(),storedIndex);
  currentLeader.stop("Stopping for test");
  assertFalse(currentLeader.isMaster());
  currentLeader=getCurrentLeader();
  assertNotNull("New leader should exist after stop",currentLeader);
  LOG.debug("New leader index is " + currentLeader.getIndex());
  znodeData=ZKUtil.getData(currentLeader.getWatcher(),LEADER_ZNODE);
  assertNotNull("Leader znode should contain leader index",znodeData);
  assertTrue("Leader znode should not be empty",znodeData.length > 0);
  storedIndex=Bytes.toInt(znodeData);
  LOG.debug("Stored leader index in ZK is " + storedIndex);
  assertEquals("Leader znode should match leader index",currentLeader.getIndex(),storedIndex);
  currentLeader.stop("Stopping for test");
  assertFalse(currentLeader.isMaster());
  currentLeader=getCurrentLeader();
  assertNotNull("New leader should exist",currentLeader);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZKUtil </h4><pre class="type-4 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateACL() throws ZooKeeperConnectionException, IOException {
  Configuration conf=HBaseConfiguration.create();
  conf.set(Superusers.SUPERUSER_CONF_KEY,"user1,@group1,user2,@group2,user3");
  String node="/hbase/testCreateACL";
  ZooKeeperWatcher watcher=new ZooKeeperWatcher(conf,node,null,false);
  List<ACL> aclList=ZKUtil.createACL(watcher,node,true);
  Assert.assertEquals(aclList.size(),4);
  Assert.assertTrue(!aclList.contains(new ACL(Perms.ALL,new Id("auth","@group1"))) && !aclList.contains(new ACL(Perms.ALL,new Id("auth","@group2"))));
  Assert.assertTrue(aclList.contains(new ACL(Perms.ALL,new Id("auth","user1"))) && aclList.contains(new ACL(Perms.ALL,new Id("auth","user2"))) && aclList.contains(new ACL(Perms.ALL,new Id("auth","user3"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZooKeeperACL </h4><pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/master should be
 * created with 2 ACLs: one specifies that the hbase user has full access
 * to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseMasterServerZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/master",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/hbaseid should be
 * created with 2 ACLs: one specifies that the hbase user has full access
 * to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseIDZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/hbaseid",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * When authentication is enabled on Zookeeper, /hbase/root-region-server
 * should be created with 2 ACLs: one specifies that the hbase user has
 * full access to the node; the other, that it is world-readable.
 */
@Test(timeout=30000) public void testHBaseRootRegionServerZNodeACL() throws Exception {
  if (!secureZKAvailable) {
    return;
  }
  List<ACL> acls=zkw.getRecoverableZooKeeper().getZooKeeper().getACL("/hbase/root-region-server",new Stat());
  assertEquals(acls.size(),2);
  boolean foundWorldReadableAcl=false;
  boolean foundHBaseOwnerAcl=false;
  for (int i=0; i < 2; i++) {
    if (acls.get(i).getId().getScheme().equals("world") == true) {
      assertEquals(acls.get(0).getId().getId(),"anyone");
      assertEquals(acls.get(0).getPerms(),ZooDefs.Perms.READ);
      foundWorldReadableAcl=true;
    }
 else {
      if (acls.get(i).getId().getScheme().equals("sasl") == true) {
        assertEquals(acls.get(1).getId().getId(),"hbase");
        assertEquals(acls.get(1).getId().getScheme(),"sasl");
        foundHBaseOwnerAcl=true;
      }
 else {
        assertTrue(false);
      }
    }
  }
  assertTrue(foundWorldReadableAcl);
  assertTrue(foundHBaseOwnerAcl);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZooKeeperMainServer </h4><pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * We need delete of a znode to work at least.
 * @throws Exception
 */
@Test public void testCommandLineWorks() throws Exception {
  System.setSecurityManager(new NoExitSecurityManager());
  HBaseTestingUtility htu=new HBaseTestingUtility();
  htu.getConfiguration().setInt(HConstants.ZK_SESSION_TIMEOUT,1000);
  htu.startMiniZKCluster();
  try {
    ZooKeeperWatcher zkw=htu.getZooKeeperWatcher();
    String znode="/testCommandLineWorks";
    ZKUtil.createWithParents(zkw,znode,HConstants.EMPTY_BYTE_ARRAY);
    ZKUtil.checkExists(zkw,znode);
    boolean exception=false;
    try {
      ZooKeeperMainServer.main(new String[]{"-server","localhost:" + htu.getZkCluster().getClientPort(),"delete",znode});
    }
 catch (    ExitException ee) {
      exception=true;
    }
    assertTrue(exception);
    assertEquals(-1,ZKUtil.checkExists(zkw,znode));
  }
  finally {
    htu.shutdownMiniZKCluster();
    System.setSecurityManager(null);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostPortParse(){
  ZooKeeperMainServer parser=new ZooKeeperMainServer();
  Configuration c=HBaseConfiguration.create();
  assertEquals("localhost:" + c.get(HConstants.ZOOKEEPER_CLIENT_PORT),parser.parse(c));
  final String port="1234";
  c.set(HConstants.ZOOKEEPER_CLIENT_PORT,port);
  c.set("hbase.zookeeper.quorum","example.com");
  assertEquals("example.com:" + port,parser.parse(c));
  c.set("hbase.zookeeper.quorum","example1.com,example2.com,example3.com");
  String ensemble=parser.parse(c);
  assertTrue(port,ensemble.matches("(example[1-3]\\.com:1234,){2}example[1-3]\\.com:" + port));
  c.set("hbase.zookeeper.quorum","example1.com:5678,example2.com:9012,example3.com:3456");
  ensemble=parser.parse(c);
  assertEquals(ensemble,"example1.com:5678,example2.com:9012,example3.com:3456");
  c.set("hbase.zookeeper.quorum","example1.com:5678,example2.com:9012,example3.com");
  ensemble=parser.parse(c);
  assertEquals(ensemble,"example1.com:5678,example2.com:9012,example3.com:" + port);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZooKeeperNodeTracker </h4><pre class="type-4 type-7 type-8 type-13 type-5 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNodeTracker() throws Exception {
  Abortable abortable=new StubAbortable();
  ZooKeeperWatcher zk=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"testNodeTracker",abortable);
  ZKUtil.createAndFailSilent(zk,zk.baseZNode);
  final String node=ZKUtil.joinZNode(zk.baseZNode,new Long(rand.nextLong()).toString());
  final byte[] dataOne=Bytes.toBytes("dataOne");
  final byte[] dataTwo=Bytes.toBytes("dataTwo");
  TestTracker localTracker=new TestTracker(zk,node,abortable);
  localTracker.start();
  zk.registerListener(localTracker);
  assertNull(localTracker.getData(false));
  WaitToGetDataThread thread=new WaitToGetDataThread(zk,node);
  thread.start();
  assertFalse(thread.hasData);
  TestTracker secondTracker=new TestTracker(zk,node,null);
  secondTracker.start();
  zk.registerListener(secondTracker);
  TestingZKListener zkListener=new TestingZKListener(zk,node);
  zk.registerListener(zkListener);
  assertEquals(0,zkListener.createdLock.availablePermits());
  final ZooKeeper zkconn=new ZooKeeper(ZKConfig.getZKQuorumServersString(TEST_UTIL.getConfiguration()),60000,new StubWatcher());
  zkconn.create(node,dataOne,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zkListener.waitForCreation();
  thread.join();
  assertNotNull(localTracker.getData(false));
  assertNotNull(localTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(localTracker.getData(false),dataOne));
  assertTrue(thread.hasData);
  assertTrue(Bytes.equals(thread.tracker.getData(false),dataOne));
  LOG.info("Successfully got data one");
  assertNotNull(secondTracker.getData(false));
  assertNotNull(secondTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(secondTracker.getData(false),dataOne));
  LOG.info("Successfully got data one with the second tracker");
  zkconn.delete(node,-1);
  zkListener.waitForDeletion();
  TestTracker threadTracker=thread.tracker;
  thread=new WaitToGetDataThread(zk,node,threadTracker);
  thread.start();
  assertFalse(thread.hasData);
  assertNull(secondTracker.getData(false));
  assertNull(localTracker.getData(false));
  LOG.info("Successfully made unavailable");
  zkconn.create(node,dataTwo,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zkListener.waitForCreation();
  thread.join();
  assertNotNull(localTracker.getData(false));
  assertNotNull(localTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(localTracker.getData(false),dataTwo));
  assertNotNull(secondTracker.getData(false));
  assertNotNull(secondTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(secondTracker.getData(false),dataTwo));
  assertTrue(thread.hasData);
  assertTrue(Bytes.equals(thread.tracker.getData(false),dataTwo));
  LOG.info("Successfully got data two on all trackers and threads");
  zkconn.setData(node,dataOne,-1);
  zkListener.waitForDataChange();
  assertNotNull(localTracker.getData(false));
  assertNotNull(localTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(localTracker.getData(false),dataOne));
  assertNotNull(secondTracker.getData(false));
  assertNotNull(secondTracker.blockUntilAvailable());
  assertTrue(Bytes.equals(secondTracker.getData(false),dataOne));
  assertTrue(thread.hasData);
  assertTrue(Bytes.equals(thread.tracker.getData(false),dataOne));
  LOG.info("Successfully got data one following a data change on all trackers and threads");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
