<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestAcidGuarantees </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetAtomicity() throws Exception {
  tag.runTestAtomicity(20000,4,4,0,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanAtomicity() throws Exception {
  tag.runTestAtomicity(20000,3,0,2,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMixedAtomicity() throws Exception {
  tag.runTestAtomicity(20000,4,2,2,3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestDDLMasterFailover </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsUnitTest() throws Exception {
  runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestIngest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIngest() throws Exception {
  runIngestTest(JUNIT_RUN_TIME,2500,10,1024,10,20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestIngestWithMOB </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIngest() throws Exception {
  runIngestTest(JUNIT_RUN_TIME,100,10,1024,10,20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestMetaReplicas </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShutdownHandling() throws Exception {
  TestMetaWithReplicas.shutdownMetaAndDoValidations(util);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.IntegrationTestRegionReplicaReplication </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Override @Test public void testIngest() throws Exception {
  runIngestTest(JUNIT_RUN_TIME,25000,10,1024,10,20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestAcidGuarantees </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMobGetAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    boolean systemTest=false;
    boolean useMob=true;
    runTestAtomicity(20000,5,5,0,3,systemTest,useMob);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMobMixedAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    boolean systemTest=false;
    boolean useMob=true;
    runTestAtomicity(20000,5,2,2,3,systemTest,useMob);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMixedAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    runTestAtomicity(20000,5,2,2,3);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    runTestAtomicity(20000,5,0,5,3);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    runTestAtomicity(20000,5,5,0,3);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMobScanAtomicity() throws Exception {
  util.startMiniCluster(1);
  try {
    boolean systemTest=false;
    boolean useMob=true;
    runTestAtomicity(20000,5,0,5,3,systemTest,useMob);
  }
  finally {
    util.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestCellUtil </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Was overflowing if 100k or so lists of cellscanners to return.
 * @throws IOException
 */
@Test public void testCreateCellScannerOverflow() throws IOException {
  consume(doCreateCellScanner(1,1),1 * 1);
  consume(doCreateCellScanner(3,0),3 * 0);
  consume(doCreateCellScanner(3,3),3 * 3);
  consume(doCreateCellScanner(0,1),0 * 1);
  final int hundredK=100000;
  consume(doCreateCellScanner(hundredK,0),hundredK * 0);
  consume(doCreateCellArray(1),1);
  consume(doCreateCellArray(0),0);
  consume(doCreateCellArray(3),3);
  List<CellScannable> cells=new ArrayList<CellScannable>(hundredK);
  for (int i=0; i < hundredK; i++) {
    cells.add(new TestCellScannable(1));
  }
  consume(CellUtil.createCellScanner(cells),hundredK * 1);
  NavigableMap<byte[],List<Cell>> m=new TreeMap<byte[],List<Cell>>(Bytes.BYTES_COMPARATOR);
  List<Cell> cellArray=new ArrayList<Cell>(hundredK);
  for (int i=0; i < hundredK; i++)   cellArray.add(new TestCell(i));
  m.put(new byte[]{'f'},cellArray);
  consume(CellUtil.createCellScanner(m),hundredK * 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestClusterBootOrder </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests launching the cluster by first starting regionserver, and then the master
 * to ensure that it does not matter which is started first.
 */
@Test public void testBootRegionServerFirst() throws Exception {
  startRegionServer();
  startMaster();
  waitForClusterOnline();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests launching the cluster by first starting master, and then the regionserver
 * to ensure that it does not matter which is started first.
 */
@Test public void testBootMasterFirst() throws Exception {
  startMaster();
  startRegionServer();
  waitForClusterOnline();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHColumnDescriptor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClassMethodsAreBuilderStyle(){
  BuilderStyleTest.assertClassesAreBuilderStyle(HColumnDescriptor.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHColumnDescriptorDefaultVersions </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithDefaultFromConf() throws Exception {
  TEST_UTIL.shutdownMiniCluster();
  TEST_UTIL.getConfiguration().setInt("hbase.column.max.version",3);
  TEST_UTIL.startMiniCluster(1);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY);
  hcd.setMaxVersions(TEST_UTIL.getConfiguration().getInt("hbase.column.max.version",1));
  baseHtd.addFamily(hcd);
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyHColumnDescriptor(3,TABLE_NAME,FAMILY);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithSetVersion() throws Exception {
  TEST_UTIL.shutdownMiniCluster();
  TEST_UTIL.getConfiguration().setInt("hbase.column.max.version",3);
  TEST_UTIL.startMiniCluster(1);
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY);
  hcd.setMaxVersions(5);
  baseHtd.addFamily(hcd);
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyHColumnDescriptor(5,TABLE_NAME,FAMILY);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithDefault() throws IOException {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  HColumnDescriptor hcd=new HColumnDescriptor(FAMILY);
  baseHtd.addFamily(hcd);
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyHColumnDescriptor(1,TABLE_NAME,FAMILY);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHRegionLocation </h4><pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testToString(){
  ServerName hsa1=ServerName.valueOf("localhost",1234,-1L);
  HRegionLocation hrl1=new HRegionLocation(HRegionInfo.FIRST_META_REGIONINFO,hsa1);
  System.out.println(hrl1.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestHTableDescriptor </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testModifyInexistentFamily(){
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("table"));
  byte[] familyName=Bytes.toBytes("cf");
  HColumnDescriptor hcd=new HColumnDescriptor(familyName);
  htd.modifyFamily(hcd);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClassMethodsAreBuilderStyle(){
  BuilderStyleTest.assertClassesAreBuilderStyle(HTableDescriptor.class);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testAddCoprocessorTwice() throws IOException {
  HTableDescriptor htd=new HTableDescriptor(TableName.META_TABLE_NAME);
  String cpName="a.b.c.d";
  htd.addCoprocessor(cpName);
  htd.addCoprocessor(cpName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegalHTableNames(){
  for (  String tn : legalTableNames) {
    TableName.isLegalFullyQualifiedTableName(Bytes.toBytes(tn));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestIOFencing </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that puts up a regionserver, starts a compaction on a loaded region but holds the
 * compaction completion until after we have killed the server and the region has come up on
 * a new regionserver altogether.  This fakes the double assignment case where region in one
 * location changes the files out from underneath a region being served elsewhere.
 */
@Test public void testFencingAroundCompactionAfterWALSync() throws Exception {
  doTest(BlockCompactionsInCompletionRegion.class);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that puts up a regionserver, starts a compaction on a loaded region but holds the
 * compaction until after we have killed the server and the region has come up on
 * a new regionserver altogether.  This fakes the double assignment case where region in one
 * location changes the files out from underneath a region being served elsewhere.
 */
@Test public void testFencingAroundCompaction() throws Exception {
  doTest(BlockCompactionsInPrepRegion.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestIPv6NIOServerSocketChannel </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests whether every InetAddress we obtain by resolving can open a
 * ServerSocketChannel.
 */
@Test public void testServerSocketFromLocalhostResolution() throws IOException {
  InetAddress[] addrs=InetAddress.getAllByName("localhost");
  for (  InetAddress addr : addrs) {
    LOG.info("resolved localhost as:" + addr);
    bindServerSocket(addr);
    bindNIOServerSocket(addr);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestInfoServers </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that the status pages in the minicluster load properly.
 * This is somewhat a duplicate of TestRSStatusServlet and
 * TestMasterStatusServlet, but those are true unit tests
 * whereas this uses a cluster.
 */
@Test public void testInfoServersStatusPages() throws Exception {
  int port=UTIL.getHBaseCluster().getMaster().getInfoServer().getPort();
  assertContainsContent(new URL("http://localhost:" + port + "/master-status"),"meta");
  port=UTIL.getHBaseCluster().getRegionServerThreads().get(0).getRegionServer().getInfoServer().getPort();
  assertContainsContent(new URL("http://localhost:" + port + "/rs-status"),"meta");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMasterServerReadOnly() throws Exception {
  TableName tableName=TableName.valueOf("testMasterServerReadOnly");
  byte[] cf=Bytes.toBytes("d");
  UTIL.createTable(tableName,cf);
  UTIL.waitTableAvailable(tableName);
  int port=UTIL.getHBaseCluster().getMaster().getInfoServer().getPort();
  assertDoesNotContainContent(new URL("http://localhost:" + port + "/table.jsp?name="+ tableName+ "&action=split&key="),"Table action request accepted");
  assertDoesNotContainContent(new URL("http://localhost:" + port + "/table.jsp?name="+ tableName),"Actions:");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testInfoServersRedirect() throws Exception {
  UTIL.getConnection().getTable(TableName.META_TABLE_NAME).close();
  int port=UTIL.getHBaseCluster().getMaster().getInfoServer().getPort();
  assertContainsContent(new URL("http://localhost:" + port + "/index.html"),"master-status");
  port=UTIL.getHBaseCluster().getRegionServerThreads().get(0).getRegionServer().getInfoServer().getPort();
  assertContainsContent(new URL("http://localhost:" + port + "/index.html"),"rs-status");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestJMXListener </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStop() throws Exception {
  MiniHBaseCluster cluster=UTIL.getHBaseCluster();
  LOG.info("shutdown hbase cluster...");
  cluster.shutdown();
  LOG.info("wait for the hbase cluster shutdown...");
  cluster.waitUntilShutDown();
  JMXConnector connector=JMXConnectorFactory.newJMXConnector(JMXListener.buildJMXServiceURL(connectorPort,connectorPort),null);
  expectedEx.expect(IOException.class);
  connector.connect();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMetaTableAccessor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaLocationForRegionReplicasIsAddedAtRegionMerge() throws IOException {
  long regionId=System.currentTimeMillis();
  ServerName serverName0=ServerName.valueOf("foo",60010,random.nextLong());
  HRegionInfo parentA=new HRegionInfo(TableName.valueOf("table_foo"),Bytes.toBytes("a"),HConstants.EMPTY_END_ROW,false,regionId,0);
  HRegionInfo parentB=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,Bytes.toBytes("a"),false,regionId,0);
  HRegionInfo merged=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId + 1,0);
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<HRegionInfo> regionInfos=Lists.newArrayList(parentA,parentB);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,3);
    MetaTableAccessor.mergeRegions(connection,merged,parentA,parentB,serverName0,3,HConstants.LATEST_TIMESTAMP);
    assertEmptyMetaLocation(meta,merged.getRegionName(),1);
    assertEmptyMetaLocation(meta,merged.getRegionName(),2);
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaLocationForRegionReplicasIsAddedAtTableCreation() throws IOException {
  long regionId=System.currentTimeMillis();
  HRegionInfo primary=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,0);
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<HRegionInfo> regionInfos=Lists.newArrayList(primary);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,3);
    assertEmptyMetaLocation(meta,primary.getRegionName(),1);
    assertEmptyMetaLocation(meta,primary.getRegionName(),2);
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaScanner() throws Exception {
  LOG.info("Starting testMetaScanner");
  final TableName TABLENAME=TableName.valueOf("testMetaScanner");
  final byte[] FAMILY=Bytes.toBytes("family");
  final byte[][] SPLIT_KEYS=new byte[][]{Bytes.toBytes("region_a"),Bytes.toBytes("region_b")};
  UTIL.createTable(TABLENAME,FAMILY,SPLIT_KEYS);
  Table table=connection.getTable(TABLENAME);
  UTIL.countRows(table);
  MetaTableAccessor.Visitor visitor=mock(MetaTableAccessor.Visitor.class);
  doReturn(true).when(visitor).visit((Result)anyObject());
  MetaTableAccessor.scanMetaForTableRegions(connection,visitor,TABLENAME);
  verify(visitor,times(3)).visit((Result)anyObject());
  reset(visitor);
  doReturn(true).when(visitor).visit((Result)anyObject());
  MetaTableAccessor.scanMeta(connection,visitor,TABLENAME,null,1000);
  verify(visitor,times(3)).visit((Result)anyObject());
  reset(visitor);
  doReturn(true).when(visitor).visit((Result)anyObject());
  MetaTableAccessor.scanMeta(connection,visitor,TABLENAME,Bytes.toBytes("region_ac"),1000);
  verify(visitor,times(2)).visit((Result)anyObject());
  reset(visitor);
  doReturn(true).when(visitor).visit((Result)anyObject());
  MetaTableAccessor.scanMeta(connection,visitor,TABLENAME,Bytes.toBytes("region_ac"),1);
  verify(visitor,times(1)).visit((Result)anyObject());
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaLocationsForRegionReplicas() throws IOException {
  ServerName serverName0=ServerName.valueOf("foo",60010,random.nextLong());
  ServerName serverName1=ServerName.valueOf("bar",60010,random.nextLong());
  ServerName serverName100=ServerName.valueOf("baz",60010,random.nextLong());
  long regionId=System.currentTimeMillis();
  HRegionInfo primary=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,0);
  HRegionInfo replica1=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,1);
  HRegionInfo replica100=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,100);
  long seqNum0=random.nextLong();
  long seqNum1=random.nextLong();
  long seqNum100=random.nextLong();
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    MetaTableAccessor.updateRegionLocation(connection,primary,serverName0,seqNum0,-1);
    assertMetaLocation(meta,primary.getRegionName(),serverName0,seqNum0,0,true);
    MetaTableAccessor.updateRegionLocation(connection,replica1,serverName1,seqNum1,-1);
    assertMetaLocation(meta,primary.getRegionName(),serverName0,seqNum0,0,true);
    assertMetaLocation(meta,primary.getRegionName(),serverName1,seqNum1,1,true);
    MetaTableAccessor.updateRegionLocation(connection,replica100,serverName100,seqNum100,-1);
    assertMetaLocation(meta,primary.getRegionName(),serverName0,seqNum0,0,true);
    assertMetaLocation(meta,primary.getRegionName(),serverName1,seqNum1,1,true);
    assertMetaLocation(meta,primary.getRegionName(),serverName100,seqNum100,100,true);
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaLocationForRegionReplicasIsAddedAtRegionSplit() throws IOException {
  long regionId=System.currentTimeMillis();
  ServerName serverName0=ServerName.valueOf("foo",60010,random.nextLong());
  HRegionInfo parent=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,regionId,0);
  HRegionInfo splitA=new HRegionInfo(TableName.valueOf("table_foo"),HConstants.EMPTY_START_ROW,Bytes.toBytes("a"),false,regionId + 1,0);
  HRegionInfo splitB=new HRegionInfo(TableName.valueOf("table_foo"),Bytes.toBytes("a"),HConstants.EMPTY_END_ROW,false,regionId + 1,0);
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<HRegionInfo> regionInfos=Lists.newArrayList(parent);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,3);
    MetaTableAccessor.splitRegion(connection,parent,splitA,splitB,serverName0,3);
    assertEmptyMetaLocation(meta,splitA.getRegionName(),1);
    assertEmptyMetaLocation(meta,splitA.getRegionName(),2);
    assertEmptyMetaLocation(meta,splitB.getRegionName(),1);
    assertEmptyMetaLocation(meta,splitB.getRegionName(),2);
  }
  finally {
    meta.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMetaTableLocator </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that verifyMetaRegionLocation properly handles getting a
 * ServerNotRunningException. See HBASE-4470.
 * Note this doesn't check the exact exception thrown in the
 * HBASE-4470 as there it is thrown from getHConnection() and
 * here it is thrown from get() -- but those are both called
 * from the same function anyway, and this way is less invasive than
 * throwing from getHConnection would be.
 * @throws IOException
 * @throws InterruptedException
 * @throws KeeperException
 * @throws ServiceException
 */
@Test public void testVerifyMetaRegionServerNotRunning() throws IOException, InterruptedException, KeeperException, ServiceException {
  testVerifyMetaRegionLocationWithException(new ServerNotRunningYetException("mock"));
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NotAllMetaRegionsOnlineException.class) public void testTimeoutWaitForMeta() throws IOException, InterruptedException {
  new MetaTableLocator().waitMetaRegionLocation(watcher,100);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test we survive a connection refused {@link ConnectException}
 * @throws IOException
 * @throws InterruptedException
 * @throws KeeperException
 * @throws ServiceException
 */
@Test public void testGetMetaServerConnectionFails() throws IOException, InterruptedException, KeeperException, ServiceException {
  testVerifyMetaRegionLocationWithException(new ConnectException("Connection refused"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMovedRegionsCleaner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Start the cluster, wait for some time and verify that the background
 * MovedRegion cleaner indeed gets called
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testMovedRegionsCleaner() throws IOException, InterruptedException {
  UTIL.waitFor(2000,new Waiter.Predicate<IOException>(){
    @Override public boolean evaluate() throws IOException {
      return numCalls > 0;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestMultiVersions </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests user specifiable time stamps putting, getting and scanning.  Also
 * tests same in presence of deletes.  Test cores are written so can be
 * run against an HRegion and against an HTable: i.e. both local and remote.
 * <p>Port of old TestTimestamp test to here so can better utilize the spun
 * up cluster running more than a single test per spin up.  Keep old tests'
 * crazyness.
 */
@Test public void testTimestamps() throws Exception {
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf("testTimestamps"));
  HColumnDescriptor hcd=new HColumnDescriptor(TimestampTestBase.FAMILY_NAME);
  hcd.setMaxVersions(3);
  desc.addFamily(hcd);
  this.admin.createTable(desc);
  Table table=UTIL.getConnection().getTable(desc.getTableName());
  TimestampTestBase.doTestDelete(table,new FlushCache(){
    public void flushcache() throws IOException {
      UTIL.getHBaseCluster().flushcache();
    }
  }
);
  TimestampTestBase.doTestTimestampScanning(table,new FlushCache(){
    public void flushcache() throws IOException {
      UTIL.getMiniHBaseCluster().flushcache();
    }
  }
);
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestNodeHealthCheckChore </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testHealthCheckerTimeout() throws Exception {
  String timeOutScript="sleep 10" + eol + "echo \"I am fine\"";
  healthCheckerTest(timeOutScript,HealthCheckerExitStatus.TIMED_OUT);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testHealthCheckerSuccess() throws Exception {
  String normalScript="echo \"I am all fine\"";
  healthCheckerTest(normalScript,HealthCheckerExitStatus.SUCCESS);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testHealthCheckerFail() throws Exception {
  String errorScript="echo ERROR" + eol + "echo \"Node not healthy\"";
  healthCheckerTest(errorScript,HealthCheckerExitStatus.FAILED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestServerSideScanMetricsFromClientSide </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowsFilteredMetric() throws Exception {
  Scan baseScan;
  baseScan=new Scan();
  baseScan.setScanMetricsEnabled(true);
  testRowsFilteredMetric(baseScan);
  baseScan.setCaching(1);
  testRowsFilteredMetric(baseScan);
  baseScan.setMaxResultSize(1);
  testRowsFilteredMetric(baseScan);
  baseScan.setCaching(NUM_ROWS);
  baseScan.setMaxResultSize(getCellHeapSize() * (NUM_COLS - 1));
  testRowsSeenMetric(baseScan);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowsSeenMetric() throws Exception {
  Scan baseScan;
  baseScan=new Scan();
  baseScan.setScanMetricsEnabled(true);
  testRowsSeenMetric(baseScan);
  baseScan.setCaching(1);
  testRowsSeenMetric(baseScan);
  baseScan.setMaxResultSize(1);
  testRowsSeenMetric(baseScan);
  baseScan.setCaching(NUM_ROWS);
  baseScan.setMaxResultSize(getCellHeapSize() * (NUM_COLS - 1));
  testRowsSeenMetric(baseScan);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.TestZooKeeper </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test should not fail with NPE when getChildDataAndWatchForNewChildren
 * invoked with wrongNode
 */
@Test @SuppressWarnings("deprecation") public void testGetChildDataAndWatchForNewChildrenShouldNotThrowNPE() throws Exception {
  ZooKeeperWatcher zkw=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"testGetChildDataAndWatchForNewChildrenShouldNotThrowNPE",null);
  ZKUtil.getChildDataAndWatchForNewChildren(zkw,"/wrongNode");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testRegionServerSessionExpired() throws Exception {
  LOG.info("Starting testRegionServerSessionExpired");
  TEST_UTIL.expireRegionServerSession(0);
  testSanity("testRegionServerSessionExpired");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for HBASE-3238
 * @throws IOException A connection attempt to zk failed
 * @throws InterruptedException One of the non ZKUtil actions was interrupted
 * @throws KeeperException Any of the zookeeper connections had a
 * KeeperException
 */
@Test public void testCreateSilentIsReallySilent() throws InterruptedException, KeeperException, IOException {
  Configuration c=TEST_UTIL.getConfiguration();
  String aclZnode="/aclRoot";
  String quorumServers=ZKConfig.getZKQuorumServersString(c);
  int sessionTimeout=5 * 1000;
  ZooKeeper zk=new ZooKeeper(quorumServers,sessionTimeout,EmptyWatcher.instance);
  zk.addAuthInfo("digest","hbase:rox".getBytes());
  ZooKeeperWatcher zk2=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"testCreateSilentIsReallySilent",null);
  Stat s=null;
  List<ACL> oldACL=null;
  while (true) {
    try {
      s=new Stat();
      oldACL=zk.getACL("/",s);
      break;
    }
 catch (    KeeperException e) {
switch (e.code()) {
case CONNECTIONLOSS:
case SESSIONEXPIRED:
case OPERATIONTIMEOUT:
        LOG.warn("Possibly transient ZooKeeper exception",e);
      Threads.sleep(100);
    break;
default :
  throw e;
}
}
}
while (true) {
try {
zk.setACL("/",ZooDefs.Ids.CREATOR_ALL_ACL,-1);
break;
}
 catch (KeeperException e) {
switch (e.code()) {
case CONNECTIONLOSS:
case SESSIONEXPIRED:
case OPERATIONTIMEOUT:
LOG.warn("Possibly transient ZooKeeper exception: " + e);
Threads.sleep(100);
break;
default :
throw e;
}
}
}
while (true) {
try {
zk.create(aclZnode,null,ZooDefs.Ids.CREATOR_ALL_ACL,CreateMode.PERSISTENT);
break;
}
 catch (KeeperException e) {
switch (e.code()) {
case CONNECTIONLOSS:
case SESSIONEXPIRED:
case OPERATIONTIMEOUT:
LOG.warn("Possibly transient ZooKeeper exception: " + e);
Threads.sleep(100);
break;
default :
throw e;
}
}
}
zk.close();
ZKUtil.createAndFailSilent(zk2,aclZnode);
ZooKeeper zk3=new ZooKeeper(quorumServers,sessionTimeout,EmptyWatcher.instance);
zk3.addAuthInfo("digest","hbase:rox".getBytes());
try {
zk3.setACL("/",oldACL,-1);
}
  finally {
zk3.close();
}
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testMasterSessionExpired() throws Exception {
  LOG.info("Starting testMasterSessionExpired");
  TEST_UTIL.expireMasterSession();
  testSanity("testMasterSessionExpired");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAdmin1 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testEnableDisableAddColumnDeleteColumn() throws Exception {
  TableName tableName=TableName.valueOf("testEnableDisableAddColumnDeleteColumn");
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  while (!this.admin.isTableEnabled(TableName.valueOf("testEnableDisableAddColumnDeleteColumn"))) {
    Thread.sleep(10);
  }
  this.admin.disableTable(tableName);
  try {
    TEST_UTIL.getConnection().getTable(tableName);
  }
 catch (  org.apache.hadoop.hbase.DoNotRetryIOException e) {
  }
  this.admin.addColumnFamily(tableName,new HColumnDescriptor("col2"));
  this.admin.enableTable(tableName);
  try {
    this.admin.deleteColumnFamily(tableName,Bytes.toBytes("col2"));
  }
 catch (  TableNotDisabledException e) {
    LOG.info(e);
  }
  this.admin.disableTable(tableName);
  this.admin.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests forcing split from client and having scanners successfully ride over split.
 * @throws Exception
 * @throws IOException
 */
@Test(timeout=400000) public void testForceSplit() throws Exception {
  byte[][] familyNames=new byte[][]{Bytes.toBytes("cf")};
  int[] rowCounts=new int[]{6000};
  int numVersions=HColumnDescriptor.DEFAULT_VERSIONS;
  int blockSize=256;
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  byte[] splitKey=Bytes.toBytes(3500);
  splitTest(splitKey,familyNames,rowCounts,numVersions,blockSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Multi-family scenario. Tests forcing split from client and
 * having scanners successfully ride over split.
 * @throws Exception
 * @throws IOException
 */
@Test(timeout=800000) public void testForceSplitMultiFamily() throws Exception {
  int numVersions=HColumnDescriptor.DEFAULT_VERSIONS;
  int blockSize=256;
  byte[][] familyNames=new byte[][]{Bytes.toBytes("cf1"),Bytes.toBytes("cf2")};
  int[] rowCounts=new int[]{6000,1};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{1,6000};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{6000,300};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
  rowCounts=new int[]{300,6000};
  splitTest(null,familyNames,rowCounts,numVersions,blockSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testTruncateTable() throws IOException {
  testTruncateTable(TableName.valueOf("testTruncateTable"),false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testTruncateTablePreservingSplits() throws IOException {
  testTruncateTable(TableName.valueOf("testTruncateTablePreservingSplits"),true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAdmin2 </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Can't disable a table if the table isn't in enabled state
 * @throws IOException
 */
@Test(expected=TableNotEnabledException.class,timeout=300000) public void testTableNotEnabledExceptionWithATable() throws IOException {
  final TableName name=TableName.valueOf("testTableNotEnabledExceptionWithATable");
  TEST_UTIL.createTable(name,HConstants.CATALOG_FAMILY).close();
  this.admin.disableTable(name);
  this.admin.disableTable(name);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for hadoop-1581 'HBASE: Unopenable tablename bug'.
 * @throws Exception
 */
@Test(timeout=300000) public void testTableNameClash() throws Exception {
  String name="testTableNameClash";
  HTableDescriptor htd1=new HTableDescriptor(TableName.valueOf(name + "SOMEUPPERCASE"));
  HTableDescriptor htd2=new HTableDescriptor(TableName.valueOf(name));
  htd1.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  htd2.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(htd1);
  admin.createTable(htd2);
  TEST_UTIL.getConnection().getTable(htd2.getTableName()).close();
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * For HADOOP-2579
 * @throws IOException
 */
@Test(expected=TableExistsException.class,timeout=300000) public void testTableExistsExceptionWithATable() throws IOException {
  final TableName name=TableName.valueOf("testTableExistsExceptionWithATable");
  TEST_UTIL.createTable(name,HConstants.CATALOG_FAMILY).close();
  TEST_UTIL.createTable(name,HConstants.CATALOG_FAMILY);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test read only tables
 * @throws Exception
 */
@Test(timeout=300000) public void testReadOnlyTable() throws Exception {
  TableName name=TableName.valueOf("testReadOnlyTable");
  Table table=TEST_UTIL.createTable(name,HConstants.CATALOG_FAMILY);
  byte[] value=Bytes.toBytes("somedata");
  Put put=new Put(value);
  put.addColumn(HConstants.CATALOG_FAMILY,HConstants.CATALOG_FAMILY,value);
  table.put(put);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HMaster.createTable used to be kind of synchronous call
 * Thus creating of table with lots of regions can cause RPC timeout
 * After the fix to make createTable truly async, RPC timeout shouldn't be an
 * issue anymore
 * @throws Exception
 */
@Test(timeout=300000) public void testCreateTableRPCTimeOut() throws Exception {
  String name="testCreateTableRPCTimeOut";
  int oldTimeout=TEST_UTIL.getConfiguration().getInt(HConstants.HBASE_RPC_TIMEOUT_KEY,HConstants.DEFAULT_HBASE_RPC_TIMEOUT);
  TEST_UTIL.getConfiguration().setInt(HConstants.HBASE_RPC_TIMEOUT_KEY,1500);
  try {
    int expectedRegions=100;
    byte[] startKey={1,1,1,1,1,1,1,1,1,1};
    byte[] endKey={9,9,9,9,9,9,9,9,9,9};
    Admin hbaseadmin=TEST_UTIL.getHBaseAdmin();
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name));
    htd.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
    hbaseadmin.createTable(htd,startKey,endKey,expectedRegions);
  }
  finally {
    TEST_UTIL.getConfiguration().setInt(HConstants.HBASE_RPC_TIMEOUT_KEY,oldTimeout);
  }
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * For HADOOP-2579
 * @throws IOException
 */
@Test(expected=TableNotFoundException.class,timeout=300000) public void testTableNotFoundExceptionWithoutAnyTables() throws IOException {
  TableName tableName=TableName.valueOf("testTableNotFoundExceptionWithoutAnyTables");
  Table ht=TEST_UTIL.getConnection().getTable(tableName);
  ht.get(new Get("e".getBytes()));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that user table names can contain '-' and '.' so long as they do not
 * start with same. HBASE-771
 * @throws IOException
 */
@Test(timeout=300000) public void testTableNames() throws IOException {
  byte[][] illegalNames=new byte[][]{Bytes.toBytes("-bad"),Bytes.toBytes(".bad")};
  for (  byte[] illegalName : illegalNames) {
    try {
      new HTableDescriptor(TableName.valueOf(illegalName));
      throw new IOException("Did not detect '" + Bytes.toString(illegalName) + "' as an illegal user table name");
    }
 catch (    IllegalArgumentException e) {
    }
  }
  byte[] legalName=Bytes.toBytes("g-oo.d");
  try {
    new HTableDescriptor(TableName.valueOf(legalName));
  }
 catch (  IllegalArgumentException e) {
    throw new IOException("Legal user table name: '" + Bytes.toString(legalName) + "' caused IllegalArgumentException: "+ e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Can't enable a table if the table isn't in disabled state
 * @throws IOException
 */
@Test(expected=TableNotDisabledException.class,timeout=300000) public void testTableNotDisabledExceptionWithATable() throws IOException {
  final TableName name=TableName.valueOf("testTableNotDisabledExceptionWithATable");
  Table t=TEST_UTIL.createTable(name,HConstants.CATALOG_FAMILY);
  try {
    this.admin.enableTable(name);
  }
  finally {
    t.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestAsyncProcess </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHTableFailedPutWithoutBuffer() throws Exception {
  doHTableFailedPut(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHTableFailedPutWithBuffer() throws Exception {
  doHTableFailedPut(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestBlockEvictionFromClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReverseScanWithCompaction() throws IOException, InterruptedException {
  testScanWithCompactionInternals("testReverseScanWithCompaction",true);
}

</code></pre>

<br>
<pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParallelGetsAndScanWithWrappedRegionScanner() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(2);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testParallelGetsAndScanWithWrappedRegionScanner");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserverWrapper.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    insertData(table);
    System.out.println("Flushing cache");
    region.flush(true);
    CustomInnerRegionObserver.waitForGets.set(true);
    ScanThread[] scanThreads=initiateScan(table,false);
    GetThread[] getThreads=initiateGet(table,false,false);
    Thread.sleep(100);
    CustomInnerRegionObserver.waitForGets.set(false);
    checkForBlockEviction(cache,false,false,true);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    getLatch.countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParallelGetsAndScans() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(2);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testParallelGetsAndScans");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    insertData(table);
    System.out.println("Flushing cache");
    region.flush(true);
    CustomInnerRegionObserver.waitForGets.set(true);
    ScanThread[] scanThreads=initiateScan(table,false);
    GetThread[] getThreads=initiateGet(table,false,false);
    checkForBlockEviction(cache,false,false,false);
    CustomInnerRegionObserver.waitForGets.set(false);
    checkForBlockEviction(cache,false,false,false);
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    for (    ScanThread thread : scanThreads) {
      thread.join();
    }
    System.out.println("Scans should have returned the bloks");
    CustomInnerRegionObserver.waitForGets.set(false);
    checkForBlockEviction(cache,true,true,false);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetWithCellsInDifferentFiles() throws IOException, InterruptedException {
  HTable table=null;
  try {
    latch=new CountDownLatch(1);
    getLatch=new CountDownLatch(1);
    TableName tableName=TableName.valueOf("testGetWithCellsInDifferentFiles");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024,CustomInnerRegionObserver.class.getName());
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setCacheDataOnWrite(true);
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    System.out.println("Flushing cache");
    CustomInnerRegionObserver.waitForGets.set(true);
    GetThread[] getThreads=initiateGet(table,false,false);
    Thread.sleep(200);
    CustomInnerRegionObserver.getCdl().get().countDown();
    for (    GetThread thread : getThreads) {
      thread.join();
    }
    CustomInnerRegionObserver.waitForGets.set(true);
    checkForBlockEviction(cache,true,false,false);
    getLatch.countDown();
    System.out.println("Gets should have returned the bloks");
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlockRefCountAfterSplits() throws IOException, InterruptedException {
  HTable table=null;
  try {
    TableName tableName=TableName.valueOf("testBlockRefCountAfterSplits");
    table=TEST_UTIL.createTable(tableName,FAMILIES_1,1,1024);
    RegionLocator locator=table.getRegionLocator();
    String regionName=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    Region region=TEST_UTIL.getRSForFirstRegionInTable(tableName).getFromOnlineRegions(regionName);
    Store store=region.getStores().iterator().next();
    CacheConfig cacheConf=store.getCacheConfig();
    cacheConf.setEvictOnClose(true);
    BlockCache cache=cacheConf.getBlockCache();
    Put put=new Put(ROW);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    put=new Put(ROW1);
    put.addColumn(FAMILY,QUALIFIER,data);
    table.put(put);
    region.flush(true);
    byte[] QUALIFIER2=Bytes.add(QUALIFIER,QUALIFIER);
    put=new Put(ROW2);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    put=new Put(ROW3);
    put.addColumn(FAMILY,QUALIFIER2,data2);
    table.put(put);
    region.flush(true);
    TEST_UTIL.getAdmin().split(tableName,ROW1);
    List<HRegionInfo> tableRegions=TEST_UTIL.getAdmin().getTableRegions(tableName);
    while (tableRegions.size() != 2) {
      tableRegions=TEST_UTIL.getAdmin().getTableRegions(tableName);
      Thread.sleep(100);
    }
    region.compact(true);
    Iterator<CachedBlock> iterator=cache.iterator();
    iterateBlockCache(cache,iterator);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanWithCompaction() throws IOException, InterruptedException {
  testScanWithCompactionInternals("testScanWithCompaction",false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestClientNoCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoNotRetryOnScanNext() throws IOException {
  this.conf.set("hbase.client.connection.impl",RegionServerStoppedOnScannerOpenConnection.class.getName());
  Connection connection=ConnectionFactory.createConnection(this.conf);
  Table table=connection.getTable(TableName.META_TABLE_NAME);
  ResultScanner scanner=table.getScanner(HConstants.CATALOG_FAMILY);
  try {
    Result result=null;
    while ((result=scanner.next()) != null) {
      LOG.info(result);
    }
  }
  finally {
    scanner.close();
    table.close();
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegionServerStoppedOnScannerOpen() throws IOException {
  this.conf.set("hbase.client.connection.impl",RegionServerStoppedOnScannerOpenConnection.class.getName());
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(TableName.META_TABLE_NAME);
  ResultScanner scanner=table.getScanner(HConstants.CATALOG_FAMILY);
  try {
    Result result=null;
    while ((result=scanner.next()) != null) {
      LOG.info(result);
    }
  }
  finally {
    scanner.close();
    table.close();
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoNotRetryMetaTableAccessor() throws IOException {
  this.conf.set("hbase.client.connection.impl",RegionServerStoppedOnScannerOpenConnection.class.getName());
  try (Connection connection=ConnectionFactory.createConnection(conf)){
    MetaTableAccessor.fullScanRegions(connection);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestCloneSnapshotFromClient </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=SnapshotDoesNotExistException.class) public void testCloneNonExistentSnapshot() throws IOException, InterruptedException {
  String snapshotName="random-snapshot-" + System.currentTimeMillis();
  TableName tableName=TableName.valueOf("random-table-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName,tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that tables created from the snapshot are still alive after source table deletion.
 */
@Test public void testCloneLinksAfterDelete() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("clonedtb1-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName0,clonedTableName);
  verifyRowCount(TEST_UTIL,clonedTableName,snapshot0Rows);
  admin.disableTable(clonedTableName);
  admin.snapshot(snapshotName2,clonedTableName);
  TableName clonedTableName2=TableName.valueOf("clonedtb2-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName2,clonedTableName2);
  verifyRowCount(TEST_UTIL,clonedTableName2,snapshot0Rows);
  admin.disableTable(clonedTableName2);
  TEST_UTIL.deleteTable(tableName);
  waitCleanerRun();
  admin.enableTable(clonedTableName);
  verifyRowCount(TEST_UTIL,clonedTableName,snapshot0Rows);
  admin.enableTable(clonedTableName2);
  verifyRowCount(TEST_UTIL,clonedTableName2,snapshot0Rows);
  admin.disableTable(clonedTableName2);
  TEST_UTIL.deleteTable(clonedTableName);
  waitCleanerRun();
  admin.enableTable(clonedTableName2);
  verifyRowCount(TEST_UTIL,clonedTableName2,snapshot0Rows);
  TableName clonedTableName3=TableName.valueOf("clonedtb3-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName2,clonedTableName3);
  verifyRowCount(TEST_UTIL,clonedTableName3,snapshot0Rows);
  TEST_UTIL.deleteTable(clonedTableName2);
  TEST_UTIL.deleteTable(clonedTableName3);
  admin.deleteSnapshot(snapshotName2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCloneSnapshot() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("clonedtb-" + System.currentTimeMillis());
  testCloneSnapshot(clonedTableName,snapshotName0,snapshot0Rows);
  testCloneSnapshot(clonedTableName,snapshotName1,snapshot1Rows);
  testCloneSnapshot(clonedTableName,emptySnapshot,0);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCloneSnapshotCrossNamespace() throws IOException, InterruptedException {
  String nsName="testCloneSnapshotCrossNamespace";
  admin.createNamespace(NamespaceDescriptor.create(nsName).build());
  TableName clonedTableName=TableName.valueOf(nsName,"clonedtb-" + System.currentTimeMillis());
  testCloneSnapshot(clonedTableName,snapshotName0,snapshot0Rows);
  testCloneSnapshot(clonedTableName,snapshotName1,snapshot1Rows);
  testCloneSnapshot(clonedTableName,emptySnapshot,0);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NamespaceNotFoundException.class) public void testCloneOnMissingNamespace() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("unknownNS:clonetb");
  admin.cloneSnapshot(snapshotName1,clonedTableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestFromClientSide </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-861
 * get with timestamp will return a value if there is a version with an
 * earlier timestamp
 */
@Test public void testJiraTest861() throws Exception {
  TableName TABLE=TableName.valueOf("testJiraTest861");
  byte[][] VALUES=makeNAscii(VALUE,7);
  long[] STAMPS=makeStamps(7);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  ht.put(put);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[1]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[5]);
  TEST_UTIL.flush();
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[1]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[5]);
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[6],VALUES[6]);
  ht.put(put);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[5]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[6],VALUES[6]);
  TEST_UTIL.flush();
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[5]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[6],VALUES[6]);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-33
 * Add a HTable get/obtainScanner method that retrieves all versions of a
 * particular column and row between two timestamps
 */
@Test public void testJiraTest33() throws Exception {
  TableName TABLE=TableName.valueOf("testJiraTest33");
  byte[][] VALUES=makeNAscii(VALUE,7);
  long[] STAMPS=makeStamps(7);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  ht.put(put);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,2);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,3);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,2);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,3);
  TEST_UTIL.flush();
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,2);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  getVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,3);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,2);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  scanVersionRangeAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test simple table and non-existent row cases.
 */
@Test public void testSimpleMissingWithReverseScan() throws Exception {
  TableName TABLE=TableName.valueOf("testSimpleMissingWithReverseScan");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  byte[][] ROWS=makeN(ROW,4);
  Scan scan=new Scan();
  scan.setReversed(true);
  Result result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan(ROWS[0]);
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan(ROWS[0],ROWS[1]);
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.setReversed(true);
  scan.addFamily(FAMILY);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.setReversed(true);
  scan.addColumn(FAMILY,QUALIFIER);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  Put put=new Put(ROWS[2]);
  put.addColumn(FAMILY,QUALIFIER,VALUE);
  ht.put(put);
  scan=new Scan();
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan(ROWS[3],ROWS[0]);
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan(ROWS[2],ROWS[1]);
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan(ROWS[1]);
  scan.setReversed(true);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  ht.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullWithReverseScan() throws Exception {
  TableName TABLE=TableName.valueOf("testNullWithReverseScan");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,null,VALUE);
  ht.put(put);
  scanTestNull(ht,ROW,FAMILY,VALUE,true);
  Delete delete=new Delete(ROW);
  delete.addColumns(FAMILY,null);
  ht.delete(delete);
  byte[] TABLE2=Bytes.toBytes("testNull2WithReverseScan");
  ht=TEST_UTIL.createTable(TableName.valueOf(TABLE2),FAMILY);
  put=new Put(ROW);
  put.addColumn(FAMILY,HConstants.EMPTY_BYTE_ARRAY,VALUE);
  ht.put(put);
  scanTestNull(ht,ROW,FAMILY,VALUE,true);
  TEST_UTIL.flush();
  scanTestNull(ht,ROW,FAMILY,VALUE,true);
  delete=new Delete(ROW);
  delete.addColumns(FAMILY,HConstants.EMPTY_BYTE_ARRAY);
  ht.delete(delete);
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,null);
  ht.put(put);
  Scan scan=new Scan();
  scan.setReversed(true);
  scan.addColumn(FAMILY,QUALIFIER);
  Result result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROW,FAMILY,QUALIFIER,null);
  ht.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-52
 * Add a means of scanning over all versions
 */
@Test public void testJiraTest52() throws Exception {
  TableName TABLE=TableName.valueOf("testJiraTest52");
  byte[][] VALUES=makeNAscii(VALUE,7);
  long[] STAMPS=makeStamps(7);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  ht.put(put);
  getAllVersionsAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanAllVersionsAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  TEST_UTIL.flush();
  getAllVersionsAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanAllVersionsAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateVersions() throws Exception {
  TableName TABLE=TableName.valueOf("testDuplicateVersions");
  long[] STAMPS=makeStamps(20);
  byte[][] VALUES=makeNAscii(VALUE,20);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  ht.put(put);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(2);
  Result result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  Scan scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(2);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  TEST_UTIL.flush();
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(2);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(2);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[14]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[6],VALUES[6]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[8],VALUES[8]);
  ht.put(put);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(7);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,6);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(7);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,6);
  get=new Get(ROW);
  get.setMaxVersions(7);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,6);
  scan=new Scan(ROW);
  scan.setMaxVersions(7);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,6);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[14]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[14]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[9]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[9]);
  TEST_UTIL.flush();
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[9],VALUES[9]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[11],VALUES[11]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[13],VALUES[13]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[15],VALUES[15]);
  ht.put(put);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8],STAMPS[9],STAMPS[11],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8],VALUES[9],VALUES[11],VALUES[13],VALUES[15]},0,9);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8],STAMPS[9],STAMPS[11],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[7],VALUES[8],VALUES[9],VALUES[11],VALUES[13],VALUES[15]},0,9);
  Delete delete=new Delete(ROW);
  delete.addColumn(FAMILY,QUALIFIER,STAMPS[11]);
  delete.addColumn(FAMILY,QUALIFIER,STAMPS[7]);
  ht.delete(delete);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[8],STAMPS[9],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[8],VALUES[9],VALUES[13],VALUES[15]},0,9);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[8],STAMPS[9],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[14],VALUES[5],VALUES[6],VALUES[8],VALUES[9],VALUES[13],VALUES[15]},0,9);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVersions() throws Exception {
  TableName TABLE=TableName.valueOf("testVersions");
  long[] STAMPS=makeStamps(20);
  byte[][] VALUES=makeNAscii(VALUE,20);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  ht.put(put);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  Get get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(2);
  Result result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  Scan scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(2);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  TEST_UTIL.flush();
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[3]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[6]);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(2);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(2);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[4],STAMPS[5]},new byte[][]{VALUES[4],VALUES[5]},0,1);
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[6],VALUES[6]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[8],VALUES[8]);
  ht.put(put);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions();
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,7);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions();
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,7);
  get=new Get(ROW);
  get.setMaxVersions();
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,7);
  scan=new Scan(ROW);
  scan.setMaxVersions();
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8]},0,7);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  scanVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,STAMPS[7],VALUES[7]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[9]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[0]);
  scanVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,STAMPS[9]);
  TEST_UTIL.flush();
  put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[9],VALUES[9]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[11],VALUES[11]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[13],VALUES[13]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[15],VALUES[15]);
  ht.put(put);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8],STAMPS[9],STAMPS[11],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8],VALUES[9],VALUES[11],VALUES[13],VALUES[15]},0,9);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[7],STAMPS[8],STAMPS[9],STAMPS[11],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[7],VALUES[8],VALUES[9],VALUES[11],VALUES[13],VALUES[15]},0,9);
  Delete delete=new Delete(ROW);
  delete.addColumn(FAMILY,QUALIFIER,STAMPS[11]);
  delete.addColumn(FAMILY,QUALIFIER,STAMPS[7]);
  ht.delete(delete);
  get=new Get(ROW);
  get.addColumn(FAMILY,QUALIFIER);
  get.setMaxVersions(Integer.MAX_VALUE);
  result=ht.get(get);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[8],STAMPS[9],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[8],VALUES[9],VALUES[13],VALUES[15]},0,9);
  scan=new Scan(ROW);
  scan.addColumn(FAMILY,QUALIFIER);
  scan.setMaxVersions(Integer.MAX_VALUE);
  result=getSingleScanResult(ht,scan);
  assertNResult(result,ROW,FAMILY,QUALIFIER,new long[]{STAMPS[1],STAMPS[2],STAMPS[3],STAMPS[4],STAMPS[5],STAMPS[6],STAMPS[8],STAMPS[9],STAMPS[13],STAMPS[15]},new byte[][]{VALUES[1],VALUES[2],VALUES[3],VALUES[4],VALUES[5],VALUES[6],VALUES[8],VALUES[9],VALUES[13],VALUES[15]},0,9);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-1014
 * commit(BatchUpdate) method should return timestamp
 */
@Test public void testJiraTest1014() throws Exception {
  TableName TABLE=TableName.valueOf("testJiraTest1014");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  long manualStamp=12345;
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,manualStamp,VALUE);
  ht.put(put);
  getVersionAndVerify(ht,ROW,FAMILY,QUALIFIER,manualStamp,VALUE);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,manualStamp - 1);
  getVersionAndVerifyMissing(ht,ROW,FAMILY,QUALIFIER,manualStamp + 1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-1182
 * Scan for columns > some timestamp
 */
@Test public void testJiraTest1182() throws Exception {
  TableName TABLE=TableName.valueOf("testJiraTest1182");
  byte[][] VALUES=makeNAscii(VALUE,7);
  long[] STAMPS=makeStamps(7);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,10);
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[0],VALUES[0]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[1],VALUES[1]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[2],VALUES[2]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[3],VALUES[3]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[4],VALUES[4]);
  put.addColumn(FAMILY,QUALIFIER,STAMPS[5],VALUES[5]);
  ht.put(put);
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,5);
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  TEST_UTIL.flush();
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,5);
  getVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,0,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,2,5);
  scanVersionRangeAndVerifyGreaterThan(ht,ROW,FAMILY,QUALIFIER,STAMPS,VALUES,4,5);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteFamilyVersion() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  TableName TABLE=TableName.valueOf("testDeleteFamilyVersion");
  byte[][] QUALIFIERS=makeNAscii(QUALIFIER,1);
  byte[][] VALUES=makeN(VALUE,5);
  long[] ts={1000,2000,3000,4000,5000};
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY,5);
  Put put=new Put(ROW);
  for (int q=0; q < 1; q++)   for (int t=0; t < 5; t++)   put.addColumn(FAMILY,QUALIFIERS[q],ts[t],VALUES[t]);
  ht.put(put);
  admin.flush(TABLE);
  Delete delete=new Delete(ROW);
  delete.addFamilyVersion(FAMILY,ts[1]);
  delete.addFamilyVersion(FAMILY,ts[3]);
  ht.delete(delete);
  admin.flush(TABLE);
  for (int i=0; i < 1; i++) {
    Get get=new Get(ROW);
    get.addColumn(FAMILY,QUALIFIERS[i]);
    get.setMaxVersions(Integer.MAX_VALUE);
    Result result=ht.get(get);
    assertNResult(result,ROW,FAMILY,QUALIFIERS[i],new long[]{ts[0],ts[2],ts[4]},new byte[][]{VALUES[0],VALUES[2],VALUES[4]},0,2);
  }
  ht.close();
  admin.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test simple table and non-existent row cases.
 */
@Test public void testSimpleMissing() throws Exception {
  TableName TABLE=TableName.valueOf("testSimpleMissing");
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  byte[][] ROWS=makeN(ROW,4);
  Get get=new Get(ROWS[0]);
  Result result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILY);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILY,QUALIFIER);
  result=ht.get(get);
  assertEmptyResult(result);
  Scan scan=new Scan();
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan(ROWS[0]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan(ROWS[0],ROWS[1]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addFamily(FAMILY);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addColumn(FAMILY,QUALIFIER);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  Put put=new Put(ROWS[2]);
  put.addColumn(FAMILY,QUALIFIER,VALUE);
  ht.put(put);
  get=new Get(ROWS[1]);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILY);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[3]);
  get.addColumn(FAMILY,QUALIFIER);
  result=ht.get(get);
  assertEmptyResult(result);
  scan=new Scan(ROWS[3]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan(ROWS[0],ROWS[2]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  get=new Get(ROWS[2]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  get=new Get(ROWS[2]);
  get.addFamily(FAMILY);
  result=ht.get(get);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  get=new Get(ROWS[2]);
  get.addColumn(FAMILY,QUALIFIER);
  result=ht.get(get);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan();
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan(ROWS[0],ROWS[3]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
  scan=new Scan(ROWS[2],ROWS[3]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[2],FAMILY,QUALIFIER,VALUE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test basic puts, gets, scans, and deletes for a single row
 * in a multiple family table.
 */
@Test public void testSingleRowMultipleFamily() throws Exception {
  TableName TABLE=TableName.valueOf("testSingleRowMultipleFamily");
  byte[][] ROWS=makeN(ROW,3);
  byte[][] FAMILIES=makeNAscii(FAMILY,10);
  byte[][] QUALIFIERS=makeN(QUALIFIER,10);
  byte[][] VALUES=makeN(VALUE,10);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES);
  Get get;
  Scan scan;
  Delete delete;
  Put put;
  Result result;
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[4],QUALIFIERS[0],VALUES[0]);
  ht.put(put);
  getVerifySingleColumn(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0,VALUES,0);
  scanVerifySingleColumn(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0,VALUES,0);
  getVerifySingleEmpty(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0);
  scanVerifySingleEmpty(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0);
  TEST_UTIL.flush();
  getVerifySingleColumn(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0,VALUES,0);
  scanVerifySingleColumn(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0,VALUES,0);
  getVerifySingleEmpty(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0);
  scanVerifySingleEmpty(ht,ROWS,0,FAMILIES,4,QUALIFIERS,0);
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[2],QUALIFIERS[2],VALUES[2]);
  put.addColumn(FAMILIES[2],QUALIFIERS[4],VALUES[4]);
  put.addColumn(FAMILIES[4],QUALIFIERS[4],VALUES[4]);
  put.addColumn(FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  put.addColumn(FAMILIES[6],QUALIFIERS[7],VALUES[7]);
  put.addColumn(FAMILIES[7],QUALIFIERS[7],VALUES[7]);
  put.addColumn(FAMILIES[9],QUALIFIERS[0],VALUES[0]);
  ht.put(put);
  singleRowGetTest(ht,ROWS,FAMILIES,QUALIFIERS,VALUES);
  singleRowScanTest(ht,ROWS,FAMILIES,QUALIFIERS,VALUES);
  TEST_UTIL.flush();
  singleRowGetTest(ht,ROWS,FAMILIES,QUALIFIERS,VALUES);
  singleRowScanTest(ht,ROWS,FAMILIES,QUALIFIERS,VALUES);
  put=new Put(ROWS[0]);
  put.addColumn(FAMILIES[6],QUALIFIERS[5],VALUES[5]);
  put.addColumn(FAMILIES[6],QUALIFIERS[8],VALUES[8]);
  put.addColumn(FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  put.addColumn(FAMILIES[4],QUALIFIERS[3],VALUES[3]);
  ht.put(put);
  delete=new Delete(ROWS[0]);
  delete.addColumns(FAMILIES[6],QUALIFIERS[7]);
  ht.delete(delete);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[7]);
  result=ht.get(get);
  assertEmptyResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[7]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[8]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[8],VALUES[8]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[8]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[8],VALUES[8]);
  delete=new Delete(ROWS[0]);
  delete.addColumns(FAMILIES[6],QUALIFIERS[8]);
  ht.delete(delete);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[8]);
  result=ht.get(get);
  assertEmptyResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[8]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  delete=new Delete(ROWS[0]);
  delete.addFamily(FAMILIES[4]);
  ht.delete(delete);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[4],QUALIFIERS[4]);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[4],QUALIFIERS[3]);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILIES[4]);
  result=ht.get(get);
  assertEmptyResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[4],QUALIFIERS[4]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[4],QUALIFIERS[3]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addFamily(FAMILIES[4]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[2],QUALIFIERS[2]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[2],QUALIFIERS[2],VALUES[2]);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  TEST_UTIL.flush();
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[4],QUALIFIERS[4]);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[4],QUALIFIERS[3]);
  result=ht.get(get);
  assertEmptyResult(result);
  get=new Get(ROWS[0]);
  get.addFamily(FAMILIES[4]);
  result=ht.get(get);
  assertEmptyResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[4],QUALIFIERS[4]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addColumn(FAMILIES[4],QUALIFIERS[3]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  scan=new Scan();
  scan.addFamily(FAMILIES[4]);
  result=getSingleScanResult(ht,scan);
  assertNullResult(result);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[2],QUALIFIERS[2]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[2],QUALIFIERS[2],VALUES[2]);
  get=new Get(ROWS[0]);
  get.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=ht.get(get);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[6]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[6],VALUES[6]);
  scan=new Scan();
  scan.addColumn(FAMILIES[6],QUALIFIERS[9]);
  result=getSingleScanResult(ht,scan);
  assertSingleResult(result,ROWS[0],FAMILIES[6],QUALIFIERS[9],VALUES[9]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestHBaseAdminNoCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMasterOperationsRetries() throws Exception {
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.listTables();
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).getTableDescriptors((RpcController)Mockito.any(),(GetTableDescriptorsRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.listTableNames();
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).getTableNames((RpcController)Mockito.any(),(GetTableNamesRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.getTableDescriptor(TableName.valueOf("getTableDescriptor"));
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).getTableDescriptors((RpcController)Mockito.any(),(GetTableDescriptorsRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.getTableDescriptorsByTableName(new ArrayList<TableName>());
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).getTableDescriptors((RpcController)Mockito.any(),(GetTableDescriptorsRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.move(new byte[0],null);
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).moveRegion((RpcController)Mockito.any(),(MoveRegionRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.offline(new byte[0]);
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).offlineRegion((RpcController)Mockito.any(),(OfflineRegionRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.setBalancerRunning(true,true);
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).setBalancerRunning((RpcController)Mockito.any(),(SetBalancerRunningRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.balancer();
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).balance((RpcController)Mockito.any(),(BalanceRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.enableCatalogJanitor(true);
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).enableCatalogJanitor((RpcController)Mockito.any(),(EnableCatalogJanitorRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.runCatalogScan();
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).runCatalogScan((RpcController)Mockito.any(),(RunCatalogScanRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.isCatalogJanitorEnabled();
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).isCatalogJanitorEnabled((RpcController)Mockito.any(),(IsCatalogJanitorEnabledRequest)Mockito.any());
    }
  }
);
  testMasterOperationIsRetried(new MethodCaller(){
    @Override public void call(    Admin admin) throws Exception {
      admin.mergeRegions(new byte[0],new byte[0],true);
    }
    @Override public void verify(    MasterKeepAliveConnection masterAdmin,    int count) throws Exception {
      Mockito.verify(masterAdmin,Mockito.atLeast(count)).dispatchMergingRegions((RpcController)Mockito.any(),(DispatchMergingRegionsRequest)Mockito.any());
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestHCM </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConnectionRideOverClusterRestart() throws IOException, InterruptedException {
  Configuration config=new Configuration(TEST_UTIL.getConfiguration());
  TableName tableName=TableName.valueOf("testConnectionRideOverClusterRestart");
  TEST_UTIL.createTable(tableName,new byte[][]{FAM_NAM}).close();
  Connection connection=ConnectionFactory.createConnection(config);
  Table table=connection.getTable(tableName);
  table.get(new Get(Bytes.toBytes("foo")));
  TEST_UTIL.shutdownMiniHBaseCluster();
  TEST_UTIL.restartHBaseCluster(2);
  table.get(new Get(Bytes.toBytes("foo")));
  TEST_UTIL.deleteTable(tableName);
  table.close();
  connection.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that connection can become idle without breaking everything.
 */
@Test public void testConnectionIdle() throws Exception {
  TableName tableName=TableName.valueOf("HCM-testConnectionIdle");
  TEST_UTIL.createTable(tableName,FAM_NAM).close();
  int idleTime=20000;
  boolean previousBalance=TEST_UTIL.getHBaseAdmin().setBalancerRunning(false,true);
  Configuration c2=new Configuration(TEST_UTIL.getConfiguration());
  c2.set(HConstants.HBASE_CLIENT_INSTANCE_ID,String.valueOf(-1));
  c2.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,1);
  c2.setInt(RpcClient.IDLE_TIME,idleTime);
  Connection connection=ConnectionFactory.createConnection(c2);
  final Table table=connection.getTable(tableName);
  Put put=new Put(ROW);
  put.addColumn(FAM_NAM,ROW,ROW);
  table.put(put);
  ManualEnvironmentEdge mee=new ManualEnvironmentEdge();
  mee.setValue(System.currentTimeMillis());
  EnvironmentEdgeManager.injectEdge(mee);
  LOG.info("first get");
  table.get(new Get(ROW));
  LOG.info("first get - changing the time & sleeping");
  mee.incValue(idleTime + 1000);
  Thread.sleep(1500);
  LOG.info("second get - connection has been marked idle in the middle");
  table.get(new Get(ROW));
  mee.incValue(idleTime + 1000);
  LOG.info("third get - connection is idle, but the reader doesn't know yet");
  table.get(new Get(ROW));
  LOG.info("we're done - time will change back");
  table.close();
  connection.close();
  EnvironmentEdgeManager.reset();
  TEST_UTIL.getHBaseAdmin().setBalancerRunning(previousBalance,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can handle connection close: it will trigger a retry, but the calls will
 * finish.
 */
@Test public void testConnectionCloseAllowsInterrupt() throws Exception {
  testConnectionClose(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConnectionNotAllowsInterrupt() throws Exception {
  testConnectionClose(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestIntraRowPagination </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test from client side for scan with maxResultPerCF set
 * @throws Exception
 */
@Test public void testScanLimitAndOffset() throws Exception {
  byte[][] ROWS=HTestConst.makeNAscii(HTestConst.DEFAULT_ROW_BYTES,2);
  byte[][] FAMILIES=HTestConst.makeNAscii(HTestConst.DEFAULT_CF_BYTES,3);
  byte[][] QUALIFIERS=HTestConst.makeNAscii(HTestConst.DEFAULT_QUALIFIER_BYTES,10);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(HTestConst.DEFAULT_TABLE_BYTES));
  HRegionInfo info=new HRegionInfo(HTestConst.DEFAULT_TABLE,null,null,false);
  for (  byte[] family : FAMILIES) {
    HColumnDescriptor hcd=new HColumnDescriptor(family);
    htd.addFamily(hcd);
  }
  HRegion region=HBaseTestingUtility.createRegionAndWAL(info,TEST_UTIL.getDataTestDir(),TEST_UTIL.getConfiguration(),htd);
  try {
    Put put;
    Scan scan;
    Result result;
    boolean toLog=true;
    List<Cell> kvListExp=new ArrayList<Cell>();
    int storeOffset=1;
    int storeLimit=3;
    for (int r=0; r < ROWS.length; r++) {
      put=new Put(ROWS[r]);
      for (int c=0; c < FAMILIES.length; c++) {
        for (int q=0; q < QUALIFIERS.length; q++) {
          KeyValue kv=new KeyValue(ROWS[r],FAMILIES[c],QUALIFIERS[q],1,HTestConst.DEFAULT_VALUE_BYTES);
          put.add(kv);
          if (storeOffset <= q && q < storeOffset + storeLimit) {
            kvListExp.add(kv);
          }
        }
      }
      region.put(put);
    }
    scan=new Scan();
    scan.setRowOffsetPerColumnFamily(storeOffset);
    scan.setMaxResultsPerColumnFamily(storeLimit);
    RegionScanner scanner=region.getScanner(scan);
    List<Cell> kvListScan=new ArrayList<Cell>();
    List<Cell> results=new ArrayList<Cell>();
    while (scanner.next(results) || !results.isEmpty()) {
      kvListScan.addAll(results);
      results.clear();
    }
    result=Result.create(kvListScan);
    TestScannersFromClientSide.verifyResult(result,kvListExp,toLog,"Testing scan with storeOffset and storeLimit");
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMetaWithReplicas </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChangingReplicaCount() throws Exception {
  stopMasterAndValidateReplicaCount(3,2);
  stopMasterAndValidateReplicaCount(2,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHBaseFsckWithFewerMetaReplicaZnodes() throws Exception {
  ClusterConnection c=(ClusterConnection)ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
  RegionLocations rl=c.locateRegion(TableName.META_TABLE_NAME,HConstants.EMPTY_START_ROW,false,false);
  HBaseFsckRepair.closeRegionSilentlyAndWait(c,rl.getRegionLocation(2).getServerName(),rl.getRegionLocation(2).getRegionInfo());
  ZooKeeperWatcher zkw=TEST_UTIL.getZooKeeperWatcher();
  ZKUtil.deleteNode(zkw,zkw.getZNodeForReplica(2));
  HBaseFsck hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.UNKNOWN,ERROR_CODE.NO_META_REGION});
  hbck=doFsck(TEST_UTIL.getConfiguration(),true);
  hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHBaseFsckWithMetaReplicas() throws Exception {
  HBaseFsck hbck=HbckTestingUtil.doFsck(TEST_UTIL.getConfiguration(),false);
  HbckTestingUtil.assertNoErrors(hbck);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHBaseFsckWithFewerMetaReplicas() throws Exception {
  ClusterConnection c=(ClusterConnection)ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
  RegionLocations rl=c.locateRegion(TableName.META_TABLE_NAME,HConstants.EMPTY_START_ROW,false,false);
  HBaseFsckRepair.closeRegionSilentlyAndWait(c,rl.getRegionLocation(1).getServerName(),rl.getRegionLocation(1).getRegionInfo());
  HBaseFsck hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.UNKNOWN,ERROR_CODE.NO_META_REGION});
  hbck=doFsck(TEST_UTIL.getConfiguration(),true);
  hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHBaseFsckWithExcessMetaReplicas() throws Exception {
  HRegionInfo h=RegionReplicaUtil.getRegionInfoForReplica(HRegionInfo.FIRST_META_REGIONINFO,3);
  TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().createRegionState(h);
  TEST_UTIL.getMiniHBaseCluster().getMaster().assignRegion(h);
  HBaseFsckRepair.waitUntilAssigned(TEST_UTIL.getHBaseAdmin(),h);
  HBaseFsck hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{ERROR_CODE.UNKNOWN,ERROR_CODE.SHOULD_NOT_BE_DEPLOYED});
  hbck=doFsck(TEST_UTIL.getConfiguration(),true);
  hbck=doFsck(TEST_UTIL.getConfiguration(),false);
  assertErrors(hbck,new ERROR_CODE[]{});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaLookupThreadPoolCreated() throws Exception {
  TableName TABLE=TableName.valueOf("testMetaLookupThreadPoolCreated");
  byte[][] FAMILIES=new byte[][]{Bytes.toBytes("foo")};
  if (TEST_UTIL.getHBaseAdmin().tableExists(TABLE)) {
    TEST_UTIL.getHBaseAdmin().disableTable(TABLE);
    TEST_UTIL.getHBaseAdmin().deleteTable(TABLE);
  }
  try (Table htable=TEST_UTIL.createTable(TABLE,FAMILIES)){
    byte[] row="test".getBytes();
    ConnectionImplementation c=((ConnectionImplementation)TEST_UTIL.getConnection());
    c.relocateRegion(TABLE,row);
    ExecutorService ex=c.getCurrentMetaLookupPool();
    assert (ex != null);
  }
 }

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShutdownHandling() throws Exception {
  shutdownMetaAndDoValidations(TEST_UTIL);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMultiParallel </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testBatchWithPut() throws Exception {
  LOG.info("test=testBatchWithPut");
  Table table=CONNECTION.getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  Object[] results=new Object[puts.size()];
  table.batch(puts,results);
  validateSizeAndEmpty(results,KEYS.length);
  if (true) {
    int liveRScount=UTIL.getMiniHBaseCluster().getLiveRegionServerThreads().size();
    assert liveRScount > 0;
    JVMClusterUtil.RegionServerThread liveRS=UTIL.getMiniHBaseCluster().getLiveRegionServerThreads().get(0);
    liveRS.getRegionServer().abort("Aborting for tests",new Exception("testBatchWithPut"));
    puts=constructPutRequests();
    try {
      results=new Object[puts.size()];
      table.batch(puts,results);
    }
 catch (    RetriesExhaustedWithDetailsException ree) {
      LOG.info(ree.getExhaustiveDescription());
      table.close();
      throw ree;
    }
    validateSizeAndEmpty(results,KEYS.length);
  }
  validateLoadedData(table);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testFlushCommitsNoAbort() throws Exception {
  LOG.info("test=testFlushCommitsNoAbort");
  doTestFlushCommits(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testBatchWithManyColsInOneRowGetAndPut() throws Exception {
  LOG.info("test=testBatchWithManyColsInOneRowGetAndPut");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Row> puts=new ArrayList<Row>();
  for (int i=0; i < 100; i++) {
    Put put=new Put(ONE_ROW);
    byte[] qual=Bytes.toBytes("column" + i);
    put.addColumn(BYTES_FAMILY,qual,VALUE);
    puts.add(put);
  }
  Object[] results=new Object[puts.size()];
  table.batch(puts,results);
  validateSizeAndEmpty(results,100);
  List<Row> gets=new ArrayList<Row>();
  for (int i=0; i < 100; i++) {
    Get get=new Get(ONE_ROW);
    byte[] qual=Bytes.toBytes("column" + i);
    get.addColumn(BYTES_FAMILY,qual);
    gets.add(get);
  }
  Object[] multiRes=new Object[gets.size()];
  table.batch(gets,multiRes);
  int idx=0;
  for (  Object r : multiRes) {
    byte[] qual=Bytes.toBytes("column" + idx);
    validateResult(r,qual,VALUE);
    idx++;
  }
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testBatchWithMixedActions() throws Exception {
  LOG.info("test=testBatchWithMixedActions");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  Object[] results=new Object[puts.size()];
  table.batch(puts,results);
  validateSizeAndEmpty(results,KEYS.length);
  List<Row> actions=new ArrayList<Row>();
  byte[] qual2=Bytes.toBytes("qual2");
  byte[] val2=Bytes.toBytes("putvalue2");
  Get get=new Get(KEYS[10]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  get=new Get(KEYS[11]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  Put put=new Put(KEYS[10]);
  put.addColumn(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  Delete delete=new Delete(KEYS[20]);
  delete.addFamily(BYTES_FAMILY);
  actions.add(delete);
  get=new Get(KEYS[30]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  put=new Put(KEYS[40]);
  put.addColumn(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  results=new Object[actions.size()];
  table.batch(actions,results);
  validateResult(results[0]);
  validateResult(results[1]);
  validateEmpty(results[2]);
  validateEmpty(results[3]);
  validateResult(results[4]);
  validateEmpty(results[5]);
  get=new Get(KEYS[40]);
  get.addColumn(BYTES_FAMILY,qual2);
  Result r=table.get(get);
  validateResult(r,qual2,val2);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testBatchWithIncrementAndAppend() throws Exception {
  LOG.info("test=testBatchWithIncrementAndAppend");
  final byte[] QUAL1=Bytes.toBytes("qual1");
  final byte[] QUAL2=Bytes.toBytes("qual2");
  final byte[] QUAL3=Bytes.toBytes("qual3");
  final byte[] QUAL4=Bytes.toBytes("qual4");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  Delete d=new Delete(ONE_ROW);
  table.delete(d);
  Put put=new Put(ONE_ROW);
  put.addColumn(BYTES_FAMILY,QUAL1,Bytes.toBytes("abc"));
  put.addColumn(BYTES_FAMILY,QUAL2,Bytes.toBytes(1L));
  table.put(put);
  Increment inc=new Increment(ONE_ROW);
  inc.addColumn(BYTES_FAMILY,QUAL2,1);
  inc.addColumn(BYTES_FAMILY,QUAL3,1);
  Append a=new Append(ONE_ROW);
  a.add(BYTES_FAMILY,QUAL1,Bytes.toBytes("def"));
  a.add(BYTES_FAMILY,QUAL4,Bytes.toBytes("xyz"));
  List<Row> actions=new ArrayList<Row>();
  actions.add(inc);
  actions.add(a);
  Object[] multiRes=new Object[actions.size()];
  table.batch(actions,multiRes);
  validateResult(multiRes[1],QUAL1,Bytes.toBytes("abcdef"));
  validateResult(multiRes[1],QUAL4,Bytes.toBytes("xyz"));
  validateResult(multiRes[0],QUAL2,Bytes.toBytes(2L));
  validateResult(multiRes[0],QUAL3,Bytes.toBytes(1L));
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Only run one Multi test with a forced RegionServer abort. Otherwise, the
 * unit tests will take an unnecessarily long time to run.
 * @throws Exception
 */
@Test(timeout=360000) public void testFlushCommitsWithAbort() throws Exception {
  LOG.info("test=testFlushCommitsWithAbort");
  doTestFlushCommits(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestMultipleTimestamps </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithVersionDeletes() throws Exception {
  testWithVersionDeletes(false);
  testWithVersionDeletes(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestOperation </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings("rawtypes") public void testOperationSubClassMethodsAreBuilderStyle(){
  Class[] classes=new Class[]{Operation.class,OperationWithAttributes.class,Mutation.class,Query.class,Delete.class,Increment.class,Append.class,Put.class,Get.class,Scan.class};
  BuilderStyleTest.assertClassesAreBuilderStyle(classes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestReplicasClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlushTable() throws Exception {
  openRegion(hriSecondary);
  try {
    flushRegion(hriPrimary);
    flushRegion(hriSecondary);
    Put p=new Put(row);
    p.addColumn(f,row,row);
    table.put(p);
    flushRegion(hriPrimary);
    flushRegion(hriSecondary);
  }
  finally {
    Delete d=new Delete(row);
    table.delete(d);
    closeRegion(hriSecondary);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSmallScanWithReplicas() throws Exception {
  runMultipleScansOfOneType(false,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanWithReplicas() throws Exception {
  runMultipleScansOfOneType(false,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlushSecondary() throws Exception {
  openRegion(hriSecondary);
  try {
    flushRegion(hriSecondary);
    Put p=new Put(row);
    p.addColumn(f,row,row);
    table.put(p);
    flushRegion(hriSecondary);
  }
 catch (  TableNotFoundException expected) {
  }
 finally {
    Delete d=new Delete(row);
    table.delete(d);
    closeRegion(hriSecondary);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlushPrimary() throws Exception {
  openRegion(hriSecondary);
  try {
    flushRegion(hriPrimary);
    Put p=new Put(row);
    p.addColumn(f,row,row);
    table.put(p);
    flushRegion(hriPrimary);
  }
  finally {
    Delete d=new Delete(row);
    table.delete(d);
    closeRegion(hriSecondary);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReverseScanWithReplicas() throws Exception {
  runMultipleScansOfOneType(true,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestRestoreSnapshotFromClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCloneSnapshotOfCloned() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("clonedtb-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName0,clonedTableName);
  verifyRowCount(TEST_UTIL,clonedTableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(clonedTableName,admin,getNumReplicas());
  admin.disableTable(clonedTableName);
  admin.snapshot(snapshotName2,clonedTableName);
  TEST_UTIL.deleteTable(clonedTableName);
  waitCleanerRun();
  admin.cloneSnapshot(snapshotName2,clonedTableName);
  verifyRowCount(TEST_UTIL,clonedTableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(clonedTableName,admin,getNumReplicas());
  TEST_UTIL.deleteTable(clonedTableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCloneAndRestoreSnapshot() throws IOException, InterruptedException {
  TEST_UTIL.deleteTable(tableName);
  waitCleanerRun();
  admin.cloneSnapshot(snapshotName0,tableName);
  verifyRowCount(TEST_UTIL,tableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  waitCleanerRun();
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName0);
  admin.enableTable(tableName);
  verifyRowCount(TEST_UTIL,tableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestoreSnapshot() throws IOException {
  verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  admin.disableTable(tableName);
  admin.snapshot(snapshotName1,tableName);
  admin.restoreSnapshot(snapshotName0);
  admin.enableTable(tableName);
  verifyRowCount(TEST_UTIL,tableName,snapshot0Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  admin.disableTable(tableName);
  admin.restoreSnapshot(emptySnapshot);
  admin.enableTable(tableName);
  verifyRowCount(TEST_UTIL,tableName,0);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName1);
  admin.enableTable(tableName);
  verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
  TEST_UTIL.deleteTable(tableName);
  admin.restoreSnapshot(snapshotName1);
  verifyRowCount(TEST_UTIL,tableName,snapshot1Rows);
  SnapshotTestingUtils.verifyReplicasCameOnline(tableName,admin,getNumReplicas());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestRpcControllerFactory </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * check some of the methods and make sure we are incrementing each time. Its a bit tediuous to
 * cover all methods here and really is a bit brittle since we can always add new methods but
 * won't be sure to add them here. So we just can cover the major ones.
 * @throws Exception on failure
 */
@Test public void testCountController() throws Exception {
  Configuration conf=new Configuration(UTIL.getConfiguration());
  conf.set(RpcControllerFactory.CUSTOM_CONTROLLER_CONF_KEY,StaticRpcControllerFactory.class.getName());
  TableName name=TableName.valueOf("testcustomcontroller");
  UTIL.createTable(name,fam1).close();
  conf.setInt(HConstants.HBASE_RPC_TIMEOUT_KEY,HConstants.DEFAULT_HBASE_RPC_TIMEOUT + 1);
  Connection connection=ConnectionFactory.createConnection(conf);
  Table table=connection.getTable(name);
  byte[] row=Bytes.toBytes("row");
  Put p=new Put(row);
  p.addColumn(fam1,fam1,Bytes.toBytes("val0"));
  table.put(p);
  Integer counter=1;
  counter=verifyCount(counter);
  Delete d=new Delete(row);
  d.addColumn(fam1,fam1);
  table.delete(d);
  counter=verifyCount(counter);
  Put p2=new Put(row);
  p2.addColumn(fam1,Bytes.toBytes("qual"),Bytes.toBytes("val1"));
  table.batch(Lists.newArrayList(p,p2),null);
  counter=verifyCount(counter);
  Append append=new Append(row);
  append.add(fam1,fam1,Bytes.toBytes("val2"));
  table.append(append);
  counter=verifyCount(counter);
  Get g=new Get(row);
  table.get(g);
  counter=verifyCount(counter);
  ResultScanner scan=table.getScanner(fam1);
  scan.next();
  scan.close();
  counter=verifyCount(counter);
  Get g2=new Get(row);
  table.get(Lists.newArrayList(g,g2));
  counter=verifyCount(counter);
  Scan scanInfo=new Scan(row);
  scanInfo.setSmall(true);
  counter=doScan(table,scanInfo,counter);
  scanInfo.setReversed(true);
  counter=doScan(table,scanInfo,counter);
  scanInfo.setSmall(false);
  counter=doScan(table,scanInfo,counter);
  table.close();
  connection.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestScannersFromClientSide </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test from client side for get with rowOffset
 * @throws Exception
 */
@Test public void testGetRowOffset() throws Exception {
  TableName TABLE=TableName.valueOf("testGetRowOffset");
  byte[][] FAMILIES=HTestConst.makeNAscii(FAMILY,3);
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,20);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES);
  Get get;
  Put put;
  Result result;
  boolean toLog=true;
  List<Cell> kvListExp;
  kvListExp=new ArrayList<Cell>();
  put=new Put(ROW);
  for (int i=0; i < 10; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILIES[0],QUALIFIERS[i],1,VALUE);
    put.add(kv);
    if (i < 2)     continue;
    kvListExp.add(kv);
  }
  ht.put(put);
  get=new Get(ROW);
  get.setRowOffsetPerColumnFamily(2);
  result=ht.get(get);
  verifyResult(result,kvListExp,toLog,"Testing basic setRowOffset");
  get=new Get(ROW);
  get.setRowOffsetPerColumnFamily(20);
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  verifyResult(result,kvListExp,toLog,"Testing offset > #kvs");
  get=new Get(ROW);
  get.setRowOffsetPerColumnFamily(4);
  get.setMaxResultsPerColumnFamily(5);
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  for (int i=4; i < 9; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[i],1,VALUE));
  }
  verifyResult(result,kvListExp,toLog,"Testing offset + setMaxResultsPerCF");
  get=new Get(ROW);
  get.setRowOffsetPerColumnFamily(1);
  get.setFilter(new ColumnRangeFilter(QUALIFIERS[2],true,QUALIFIERS[5],true));
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[3],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[4],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[5],1,VALUE));
  verifyResult(result,kvListExp,toLog,"Testing offset with CRF");
  for (int j=2; j > 0; j--) {
    put=new Put(ROW);
    for (int i=0; i < 10; i++) {
      KeyValue kv=new KeyValue(ROW,FAMILIES[j],QUALIFIERS[i],1,VALUE);
      put.add(kv);
    }
    ht.put(put);
  }
  get=new Get(ROW);
  get.setRowOffsetPerColumnFamily(4);
  get.setMaxResultsPerColumnFamily(2);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILIES[1],QUALIFIERS[4],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[1],QUALIFIERS[5],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[4],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[5],1,VALUE));
  verifyResult(result,kvListExp,toLog,"Testing offset + multiple CFs + maxResults");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test from client side for get with maxResultPerCF set
 * @throws Exception
 */
@Test public void testGetMaxResults() throws Exception {
  TableName TABLE=TableName.valueOf("testGetMaxResults");
  byte[][] FAMILIES=HTestConst.makeNAscii(FAMILY,3);
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,20);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES);
  Get get;
  Put put;
  Result result;
  boolean toLog=true;
  List<Cell> kvListExp;
  kvListExp=new ArrayList<Cell>();
  put=new Put(ROW);
  for (int i=0; i < 10; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILIES[0],QUALIFIERS[i],1,VALUE);
    put.add(kv);
    kvListExp.add(kv);
  }
  ht.put(put);
  get=new Get(ROW);
  result=ht.get(get);
  verifyResult(result,kvListExp,toLog,"Testing without setting maxResults");
  get=new Get(ROW);
  get.setMaxResultsPerColumnFamily(2);
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[0],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[1],1,VALUE));
  verifyResult(result,kvListExp,toLog,"Testing basic setMaxResults");
  get=new Get(ROW);
  get.setMaxResultsPerColumnFamily(5);
  get.setFilter(new ColumnRangeFilter(QUALIFIERS[2],true,QUALIFIERS[5],true));
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[2],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[3],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[4],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[5],1,VALUE));
  verifyResult(result,kvListExp,toLog,"Testing single CF with CRF");
  put=new Put(ROW);
  for (int i=0; i < QUALIFIERS.length; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILIES[2],QUALIFIERS[i],1,VALUE);
    put.add(kv);
  }
  ht.put(put);
  put=new Put(ROW);
  for (int i=0; i < 10; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILIES[1],QUALIFIERS[i],1,VALUE);
    put.add(kv);
  }
  ht.put(put);
  get=new Get(ROW);
  get.setMaxResultsPerColumnFamily(12);
  get.addFamily(FAMILIES[1]);
  get.addFamily(FAMILIES[2]);
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  for (int i=0; i < 10; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[1],QUALIFIERS[i],1,VALUE));
  }
  for (int i=0; i < 2; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[i],1,VALUE));
  }
  for (int i=10; i < 20; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[i],1,VALUE));
  }
  verifyResult(result,kvListExp,toLog,"Testing multiple CFs");
  get=new Get(ROW);
  get.setMaxResultsPerColumnFamily(3);
  get.setFilter(new ColumnRangeFilter(QUALIFIERS[2],true,null,true));
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  for (int i=2; i < 5; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[i],1,VALUE));
  }
  for (int i=2; i < 5; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[1],QUALIFIERS[i],1,VALUE));
  }
  for (int i=2; i < 5; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[i],1,VALUE));
  }
  verifyResult(result,kvListExp,toLog,"Testing multiple CFs + CRF");
  get=new Get(ROW);
  get.setMaxResultsPerColumnFamily(7);
  get.setFilter(new ColumnPrefixFilter(QUALIFIERS[1]));
  result=ht.get(get);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILIES[0],QUALIFIERS[1],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[1],QUALIFIERS[1],1,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[1],1,VALUE));
  for (int i=10; i < 16; i++) {
    kvListExp.add(new KeyValue(ROW,FAMILIES[2],QUALIFIERS[i],1,VALUE));
  }
  verifyResult(result,kvListExp,toLog,"Testing multiple CFs + PFF");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test from client side for scan with maxResultPerCF set
 * @throws Exception
 */
@Test public void testScanMaxResults() throws Exception {
  TableName TABLE=TableName.valueOf("testScanLimit");
  byte[][] ROWS=HTestConst.makeNAscii(ROW,2);
  byte[][] FAMILIES=HTestConst.makeNAscii(FAMILY,3);
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,10);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILIES);
  Put put;
  Scan scan;
  Result result;
  boolean toLog=true;
  List<Cell> kvListExp, kvListScan;
  kvListExp=new ArrayList<Cell>();
  for (int r=0; r < ROWS.length; r++) {
    put=new Put(ROWS[r]);
    for (int c=0; c < FAMILIES.length; c++) {
      for (int q=0; q < QUALIFIERS.length; q++) {
        KeyValue kv=new KeyValue(ROWS[r],FAMILIES[c],QUALIFIERS[q],1,VALUE);
        put.add(kv);
        if (q < 4) {
          kvListExp.add(kv);
        }
      }
    }
    ht.put(put);
  }
  scan=new Scan();
  scan.setMaxResultsPerColumnFamily(4);
  ResultScanner scanner=ht.getScanner(scan);
  kvListScan=new ArrayList<Cell>();
  while ((result=scanner.next()) != null) {
    for (    Cell kv : result.listCells()) {
      kvListScan.add(kv);
    }
  }
  result=Result.create(kvListScan);
  verifyResult(result,kvListExp,toLog,"Testing scan with maxResults");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSmallScan() throws Exception {
  TableName TABLE=TableName.valueOf("testSmallScan");
  int numRows=10;
  byte[][] ROWS=HTestConst.makeNAscii(ROW,numRows);
  int numQualifiers=10;
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,numQualifiers);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  Put put;
  List<Put> puts=new ArrayList<Put>();
  for (int row=0; row < ROWS.length; row++) {
    put=new Put(ROWS[row]);
    for (int qual=0; qual < QUALIFIERS.length; qual++) {
      KeyValue kv=new KeyValue(ROWS[row],FAMILY,QUALIFIERS[qual],VALUE);
      put.add(kv);
    }
    puts.add(put);
  }
  ht.put(puts);
  int expectedRows=numRows;
  int expectedCols=numRows * numQualifiers;
  testSmallScan(ht,true,expectedRows,expectedCols);
  testSmallScan(ht,false,expectedRows,expectedCols);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test from client side for batch of scan
 * @throws Exception
 */
@Test public void testScanBatch() throws Exception {
  TableName TABLE=TableName.valueOf("testScanBatch");
  byte[][] QUALIFIERS=HTestConst.makeNAscii(QUALIFIER,8);
  Table ht=TEST_UTIL.createTable(TABLE,FAMILY);
  Put put;
  Scan scan;
  Delete delete;
  Result result;
  ResultScanner scanner;
  boolean toLog=true;
  List<Cell> kvListExp;
  put=new Put(ROW);
  for (int i=0; i < QUALIFIERS.length; i++) {
    KeyValue kv=new KeyValue(ROW,FAMILY,QUALIFIERS[i],i,VALUE);
    put.add(kv);
  }
  ht.put(put);
  put=new Put(ROW);
  KeyValue kv=new KeyValue(ROW,FAMILY,QUALIFIERS[6],2,VALUE);
  put.add(kv);
  ht.put(put);
  delete=new Delete(ROW);
  delete.addFamily(FAMILY,3);
  ht.delete(delete);
  scan=new Scan(ROW);
  scan.setMaxVersions();
  scanner=ht.getScanner(scan);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[4],4,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[5],5,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[6],6,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[7],7,VALUE));
  result=scanner.next();
  verifyResult(result,kvListExp,toLog,"Testing first batch of scan");
  scan=new Scan(ROW);
  scan.setMaxVersions();
  scan.setBatch(2);
  scanner=ht.getScanner(scan);
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[4],4,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[5],5,VALUE));
  result=scanner.next();
  verifyResult(result,kvListExp,toLog,"Testing first batch of scan");
  kvListExp=new ArrayList<Cell>();
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[6],6,VALUE));
  kvListExp.add(new KeyValue(ROW,FAMILY,QUALIFIERS[7],7,VALUE));
  result=scanner.next();
  verifyResult(result,kvListExp,toLog,"Testing second batch of scan");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestShell </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRunShellTests() throws IOException {
  System.setProperty("shell.test.exclude","replication_admin_test.rb");
  jruby.runScriptlet(PathType.ABSOLUTE,"src/test/ruby/tests_runner.rb");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestSnapshotFromAdmin </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure that we validate the snapshot name and the table name before we pass anything across
 * the wire
 * @throws Exception on failure
 */
@Test public void testValidateSnapshotName() throws Exception {
  ConnectionImplementation mockConnection=Mockito.mock(ConnectionImplementation.class);
  Configuration conf=HBaseConfiguration.create();
  Mockito.when(mockConnection.getConfiguration()).thenReturn(conf);
  Admin admin=new HBaseAdmin(mockConnection);
  SnapshotDescription.Builder builder=SnapshotDescription.newBuilder();
  failSnapshotStart(admin,builder.setName(HConstants.SNAPSHOT_DIR_NAME).build());
  failSnapshotStart(admin,builder.setName("-snapshot").build());
  failSnapshotStart(admin,builder.setName("snapshot fails").build());
  failSnapshotStart(admin,builder.setName("snap$hot").build());
  failSnapshotStart(admin,builder.setName("snap:hot").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable(".table").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("-table").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("table fails").build());
  failSnapshotStart(admin,builder.setName("snapshot").setTable("tab%le").build());
  MasterKeepAliveConnection master=Mockito.mock(MasterKeepAliveConnection.class);
  Mockito.when(mockConnection.getKeepAliveMasterService()).thenReturn(master);
  SnapshotResponse response=SnapshotResponse.newBuilder().setExpectedTimeout(0).build();
  Mockito.when(master.snapshot((RpcController)Mockito.isNull(),Mockito.any(SnapshotRequest.class))).thenReturn(response);
  IsSnapshotDoneResponse doneResponse=IsSnapshotDoneResponse.newBuilder().setDone(true).build();
  Mockito.when(master.isSnapshotDone((RpcController)Mockito.isNull(),Mockito.any(IsSnapshotDoneRequest.class))).thenReturn(doneResponse);
  admin.snapshot(builder.setName("snapshot").setTable("table").build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestSnapshotFromClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test snapshotting a table that is offline
 * @throws Exception
 */
@Test(timeout=300000) public void testOfflineTableSnapshot() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  Table table=UTIL.getConnection().getTable(TABLE_NAME);
  UTIL.loadTable(table,TEST_FAM,false);
  LOG.debug("FS state before disable:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  admin.disableTable(TABLE_NAME);
  LOG.debug("FS state before snapshot:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  final String SNAPSHOT_NAME="offlineTableSnapshot";
  byte[] snapshot=Bytes.toBytes(SNAPSHOT_NAME);
  SnapshotDescription desc=SnapshotDescription.newBuilder().setType(SnapshotDescription.Type.DISABLED).setTable(STRING_TABLE_NAME).setName(SNAPSHOT_NAME).setVersion(SnapshotManifestV1.DESCRIPTOR_VERSION).build();
  admin.snapshot(desc);
  LOG.debug("Snapshot completed.");
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot,TABLE_NAME);
  FileSystem fs=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getFileSystem();
  Path rootDir=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getRootDir();
  LOG.debug("FS state after snapshot:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  SnapshotTestingUtils.confirmSnapshotValid(snapshots.get(0),TABLE_NAME,TEST_FAM,rootDir,admin,fs);
  admin.deleteSnapshot(snapshot);
  snapshots=admin.listSnapshots();
  SnapshotTestingUtils.assertNoSnapshots(admin);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testOfflineTableSnapshotWithEmptyRegions() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  LOG.debug("FS state before disable:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  admin.disableTable(TABLE_NAME);
  LOG.debug("FS state before snapshot:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  byte[] snapshot=Bytes.toBytes("testOfflineTableSnapshotWithEmptyRegions");
  admin.snapshot(snapshot,TABLE_NAME);
  LOG.debug("Snapshot completed.");
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot,TABLE_NAME);
  FileSystem fs=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getFileSystem();
  Path rootDir=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getRootDir();
  LOG.debug("FS state after snapshot:");
  FSUtils.logFileSystemState(UTIL.getTestFileSystem(),FSUtils.getRootDir(UTIL.getConfiguration()),LOG);
  List<byte[]> emptyCfs=Lists.newArrayList(TEST_FAM);
  List<byte[]> nonEmptyCfs=Lists.newArrayList();
  SnapshotTestingUtils.confirmSnapshotValid(snapshots.get(0),TABLE_NAME,nonEmptyCfs,emptyCfs,rootDir,admin,fs);
  admin.deleteSnapshot(snapshot);
  snapshots=admin.listSnapshots();
  SnapshotTestingUtils.assertNoSnapshots(admin);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestSnapshotMetadata </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that the describe for a restored table matches the describe for one the original.
 */
@Test(timeout=300000) public void testDescribeMatchesAfterRestore() throws Exception {
  runRestoreWithAdditionalMetadata(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that when the table is empty, making metadata changes after the restore does not affect
 * the restored table's original metadata
 * @throws Exception
 */
@Test(timeout=300000) public void testDescribeOnEmptyTableMatchesAfterMetadataChangeAndRestore() throws Exception {
  runRestoreWithAdditionalMetadata(true,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that if metadata changed after a snapshot was taken, that the old metadata replaces the
 * new metadata during a restore
 */
@Test(timeout=300000) public void testDescribeMatchesAfterMetadataChangeAndRestore() throws Exception {
  runRestoreWithAdditionalMetadata(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestTableSnapshotScanner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithSingleRegion() throws Exception {
  testScanner(UTIL,"testWithSingleRegion",1,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithOfflineHBaseMultiRegion() throws Exception {
  testScanner(UTIL,"testWithMultiRegion",20,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMultiRegion() throws Exception {
  testScanner(UTIL,"testWithMultiRegion",10,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestTimestampsFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test TimestampsFilter in the presence of version deletes.
 * @throws Exception
 */
@Test public void testWithVersionDeletes() throws Exception {
  testWithVersionDeletes(false);
  testWithVersionDeletes(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.TestUpdateConfiguration </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnlineConfigChange() throws IOException {
  LOG.debug("Starting the test");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  ServerName server=TEST_UTIL.getHBaseCluster().getRegionServer(0).getServerName();
  admin.updateConfiguration(server);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.client.replication.TestReplicationAdminWithClusters </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000,expected=TableNotFoundException.class) public void testDisableReplicationForNonExistingTable() throws Exception {
  adminExt.disableTableRep(TableName.valueOf("nonExistingTable"));
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000,expected=IllegalArgumentException.class) public void testEnableReplicationWhenTableNameAsNull() throws Exception {
  adminExt.enableTableRep(null);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000,expected=TableNotFoundException.class) public void testEnableReplicationForNonExistingTable() throws Exception {
  adminExt.enableTableRep(TableName.valueOf("nonExistingTable"));
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000,expected=IllegalArgumentException.class) public void testDisableReplicationWhenTableNameAsNull() throws Exception {
  adminExt.disableTableRep(null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.builder.TestTreeDepth </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleBranch(){
  List<String> inputs=Lists.newArrayList("a","aa","ab");
  testInternal(inputs,2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleNode(){
  List<String> inputs=Lists.newArrayList("a");
  testInternal(inputs,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRootAsNubPlusNub(){
  List<String> inputs=Lists.newArrayList("a","aa","aaa");
  testInternal(inputs,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRootAsNub(){
  List<String> inputs=Lists.newArrayList("a","aa");
  testInternal(inputs,2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyRootPlusNub(){
  List<String> inputs=Lists.newArrayList("a","aa","b");
  testInternal(inputs,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitDistantAncestor(){
  List<String> inputs=Lists.newArrayList("a","ac","acd","b");
  testInternal(inputs,4);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyRoot(){
  List<String> inputs=Lists.newArrayList("a","b");
  testInternal(inputs,2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.row.TestPrefixTreeSearcher </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomSeekIndividualAssertions() throws IOException {
  CellSearcher searcher=null;
  try {
    searcher=DecoderFactory.checkOut(block,true);
    rows.individualSearcherAssertions(searcher);
  }
  finally {
    DecoderFactory.checkIn(searcher);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.codec.prefixtree.row.TestRowEncoder </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndividualBlockMetaAssertions(){
  rows.individualBlockMetaAssertions(blockMetaReader);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.constraint.TestConstraints </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that if a constraint hasn't been set that there are no problems with
 * attempting to remove it.
 * @throws Throwableon failure.
 */
@Test public void testRemoveUnsetConstraint() throws Throwable {
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf("table"));
  Constraints.remove(desc);
  Constraints.remove(desc,AlsoWorks.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestClassLoading </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegionServerCoprocessorsReported() throws Exception {
  assertAllRegionServers(null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClassLoadingFromRelativeLibDirInJar() throws Exception {
  loadingClassFromLibDirInJar("lib/");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClassLoadingFromLibDirInJar() throws Exception {
  loadingClassFromLibDirInJar("/lib/");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestCoprocessorTableEndpoint </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCoprocessorTableEndpoint() throws Throwable {
  final TableName tableName=TableName.valueOf("testCoprocessorTableEndpoint");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(TEST_FAMILY));
  desc.addCoprocessor(org.apache.hadoop.hbase.coprocessor.ColumnAggregationEndpoint.class.getName());
  createTable(desc);
  verifyTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDynamicCoprocessorTableEndpoint() throws Throwable {
  final TableName tableName=TableName.valueOf("testDynamicCoprocessorTableEndpoint");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(TEST_FAMILY));
  createTable(desc);
  desc.addCoprocessor(org.apache.hadoop.hbase.coprocessor.ColumnAggregationEndpoint.class.getName());
  updateTable(desc);
  verifyTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestOpenTableInCoprocessor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCoprocessorCanCreateConnectionToRemoteTable() throws Throwable {
  runCoprocessorConnectionToRemoteTable(SendToOtherTableCoprocessor.class,completed);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCoprocessorCanCreateConnectionToRemoteTableWithCustomPool() throws Throwable {
  runCoprocessorConnectionToRemoteTable(CustomThreadPoolCoprocessor.class,completedWithPool);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionObserverBypass </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * do a single put that is bypassed by a RegionObserver
 * @throws Exception
 */
@Test public void testSimple() throws Exception {
  Table t=util.getConnection().getTable(tableName);
  Put p=new Put(row1);
  p.addColumn(test,dummy,dummy);
  t.put(p);
  checkRowAndDelete(t,row1,0);
  t.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test various multiput operations.
 * @throws Exception
 */
@Test public void testMulti() throws Exception {
  EnvironmentEdgeManagerTestHelper.injectEdge(new IncrementingEnvironmentEdge());
  Table t=util.getConnection().getTable(tableName);
  List<Put> puts=new ArrayList<Put>();
  Put p=new Put(row1);
  p.addColumn(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,1);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,0);
  puts.clear();
  p=new Put(row1);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,0);
  puts.clear();
  p=new Put(row1);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.addColumn(dummy,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,1);
  puts.clear();
  p=new Put(row1);
  p.addColumn(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.addColumn(dummy,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,1);
  checkRowAndDelete(t,row2,0);
  checkRowAndDelete(t,row3,1);
  puts.clear();
  p=new Put(row1);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  p=new Put(row2);
  p.addColumn(dummy,dummy,dummy);
  puts.add(p);
  p=new Put(row3);
  p.addColumn(test,dummy,dummy);
  puts.add(p);
  t.put(puts);
  checkRowAndDelete(t,row1,0);
  checkRowAndDelete(t,row2,1);
  checkRowAndDelete(t,row3,0);
  t.close();
  EnvironmentEdgeManager.reset();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionObserverInterface </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testCheckAndDeleteHooks() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testCheckAndDeleteHooks");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    Put p=new Put(Bytes.toBytes(0));
    p.addColumn(A,A,A);
    table.put(p);
    Delete d=new Delete(Bytes.toBytes(0));
    table.delete(d);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreCheckAndDelete","hadPreCheckAndDeleteAfterRowLock","hadPostCheckAndDelete"},tableName,new Boolean[]{false,false,false});
    table.checkAndDelete(Bytes.toBytes(0),A,A,A,d);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreCheckAndDelete","hadPreCheckAndDeleteAfterRowLock","hadPostCheckAndDelete"},tableName,new Boolean[]{true,true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testRegionObserver() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testRegionObserver");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadDelete","hadPostStartRegionOperation","hadPostCloseRegionOperation","hadPostBatchMutateIndispensably"},tableName,new Boolean[]{false,false,false,false,false,false,false,false});
    Put put=new Put(ROW);
    put.addColumn(A,A,A);
    put.addColumn(B,B,B);
    put.addColumn(C,C,C);
    table.put(put);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadPreBatchMutate","hadPostBatchMutate","hadDelete","hadPostStartRegionOperation","hadPostCloseRegionOperation","hadPostBatchMutateIndispensably"},TEST_TABLE,new Boolean[]{false,false,true,true,true,true,false,true,true,true});
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"getCtPreOpen","getCtPostOpen","getCtPreClose","getCtPostClose"},tableName,new Integer[]{1,1,0,0});
    Get get=new Get(ROW);
    get.addColumn(A,A);
    get.addColumn(B,B);
    get.addColumn(C,C);
    table.get(get);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadDelete","hadPrePreparedDeleteTS"},tableName,new Boolean[]{true,true,true,true,false,false});
    Delete delete=new Delete(ROW);
    delete.addColumn(A,A);
    delete.addColumn(B,B);
    delete.addColumn(C,C);
    table.delete(delete);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadPreBatchMutate","hadPostBatchMutate","hadDelete","hadPrePreparedDeleteTS"},tableName,new Boolean[]{true,true,true,true,true,true,true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"getCtPreOpen","getCtPostOpen","getCtPreClose","getCtPostClose"},tableName,new Integer[]{1,1,1,1});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testIncrementHook() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testIncrementHook");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    Increment inc=new Increment(Bytes.toBytes(0));
    inc.addColumn(A,A,1);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreIncrement","hadPostIncrement","hadPreIncrementAfterRowLock"},tableName,new Boolean[]{false,false,false});
    table.increment(inc);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreIncrement","hadPostIncrement","hadPreIncrementAfterRowLock"},tableName,new Boolean[]{true,true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testHBase3758() throws IOException {
  TableName tableName=TableName.valueOf("testHBase3758");
  util.createTable(tableName,new byte[][]{A,B,C});
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadDeleted","wasScannerOpenCalled"},tableName,new Boolean[]{false,false});
  Table table=util.getConnection().getTable(tableName);
  Put put=new Put(ROW);
  put.addColumn(A,A,A);
  table.put(put);
  Delete delete=new Delete(ROW);
  table.delete(delete);
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadDeleted","wasScannerOpenCalled"},tableName,new Boolean[]{true,false});
  Scan s=new Scan();
  ResultScanner scanner=table.getScanner(s);
  try {
    for (Result rr=scanner.next(); rr != null; rr=scanner.next()) {
    }
  }
  finally {
    scanner.close();
  }
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"wasScannerOpenCalled"},tableName,new Boolean[]{true});
  util.deleteTable(tableName);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore @Test(timeout=300000) public void testRecovery() throws Exception {
  LOG.info(TestRegionObserverInterface.class.getName() + ".testRecovery");
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testRecovery");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try (RegionLocator locator=util.getConnection().getRegionLocator(tableName)){
    JVMClusterUtil.RegionServerThread rs1=cluster.startRegionServer();
    ServerName sn2=rs1.getRegionServer().getServerName();
    String regEN=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    util.getHBaseAdmin().move(regEN.getBytes(),sn2.getServerName().getBytes());
    while (!sn2.equals(locator.getAllRegionLocations().get(0).getServerName())) {
      Thread.sleep(100);
    }
    Put put=new Put(ROW);
    put.addColumn(A,A,A);
    put.addColumn(B,B,B);
    put.addColumn(C,C,C);
    table.put(put);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadPreBatchMutate","hadPostBatchMutate","hadDelete"},tableName,new Boolean[]{false,false,true,true,true,true,false});
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"getCtPreWALRestore","getCtPostWALRestore","getCtPrePut","getCtPostPut","getCtPreWALRestoreDeprecated","getCtPostWALRestoreDeprecated"},tableName,new Integer[]{0,0,1,1,0,0});
    cluster.killRegionServer(rs1.getRegionServer().getServerName());
    Threads.sleep(1000);
    util.waitUntilAllRegionsAssigned(tableName);
    LOG.info("All regions assigned");
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"getCtPreWALRestore","getCtPostWALRestore","getCtPrePut","getCtPostPut","getCtPreWALRestoreDeprecated","getCtPostWALRestoreDeprecated"},tableName,new Integer[]{1,1,0,0,0,0});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testHBase3583() throws IOException {
  TableName tableName=TableName.valueOf("testHBase3583");
  util.createTable(tableName,new byte[][]{A,B,C});
  util.waitUntilAllRegionsAssigned(tableName);
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","wasScannerNextCalled","wasScannerCloseCalled"},tableName,new Boolean[]{false,false,false,false});
  Table table=util.getConnection().getTable(tableName);
  Put put=new Put(ROW);
  put.addColumn(A,A,A);
  table.put(put);
  Get get=new Get(ROW);
  get.addColumn(A,A);
  table.get(get);
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","wasScannerNextCalled","wasScannerCloseCalled"},tableName,new Boolean[]{true,true,false,false});
  Scan s=new Scan();
  ResultScanner scanner=table.getScanner(s);
  try {
    for (Result rr=scanner.next(); rr != null; rr=scanner.next()) {
    }
  }
  finally {
    scanner.close();
  }
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"wasScannerNextCalled","wasScannerCloseCalled"},tableName,new Boolean[]{true,true});
  util.deleteTable(tableName);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore @Test(timeout=300000) public void testLegacyRecovery() throws Exception {
  LOG.info(TestRegionObserverInterface.class.getName() + ".testLegacyRecovery");
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testLegacyRecovery");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    try (RegionLocator locator=util.getConnection().getRegionLocator(tableName)){
      JVMClusterUtil.RegionServerThread rs1=cluster.startRegionServer();
      ServerName sn2=rs1.getRegionServer().getServerName();
      String regEN=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
      util.getHBaseAdmin().move(regEN.getBytes(),sn2.getServerName().getBytes());
      while (!sn2.equals(locator.getAllRegionLocations().get(0).getServerName())) {
        Thread.sleep(100);
      }
      Put put=new Put(ROW);
      put.addColumn(A,A,A);
      put.addColumn(B,B,B);
      put.addColumn(C,C,C);
      table.put(put);
      verifyMethodResult(SimpleRegionObserver.Legacy.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadPreBatchMutate","hadPostBatchMutate","hadDelete"},tableName,new Boolean[]{false,false,true,true,true,true,false});
      verifyMethodResult(SimpleRegionObserver.Legacy.class,new String[]{"getCtPreWALRestore","getCtPostWALRestore","getCtPrePut","getCtPostPut","getCtPreWALRestoreDeprecated","getCtPostWALRestoreDeprecated"},tableName,new Integer[]{0,0,1,1,0,0});
      cluster.killRegionServer(rs1.getRegionServer().getServerName());
      Threads.sleep(1000);
      util.waitUntilAllRegionsAssigned(tableName);
      LOG.info("All regions assigned");
      verifyMethodResult(SimpleRegionObserver.Legacy.class,new String[]{"getCtPreWALRestore","getCtPostWALRestore","getCtPrePut","getCtPostPut","getCtPreWALRestoreDeprecated","getCtPostWALRestoreDeprecated"},tableName,new Integer[]{1,1,0,0,1,1});
    }
   }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testCheckAndPutHooks() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testCheckAndPutHooks");
  try (Table table=util.createTable(tableName,new byte[][]{A,B,C})){
    Put p=new Put(Bytes.toBytes(0));
    p.addColumn(A,A,A);
    table.put(p);
    p=new Put(Bytes.toBytes(0));
    p.addColumn(A,A,A);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreCheckAndPut","hadPreCheckAndPutAfterRowLock","hadPostCheckAndPut"},tableName,new Boolean[]{false,false,false});
    table.checkAndPut(Bytes.toBytes(0),A,A,A,p);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreCheckAndPut","hadPreCheckAndPutAfterRowLock","hadPostCheckAndPut"},tableName,new Boolean[]{true,true,true});
  }
  finally {
    util.deleteTable(tableName);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testHBASE14489() throws IOException {
  TableName tableName=TableName.valueOf("testHBASE14489");
  HTable table=util.createTable(tableName,new byte[][]{A});
  Put put=new Put(ROW);
  put.addColumn(A,A,A);
  table.put(put);
  Scan s=new Scan();
  s.setFilter(new FilterAllFilter());
  ResultScanner scanner=table.getScanner(s);
  try {
    for (Result rr=scanner.next(); rr != null; rr=scanner.next()) {
    }
  }
  finally {
    scanner.close();
  }
  verifyMethodResult(SimpleRegionObserver.class,new String[]{"wasScannerFilterRowCalled"},tableName,new Boolean[]{true});
  util.deleteTable(tableName);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testRowMutation() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testRowMutation");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadDeleted"},tableName,new Boolean[]{false,false,false,false,false});
    Put put=new Put(ROW);
    put.addColumn(A,A,A);
    put.addColumn(B,B,B);
    put.addColumn(C,C,C);
    Delete delete=new Delete(ROW);
    delete.addColumn(A,A);
    delete.addColumn(B,B);
    delete.addColumn(C,C);
    RowMutations arm=new RowMutations(ROW);
    arm.add(put);
    arm.add(delete);
    table.mutateRow(arm);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreGet","hadPostGet","hadPrePut","hadPostPut","hadDeleted"},tableName,new Boolean[]{false,false,true,true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testPreWALRestoreSkip() throws Exception {
  LOG.info(TestRegionObserverInterface.class.getName() + ".testPreWALRestoreSkip");
  TableName tableName=TableName.valueOf(SimpleRegionObserver.TABLE_SKIPPED);
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try (RegionLocator locator=util.getConnection().getRegionLocator(tableName)){
    JVMClusterUtil.RegionServerThread rs1=cluster.startRegionServer();
    ServerName sn2=rs1.getRegionServer().getServerName();
    String regEN=locator.getAllRegionLocations().get(0).getRegionInfo().getEncodedName();
    util.getHBaseAdmin().move(regEN.getBytes(),sn2.getServerName().getBytes());
    while (!sn2.equals(locator.getAllRegionLocations().get(0).getServerName())) {
      Thread.sleep(100);
    }
    Put put=new Put(ROW);
    put.addColumn(A,A,A);
    put.addColumn(B,B,B);
    put.addColumn(C,C,C);
    table.put(put);
    cluster.killRegionServer(rs1.getRegionServer().getServerName());
    Threads.sleep(20000);
    util.waitUntilAllRegionsAssigned(tableName);
  }
   verifyMethodResult(SimpleRegionObserver.class,new String[]{"getCtPreWALRestore","getCtPostWALRestore","getCtPreWALRestoreDeprecated","getCtPostWALRestoreDeprecated"},tableName,new Integer[]{0,0,0,0});
  util.deleteTable(tableName);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testAppendHook() throws IOException {
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".testAppendHook");
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try {
    Append app=new Append(Bytes.toBytes(0));
    app.add(A,A,A);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreAppend","hadPostAppend","hadPreAppendAfterRowLock"},tableName,new Boolean[]{false,false,false});
    table.append(app);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreAppend","hadPostAppend","hadPreAppendAfterRowLock"},tableName,new Boolean[]{true,true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void bulkLoadHFileTest() throws Exception {
  String testName=TestRegionObserverInterface.class.getName() + ".bulkLoadHFileTest";
  TableName tableName=TableName.valueOf(TEST_TABLE.getNameAsString() + ".bulkLoadHFileTest");
  Configuration conf=util.getConfiguration();
  Table table=util.createTable(tableName,new byte[][]{A,B,C});
  try (RegionLocator locator=util.getConnection().getRegionLocator(tableName)){
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreBulkLoadHFile","hadPostBulkLoadHFile"},tableName,new Boolean[]{false,false});
    FileSystem fs=util.getTestFileSystem();
    final Path dir=util.getDataTestDirOnTestFS(testName).makeQualified(fs);
    Path familyDir=new Path(dir,Bytes.toString(A));
    createHFile(util.getConfiguration(),fs,new Path(familyDir,Bytes.toString(A)),A,A);
    new LoadIncrementalHFiles(conf).doBulkLoad(dir,util.getHBaseAdmin(),table,locator);
    verifyMethodResult(SimpleRegionObserver.class,new String[]{"hadPreBulkLoadHFile","hadPostBulkLoadHFile"},tableName,new Boolean[]{true,true});
  }
  finally {
    util.deleteTable(tableName);
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testExceptionDuringInitialization() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER,2);
  conf.setBoolean(CoprocessorHost.ABORT_ON_ERROR_KEY,true);
  conf.set(CoprocessorHost.REGION_COPROCESSOR_CONF_KEY,"");
  TEST_UTIL.startMiniCluster(2);
  try {
    MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
    final HRegionServer regionServer=cluster.getRegionServer(0);
    conf.set(CoprocessorHost.REGION_COPROCESSOR_CONF_KEY,FailedInitializationObserver.class.getName());
    regionServer.getRegionServerCoprocessorHost().loadSystemCoprocessors(conf,CoprocessorHost.REGION_COPROCESSOR_CONF_KEY);
    TEST_UTIL.waitFor(10000,1000,new Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return regionServer.isAborted();
      }
    }
);
  }
  finally {
    TEST_UTIL.shutdownMiniCluster();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.coprocessor.TestWALObserver </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test WAL write behavior with WALObserver. The coprocessor monitors a
 * WALEdit written to WAL, and ignore, modify, and add KeyValue's for the
 * WALEdit.
 */
@Test public void testWALObserverWriteToWAL() throws Exception {
  final WAL log=wals.getWAL(UNSPECIFIED_REGION,null);
  verifyWritesSeen(log,getCoprocessor(log,SampleRegionWALObserver.class),false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test WAL write behavior with WALObserver. The coprocessor monitors a
 * WALEdit written to WAL, and ignore, modify, and add KeyValue's for the
 * WALEdit.
 */
@Test public void testLegacyWALObserverWriteToWAL() throws Exception {
  final WAL log=wals.getWAL(UNSPECIFIED_REGION,null);
  verifyWritesSeen(log,getCoprocessor(log,SampleRegionWALObserver.Legacy.class),true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.errorhandling.TestForeignExceptionDispatcher </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that the dispatcher can receive an error via the timer mechanism.
 */
@Test public void testAttemptTimer(){
  ForeignExceptionListener listener1=Mockito.mock(ForeignExceptionListener.class);
  ForeignExceptionListener listener2=Mockito.mock(ForeignExceptionListener.class);
  ForeignExceptionDispatcher orchestrator=new ForeignExceptionDispatcher();
  orchestrator.addListener(listener1);
  orchestrator.addListener(listener2);
  TimeoutExceptionInjector timer=new TimeoutExceptionInjector(orchestrator,1000);
  timer.start();
  timer.trigger();
  Mockito.verify(listener1,Mockito.times(1)).receive(Mockito.any(ForeignException.class));
  Mockito.verify(listener2,Mockito.times(1)).receive(Mockito.any(ForeignException.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.errorhandling.TestTimeoutExceptionInjector </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that a manually triggered exception with data fires with the data in receiveError.
 */
@Test public void testTimerPassesOnErrorInfo(){
  final long time=1000000;
  ForeignExceptionListener listener=Mockito.mock(ForeignExceptionListener.class);
  TimeoutExceptionInjector timer=new TimeoutExceptionInjector(listener,time);
  timer.start();
  timer.trigger();
  Mockito.verify(listener).receive(Mockito.any(ForeignException.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that a manually triggered timer fires an exception.
 */
@Test(timeout=60000) public void testTimerTrigger(){
  final long time=10000000;
  ForeignExceptionListener listener=Mockito.mock(ForeignExceptionListener.class);
  TimeoutExceptionInjector timer=new TimeoutExceptionInjector(listener,time);
  timer.start();
  timer.trigger();
  Mockito.verify(listener,Mockito.times(1)).receive(Mockito.any(ForeignException.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.executor.TestExecutorService </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAborting() throws Exception {
  final Configuration conf=HBaseConfiguration.create();
  final Server server=mock(Server.class);
  when(server.getConfiguration()).thenReturn(conf);
  ExecutorService executorService=new ExecutorService("unit_test");
  executorService.startExecutorService(ExecutorType.MASTER_SERVER_OPERATIONS,1);
  executorService.submit(new EventHandler(server,EventType.M_SERVER_SHUTDOWN){
    @Override public void process() throws IOException {
      throw new RuntimeException("Should cause abort");
    }
  }
);
  Waiter.waitFor(conf,30000,new Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      try {
        verify(server,times(1)).abort(anyString(),(Throwable)anyObject());
        return true;
      }
 catch (      Throwable t) {
        return false;
      }
    }
  }
);
  executorService.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestBitComparator </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testANDOperation(){
  testOperation(zeros,ones,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(data1,ones,BitComparator.BitwiseOp.AND,Equal);
  testOperation(data1,data0,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(data2,data1,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(ones,data0,BitComparator.BitwiseOp.AND,Equal);
  testOperation(ones,data3,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(zeros_bb,ones,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(data1_bb,ones,BitComparator.BitwiseOp.AND,Equal);
  testOperation(data1_bb,data0,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(data2_bb,data1,BitComparator.BitwiseOp.AND,NotEqual);
  testOperation(ones_bb,data0,BitComparator.BitwiseOp.AND,Equal);
  testOperation(ones_bb,data3,BitComparator.BitwiseOp.AND,NotEqual);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOROperationWithOffset(){
  testOperationWithOffset(data1_2,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperationWithOffset(data2_2,data1,BitComparator.BitwiseOp.OR,Equal);
  testOperationWithOffset(data1_2_bb,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperationWithOffset(data2_2_bb,data1,BitComparator.BitwiseOp.OR,Equal);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOROperation(){
  testOperation(ones,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperation(zeros,zeros,BitComparator.BitwiseOp.OR,NotEqual);
  testOperation(data1,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperation(data2,data1,BitComparator.BitwiseOp.OR,Equal);
  testOperation(ones,data3,BitComparator.BitwiseOp.OR,NotEqual);
  testOperation(ones_bb,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperation(zeros_bb,zeros,BitComparator.BitwiseOp.OR,NotEqual);
  testOperation(data1_bb,zeros,BitComparator.BitwiseOp.OR,Equal);
  testOperation(data2_bb,data1,BitComparator.BitwiseOp.OR,Equal);
  testOperation(ones_bb,data3,BitComparator.BitwiseOp.OR,NotEqual);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testANDOperationWithOffset(){
  testOperationWithOffset(data1_2,ones,BitComparator.BitwiseOp.AND,Equal);
  testOperationWithOffset(data1_2,data0,BitComparator.BitwiseOp.AND,NotEqual);
  testOperationWithOffset(data2_2,data1,BitComparator.BitwiseOp.AND,NotEqual);
  testOperationWithOffset(data1_2_bb,ones,BitComparator.BitwiseOp.AND,Equal);
  testOperationWithOffset(data1_2_bb,data0,BitComparator.BitwiseOp.AND,NotEqual);
  testOperationWithOffset(data2_2_bb,data1,BitComparator.BitwiseOp.AND,NotEqual);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testXOROperationWithOffset(){
  testOperationWithOffset(data2_2,data1,BitComparator.BitwiseOp.XOR,Equal);
  testOperationWithOffset(data2_2_bb,data1,BitComparator.BitwiseOp.XOR,Equal);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testXOROperation(){
  testOperation(ones,zeros,BitComparator.BitwiseOp.XOR,Equal);
  testOperation(zeros,zeros,BitComparator.BitwiseOp.XOR,NotEqual);
  testOperation(ones,ones,BitComparator.BitwiseOp.XOR,NotEqual);
  testOperation(data2,data1,BitComparator.BitwiseOp.XOR,Equal);
  testOperation(ones,data3,BitComparator.BitwiseOp.XOR,NotEqual);
  testOperation(ones_bb,zeros,BitComparator.BitwiseOp.XOR,Equal);
  testOperation(zeros_bb,zeros,BitComparator.BitwiseOp.XOR,NotEqual);
  testOperation(ones_bb,ones,BitComparator.BitwiseOp.XOR,NotEqual);
  testOperation(data2_bb,data1,BitComparator.BitwiseOp.XOR,Equal);
  testOperation(ones_bb,data3,BitComparator.BitwiseOp.XOR,NotEqual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestColumnPaginationFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests serialization
 * @throws Exception
 */
@Test public void testSerialization() throws Exception {
  Filter newFilter=serializationTest(columnPaginationFilter);
  basicFilterTests((ColumnPaginationFilter)newFilter);
  Filter newFilterOffset=serializationTest(columnPaginationFilterOffset);
  basicFilterTests((ColumnPaginationFilter)newFilterOffset);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestDependentColumnFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test scans using a DependentColumnFilter
 */
@Test public void testScans() throws Exception {
  Filter filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER);
  Scan scan=new Scan();
  scan.setFilter(filter);
  scan.setMaxVersions(Integer.MAX_VALUE);
  verifyScan(scan,2,8);
  filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER,true);
  scan=new Scan();
  scan.setFilter(filter);
  scan.setMaxVersions(Integer.MAX_VALUE);
  verifyScan(scan,2,3);
  filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER,false,CompareOp.EQUAL,new BinaryComparator(MATCH_VAL));
  scan=new Scan();
  scan.setFilter(filter);
  scan.setMaxVersions(Integer.MAX_VALUE);
  verifyScan(scan,2,3);
  filter=new DependentColumnFilter(FAMILIES[0],QUALIFIER,true,CompareOp.EQUAL,new BinaryComparator(MATCH_VAL));
  scan=new Scan();
  scan.setFilter(filter);
  scan.setMaxVersions(Integer.MAX_VALUE);
  verifyScan(scan,1,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPageFilter() throws Exception {
  KeyValue[] expectedKVs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  long expectedRows=6;
  long expectedKeys=this.colsPerRow;
  Scan s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,expectedKVs);
  expectedRows=4;
  expectedKeys=this.colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,24));
  expectedRows=2;
  expectedKeys=this.colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,12));
  expectedRows=1;
  expectedKeys=this.colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,6));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoFilter() throws Exception {
  long expectedRows=this.numRows;
  long expectedKeys=this.colsPerRow;
  Scan s=new Scan();
  verifyScan(s,expectedRows,expectedKeys);
  s=new Scan();
  s.addFamily(FAMILIES[0]);
  verifyScan(s,expectedRows,expectedKeys / 2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValueFilter() throws IOException {
  long expectedRows=this.numRows / 2;
  long expectedKeys=this.colsPerRow;
  Filter f=new ValueFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.EQUAL,new RegexStringComparator("testValue((One)|(Two))"));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new ValueFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new ValueFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterList() throws IOException {
  List<Filter> filters=new ArrayList<Filter>();
  filters.add(new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new ValueFilter(CompareOp.EQUAL,new SubstringComparator("One")));
  Filter f=new FilterList(Operator.MUST_PASS_ALL,filters);
  Scan s=new Scan();
  s.addFamily(FAMILIES[0]);
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0])};
  verifyScanFull(s,kvs);
  filters.clear();
  filters.add(new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+Two.+")));
  filters.add(new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new ValueFilter(CompareOp.EQUAL,new SubstringComparator("One")));
  f=new FilterList(Operator.MUST_PASS_ONE,filters);
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,this.numRows,this.colsPerRow);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFirstKeyOnlyFilter() throws IOException {
  Scan s=new Scan();
  s.setFilter(new FirstKeyOnlyFilter());
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQualifierFilter() throws IOException {
  long expectedRows=this.numRows / 2;
  long expectedKeys=2;
  Filter f=new QualifierFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=2;
  f=new QualifierFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=2;
  f=new QualifierFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(QUALIFIERS_ONE[2]));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new RegexStringComparator("test.+-2"));
  s=new Scan();
  s.setFilter(f);
  kvs=new KeyValue[]{new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowFilter() throws IOException {
  long expectedRows=1;
  long expectedKeys=this.colsPerRow;
  Filter f=new RowFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=2;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.EQUAL,new RegexStringComparator("testRow.+-2"));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=1;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=2;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows - 1;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows - 1;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows - 2;
  expectedKeys=this.colsPerRow;
  f=new RowFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new RowFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
  f=new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2"));
  s=new Scan();
  s.setFilter(f);
  kvs=new KeyValue[]{new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyOnlyFilter() throws Exception {
  KeyValue[] expectedKVs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  long expectedRows=6;
  long expectedKeys=this.colsPerRow;
  for (  boolean useLen : new boolean[]{false,true}) {
    Scan s=new Scan();
    s.setFilter(new KeyOnlyFilter(useLen));
    verifyScan(s,expectedRows,expectedKeys);
    verifyScanFullNoValues(s,expectedKVs,useLen);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkipFilter() throws IOException {
  Filter f=new SkipFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2"))));
  Scan s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnPaginationFilter() throws Exception {
  Put p=new Put(ROWS_ONE[0]);
  p.setDurability(Durability.SKIP_WAL);
  p.addColumn(FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]);
  this.region.put(p);
  this.region.flush(true);
  KeyValue[] expectedKVs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1])};
  KeyValue[] expectedKVs2={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1])};
  KeyValue[] expectedKVs3={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1])};
  KeyValue[] expectedKVs4={};
  long expectedRows=this.numRows;
  long expectedKeys=1;
  Scan s=new Scan();
  s.setFilter(new ColumnPaginationFilter(1,0));
  verifyScan(s,expectedRows,expectedKeys);
  this.verifyScanFull(s,expectedKVs);
  s.setFilter(new ColumnPaginationFilter(1,2));
  verifyScan(s,expectedRows,expectedKeys);
  this.verifyScanFull(s,expectedKVs2);
  s.setFilter(new ColumnPaginationFilter(2,2));
  expectedKeys=2;
  verifyScan(s,expectedRows,expectedKeys);
  this.verifyScanFull(s,expectedKVs3);
  s.setFilter(new ColumnPaginationFilter(20,140));
  expectedKeys=0;
  expectedRows=0;
  verifyScan(s,expectedRows,0);
  this.verifyScanFull(s,expectedKVs4);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterListWithSingleColumnValueFilter() throws IOException {
  SingleColumnValueFilter f1=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,VALUES[0]);
  f1.setFilterIfMissing(true);
  Scan s1=new Scan();
  s1.addFamily(FAMILIES[0]);
  s1.setFilter(f1);
  KeyValue[] kvs1={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0])};
  verifyScanNoEarlyOut(s1,3,3);
  verifyScanFull(s1,kvs1);
  SingleColumnValueFilter f2=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_TWO[0],CompareOp.EQUAL,VALUES[1]);
  f2.setFilterIfMissing(true);
  Scan s2=new Scan();
  s2.addFamily(FAMILIES[0]);
  s2.setFilter(f2);
  KeyValue[] kvs2={new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanNoEarlyOut(s2,3,3);
  verifyScanFull(s2,kvs2);
  FilterList f=new FilterList(Operator.MUST_PASS_ONE);
  f.addFilter(f1);
  f.addFilter(f2);
  Scan s=new Scan();
  s.addFamily(FAMILIES[0]);
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanNoEarlyOut(s,6,3);
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFamilyFilter() throws IOException {
  long expectedRows=this.numRows;
  long expectedKeys=this.colsPerRow / 2;
  Filter f=new FamilyFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testFamilyOne")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=0;
  expectedKeys=0;
  f=new FamilyFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testFamily")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows;
  expectedKeys=this.colsPerRow / 2;
  f=new FamilyFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testFamilyOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow / 2;
  f=new FamilyFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testFamilyOne")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow;
  f=new FamilyFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testFamilyOne")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  expectedKeys=this.colsPerRow / 2;
  f=new FamilyFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testFamilyOne")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new FamilyFilter(CompareOp.NOT_EQUAL,new BinaryComparator(FAMILIES[1]));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
  f=new FamilyFilter(CompareOp.NOT_EQUAL,new RegexStringComparator("test.*One"));
  s=new Scan();
  s.setFilter(f);
  kvs=new KeyValue[]{new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInclusiveStopFilter() throws IOException {
  long expectedRows=(this.numRows / 2) - 1;
  long expectedKeys=this.colsPerRow;
  Scan s=new Scan(Bytes.toBytes("testRowOne-0"),Bytes.toBytes("testRowOne-3"));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  s=new Scan(Bytes.toBytes("testRowOne-0"));
  s.setFilter(new InclusiveStopFilter(Bytes.toBytes("testRowOne-3")));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=(this.numRows / 2) - 1;
  expectedKeys=this.colsPerRow;
  s=new Scan(Bytes.toBytes("testRowTwo-0"),Bytes.toBytes("testRowTwo-3"));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=this.numRows / 2;
  s=new Scan(Bytes.toBytes("testRowTwo-0"));
  s.setFilter(new InclusiveStopFilter(Bytes.toBytes("testRowTwo-3")));
  verifyScan(s,expectedRows,expectedKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefixFilter() throws Exception {
  long expectedRows=this.numRows / 2;
  long expectedKeys=this.colsPerRow;
  Scan s=new Scan();
  s.setFilter(new PrefixFilter(Bytes.toBytes("testRowOne")));
  verifyScan(s,expectedRows,expectedKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleColumnValueFilter() throws IOException {
  Put p=new Put(ROWS_ONE[2]);
  p.addColumn(FAMILIES[0],QUALIFIERS_ONE[2],VALUES[1]);
  this.region.put(p);
  List<Filter> filters=new ArrayList<Filter>();
  filters.add(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,VALUES[0]));
  filters.add(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[2],CompareOp.EQUAL,VALUES[1]));
  Filter f=new FilterList(Operator.MUST_PASS_ALL,filters);
  Scan s=new Scan(ROWS_ONE[0],ROWS_TWO[0]);
  s.addFamily(FAMILIES[0]);
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[1]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0])};
  verifyScanNoEarlyOut(s,1,3);
  verifyScanFull(s,kvs);
  filters=new ArrayList<Filter>();
  filters.add(new SkipFilter(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,VALUES[0])));
  filters.add(new SkipFilter(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[2],CompareOp.EQUAL,VALUES[1])));
  f=new FilterList(Operator.MUST_PASS_ALL,filters);
  s=new Scan(ROWS_ONE[0],ROWS_TWO[0]);
  s.addFamily(FAMILIES[0]);
  s.setFilter(f);
  verifyScanNoEarlyOut(s,1,3);
  verifyScanFull(s,kvs);
  byte[][] ROWS_THREE={Bytes.toBytes("rowThree-0"),Bytes.toBytes("rowThree-1"),Bytes.toBytes("rowThree-2"),Bytes.toBytes("rowThree-3")};
  KeyValue[] srcKVs=new KeyValue[]{new KeyValue(ROWS_THREE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_THREE[1],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[1]),new KeyValue(ROWS_THREE[2],FAMILIES[0],QUALIFIERS_ONE[1],VALUES[0]),new KeyValue(ROWS_THREE[3],FAMILIES[0],QUALIFIERS_ONE[1],VALUES[1])};
  for (  KeyValue kv : srcKVs) {
    Put put=new Put(CellUtil.cloneRow(kv)).add(kv);
    put.setDurability(Durability.SKIP_WAL);
    this.region.put(put);
  }
  SingleColumnValueFilter scvf=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,VALUES[0]);
  s=new Scan(ROWS_THREE[0],Bytes.toBytes("rowThree-4"));
  s.addFamily(FAMILIES[0]);
  s.setFilter(scvf);
  kvs=new KeyValue[]{srcKVs[0],srcKVs[2],srcKVs[3]};
  verifyScanFull(s,kvs);
  scvf=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOp.EQUAL,VALUES[0]);
  scvf.setFilterIfMissing(true);
  s=new Scan(ROWS_THREE[0],Bytes.toBytes("rowThree-4"));
  s.addFamily(FAMILIES[0]);
  s.setFilter(scvf);
  kvs=new KeyValue[]{srcKVs[0]};
  verifyScanFull(s,kvs);
  scvf=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[1],CompareOp.EQUAL,VALUES[1]);
  scvf.setFilterIfMissing(true);
  s=new Scan(ROWS_THREE[0],Bytes.toBytes("rowThree-4"));
  s.addFamily(FAMILIES[0]);
  s.setFilter(scvf);
  kvs=new KeyValue[]{srcKVs[3]};
  verifyScanFull(s,kvs);
  KeyValue kvA=new KeyValue(ROWS_THREE[0],FAMILIES[0],QUALIFIERS_ONE[1],VALUES[0]);
  this.region.put(new Put(CellUtil.cloneRow(kvA)).add(kvA));
  scvf=new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[1],CompareOp.EQUAL,VALUES[1]);
  scvf.setFilterIfMissing(true);
  s=new Scan(ROWS_THREE[0],Bytes.toBytes("rowThree-4"));
  s.addFamily(FAMILIES[0]);
  s.setFilter(scvf);
  kvs=new KeyValue[]{srcKVs[3]};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFilterList </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test list ordering
 * @throws Exception
 */
@Test public void testOrdering() throws Exception {
  orderingTest(getOrderingFilter());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test serialization
 * @throws Exception
 */
@Test public void testSerialization() throws Exception {
  List<Filter> filters=new ArrayList<Filter>();
  filters.add(new PageFilter(MAX_PAGES));
  filters.add(new WhileMatchFilter(new PrefixFilter(Bytes.toBytes("yyy"))));
  Filter filterMPALL=new FilterList(FilterList.Operator.MUST_PASS_ALL,filters);
  byte[] buffer=filterMPALL.toByteArray();
  FilterList newFilter=FilterList.parseFrom(buffer);
  mpOneTest(ProtobufUtil.toFilter(ProtobufUtil.toFilter(getFilterMPONE())));
  mpAllTest(ProtobufUtil.toFilter(ProtobufUtil.toFilter(getMPALLFilter())));
  orderingTest(ProtobufUtil.toFilter(ProtobufUtil.toFilter(getOrderingFilter())));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test "must pass all"
 * @throws Exception
 */
@Test public void testMPALL() throws Exception {
  mpAllTest(getMPALLFilter());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddFilter() throws Exception {
  Filter filter1=new FirstKeyOnlyFilter();
  Filter filter2=new FirstKeyOnlyFilter();
  FilterList filterList=new FilterList(filter1,filter2);
  filterList.addFilter(new FirstKeyOnlyFilter());
  filterList=new FilterList(Arrays.asList(filter1,filter2));
  filterList.addFilter(new FirstKeyOnlyFilter());
  filterList=new FilterList(Operator.MUST_PASS_ALL,filter1,filter2);
  filterList.addFilter(new FirstKeyOnlyFilter());
  filterList=new FilterList(Operator.MUST_PASS_ALL,Arrays.asList(filter1,filter2));
  filterList.addFilter(new FirstKeyOnlyFilter());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test "must pass one"
 * @throws Exception
 */
@Test public void testMPONE() throws Exception {
  mpOneTest(getFilterMPONE());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFuzzyRowAndColumnRangeFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void Test() throws Exception {
  String cf="f";
  String table="TestFuzzyAndColumnRangeFilterClient";
  Table ht=TEST_UTIL.createTable(TableName.valueOf(table),Bytes.toBytes(cf),Integer.MAX_VALUE);
  for (int i1=0; i1 < 2; i1++) {
    for (int i2=0; i2 < 5; i2++) {
      byte[] rk=new byte[10];
      ByteBuffer buf=ByteBuffer.wrap(rk);
      buf.clear();
      buf.putShort((short)2);
      buf.putInt(i1);
      buf.putInt(i2);
      for (int c=0; c < 5; c++) {
        byte[] cq=new byte[4];
        Bytes.putBytes(cq,0,Bytes.toBytes(c),0,4);
        Put p=new Put(rk);
        p.setDurability(Durability.SKIP_WAL);
        p.addColumn(cf.getBytes(),cq,Bytes.toBytes(c));
        ht.put(p);
        LOG.info("Inserting: rk: " + Bytes.toStringBinary(rk) + " cq: "+ Bytes.toStringBinary(cq));
      }
    }
  }
  TEST_UTIL.flush();
  runTest(ht,0,10);
  runTest(ht,1,8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestFuzzyRowFilterEndToEnd </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEndToEnd() throws Exception {
  String cf="f";
  Table ht=TEST_UTIL.createTable(TableName.valueOf(table),Bytes.toBytes(cf),Integer.MAX_VALUE);
  for (int i0=0; i0 < firstPartCardinality; i0++) {
    for (int i1=0; i1 < secondPartCardinality; i1++) {
      for (int i2=0; i2 < thirdPartCardinality; i2++) {
        byte[] rk=new byte[10];
        ByteBuffer buf=ByteBuffer.wrap(rk);
        buf.clear();
        buf.putShort((short)i0);
        buf.putInt(i1);
        buf.putInt(i2);
        for (int c=0; c < colQualifiersTotal; c++) {
          byte[] cq=new byte[4];
          Bytes.putBytes(cq,0,Bytes.toBytes(c),0,4);
          Put p=new Put(rk);
          p.setDurability(Durability.SKIP_WAL);
          p.addColumn(cf.getBytes(),cq,Bytes.toBytes(c));
          ht.put(p);
        }
      }
    }
  }
  TEST_UTIL.flush();
  runTest1(ht);
  runTest2(ht);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("deprecation") @Test public void testFilterList() throws Exception {
  String cf="f";
  String table="TestFuzzyRowFiltersInFilterList";
  Table ht=TEST_UTIL.createTable(TableName.valueOf(table),Bytes.toBytes(cf),Integer.MAX_VALUE);
  for (int i1=0; i1 < 5; i1++) {
    for (int i2=0; i2 < 5; i2++) {
      byte[] rk=new byte[10];
      ByteBuffer buf=ByteBuffer.wrap(rk);
      buf.clear();
      buf.putShort((short)2);
      buf.putInt(i1);
      buf.putInt(i2);
      for (int c=0; c < 5; c++) {
        byte[] cq=new byte[4];
        Bytes.putBytes(cq,0,Bytes.toBytes(c),0,4);
        Put p=new Put(rk);
        p.setDurability(Durability.SKIP_WAL);
        p.addColumn(cf.getBytes(),cq,Bytes.toBytes(c));
        ht.put(p);
        LOG.info("Inserting: rk: " + Bytes.toStringBinary(rk) + " cq: "+ Bytes.toStringBinary(cq));
      }
    }
  }
  TEST_UTIL.flush();
  runTest(ht,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestInclusiveStopFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests identification of the stop row
 * @throws Exception
 */
@Test public void testStopRowIdentification() throws Exception {
  stopRowTests(mainFilter);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests serialization
 * @throws Exception
 */
@Test public void testSerialization() throws Exception {
  byte[] buffer=mainFilter.toByteArray();
  Filter newFilter=InclusiveStopFilter.parseFrom(buffer);
  stopRowTests(newFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestInvocationRecordFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterInvocation() throws Exception {
  List<Integer> selectQualifiers=new ArrayList<Integer>();
  List<Integer> expectedQualifiers=new ArrayList<Integer>();
  selectQualifiers.add(-1);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
  selectQualifiers.clear();
  selectQualifiers.add(0);
  expectedQualifiers.add(0);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
  selectQualifiers.add(3);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
  selectQualifiers.add(4);
  expectedQualifiers.add(4);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
  selectQualifiers.add(5);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
  selectQualifiers.add(8);
  expectedQualifiers.add(8);
  verifyInvocationResults(selectQualifiers.toArray(new Integer[selectQualifiers.size()]),expectedQualifiers.toArray(new Integer[expectedQualifiers.size()]));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestMultiRowRangeFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithStartRowInclusive() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(20),true,Bytes.toBytes(""),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(""),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithRowInclusive() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),true));
  ranges.add(new RowRange(Bytes.toBytes(20),false,Bytes.toBytes(""),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(""),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithOverlap() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(15),true,Bytes.toBytes(40),false));
  ranges.add(new RowRange(Bytes.toBytes(20),true,Bytes.toBytes(30),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(50),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(70),false));
  ranges.add(new RowRange(Bytes.toBytes(90),true,Bytes.toBytes(100),false));
  ranges.add(new RowRange(Bytes.toBytes(95),true,Bytes.toBytes(100),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(70),false));
  expectedRanges.add(new RowRange(Bytes.toBytes(90),true,Bytes.toBytes(100),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithoutOverlap() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(40),false));
  ranges.add(new RowRange(Bytes.toBytes(60),true,Bytes.toBytes(70),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  expectedRanges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(40),false));
  expectedRanges.add(new RowRange(Bytes.toBytes(60),true,Bytes.toBytes(70),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithRowExclusive() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(20),false,Bytes.toBytes(""),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  expectedRanges.add(new RowRange(Bytes.toBytes(20),false,Bytes.toBytes(""),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testMultiRowRangeWithInvalidRange() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(80),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(70),false));
  new MultiRowRangeFilter(ranges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithEmptyStopRow() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(15),true,Bytes.toBytes(""),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(70),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(""),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithEmptyStartRowAndStopRow() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(10),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(""),true,Bytes.toBytes(""),false));
  ranges.add(new RowRange(Bytes.toBytes(30),true,Bytes.toBytes(70),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(""),true,Bytes.toBytes(""),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeAndSortWithEmptyStartRow() throws IOException {
  List<RowRange> ranges=new ArrayList<RowRange>();
  ranges.add(new RowRange(Bytes.toBytes(""),true,Bytes.toBytes(20),false));
  ranges.add(new RowRange(Bytes.toBytes(15),true,Bytes.toBytes(40),false));
  List<RowRange> actualRanges=MultiRowRangeFilter.sortAndMerge(ranges);
  List<RowRange> expectedRanges=new ArrayList<RowRange>();
  expectedRanges.add(new RowRange(Bytes.toBytes(""),true,Bytes.toBytes(40),false));
  assertRangesEqual(expectedRanges,actualRanges);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestPageFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test page size filter
 * @throws Exception
 */
@Test public void testPageSize() throws Exception {
  Filter f=new PageFilter(ROW_LIMIT);
  pageSizeTests(f);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test filter serialization
 * @throws Exception
 */
@Test public void testSerialization() throws Exception {
  Filter f=new PageFilter(ROW_LIMIT);
  byte[] buffer=f.toByteArray();
  Filter newFilter=PageFilter.parseFrom(buffer);
  pageSizeTests(newFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestParseFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCorrectFilterString() throws IOException {
  String filterString="(FirstKeyOnlyFilter())";
  FirstKeyOnlyFilter firstKeyOnlyFilter=doTestFilter(filterString,FirstKeyOnlyFilter.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestPrefixFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefixOnRowInsideWhileMatchRow() throws Exception {
  prefixRowTests(new WhileMatchFilter(this.mainFilter),true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefixOnRow() throws Exception {
  prefixRowTests(mainFilter);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialization() throws Exception {
  byte[] buffer=mainFilter.toByteArray();
  Filter newFilter=PrefixFilter.parseFrom(buffer);
  prefixRowTests(newFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestScanRowPrefix </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefixScanning() throws IOException {
  TableName tableName=TableName.valueOf("prefixScanning");
  createTable(tableName,"F");
  Table table=openTable(tableName);
  final byte[][] rowIds={{(byte)0x11},{(byte)0x12},{(byte)0x12,(byte)0x23,(byte)0xFF,(byte)0xFE},{(byte)0x12,(byte)0x23,(byte)0xFF,(byte)0xFF},{(byte)0x12,(byte)0x23,(byte)0xFF,(byte)0xFF,(byte)0x00},{(byte)0x12,(byte)0x23,(byte)0xFF,(byte)0xFF,(byte)0x01},{(byte)0x12,(byte)0x24},{(byte)0x12,(byte)0x24,(byte)0x00},{(byte)0x12,(byte)0x24,(byte)0x00,(byte)0x00},{(byte)0x12,(byte)0x25},{(byte)0xFF,(byte)0xFF,(byte)0xFF,(byte)0xFF,(byte)0xFF}};
  for (  byte[] rowId : rowIds) {
    Put p=new Put(rowId);
    p.addColumn("F".getBytes(),rowId,"Dummy value".getBytes());
    table.put(p);
  }
  byte[] prefix0={};
  List<byte[]> expected0=new ArrayList<>(16);
  expected0.addAll(Arrays.asList(rowIds));
  byte[] prefix1={(byte)0x12,(byte)0x23};
  List<byte[]> expected1=new ArrayList<>(16);
  expected1.add(rowIds[2]);
  expected1.add(rowIds[3]);
  expected1.add(rowIds[4]);
  expected1.add(rowIds[5]);
  byte[] prefix2={(byte)0x12,(byte)0x23,(byte)0xFF,(byte)0xFF};
  List<byte[]> expected2=new ArrayList<>();
  expected2.add(rowIds[3]);
  expected2.add(rowIds[4]);
  expected2.add(rowIds[5]);
  byte[] prefix3={(byte)0x12,(byte)0x24};
  List<byte[]> expected3=new ArrayList<>();
  expected3.add(rowIds[6]);
  expected3.add(rowIds[7]);
  expected3.add(rowIds[8]);
  byte[] prefix4={(byte)0xFF,(byte)0xFF};
  List<byte[]> expected4=new ArrayList<>();
  expected4.add(rowIds[10]);
  Scan scan=new Scan();
  scan.setRowPrefixFilter(prefix0);
  verifyScanResult(table,scan,expected0,"Scan empty prefix failed");
  scan=new Scan();
  scan.setRowPrefixFilter(prefix1);
  verifyScanResult(table,scan,expected1,"Scan normal prefix failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after prefix reset failed");
  scan=new Scan();
  scan.setFilter(new ColumnPrefixFilter(prefix1));
  verifyScanResult(table,scan,expected1,"Double check on column prefix failed");
  scan=new Scan();
  scan.setRowPrefixFilter(prefix2);
  verifyScanResult(table,scan,expected2,"Scan edge 0xFF prefix failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after prefix reset failed");
  scan=new Scan();
  scan.setFilter(new ColumnPrefixFilter(prefix2));
  verifyScanResult(table,scan,expected2,"Double check on column prefix failed");
  scan=new Scan();
  scan.setRowPrefixFilter(prefix3);
  verifyScanResult(table,scan,expected3,"Scan normal with 0x00 ends failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after prefix reset failed");
  scan=new Scan();
  scan.setFilter(new ColumnPrefixFilter(prefix3));
  verifyScanResult(table,scan,expected3,"Double check on column prefix failed");
  scan=new Scan();
  scan.setRowPrefixFilter(prefix4);
  verifyScanResult(table,scan,expected4,"Scan end prefix failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after prefix reset failed");
  scan=new Scan();
  scan.setFilter(new ColumnPrefixFilter(prefix4));
  verifyScanResult(table,scan,expected4,"Double check on column prefix failed");
  scan=new Scan();
  scan.setRowPrefixFilter(prefix1);
  verifyScanResult(table,scan,expected1,"Prefix filter failed");
  scan.setFilter(new ColumnPrefixFilter(prefix2));
  verifyScanResult(table,scan,expected2,"Combined Prefix + Filter failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected2,"Combined Prefix + Filter; removing Prefix failed");
  scan.setFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after Filter reset failed");
  scan=new Scan();
  scan.setFilter(new ColumnPrefixFilter(prefix2));
  verifyScanResult(table,scan,expected2,"Test filter failed");
  scan.setRowPrefixFilter(prefix1);
  verifyScanResult(table,scan,expected2,"Combined Filter + Prefix failed");
  scan.setFilter(null);
  verifyScanResult(table,scan,expected1,"Combined Filter + Prefix ; removing Filter failed");
  scan.setRowPrefixFilter(null);
  verifyScanResult(table,scan,expected0,"Scan after prefix reset failed");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.filter.TestSingleColumnValueFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests serialization
 * @throws Exception
 */
@Test public void testSerialization() throws Exception {
  Filter newFilter=serializationTest(basicFilter);
  basicFilterTests((SingleColumnValueFilter)newFilter);
  newFilter=serializationTest(nullFilter);
  nullFilterTests(newFilter);
  newFilter=serializationTest(substrFilter);
  substrFilterTests(newFilter);
  newFilter=serializationTest(regexFilter);
  regexFilterTests(newFilter);
  newFilter=serializationTest(regexPatternFilter);
  regexPatternFilterTests(newFilter);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests identification of the stop row
 * @throws Exception
 */
@Test public void testStop() throws Exception {
  basicFilterTests((SingleColumnValueFilter)basicFilter);
  nullFilterTests(nullFilter);
  substrFilterTests(substrFilter);
  regexFilterTests(regexFilter);
  regexPatternFilterTests(regexPatternFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHtmlQuoting </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRoundtrip() throws Exception {
  runRoundTrip("");
  runRoundTrip("<>&'\"");
  runRoundTrip("ab>cd<ef&ghi'\"");
  runRoundTrip("A string\n with no quotable chars in it!");
  runRoundTrip(null);
  StringBuilder buffer=new StringBuilder();
  for (char ch=0; ch < 127; ++ch) {
    buffer.append(ch);
  }
  runRoundTrip(buffer.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpServer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HTTPServer.Builder should proceed if a external connector is available.
 */
@Test public void testHttpServerBuilderWithExternalConnector() throws Exception {
  Connector c=mock(Connector.class);
  doReturn("localhost").when(c).getHost();
  HttpServer s=new HttpServer.Builder().setName("test").setConnector(c).build();
  s.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpServerLifecycle </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Test that the server is not alive once stopped
 * @throws Throwable on failure
 */
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testStoppingTwiceServerIsAllowed() throws Throwable {
  HttpServer server=createAndStartTestServer();
  assertAlive(server);
  stop(server);
  assertNotLive(server);
  stop(server);
  assertNotLive(server);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Test that the server is alive once started
 * @throws Throwable on failure
 */
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testCreatedServerIsNotAlive() throws Throwable {
  HttpServer server=createTestServer();
  assertNotLive(server);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testStopUnstartedServer() throws Throwable {
  HttpServer server=createTestServer();
  stop(server);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Test that the server is not alive once stopped
 * @throws Throwable on failure
 */
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testStoppedServerIsNotAlive() throws Throwable {
  HttpServer server=createAndStartTestServer();
  assertAlive(server);
  stop(server);
  assertNotLive(server);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Test that the server is alive once started
 * @throws Throwable on failure
 */
@Ignore("Hangs on occasion; see HBASE-14430") @Test(timeout=60000) public void testStartedServerIsAlive() throws Throwable {
  HttpServer server=null;
  server=createTestServer();
  assertNotLive(server);
  server.start();
  assertAlive(server);
  stop(server);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.TestHttpServerWebapps </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that the test server is loadable on the classpath
 * @throws Throwable if something went wrong
 */
@Test public void testValidServerResource() throws Throwable {
  HttpServer server=null;
  try {
    server=createServer("test");
  }
  finally {
    stop(server);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.http.jmx.TestJMXJsonServlet </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery() throws Exception {
  String result=readOutput(new URL(baseUrl,"/jmx?qry=java.lang:type=Runtime"));
  LOG.info("/jmx?qry=java.lang:type=Runtime RESULT: " + result);
  assertReFind("\"name\"\\s*:\\s*\"java.lang:type=Runtime\"",result);
  assertReFind("\"modelerType\"",result);
  result=readOutput(new URL(baseUrl,"/jmx?qry=java.lang:type=Memory"));
  LOG.info("/jmx?qry=java.lang:type=Memory RESULT: " + result);
  assertReFind("\"name\"\\s*:\\s*\"java.lang:type=Memory\"",result);
  assertReFind("\"modelerType\"",result);
  result=readOutput(new URL(baseUrl,"/jmx"));
  LOG.info("/jmx RESULT: " + result);
  assertReFind("\"name\"\\s*:\\s*\"java.lang:type=Memory\"",result);
  result=readOutput(new URL(baseUrl,"/jmx?get=java.lang:type=Memory::HeapMemoryUsage"));
  LOG.info("/jmx RESULT: " + result);
  assertReFind("\"name\"\\s*:\\s*\"java.lang:type=Memory\"",result);
  assertReFind("\"committed\"\\s*:",result);
  result=readOutput(new URL(baseUrl,"/jmx?get=java.lang:type=Memory::"));
  LOG.info("/jmx RESULT: " + result);
  assertReFind("\"ERROR\"",result);
  result=readOutput(new URL(baseUrl,"/jmx?qry=java.lang:type=Memory&callback=mycallback1"));
  LOG.info("/jmx?qry=java.lang:type=Memory&callback=mycallback RESULT: " + result);
  assertReFind("^mycallback1\\(\\{",result);
  assertReFind("\\}\\);$",result);
  result=readOutput(new URL(baseUrl,"/jmx?get=java.lang:type=Memory::&callback=mycallback2"));
  LOG.info("/jmx RESULT: " + result);
  assertReFind("^mycallback2\\(\\{",result);
  assertReFind("\"ERROR\"",result);
  assertReFind("\\}\\);$",result);
  result=readOutput(new URL(baseUrl,"/jmx?get=java.lang:type=Memory::HeapMemoryUsage&callback=mycallback3"));
  LOG.info("/jmx RESULT: " + result);
  assertReFind("^mycallback3\\(\\{",result);
  assertReFind("\"name\"\\s*:\\s*\"java.lang:type=Memory\"",result);
  assertReFind("\"committed\"\\s*:",result);
  assertReFind("\\}\\);$",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.TestHalfStoreFileReader </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the scanner and reseek of a half hfile scanner. The scanner API
 * demands that seekTo and reseekTo() only return < 0 if the key lies
 * before the start of the file (with no position on the scanner). Returning
 * 0 if perfect match (rare), and return > 1 if we got an imperfect match.
 * The latter case being the most common, we should generally be returning 1,
 * and if we do, there may or may not be a 'next' in the scanner/file.
 * A bug in the half file scanner was returning -1 at the end of the bottom
 * half, and that was causing the infrastructure above to go null causing NPEs
 * and other problems.  This test reproduces that failure, and also tests
 * both the bottom and top of the file while we are at it.
 * @throws IOException
 */
@Test public void testHalfScanAndReseek() throws IOException {
  String root_dir=TEST_UTIL.getDataTestDir().toString();
  Path p=new Path(root_dir,"test");
  Configuration conf=TEST_UTIL.getConfiguration();
  FileSystem fs=FileSystem.get(conf);
  CacheConfig cacheConf=new CacheConfig(conf);
  HFileContext meta=new HFileContextBuilder().withBlockSize(1024).build();
  HFile.Writer w=HFile.getWriterFactory(conf,cacheConf).withPath(fs,p).withFileContext(meta).create();
  List<KeyValue> items=genSomeKeys();
  for (  KeyValue kv : items) {
    w.append(kv);
  }
  w.close();
  HFile.Reader r=HFile.createReader(fs,p,cacheConf,conf);
  r.loadFileInfo();
  Cell midKV=r.midkey();
  byte[] midkey=CellUtil.cloneRow(midKV);
  Reference bottom=new Reference(midkey,Reference.Range.bottom);
  doTestOfScanAndReseek(p,fs,bottom,cacheConf);
  Reference top=new Reference(midkey,Reference.Range.top);
  doTestOfScanAndReseek(p,fs,top,cacheConf);
  r.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.TestReference </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * See if we can parse a Reference that was written pre-0.96, i.e. a serialized Writable.
 * Exercises the code path that parses Writables.
 * @throws IOException
 */
@Test public void testParsingWritableReference() throws IOException {
  final String datafile=System.getProperty("test.build.classes","target/test-classes") + File.separator + "a6a6562b777440fd9c34885428f5cb61.21e75333ada3d5bafb34bb918f29576c";
  FileSystem fs=FileSystem.get(HTU.getConfiguration());
  Reference.read(fs,new Path(datafile));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.crypto.TestEncryption </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTypicalHFileBlocks() throws Exception {
  byte[] key=new byte[16];
  Bytes.random(key);
  byte[] iv=new byte[16];
  Bytes.random(iv);
  for (  int size : new int[]{4 * 1024,8 * 1024,64 * 1024,128 * 1024}) {
    checkTransformSymmetry(key,iv,getRandomBlock(size));
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOddSizedBlocks() throws Exception {
  byte[] key=new byte[16];
  Bytes.random(key);
  byte[] iv=new byte[16];
  Bytes.random(iv);
  for (  int size : new int[]{3,7,11,23,47,79,119,175}) {
    checkTransformSymmetry(key,iv,getRandomBlock(size));
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLargeBlocks() throws Exception {
  byte[] key=new byte[16];
  Bytes.random(key);
  byte[] iv=new byte[16];
  Bytes.random(iv);
  for (  int size : new int[]{256 * 1024,512 * 1024,1024 * 1024}) {
    checkTransformSymmetry(key,iv,getRandomBlock(size));
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSmallBlocks() throws Exception {
  byte[] key=new byte[16];
  Bytes.random(key);
  byte[] iv=new byte[16];
  Bytes.random(iv);
  for (  int size : new int[]{4,8,16,32,64,128,256,512}) {
    checkTransformSymmetry(key,iv,getRandomBlock(size));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestChangingEncoding </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrazyRandomChanges() throws Exception {
  prepareTest("RandomChanges");
  Random rand=new Random(2934298742974297L);
  for (int i=0; i < 20; ++i) {
    int encodingOrdinal=rand.nextInt(DataBlockEncoding.values().length);
    DataBlockEncoding encoding=DataBlockEncoding.values()[encodingOrdinal];
    setEncodingConf(encoding,rand.nextBoolean());
    writeSomeNewData();
    verifyAllData();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TIMEOUT_MS) public void testChangingEncodingWithCompaction() throws Exception {
  prepareTest("ChangingEncodingWithCompaction");
  for (  boolean onlineChange : new boolean[]{false,true}) {
    for (    DataBlockEncoding encoding : ENCODINGS_TO_ITERATE) {
      setEncodingConf(encoding,onlineChange);
      writeSomeNewData();
      verifyAllData();
      compactAndWait();
      verifyAllData();
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TIMEOUT_MS) public void testChangingEncoding() throws Exception {
  prepareTest("ChangingEncoding");
  for (  boolean onlineChange : new boolean[]{false,true}) {
    for (    DataBlockEncoding encoding : ENCODINGS_TO_ITERATE) {
      setEncodingConf(encoding,onlineChange);
      writeSomeNewData();
      verifyAllData();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestDataBlockEncoders </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test whether compression -> decompression gives the consistent results on
 * pseudorandom sample.
 * @throws IOException On test failure.
 */
@Test public void testExecutionOnSample() throws IOException {
  List<KeyValue> kvList=generator.generateTestKeyValues(NUMBER_OF_KV,includesTags);
  testEncodersOnDataset(kvList,includesMemstoreTS,includesTags);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test seeking while file is encoded.
 */
@Test public void testSeekingOnSample() throws IOException {
  List<KeyValue> sampleKv=generator.generateTestKeyValues(NUMBER_OF_KV,includesTags);
  List<DataBlockEncoder.EncodedSeeker> encodedSeekers=new ArrayList<DataBlockEncoder.EncodedSeeker>();
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    LOG.info("Encoding: " + encoding);
    if (this.useOffheapData && encoding == DataBlockEncoding.PREFIX_TREE)     continue;
    DataBlockEncoder encoder=encoding.getEncoder();
    if (encoder == null) {
      continue;
    }
    LOG.info("Encoder: " + encoder);
    ByteBuffer encodedBuffer=encodeKeyValues(encoding,sampleKv,getEncodingContext(Compression.Algorithm.NONE,encoding),this.useOffheapData);
    HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTags).withCompression(Compression.Algorithm.NONE).build();
    DataBlockEncoder.EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
    seeker.setCurrentBuffer(new SingleByteBuff(encodedBuffer));
    encodedSeekers.add(seeker);
  }
  LOG.info("Testing it!");
  for (  boolean seekBefore : new boolean[]{false,true}) {
    for (int i=0; i < NUM_RANDOM_SEEKS; ++i) {
      int keyValueId;
      if (!seekBefore) {
        keyValueId=randomizer.nextInt(sampleKv.size());
      }
 else {
        keyValueId=randomizer.nextInt(sampleKv.size() - 1) + 1;
      }
      KeyValue keyValue=sampleKv.get(keyValueId);
      checkSeekingConsistency(encodedSeekers,seekBefore,keyValue);
    }
  }
  LOG.info("Checking edge cases");
  checkSeekingConsistency(encodedSeekers,false,sampleKv.get(0));
  for (  boolean seekBefore : new boolean[]{false,true}) {
    checkSeekingConsistency(encodedSeekers,seekBefore,sampleKv.get(sampleKv.size() - 1));
    KeyValue midKv=sampleKv.get(sampleKv.size() / 2);
    Cell lastMidKv=CellUtil.createLastOnRowCol(midKv);
    checkSeekingConsistency(encodedSeekers,seekBefore,lastMidKv);
  }
  LOG.info("Done");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testZeroByte() throws IOException {
  List<KeyValue> kvList=new ArrayList<KeyValue>();
  byte[] row=Bytes.toBytes("abcd");
  byte[] family=new byte[]{'f'};
  byte[] qualifier0=new byte[]{'b'};
  byte[] qualifier1=new byte[]{'c'};
  byte[] value0=new byte[]{'d'};
  byte[] value1=new byte[]{0x00};
  if (includesTags) {
    kvList.add(new KeyValue(row,family,qualifier0,0,value0,new Tag[]{new ArrayBackedTag((byte)1,"value1")}));
    kvList.add(new KeyValue(row,family,qualifier1,0,value1,new Tag[]{new ArrayBackedTag((byte)1,"value1")}));
  }
 else {
    kvList.add(new KeyValue(row,family,qualifier0,0,Type.Put,value0));
    kvList.add(new KeyValue(row,family,qualifier1,0,Type.Put,value1));
  }
  testEncodersOnDataset(kvList,includesMemstoreTS,includesTags);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test data block encoding of empty KeyValue.
 * @throws IOExceptionOn test failure.
 */
@Test public void testEmptyKeyValues() throws IOException {
  List<KeyValue> kvList=new ArrayList<KeyValue>();
  byte[] row=new byte[0];
  byte[] family=new byte[0];
  byte[] qualifier=new byte[0];
  byte[] value=new byte[0];
  if (!includesTags) {
    kvList.add(new KeyValue(row,family,qualifier,0l,value));
    kvList.add(new KeyValue(row,family,qualifier,0l,value));
  }
 else {
    byte[] metaValue1=Bytes.toBytes("metaValue1");
    byte[] metaValue2=Bytes.toBytes("metaValue2");
    kvList.add(new KeyValue(row,family,qualifier,0l,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue1)}));
    kvList.add(new KeyValue(row,family,qualifier,0l,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue2)}));
  }
  testEncodersOnDataset(kvList,includesMemstoreTS,includesTags);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test KeyValues with negative timestamp.
 * @throws IOExceptionOn test failure.
 */
@Test public void testNegativeTimestamps() throws IOException {
  List<KeyValue> kvList=new ArrayList<KeyValue>();
  byte[] row=new byte[0];
  byte[] family=new byte[0];
  byte[] qualifier=new byte[0];
  byte[] value=new byte[0];
  if (includesTags) {
    byte[] metaValue1=Bytes.toBytes("metaValue1");
    byte[] metaValue2=Bytes.toBytes("metaValue2");
    kvList.add(new KeyValue(row,family,qualifier,0l,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue1)}));
    kvList.add(new KeyValue(row,family,qualifier,0l,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue2)}));
  }
 else {
    kvList.add(new KeyValue(row,family,qualifier,-1l,Type.Put,value));
    kvList.add(new KeyValue(row,family,qualifier,-2l,Type.Put,value));
  }
  testEncodersOnDataset(kvList,includesMemstoreTS,includesTags);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestLoadAndSwitchEncodeOnDisk </h4><pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TIMEOUT_MS) public void loadTest() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  compression=Compression.Algorithm.GZ;
  super.loadTest();
  HColumnDescriptor hcd=getColumnDesc(admin);
  System.err.println("\nDisabling encode-on-disk. Old column descriptor: " + hcd + "\n");
  Table t=TEST_UTIL.getConnection().getTable(TABLE);
  assertAllOnLine(t);
  admin.disableTable(TABLE);
  admin.modifyColumnFamily(TABLE,hcd);
  System.err.println("\nRe-enabling table\n");
  admin.enableTable(TABLE);
  System.err.println("\nNew column descriptor: " + getColumnDesc(admin) + "\n");
  assertAllOnLine(t);
  System.err.println("\nCompacting the table\n");
  admin.majorCompact(TABLE);
  Threads.sleepWithoutInterrupt(5000);
  HRegionServer rs=TEST_UTIL.getMiniHBaseCluster().getRegionServer(0);
  while (rs.compactSplitThread.getCompactionQueueSize() > 0) {
    Threads.sleep(50);
  }
  System.err.println("\nDone with the test, shutting down the cluster\n");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestPrefixTreeEncoding </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekWithRandomData() throws Exception {
  PrefixTreeCodec encoder=new PrefixTreeCodec();
  ByteArrayOutputStream baosInMemory=new ByteArrayOutputStream();
  DataOutputStream userDataStream=new DataOutputStream(baosInMemory);
  int batchId=numBatchesWritten++;
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(false).withIncludesTags(includesTag).withCompression(Algorithm.NONE).build();
  HFileBlockEncodingContext blkEncodingCtx=new HFileBlockDefaultEncodingContext(DataBlockEncoding.PREFIX_TREE,new byte[0],meta);
  generateRandomTestData(kvset,batchId,includesTag,encoder,blkEncodingCtx,userDataStream);
  EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  byte[] onDiskBytes=baosInMemory.toByteArray();
  ByteBuffer readBuffer=ByteBuffer.wrap(onDiskBytes,DataBlockEncoding.ID_SIZE,onDiskBytes.length - DataBlockEncoding.ID_SIZE);
  verifySeeking(seeker,readBuffer,batchId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekWithFixedData() throws Exception {
  PrefixTreeCodec encoder=new PrefixTreeCodec();
  int batchId=numBatchesWritten++;
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(false).withIncludesTags(includesTag).withCompression(Algorithm.NONE).build();
  HFileBlockEncodingContext blkEncodingCtx=new HFileBlockDefaultEncodingContext(DataBlockEncoding.PREFIX_TREE,new byte[0],meta);
  ByteArrayOutputStream baosInMemory=new ByteArrayOutputStream();
  DataOutputStream userDataStream=new DataOutputStream(baosInMemory);
  generateFixedTestData(kvset,batchId,includesTag,encoder,blkEncodingCtx,userDataStream);
  EncodedSeeker seeker=encoder.createSeeker(CellComparator.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  byte[] onDiskBytes=baosInMemory.toByteArray();
  ByteBuffer readBuffer=ByteBuffer.wrap(onDiskBytes,DataBlockEncoding.ID_SIZE,onDiskBytes.length - DataBlockEncoding.ID_SIZE);
  verifySeeking(seeker,readBuffer,batchId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.encoding.TestSeekToBlockWithEncoders </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekToBlockWithDiffQualifer() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aab"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  seekToTheKey(kv5,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test seeking while file is encoded.
 */
@Test public void testSeekingToBlockWithBiggerNonLength1() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aab"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv3=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv3);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aad"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aaaad"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aaaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  seekToTheKey(kv1,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test seeking while file is encoded.
 */
@Test public void testSeekToBlockWithDecreasingCommonPrefix() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("row10aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("row10aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv3=new KeyValue(Bytes.toBytes("row10aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q3"),Bytes.toBytes("val"));
  sampleKv.add(kv3);
  KeyValue kv4=new KeyValue(Bytes.toBytes("row11baa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  Cell toSeek=CellUtil.createLastOnRow(kv3);
  seekToTheKey(kv3,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekToBlockWithDiffQualiferOnSameRow1() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q3"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q4"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue kv6=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("z5"),Bytes.toBytes("val"));
  sampleKv.add(kv6);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q5"),Bytes.toBytes("val"));
  seekToTheKey(kv5,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test seeking while file is encoded.
 */
@Test public void testSeekingToBlockToANotAvailableKey() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aab"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv3=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv3);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aaae"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("bbbcd"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("bbbce"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  seekToTheKey(kv5,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test seeking while file is encoded.
 */
@Test public void testSeekToBlockWithNonMatchingSeekKey() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aab"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv3=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv3);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aad"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("bba"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aae"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  seekToTheKey(kv4,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekToBlockWithDiffFamilyAndQualifer() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("fam1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aab"),Bytes.toBytes("fam1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("fam1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("fam1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aac"),Bytes.toBytes("fam2"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  seekToTheKey(kv5,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekToBlockWithDiffQualiferOnSameRowButDescendingInSize() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qual1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qual2"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qual3"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qual4"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue kv6=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qz"),Bytes.toBytes("val"));
  sampleKv.add(kv6);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("qz"),Bytes.toBytes("val"));
  seekToTheKey(kv6,sampleKv,toSeek);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekToBlockWithDiffQualiferOnSameRow() throws IOException {
  List<KeyValue> sampleKv=new ArrayList<KeyValue>();
  KeyValue kv1=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q1"),Bytes.toBytes("val"));
  sampleKv.add(kv1);
  KeyValue kv2=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q2"),Bytes.toBytes("val"));
  sampleKv.add(kv2);
  KeyValue kv4=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q3"),Bytes.toBytes("val"));
  sampleKv.add(kv4);
  KeyValue kv5=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q4"),Bytes.toBytes("val"));
  sampleKv.add(kv5);
  KeyValue kv6=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q5"),Bytes.toBytes("val"));
  sampleKv.add(kv6);
  KeyValue toSeek=new KeyValue(Bytes.toBytes("aaa"),Bytes.toBytes("f1"),Bytes.toBytes("q5"),Bytes.toBytes("val"));
  seekToTheKey(kv6,sampleKv,toSeek);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestCacheConfig </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnHeapBucketCacheConfig(){
  this.conf.set(HConstants.BUCKET_CACHE_IOENGINE_KEY,"heap");
  doBucketCacheConfigTest();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFileBucketCacheConfig() throws IOException {
  HBaseTestingUtility htu=new HBaseTestingUtility(this.conf);
  try {
    Path p=new Path(htu.getDataTestDir(),"bc.txt");
    FileSystem fs=FileSystem.get(this.conf);
    fs.create(p).close();
    this.conf.set(HConstants.BUCKET_CACHE_IOENGINE_KEY,"file:" + p);
    doBucketCacheConfigTest();
  }
  finally {
    htu.cleanupTestDir();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Assert that the caches are deployed with CombinedBlockCache and of the appropriate sizes.
 */
@Test public void testOffHeapBucketCacheConfig(){
  this.conf.set(HConstants.BUCKET_CACHE_IOENGINE_KEY,"offheap");
  doBucketCacheConfigTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestCacheOnWrite </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreFileCacheOnWrite() throws IOException {
  testStoreFileCacheOnWriteInternals(false);
  testStoreFileCacheOnWriteInternals(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNotCachingDataBlocksDuringCompaction() throws IOException, InterruptedException {
  testNotCachingDataBlocksDuringCompactionInternals(false);
  testNotCachingDataBlocksDuringCompactionInternals(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestChecksum </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test different values of bytesPerChecksum
 */
@Test public void testChecksumChunks() throws IOException {
  testChecksumInternals(false);
  testChecksumInternals(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Introduce checksum failures and check that we can still read
 * the data
 */
@Test public void testChecksumCorruption() throws IOException {
  testChecksumCorruptionInternals(false);
  testChecksumCorruptionInternals(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFile </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaBlocks() throws Exception {
  metablocks("none");
  metablocks("gz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTFileFeatures() throws IOException {
  testHFilefeaturesInternals(false);
  testHFilefeaturesInternals(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlock </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPreviousOffset() throws IOException {
  testPreviousOffsetInternals();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcurrentReading() throws Exception {
  testConcurrentReadingInternals();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlockHeapSize(){
  testBlockHeapSizeInternals();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReaderV2() throws IOException {
  testReaderV2Internals();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test encoding/decoding data blocks.
 * @throws IOException a bug or a problem with temporary files.
 */
@Test public void testDataBlockEncoding() throws IOException {
  testInternals();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockIndex </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlockIndex() throws IOException {
  testBlockIndexInternals(false);
  clear();
  testBlockIndexInternals(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileBlockPositionalRead </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPositionalReadPrematureEOF() throws IOException {
  long position=0;
  int bufOffset=0;
  int necessaryLen=10;
  int extraLen=0;
  int totalLen=necessaryLen + extraLen;
  byte[] buf=new byte[totalLen];
  FSDataInputStream in=mock(FSDataInputStream.class);
  when(in.read(position,buf,bufOffset,totalLen)).thenReturn(9);
  when(in.read(position,buf,bufOffset,totalLen)).thenReturn(-1);
  exception.expect(IOException.class);
  exception.expectMessage("EOF");
  HFileBlock.positionalReadWithExtra(in,position,buf,bufOffset,necessaryLen,extraLen);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileDataBlockEncoder </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test encoding.
 * @throws IOException
 */
@Test public void testEncoding() throws IOException {
  testEncodingInternals(false);
  testEncodingInternals(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for HBASE-5746. 
 */
@Test public void testHeaderSizeInCacheWithoutChecksum() throws Exception {
  testHeaderSizeInCacheWithoutChecksumInternals(false);
  testHeaderSizeInCacheWithoutChecksumInternals(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test putting and taking out blocks into cache with different
 * encoding options.
 */
@Test public void testEncodingWithCache() throws IOException {
  testEncodingWithCacheInternals(false);
  testEncodingWithCacheInternals(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileEncryption </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=20000) public void testDataBlockEncryption() throws IOException {
  final int blocks=10;
  final int[] blockSizes=new int[blocks];
  for (int i=0; i < blocks; i++) {
    blockSizes[i]=(1024 + RNG.nextInt(1024 * 63)) / Bytes.SIZEOF_INT;
  }
  for (  Compression.Algorithm compression : TestHFileBlock.COMPRESSION_ALGORITHMS) {
    Path path=new Path(TEST_UTIL.getDataTestDir(),"block_v3_" + compression + "_AES");
    LOG.info("testDataBlockEncryption: encryption=AES compression=" + compression);
    long totalSize=0;
    HFileContext fileContext=new HFileContextBuilder().withCompression(compression).withEncryptionContext(cryptoContext).build();
    FSDataOutputStream os=fs.create(path);
    try {
      for (int i=0; i < blocks; i++) {
        totalSize+=writeBlock(os,fileContext,blockSizes[i]);
      }
    }
  finally {
      os.close();
    }
    FSDataInputStream is=fs.open(path);
    try {
      HFileBlock.FSReaderImpl hbr=new HFileBlock.FSReaderImpl(is,totalSize,fileContext);
      long pos=0;
      for (int i=0; i < blocks; i++) {
        pos+=readAndVerifyBlock(pos,fileContext,hbr,blockSizes[i]);
      }
    }
  finally {
      is.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileInlineToRootChunkConversion </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWriteHFile() throws Exception {
  Path hfPath=new Path(testUtil.getDataTestDir(),TestHFileInlineToRootChunkConversion.class.getSimpleName() + ".hfile");
  int maxChunkSize=1024;
  FileSystem fs=FileSystem.get(conf);
  CacheConfig cacheConf=new CacheConfig(conf);
  conf.setInt(HFileBlockIndex.MAX_CHUNK_SIZE_KEY,maxChunkSize);
  HFileContext context=new HFileContextBuilder().withBlockSize(16).build();
  HFile.Writer hfw=new HFile.WriterFactory(conf,cacheConf).withFileContext(context).withPath(fs,hfPath).create();
  List<byte[]> keys=new ArrayList<byte[]>();
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 4; ++i) {
    sb.append("key" + String.format("%05d",i));
    sb.append("_");
    for (int j=0; j < 100; ++j) {
      sb.append('0' + j);
    }
    String keyStr=sb.toString();
    sb.setLength(0);
    byte[] k=Bytes.toBytes(keyStr);
    keys.add(k);
    byte[] v=Bytes.toBytes("value" + i);
    hfw.append(CellUtil.createCell(k,v));
  }
  hfw.close();
  HFile.Reader reader=HFile.createReader(fs,hfPath,cacheConf,conf);
  HFileScanner scanner=reader.getScanner(true,true);
  for (int i=0; i < keys.size(); ++i) {
    scanner.seekTo(CellUtil.createCell(keys.get(i)));
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestHFileWriterV3 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMidKeyInHFile() throws IOException {
  testMidKeyInHFileInternals(useTags);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHFileFormatV3() throws IOException {
  testHFileFormatV3Internals(useTags);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestPrefetch </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testPrefetch() throws Exception {
  Path storeFile=writeStoreFile();
  readStoreFile(storeFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestReseekTo </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReseekTo() throws Exception {
  testReseekToInternals(TagUsage.NO_TAG);
  testReseekToInternals(TagUsage.ONLY_TAG);
  testReseekToInternals(TagUsage.PARTIAL_TAG);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.TestSeekTo </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekTo() throws Exception {
  testSeekToInternals(TagUsage.NO_TAG);
  testSeekToInternals(TagUsage.ONLY_TAG);
  testSeekToInternals(TagUsage.PARTIAL_TAG);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekBeforeWithReSeekTo() throws Exception {
  testSeekBeforeWithReSeekToInternals(TagUsage.NO_TAG);
  testSeekBeforeWithReSeekToInternals(TagUsage.ONLY_TAG);
  testSeekBeforeWithReSeekToInternals(TagUsage.PARTIAL_TAG);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlockContainingKey() throws Exception {
  testBlockContainingKeyInternals(TagUsage.NO_TAG);
  testBlockContainingKeyInternals(TagUsage.ONLY_TAG);
  testBlockContainingKeyInternals(TagUsage.PARTIAL_TAG);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeekBefore() throws Exception {
  testSeekBeforeInternals(TagUsage.NO_TAG);
  testSeekBeforeInternals(TagUsage.ONLY_TAG);
  testSeekBeforeInternals(TagUsage.PARTIAL_TAG);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestBucketCache </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCacheSimple() throws Exception {
  CacheTestUtils.testCacheSimple(cache,BLOCK_SIZE,NUM_QUERIES);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCacheMultiThreadedSingleKey() throws Exception {
  CacheTestUtils.hammerSingleKey(cache,BLOCK_SIZE,2 * NUM_THREADS,2 * NUM_QUERIES);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHeapSizeChanges() throws Exception {
  cache.stopWriterThreads();
  CacheTestUtils.testHeapSizeChanges(cache,BLOCK_SIZE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.io.hfile.bucket.TestBucketWriterThread </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pass through a too big entry and ensure it is cleared from queues and ramCache.
 * Manually run the WriterThread.
 * @throws InterruptedException
 */
@Test public void testTooBigEntry() throws InterruptedException {
  Cacheable tooBigCacheable=Mockito.mock(Cacheable.class);
  Mockito.when(tooBigCacheable.getSerializedLength()).thenReturn(Integer.MAX_VALUE);
  this.bc.cacheBlock(this.plainKey,tooBigCacheable);
  doDrainOfOneEntry(this.bc,this.wt,this.q);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test non-error case just works.
 * @throws FileNotFoundException
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=30000) public void testNonErrorCase() throws IOException, InterruptedException {
  bc.cacheBlock(this.plainKey,this.plainCacheable);
  doDrainOfOneEntry(this.bc,this.wt,this.q);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Do Cache full exception
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=30000) public void testCacheFullException() throws IOException, InterruptedException {
  this.bc.cacheBlock(this.plainKey,plainCacheable);
  RAMQueueEntry rqe=q.remove();
  RAMQueueEntry spiedRqe=Mockito.spy(rqe);
  final CacheFullException cfe=new CacheFullException(0,0);
  BucketEntry mockedBucketEntry=Mockito.mock(BucketEntry.class);
  Mockito.doThrow(cfe).doReturn(mockedBucketEntry).when(spiedRqe).writeToCache((IOEngine)Mockito.any(),(BucketAllocator)Mockito.any(),(UniqueIndexMap<Integer>)Mockito.any(),(AtomicLong)Mockito.any());
  this.q.add(spiedRqe);
  doDrainOfOneEntry(bc,wt,q);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.AbstractTestIPC </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the rpc scheduler is called when requests arrive. 
 */
@Test public void testRpcScheduler() throws IOException, InterruptedException {
  RpcScheduler scheduler=spy(new FifoRpcScheduler(CONF,1));
  RpcServer rpcServer=new TestRpcServer(scheduler);
  verify(scheduler).init((RpcScheduler.Context)anyObject());
  AbstractRpcClient client=createRpcClient(CONF);
  try {
    rpcServer.start();
    verify(scheduler).start();
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    for (int i=0; i < 10; i++) {
      client.call(new PayloadCarryingRpcController(CellUtil.createCellScanner(ImmutableList.<Cell>of(CELL))),md,param,md.getOutputType().toProto(),User.getCurrent(),address,new MetricsConnection.CallStats());
    }
    verify(scheduler,times(10)).dispatch((CallRunner)anyObject());
  }
  finally {
    rpcServer.stop();
    verify(scheduler).stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.IntegrationTestRpcClient </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Test(timeout=900000) @Ignore public void testRpcWithChaosMonkeyWithAsyncClient() throws Throwable {
  for (int i=0; i < numIterations; i++) {
    TimeoutThread.runWithTimeout(new Callable<Void>(){
      @Override public Void call() throws Exception {
        try {
          testRpcWithChaosMonkey(false);
        }
 catch (        Throwable e) {
          if (e instanceof Exception) {
            throw (Exception)e;
          }
 else {
            throw new Exception(e);
          }
        }
        return null;
      }
    }
,90000);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=900000) public void testRpcWithChaosMonkeyWithSyncClient() throws Throwable {
  for (int i=0; i < numIterations; i++) {
    TimeoutThread.runWithTimeout(new Callable<Void>(){
      @Override public Void call() throws Exception {
        try {
          testRpcWithChaosMonkey(true);
        }
 catch (        Throwable e) {
          if (e instanceof Exception) {
            throw (Exception)e;
          }
 else {
            throw new Exception(e);
          }
        }
        return null;
      }
    }
,90000);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestAsyncIPC </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsyncConnectionSetup() throws Exception {
  TestRpcServer rpcServer=new TestRpcServer();
  AsyncRpcClient client=createRpcClient(CONF);
  try {
    rpcServer.start();
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    RpcChannel channel=client.createRpcChannel(ServerName.valueOf(address.getHostName(),address.getPort(),System.currentTimeMillis()),User.getCurrent(),0);
    final AtomicBoolean done=new AtomicBoolean(false);
    channel.callMethod(md,new PayloadCarryingRpcController(),param,md.getOutputType().toProto(),new RpcCallback<Message>(){
      @Override public void run(      Message parameter){
        done.set(true);
      }
    }
);
    TEST_UTIL.waitFor(1000,new Waiter.Predicate<Exception>(){
      @Override public boolean evaluate() throws Exception {
        return done.get();
      }
    }
);
  }
  finally {
    client.close();
    rpcServer.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestBufferChain </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChainChunkBiggerThanSomeArrays() throws IOException {
  ByteBuffer[] bufs=wrapArrays(HELLO_WORLD_CHUNKS);
  BufferChain chain=new BufferChain(bufs);
  writeAndVerify(chain,"hello world",3);
  assertNoRemaining(bufs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChainChunkBiggerThanWholeArray() throws IOException {
  ByteBuffer[] bufs=wrapArrays(HELLO_WORLD_CHUNKS);
  BufferChain chain=new BufferChain(bufs);
  writeAndVerify(chain,"hello world",8192);
  assertNoRemaining(bufs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitOffset() throws IOException {
  ByteBuffer[] bufs=new ByteBuffer[]{stringBuf("XXXhelloYYY",3,5),stringBuf(" ",0,1),stringBuf("XXXXworldY",4,5)};
  BufferChain chain=new BufferChain(bufs);
  writeAndVerify(chain,"hello world",3);
  assertNoRemaining(bufs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestCallRunner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Does nothing but exercise a {@link CallRunner} outside of {@link RpcServer} context.
 */
@Test public void testSimpleCall(){
  RpcServerInterface mockRpcServer=Mockito.mock(RpcServerInterface.class);
  Mockito.when(mockRpcServer.isStarted()).thenReturn(true);
  RpcServer.Call mockCall=Mockito.mock(RpcServer.Call.class);
  mockCall.connection=Mockito.mock(RpcServer.Connection.class);
  CallRunner cr=new CallRunner(mockRpcServer,mockCall);
  cr.setStatus(new MonitoredRPCHandlerImpl());
  cr.run();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestIPCUtil </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuildCellBlock() throws IOException {
  doBuildCellBlockUndoCellBlock(this.util,new KeyValueCodec(),null);
  doBuildCellBlockUndoCellBlock(this.util,new KeyValueCodec(),new DefaultCodec());
  doBuildCellBlockUndoCellBlock(this.util,new KeyValueCodec(),new GzipCodec());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestRpcHandlerException </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testRpcScheduler() throws IOException, InterruptedException {
  PriorityFunction qosFunction=mock(PriorityFunction.class);
  Abortable abortable=new AbortServer();
  RpcScheduler scheduler=new SimpleRpcScheduler(CONF,2,0,0,qosFunction,abortable,0);
  RpcServer rpcServer=new TestRpcServer(scheduler);
  RpcClientImpl client=new RpcClientImpl(CONF,HConstants.CLUSTER_ID_DEFAULT);
  try {
    rpcServer.start();
    MethodDescriptor md=SERVICE.getDescriptorForType().findMethodByName("echo");
    EchoRequestProto param=EchoRequestProto.newBuilder().setMessage("hello").build();
    PayloadCarryingRpcController controller=new PayloadCarryingRpcController(CellUtil.createCellScanner(ImmutableList.of(CELL)));
    InetSocketAddress address=rpcServer.getListenerAddress();
    if (address == null) {
      throw new IOException("Listener channel is closed");
    }
    client.call(controller,md,param,md.getOutputType().toProto(),User.getCurrent(),address,new MetricsConnection.CallStats());
  }
 catch (  Throwable e) {
    assert (abortable.isAborted() == true);
  }
 finally {
    rpcServer.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestRpcMetrics </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This test makes sure that the numbers from a MetricsHBaseServerWrapper are correctly exported
 * to hadoop metrics 2 system.
 */
@Test public void testWrapperSource(){
  MetricsHBaseServer mrpc=new MetricsHBaseServer("HMaster",new MetricsHBaseServerWrapperStub());
  MetricsHBaseServerSource serverSource=mrpc.getMetricsSource();
  HELPER.assertGauge("queueSize",101,serverSource);
  HELPER.assertGauge("numCallsInGeneralQueue",102,serverSource);
  HELPER.assertGauge("numCallsInReplicationQueue",103,serverSource);
  HELPER.assertGauge("numCallsInPriorityQueue",104,serverSource);
  HELPER.assertGauge("numOpenConnections",105,serverSource);
  HELPER.assertGauge("numActiveHandler",106,serverSource);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test to make sure that all the actively called method on MetricsHBaseServer work.
 */
@Test public void testSourceMethods(){
  MetricsHBaseServer mrpc=new MetricsHBaseServer("HMaster",new MetricsHBaseServerWrapperStub());
  MetricsHBaseServerSource serverSource=mrpc.getMetricsSource();
  for (int i=0; i < 12; i++) {
    mrpc.authenticationFailure();
  }
  for (int i=0; i < 13; i++) {
    mrpc.authenticationSuccess();
  }
  HELPER.assertCounter("authenticationFailures",12,serverSource);
  HELPER.assertCounter("authenticationSuccesses",13,serverSource);
  for (int i=0; i < 14; i++) {
    mrpc.authorizationSuccess();
  }
  for (int i=0; i < 15; i++) {
    mrpc.authorizationFailure();
  }
  HELPER.assertCounter("authorizationSuccesses",14,serverSource);
  HELPER.assertCounter("authorizationFailures",15,serverSource);
  mrpc.dequeuedCall(100);
  mrpc.processedCall(101);
  mrpc.totalCall(102);
  HELPER.assertCounter("queueCallTime_NumOps",1,serverSource);
  HELPER.assertCounter("processCallTime_NumOps",1,serverSource);
  HELPER.assertCounter("totalCallTime_NumOps",1,serverSource);
  mrpc.sentBytes(103);
  mrpc.sentBytes(103);
  mrpc.sentBytes(103);
  mrpc.receivedBytes(104);
  mrpc.receivedBytes(104);
  HELPER.assertCounter("sentBytes",309,serverSource);
  HELPER.assertCounter("receivedBytes",208,serverSource);
  mrpc.receivedRequest(105);
  mrpc.sentResponse(106);
  HELPER.assertCounter("requestSize_NumOps",1,serverSource);
  HELPER.assertCounter("responseSize_NumOps",1,serverSource);
  mrpc.exception(null);
  HELPER.assertCounter("exceptions",1,serverSource);
  mrpc.exception(new RegionMovedException(ServerName.parseServerName("localhost:60020"),100));
  mrpc.exception(new RegionTooBusyException());
  mrpc.exception(new OutOfOrderScannerNextException());
  mrpc.exception(new NotServingRegionException());
  HELPER.assertCounter("exceptions.RegionMovedException",1,serverSource);
  HELPER.assertCounter("exceptions.RegionTooBusyException",1,serverSource);
  HELPER.assertCounter("exceptions.OutOfOrderScannerNextException",1,serverSource);
  HELPER.assertCounter("exceptions.NotServingRegionException",1,serverSource);
  HELPER.assertCounter("exceptions",5,serverSource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.ipc.TestSimpleRpcScheduler </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBasic() throws IOException, InterruptedException {
  PriorityFunction qosFunction=mock(PriorityFunction.class);
  RpcScheduler scheduler=new SimpleRpcScheduler(conf,10,0,0,qosFunction,0);
  scheduler.init(CONTEXT);
  scheduler.start();
  CallRunner task=createMockTask();
  task.setStatus(new MonitoredRPCHandlerImpl());
  scheduler.dispatch(task);
  verify(task,timeout(1000)).run();
  scheduler.stop();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRpcScheduler() throws Exception {
  testRpcScheduler(SimpleRpcScheduler.CALL_QUEUE_TYPE_DEADLINE_CONF_VALUE);
  testRpcScheduler(SimpleRpcScheduler.CALL_QUEUE_TYPE_FIFO_CONF_VALUE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestDriver </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDriverMainMethod() throws Throwable {
  ProgramDriver programDriverMock=mock(ProgramDriver.class);
  Driver.setProgramDriver(programDriverMock);
  Driver.main(new String[]{});
  verify(programDriverMock).driver(Mockito.any(String[].class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestGroupingTableMap </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings({"deprecation","unchecked"}) public void shouldNotCallCollectonSinceFindUniqueKeyValueMoreThanOnes() throws Exception {
  GroupingTableMap gTableMap=null;
  try {
    Result result=mock(Result.class);
    Reporter reporter=mock(Reporter.class);
    gTableMap=new GroupingTableMap();
    Configuration cfg=new Configuration();
    cfg.set(GroupingTableMap.GROUP_COLUMNS,"familyA:qualifierA familyB:qualifierB");
    JobConf jobConf=new JobConf(cfg);
    gTableMap.configure(jobConf);
    byte[] row={};
    List<Cell> keyValues=ImmutableList.<Cell>of(new KeyValue(row,"familyA".getBytes(),"qualifierA".getBytes(),Bytes.toBytes("1111")),new KeyValue(row,"familyA".getBytes(),"qualifierA".getBytes(),Bytes.toBytes("2222")),new KeyValue(row,"familyB".getBytes(),"qualifierB".getBytes(),Bytes.toBytes("3333")));
    when(result.listCells()).thenReturn(keyValues);
    OutputCollector<ImmutableBytesWritable,Result> outputCollectorMock=mock(OutputCollector.class);
    gTableMap.map(null,result,outputCollectorMock,reporter);
    verify(result).listCells();
    verifyZeroInteractions(outputCollectorMock);
  }
  finally {
    if (gTableMap != null)     gTableMap.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings({"deprecation","unchecked"}) public void shouldCreateNewKeyAlthoughExtraKey() throws Exception {
  GroupingTableMap gTableMap=null;
  try {
    Result result=mock(Result.class);
    Reporter reporter=mock(Reporter.class);
    gTableMap=new GroupingTableMap();
    Configuration cfg=new Configuration();
    cfg.set(GroupingTableMap.GROUP_COLUMNS,"familyA:qualifierA familyB:qualifierB");
    JobConf jobConf=new JobConf(cfg);
    gTableMap.configure(jobConf);
    byte[] row={};
    List<Cell> keyValues=ImmutableList.<Cell>of(new KeyValue(row,"familyA".getBytes(),"qualifierA".getBytes(),Bytes.toBytes("1111")),new KeyValue(row,"familyB".getBytes(),"qualifierB".getBytes(),Bytes.toBytes("2222")),new KeyValue(row,"familyC".getBytes(),"qualifierC".getBytes(),Bytes.toBytes("3333")));
    when(result.listCells()).thenReturn(keyValues);
    OutputCollector<ImmutableBytesWritable,Result> outputCollectorMock=mock(OutputCollector.class);
    gTableMap.map(null,result,outputCollectorMock,reporter);
    verify(result).listCells();
    verify(outputCollectorMock,times(1)).collect(any(ImmutableBytesWritable.class),any(Result.class));
    verifyNoMoreInteractions(outputCollectorMock);
  }
  finally {
    if (gTableMap != null)     gTableMap.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestIdentityTableMap </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings({"deprecation","unchecked"}) public void shouldCollectPredefinedTimes() throws IOException {
  int recordNumber=999;
  Result resultMock=mock(Result.class);
  IdentityTableMap identityTableMap=null;
  try {
    Reporter reporterMock=mock(Reporter.class);
    identityTableMap=new IdentityTableMap();
    ImmutableBytesWritable bytesWritableMock=mock(ImmutableBytesWritable.class);
    OutputCollector<ImmutableBytesWritable,Result> outputCollectorMock=mock(OutputCollector.class);
    for (int i=0; i < recordNumber; i++)     identityTableMap.map(bytesWritableMock,resultMock,outputCollectorMock,reporterMock);
    verify(outputCollectorMock,times(recordNumber)).collect(Mockito.any(ImmutableBytesWritable.class),Mockito.any(Result.class));
  }
  finally {
    if (identityTableMap != null)     identityTableMap.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestRowCounter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings({"deprecation","unchecked"}) public void shouldRegInReportEveryIncomingRow() throws IOException {
  int iterationNumber=999;
  RowCounter.RowCounterMapper mapper=new RowCounter.RowCounterMapper();
  Reporter reporter=mock(Reporter.class);
  for (int i=0; i < iterationNumber; i++)   mapper.map(mock(ImmutableBytesWritable.class),mock(Result.class),mock(OutputCollector.class),reporter);
  Mockito.verify(reporter,times(iterationNumber)).incrCounter(any(Enum.class),anyInt());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestTableInputFormat </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming Scanner IOException failure using mapred api,
 * @throws IOException
 */
@Test public void testTableRecordReaderScannerFail() throws IOException {
  Table htable=createIOEScannerTable("table2".getBytes(),1);
  runTestMapred(htable);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify the example we present in javadocs on TableInputFormatBase
 */
@Test public void testExtensionOfTableInputFormatBase() throws IOException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase");
  final Table table=createTable(Bytes.toBytes("exampleTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleTIF.class);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeprecatedExtensionOfTableInputFormatBase() throws IOException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase, " + "as it was given in 0.98.");
  final Table table=createTable(Bytes.toBytes("exampleDeprecatedTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleDeprecatedTIF.class);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming NotServingRegionException using mapred api.
 * @throws org.apache.hadoop.hbase.DoNotRetryIOException
 */
@Test public void testTableRecordReaderScannerTimeout() throws IOException {
  Table htable=createDNRIOEScannerTable("table4".getBytes(),1);
  runTestMapred(htable);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming NotServingRegionException using mapred api.
 * @throws org.apache.hadoop.hbase.DoNotRetryIOException
 */
@Test(expected=org.apache.hadoop.hbase.NotServingRegionException.class) public void testTableRecordReaderScannerTimeoutTwice() throws IOException {
  Table htable=createDNRIOEScannerTable("table5".getBytes(),2);
  runTestMapred(htable);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming no errors using mapred api.
 * @throws IOException
 */
@Test public void testTableRecordReader() throws IOException {
  Table table=createTable("table1".getBytes());
  runTestMapred(table);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming Scanner IOException failure using mapred api,
 * @throws IOException
 */
@Test(expected=IOException.class) public void testTableRecordReaderScannerFailTwice() throws IOException {
  Table htable=createIOEScannerTable("table3".getBytes(),2);
  runTestMapred(htable);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJobConfigurableExtensionOfTableInputFormatBase() throws IOException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase, " + "using JobConfigurable.");
  final Table table=createTable(Bytes.toBytes("exampleJobConfigurableTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleJobConfigurableTIF.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapred.TestTableSnapshotInputFormat </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @Override public void testWithMapReduceMultiRegion() throws Exception {
  testWithMapReduce(UTIL,"testWithMapReduceMultiRegion",10,10,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @Override public void testWithMockedMapReduceMultiRegion() throws Exception {
  testWithMockedMapReduce(UTIL,"testWithMockedMapReduceMultiRegion",10,10);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @Override public void testWithMapReduceAndOfflineHBaseMultiRegion() throws Exception {
  testWithMapReduce(UTIL,"testWithMapReduceAndOfflineHBaseMultiRegion",10,10,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.IntegrationTestBulkLoad </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkLoad() throws Exception {
  runLoad();
  installSlowingCoproc();
  runCheck();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.IntegrationTestImportTsv </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGenerateAndLoad() throws Exception {
  LOG.info("Running test testGenerateAndLoad.");
  TableName table=TableName.valueOf(NAME + "-" + UUID.randomUUID());
  String cf="d";
  Path hfiles=new Path(util.getDataTestDirOnTestFS(table.getNameAsString()),"hfiles");
  Map<String,String> args=new HashMap<String,String>();
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  args.put(ImportTsv.COLUMNS_CONF_KEY,format("HBASE_ROW_KEY,HBASE_TS_KEY,%s:c1,%s:c2",cf,cf));
  args.put(TestImportTsv.DELETE_AFTER_LOAD_CONF,"false");
  util.createTable(table,new String[]{cf});
  Tool t=TestImportTsv.doMROnTableTest(util,table,cf,simple_tsv,args);
  doLoadIncrementalHFiles(hfiles,table);
  validateDeletedPartitionsFile(t.getConf());
  util.deleteTable(table);
  util.cleanupDataTestDirOnTestFS(table.getNameAsString());
  LOG.info("testGenerateAndLoad completed successfully.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.MultiTableInputFormatTestBase </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanEmptyToAPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,"app","apo");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanYZYToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("yzy",null,"zzz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanOBBToOPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("obb","opp","opo");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanEmptyToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,null,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TableSnapshotInputFormatTestBase </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMapReduceAndOfflineHBaseMultiRegion() throws Exception {
  testWithMapReduce(UTIL,"testWithMapReduceAndOfflineHBaseMultiRegion",10,8,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMapReduceMultiRegion() throws Exception {
  testWithMapReduce(UTIL,"testWithMapReduceMultiRegion",10,8,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMapReduceSingleRegion() throws Exception {
  testWithMapReduce(UTIL,"testWithMapReduceSingleRegion",1,1,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMockedMapReduceSingleRegion() throws Exception {
  testWithMockedMapReduce(UTIL,"testWithMockedMapReduceSingleRegion",1,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithMockedMapReduceMultiRegion() throws Exception {
  testWithMockedMapReduce(UTIL,"testWithMockedMapReduceMultiRegion",10,8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestCopyTable </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Simple end-to-end test with bulkload.
 */
@Test public void testCopyTableWithBulkload() throws Exception {
  doCopyTableTest(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Simple end-to-end test
 * @throws Exception
 */
@Test public void testCopyTable() throws Exception {
  doCopyTableTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestGroupingTableMapper </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test GroupingTableMapper class
 */
@Test public void testGroupingTableMapper() throws Exception {
  GroupingTableMapper mapper=new GroupingTableMapper();
  Configuration configuration=new Configuration();
  configuration.set(GroupingTableMapper.GROUP_COLUMNS,"family1:clm family2:clm");
  mapper.setConf(configuration);
  Result result=mock(Result.class);
  @SuppressWarnings("unchecked") Mapper<ImmutableBytesWritable,Result,ImmutableBytesWritable,Result>.Context context=mock(Mapper.Context.class);
  context.write(any(ImmutableBytesWritable.class),any(Result.class));
  List<Cell> keyValue=new ArrayList<Cell>();
  byte[] row={};
  keyValue.add(new KeyValue(row,Bytes.toBytes("family2"),Bytes.toBytes("clm"),Bytes.toBytes("value1")));
  keyValue.add(new KeyValue(row,Bytes.toBytes("family1"),Bytes.toBytes("clm"),Bytes.toBytes("value2")));
  when(result.listCells()).thenReturn(keyValue);
  mapper.map(null,result,context);
  byte[][] data={Bytes.toBytes("value1"),Bytes.toBytes("value2")};
  ImmutableBytesWritable ibw=mapper.createGroupKey(data);
  verify(context).write(ibw,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat2 </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Test for HFileOutputFormat2.LOCALITY_SENSITIVE_CONF_KEY = true
 * This test could only check the correctness of original logic if LOCALITY_SENSITIVE_CONF_KEY
 * is set to true. Because MiniHBaseCluster always run with single hostname (and different ports),
 * it's not possible to check the region locality by comparing region locations and DN hostnames.
 * When MiniHBaseCluster supports explicit hostnames parameter (just like MiniDFSCluster does),
 * we could test region locality features more easily.
 */
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testMRIncrementalLoadWithLocality() throws Exception {
  LOG.info("\nStarting test testMRIncrementalLoadWithLocality\n");
  doIncrementalLoadTest(false,true);
  doIncrementalLoadTest(true,true);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testMRIncrementalLoad() throws Exception {
  LOG.info("\nStarting test testMRIncrementalLoad\n");
  doIncrementalLoadTest(false,false);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Goes zombie too frequently; needs work. See HBASE-14563") @Test public void testMRIncrementalLoadWithSplit() throws Exception {
  LOG.info("\nStarting test testMRIncrementalLoadWithSplit\n");
  doIncrementalLoadTest(true,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTSVWithOperationAttributes </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTableWithInvalidOperationAttr() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterCustomTestMapperForOprAttr","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_ATTRIBUTES_KEY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001btest1=>myvalue\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1,false);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTable() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterCustomTestMapperForOprAttr","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_ATTRIBUTES_KEY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001btest=>myvalue\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1,true);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTSVWithTTLs </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTable() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterMapper","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_TTL","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001b1000000\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTSVWithVisibilityLabels </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithTsvImporterTextMapper() throws Exception {
  TableName table=TableName.valueOf("test-" + UUID.randomUUID());
  String FAMILY="FAM";
  Path bulkOutputPath=new Path(util.getDataTestDirOnTestFS(table.getNameAsString()),"hfiles");
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterTextMapper","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b","-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ bulkOutputPath.toString(),table.getNameAsString()};
  String data="KEY\u001bVALUE4\u001bVALUE8\u001bsecret&private\n";
  doMROnTableTest(util,FAMILY,data,args,4);
  util.deleteTable(table);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTableWithDeletes() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterMapper","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001bsecret&private\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1);
  issueDeleteAndVerifyData(tableName);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTableWithBulkload() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tableName.getNameAsString()),"hfiles");
  String[] args=new String[]{"-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ hfiles.toString(),"-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001bsecret&private\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithTsvImporterTextMapperWithInvalidLabels() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tableName.getNameAsString()),"hfiles");
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterTextMapper","-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ hfiles.toString(),"-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001bprivate\nKEY1\u001bVALUE1\u001bVALUE2\u001binvalid\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1,2);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithInvalidLabels() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tableName.getNameAsString()),"hfiles");
  String[] args=new String[]{"-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ hfiles.toString(),"-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001bprivate\nKEY1\u001bVALUE1\u001bVALUE2\u001binvalid\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1,2);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTable() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterMapper","-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE1\u001bVALUE2\u001bsecret&private\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMRWithOutputFormat() throws Exception {
  TableName tableName=TableName.valueOf("test-" + UUID.randomUUID());
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tableName.getNameAsString()),"hfiles");
  String[] args=new String[]{"-D" + ImportTsv.MAPPER_CONF_KEY + "=org.apache.hadoop.hbase.mapreduce.TsvImporterMapper","-D" + ImportTsv.BULK_OUTPUT_CONF_KEY + "="+ hfiles.toString(),"-D" + ImportTsv.COLUMNS_CONF_KEY + "=HBASE_ROW_KEY,FAM:A,FAM:B,HBASE_CELL_VISIBILITY","-D" + ImportTsv.SEPARATOR_CONF_KEY + "=\u001b",tableName.getNameAsString()};
  String data="KEY\u001bVALUE4\u001bVALUE8\u001bsecret&private\n";
  util.createTable(tableName,FAMILY);
  doMROnTableTest(util,FAMILY,data,args,1);
  util.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTsv </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDryModeWithBulkModeAndTableDoesNotExistsCreateTableSetToYes() throws Exception {
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  args.put(ImportTsv.DRY_RUN_CONF_KEY,"true");
  args.put(ImportTsv.CREATE_TABLE_CONF_KEY,"yes");
  doMROnTableTest(null,1);
  exception.expect(TableNotFoundException.class);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * If there are invalid data rows as inputs, then only those rows should be ignored.
 */
@Test public void testTsvImporterTextMapperWithInvalidData() throws Exception {
  Path bulkOutputPath=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.MAPPER_CONF_KEY,"org.apache.hadoop.hbase.mapreduce.TsvImporterTextMapper");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,bulkOutputPath.toString());
  args.put(ImportTsv.COLUMNS_CONF_KEY,"HBASE_ROW_KEY,HBASE_TS_KEY,FAM:A,FAM:B");
  args.put(ImportTsv.SEPARATOR_CONF_KEY,",");
  String data="KEY,1234,VALUE1,VALUE2\nKEY\nKEY,1235,VALUE1,VALUE2\n";
  doMROnTableTest(util,tn,FAMILY,data,args,1,4);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDryModeWithBulkOutputAndTableExists() throws Exception {
  util.createTable(tn,FAMILY);
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  args.put(ImportTsv.DRY_RUN_CONF_KEY,"true");
  doMROnTableTest(null,1);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * If table is not present in bulk mode and create.table is not set to yes,
 * import should fail with TableNotFoundException.
 */
@Test public void testDryModeWithBulkOutputAndTableDoesNotExistsCreateTableSetToNo() throws Exception {
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  args.put(ImportTsv.DRY_RUN_CONF_KEY,"true");
  args.put(ImportTsv.CREATE_TABLE_CONF_KEY,"no");
  exception.expect(TableNotFoundException.class);
  doMROnTableTest(null,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTable() throws Exception {
  util.createTable(tn,FAMILY);
  doMROnTableTest(null,1);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithoutAnExistingTable() throws Exception {
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  doMROnTableTest(null,3);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithAnExistingTable() throws Exception {
  util.createTable(tn,FAMILY);
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  doMROnTableTest(null,3);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTableWithCustomMapper() throws Exception {
  util.createTable(tn,FAMILY);
  args.put(ImportTsv.MAPPER_CONF_KEY,"org.apache.hadoop.hbase.mapreduce.TsvImporterCustomTestMapper");
  doMROnTableTest(null,3);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * If table is not present in non-bulk mode, dry run should fail just like
 * normal mode.
 */
@Test public void testDryModeWithoutBulkOutputAndTableDoesNotExists() throws Exception {
  args.put(ImportTsv.DRY_RUN_CONF_KEY,"true");
  exception.expect(TableNotFoundException.class);
  doMROnTableTest(null,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDryModeWithoutBulkOutputAndTableExists() throws Exception {
  util.createTable(tn,FAMILY);
  args.put(ImportTsv.DRY_RUN_CONF_KEY,"true");
  doMROnTableTest(null,1);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithAnExistingTableNoStrictTrue() throws Exception {
  util.createTable(tn,FAMILY);
  Path hfiles=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,hfiles.toString());
  args.put(ImportTsv.NO_STRICT_COL_FAMILY,"true");
  doMROnTableTest(null,3);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkOutputWithTsvImporterTextMapper() throws Exception {
  Path bulkOutputPath=new Path(util.getDataTestDirOnTestFS(tn.getNameAsString()),"hfiles");
  args.put(ImportTsv.MAPPER_CONF_KEY,"org.apache.hadoop.hbase.mapreduce.TsvImporterTextMapper");
  args.put(ImportTsv.BULK_OUTPUT_CONF_KEY,bulkOutputPath.toString());
  String data="KEY\u001bVALUE4\u001bVALUE8\n";
  doMROnTableTest(data,4);
  util.deleteTable(tn);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMROnTableWithTimestamp() throws Exception {
  util.createTable(tn,FAMILY);
  args.put(ImportTsv.COLUMNS_CONF_KEY,"HBASE_ROW_KEY,HBASE_TS_KEY,FAM:A,FAM:B");
  args.put(ImportTsv.SEPARATOR_CONF_KEY,",");
  String data="KEY,1234,VALUE1,VALUE2\n";
  doMROnTableTest(data,1);
  util.deleteTable(tn);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestImportTsvParser </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=BadTsvLineException.class) public void testTsvParserBadTsvLineOnlyKey() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a","\t");
  byte[] line=Bytes.toBytes("key_only");
  parser.parse(line,line.length);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test cases that throw BadTsvLineException
 */
@Test(expected=BadTsvLineException.class) public void testTsvParserBadTsvLineExcessiveColumns() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a","\t");
  byte[] line=Bytes.toBytes("val_a\tval_b\tval_c");
  parser.parse(line,line.length);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=BadTsvLineException.class) public void testTsvParserBadTsvLineNoRowKey() throws BadTsvLineException {
  TsvParser parser=new TsvParser("col_a,HBASE_ROW_KEY","\t");
  byte[] line=Bytes.toBytes("only_cola_data_and_no_row_key");
  parser.parse(line,line.length);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=BadTsvLineException.class) public void testTsvParserBadTsvLineZeroColumn() throws BadTsvLineException {
  TsvParser parser=new TsvParser("HBASE_ROW_KEY,col_a","\t");
  byte[] line=Bytes.toBytes("");
  parser.parse(line,line.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithNoneToNone() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.NONE,DataBlockEncoding.NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testNonHfileFolder() throws Exception {
  testNonHfileFolder("testNonHfileFolder",false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that have
 * different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testSimpleHFileSplit() throws Exception {
  runTest("testHFileSplit",BloomType.NONE,new byte[][]{Bytes.toBytes("aaa"),Bytes.toBytes("fff"),Bytes.toBytes("jjj"),Bytes.toBytes("ppp"),Bytes.toBytes("uuu"),Bytes.toBytes("zzz")},new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("lll")},new byte[][]{Bytes.toBytes("mmm"),Bytes.toBytes("zzz")}});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test loading into a column family that has a ROWCOL bloom filter.
 */
@Test(timeout=120000) public void testRegionCrossingRowColBloom() throws Exception {
  runTest("testRegionCrossingLoadRowColBloom",BloomType.ROWCOL,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TableNotFoundException.class) public void testWithoutAnExistingTableAndCreateTableSetToNo() throws Exception {
  Configuration conf=util.getConfiguration();
  conf.set(LoadIncrementalHFiles.CREATE_TABLE_CONF_KEY,"no");
  LoadIncrementalHFiles loader=new LoadIncrementalHFiles(conf);
  String[] args={"directory","nonExistingTable"};
  loader.run(args);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithEncodedToNone() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.DIFF,DataBlockEncoding.NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test loading into a column family that has a ROW bloom filter.
 */
@Test(timeout=60000) public void testRegionCrossingRowBloom() throws Exception {
  runTest("testRegionCrossingLoadRowBloom",BloomType.ROW,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitALot() throws Exception {
  runTest("testSplitALot",BloomType.NONE,new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("bbb"),Bytes.toBytes("ccc"),Bytes.toBytes("ddd"),Bytes.toBytes("eee"),Bytes.toBytes("fff"),Bytes.toBytes("ggg"),Bytes.toBytes("hhh"),Bytes.toBytes("iii"),Bytes.toBytes("lll"),Bytes.toBytes("mmm"),Bytes.toBytes("nnn"),Bytes.toBytes("ooo"),Bytes.toBytes("ppp"),Bytes.toBytes("qqq"),Bytes.toBytes("rrr"),Bytes.toBytes("sss"),Bytes.toBytes("ttt"),Bytes.toBytes("uuu"),Bytes.toBytes("vvv"),Bytes.toBytes("zzz")},new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("zzz")}});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * have a ROWCOL bloom filter and a different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testRegionCrossingHFileSplitRowColBloom() throws Exception {
  testRegionCrossingHFileSplit(BloomType.ROWCOL);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * have a ROW bloom filter and a different region boundaries than the table pre-split.
 */
@Test(timeout=120000) public void testRegionCrossingHFileSplitRowBloom() throws Exception {
  testRegionCrossingHFileSplit(BloomType.ROW);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads
 * HFiles that cross the boundaries of those regions
 */
@Test(timeout=120000) public void testRegionCrossingLoad() throws Exception {
  runTest("testRegionCrossingLoad",BloomType.NONE,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("eee")},new byte[][]{Bytes.toBytes("fff"),Bytes.toBytes("zzz")}});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithNoneToEncoded() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.NONE,DataBlockEncoding.DIFF);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads HFiles that cross the boundaries
 * and have different region boundaries than the table pre-split.
 */
@Test(timeout=60000) public void testRegionCrossingHFileSplit() throws Exception {
  testRegionCrossingHFileSplit(BloomType.NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test case that creates some regions and loads
 * HFiles that fit snugly inside those regions
 */
@Test(timeout=120000) public void testSimpleLoad() throws Exception {
  runTest("testSimpleLoad",BloomType.NONE,new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("cccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("ooo")}});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testNonHfileFolderWithUnmatchedFamilyName() throws Exception {
  testNonHfileFolder("testNonHfileFolderWithUnmatchedFamilyName",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitStoreFileWithEncodedToEncoded() throws IOException {
  testSplitStoreFileWithDifferentEncoding(DataBlockEncoding.DIFF,DataBlockEncoding.DIFF);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestMultiTableSnapshotInputFormatImpl </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetInputRestoresSnapshots() throws Exception {
  callSetInput();
  Map<String,Path> snapshotDirs=subject.getSnapshotDirs(conf);
  for (  Map.Entry<String,Path> entry : snapshotDirs.entrySet()) {
    verify(this.subject).restoreSnapshot(eq(this.conf),eq(entry.getKey()),eq(this.rootDir),eq(entry.getValue()),any(FileSystem.class));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestMultithreadedTableMapper </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test multithreadedTableMappper map/reduce against a multi-region table
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testMultithreadedTableMapper() throws IOException, InterruptedException, ClassNotFoundException {
  runTestOnTable(UTIL.getConnection().getTable(MULTI_REGION_TABLE_NAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestRowCounter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a case when the timerange is specified with --starttime and --endtime options
 * @throws Exception
 */
@Test public void testRowCounterTimeRange() throws Exception {
  final byte[] family=Bytes.toBytes(COL_FAM);
  final byte[] col1=Bytes.toBytes(COL1);
  Put put1=new Put(Bytes.toBytes("row_timerange_" + 1));
  Put put2=new Put(Bytes.toBytes("row_timerange_" + 2));
  Put put3=new Put(Bytes.toBytes("row_timerange_" + 3));
  long ts;
  Table table=TEST_UTIL.deleteTableData(TableName.valueOf(TABLE_NAME));
  ts=System.currentTimeMillis();
  put1.addColumn(family,col1,ts,Bytes.toBytes("val1"));
  table.put(put1);
  Thread.sleep(100);
  ts=System.currentTimeMillis();
  put2.addColumn(family,col1,ts,Bytes.toBytes("val2"));
  put3.addColumn(family,col1,ts,Bytes.toBytes("val3"));
  table.put(put2);
  table.put(put3);
  table.close();
  String[] args=new String[]{TABLE_NAME,COL_FAM + ":" + COL1,"--starttime=" + 0,"--endtime=" + ts};
  runRowCount(args,1);
  args=new String[]{TABLE_NAME,COL_FAM + ":" + COL1,"--starttime=" + 0,"--endtime=" + (ts - 10)};
  runRowCount(args,1);
  args=new String[]{TABLE_NAME,COL_FAM + ":" + COL1,"--starttime=" + ts,"--endtime=" + (ts + 1000)};
  runRowCount(args,2);
  args=new String[]{TABLE_NAME,COL_FAM + ":" + COL1,"--starttime=" + (ts - 30 * 1000),"--endtime=" + (ts + 30 * 1000)};
  runRowCount(args,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a case when the column specified in command line arguments is
 * exclusive for few rows.
 * @throws Exception
 */
@Test public void testRowCounterExclusiveColumn() throws Exception {
  String[] args=new String[]{TABLE_NAME,COL_FAM + ":" + COL1};
  runRowCount(args,8);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a case when no column was specified in command line arguments.
 * @throws Exception
 */
@Test public void testRowCounterNoColumn() throws Exception {
  String[] args=new String[]{TABLE_NAME};
  runRowCount(args,10);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a case when the column specified in command line arguments is not part
 * of first KV for a row.
 * @throws Exception
 */
@Test public void testRowCounterHiddenColumn() throws Exception {
  String[] args=new String[]{TABLE_NAME,COL_FAM + ":" + COL2};
  runRowCount(args,10);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a case when the column specified in command line arguments is
 * one for which the qualifier contains colons.
 * @throws Exception
 */
@Test public void testRowCounterColumnWithColonInQualifier() throws Exception {
  String[] args=new String[]{TABLE_NAME,COL_FAM + ":" + COMPOSITE_COLUMN};
  runRowCount(args,8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableInputFormat </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming NotServingRegionException using newer mapreduce api
 * @throws InterruptedException
 * @throws org.apache.hadoop.hbase.DoNotRetryIOException
 */
@Test public void testTableRecordReaderScannerTimeoutMapreduce() throws IOException, InterruptedException {
  Table htable=createDNRIOEScannerTable("table4-mr".getBytes(),1);
  runTestMapreduce(htable);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming Scanner IOException failure using newer mapreduce api
 * @throws IOException
 * @throws InterruptedException
 */
@Test(expected=IOException.class) public void testTableRecordReaderScannerFailMapreduceTwice() throws IOException, InterruptedException {
  Table htable=createIOEScannerTable("table3-mr".getBytes(),2);
  runTestMapreduce(htable);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming no errors using newer mapreduce api
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testTableRecordReaderMapreduce() throws IOException, InterruptedException {
  Table table=createTable("table1-mr".getBytes());
  runTestMapreduce(table);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify the example we present in javadocs on TableInputFormatBase
 */
@Test public void testExtensionOfTableInputFormatBase() throws IOException, InterruptedException, ClassNotFoundException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase");
  final Table htable=createTable(Bytes.toBytes("exampleTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleTIF.class);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming Scanner IOException failure using newer mapreduce api
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testTableRecordReaderScannerFailMapreduce() throws IOException, InterruptedException {
  Table htable=createIOEScannerTable("table2-mr".getBytes(),1);
  runTestMapreduce(htable);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run test assuming NotServingRegionException using newer mapreduce api
 * @throws InterruptedException
 * @throws org.apache.hadoop.hbase.NotServingRegionException
 */
@Test(expected=org.apache.hadoop.hbase.NotServingRegionException.class) public void testTableRecordReaderScannerTimeoutMapreduceTwice() throws IOException, InterruptedException {
  Table htable=createDNRIOEScannerTable("table5-mr".getBytes(),2);
  runTestMapreduce(htable);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJobConfigurableExtensionOfTableInputFormatBase() throws IOException, InterruptedException, ClassNotFoundException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase, " + "using JobConfigurable.");
  final Table htable=createTable(Bytes.toBytes("exampleJobConfigurableTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleJobConfigurableTIF.class);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeprecatedExtensionOfTableInputFormatBase() throws IOException, InterruptedException, ClassNotFoundException {
  LOG.info("testing use of an InputFormat taht extends InputFormatBase, " + "using the approach documented in 0.98.");
  final Table htable=createTable(Bytes.toBytes("exampleDeprecatedTable"),new byte[][]{Bytes.toBytes("columnA"),Bytes.toBytes("columnB")});
  testInputFormat(ExampleDeprecatedTIF.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableInputFormatScan1 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanEmptyToOPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,"opp","opo");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanEmptyToBBB() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,"bbb","bba");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanEmptyToBBA() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,"bba","baz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanEmptyToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,null,null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanEmptyToAPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan(null,"app","apo");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific number of mappers. The test table has 25 regions,
 * and all region sizes are set as 0 as default. The average region size is 1 (the smallest
 * positive). When we set hbase.mapreduce.input.ratio as -1, all regions will be cut into two
 * MapRedcue input splits, the number of MR input splits should be 50; when we set hbase
 * .mapreduce.input.ratio as 100, the sum of all region sizes is less then the average region
 * size, all regions will be combined into 1 MapRedcue input split.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testGetSplits() throws IOException, InterruptedException, ClassNotFoundException {
  testNumOfSplits("-1",52);
  testNumOfSplits("100",1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the getSplitKey() method in TableInputFormatBase.java
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testGetSplitsPoint() throws IOException, InterruptedException, ClassNotFoundException {
  byte[] start1={'a','a','a','b','c','d','e','f'};
  byte[] end1={'a','a','a','f','f'};
  byte[] splitPoint1={'a','a','a','d'};
  testGetSplitKey(start1,end1,splitPoint1,true);
  byte[] start2={'1','1','1','0','0','0'};
  byte[] end2={'1','1','2','5','7','9','0'};
  byte[] splitPoint2={'1','1','1','b'};
  testGetSplitKey(start2,end2,splitPoint2,true);
  byte[] start3={'a','a','a','a','a','a'};
  byte[] end3={'a','a','b'};
  byte[] splitPoint3={'a','a','a','p'};
  testGetSplitKey(start3,end3,splitPoint3,true);
  byte[] start4={'a','a','a'};
  byte[] end4={'a','a','a','z'};
  byte[] splitPoint4={'a','a','a','M'};
  testGetSplitKey(start4,end4,splitPoint4,true);
  byte[] start5={'a','a','a'};
  byte[] end5={'a','a','b','a'};
  byte[] splitPoint5={'a','a','a','p'};
  testGetSplitKey(start5,end5,splitPoint5,true);
  byte[] start6={};
  byte[] end6={'h','h','h','q','q','q','w','w'};
  byte[] splitPoint6={'h'};
  testGetSplitKey(start6,end6,splitPoint6,true);
  byte[] start7={'f','f','f','f','a','a','a'};
  byte[] end7={};
  byte[] splitPointText7={'f','~','~','~','~','~','~'};
  byte[] splitPointBinary7={'f',127,127,127,127,127,127};
  testGetSplitKey(start7,end7,splitPointText7,true);
  testGetSplitKey(start7,end7,splitPointBinary7,false);
  byte[] start8={};
  byte[] end8={};
  byte[] splitPointText8={'O'};
  byte[] splitPointBinary8={0};
  testGetSplitKey(start8,end8,splitPointText8,true);
  testGetSplitKey(start8,end8,splitPointBinary8,false);
  byte[] start9={13,-19,126,127};
  byte[] end9={13,-19,127,0};
  byte[] splitPoint9={13,-19,127,-64};
  testGetSplitKey(start9,end9,splitPoint9,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableInputFormatScan2 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScanFromConfiguration() throws IOException, InterruptedException, ClassNotFoundException {
  testScanFromConfiguration("bba","bbd","bbc");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanOPPToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("opp",null,"zzz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanOBBToOPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("obb","opp","opo");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanYZYToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("yzy",null,"zzz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanYYYToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("yyy",null,"zzz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanYYXToEmpty() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("yyx",null,"zzz");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests a MR scan using specific start and stop rows.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testScanOBBToQPP() throws IOException, InterruptedException, ClassNotFoundException {
  testScan("obb","qpp","qpo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTableMapReduceBase </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombiner() throws IOException {
  Configuration conf=new Configuration(UTIL.getConfiguration());
  conf.setInt("mapreduce.map.combine.minspills",1);
  runTestOnTable(UTIL.getConnection().getTable(MULTI_REGION_TABLE_NAME));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a map/reduce against a multi-region table
 * @throws IOException
 */
@Test public void testMultiRegionTable() throws IOException {
  runTestOnTable(UTIL.getConnection().getTable(MULTI_REGION_TABLE_NAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestTimeRangeMapRed </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTimeRangeMapRed() throws IOException, InterruptedException, ClassNotFoundException {
  final HTableDescriptor desc=new HTableDescriptor(TABLE_NAME);
  final HColumnDescriptor col=new HColumnDescriptor(FAMILY_NAME);
  col.setMaxVersions(Integer.MAX_VALUE);
  desc.addFamily(col);
  admin.createTable(desc);
  List<Put> puts=new ArrayList<Put>();
  for (  Map.Entry<Long,Boolean> entry : TIMESTAMP.entrySet()) {
    Put put=new Put(KEY);
    put.setDurability(Durability.SKIP_WAL);
    put.addColumn(FAMILY_NAME,COLUMN_NAME,entry.getKey(),Bytes.toBytes(false));
    puts.add(put);
  }
  Table table=UTIL.getConnection().getTable(desc.getTableName());
  table.put(puts);
  runTestOnTable();
  verify(table);
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mapreduce.TestWALPlayer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWALKeyValueMapperWithDeprecatedConfig() throws Exception {
  testWALKeyValueMapper("hlog.input.tables");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test WALKeyValueMapper setup and map
 */
@Test public void testWALKeyValueMapper() throws Exception {
  testWALKeyValueMapper(WALPlayer.TABLES_KEY);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestCatalogJanitor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure parent gets cleaned up even if daughter is cleaned up before it.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testParentCleanedEvenIfDaughterGoneFirst() throws IOException, InterruptedException {
  parentWithSpecifiedEndKeyCleanedEvenIfDaughterGoneFirst("testParentCleanedEvenIfDaughterGoneFirst",Bytes.toBytes("eee"));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure last parent with empty end key gets cleaned up even if daughter is cleaned up before it.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testLastParentCleanedEvenIfDaughterGoneFirst() throws IOException, InterruptedException {
  parentWithSpecifiedEndKeyCleanedEvenIfDaughterGoneFirst("testLastParentCleanedEvenIfDaughterGoneFirst",new byte[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterMetrics </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testClusterRequests() throws Exception {
  RegionServerStatusProtos.RegionServerReportRequest.Builder request=RegionServerStatusProtos.RegionServerReportRequest.newBuilder();
  ServerName serverName=cluster.getMaster(0).getServerName();
  request.setServer(ProtobufUtil.toServerName(serverName));
  MetricsMasterSource masterSource=master.getMasterMetrics().getMetricsSource();
  ClusterStatusProtos.ServerLoad sl=ClusterStatusProtos.ServerLoad.newBuilder().setTotalNumberOfRequests(10000).build();
  masterSource.init();
  request.setLoad(sl);
  master.getMasterRpcServices().regionServerReport(null,request.build());
  metricsHelper.assertCounter("cluster_requests",10000,masterSource);
  sl=ClusterStatusProtos.ServerLoad.newBuilder().setTotalNumberOfRequests(15000).build();
  request.setLoad(sl);
  master.getMasterRpcServices().regionServerReport(null,request.build());
  metricsHelper.assertCounter("cluster_requests",15000,masterSource);
  master.getMasterRpcServices().regionServerReport(null,request.build());
  metricsHelper.assertCounter("cluster_requests",15000,masterSource);
  master.stopMaster();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefaultMasterProcMetrics() throws Exception {
  MetricsMasterProcSource masterSource=master.getMasterMetrics().getMetricsProcSource();
  metricsHelper.assertGauge("numMasterWALs",master.getNumWALFiles(),masterSource);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefaultMasterMetrics() throws Exception {
  MetricsMasterSource masterSource=master.getMasterMetrics().getMetricsSource();
  metricsHelper.assertGauge("numRegionServers",2,masterSource);
  metricsHelper.assertGauge("averageLoad",2,masterSource);
  metricsHelper.assertGauge("numDeadRegionServers",0,masterSource);
  metricsHelper.assertGauge("masterStartTime",master.getMasterStartTime(),masterSource);
  metricsHelper.assertGauge("masterActiveTime",master.getMasterActiveTime(),masterSource);
  metricsHelper.assertTag("isActiveMaster","true",masterSource);
  metricsHelper.assertTag("serverName",master.getServerName().toString(),masterSource);
  metricsHelper.assertTag("clusterId",master.getClusterId(),masterSource);
  metricsHelper.assertTag("zookeeperQuorum",master.getZooKeeper().getQuorum(),masterSource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterNoCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test starting master then stopping it before its fully up.
 * @throws IOException
 * @throws KeeperException
 * @throws InterruptedException
 */
@Test public void testStopDuringStart() throws IOException, KeeperException, InterruptedException {
  CoordinatedStateManager cp=CoordinatedStateManagerFactory.getCoordinatedStateManager(TESTUTIL.getConfiguration());
  HMaster master=new HMaster(TESTUTIL.getConfiguration(),cp);
  master.start();
  master.stopMaster();
  master.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterOperationsForRegionReplicas </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithSingleReplica() throws Exception {
  final int numRegions=3;
  final int numReplica=1;
  final TableName table=TableName.valueOf("singleReplicaTable");
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.setRegionReplication(numReplica);
    desc.addFamily(new HColumnDescriptor("family"));
    ADMIN.createTable(desc,Bytes.toBytes("A"),Bytes.toBytes("Z"),numRegions);
    validateNumberOfRowsInMeta(table,numRegions,ADMIN.getConnection());
    List<HRegionInfo> hris=MetaTableAccessor.getTableRegions(ADMIN.getConnection(),table);
    assert (hris.size() == numRegions * numReplica);
  }
  finally {
    ADMIN.disableTable(table);
    ADMIN.deleteTable(table);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithMultipleReplicas() throws Exception {
  final TableName table=TableName.valueOf("fooTable");
  final int numRegions=3;
  final int numReplica=2;
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    desc.setRegionReplication(numReplica);
    desc.addFamily(new HColumnDescriptor("family"));
    ADMIN.createTable(desc,Bytes.toBytes("A"),Bytes.toBytes("Z"),numRegions);
    TEST_UTIL.waitTableEnabled(table);
    validateNumberOfRowsInMeta(table,numRegions,ADMIN.getConnection());
    List<HRegionInfo> hris=MetaTableAccessor.getTableRegions(ADMIN.getConnection(),table);
    assert (hris.size() == numRegions * numReplica);
    for (int i=0; i < numRegions; i++) {
      for (int j=0; j < numReplica; j++) {
        HRegionInfo replica=RegionReplicaUtil.getRegionInfoForReplica(hris.get(i),j);
        RegionState state=TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionState(replica);
        assert (state != null);
      }
    }
    List<Result> metaRows=MetaTableAccessor.fullScanRegions(ADMIN.getConnection());
    int numRows=0;
    for (    Result result : metaRows) {
      RegionLocations locations=MetaTableAccessor.getRegionLocations(result);
      HRegionInfo hri=locations.getRegionLocation().getRegionInfo();
      if (!hri.getTable().equals(table))       continue;
      numRows+=1;
      HRegionLocation[] servers=locations.getRegionLocations();
      assert (servers.length == 2);
      assert (!servers[0].equals(servers[1]));
    }
    assert (numRows == numRegions);
    validateFromSnapshotFromMeta(TEST_UTIL,table,numRegions,numReplica,ADMIN.getConnection());
    ServerName master=TEST_UTIL.getHBaseClusterInterface().getClusterStatus().getMaster();
    TEST_UTIL.getHBaseClusterInterface().stopMaster(master);
    TEST_UTIL.getHBaseClusterInterface().waitForMasterToStop(master,30000);
    TEST_UTIL.getHBaseClusterInterface().startMaster(master.getHostname(),master.getPort());
    TEST_UTIL.getHBaseClusterInterface().waitForActiveAndReadyMaster();
    for (int i=0; i < numRegions; i++) {
      for (int j=0; j < numReplica; j++) {
        HRegionInfo replica=RegionReplicaUtil.getRegionInfoForReplica(hris.get(i),j);
        RegionState state=TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionState(replica);
        assert (state != null);
      }
    }
    validateFromSnapshotFromMeta(TEST_UTIL,table,numRegions,numReplica,ADMIN.getConnection());
    TEST_UTIL.getConfiguration().setBoolean("hbase.master.startup.retainassign",true);
    TEST_UTIL.shutdownMiniHBaseCluster();
    TEST_UTIL.startMiniHBaseCluster(1,numSlaves);
    TEST_UTIL.waitTableEnabled(table);
    validateFromSnapshotFromMeta(TEST_UTIL,table,numRegions,numReplica,ADMIN.getConnection());
    TEST_UTIL.shutdownMiniHBaseCluster();
    TEST_UTIL.startMiniHBaseCluster(1,1);
    TEST_UTIL.waitTableEnabled(table);
    validateSingleRegionServerAssignment(ADMIN.getConnection(),numRegions,numReplica);
    for (int i=1; i < numSlaves; i++) {
      TEST_UTIL.getMiniHBaseCluster().startRegionServer();
    }
    ADMIN.disableTable(table);
    assert (ADMIN.isTableDisabled(table));
    desc.setRegionReplication(numReplica + 1);
    ADMIN.modifyTable(table,desc);
    ADMIN.enableTable(table);
    assert (ADMIN.isTableEnabled(table));
    List<HRegionInfo> regions=TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsOfTable(table);
    assert (regions.size() == numRegions * (numReplica + 1));
    ADMIN.disableTable(table);
    desc.setRegionReplication(numReplica);
    ADMIN.modifyTable(table,desc);
    ADMIN.enableTable(table);
    assert (ADMIN.isTableEnabled(table));
    regions=TEST_UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionStates().getRegionsOfTable(table);
    assert (regions.size() == numRegions * numReplica);
    hris=MetaTableAccessor.getTableRegions(ADMIN.getConnection(),table);
    assert (hris.size() == numRegions * numReplica);
    Map<HRegionInfo,Integer> defaultReplicas=new HashMap<HRegionInfo,Integer>();
    for (    HRegionInfo hri : hris) {
      Integer i;
      HRegionInfo regionReplica0=RegionReplicaUtil.getRegionInfoForDefaultReplica(hri);
      defaultReplicas.put(regionReplica0,(i=defaultReplicas.get(regionReplica0)) == null ? 1 : i + 1);
    }
    assert (defaultReplicas.size() == numRegions);
    Collection<Integer> counts=new HashSet<Integer>(defaultReplicas.values());
    assert (counts.size() == 1 && counts.contains(new Integer(numReplica)));
  }
  finally {
    ADMIN.disableTable(table);
    ADMIN.deleteTable(table);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterQosFunction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnnotations(){
  checkMethod(conf,"GetLastFlushedSequenceId",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"CompactRegion",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"GetLastFlushedSequenceId",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"GetRegionInfo",HConstants.ADMIN_QOS,qosFunction);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegionInTransition() throws IOException {
  HBaseProtos.RegionInfo meta_ri=HRegionInfo.convert(HRegionInfo.FIRST_META_REGIONINFO);
  HBaseProtos.RegionInfo normal_ri=HRegionInfo.convert(new HRegionInfo(TableName.valueOf("test:table"),Bytes.toBytes("a"),Bytes.toBytes("b"),false));
  RegionServerStatusProtos.RegionStateTransition metaTransition=RegionServerStatusProtos.RegionStateTransition.newBuilder().addRegionInfo(meta_ri).setTransitionCode(RegionServerStatusProtos.RegionStateTransition.TransitionCode.CLOSED).build();
  RegionServerStatusProtos.RegionStateTransition normalTransition=RegionServerStatusProtos.RegionStateTransition.newBuilder().addRegionInfo(normal_ri).setTransitionCode(RegionServerStatusProtos.RegionStateTransition.TransitionCode.CLOSED).build();
  RegionServerStatusProtos.ReportRegionStateTransitionRequest metaTransitionRequest=RegionServerStatusProtos.ReportRegionStateTransitionRequest.newBuilder().setServer(ProtobufUtil.toServerName(ServerName.valueOf("locahost:60020",100))).addTransition(normalTransition).addTransition(metaTransition).build();
  RegionServerStatusProtos.ReportRegionStateTransitionRequest normalTransitionRequest=RegionServerStatusProtos.ReportRegionStateTransitionRequest.newBuilder().setServer(ProtobufUtil.toServerName(ServerName.valueOf("locahost:60020",100))).addTransition(normalTransition).build();
  final String reportFuncName="ReportRegionStateTransition";
  checkMethod(conf,reportFuncName,HConstants.SYSTEMTABLE_QOS,qosFunction,metaTransitionRequest);
  checkMethod(conf,reportFuncName,HConstants.NORMAL_QOS,qosFunction,normalTransitionRequest);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMasterStatusServlet </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStatusTemplateNoTables() throws IOException {
  new MasterStatusTmpl().render(new StringWriter(),master);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStatusTemplateWithServers() throws IOException {
  setupMockTables();
  List<ServerName> servers=Lists.newArrayList(ServerName.valueOf("rootserver:123,12345"),ServerName.valueOf("metaserver:123,12345"));
  Set<ServerName> deadServers=new HashSet<ServerName>(Lists.newArrayList(ServerName.valueOf("badserver:123,12345"),ServerName.valueOf("uglyserver:123,12345")));
  new MasterStatusTmpl().setMetaLocation(ServerName.valueOf("metaserver:123,12345")).setServers(servers).setDeadServers(deadServers).render(new StringWriter(),master);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStatusTemplateMetaAvailable() throws IOException {
  setupMockTables();
  new MasterStatusTmpl().setMetaLocation(ServerName.valueOf("metaserver:123,12345")).render(new StringWriter(),master);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestMetricsMasterSourceFactory </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsMasterSourceFactory.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestRegionPlacement </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
/** 
 * Used to test the correctness of this class.
 */
@Ignore("Test for unfinished feature") @Test public void testRandomizedMatrix(){
  int rows=100;
  int cols=100;
  float[][] matrix=new float[rows][cols];
  Random random=new Random();
  for (int i=0; i < rows; i++) {
    for (int j=0; j < cols; j++) {
      matrix[i][j]=random.nextFloat();
    }
  }
  RegionPlacementMaintainer.RandomizedMatrix rm=new RegionPlacementMaintainer.RandomizedMatrix(rows,cols);
  float[][] transformed=rm.transform(matrix);
  float[][] invertedTransformed=rm.invert(transformed);
  for (int i=0; i < rows; i++) {
    for (int j=0; j < cols; j++) {
      if (matrix[i][j] != invertedTransformed[i][j]) {
        throw new RuntimeException();
      }
    }
  }
  int[] transformedIndices=new int[rows];
  for (int i=0; i < rows; i++) {
    transformedIndices[i]=random.nextInt(cols);
  }
  int[] invertedTransformedIndices=rm.invertIndices(transformedIndices);
  float[] transformedValues=new float[rows];
  float[] invertedTransformedValues=new float[rows];
  for (int i=0; i < rows; i++) {
    transformedValues[i]=transformed[i][transformedIndices[i]];
    invertedTransformedValues[i]=matrix[i][invertedTransformedIndices[i]];
  }
  Arrays.sort(transformedValues);
  Arrays.sort(invertedTransformedValues);
  if (!Arrays.equals(transformedValues,invertedTransformedValues)) {
    throw new RuntimeException();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestSplitLogManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testUnassignedTimeout() throws Exception {
  LOG.info("TestUnassignedTimeout - iff all tasks are unassigned then" + " resubmit");
  String tasknode1=ZKSplitLog.getEncodedNodeName(zkw,"orphan/1");
  final ServerName worker1=ServerName.valueOf("worker1,1,1");
  SplitLogTask slt=new SplitLogTask.Owned(worker1,this.mode);
  zkw.getRecoverableZooKeeper().create(tasknode1,slt.toByteArray(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  slm=new SplitLogManager(ds,conf,stopper,master,DUMMY_MASTER);
  waitForCounter(tot_mgr_orphan_task_acquired,0,1,to / 2);
  TaskBatch batch=new TaskBatch();
  submitTaskAndWait(batch,"foo/1");
  for (int i=0; i < (3 * to) / 100; i++) {
    Thread.sleep(100);
    final ServerName worker2=ServerName.valueOf("worker1,1,1");
    slt=new SplitLogTask.Owned(worker2,this.mode);
    ZKUtil.setData(zkw,tasknode1,slt.toByteArray());
  }
  LOG.info("waiting for manager to resubmit the orphan task");
  waitForCounter(tot_mgr_resubmit,0,1,to + to / 2);
  waitForCounter(tot_mgr_resubmit_unassigned,0,1,2 * to + to / 2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestTableLockManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testReapAllTableLocks() throws Exception {
  prepareMiniZkCluster();
  ServerName serverName=ServerName.valueOf("localhost:10000",0);
  final TableLockManager lockManager=TableLockManager.createTableLockManager(TEST_UTIL.getConfiguration(),TEST_UTIL.getZooKeeperWatcher(),serverName);
  String tables[]={"table1","table2","table3","table4"};
  ExecutorService executor=Executors.newFixedThreadPool(6);
  final CountDownLatch writeLocksObtained=new CountDownLatch(4);
  final CountDownLatch writeLocksAttempted=new CountDownLatch(10);
  for (int i=0; i < tables.length; i++) {
    final String table=tables[i];
    for (int j=0; j < i + 1; j++) {
      executor.submit(new Callable<Void>(){
        @Override public Void call() throws Exception {
          writeLocksAttempted.countDown();
          lockManager.writeLock(TableName.valueOf(table),"testReapAllTableLocks").acquire();
          writeLocksObtained.countDown();
          return null;
        }
      }
);
    }
  }
  writeLocksObtained.await();
  writeLocksAttempted.await();
  TableLockCounter counter=new TableLockCounter();
  do {
    counter.reset();
    lockManager.visitAllLocks(counter);
    Thread.sleep(10);
  }
 while (counter.getLockCount() != 10);
  lockManager.reapWriteLocks();
  TEST_UTIL.getConfiguration().setInt(TableLockManager.TABLE_WRITE_LOCK_TIMEOUT_MS,0);
  TableLockManager zeroTimeoutLockManager=TableLockManager.createTableLockManager(TEST_UTIL.getConfiguration(),TEST_UTIL.getZooKeeperWatcher(),serverName);
  zeroTimeoutLockManager.writeLock(TableName.valueOf(tables[tables.length - 1]),"zero timeout").acquire();
  executor.shutdownNow();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.TestWarmupRegion </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Basic client side validation of HBASE-4536
 */
@Test public void testWarmup() throws Exception {
  int serverid=0;
  HRegion region=TEST_UTIL.getMiniHBaseCluster().getRegions(TABLENAME).get(0);
  HRegionInfo info=region.getRegionInfo();
  runwarmup();
  for (int i=0; i < 10; i++) {
    HRegionServer rs=TEST_UTIL.getMiniHBaseCluster().getRegionServer(serverid);
    byte[] destName=Bytes.toBytes(rs.getServerName().toString());
    TEST_UTIL.getMiniHBaseCluster().getMaster().move(info.getEncodedNameAsBytes(),destName);
    serverid=(serverid + 1) % 2;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestBaseLoadBalancer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the cluster startup bulk assignment which attempts to retain
 * assignment info.
 * @throws Exception
 */
@Test(timeout=180000) public void testRetainAssignment() throws Exception {
  List<ServerAndLoad> servers=randomServers(10,10);
  List<HRegionInfo> regions=randomRegions(100);
  Map<HRegionInfo,ServerName> existing=new TreeMap<HRegionInfo,ServerName>();
  for (int i=0; i < regions.size(); i++) {
    ServerName sn=servers.get(i % servers.size()).getServerName();
    ServerName snWithOldStartCode=ServerName.valueOf(sn.getHostname(),sn.getPort(),sn.getStartcode() - 10);
    existing.put(regions.get(i),snWithOldStartCode);
  }
  List<ServerName> listOfServerNames=getListOfServerNames(servers);
  Map<ServerName,List<HRegionInfo>> assignment=loadBalancer.retainAssignment(existing,listOfServerNames);
  assertRetainedAssignment(existing,listOfServerNames,assignment);
  List<ServerAndLoad> servers2=new ArrayList<ServerAndLoad>(servers);
  servers2.add(randomServer(10));
  servers2.add(randomServer(10));
  listOfServerNames=getListOfServerNames(servers2);
  assignment=loadBalancer.retainAssignment(existing,listOfServerNames);
  assertRetainedAssignment(existing,listOfServerNames,assignment);
  List<ServerAndLoad> servers3=new ArrayList<ServerAndLoad>(servers);
  servers3.remove(0);
  servers3.remove(0);
  listOfServerNames=getListOfServerNames(servers3);
  assignment=loadBalancer.retainAssignment(existing,listOfServerNames);
  assertRetainedAssignment(existing,listOfServerNames,assignment);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestDefaultLoadBalancer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the load balancing algorithm.
 * Invariant is that all servers should be hosting either floor(average) or
 * ceiling(average)
 * @throws Exception
 */
@Test(timeout=60000) public void testBalanceCluster() throws Exception {
  for (  int[] mockCluster : clusterStateMocks) {
    Map<ServerName,List<HRegionInfo>> servers=mockClusterServers(mockCluster);
    List<ServerAndLoad> list=convertToList(servers);
    LOG.info("Mock Cluster : " + printMock(list) + " "+ printStats(list));
    List<RegionPlan> plans=loadBalancer.balanceCluster(servers);
    List<ServerAndLoad> balancedCluster=reconcile(list,plans,servers);
    LOG.info("Mock Balance : " + printMock(balancedCluster));
    assertClusterAsBalanced(balancedCluster);
    for (    Map.Entry<ServerName,List<HRegionInfo>> entry : servers.entrySet()) {
      returnRegions(entry.getValue());
      returnServer(entry.getKey());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestFavoredNodeAssignmentHelper </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testRoundRobinAssignmentsWithUnevenSizedRacks(){
  primaryRSPlacement(6,null,10,10,10);
  primaryRSPlacement(600,null,10,10,5);
  primaryRSPlacement(600,null,10,5,10);
  primaryRSPlacement(600,null,5,10,10);
  primaryRSPlacement(500,null,10,10,5);
  primaryRSPlacement(500,null,10,5,10);
  primaryRSPlacement(500,null,5,10,10);
  primaryRSPlacement(500,null,9,7,8);
  primaryRSPlacement(500,null,8,7,9);
  primaryRSPlacement(500,null,7,9,8);
  primaryRSPlacement(459,null,7,9,8);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Disabled for now until FavoredNodes gets finished as a feature") @Test public void testPlacePrimaryRSAsRoundRobin(){
  primaryRSPlacement(6,null,10,10,10);
  primaryRSPlacement(600,null,10,10,10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=800000) public void testMidCluster3(){
  int numNodes=100;
  int numRegions=2000;
  int numRegionsPerServer=9;
  int replication=1;
  int numTables=110;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore @Test(timeout=800000) public void testRegionReplicationOnMidClusterSameHosts(){
  conf.setLong(StochasticLoadBalancer.MAX_STEPS_KEY,2000000L);
  conf.setLong("hbase.master.balancer.stochastic.maxRunningTime",90 * 1000);
  conf.setFloat("hbase.master.balancer.stochastic.maxMovePercent",1.0f);
  loadBalancer.setConf(conf);
  int numHosts=100;
  int numRegions=100 * 100;
  int replication=3;
  int numRegionsPerServer=5;
  int numTables=10;
  Map<ServerName,List<HRegionInfo>> serverMap=createServerMap(numHosts,numRegions,numRegionsPerServer,replication,numTables);
  int numNodesPerHost=4;
  Map<ServerName,List<HRegionInfo>> newServerMap=new TreeMap<ServerName,List<HRegionInfo>>(serverMap);
  for (  Map.Entry<ServerName,List<HRegionInfo>> entry : serverMap.entrySet()) {
    for (int i=1; i < numNodesPerHost; i++) {
      ServerName s1=entry.getKey();
      ServerName s2=ServerName.valueOf(s1.getHostname(),s1.getPort() + i,1);
      newServerMap.put(s2,new ArrayList<HRegionInfo>());
    }
  }
  testWithCluster(newServerMap,null,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSmallCluster(){
  int numNodes=10;
  int numRegions=1000;
  int numRegionsPerServer=40;
  int replication=1;
  int numTables=10;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=800000) public void testMidCluster2(){
  int numNodes=200;
  int numRegions=100000;
  int numRegionsPerServer=40;
  int replication=1;
  int numTables=400;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,false,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSmallCluster2(){
  int numNodes=20;
  int numRegions=2000;
  int numRegionsPerServer=40;
  int replication=1;
  int numTables=10;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=800000) public void testRegionReplicasOnSmallCluster(){
  int numNodes=10;
  int numRegions=1000;
  int replication=3;
  int numRegionsPerServer=80;
  int numTables=10;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=800000) public void testMidCluster(){
  int numNodes=100;
  int numRegions=10000;
  int numRegionsPerServer=60;
  int replication=1;
  int numTables=40;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=800000) public void testRegionReplicationOnMidClusterWithRacks(){
  conf.setLong(StochasticLoadBalancer.MAX_STEPS_KEY,10000000L);
  conf.setFloat("hbase.master.balancer.stochastic.maxMovePercent",1.0f);
  conf.setLong("hbase.master.balancer.stochastic.maxRunningTime",120 * 1000);
  loadBalancer.setConf(conf);
  int numNodes=30;
  int numRegions=numNodes * 30;
  int replication=3;
  int numRegionsPerServer=28;
  int numTables=10;
  int numRacks=4;
  Map<ServerName,List<HRegionInfo>> serverMap=createServerMap(numNodes,numRegions,numRegionsPerServer,replication,numTables);
  RackManager rm=new ForTestRackManager(numRacks);
  testWithCluster(serverMap,rm,false,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLargeCluster(){
  int numNodes=1000;
  int numRegions=100000;
  int numRegionsPerServer=80;
  int numTables=100;
  int replication=1;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSmallCluster3(){
  int numNodes=20;
  int numRegions=2000;
  int numRegionsPerServer=1;
  int replication=1;
  int numTables=10;
  testWithCluster(numNodes,numRegions,numRegionsPerServer,replication,numTables,false,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.cleaner.TestLogsCleaner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=5000) public void testZnodeCversionChange() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  ReplicationLogCleaner cleaner=new ReplicationLogCleaner();
  cleaner.setConf(conf);
  ReplicationQueuesClient rqcMock=Mockito.mock(ReplicationQueuesClient.class);
  Mockito.when(rqcMock.getQueuesZNodeCversion()).thenReturn(1,2,3,4);
  Field rqc=ReplicationLogCleaner.class.getDeclaredField("replicationQueues");
  rqc.setAccessible(true);
  rqc.set(cleaner,rqcMock);
  cleaner.getDeletableFiles(new LinkedList<FileStatus>());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.handler.TestTableDescriptorModification </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteColumn() throws IOException {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  baseHtd.addFamily(new HColumnDescriptor(FAMILY_0));
  baseHtd.addFamily(new HColumnDescriptor(FAMILY_1));
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyTableDescriptor(TABLE_NAME,FAMILY_0,FAMILY_1);
    admin.deleteColumnFamily(TABLE_NAME,FAMILY_1);
    verifyTableDescriptor(TABLE_NAME,FAMILY_0);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddColumn() throws IOException {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  baseHtd.addFamily(new HColumnDescriptor(FAMILY_0));
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyTableDescriptor(TABLE_NAME,FAMILY_0);
    admin.addColumnFamily(TABLE_NAME,new HColumnDescriptor(FAMILY_1));
    verifyTableDescriptor(TABLE_NAME,FAMILY_0,FAMILY_1);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testModifyTable() throws IOException {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HTableDescriptor baseHtd=new HTableDescriptor(TABLE_NAME);
  baseHtd.addFamily(new HColumnDescriptor(FAMILY_0));
  admin.createTable(baseHtd);
  admin.disableTable(TABLE_NAME);
  try {
    verifyTableDescriptor(TABLE_NAME,FAMILY_0);
    HTableDescriptor modifiedHtd=new HTableDescriptor(TABLE_NAME);
    modifiedHtd.addFamily(new HColumnDescriptor(FAMILY_0));
    modifiedHtd.addFamily(new HColumnDescriptor(FAMILY_1));
    admin.modifyTable(TABLE_NAME,modifiedHtd);
    verifyTableDescriptor(TABLE_NAME,FAMILY_0,FAMILY_1);
  }
  finally {
    admin.deleteTable(TABLE_NAME);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.normalizer.TestSimpleRegionNormalizerOnCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) @SuppressWarnings("deprecation") public void testRegionNormalizationSplitOnCluster() throws Exception {
  testRegionNormalizationSplitOnCluster(false);
  testRegionNormalizationSplitOnCluster(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestAddColumnFamilyProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOffline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOffline");
  final String cf4="cf4";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf4);
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3");
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new AddColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=AddColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,AddColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyAddition(UTIL.getHBaseCluster().getMaster(),tableName,cf4);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final String cf6="cf6";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf6);
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2");
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new AddColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=AddColumnFamilyState.values().length - 2;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,AddColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyDeletion(UTIL.getHBaseCluster().getMaster(),tableName,cf6);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testAddColumnFamily() throws Exception {
  final TableName tableName=TableName.valueOf("testAddColumnFamily");
  final String cf1="cf1";
  final String cf2="cf2";
  final HColumnDescriptor columnDescriptor1=new HColumnDescriptor(cf1);
  final HColumnDescriptor columnDescriptor2=new HColumnDescriptor(cf2);
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f3");
  long procId1=procExec.submitProcedure(new AddColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor1),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId1);
  MasterProcedureTestingUtility.validateColumnFamilyAddition(UTIL.getHBaseCluster().getMaster(),tableName,cf1);
  UTIL.getHBaseAdmin().disableTable(tableName);
  long procId2=procExec.submitProcedure(new AddColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor2),nonceGroup + 1,nonce + 1);
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId2);
  MasterProcedureTestingUtility.validateColumnFamilyAddition(UTIL.getHBaseCluster().getMaster(),tableName,cf2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOnline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOnline");
  final String cf5="cf5";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf5);
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3");
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new AddColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=AddColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,AddColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyAddition(UTIL.getHBaseCluster().getMaster(),tableName,cf5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestCreateNamespaceProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final NamespaceDescriptor nsd=NamespaceDescriptor.create("testRecoveryAndDoubleExecution").build();
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new CreateNamespaceProcedure(procExec.getEnvironment(),nsd),nonceGroup,nonce);
  int numberOfSteps=CreateNamespaceState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,CreateNamespaceState.values());
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  validateNamespaceCreated(nsd);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCreateNamespace() throws Exception {
  final NamespaceDescriptor nsd=NamespaceDescriptor.create("testCreateNamespace").build();
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  long procId=procExec.submitProcedure(new CreateNamespaceProcedure(procExec.getEnvironment(),nsd),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  validateNamespaceCreated(nsd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestCreateTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) public void testRollbackAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  testRollbackAndDoubleExecution(MasterProcedureTestingUtility.createHTD(tableName,"f1","f2"));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleCreateWithSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleCreateWithSplits");
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  testSimpleCreate(tableName,splitKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) public void testRollbackRetriableFailure() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackRetriableFailure");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  HTableDescriptor htd=MasterProcedureTestingUtility.createHTD(tableName,"f1","f2");
  HRegionInfo[] regions=ModifyRegionUtils.createHRegionInfos(htd,splitKeys);
  long procId=procExec.submitProcedure(new FaultyCreateTableProcedure(procExec.getEnvironment(),htd,regions),nonceGroup,nonce);
  MasterProcedureTestingUtility.testRollbackRetriableFailure(procExec,procId,4,CreateTableState.values());
  MasterProcedureTestingUtility.validateTableDeletion(UTIL.getHBaseCluster().getMaster(),tableName,regions,"f1","f2");
  resetProcExecutorTestingKillFlag();
  testSimpleCreate(tableName,splitKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleCreate() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleCreate");
  final byte[][] splitKeys=null;
  testSimpleCreate(tableName,splitKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) public void testRollbackAndDoubleExecutionOnMobTable() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecutionOnMobTable");
  HTableDescriptor htd=MasterProcedureTestingUtility.createHTD(tableName,"f1","f2");
  htd.getFamily(Bytes.toBytes("f1")).setMobEnabled(true);
  testRollbackAndDoubleExecution(htd);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000,expected=TableExistsException.class) public void testCreateExisting() throws Exception {
  final TableName tableName=TableName.valueOf("testCreateExisting");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  final HTableDescriptor htd=MasterProcedureTestingUtility.createHTD(tableName,"f");
  final HRegionInfo[] regions=ModifyRegionUtils.createHRegionInfos(htd,null);
  long procId1=procExec.submitProcedure(new CreateTableProcedure(procExec.getEnvironment(),htd,regions),nonceGroup,nonce);
  ProcedurePrepareLatch latch2=new ProcedurePrepareLatch.CompatibilityLatch();
  long procId2=procExec.submitProcedure(new CreateTableProcedure(procExec.getEnvironment(),htd,regions,latch2),nonceGroup + 1,nonce + 1);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec.getResult(procId1));
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  latch2.await();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecution");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  byte[][] splitKeys=null;
  HTableDescriptor htd=MasterProcedureTestingUtility.createHTD(tableName,"f1","f2");
  HRegionInfo[] regions=ModifyRegionUtils.createHRegionInfos(htd,splitKeys);
  long procId=procExec.submitProcedure(new CreateTableProcedure(procExec.getEnvironment(),htd,regions),nonceGroup,nonce);
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,6,CreateTableState.values());
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,"f1","f2");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDeleteColumnFamilyProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOnline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOnline");
  final String cf5="cf5";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3",cf5);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf5.getBytes()),nonceGroup,nonce);
  int numberOfSteps=DeleteColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,DeleteColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyDeletion(UTIL.getHBaseCluster().getMaster(),tableName,cf5);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testDeleteColumnFamily() throws Exception {
  final TableName tableName=TableName.valueOf("testDeleteColumnFamily");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  final String cf1="cf1";
  final String cf2="cf2";
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,cf1,cf2,"f3");
  long procId1=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf1.getBytes()),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId1);
  MasterProcedureTestingUtility.validateColumnFamilyDeletion(UTIL.getHBaseCluster().getMaster(),tableName,cf1);
  UTIL.getHBaseAdmin().disableTable(tableName);
  long procId2=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf2.getBytes()),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecutionAfterPONR() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecutionAfterPONR");
  final String cf5="cf5";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3",cf5);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf5.getBytes()),nonceGroup,nonce);
  int numberOfSteps=4;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecutionAfterPONR(procExec,procId,numberOfSteps,DeleteColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyDeletion(UTIL.getHBaseCluster().getMaster(),tableName,cf5);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOffline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOffline");
  final String cf4="cf4";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3",cf4);
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf4.getBytes()),nonceGroup,nonce);
  int numberOfSteps=DeleteColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,DeleteColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyDeletion(UTIL.getHBaseCluster().getMaster(),tableName,cf4);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final String cf5="cf5";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2","f3",cf5);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteColumnFamilyProcedure(procExec.getEnvironment(),tableName,cf5.getBytes()),nonceGroup,nonce);
  int numberOfSteps=1;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,DeleteColumnFamilyState.values());
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,"f1","f2","f3",cf5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDeleteNamespaceProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testDeleteNamespace() throws Exception {
  final String namespaceName="testDeleteNamespace";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  createNamespaceForTesting(namespaceName);
  long procId=procExec.submitProcedure(new DeleteNamespaceProcedure(procExec.getEnvironment(),namespaceName),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  validateNamespaceNotExist(namespaceName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final String namespaceName="testRecoveryAndDoubleExecution";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  createNamespaceForTesting(namespaceName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteNamespaceProcedure(procExec.getEnvironment(),namespaceName),nonceGroup,nonce);
  int numberOfSteps=DeleteNamespaceState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,DeleteNamespaceState.values());
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  validateNamespaceNotExist(namespaceName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDeleteTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecution");
  byte[][] splitKeys=null;
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(getMasterProcedureExecutor(),tableName,splitKeys,"f1","f2");
  UTIL.getHBaseAdmin().disableTable(tableName);
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DeleteTableProcedure(procExec.getEnvironment(),tableName),nonceGroup,nonce);
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,6,DeleteTableState.values());
  MasterProcedureTestingUtility.validateTableDeletion(UTIL.getHBaseCluster().getMaster(),tableName,regions,"f1","f2");
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000,expected=TableNotDisabledException.class) public void testDeleteNotDisabledTable() throws Exception {
  final TableName tableName=TableName.valueOf("testDeleteNotDisabledTable");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f");
  ProcedurePrepareLatch latch=new ProcedurePrepareLatch.CompatibilityLatch();
  long procId=ProcedureTestingUtility.submitAndWait(procExec,new DeleteTableProcedure(procExec.getEnvironment(),tableName,latch));
  latch.await();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleDelete() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleDelete");
  final byte[][] splitKeys=null;
  testSimpleDelete(tableName,splitKeys);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000,expected=TableNotFoundException.class) public void testDeleteNotExistentTable() throws Exception {
  final TableName tableName=TableName.valueOf("testDeleteNotExistentTable");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  ProcedurePrepareLatch latch=new ProcedurePrepareLatch.CompatibilityLatch();
  long procId=ProcedureTestingUtility.submitAndWait(procExec,new DeleteTableProcedure(procExec.getEnvironment(),tableName,latch));
  latch.await();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleDeleteWithSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleDeleteWithSplits");
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  testSimpleDelete(tableName,splitKeys);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestDisableTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecution");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  MasterProcedureTestingUtility.createTable(procExec,tableName,splitKeys,"f1","f2");
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  int numberOfSteps=DisableTableState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,DisableTableState.values());
  MasterProcedureTestingUtility.validateTableIsDisabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testDisableTable() throws Exception {
  final TableName tableName=TableName.valueOf("testDisableTable");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2");
  long procId=procExec.submitProcedure(new DisableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  MasterProcedureTestingUtility.validateTableIsDisabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestEnableTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  MasterProcedureTestingUtility.createTable(procExec,tableName,splitKeys,"f1","f2");
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  int numberOfSteps=EnableTableState.values().length - 2;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,EnableTableState.values());
  MasterProcedureTestingUtility.validateTableIsDisabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testEnableTable() throws Exception {
  final TableName tableName=TableName.valueOf("testEnableTable");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2");
  UTIL.getHBaseAdmin().disableTable(tableName);
  long procId=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId);
  MasterProcedureTestingUtility.validateTableIsEnabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecution");
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  final byte[][] splitKeys=new byte[][]{Bytes.toBytes("a"),Bytes.toBytes("b"),Bytes.toBytes("c")};
  MasterProcedureTestingUtility.createTable(procExec,tableName,splitKeys,"f1","f2");
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  long procId=procExec.submitProcedure(new EnableTableProcedure(procExec.getEnvironment(),tableName,false),nonceGroup,nonce);
  int numberOfSteps=EnableTableState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,EnableTableState.values());
  MasterProcedureTestingUtility.validateTableIsEnabled(UTIL.getHBaseCluster().getMaster(),tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestModifyColumnFamilyProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOnline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOnline");
  final String cf4="cf4";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf4);
  int oldBlockSize=columnDescriptor.getBlocksize();
  int newBlockSize=4 * oldBlockSize;
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2",cf4);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  columnDescriptor.setBlocksize(newBlockSize);
  long procId=procExec.submitProcedure(new ModifyColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=ModifyColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,ModifyColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyModification(UTIL.getHBaseCluster().getMaster(),tableName,cf4,columnDescriptor);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecution() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final String cf3="cf3";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf3);
  int oldBlockSize=columnDescriptor.getBlocksize();
  int newBlockSize=4 * oldBlockSize;
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2",cf3);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  columnDescriptor.setBlocksize(newBlockSize);
  long procId=procExec.submitProcedure(new ModifyColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=ModifyColumnFamilyState.values().length - 2;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,ModifyColumnFamilyState.values());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionOffline() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionOffline");
  final String cf3="cf3";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf3);
  int oldBlockSize=columnDescriptor.getBlocksize();
  int newBlockSize=4 * oldBlockSize;
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,"f1","f2",cf3);
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  columnDescriptor.setBlocksize(newBlockSize);
  long procId=procExec.submitProcedure(new ModifyColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  int numberOfSteps=ModifyColumnFamilyState.values().length;
  MasterProcedureTestingUtility.testRecoveryAndDoubleExecution(procExec,procId,numberOfSteps,ModifyColumnFamilyState.values());
  MasterProcedureTestingUtility.validateColumnFamilyModification(UTIL.getHBaseCluster().getMaster(),tableName,cf3,columnDescriptor);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testModifyColumnFamily() throws Exception {
  final TableName tableName=TableName.valueOf("testModifyColumnFamily");
  final String cf1="cf1";
  final HColumnDescriptor columnDescriptor=new HColumnDescriptor(cf1);
  int oldBlockSize=columnDescriptor.getBlocksize();
  int newBlockSize=3 * oldBlockSize;
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  MasterProcedureTestingUtility.createTable(procExec,tableName,null,cf1,"f2");
  columnDescriptor.setBlocksize(newBlockSize);
  long procId1=procExec.submitProcedure(new ModifyColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup,nonce);
  ProcedureTestingUtility.waitProcedure(procExec,procId1);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId1);
  MasterProcedureTestingUtility.validateColumnFamilyModification(UTIL.getHBaseCluster().getMaster(),tableName,cf1,columnDescriptor);
  UTIL.getHBaseAdmin().disableTable(tableName);
  columnDescriptor.setBlocksize(newBlockSize * 2);
  long procId2=procExec.submitProcedure(new ModifyColumnFamilyProcedure(procExec.getEnvironment(),tableName,columnDescriptor),nonceGroup + 1,nonce + 1);
  ProcedureTestingUtility.waitProcedure(procExec,procId2);
  ProcedureTestingUtility.assertProcNotFailed(procExec,procId2);
  MasterProcedureTestingUtility.validateColumnFamilyModification(UTIL.getHBaseCluster().getMaster(),tableName,cf1,columnDescriptor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestModifyTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecutionAfterPONR() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecutionAfterPONR");
  final String familyToAddName="cf2";
  final String familyToRemove="cf1";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,familyToRemove);
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  htd.setCompactionEnabled(!htd.isCompactionEnabled());
  htd.addFamily(new HColumnDescriptor(familyToAddName));
  htd.removeFamily(familyToRemove.getBytes());
  htd.setRegionReplication(3);
  long procId=procExec.submitProcedure(new ModifyTableProcedure(procExec.getEnvironment(),htd),nonceGroup,nonce);
  int numberOfSteps=5;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecutionAfterPONR(procExec,procId,numberOfSteps,ModifyTableState.values());
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,false,familyToAddName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecutionOffline() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final String familyName="cf2";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,"cf1");
  UTIL.getHBaseAdmin().disableTable(tableName);
  ProcedureTestingUtility.waitNoProcedureRunning(procExec);
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  boolean newCompactionEnableOption=htd.isCompactionEnabled() ? false : true;
  htd.setCompactionEnabled(newCompactionEnableOption);
  htd.addFamily(new HColumnDescriptor(familyName));
  htd.setRegionReplication(3);
  long procId=procExec.submitProcedure(new ModifyTableProcedure(procExec.getEnvironment(),htd),nonceGroup,nonce);
  int numberOfSteps=ModifyTableState.values().length - 4;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,ModifyTableState.values());
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,"cf1");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRollbackAndDoubleExecutionOnline() throws Exception {
  final TableName tableName=TableName.valueOf("testRollbackAndDoubleExecution");
  final String familyName="cf2";
  final ProcedureExecutor<MasterProcedureEnv> procExec=getMasterProcedureExecutor();
  HRegionInfo[] regions=MasterProcedureTestingUtility.createTable(procExec,tableName,null,"cf1");
  ProcedureTestingUtility.setKillAndToggleBeforeStoreUpdate(procExec,true);
  HTableDescriptor htd=new HTableDescriptor(UTIL.getHBaseAdmin().getTableDescriptor(tableName));
  boolean newCompactionEnableOption=htd.isCompactionEnabled() ? false : true;
  htd.setCompactionEnabled(newCompactionEnableOption);
  htd.addFamily(new HColumnDescriptor(familyName));
  long procId=procExec.submitProcedure(new ModifyTableProcedure(procExec.getEnvironment(),htd),nonceGroup,nonce);
  int numberOfSteps=ModifyTableState.values().length - 4;
  MasterProcedureTestingUtility.testRollbackAndDoubleExecution(procExec,procId,numberOfSteps,ModifyTableState.values());
  MasterProcedureTestingUtility.validateTableCreation(UTIL.getHBaseCluster().getMaster(),tableName,regions,"cf1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.procedure.TestTruncateTableProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleTruncateNoPreserveSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleTruncateNoPreserveSplits");
  testSimpleTruncate(tableName,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionNoPreserveSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionNoPreserveSplits");
  testRecoveryAndDoubleExecution(tableName,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testRecoveryAndDoubleExecutionPreserveSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testRecoveryAndDoubleExecutionPreserveSplits");
  testRecoveryAndDoubleExecution(tableName,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSimpleTruncatePreserveSplits() throws Exception {
  final TableName tableName=TableName.valueOf("testSimpleTruncatePreserveSplits");
  testSimpleTruncate(tableName,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.master.snapshot.TestSnapshotFileCache </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=10000000) public void testLoadAndDelete() throws IOException {
  long period=Long.MAX_VALUE;
  SnapshotFileCache cache=new SnapshotFileCache(fs,rootDir,period,10000000,"test-snapshot-file-cache-refresh",new SnapshotFiles());
  createAndTestSnapshotV1(cache,"snapshot1a",false,true);
  createAndTestSnapshotV1(cache,"snapshot1b",true,true);
  createAndTestSnapshotV2(cache,"snapshot2a",false,true);
  createAndTestSnapshotV2(cache,"snapshot2b",true,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSnapshotTempDirReload() throws IOException {
  long period=Long.MAX_VALUE;
  SnapshotFileCache cache=new SnapshotFileCache(fs,rootDir,period,10000000,"test-snapshot-file-cache-refresh",new SnapshotFiles());
  createAndTestSnapshotV1(cache,"snapshot0v1",false,false);
  createAndTestSnapshotV1(cache,"snapshot0v2",false,false);
  createAndTestSnapshotV2(cache,"snapshot1",true,false);
  createAndTestSnapshotV2(cache,"snapshot2",true,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReloadModifiedDirectory() throws IOException {
  long period=Long.MAX_VALUE;
  SnapshotFileCache cache=new SnapshotFileCache(fs,rootDir,period,10000000,"test-snapshot-file-cache-refresh",new SnapshotFiles());
  createAndTestSnapshotV1(cache,"snapshot1",false,true);
  createAndTestSnapshotV1(cache,"snapshot1",false,false);
  createAndTestSnapshotV2(cache,"snapshot2",false,true);
  createAndTestSnapshotV2(cache,"snapshot2",false,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.TestDefaultMobStoreFlusher </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlushNonMobFile() throws Exception {
  TableName tn=TableName.valueOf("testFlushNonMobFile");
  HTableDescriptor desc=new HTableDescriptor(tn);
  HColumnDescriptor hcd=new HColumnDescriptor(family);
  hcd.setMaxVersions(4);
  desc.addFamily(hcd);
  testFlushFile(desc);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFlushMobFile() throws Exception {
  TableName tn=TableName.valueOf("testFlushMobFile");
  HTableDescriptor desc=new HTableDescriptor(tn);
  HColumnDescriptor hcd=new HColumnDescriptor(family);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(3L);
  hcd.setMaxVersions(4);
  desc.addFamily(hcd);
  testFlushFile(desc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.TestMobDataBlockEncoding </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataBlockEncoding() throws Exception {
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    testDataBlockEncoding(encoding);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mob.compactions.TestPartitionedMobCompactor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactDelFilesChangeMaxDelFileCount() throws Exception {
  String tableName="testCompactDelFilesWithSmallBatchSize";
  testCompactDelFilesAtBatchSize(tableName,4,2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactDelFilesWithSmallBatchSize() throws Exception {
  String tableName="testCompactDelFilesWithSmallBatchSize";
  testCompactDelFilesAtBatchSize(tableName,4,MobConstants.DEFAULT_MOB_DELFILE_MAX_COUNT);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactionSelectWithAllFiles() throws Exception {
  String tableName="testCompactionSelectWithAllFiles";
  testCompactionAtMergeSize(tableName,MobConstants.DEFAULT_MOB_COMPACTION_MERGEABLE_THRESHOLD,CompactionType.ALL_FILES,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactionSelectWithPartFiles() throws Exception {
  String tableName="testCompactionSelectWithPartFiles";
  testCompactionAtMergeSize(tableName,4000,CompactionType.PART_FILES,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactDelFilesWithDefaultBatchSize() throws Exception {
  String tableName="testCompactDelFilesWithDefaultBatchSize";
  testCompactDelFilesAtBatchSize(tableName,MobConstants.DEFAULT_MOB_COMPACTION_BATCH_SIZE,MobConstants.DEFAULT_MOB_DELFILE_MAX_COUNT);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompactionSelectWithForceAllFiles() throws Exception {
  String tableName="testCompactionSelectWithForceAllFiles";
  testCompactionAtMergeSize(tableName,Long.MAX_VALUE,CompactionType.ALL_FILES,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.mttr.IntegrationTestMTTR </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestartRsHoldingTable() throws Exception {
  run(new ActionCallable(restartRSAction),"RestartRsHoldingTableAction");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveRegion() throws Exception {
  run(new ActionCallable(moveRegionAction),"MoveRegion");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveMeta() throws Exception {
  run(new ActionCallable(moveMetaRegionsAction),"MoveMeta");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestartMaster() throws Exception {
  run(new ActionCallable(restartMasterAction),"RestartMaster");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKillRsHoldingMeta() throws Exception {
  run(new ActionCallable(restartMetaAction),"KillRsHoldingMeta");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.nio.TestSingleByteBuff </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPositionalReads(){
  testPositionalReads(ByteBuffer.allocateDirect(15));
  testPositionalReads(ByteBuffer.allocate(15));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure.TestProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testMultipleMember() throws Exception {
  List<String> members=new ArrayList<String>();
  members.add("member1");
  members.add("member2");
  LatchedProcedure proc=new LatchedProcedure(coord,new ForeignExceptionDispatcher(),100,Integer.MAX_VALUE,"op",null,members);
  final LatchedProcedure procspy=spy(proc);
  new Thread(){
    public void run(){
      procspy.call();
    }
  }
.start();
  procspy.startedAcquireBarrier.await();
  verify(procspy).sendGlobalBarrierStart();
  verify(procspy,never()).sendGlobalBarrierReached();
  verify(procspy,never()).sendGlobalBarrierComplete();
  verify(procspy,never()).barrierAcquiredByMember(anyString());
  procspy.barrierAcquiredByMember(members.get(0));
  verify(procspy).sendGlobalBarrierStart();
  verify(procspy,never()).sendGlobalBarrierReached();
  verify(procspy,never()).sendGlobalBarrierComplete();
  procspy.barrierAcquiredByMember(members.get(1));
  procspy.startedDuringBarrier.await();
  verify(procspy).sendGlobalBarrierStart();
  procspy.barrierReleasedByMember(members.get(0),new byte[0]);
  procspy.barrierReleasedByMember(members.get(1),new byte[0]);
  procspy.completedProcedure.await();
  verify(procspy).sendGlobalBarrierReached();
  verify(procspy).sendGlobalBarrierComplete();
  verify(procspy,never()).receive(any(ForeignException.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * With a single member, verify ordered execution.  The Coordinator side is run in a separate
 * thread so we can only trigger from members and wait for particular state latches.
 */
@Test(timeout=60000) public void testSingleMember() throws Exception {
  List<String> members=new ArrayList<String>();
  members.add("member");
  LatchedProcedure proc=new LatchedProcedure(coord,new ForeignExceptionDispatcher(),100,Integer.MAX_VALUE,"op",null,members);
  final LatchedProcedure procspy=spy(proc);
  new Thread(){
    public void run(){
      procspy.call();
    }
  }
.start();
  proc.startedAcquireBarrier.await();
  verify(procspy).sendGlobalBarrierStart();
  verify(procspy,never()).sendGlobalBarrierReached();
  verify(procspy,never()).sendGlobalBarrierComplete();
  verify(procspy,never()).barrierAcquiredByMember(anyString());
  proc.barrierAcquiredByMember(members.get(0));
  proc.acquiredBarrierLatch.await();
  verify(procspy).sendGlobalBarrierStart();
  proc.barrierReleasedByMember(members.get(0),new byte[0]);
  proc.completedProcedure.await();
  verify(procspy).sendGlobalBarrierReached();
  verify(procspy).sendGlobalBarrierComplete();
  verify(procspy,never()).receive(any(ForeignException.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testBarrieredErrorPropagation() throws Exception {
  List<String> members=new ArrayList<String>();
  members.add("member");
  LatchedProcedure proc=new LatchedProcedure(coord,new ForeignExceptionDispatcher(),100,Integer.MAX_VALUE,"op",null,members);
  final LatchedProcedure procspy=spy(proc);
  Thread t=new Thread(){
    public void run(){
      procspy.call();
    }
  }
;
  t.start();
  procspy.startedAcquireBarrier.await();
  ForeignException cause=new ForeignException("SRC","External Exception");
  procspy.receive(cause);
  procspy.barrierAcquiredByMember(members.get(0));
  t.join();
  verify(procspy).sendGlobalBarrierStart();
  verify(procspy).sendGlobalBarrierComplete();
  verify(procspy,never()).sendGlobalBarrierReached();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testErrorPropagation() throws Exception {
  List<String> members=new ArrayList<String>();
  members.add("member");
  Procedure proc=new Procedure(coord,new ForeignExceptionDispatcher(),100,Integer.MAX_VALUE,"op",null,members);
  final Procedure procspy=spy(proc);
  ForeignException cause=new ForeignException("SRC","External Exception");
  proc.receive(cause);
  Thread t=new Thread(){
    public void run(){
      procspy.call();
    }
  }
;
  t.start();
  t.join();
  verify(procspy,never()).sendGlobalBarrierStart();
  verify(procspy,never()).sendGlobalBarrierReached();
  verify(procspy).sendGlobalBarrierComplete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure.TestProcedureCoordinator </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check handling a connection failure correctly if we get it during the acquiring phase
 */
@Test(timeout=60000) public void testUnreachableControllerDuringPrepare() throws Exception {
  coordinator=buildNewCoordinator();
  List<String> expected=Arrays.asList("cohort");
  Procedure proc=new Procedure(coordinator,WAKE_FREQUENCY,TIMEOUT,procName,procData,expected);
  final Procedure procSpy=spy(proc);
  when(coordinator.createProcedure(any(ForeignExceptionDispatcher.class),eq(procName),eq(procData),anyListOf(String.class))).thenReturn(procSpy);
  IOException cause=new IOException("Failed to reach comms during acquire");
  doThrow(cause).when(controller).sendGlobalBarrierAcquire(eq(procSpy),eq(procData),anyListOf(String.class));
  proc=coordinator.startProcedure(proc.getErrorMonitor(),procName,procData,expected);
  while (!proc.completedLatch.await(WAKE_FREQUENCY,TimeUnit.MILLISECONDS))   ;
  verify(procSpy,atLeastOnce()).receive(any(ForeignException.class));
  verify(coordinator,times(1)).rpcConnectionFailure(anyString(),eq(cause));
  verify(controller,times(1)).sendGlobalBarrierAcquire(procSpy,procData,expected);
  verify(controller,never()).sendGlobalBarrierReached(any(Procedure.class),anyListOf(String.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that if nodes join the barrier early we still correctly handle the progress
 */
@Test(timeout=60000) public void testEarlyJoiningBarrier() throws Exception {
  final String[] cohort=new String[]{"one","two","three","four"};
  coordinator=buildNewCoordinator();
  final ProcedureCoordinator ref=coordinator;
  Procedure task=new Procedure(coordinator,monitor,WAKE_FREQUENCY,TIMEOUT,procName,procData,Arrays.asList(cohort));
  final Procedure spy=spy(task);
  AcquireBarrierAnswer prepare=new AcquireBarrierAnswer(procName,cohort){
    public void doWork(){
      ref.memberAcquiredBarrier(this.opName,this.cohort[0]);
      ref.memberFinishedBarrier(this.opName,this.cohort[0],new byte[0]);
      ref.memberAcquiredBarrier(this.opName,this.cohort[1]);
      ref.memberAcquiredBarrier(this.opName,this.cohort[2]);
      ref.memberFinishedBarrier(this.opName,this.cohort[2],new byte[0]);
      ref.memberAcquiredBarrier(this.opName,this.cohort[3]);
    }
  }
;
  BarrierAnswer commit=new BarrierAnswer(procName,cohort){
    @Override public void doWork(){
      ref.memberFinishedBarrier(opName,this.cohort[1],new byte[0]);
      ref.memberFinishedBarrier(opName,this.cohort[3],new byte[0]);
    }
  }
;
  runCoordinatedOperation(spy,prepare,commit,cohort);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Check handling a connection failure correctly if we get it during the barrier phase
 */
@Test(timeout=60000) public void testUnreachableControllerDuringCommit() throws Exception {
  coordinator=buildNewCoordinator();
  List<String> expected=Arrays.asList("cohort");
  final Procedure spy=spy(new Procedure(coordinator,WAKE_FREQUENCY,TIMEOUT,procName,procData,expected));
  when(coordinator.createProcedure(any(ForeignExceptionDispatcher.class),eq(procName),eq(procData),anyListOf(String.class))).thenReturn(spy);
  IOException cause=new IOException("Failed to reach controller during prepare");
  doAnswer(new AcquireBarrierAnswer(procName,new String[]{"cohort"})).when(controller).sendGlobalBarrierAcquire(eq(spy),eq(procData),anyListOf(String.class));
  doThrow(cause).when(controller).sendGlobalBarrierReached(eq(spy),anyListOf(String.class));
  Procedure task=coordinator.startProcedure(spy.getErrorMonitor(),procName,procData,expected);
  while (!task.completedLatch.await(WAKE_FREQUENCY,TimeUnit.MILLISECONDS))   ;
  verify(spy,atLeastOnce()).receive(any(ForeignException.class));
  verify(coordinator,times(1)).rpcConnectionFailure(anyString(),eq(cause));
  verify(controller,times(1)).sendGlobalBarrierAcquire(eq(spy),eq(procData),anyListOf(String.class));
  verify(controller,times(1)).sendGlobalBarrierReached(any(Procedure.class),anyListOf(String.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testMultipleCohortOrchestration() throws Exception {
  runSimpleProcedure("one","two","three","four");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testNoCohort() throws Exception {
  runSimpleProcedure();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testSingleCohortOrchestration() throws Exception {
  runSimpleProcedure("one");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure.TestProcedureMember </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Fail correctly if coordinator aborts the procedure.  The subprocedure will not interrupt a
 * running {@link Subprocedure#prepare} -- prepare needs to finish first, and the the abort
 * is checked.  Thus, the {@link Subprocedure#prepare} should succeed but later get rolled back
 * via {@link Subprocedure#cleanup}.
 */
@Test(timeout=60000) public void testCoordinatorAbort() throws Exception {
  buildCohortMemberPair();
  final TimeoutException oate=new TimeoutException("bogus timeout",1,2,0);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      spySub.cancel("bogus message",oate);
      Thread.sleep(WAKE_FREQUENCY);
      return null;
    }
  }
).when(spySub).waitForReachedGlobalBarrier();
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  member.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spySub);
  order.verify(spySub).acquireBarrier();
  order.verify(mockMemberComms).sendMemberAcquired(eq(spySub));
  order.verify(spySub,never()).insideBarrier();
  order.verify(mockMemberComms,never()).sendMemberCompleted(eq(spySub),eq(data));
  order.verify(spySub).cancel(anyString(),any(Exception.class));
  order.verify(spySub).cleanup(any(Exception.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that the cohort member correctly doesn't attempt to start a task when the builder cannot
 * correctly build a new task for the requested operation
 * @throws Exception on failure
 */
@Test public void testNoTaskToBeRunFromRequest() throws Exception {
  ThreadPoolExecutor pool=mock(ThreadPoolExecutor.class);
  when(mockBuilder.buildSubprocedure(op,data)).thenReturn(null).thenThrow(new IllegalStateException("Wrong state!"),new IllegalArgumentException("can't understand the args"));
  member=new ProcedureMember(mockMemberComms,pool,mockBuilder);
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  try {
    Subprocedure subproc2=member.createSubprocedure(op,data);
    member.submitSubprocedure(subproc2);
  }
 catch (  IllegalStateException ise) {
  }
  try {
    Subprocedure subproc3=member.createSubprocedure(op,data);
    member.submitSubprocedure(subproc3);
  }
 catch (  IllegalArgumentException iae) {
  }
  verifyZeroInteractions(pool);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Handle failures if a member's commit phase fails.
 * NOTE: This is the core difference that makes this different from traditional 2PC.  In true
 * 2PC the transaction is committed just before the coordinator sends commit messages to the
 * member.  Members are then responsible for reading its TX log.  This implementation actually
 * rolls back, and thus breaks the normal TX guarantees.
 */
@Test(timeout=60000) public void testMemberCommitException() throws Exception {
  buildCohortMemberPair();
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      throw new IOException("Forced IOException in memeber prepare");
    }
  }
).when(spySub).insideBarrier();
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  member.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spySub);
  order.verify(spySub).acquireBarrier();
  order.verify(mockMemberComms).sendMemberAcquired(eq(spySub));
  order.verify(spySub).insideBarrier();
  order.verify(mockMemberComms,never()).sendMemberCompleted(eq(spySub),eq(data));
  order.verify(spySub).cancel(anyString(),any(Exception.class));
  order.verify(spySub).cleanup(any(Exception.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the normal sub procedure execution case.
 */
@Test(timeout=500) public void testSimpleRun() throws Exception {
  member=buildCohortMember();
  EmptySubprocedure subproc=new EmptySubprocedure(member,mockListener);
  EmptySubprocedure spy=spy(subproc);
  when(mockBuilder.buildSubprocedure(op,data)).thenReturn(spy);
  addCommitAnswer();
  Subprocedure subproc1=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc1);
  subproc.waitForLocallyCompleted();
  InOrder order=inOrder(mockMemberComms,spy);
  order.verify(spy).acquireBarrier();
  order.verify(mockMemberComms).sendMemberAcquired(eq(spy));
  order.verify(spy).insideBarrier();
  order.verify(mockMemberComms).sendMemberCompleted(eq(spy),eq(data));
  order.verify(mockMemberComms,never()).sendMemberAborted(eq(spy),any(ForeignException.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Handle Failures if a member's commit phase succeeds but notification to coordinator fails
 * NOTE: This is the core difference that makes this different from traditional 2PC.  In true
 * 2PC the transaction is committed just before the coordinator sends commit messages to the
 * member.  Members are then responsible for reading its TX log.  This implementation actually
 * rolls back, and thus breaks the normal TX guarantees.
 */
@Test(timeout=60000) public void testMemberCommitCommsFailure() throws Exception {
  buildCohortMemberPair();
  final TimeoutException oate=new TimeoutException("bogus timeout",1,2,0);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      spySub.cancel("commit comms fail",oate);
      Thread.sleep(WAKE_FREQUENCY);
      return null;
    }
  }
).when(mockMemberComms).sendMemberCompleted(any(Subprocedure.class),eq(data));
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  member.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spySub);
  order.verify(spySub).acquireBarrier();
  order.verify(mockMemberComms).sendMemberAcquired(eq(spySub));
  order.verify(spySub).insideBarrier();
  order.verify(mockMemberComms).sendMemberCompleted(eq(spySub),eq(data));
  order.verify(spySub).cancel(anyString(),any(Exception.class));
  order.verify(spySub).cleanup(any(Exception.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure we call cleanup etc, when we have an exception during prepare.
 */
@Test(timeout=60000) public void testSendMemberAcquiredCommsFailure() throws Exception {
  buildCohortMemberPair();
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      throw new IOException("Forced IOException in memeber prepare");
    }
  }
).when(mockMemberComms).sendMemberAcquired(any(Subprocedure.class));
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  member.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spySub);
  order.verify(spySub).acquireBarrier();
  order.verify(mockMemberComms).sendMemberAcquired(eq(spySub));
  order.verify(spySub,never()).insideBarrier();
  order.verify(mockMemberComms,never()).sendMemberCompleted(eq(spySub),eq(data));
  order.verify(spySub).cancel(anyString(),any(Exception.class));
  order.verify(spySub).cleanup(any(Exception.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure we call cleanup etc, when we have an exception during{@link Subprocedure#acquireBarrier()}.
 */
@Test(timeout=60000) public void testMemberPrepareException() throws Exception {
  buildCohortMemberPair();
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      throw new IOException("Forced IOException in member acquireBarrier");
    }
  }
).when(spySub).acquireBarrier();
  Subprocedure subproc=member.createSubprocedure(op,data);
  member.submitSubprocedure(subproc);
  member.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spySub);
  order.verify(spySub).acquireBarrier();
  order.verify(mockMemberComms,never()).sendMemberAcquired(eq(spySub));
  order.verify(spySub,never()).insideBarrier();
  order.verify(mockMemberComms,never()).sendMemberCompleted(eq(spySub),eq(data));
  order.verify(spySub).cancel(anyString(),any(Exception.class));
  order.verify(spySub).cleanup(any(Exception.class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Fail correctly on getting an external error while waiting for the prepared latch
 * @throws Exception on failure
 */
@Test(timeout=60000) public void testPropagateConnectionErrorBackToManager() throws Exception {
  member=buildCohortMember();
  ProcedureMember memberSpy=spy(member);
  final ForeignExceptionDispatcher dispatcher=new ForeignExceptionDispatcher();
  ForeignExceptionDispatcher dispSpy=spy(dispatcher);
  Subprocedure commit=new EmptySubprocedure(member,dispatcher);
  Subprocedure spy=spy(commit);
  when(mockBuilder.buildSubprocedure(op,data)).thenReturn(spy);
  doThrow(new ForeignException("SRC","prepare exception")).when(spy).acquireBarrier();
  doThrow(new IOException("Controller is down!")).when(mockMemberComms).sendMemberAborted(eq(spy),any(ForeignException.class));
  Subprocedure subproc=memberSpy.createSubprocedure(op,data);
  memberSpy.submitSubprocedure(subproc);
  memberSpy.closeAndWait(TIMEOUT);
  InOrder order=inOrder(mockMemberComms,spy,dispSpy);
  order.verify(spy).acquireBarrier();
  order.verify(mockMemberComms,never()).sendMemberAcquired(spy);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure.TestZKProcedure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleMembers() throws Exception {
  runCommit("one","two","three","four");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleMember() throws Exception {
  runCommit("one");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyMemberSet() throws Exception {
  runCommit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure.TestZKProcedureControllers </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testZKCoordinatorControllerWithNoCohort() throws Exception {
  final String operationName="no cohort controller test";
  final byte[] data=new byte[]{1,2,3};
  runMockCommitWithOrchestratedControllers(startCoordinatorFirst,operationName,data);
  runMockCommitWithOrchestratedControllers(startCohortFirst,operationName,data);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testZKCoordinatorControllerMultipleCohort() throws Exception {
  final String operationName="multi member controller test";
  final byte[] data=new byte[]{1,2,3};
  runMockCommitWithOrchestratedControllers(startCoordinatorFirst,operationName,data,"cohort","cohort2","cohort3");
  runMockCommitWithOrchestratedControllers(startCohortFirst,operationName,data,"cohort","cohort2","cohort3");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testZKCoordinatorControllerWithSingleMemberCohort() throws Exception {
  final String operationName="single member controller test";
  final byte[] data=new byte[]{1,2,3};
  runMockCommitWithOrchestratedControllers(startCoordinatorFirst,operationName,data,"cohort");
  runMockCommitWithOrchestratedControllers(startCohortFirst,operationName,data,"cohort");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestProcedureRecovery </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoopLoad() throws Exception {
  restart();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.procedure2.TestProcedureReplayOrder </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) public void testSingleStepReplayOrder() throws Exception {
  final int NUM_PROC_XTHREAD=32;
  final int NUM_PROCS=NUM_THREADS * NUM_PROC_XTHREAD;
  submitProcedures(NUM_THREADS,NUM_PROC_XTHREAD,TestSingleStepProcedure.class);
  while (procEnv.getExecId() < NUM_PROCS) {
    Thread.sleep(100);
  }
  ProcedureTestingUtility.restart(procExecutor);
  ProcedureTestingUtility.waitNoProcedureRunning(procExecutor);
  procEnv.assertSortedExecList(NUM_PROCS);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=90000) public void testMultiStepReplayOrder() throws Exception {
  final int NUM_PROC_XTHREAD=24;
  final int NUM_PROCS=NUM_THREADS * (NUM_PROC_XTHREAD * 2);
  submitProcedures(NUM_THREADS,NUM_PROC_XTHREAD,TestTwoStepProcedure.class);
  while (procEnv.getExecId() < NUM_PROCS) {
    Thread.sleep(100);
  }
  ProcedureTestingUtility.restart(procExecutor);
  ProcedureTestingUtility.waitNoProcedureRunning(procExecutor);
  procEnv.assertSortedExecList(NUM_PROCS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestQuotaAdmin </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuotaRetrieverFilter() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  TableName[] tables=new TableName[]{TableName.valueOf("T0"),TableName.valueOf("T01"),TableName.valueOf("NS0:T2")};
  String[] namespaces=new String[]{"NS0","NS01","NS2"};
  String[] users=new String[]{"User0","User01","User2"};
  for (  String user : users) {
    admin.setQuota(QuotaSettingsFactory.throttleUser(user,ThrottleType.REQUEST_NUMBER,1,TimeUnit.MINUTES));
    for (    TableName table : tables) {
      admin.setQuota(QuotaSettingsFactory.throttleUser(user,table,ThrottleType.REQUEST_NUMBER,2,TimeUnit.MINUTES));
    }
    for (    String ns : namespaces) {
      admin.setQuota(QuotaSettingsFactory.throttleUser(user,ns,ThrottleType.REQUEST_NUMBER,3,TimeUnit.MINUTES));
    }
  }
  assertNumResults(21,null);
  for (  TableName table : tables) {
    admin.setQuota(QuotaSettingsFactory.throttleTable(table,ThrottleType.REQUEST_NUMBER,4,TimeUnit.MINUTES));
  }
  assertNumResults(24,null);
  for (  String ns : namespaces) {
    admin.setQuota(QuotaSettingsFactory.throttleNamespace(ns,ThrottleType.REQUEST_NUMBER,5,TimeUnit.MINUTES));
  }
  assertNumResults(27,null);
  assertNumResults(7,new QuotaFilter().setUserFilter("User0"));
  assertNumResults(0,new QuotaFilter().setUserFilter("User"));
  assertNumResults(21,new QuotaFilter().setUserFilter("User.*"));
  assertNumResults(3,new QuotaFilter().setUserFilter("User.*").setTableFilter("T0"));
  assertNumResults(3,new QuotaFilter().setUserFilter("User.*").setTableFilter("NS.*"));
  assertNumResults(0,new QuotaFilter().setUserFilter("User.*").setTableFilter("T"));
  assertNumResults(6,new QuotaFilter().setUserFilter("User.*").setTableFilter("T.*"));
  assertNumResults(3,new QuotaFilter().setUserFilter("User.*").setNamespaceFilter("NS0"));
  assertNumResults(0,new QuotaFilter().setUserFilter("User.*").setNamespaceFilter("NS"));
  assertNumResults(9,new QuotaFilter().setUserFilter("User.*").setNamespaceFilter("NS.*"));
  assertNumResults(6,new QuotaFilter().setUserFilter("User.*").setTableFilter("T0").setNamespaceFilter("NS0"));
  assertNumResults(1,new QuotaFilter().setTableFilter("T0"));
  assertNumResults(0,new QuotaFilter().setTableFilter("T"));
  assertNumResults(2,new QuotaFilter().setTableFilter("T.*"));
  assertNumResults(3,new QuotaFilter().setTableFilter(".*T.*"));
  assertNumResults(1,new QuotaFilter().setNamespaceFilter("NS0"));
  assertNumResults(0,new QuotaFilter().setNamespaceFilter("NS"));
  assertNumResults(3,new QuotaFilter().setNamespaceFilter("NS.*"));
  for (  String user : users) {
    admin.setQuota(QuotaSettingsFactory.unthrottleUser(user));
    for (    TableName table : tables) {
      admin.setQuota(QuotaSettingsFactory.unthrottleUser(user,table));
    }
    for (    String ns : namespaces) {
      admin.setQuota(QuotaSettingsFactory.unthrottleUser(user,ns));
    }
  }
  assertNumResults(6,null);
  for (  TableName table : tables) {
    admin.setQuota(QuotaSettingsFactory.unthrottleTable(table));
  }
  assertNumResults(3,null);
  for (  String ns : namespaces) {
    admin.setQuota(QuotaSettingsFactory.unthrottleNamespace(ns));
  }
  assertNumResults(0,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.quotas.TestRateLimiter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWaitIntervalTimeUnitSeconds(){
  testWaitInterval(TimeUnit.SECONDS,10,100);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWaitIntervalTimeUnitMinutes(){
  testWaitInterval(TimeUnit.MINUTES,10,6000);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWaitIntervalTimeUnitHours(){
  testWaitInterval(TimeUnit.HOURS,10,360000);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWaitIntervalTimeUnitDays(){
  testWaitInterval(TimeUnit.DAYS,10,8640000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestAtomicOperation </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test multi-threaded increments.
 */
@Test public void testIncrementMultiThreads() throws IOException {
  boolean fast=true;
  LOG.info("Starting test testIncrementMultiThreads");
  initHRegion(tableName,name.getMethodName(),new int[]{1,3},fam1,fam2);
  int numThreads=100;
  int incrementsPerThread=1000;
  Incrementer[] all=new Incrementer[numThreads];
  int expectedTotal=0;
  for (int i=0; i < numThreads; i++) {
    all[i]=new Incrementer(region,i,i,incrementsPerThread);
    expectedTotal+=(i * incrementsPerThread);
  }
  for (int i=0; i < numThreads; i++) {
    all[i].start();
  }
  for (int i=0; i < numThreads; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
      LOG.info("Ignored",e);
    }
  }
  assertICV(row,fam1,qual1,expectedTotal,fast);
  assertICV(row,fam1,qual2,expectedTotal * 2,fast);
  assertICV(row,fam2,qual3,expectedTotal * 3,fast);
  LOG.info("testIncrementMultiThreads successfully verified that total is " + expectedTotal);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestBlocksScanned </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlocksScanned() throws Exception {
  byte[] tableName=Bytes.toBytes("TestBlocksScanned");
  HTableDescriptor table=new HTableDescriptor(TableName.valueOf(tableName));
  table.addFamily(new HColumnDescriptor(FAMILY).setMaxVersions(10).setBlockCacheEnabled(true).setBlocksize(BLOCK_SIZE).setCompressionType(Compression.Algorithm.NONE));
  _testBlocksScanned(table);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBlocksScannedWithEncoding() throws Exception {
  byte[] tableName=Bytes.toBytes("TestBlocksScannedWithEncoding");
  HTableDescriptor table=new HTableDescriptor(TableName.valueOf(tableName));
  table.addFamily(new HColumnDescriptor(FAMILY).setMaxVersions(10).setBlockCacheEnabled(true).setDataBlockEncoding(DataBlockEncoding.FAST_DIFF).setBlocksize(BLOCK_SIZE).setCompressionType(Compression.Algorithm.NONE));
  _testBlocksScanned(table);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestBulkLoad </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldBulkLoadManyFamilyHLog() throws IOException {
  when(log.append(any(HTableDescriptor.class),any(HRegionInfo.class),any(WALKey.class),argThat(bulkLogWalEditType(WALEdit.BULK_LOAD)),any(boolean.class))).thenAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation){
      WALKey walKey=invocation.getArgumentAt(2,WALKey.class);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  testRegionWithFamilies(family1,family2).bulkLoadHFiles(withFamilyPathsFor(family1,family2),false,null);
  verify(log).sync(anyLong());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void verifyBulkLoadEvent() throws IOException {
  TableName tableName=TableName.valueOf("test","test");
  List<Pair<byte[],String>> familyPaths=withFamilyPathsFor(family1);
  byte[] familyName=familyPaths.get(0).getFirst();
  String storeFileName=familyPaths.get(0).getSecond();
  storeFileName=(new Path(storeFileName)).getName();
  List<String> storeFileNames=new ArrayList<String>();
  storeFileNames.add(storeFileName);
  when(log.append(any(HTableDescriptor.class),any(HRegionInfo.class),any(WALKey.class),argThat(bulkLogWalEdit(WALEdit.BULK_LOAD,tableName.toBytes(),familyName,storeFileNames)),any(boolean.class))).thenAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation){
      WALKey walKey=invocation.getArgumentAt(2,WALKey.class);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  testRegionWithFamiliesAndSpecifiedTableName(tableName,family1).bulkLoadHFiles(familyPaths,false,null);
  verify(log).sync(anyLong());
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=DoNotRetryIOException.class) public void shouldCrashIfBulkLoadFamiliesNotInTable() throws IOException {
  testRegionWithFamilies(family1).bulkLoadHFiles(withFamilyPathsFor(family1,family2),false,null);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=DoNotRetryIOException.class) public void bulkHLogShouldThrowErrorWhenFamilySpecifiedAndHFileExistsButNotInTableDescriptor() throws IOException {
  testRegionWithFamilies().bulkLoadHFiles(withFamilyPathsFor(family1),false,null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bulkHLogShouldThrowNoErrorAndWriteMarkerWithBlankInput() throws IOException {
  testRegionWithFamilies(family1).bulkLoadHFiles(new ArrayList<Pair<byte[],String>>(),false,null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldBulkLoadSingleFamilyHLog() throws IOException {
  when(log.append(any(HTableDescriptor.class),any(HRegionInfo.class),any(WALKey.class),argThat(bulkLogWalEditType(WALEdit.BULK_LOAD)),any(boolean.class))).thenAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation){
      WALKey walKey=invocation.getArgumentAt(2,WALKey.class);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  testRegionWithFamilies(family1).bulkLoadHFiles(withFamilyPathsFor(family1),false,null);
  verify(log).sync(anyLong());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldBulkLoadManyFamilyHLogEvenWhenTableNameNamespaceSpecified() throws IOException {
  when(log.append(any(HTableDescriptor.class),any(HRegionInfo.class),any(WALKey.class),argThat(bulkLogWalEditType(WALEdit.BULK_LOAD)),any(boolean.class))).thenAnswer(new Answer(){
    public Object answer(    InvocationOnMock invocation){
      WALKey walKey=invocation.getArgumentAt(2,WALKey.class);
      MultiVersionConcurrencyControl mvcc=walKey.getMvcc();
      if (mvcc != null) {
        MultiVersionConcurrencyControl.WriteEntry we=mvcc.begin();
        walKey.setWriteEntry(we);
      }
      return 01L;
    }
  }
);
  TableName tableName=TableName.valueOf("test","test");
  testRegionWithFamiliesAndSpecifiedTableName(tableName,family1,family2).bulkLoadHFiles(withFamilyPathsFor(family1,family2),false,null);
  verify(log).sync(anyLong());
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FileNotFoundException.class) public void shouldThrowErrorIfHFileDoesNotExist() throws IOException {
  List<Pair<byte[],String>> list=asList(withMissingHFileForFamily(family1));
  testRegionWithFamilies(family1).bulkLoadHFiles(list,false,null);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=DoNotRetryIOException.class) public void shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath() throws IOException {
  testRegionWithFamilies().bulkLoadHFiles(asList(withInvalidColumnFamilyButProperHFileLocation(family1)),false,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCacheOnWriteInSchema </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCacheOnWriteInSchema() throws IOException {
  StoreFile.Writer writer=store.createWriterInTmp(Integer.MAX_VALUE,HFile.DEFAULT_COMPRESSION_ALGORITHM,false,true,false);
  writeStoreFile(writer);
  writer.close();
  readStoreFile(writer.getPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Create a custom compaction request and be sure that we can track it through the queue, knowing
 * when the compaction is completed.
 */
@Test public void testTrackingCompactionRequest() throws Exception {
  HRegionServer mockServer=Mockito.mock(HRegionServer.class);
  Mockito.when(mockServer.getConfiguration()).thenReturn(r.getBaseConf());
  CompactSplitThread thread=new CompactSplitThread(mockServer);
  Mockito.when(mockServer.getCompactSplitThread()).thenReturn(thread);
  Store store=r.getStore(COLUMN_FAMILY);
  createStoreFile(r);
  for (int i=0; i < MAX_FILES_TO_COMPACT + 1; i++) {
    createStoreFile(r);
  }
  CountDownLatch latch=new CountDownLatch(1);
  TrackableCompactionRequest request=new TrackableCompactionRequest(latch);
  thread.requestCompaction(r,store,"test custom comapction",Store.PRIORITY_USER,request,null);
  latch.await();
  thread.interruptIfNecessary();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * HBASE-7947: Regression test to ensure adding to the correct list in the{@link CompactSplitThread}
 * @throws Exception on failure
 */
@Test public void testMultipleCustomCompactionRequests() throws Exception {
  HRegionServer mockServer=Mockito.mock(HRegionServer.class);
  Mockito.when(mockServer.getConfiguration()).thenReturn(r.getBaseConf());
  CompactSplitThread thread=new CompactSplitThread(mockServer);
  Mockito.when(mockServer.getCompactSplitThread()).thenReturn(thread);
  int numStores=r.getStores().size();
  List<Pair<CompactionRequest,Store>> requests=new ArrayList<Pair<CompactionRequest,Store>>(numStores);
  CountDownLatch latch=new CountDownLatch(numStores);
  for (  Store store : r.getStores()) {
    createStoreFile(r,store.getColumnFamilyName());
    createStoreFile(r,store.getColumnFamilyName());
    createStoreFile(r,store.getColumnFamilyName());
    requests.add(new Pair<CompactionRequest,Store>(new TrackableCompactionRequest(latch),store));
  }
  thread.requestCompaction(r,"test mulitple custom comapctions",Store.PRIORITY_USER,Collections.unmodifiableList(requests),null);
  latch.await();
  thread.interruptIfNecessary();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompactionState </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testMinorCompaction() throws IOException, InterruptedException {
  compaction("testMinorCompaction",15,CompactionState.MINOR,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testMinorCompactionOnFamily() throws IOException, InterruptedException {
  compaction("testMinorCompactionOnFamily",15,CompactionState.MINOR,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testMajorCompaction() throws IOException, InterruptedException {
  compaction("testMajorCompaction",8,CompactionState.MAJOR,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testMajorCompactionOnFamily() throws IOException, InterruptedException {
  compaction("testMajorCompactionOnFamily",8,CompactionState.MAJOR,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestCompoundBloomFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompoundBloomFilter() throws IOException {
  conf.setBoolean(BloomFilterFactory.IO_STOREFILE_BLOOM_ENABLED,true);
  for (int t=0; t < NUM_TESTS; ++t) {
    conf.setFloat(BloomFilterFactory.IO_STOREFILE_BLOOM_ERROR_RATE,(float)TARGET_ERROR_RATES[t]);
    testIdMsg="in test #" + t + ":";
    Random generationRand=new Random(GENERATION_SEED);
    List<KeyValue> kvs=createSortedKeyValues(generationRand,NUM_KV[t]);
    BloomType bt=BLOOM_TYPES[t];
    Path sfPath=writeStoreFile(t,bt,kvs);
    readStoreFile(t,bt,kvs,sfPath);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestEndToEndSplitTransaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the client sees meta table changes as atomic during splits
 */
@Test public void testFromClientSideWhileSplitting() throws Throwable {
  LOG.info("Starting testFromClientSideWhileSplitting");
  final TableName TABLENAME=TableName.valueOf("testFromClientSideWhileSplitting");
  final byte[] FAMILY=Bytes.toBytes("family");
  Table table=TEST_UTIL.createTable(TABLENAME,FAMILY);
  Stoppable stopper=new StoppableImplementation();
  RegionSplitter regionSplitter=new RegionSplitter(table);
  RegionChecker regionChecker=new RegionChecker(CONF,stopper,TABLENAME);
  final ChoreService choreService=new ChoreService("TEST_SERVER");
  choreService.scheduleChore(regionChecker);
  regionSplitter.start();
  regionSplitter.join();
  stopper.stop(null);
  if (regionChecker.ex != null) {
    throw new AssertionError("regionChecker",regionChecker.ex);
  }
  if (regionSplitter.ex != null) {
    throw new AssertionError("regionSplitter",regionSplitter.ex);
  }
  regionChecker.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestExplicitColumnTracker </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Regression test for HBASE-2545
 */
@Test public void testInfiniteLoop() throws IOException {
  TreeSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  columns.addAll(Arrays.asList(new byte[][]{col2,col3,col5}));
  List<byte[]> scanner=Arrays.<byte[]>asList(new byte[][]{col1,col4});
  List<ScanQueryMatcher.MatchCode> expected=Arrays.<ScanQueryMatcher.MatchCode>asList(new ScanQueryMatcher.MatchCode[]{ScanQueryMatcher.MatchCode.SEEK_NEXT_COL,ScanQueryMatcher.MatchCode.SEEK_NEXT_COL});
  runTest(1,columns,scanner,expected);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * hbase-2259
 */
@Test public void testStackOverflow() throws IOException {
  int maxVersions=1;
  TreeSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  for (int i=0; i < 100000; i++) {
    columns.add(Bytes.toBytes("col" + i));
  }
  ColumnTracker explicit=new ExplicitColumnTracker(columns,0,maxVersions,Long.MIN_VALUE);
  for (int i=0; i < 100000; i+=2) {
    byte[] col=Bytes.toBytes("col" + i);
    ScanQueryMatcher.checkColumn(explicit,col,0,col.length,1,KeyValue.Type.Put.getCode(),false);
  }
  explicit.reset();
  for (int i=1; i < 100000; i+=2) {
    byte[] col=Bytes.toBytes("col" + i);
    ScanQueryMatcher.checkColumn(explicit,col,0,col.length,1,KeyValue.Type.Put.getCode(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGet_SingleVersion() throws IOException {
  TreeSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  columns.add(col2);
  columns.add(col4);
  List<MatchCode> expected=new ArrayList<ScanQueryMatcher.MatchCode>();
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW);
  int maxVersions=1;
  List<byte[]> scanner=new ArrayList<byte[]>();
  scanner.add(col1);
  scanner.add(col2);
  scanner.add(col3);
  scanner.add(col4);
  scanner.add(col5);
  runTest(maxVersions,columns,scanner,expected);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGet_MultiVersion() throws IOException {
  TreeSet<byte[]> columns=new TreeSet<byte[]>(Bytes.BYTES_COMPARATOR);
  columns.add(col2);
  columns.add(col4);
  List<ScanQueryMatcher.MatchCode> expected=new ArrayList<ScanQueryMatcher.MatchCode>();
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_ROW);
  int maxVersions=2;
  List<byte[]> scanner=new ArrayList<byte[]>();
  scanner.add(col1);
  scanner.add(col1);
  scanner.add(col1);
  scanner.add(col2);
  scanner.add(col2);
  scanner.add(col2);
  scanner.add(col3);
  scanner.add(col3);
  scanner.add(col3);
  scanner.add(col4);
  scanner.add(col4);
  scanner.add(col4);
  scanner.add(col5);
  scanner.add(col5);
  scanner.add(col5);
  runTest(maxVersions,columns,scanner,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestGetClosestAtOrBefore </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUsingMetaAndBinary() throws IOException {
  FileSystem filesystem=FileSystem.get(conf);
  Path rootdir=UTIL.getDataTestDirOnTestFS();
  UTIL.getMetaTableDescriptor().setMemStoreFlushSize(64 * 1024 * 1024);
  Region mr=HBaseTestingUtility.createRegionAndWAL(HRegionInfo.FIRST_META_REGIONINFO,rootdir,this.conf,UTIL.getMetaTableDescriptor());
  try {
    for (char c='A'; c < 'D'; c++) {
      HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("" + c));
      final int last=128;
      final int interval=2;
      for (int i=0; i <= last; i+=interval) {
        HRegionInfo hri=new HRegionInfo(htd.getTableName(),i == 0 ? HConstants.EMPTY_BYTE_ARRAY : Bytes.toBytes((byte)i),i == last ? HConstants.EMPTY_BYTE_ARRAY : Bytes.toBytes((byte)i + interval));
        Put put=MetaTableAccessor.makePutFromRegionInfo(hri);
        put.setDurability(Durability.SKIP_WAL);
        mr.put(put);
      }
    }
    InternalScanner s=mr.getScanner(new Scan());
    try {
      List<Cell> keys=new ArrayList<Cell>();
      while (s.next(keys)) {
        LOG.info(keys);
        keys.clear();
      }
    }
  finally {
      s.close();
    }
    findRow(mr,'C',44,44);
    findRow(mr,'C',45,44);
    findRow(mr,'C',46,46);
    findRow(mr,'C',43,42);
    mr.flush(true);
    findRow(mr,'C',44,44);
    findRow(mr,'C',45,44);
    findRow(mr,'C',46,46);
    findRow(mr,'C',43,42);
    byte[] firstRowInC=HRegionInfo.createRegionName(TableName.valueOf("" + 'C'),HConstants.EMPTY_BYTE_ARRAY,HConstants.ZEROES,false);
    Scan scan=new Scan(firstRowInC);
    s=mr.getScanner(scan);
    try {
      List<Cell> keys=new ArrayList<Cell>();
      while (s.next(keys)) {
        mr.delete(new Delete(CellUtil.cloneRow(keys.get(0))));
        keys.clear();
      }
    }
  finally {
      s.close();
    }
    findRow(mr,'C',44,-1);
    findRow(mr,'C',45,-1);
    findRow(mr,'C',46,-1);
    findRow(mr,'C',43,-1);
    mr.flush(true);
    findRow(mr,'C',44,-1);
    findRow(mr,'C',45,-1);
    findRow(mr,'C',46,-1);
    findRow(mr,'C',43,-1);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(mr);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegion </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Write an HFile block full with Cells whose qualifier that are identical between
 * 0 and Short.MAX_VALUE. See HBASE-13329.
 * @throws Exception
 */
@Test public void testLongQualifier() throws Exception {
  String method=name.getMethodName();
  TableName tableName=TableName.valueOf(method);
  byte[] family=Bytes.toBytes("family");
  this.region=initHRegion(tableName,method,CONF,family);
  byte[] q=new byte[Short.MAX_VALUE + 2];
  Arrays.fill(q,0,q.length - 1,(byte)42);
  for (byte i=0; i < 10; i++) {
    Put p=new Put(Bytes.toBytes("row"));
    q[q.length - 1]=i;
    p.addColumn(family,q,q);
    region.put(p);
  }
  region.flush(false);
  HBaseTestingUtility.closeRegionAndWAL(this.region);
  this.region=null;
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteColumns_PostInsert() throws IOException, InterruptedException {
  Delete delete=new Delete(row);
  delete.addColumns(fam1,qual1);
  doTestDelete_AndPostInsert(delete);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testaddFamily_PostInsert() throws IOException, InterruptedException {
  Delete delete=new Delete(row);
  delete.addFamily(fam1);
  doTestDelete_AndPostInsert(delete);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegionReplicaSecondary() throws IOException {
  Path rootDir=new Path(dir + "testRegionReplicaSecondary");
  FSUtils.setRootDir(TEST_UTIL.getConfiguration(),rootDir);
  byte[][] families=new byte[][]{Bytes.toBytes("cf1"),Bytes.toBytes("cf2"),Bytes.toBytes("cf3")};
  byte[] cq=Bytes.toBytes("cq");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testRegionReplicaSecondary"));
  for (  byte[] family : families) {
    htd.addFamily(new HColumnDescriptor(family));
  }
  long time=System.currentTimeMillis();
  HRegionInfo primaryHri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,time,0);
  HRegionInfo secondaryHri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,time,1);
  HRegion primaryRegion=null, secondaryRegion=null;
  try {
    primaryRegion=HBaseTestingUtility.createRegionAndWAL(primaryHri,rootDir,TEST_UTIL.getConfiguration(),htd);
    putData(primaryRegion,0,1000,cq,families);
    primaryRegion.flush(true);
    secondaryRegion=HRegion.openHRegion(rootDir,secondaryHri,htd,null,CONF);
    verifyData(secondaryRegion,0,1000,cq,families);
  }
  finally {
    if (primaryRegion != null) {
      HBaseTestingUtility.closeRegionAndWAL(primaryRegion);
    }
    if (secondaryRegion != null) {
      HBaseTestingUtility.closeRegionAndWAL(secondaryRegion);
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDurability() throws Exception {
  String method="testDurability";
  durabilityTest(method,Durability.SYNC_WAL,Durability.SYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.SYNC_WAL,Durability.FSYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.SYNC_WAL,Durability.USE_DEFAULT,0,true,true,false);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.SYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.FSYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.USE_DEFAULT,0,true,true,false);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.SYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.FSYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.SKIP_WAL,Durability.SYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.SKIP_WAL,Durability.FSYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.SYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.FSYNC_WAL,0,true,true,false);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.USE_DEFAULT,0,true,true,false);
  durabilityTest(method,Durability.SYNC_WAL,Durability.ASYNC_WAL,0,true,false,false);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.ASYNC_WAL,0,true,false,false);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.ASYNC_WAL,0,true,false,false);
  durabilityTest(method,Durability.SKIP_WAL,Durability.ASYNC_WAL,0,true,false,false);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.ASYNC_WAL,0,true,false,false);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.USE_DEFAULT,0,true,false,false);
  durabilityTest(method,Durability.SYNC_WAL,Durability.ASYNC_WAL,5000,true,false,true);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.ASYNC_WAL,5000,true,false,true);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.ASYNC_WAL,5000,true,false,true);
  durabilityTest(method,Durability.SKIP_WAL,Durability.ASYNC_WAL,5000,true,false,true);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.ASYNC_WAL,5000,true,false,true);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.USE_DEFAULT,5000,true,false,true);
  durabilityTest(method,Durability.SYNC_WAL,Durability.SKIP_WAL,0,true,false,false);
  durabilityTest(method,Durability.FSYNC_WAL,Durability.SKIP_WAL,0,true,false,false);
  durabilityTest(method,Durability.ASYNC_WAL,Durability.SKIP_WAL,0,true,false,false);
  durabilityTest(method,Durability.SKIP_WAL,Durability.SKIP_WAL,0,true,false,false);
  durabilityTest(method,Durability.USE_DEFAULT,Durability.SKIP_WAL,0,true,false,false);
  durabilityTest(method,Durability.SKIP_WAL,Durability.USE_DEFAULT,0,true,false,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecoveredEditsReplayCompaction() throws Exception {
  testRecoveredEditsReplayCompaction(false);
  testRecoveredEditsReplayCompaction(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHRegionReplayEvents </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a region opened in secondary mode would not write region open / close
 * events to its WAL.
 * @throws IOException
 */
@Test public void testSecondaryRegionDoesNotWriteRegionEventsToWAL() throws IOException {
  secondaryRegion.close();
  walSecondary=spy(walSecondary);
  secondaryRegion=HRegion.openHRegion(secondaryHri,htd,walSecondary,CONF,rss,null);
  verify(walSecondary,times(0)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),(WALEdit)any(),anyBoolean());
  putDataByReplay(secondaryRegion,0,10,cq,families);
  secondaryRegion.replayWALFlushStartMarker(FlushDescriptor.newBuilder().setFlushSequenceNumber(10).setTableName(ByteString.copyFrom(primaryRegion.getTableDesc().getTableName().getName())).setAction(FlushAction.START_FLUSH).setEncodedRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getRegionName())).build());
  verify(walSecondary,times(0)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),(WALEdit)any(),anyBoolean());
  secondaryRegion.close();
  verify(walSecondary,times(0)).append((HTableDescriptor)any(),(HRegionInfo)any(),(WALKey)any(),(WALEdit)any(),anyBoolean());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplayingBulkLoadEventWithFileAlreadyDeleted() throws IOException {
  secondaryRegion.replayWALBulkLoadEventMarker(BulkLoadDescriptor.newBuilder().setTableName(ProtobufUtil.toProtoTableName(primaryRegion.getTableDesc().getTableName())).setEncodedRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setBulkloadSeqNum(Long.MAX_VALUE).addStores(StoreDescriptor.newBuilder().setFamilyName(ByteString.copyFrom(families[0])).setStoreHomeDir("/store_home_dir").addStoreFile("/foo").build()).build());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where we receive a flush commit before receiving any flush prepare markers.
 * The memstore edits should be not dropped after the flush commit replay since not every edit
 * will be in flushed files (based on seqId)
 */
@Test public void testReplayFlushCommitMarkerWithoutFlushStartMarkerNonDroppableMemstore() throws IOException {
  testReplayFlushCommitMarkerWithoutFlushStartMarker(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where the secondary region replica is not in reads enabled state because it is
 * waiting for a flush or region open marker from primary region. Replaying flush start and commit
 * entries should restore the reads enabled status in the region and allow the reads
 * to continue.
 */
@Test public void testReplayingFlushWithEmptyMemstoreRestoresReadsEnabledState() throws IOException {
  disableReads(secondaryRegion);
  putData(primaryRegion,Durability.SYNC_WAL,0,100,cq,families);
  primaryRegion.flush(true);
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flush=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flush != null) {
      secondaryRegion.replayWALFlushMarker(flush,entry.getKey().getLogSeqNum());
    }
  }
  verifyData(secondaryRegion,0,100,cq,families);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplayingRegionOpenEventWithFileAlreadyDeleted() throws IOException {
  secondaryRegion.replayWALRegionEventMarker(RegionEventDescriptor.newBuilder().setTableName(ByteString.copyFrom(primaryRegion.getTableDesc().getTableName().getName())).setEncodedRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getRegionName())).setEventType(EventType.REGION_OPEN).setServer(ProtobufUtil.toServerName(ServerName.valueOf("foo",1,1))).setLogSequenceNumber(Long.MAX_VALUE).addStores(StoreDescriptor.newBuilder().setFamilyName(ByteString.copyFrom(families[0])).setStoreHomeDir("/store_home_dir").addStoreFile("/foo").build()).build());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where the secondary region replica is not in reads enabled state because it is
 * waiting for a flush or region open marker from primary region. Replaying region open event
 * entry from primary should restore the reads enabled status in the region and allow the reads
 * to continue.
 */
@Test public void testReplayingRegionOpenEventRestoresReadsEnabledState() throws IOException {
  disableReads(secondaryRegion);
  primaryRegion.close();
  primaryRegion=HRegion.openHRegion(rootDir,primaryHri,htd,walPrimary,CONF,rss,null);
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    RegionEventDescriptor regionEventDesc=WALEdit.getRegionEventDescriptor(entry.getEdit().getCells().get(0));
    if (regionEventDesc != null) {
      secondaryRegion.replayWALRegionEventMarker(regionEventDesc);
    }
  }
  secondaryRegion.get(new Get(Bytes.toBytes(0)));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplayingFlushCommitWithFileAlreadyDeleted() throws IOException {
  secondaryRegion.replayWALFlushCommitMarker(FlushDescriptor.newBuilder().setFlushSequenceNumber(Long.MAX_VALUE).setTableName(ByteString.copyFrom(primaryRegion.getTableDesc().getTableName().getName())).setAction(FlushAction.COMMIT_FLUSH).setEncodedRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getRegionName())).addStoreFlushes(StoreFlushDescriptor.newBuilder().setFamilyName(ByteString.copyFrom(families[0])).setStoreHomeDir("/store_home_dir").addFlushOutput("/foo/baz/bar").build()).build());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where the secondary region replica is not in reads enabled state because it is
 * waiting for a flush or region open marker from primary region. Replaying flush start and commit
 * entries should restore the reads enabled status in the region and allow the reads
 * to continue.
 */
@Test public void testReplayingFlushRestoresReadsEnabledState() throws IOException {
  disableReads(secondaryRegion);
  putData(primaryRegion,Durability.SYNC_WAL,0,100,cq,families);
  primaryRegion.flush(true);
  putData(primaryRegion,Durability.SYNC_WAL,0,100,cq,families);
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    LOG.info(entry);
    if (entry == null) {
      break;
    }
    FlushDescriptor flush=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flush != null) {
      secondaryRegion.replayWALFlushMarker(flush,entry.getKey().getLogSeqNum());
    }
 else {
      replayEdit(secondaryRegion,entry);
    }
  }
  verifyData(secondaryRegion,0,100,cq,families);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplayingCompactionWithFileAlreadyDeleted() throws IOException {
  secondaryRegion.replayWALCompactionMarker(CompactionDescriptor.newBuilder().setTableName(ByteString.copyFrom(primaryRegion.getTableDesc().getTableName().getName())).setEncodedRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setFamilyName(ByteString.copyFrom(families[0])).addCompactionInput("/foo").addCompactionOutput("/bar").setStoreHomeDir("/store_home_dir").setRegionName(ByteString.copyFrom(primaryRegion.getRegionInfo().getRegionName())).build(),true,true,Long.MAX_VALUE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where we receive a flush commit before receiving any flush prepare markers.
 * The memstore edits should be dropped after the flush commit replay since they should be in
 * flushed files
 */
@Test public void testReplayFlushCommitMarkerWithoutFlushStartMarkerDroppableMemstore() throws IOException {
  testReplayFlushCommitMarkerWithoutFlushStartMarker(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where the secondary region replica is not in reads enabled state because it is
 * waiting for a flush or region open marker from primary region. Replaying CANNOT_FLUSH
 * flush marker entry should restore the reads enabled status in the region and allow the reads
 * to continue.
 */
@Test public void testReplayingFlushRequestRestoresReadsEnabledState() throws IOException {
  disableReads(secondaryRegion);
  primaryRegion.flushcache(true,true);
  reader=createWALReaderForPrimary();
  while (true) {
    WAL.Entry entry=reader.next();
    if (entry == null) {
      break;
    }
    FlushDescriptor flush=WALEdit.getFlushDescriptor(entry.getEdit().getCells().get(0));
    if (flush != null) {
      secondaryRegion.replayWALFlushMarker(flush,entry.getKey().getLogSeqNum());
    }
  }
  secondaryRegion.get(new Get(Bytes.toBytes(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestHeapMemoryManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWhenSizeGivenByHeapTunerGoesOutsideRange() throws Exception {
  BlockCacheStub blockCache=new BlockCacheStub((long)(maxHeapSize * 0.4));
  MemstoreFlusherStub memStoreFlusher=new MemstoreFlusherStub((long)(maxHeapSize * 0.4));
  Configuration conf=HBaseConfiguration.create();
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MIN_RANGE_KEY,0.1f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MIN_RANGE_KEY,0.1f);
  conf.setLong(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_PERIOD,1000);
  conf.setInt(DefaultHeapMemoryTuner.NUM_PERIODS_TO_IGNORE,0);
  conf.setClass(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_CLASS,CustomHeapMemoryTuner.class,HeapMemoryTuner.class);
  HeapMemoryManager heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),new RegionServerAccountingStub());
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  heapMemoryManager.start(choreService);
  CustomHeapMemoryTuner.memstoreSize=0.78f;
  CustomHeapMemoryTuner.blockCacheSize=0.02f;
  Thread.sleep(1500);
  assertHeapSpace(0.7f,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.1f,blockCache.maxSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWhenClusterIsWriteHeavy() throws Exception {
  BlockCacheStub blockCache=new BlockCacheStub((long)(maxHeapSize * 0.4));
  MemstoreFlusherStub memStoreFlusher=new MemstoreFlusherStub((long)(maxHeapSize * 0.4));
  RegionServerAccountingStub regionServerAccounting=new RegionServerAccountingStub();
  blockCache.setTestBlockSize(0);
  regionServerAccounting.setTestMemstoreSize((long)(maxHeapSize * 0.4 * 0.8));
  Configuration conf=HBaseConfiguration.create();
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.75f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MIN_RANGE_KEY,0.10f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MIN_RANGE_KEY,0.05f);
  conf.setLong(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_PERIOD,1000);
  conf.setInt(DefaultHeapMemoryTuner.NUM_PERIODS_TO_IGNORE,0);
  HeapMemoryManager heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),regionServerAccounting);
  long oldMemstoreHeapSize=memStoreFlusher.memstoreSize;
  long oldBlockCacheSize=blockCache.maxSize;
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  heapMemoryManager.start(choreService);
  memStoreFlusher.flushType=FlushType.ABOVE_LOWER_MARK;
  memStoreFlusher.requestFlush(null,false);
  memStoreFlusher.requestFlush(null,false);
  memStoreFlusher.requestFlush(null,false);
  memStoreFlusher.requestFlush(null,false);
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE,oldMemstoreHeapSize,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(-(DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE),oldBlockCacheSize,blockCache.maxSize);
  oldMemstoreHeapSize=memStoreFlusher.memstoreSize;
  oldBlockCacheSize=blockCache.maxSize;
  memStoreFlusher.flushType=FlushType.ABOVE_LOWER_MARK;
  memStoreFlusher.requestFlush(null,false);
  memStoreFlusher.requestFlush(null,false);
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE,oldMemstoreHeapSize,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(-(DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE),oldBlockCacheSize,blockCache.maxSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPluggingInHeapMemoryTuner() throws Exception {
  BlockCacheStub blockCache=new BlockCacheStub((long)(maxHeapSize * 0.4));
  MemstoreFlusherStub memStoreFlusher=new MemstoreFlusherStub((long)(maxHeapSize * 0.4));
  Configuration conf=HBaseConfiguration.create();
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.78f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MIN_RANGE_KEY,0.05f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.75f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MIN_RANGE_KEY,0.02f);
  conf.setLong(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_PERIOD,1000);
  conf.setInt(DefaultHeapMemoryTuner.NUM_PERIODS_TO_IGNORE,0);
  conf.setClass(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_CLASS,CustomHeapMemoryTuner.class,HeapMemoryTuner.class);
  HeapMemoryManager heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),new RegionServerAccountingStub());
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  heapMemoryManager.start(choreService);
  CustomHeapMemoryTuner.memstoreSize=0.78f;
  CustomHeapMemoryTuner.blockCacheSize=0.02f;
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.78f,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.02f,blockCache.maxSize);
  CustomHeapMemoryTuner.blockCacheSize=0.75f;
  CustomHeapMemoryTuner.memstoreSize=0.05f;
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpace(0.75f,blockCache.maxSize);
  assertHeapSpace(0.05f,memStoreFlusher.memstoreSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWhenClusterIsReadHeavy() throws Exception {
  BlockCacheStub blockCache=new BlockCacheStub((long)(maxHeapSize * 0.4));
  MemstoreFlusherStub memStoreFlusher=new MemstoreFlusherStub((long)(maxHeapSize * 0.4));
  RegionServerAccountingStub regionServerAccounting=new RegionServerAccountingStub();
  blockCache.setTestBlockSize((long)(maxHeapSize * 0.4 * 0.8));
  regionServerAccounting.setTestMemstoreSize(0);
  Configuration conf=HBaseConfiguration.create();
  conf.setFloat(HeapMemorySizeUtil.MEMSTORE_SIZE_LOWER_LIMIT_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MAX_RANGE_KEY,0.75f);
  conf.setFloat(HeapMemoryManager.MEMSTORE_SIZE_MIN_RANGE_KEY,0.10f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MAX_RANGE_KEY,0.7f);
  conf.setFloat(HeapMemoryManager.BLOCK_CACHE_SIZE_MIN_RANGE_KEY,0.05f);
  conf.setLong(HeapMemoryManager.HBASE_RS_HEAP_MEMORY_TUNER_PERIOD,1000);
  conf.setInt(DefaultHeapMemoryTuner.NUM_PERIODS_TO_IGNORE,0);
  HeapMemoryManager heapMemoryManager=new HeapMemoryManager(blockCache,memStoreFlusher,new RegionServerStub(conf),new RegionServerAccountingStub());
  long oldMemstoreHeapSize=memStoreFlusher.memstoreSize;
  long oldBlockCacheSize=blockCache.maxSize;
  long oldMemstoreLowerMarkSize=7 * oldMemstoreHeapSize / 10;
  long maxTuneSize=oldMemstoreHeapSize - (oldMemstoreLowerMarkSize + oldMemstoreHeapSize) / 2;
  float maxStepValue=(maxTuneSize * 1.0f) / oldMemstoreHeapSize;
  maxStepValue=maxStepValue > DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE ? DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE : maxStepValue;
  final ChoreService choreService=new ChoreService("TEST_SERVER_NAME");
  heapMemoryManager.start(choreService);
  blockCache.evictBlock(null);
  blockCache.evictBlock(null);
  blockCache.evictBlock(null);
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(-maxStepValue,oldMemstoreHeapSize,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(maxStepValue,oldBlockCacheSize,blockCache.maxSize);
  oldMemstoreHeapSize=memStoreFlusher.memstoreSize;
  oldBlockCacheSize=blockCache.maxSize;
  oldMemstoreLowerMarkSize=7 * oldMemstoreHeapSize / 10;
  maxTuneSize=oldMemstoreHeapSize - (oldMemstoreLowerMarkSize + oldMemstoreHeapSize) / 2;
  maxStepValue=(maxTuneSize * 1.0f) / oldMemstoreHeapSize;
  maxStepValue=maxStepValue > DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE ? DefaultHeapMemoryTuner.DEFAULT_MAX_STEP_VALUE : maxStepValue;
  blockCache.evictBlock(null);
  waitForTune(memStoreFlusher,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(-maxStepValue,oldMemstoreHeapSize,memStoreFlusher.memstoreSize);
  assertHeapSpaceDelta(maxStepValue,oldBlockCacheSize,blockCache.maxSize);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestJoinedScanners </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinedScanners() throws Exception {
  String dataNodeHosts[]=new String[]{"host1","host2","host3"};
  int regionServersCount=3;
  HBaseTestingUtility htu=new HBaseTestingUtility();
  final int DEFAULT_BLOCK_SIZE=1024 * 1024;
  htu.getConfiguration().setLong("dfs.blocksize",DEFAULT_BLOCK_SIZE);
  htu.getConfiguration().setInt("dfs.replication",1);
  htu.getConfiguration().setLong("hbase.hregion.max.filesize",322122547200L);
  MiniHBaseCluster cluster=null;
  try {
    cluster=htu.startMiniCluster(1,regionServersCount,dataNodeHosts);
    byte[][] families={cf_essential,cf_joined};
    TableName tableName=TableName.valueOf(this.getClass().getSimpleName());
    HTableDescriptor desc=new HTableDescriptor(tableName);
    for (    byte[] family : families) {
      HColumnDescriptor hcd=new HColumnDescriptor(family);
      hcd.setDataBlockEncoding(blockEncoding);
      desc.addFamily(hcd);
    }
    htu.getHBaseAdmin().createTable(desc);
    Table ht=htu.getConnection().getTable(tableName);
    long rows_to_insert=1000;
    int insert_batch=20;
    long time=System.nanoTime();
    Random rand=new Random(time);
    LOG.info("Make " + Long.toString(rows_to_insert) + " rows, total size = "+ Float.toString(rows_to_insert * valueWidth / 1024 / 1024)+ " MB");
    byte[] val_large=new byte[valueWidth];
    List<Put> puts=new ArrayList<Put>();
    for (long i=0; i < rows_to_insert; i++) {
      Put put=new Put(Bytes.toBytes(Long.toString(i)));
      if (rand.nextInt(100) <= selectionRatio) {
        put.addColumn(cf_essential,col_name,flag_yes);
      }
 else {
        put.addColumn(cf_essential,col_name,flag_no);
      }
      put.addColumn(cf_joined,col_name,val_large);
      puts.add(put);
      if (puts.size() >= insert_batch) {
        ht.put(puts);
        puts.clear();
      }
    }
    if (puts.size() >= 0) {
      ht.put(puts);
      puts.clear();
    }
    LOG.info("Data generated in " + Double.toString((System.nanoTime() - time) / 1000000000.0) + " seconds");
    boolean slow=true;
    for (int i=0; i < 10; ++i) {
      runScanner(ht,slow);
      slow=!slow;
    }
    ht.close();
  }
  finally {
    if (cluster != null) {
      htu.shutdownMiniCluster();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestKeepDeletes </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify correct range demarcation
 */
@Test public void testRanges() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),0,3,HConstants.FOREVER,KeepDeletedCells.TRUE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime();
  Put p=new Put(T1,ts);
  p.addColumn(c0,c0,T1);
  p.addColumn(c0,c1,T1);
  p.addColumn(c1,c0,T1);
  p.addColumn(c1,c1,T1);
  region.put(p);
  p=new Put(T2,ts);
  p.addColumn(c0,c0,T1);
  p.addColumn(c0,c1,T1);
  p.addColumn(c1,c0,T1);
  p.addColumn(c1,c1,T1);
  region.put(p);
  p=new Put(T1,ts + 1);
  p.addColumn(c0,c0,T2);
  p.addColumn(c0,c1,T2);
  p.addColumn(c1,c0,T2);
  p.addColumn(c1,c1,T2);
  region.put(p);
  p=new Put(T2,ts + 1);
  p.addColumn(c0,c0,T2);
  p.addColumn(c0,c1,T2);
  p.addColumn(c1,c0,T2);
  p.addColumn(c1,c1,T2);
  region.put(p);
  Delete d=new Delete(T1,ts + 2);
  d.addColumns(c0,c0,ts + 2);
  region.delete(d);
  d=new Delete(T1,ts + 2);
  d.addFamily(c1,ts + 2);
  region.delete(d);
  d=new Delete(T2,ts + 2);
  d.addFamily(c0,ts + 2);
  region.delete(d);
  d=new Delete(T1,ts - 10);
  d.addFamily(c1,ts - 10);
  region.delete(d);
  checkGet(region,T1,c0,c0,ts + 2,T2,T1);
  checkGet(region,T1,c0,c1,ts + 2,T2,T1);
  checkGet(region,T1,c1,c0,ts + 2,T2,T1);
  checkGet(region,T1,c1,c1,ts + 2,T2,T1);
  checkGet(region,T2,c0,c0,ts + 2,T2,T1);
  checkGet(region,T2,c0,c1,ts + 2,T2,T1);
  checkGet(region,T2,c1,c0,ts + 2,T2,T1);
  checkGet(region,T2,c1,c1,ts + 2,T2,T1);
  checkGet(region,T1,c0,c0,ts + 3);
  checkGet(region,T1,c0,c1,ts + 3,T2,T1);
  checkGet(region,T1,c1,c0,ts + 3);
  checkGet(region,T1,c1,c1,ts + 3);
  checkGet(region,T2,c0,c0,ts + 3);
  checkGet(region,T2,c0,c1,ts + 3);
  checkGet(region,T2,c1,c0,ts + 3,T2,T1);
  checkGet(region,T2,c1,c1,ts + 3,T2,T1);
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMajorCompaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataBlockEncodingInCacheOnly() throws Exception {
  majorCompactionWithDataBlockEncoding(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run compaction and flushing memstore
 * Assert deletes get cleaned up.
 * @throws Exception
 */
@Test public void testMajorCompaction() throws Exception {
  majorCompaction();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataBlockEncodingEverywhere() throws Exception {
  majorCompactionWithDataBlockEncoding(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegion </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegionWrapperMetrics(){
  MetricsRegion mr=new MetricsRegion(new MetricsRegionWrapperStub());
  MetricsRegionAggregateSource agg=mr.getSource().getAggregateSource();
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_storeCount",101,agg);
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_storeFileCount",102,agg);
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_memstoreSize",103,agg);
  HELPER.assertCounter("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_replicaid",0,agg);
  mr.close();
  mr=new MetricsRegion(new MetricsRegionWrapperStub(1));
  agg=mr.getSource().getAggregateSource();
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_storeCount",101,agg);
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_storeFileCount",102,agg);
  HELPER.assertGauge("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_memstoreSize",103,agg);
  HELPER.assertCounter("namespace_TestNS_table_MetricsRegionWrapperStub_region_DEADBEEF001_metric_replicaid",1,agg);
  mr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionServer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSlowCount(){
  for (int i=0; i < 12; i++) {
    rsm.updateAppend(12);
    rsm.updateAppend(1002);
  }
  for (int i=0; i < 13; i++) {
    rsm.updateDelete(13);
    rsm.updateDelete(1003);
  }
  for (int i=0; i < 14; i++) {
    rsm.updateGet(14);
    rsm.updateGet(1004);
  }
  for (int i=0; i < 15; i++) {
    rsm.updateIncrement(15);
    rsm.updateIncrement(1005);
  }
  for (int i=0; i < 16; i++) {
    rsm.updatePut(16);
    rsm.updatePut(1006);
  }
  HELPER.assertCounter("appendNumOps",24,serverSource);
  HELPER.assertCounter("deleteNumOps",26,serverSource);
  HELPER.assertCounter("getNumOps",28,serverSource);
  HELPER.assertCounter("incrementNumOps",30,serverSource);
  HELPER.assertCounter("mutateNumOps",32,serverSource);
  HELPER.assertCounter("slowAppendCount",12,serverSource);
  HELPER.assertCounter("slowDeleteCount",13,serverSource);
  HELPER.assertCounter("slowGetCount",14,serverSource);
  HELPER.assertCounter("slowIncrementCount",15,serverSource);
  HELPER.assertCounter("slowPutCount",16,serverSource);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWrapperSource(){
  HELPER.assertTag("serverName","test",serverSource);
  HELPER.assertTag("clusterId","tClusterId",serverSource);
  HELPER.assertTag("zookeeperQuorum","zk",serverSource);
  HELPER.assertGauge("regionServerStartTime",100,serverSource);
  HELPER.assertGauge("regionCount",101,serverSource);
  HELPER.assertGauge("storeCount",2,serverSource);
  HELPER.assertGauge("hlogFileCount",10,serverSource);
  HELPER.assertGauge("hlogFileSize",1024000,serverSource);
  HELPER.assertGauge("storeFileCount",300,serverSource);
  HELPER.assertGauge("memstoreSize",1025,serverSource);
  HELPER.assertGauge("storeFileSize",1900,serverSource);
  HELPER.assertCounter("totalRequestCount",899,serverSource);
  HELPER.assertCounter("readRequestCount",997,serverSource);
  HELPER.assertCounter("writeRequestCount",707,serverSource);
  HELPER.assertCounter("checkMutateFailedCount",401,serverSource);
  HELPER.assertCounter("checkMutatePassedCount",405,serverSource);
  HELPER.assertGauge("storeFileIndexSize",406,serverSource);
  HELPER.assertGauge("staticIndexSize",407,serverSource);
  HELPER.assertGauge("staticBloomSize",408,serverSource);
  HELPER.assertGauge("mutationsWithoutWALCount",409,serverSource);
  HELPER.assertGauge("mutationsWithoutWALSize",410,serverSource);
  HELPER.assertGauge("percentFilesLocal",99,serverSource);
  HELPER.assertGauge("percentFilesLocalSecondaryRegions",99,serverSource);
  HELPER.assertGauge("compactionQueueLength",411,serverSource);
  HELPER.assertGauge("flushQueueLength",412,serverSource);
  HELPER.assertGauge("blockCacheFreeSize",413,serverSource);
  HELPER.assertGauge("blockCacheCount",414,serverSource);
  HELPER.assertGauge("blockCacheSize",415,serverSource);
  HELPER.assertCounter("blockCacheHitCount",416,serverSource);
  HELPER.assertCounter("blockCacheMissCount",417,serverSource);
  HELPER.assertCounter("blockCacheEvictionCount",418,serverSource);
  HELPER.assertGauge("blockCacheCountHitPercent",98,serverSource);
  HELPER.assertGauge("blockCacheExpressHitPercent",97,serverSource);
  HELPER.assertCounter("blockCacheFailedInsertionCount",36,serverSource);
  HELPER.assertCounter("updatesBlockedTime",419,serverSource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionServerSourceFactory </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsRegionServerSourceFactory.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionServerSourceImpl </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testNoGetRegionServerMetricsSourceImpl() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsRegionServerSourceImpl.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMetricsRegionSourceImpl </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testNoGetRegionServerMetricsSourceImpl() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsRegionSource.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMinVersions </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify behavior of getClosestBefore(...)
 */
@Test public void testGetClosestBefore() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),1,1000,1,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  try {
    long ts=EnvironmentEdgeManager.currentTime() - 2000;
    Put p=new Put(T1,ts);
    p.addColumn(c0,c0,T1);
    region.put(p);
    p=new Put(T1,ts + 1);
    p.addColumn(c0,c0,T4);
    region.put(p);
    p=new Put(T3,ts);
    p.addColumn(c0,c0,T3);
    region.put(p);
    Result r=hbu.getClosestRowBefore(region,T1,c0);
    checkResult(r,c0,T4);
    r=hbu.getClosestRowBefore(region,T2,c0);
    checkResult(r,c0,T4);
    region.flush(true);
    region.compact(true);
    r=hbu.getClosestRowBefore(region,T1,c0);
    checkResult(r,c0,T4);
    r=hbu.getClosestRowBefore(region,T2,c0);
    checkResult(r,c0,T4);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure the Deletes behave as expected with minimum versions
 */
@Test public void testDelete() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),3,1000,1,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime() - 2000;
  try {
    Put p=new Put(T1,ts - 2);
    p.addColumn(c0,c0,T1);
    region.put(p);
    p=new Put(T1,ts - 1);
    p.addColumn(c0,c0,T2);
    region.put(p);
    p=new Put(T1,ts);
    p.addColumn(c0,c0,T3);
    region.put(p);
    Delete d=new Delete(T1,ts - 1);
    region.delete(d);
    Get g=new Get(T1);
    g.setMaxVersions();
    Result r=region.get(g);
    checkResult(r,c0,T3);
    g=new Get(T1);
    g.setMaxVersions();
    g.addColumn(c0,c0);
    r=region.get(g);
    checkResult(r,c0,T3);
    region.flush(true);
    region.compact(true);
    g=new Get(T1);
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c0,T3);
    g=new Get(T1);
    g.setMaxVersions();
    g.addColumn(c0,c0);
    r=region.get(g);
    checkResult(r,c0,T3);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Make sure the memstor behaves correctly with minimum versions
 */
@Test public void testMemStore() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),2,1000,1,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime() - 2000;
  try {
    Put p=new Put(T1,ts - 2);
    p.addColumn(c0,c0,T2);
    region.put(p);
    p=new Put(T1,ts - 1);
    p.addColumn(c0,c0,T3);
    region.put(p);
    p=new Put(T1,ts);
    p.addColumn(c0,c0,T4);
    region.put(p);
    region.flush(true);
    region.compact(true);
    p=new Put(T1,ts - 3);
    p.addColumn(c0,c0,T1);
    region.put(p);
    Result r=region.get(new Get(T1));
    checkResult(r,c0,T4);
    Get g=new Get(T1);
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c0,T4,T3);
    g=new Get(T1);
    g.setMaxVersions();
    g.addColumn(c0,c0);
    r=region.get(g);
    checkResult(r,c0,T4,T3);
    p=new Put(T1,ts + 1);
    p.addColumn(c0,c0,T5);
    region.put(p);
    g=new Get(T1);
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c0,T5,T4);
    g=new Get(T1);
    g.setMaxVersions();
    g.addColumn(c0,c0);
    r=region.get(g);
    checkResult(r,c0,T5,T4);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test mixed memstore and storefile scanning
 * with minimum versions.
 */
@Test public void testStoreMemStore() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),3,1000,1,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  long ts=EnvironmentEdgeManager.currentTime() - 2000;
  try {
    Put p=new Put(T1,ts - 1);
    p.addColumn(c0,c0,T2);
    region.put(p);
    p=new Put(T1,ts - 3);
    p.addColumn(c0,c0,T0);
    region.put(p);
    region.flush(true);
    region.compact(true);
    p=new Put(T1,ts);
    p.addColumn(c0,c0,T3);
    region.put(p);
    p=new Put(T1,ts - 2);
    p.addColumn(c0,c0,T1);
    region.put(p);
    p=new Put(T1,ts - 3);
    p.addColumn(c0,c0,T0);
    region.put(p);
    Get g=new Get(T1);
    g.setMaxVersions();
    Result r=region.get(g);
    checkResult(r,c0,T3,T2,T1);
    g=new Get(T1);
    g.setMaxVersions();
    g.addColumn(c0,c0);
    r=region.get(g);
    checkResult(r,c0,T3,T2,T1);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that basic filters still behave correctly with
 * minimum versions enabled.
 */
@Test public void testFilters() throws Exception {
  HTableDescriptor htd=hbu.createTableDescriptor(name.getMethodName(),2,1000,1,KeepDeletedCells.FALSE);
  Region region=hbu.createLocalHRegion(htd,null,null);
  final byte[] c1=COLUMNS[1];
  long ts=EnvironmentEdgeManager.currentTime() - 2000;
  try {
    Put p=new Put(T1,ts - 3);
    p.addColumn(c0,c0,T0);
    p.addColumn(c1,c1,T0);
    region.put(p);
    p=new Put(T1,ts - 2);
    p.addColumn(c0,c0,T1);
    p.addColumn(c1,c1,T1);
    region.put(p);
    p=new Put(T1,ts - 1);
    p.addColumn(c0,c0,T2);
    p.addColumn(c1,c1,T2);
    region.put(p);
    p=new Put(T1,ts);
    p.addColumn(c0,c0,T3);
    p.addColumn(c1,c1,T3);
    region.put(p);
    List<Long> tss=new ArrayList<Long>();
    tss.add(ts - 1);
    tss.add(ts - 2);
    Get g=new Get(T1);
    g.addColumn(c1,c1);
    g.setFilter(new TimestampsFilter(tss));
    g.setMaxVersions();
    Result r=region.get(g);
    checkResult(r,c1,T2,T1);
    g=new Get(T1);
    g.addColumn(c0,c0);
    g.setFilter(new TimestampsFilter(tss));
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c0,T2,T1);
    region.flush(true);
    region.compact(true);
    g=new Get(T1);
    g.addColumn(c1,c1);
    g.setFilter(new TimestampsFilter(tss));
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c1,T2);
    g=new Get(T1);
    g.addColumn(c0,c0);
    g.setFilter(new TimestampsFilter(tss));
    g.setMaxVersions();
    r=region.get(g);
    checkResult(r,c0,T2);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMinorCompaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteColumn2() throws Exception {
  Delete dc=new Delete(secondRowBytes);
  dc.addColumn(fam2,col2);
  testMinorCompactionWithDelete(dc,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteColumnFamily() throws Exception {
  Delete deleteCF=new Delete(secondRowBytes);
  deleteCF.addFamily(fam2);
  testMinorCompactionWithDelete(deleteCF);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteRow() throws Exception {
  Delete deleteRow=new Delete(secondRowBytes);
  testMinorCompactionWithDelete(deleteRow);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteColumn1() throws Exception {
  Delete dc=new Delete(secondRowBytes);
  dc.addColumns(fam2,col2);
  testMinorCompactionWithDelete(dc);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteVersion2() throws Exception {
  Delete deleteVersion=new Delete(secondRowBytes);
  deleteVersion.addColumn(fam2,col2,1);
  testMinorCompactionWithDelete(deleteVersion,3);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMinorCompactionWithDeleteVersion1() throws Exception {
  Delete deleteVersion=new Delete(secondRowBytes);
  deleteVersion.addColumns(fam2,col2,2);
  testMinorCompactionWithDelete(deleteVersion,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestMobStoreScanner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMobStoreScanner() throws Exception {
  testGetFromFiles(false);
  testGetFromMemStore(false);
  testGetReferences(false);
  testMobThreshold(false);
  testGetFromArchive(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testGetMassive() throws Exception {
  setUp(defaultThreshold,TableName.valueOf("testGetMassive"));
  byte[] bigValue=new byte[25 * 1024 * 1024];
  Put put=new Put(row1);
  put.addColumn(family,qf1,bigValue);
  put.addColumn(family,qf2,bigValue);
  put.addColumn(family,qf3,bigValue);
  table.put(put);
  Get g=new Get(row1);
  Result r=table.get(g);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReversedMobStoreScanner() throws Exception {
  testGetFromFiles(true);
  testGetFromMemStore(true);
  testGetReferences(true);
  testMobThreshold(true);
  testGetFromArchive(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestParallelPut </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test multi-threaded Puts.
 */
@Test public void testParallelPuts() throws IOException {
  LOG.info("Starting testParallelPuts");
  this.region=initHRegion(tableName,getName(),fam1);
  int numOps=1000;
  Putter[] all=new Putter[THREADS100];
  for (int i=0; i < THREADS100; i++) {
    all[i]=new Putter(region,i,numOps);
  }
  for (int i=0; i < THREADS100; i++) {
    all[i].start();
  }
  for (int i=0; i < THREADS100; i++) {
    try {
      all[i].join();
    }
 catch (    InterruptedException e) {
      LOG.warn("testParallelPuts encountered InterruptedException." + " Ignoring....",e);
    }
  }
  LOG.info("testParallelPuts successfully verified " + (numOps * THREADS100) + " put operations.");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test one put command.
 */
@Test public void testPut() throws IOException {
  LOG.info("Starting testPut");
  this.region=initHRegion(tableName,getName(),fam1);
  long value=1L;
  Put put=new Put(row);
  put.addColumn(fam1,qual1,Bytes.toBytes(value));
  region.put(put);
  assertGet(this.region,row,fam1,qual1,Bytes.toBytes(value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush </h4><pre class="type-1 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("DLR is broken by HBASE-12751") @Test(timeout=180000) public void testLogReplayWithDistributedReplay() throws Exception {
  TEST_UTIL.getConfiguration().setBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,true);
  doTestLogReplay();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testLogReplayWithDistributedLogSplit() throws Exception {
  TEST_UTIL.getConfiguration().setBoolean(HConstants.DISTRIBUTED_LOG_REPLAY_KEY,false);
  doTestLogReplay();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestQosFunction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPriority(){
  checkMethod(conf,"ReplicateWALEntry",HConstants.REPLICATION_QOS,qosFunction);
  checkMethod(conf,"OpenRegion",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"Multi",HConstants.NORMAL_QOS,qosFunction,MultiRequest.getDefaultInstance());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnnotations(){
  checkMethod(conf,"CloseRegion",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"CompactRegion",HConstants.ADMIN_QOS,qosFunction);
  checkMethod(conf,"FlushRegion",HConstants.ADMIN_QOS,qosFunction);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestQueryMatcher </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMatch_PartialRangeDropDeletes() throws Exception {
  testDropDeletes(row2,row3,new byte[][]{row1,row2,row2,row3},INCLUDE,SKIP,SKIP,INCLUDE);
  testDropDeletes(row2,row3,new byte[][]{row1,row1,row2},INCLUDE,INCLUDE,SKIP);
  testDropDeletes(row2,row3,new byte[][]{row2,row3,row3},SKIP,INCLUDE,INCLUDE);
  testDropDeletes(row1,row3,new byte[][]{row1,row2,row3},SKIP,SKIP,INCLUDE);
  testDropDeletes(HConstants.EMPTY_START_ROW,row3,new byte[][]{row1,row2,row3},SKIP,SKIP,INCLUDE);
  testDropDeletes(row2,HConstants.EMPTY_END_ROW,new byte[][]{row1,row2,row3},INCLUDE,SKIP,SKIP);
  testDropDeletes(HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,new byte[][]{row1,row2,row3,row3},SKIP,SKIP,SKIP,SKIP);
  testDropDeletes(row2,row3,new byte[][]{row1,row1,row3},INCLUDE,INCLUDE,INCLUDE);
  testDropDeletes(row2,row3,new byte[][]{row3,row3},INCLUDE,INCLUDE);
  testDropDeletes(row2,row3,new byte[][]{row1,row1},INCLUDE,INCLUDE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMatch_ExplicitColumns() throws IOException {
  List<MatchCode> expected=new ArrayList<ScanQueryMatcher.MatchCode>();
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_COL);
  expected.add(ScanQueryMatcher.MatchCode.INCLUDE_AND_SEEK_NEXT_ROW);
  expected.add(ScanQueryMatcher.MatchCode.DONE);
  _testMatch_ExplicitColumns(scan,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRSStatusServlet </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBasic() throws IOException, ServiceException {
  new RSStatusTmpl().render(new StringWriter(),rs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithRegions() throws IOException, ServiceException {
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("mytable"));
  List<HRegionInfo> regions=Lists.newArrayList(new HRegionInfo(htd.getTableName(),Bytes.toBytes("a"),Bytes.toBytes("d")),new HRegionInfo(htd.getTableName(),Bytes.toBytes("d"),Bytes.toBytes("z")));
  Mockito.doReturn(ResponseConverter.buildGetOnlineRegionResponse(regions)).when(rpcServices).getOnlineRegion((RpcController)Mockito.any(),(GetOnlineRegionRequest)Mockito.any());
  new RSStatusTmpl().render(new StringWriter(),rs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionIncrement </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMVCCCausingMisRead() throws IOException {
  final HRegion region=getRegion(TEST_UTIL.getConfiguration(),this.name.getMethodName());
  try {
  }
  finally {
    closeRegion(region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionMergeTransaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test straight prepare works. Tries to merge on {@link #region_a} and{@link #region_b}
 * @throws IOException
 */
@Test public void testPrepare() throws IOException {
  prepareOnGoodRegions();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionMergeTransactionOnCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Not really restarting the master. Simulate it by clear of new region
 * state since it is not persisted, will be lost after master restarts.
 */
@Test public void testMergeAndRestartingMaster() throws Exception {
  LOG.info("Starting testMergeAndRestartingMaster");
  final TableName tableName=TableName.valueOf("testMergeAndRestartingMaster");
  Table table=createTableAndLoadData(master,tableName);
  try {
    MyMasterRpcServices.enabled.set(true);
    mergeRegionsAndVerifyRegionNum(master,tableName,0,1,INITIAL_REGION_NUM - 1);
  }
  finally {
    MyMasterRpcServices.enabled.set(false);
  }
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionReplicaFailover </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where a newly created table with region replicas and no data, the secondary
 * region replicas are available to read immediately.
 */
@Test(timeout=60000) public void testSecondaryRegionWithEmptyRegion() throws IOException {
  try (Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());Table table=connection.getTable(htd.getTableName())){
    Get get=new Get(row);
    get.setConsistency(Consistency.TIMELINE);
    get.setReplicaId(1);
    table.get(get);
  }
 }

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where we are creating a table with a lot of regions and replicas. Opening region
 * replicas should not block handlers on RS indefinitely.
 */
@Test(timeout=120000) public void testLotsOfRegionReplicas() throws IOException {
  int numRegions=NB_SERVERS * 20;
  int regionReplication=10;
  String tableName=htd.getTableName().getNameAsString() + "2";
  htd=HTU.createTableDescriptor(tableName);
  htd.setRegionReplication(regionReplication);
  byte[] startKey=Bytes.toBytes("aaa");
  byte[] endKey=Bytes.toBytes("zzz");
  byte[][] splits=HTU.getRegionSplitStartKeys(startKey,endKey,numRegions);
  HTU.getHBaseAdmin().createTable(htd,startKey,endKey,numRegions);
  try (Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());Table table=connection.getTable(htd.getTableName())){
    for (int i=1; i < splits.length; i++) {
      for (int j=0; j < regionReplication; j++) {
        Get get=new Get(splits[i]);
        get.setConsistency(Consistency.TIMELINE);
        get.setReplicaId(j);
        table.get(get);
      }
    }
  }
   HTU.deleteTableIfAny(TableName.valueOf(tableName));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where if there is some data in the primary region, reopening the region replicas
 * (enable/disable table, etc) makes the region replicas readable.
 * @throws IOException
 */
@Test(timeout=60000) public void testSecondaryRegionWithNonEmptyRegion() throws IOException {
  try (Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());Table table=connection.getTable(htd.getTableName())){
    HTU.loadNumericRows(table,fam,0,1000);
    HTU.getHBaseAdmin().disableTable(htd.getTableName());
    HTU.getHBaseAdmin().enableTable(htd.getTableName());
    HTU.verifyNumericRows(table,fam,0,1000,1);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionReplicas </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the meta location is saved for secondary regions 
 */
@Test(timeout=60000) public void testRegionReplicaUpdatesMetaLocation() throws Exception {
  openRegion(HTU,getRS(),hriSecondary);
  Table meta=null;
  try {
    meta=HTU.getConnection().getTable(TableName.META_TABLE_NAME);
    TestMetaTableAccessor.assertMetaLocation(meta,hriPrimary.getRegionName(),getRS().getServerName(),-1,1,false);
  }
  finally {
    if (meta != null)     meta.close();
    closeRegion(HTU,getRS(),hriSecondary);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerMetrics </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckAndPutCount() throws Exception {
  String tableNameString="testCheckAndPutCount";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] valOne=Bytes.toBytes("Value");
  byte[] valTwo=Bytes.toBytes("ValueTwo");
  byte[] valThree=Bytes.toBytes("ValueThree");
  Table t=TEST_UTIL.createTable(tableName,cf);
  Put p=new Put(row);
  p.addColumn(cf,qualifier,valOne);
  t.put(p);
  Put pTwo=new Put(row);
  pTwo.addColumn(cf,qualifier,valTwo);
  t.checkAndPut(row,cf,qualifier,valOne,pTwo);
  Put pThree=new Put(row);
  pThree.addColumn(cf,qualifier,valThree);
  t.checkAndPut(row,cf,qualifier,valOne,pThree);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("checkMutateFailedCount",1,serverSource);
  metricsHelper.assertCounter("checkMutatePassedCount",1,serverSource);
  t.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMutationsWithoutWal() throws Exception {
  TableName tableName=TableName.valueOf("testMutationsWithoutWal");
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("Value");
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  Table t=TEST_UTIL.createTable(tableName,cf);
  Put p=new Put(row);
  p.addColumn(cf,qualifier,val);
  p.setDurability(Durability.SKIP_WAL);
  t.put(p);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertGauge("mutationsWithoutWALCount",1,serverSource);
  long minLength=row.length + cf.length + qualifier.length+ val.length;
  metricsHelper.assertGaugeGt("mutationsWithoutWALSize",minLength,serverSource);
  t.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocalFiles() throws Exception {
  metricsHelper.assertGauge("percentFilesLocal",0,serverSource);
  metricsHelper.assertGauge("percentFilesLocalSecondaryRegions",0,serverSource);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAppend() throws Exception {
  String tableNameString="testAppend";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("One");
  Table t=TEST_UTIL.createTable(tableName,cf);
  Put p=new Put(row);
  p.addColumn(cf,qualifier,val);
  t.put(p);
  for (int count=0; count < 73; count++) {
    Append append=new Append(row);
    append.add(cf,qualifier,Bytes.toBytes(",Test"));
    t.append(append);
  }
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("appendNumOps",73,serverSource);
  t.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMobMetrics() throws IOException, InterruptedException {
  String tableNameString="testMobMetrics";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("mobdata");
  int numHfiles=conf.getInt("hbase.hstore.compactionThreshold",3) - 1;
  HTableDescriptor htd=new HTableDescriptor(tableName);
  HColumnDescriptor hcd=new HColumnDescriptor(cf);
  hcd.setMobEnabled(true);
  hcd.setMobThreshold(0);
  htd.addFamily(hcd);
  Connection connection=ConnectionFactory.createConnection(conf);
  Admin admin=connection.getAdmin();
  HTable t=TEST_UTIL.createTable(htd,new byte[0][0],conf);
  Region region=rs.getOnlineRegions(tableName).get(0);
  t.setAutoFlush(true,true);
  for (int insertCount=0; insertCount < numHfiles; insertCount++) {
    Put p=new Put(Bytes.toBytes(insertCount));
    p.addColumn(cf,qualifier,val);
    t.put(p);
    admin.flush(tableName);
  }
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("mobFlushCount",numHfiles,serverSource);
  Scan scan=new Scan(Bytes.toBytes(0),Bytes.toBytes(2));
  ResultScanner scanner=t.getScanner(scan);
  scanner.next(100);
  numScanNext++;
  scanner.close();
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("mobScanCellsCount",2,serverSource);
  region.getTableDesc().getFamily(cf).setMobThreshold(100);
  ((HRegion)region).initialize();
  region.compact(true);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("cellsCountCompactedFromMob",numHfiles,serverSource);
  metricsHelper.assertCounter("cellsCountCompactedToMob",0,serverSource);
  scanner=t.getScanner(scan);
  scanner.next(100);
  numScanNext++;
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("mobScanCellsCount",0,serverSource);
  for (int insertCount=numHfiles; insertCount < 2 * numHfiles - 1; insertCount++) {
    Put p=new Put(Bytes.toBytes(insertCount));
    p.addColumn(cf,qualifier,val);
    t.put(p);
    admin.flush(tableName);
  }
  region.getTableDesc().getFamily(cf).setMobThreshold(0);
  ((HRegion)region).initialize();
  region.compact(true);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("cellsCountCompactedFromMob",0,serverSource);
  metricsHelper.assertCounter("cellsCountCompactedToMob",2 * numHfiles - 1,serverSource);
  t.close();
  admin.close();
  connection.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testRegionCount() throws Exception {
  String regionMetricsKey="regionCount";
  long regions=metricsHelper.getGaugeLong(regionMetricsKey,serverSource);
  TEST_UTIL.createTable(TableName.valueOf("table"),Bytes.toBytes("cf"));
  metricsHelper.assertGaugeGt(regionMetricsKey,regions,serverSource);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreCount() throws Exception {
  TableName tableName=TableName.valueOf("testStoreCount");
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes("Value");
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  long stores=metricsHelper.getGaugeLong("storeCount",serverSource);
  long storeFiles=metricsHelper.getGaugeLong("storeFileCount",serverSource);
  Table t=TEST_UTIL.createTable(tableName,cf);
  Put p=new Put(row);
  p.addColumn(cf,qualifier,val);
  t.put(p);
  TEST_UTIL.getHBaseAdmin().flush(tableName);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertGauge("storeCount",stores + 1,serverSource);
  metricsHelper.assertGauge("storeFileCount",storeFiles + 1,serverSource);
  t.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRequestCount() throws Exception {
  String tableNameString="testRequestCount";
  TableName tName=TableName.valueOf(tableNameString);
  byte[] cfName=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] initValue=Bytes.toBytes("Value");
  TEST_UTIL.createTable(tName,cfName);
  Connection connection=TEST_UTIL.getConnection();
  connection.getTable(tName).close();
  Table table=connection.getTable(tName);
  Put p=new Put(row);
  p.addColumn(cfName,qualifier,initValue);
  table.put(p);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  long requests=metricsHelper.getCounter("totalRequestCount",serverSource);
  long readRequests=metricsHelper.getCounter("readRequestCount",serverSource);
  long writeRequests=metricsHelper.getCounter("writeRequestCount",serverSource);
  for (int i=0; i < 30; i++) {
    table.put(p);
  }
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("totalRequestCount",requests + 30,serverSource);
  metricsHelper.assertCounter("readRequestCount",readRequests,serverSource);
  metricsHelper.assertCounter("writeRequestCount",writeRequests + 30,serverSource);
  Get g=new Get(row);
  for (int i=0; i < 10; i++) {
    table.get(g);
  }
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("totalRequestCount",requests + 40,serverSource);
  metricsHelper.assertCounter("readRequestCount",readRequests + 10,serverSource);
  metricsHelper.assertCounter("writeRequestCount",writeRequests + 30,serverSource);
  try (RegionLocator locator=connection.getRegionLocator(tName)){
    for (    HRegionLocation location : locator.getAllRegionLocations()) {
      HRegionInfo i=location.getRegionInfo();
      MetricsRegionAggregateSource agg=rs.getRegion(i.getRegionName()).getMetrics().getSource().getAggregateSource();
      String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ i.getEncodedName()+ "_metric";
      metricsHelper.assertCounter(prefix + "_getNumOps",10,agg);
      metricsHelper.assertCounter(prefix + "_mutateCount",31,agg);
    }
  }
   List<Get> gets=new ArrayList<Get>();
  for (int i=0; i < 10; i++) {
    gets.add(new Get(row));
  }
  table.get(gets);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("totalRequestCount",requests + 50,serverSource);
  metricsHelper.assertCounter("readRequestCount",readRequests + 20,serverSource);
  metricsHelper.assertCounter("writeRequestCount",writeRequests + 30,serverSource);
  List<Put> puts=new ArrayList<>();
  for (int i=0; i < 30; i++) {
    puts.add(p);
  }
  table.put(puts);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("totalRequestCount",requests + 80,serverSource);
  metricsHelper.assertCounter("readRequestCount",readRequests + 20,serverSource);
  metricsHelper.assertCounter("writeRequestCount",writeRequests + 60,serverSource);
  table.close();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncrement() throws Exception {
  String tableNameString="testIncrement";
  TableName tableName=TableName.valueOf(tableNameString);
  byte[] cf=Bytes.toBytes("d");
  byte[] row=Bytes.toBytes("rk");
  byte[] qualifier=Bytes.toBytes("qual");
  byte[] val=Bytes.toBytes(0l);
  Table t=TEST_UTIL.createTable(tableName,cf);
  Put p=new Put(row);
  p.addColumn(cf,qualifier,val);
  t.put(p);
  for (int count=0; count < 13; count++) {
    Increment inc=new Increment(row);
    inc.addColumn(cf,qualifier,100);
    t.increment(inc);
  }
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  metricsHelper.assertCounter("incrementNumOps",13,serverSource);
  t.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionServerNoMaster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testCloseByRegionServer() throws Exception {
  closeRegionNoZK();
  openRegion(HTU,getRS(),hri);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRegionSplitPolicy </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConstantSizePolicy() throws IOException {
  htd.setMaxFileSize(1024L);
  ConstantSizeRegionSplitPolicy policy=(ConstantSizeRegionSplitPolicy)RegionSplitPolicy.create(mockRegion,conf);
  doConstantSizePolicyTests(policy);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateDefault() throws IOException {
  conf.setLong(HConstants.HREGION_MAX_FILESIZE,1234L);
  ConstantSizeRegionSplitPolicy policy=(ConstantSizeRegionSplitPolicy)RegionSplitPolicy.create(mockRegion,conf);
  assertWithinJitter(1234L,policy.getDesiredMaxFileSize());
  htd.setMaxFileSize(9999L);
  policy=(ConstantSizeRegionSplitPolicy)RegionSplitPolicy.create(mockRegion,conf);
  assertWithinJitter(9999L,policy.getDesiredMaxFileSize());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRemoveRegionMetrics </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMoveRegion() throws IOException, InterruptedException {
  String tableNameString="testMoveRegion";
  TableName tableName=TableName.valueOf(tableNameString);
  Table t=TEST_UTIL.createTable(tableName,Bytes.toBytes("D"));
  TEST_UTIL.waitUntilAllRegionsAssigned(t.getName());
  Admin admin=TEST_UTIL.getHBaseAdmin();
  HRegionInfo regionInfo;
  byte[] row=Bytes.toBytes("r1");
  for (int i=0; i < 30; i++) {
    boolean moved=false;
    try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
      regionInfo=locator.getRegionLocation(row,true).getRegionInfo();
    }
     int currentServerIdx=cluster.getServerWith(regionInfo.getRegionName());
    int destServerIdx=(currentServerIdx + 1) % cluster.getLiveRegionServerThreads().size();
    HRegionServer currentServer=cluster.getRegionServer(currentServerIdx);
    HRegionServer destServer=cluster.getRegionServer(destServerIdx);
    byte[] destServerName=Bytes.toBytes(destServer.getServerName().getServerName());
    Put p=new Put(row);
    p.addColumn(Bytes.toBytes("D"),Bytes.toBytes("Zero"),Bytes.toBytes("VALUE"));
    t.put(p);
    MetricsRegionAggregateSource currentAgg=currentServer.getRegion(regionInfo.getRegionName()).getMetrics().getSource().getAggregateSource();
    String prefix="namespace_" + NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR + "_table_"+ tableNameString+ "_region_"+ regionInfo.getEncodedName()+ "_metric";
    metricsHelper.assertCounter(prefix + "_mutateCount",1,currentAgg);
    try {
      admin.move(regionInfo.getEncodedNameAsBytes(),destServerName);
      moved=true;
      Thread.sleep(5000);
    }
 catch (    IOException ioe) {
      moved=false;
    }
    TEST_UTIL.waitUntilAllRegionsAssigned(t.getName());
    if (moved) {
      MetricsRegionAggregateSource destAgg=destServer.getRegion(regionInfo.getRegionName()).getMetrics().getSource().getAggregateSource();
      metricsHelper.assertCounter(prefix + "_mutateCount",0,destAgg);
    }
  }
  TEST_UTIL.deleteTable(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestReversibleScanners </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReversibleStoreFileScanner() throws IOException {
  FileSystem fs=TEST_UTIL.getTestFileSystem();
  Path hfilePath=new Path(new Path(TEST_UTIL.getDataTestDir("testReversibleStoreFileScanner"),"regionname"),"familyname");
  CacheConfig cacheConf=new CacheConfig(TEST_UTIL.getConfiguration());
  for (  DataBlockEncoding encoding : DataBlockEncoding.values()) {
    HFileContextBuilder hcBuilder=new HFileContextBuilder();
    hcBuilder.withBlockSize(2 * 1024);
    hcBuilder.withDataBlockEncoding(encoding);
    HFileContext hFileContext=hcBuilder.build();
    StoreFile.Writer writer=new StoreFile.WriterBuilder(TEST_UTIL.getConfiguration(),cacheConf,fs).withOutputDir(hfilePath).withFileContext(hFileContext).build();
    writeStoreFile(writer);
    StoreFile sf=new StoreFile(fs,writer.getPath(),TEST_UTIL.getConfiguration(),cacheConf,BloomType.NONE);
    List<StoreFileScanner> scanners=StoreFileScanner.getScannersForStoreFiles(Collections.singletonList(sf),false,true,false,false,Long.MAX_VALUE);
    StoreFileScanner scanner=scanners.get(0);
    seekTestOfReversibleKeyValueScanner(scanner);
    for (int readPoint=0; readPoint < MAXMVCC; readPoint++) {
      LOG.info("Setting read point to " + readPoint);
      scanners=StoreFileScanner.getScannersForStoreFiles(Collections.singletonList(sf),false,true,false,false,readPoint);
      seekTestOfReversibleKeyValueScannerWithMVCC(scanners.get(0),readPoint);
    }
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReversibleRegionScanner() throws IOException {
  byte[] FAMILYNAME2=Bytes.toBytes("testCf2");
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testtable")).addFamily(new HColumnDescriptor(FAMILYNAME)).addFamily(new HColumnDescriptor(FAMILYNAME2));
  Region region=TEST_UTIL.createLocalHRegion(htd,null,null);
  loadDataToRegion(region,FAMILYNAME2);
  Scan scan=new Scan();
  InternalScanner scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,ROWSIZE * QUALSIZE * 2,ROWSIZE,true);
  scan.setReversed(true);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,ROWSIZE * QUALSIZE * 2,ROWSIZE,false);
  scan=new Scan();
  scan.setReversed(true);
  scan.addFamily(FAMILYNAME);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,ROWSIZE * QUALSIZE,ROWSIZE,false);
  byte[][] specifiedQualifiers={QUALS[1],QUALS[2]};
  for (  byte[] specifiedQualifier : specifiedQualifiers)   scan.addColumn(FAMILYNAME,specifiedQualifier);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,ROWSIZE * 2,ROWSIZE,false);
  for (  byte[] specifiedQualifier : specifiedQualifiers)   scan.addColumn(FAMILYNAME2,specifiedQualifier);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,ROWSIZE * 2 * 2,ROWSIZE,false);
  int startRowNum=ROWSIZE * 3 / 4;
  scan.setStartRow(ROWS[startRowNum]);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,(startRowNum + 1) * 2 * 2,(startRowNum + 1),false);
  int stopRowNum=ROWSIZE / 4;
  scan.setStartRow(HConstants.EMPTY_BYTE_ARRAY);
  scan.setStopRow(ROWS[stopRowNum]);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,(ROWSIZE - stopRowNum - 1) * 2 * 2,(ROWSIZE - stopRowNum - 1),false);
  scan.setStartRow(ROWS[startRowNum]);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,(startRowNum - stopRowNum) * 2 * 2,(startRowNum - stopRowNum),false);
  int valueNum=startRowNum % VALUESIZE;
  Filter filter=new SingleColumnValueFilter(FAMILYNAME,specifiedQualifiers[0],CompareOp.EQUAL,VALUES[valueNum]);
  scan.setFilter(filter);
  scanner=region.getScanner(scan);
  int unfilteredRowNum=(startRowNum - stopRowNum) / VALUESIZE + (stopRowNum / VALUESIZE == valueNum ? 0 : 1);
  verifyCountAndOrder(scanner,unfilteredRowNum * 2 * 2,unfilteredRowNum,false);
  int pageSize=10;
  filter=new PageFilter(pageSize);
  scan.setFilter(filter);
  scanner=region.getScanner(scan);
  int expectedRowNum=pageSize;
  verifyCountAndOrder(scanner,expectedRowNum * 2 * 2,expectedRowNum,false);
  SingleColumnValueFilter scvFilter1=new SingleColumnValueFilter(FAMILYNAME,specifiedQualifiers[0],CompareOp.EQUAL,VALUES[0]);
  SingleColumnValueFilter scvFilter2=new SingleColumnValueFilter(FAMILYNAME,specifiedQualifiers[0],CompareOp.EQUAL,VALUES[1]);
  expectedRowNum=0;
  for (int i=startRowNum; i > stopRowNum; i--) {
    if (i % VALUESIZE == 0 || i % VALUESIZE == 1) {
      expectedRowNum++;
    }
  }
  filter=new FilterList(Operator.MUST_PASS_ONE,scvFilter1,scvFilter2);
  scan.setFilter(filter);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,expectedRowNum * 2 * 2,expectedRowNum,false);
  filter=new FilterList(Operator.MUST_PASS_ALL,scvFilter1,scvFilter2);
  expectedRowNum=0;
  scan.setFilter(filter);
  scanner=region.getScanner(scan);
  verifyCountAndOrder(scanner,expectedRowNum * 2 * 2,expectedRowNum,false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReversibleMemstoreScanner() throws IOException {
  MemStore memstore=new DefaultMemStore();
  writeMemstore(memstore);
  List<KeyValueScanner> scanners=memstore.getScanners(Long.MAX_VALUE);
  seekTestOfReversibleKeyValueScanner(scanners.get(0));
  for (int readPoint=0; readPoint < MAXMVCC; readPoint++) {
    LOG.info("Setting read point to " + readPoint);
    scanners=memstore.getScanners(readPoint);
    seekTestOfReversibleKeyValueScannerWithMVCC(scanners.get(0),readPoint);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestRowTooBig </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Usecase:
 * - create a row with 5 large  cells (5 Mb each)
 * - flush memstore but don't compact storefiles.
 * - try to Get whole row.
 * OOME happened before we actually get to reading results, but
 * during seeking, as each StoreFile gets it's own scanner,
 * and each scanner seeks after the first KV.
 * @throws IOException
 */
@Test(expected=RowTooBigException.class) public void testScannersSeekOnFewLargeCells() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  HTableDescriptor htd=TEST_HTD;
  HColumnDescriptor hcd=new HColumnDescriptor(fam1);
  if (htd.hasFamily(hcd.getName())) {
    htd.modifyFamily(hcd);
  }
 else {
    htd.addFamily(hcd);
  }
  final HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_END_ROW,HConstants.EMPTY_END_ROW);
  Region region=HBaseTestingUtility.createRegionAndWAL(hri,rootRegionDir,HTU.getConfiguration(),htd);
  try {
    for (int i=0; i < 5; i++) {
      Put put=new Put(row1);
      byte[] value=new byte[5 * 1024 * 1024];
      put.addColumn(fam1,Bytes.toBytes("col_" + i),value);
      region.put(put);
      region.flush(true);
    }
    Get get=new Get(row1);
    region.get(get);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Usecase:
 * - create a row with 1M cells, 10 bytes in each
 * - flush & run major compaction
 * - try to Get whole row.
 * OOME happened in StoreScanner.next(..).
 * @throws IOException
 */
@Test(expected=RowTooBigException.class) public void testScanAcrossManySmallColumns() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  HTableDescriptor htd=TEST_HTD;
  HColumnDescriptor hcd=new HColumnDescriptor(fam1);
  if (htd.hasFamily(hcd.getName())) {
    htd.modifyFamily(hcd);
  }
 else {
    htd.addFamily(hcd);
  }
  final HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_END_ROW,HConstants.EMPTY_END_ROW);
  Region region=HBaseTestingUtility.createRegionAndWAL(hri,rootRegionDir,HTU.getConfiguration(),htd);
  try {
    for (int i=0; i < 10; i++) {
      Put put=new Put(row1);
      for (int j=0; j < 10 * 10000; j++) {
        byte[] value=new byte[10];
        put.addColumn(fam1,Bytes.toBytes("col_" + i + "_"+ j),value);
      }
      region.put(put);
      region.flush(true);
    }
    region.compact(true);
    Get get=new Get(row1);
    region.get(get);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSCVFWithMiniCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the filter by adding 2 columns of family A in the scan. (OK)
 */
@Test public void scanWithSpecificQualifiers3() throws IOException {
  Scan scan=new Scan();
  scan.addColumn(FAMILY_A,QUALIFIER_FOO);
  scan.addColumn(FAMILY_A,QUALIFIER_BAR);
  scan.setFilter(scanFilter);
  verify(scan);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the filter by adding 1 column of family A (the one used in the filter) and 1 column of
 * family B in the scan. (OK)
 */
@Test public void scanWithSpecificQualifiers2() throws IOException {
  Scan scan=new Scan();
  scan.addColumn(FAMILY_A,QUALIFIER_FOO);
  scan.addColumn(FAMILY_B,QUALIFIER_BAR);
  scan.setFilter(scanFilter);
  verify(scan);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the filter by adding all columns of family A and B in the scan. (KO: row '3' without
 * 'a:foo' qualifier is returned)
 */
@Test public void scanWithAllQualifiersOfBothFamilies() throws IOException {
  Scan scan=new Scan();
  scan.setFilter(scanFilter);
  verify(scan);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the filter by adding 2 columns of family A and 1 column of family B in the scan. (KO: row
 * '3' without 'a:foo' qualifier is returned)
 */
@Test public void scanWithSpecificQualifiers1() throws IOException {
  Scan scan=new Scan();
  scan.addColumn(FAMILY_A,QUALIFIER_FOO);
  scan.addColumn(FAMILY_A,QUALIFIER_BAR);
  scan.addColumn(FAMILY_B,QUALIFIER_BAR);
  scan.addColumn(FAMILY_B,QUALIFIER_FOO);
  scan.setFilter(scanFilter);
  verify(scan);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the filter by adding all columns of family A in the scan. (OK)
 */
@Test public void scanWithAllQualifiersOfFamiliyA() throws IOException {
  Scan scan=new Scan();
  scan.addFamily(FAMILY_A);
  scan.setFilter(scanFilter);
  verify(scan);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScanWithBloomError </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testThreeStoreFiles() throws IOException {
  region=TEST_UTIL.createTestRegion(TABLE_NAME,new HColumnDescriptor(FAMILY).setCompressionType(Compression.Algorithm.GZ).setBloomFilterType(bloomType).setMaxVersions(TestMultiColumnScanner.MAX_VERSIONS));
  createStoreFile(new int[]{1,2,6});
  createStoreFile(new int[]{1,2,3,7});
  createStoreFile(new int[]{1,9});
  scanColSet(new int[]{1,4,6,7},new int[]{1,6,7});
  HBaseTestingUtility.closeRegionAndWAL(region);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScanner </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilters() throws IOException {
  try {
    this.region=TEST_UTIL.createLocalHRegion(TESTTABLEDESC,null,null);
    HBaseTestCase.addContent(this.region,HConstants.CATALOG_FAMILY);
    byte[] prefix=Bytes.toBytes("ab");
    Filter newFilter=new PrefixFilter(prefix);
    Scan scan=new Scan();
    scan.setFilter(newFilter);
    rowPrefixFilter(scan);
    byte[] stopRow=Bytes.toBytes("bbc");
    newFilter=new WhileMatchFilter(new InclusiveStopFilter(stopRow));
    scan=new Scan();
    scan.setFilter(newFilter);
    rowInclusiveStopFilter(scan,stopRow);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * The test!
 * @throws IOException
 */
@Test public void testScanner() throws IOException {
  try {
    region=TEST_UTIL.createLocalHRegion(TESTTABLEDESC,null,null);
    Table table=new RegionAsTable(region);
    Put put=new Put(ROW_KEY,System.currentTimeMillis());
    put.addColumn(HConstants.CATALOG_FAMILY,HConstants.REGIONINFO_QUALIFIER,REGION_INFO.toByteArray());
    table.put(put);
    scan(false,null);
    getRegionInfo(table);
    ((HRegion)region).close();
    region=HRegion.openHRegion(region,null);
    table=new RegionAsTable(region);
    scan(false,null);
    getRegionInfo(table);
    String address=HConstants.LOCALHOST_IP + ":" + HBaseTestingUtility.randomFreePort();
    put=new Put(ROW_KEY,System.currentTimeMillis());
    put.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER,Bytes.toBytes(address));
    table.put(put);
    scan(true,address.toString());
    getRegionInfo(table);
    this.region.flush(true);
    scan(true,address.toString());
    getRegionInfo(table);
    ((HRegion)region).close();
    region=HRegion.openHRegion(region,null);
    table=new RegionAsTable(region);
    scan(true,address.toString());
    getRegionInfo(table);
    address="bar.foo.com:4321";
    put=new Put(ROW_KEY,System.currentTimeMillis());
    put.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER,Bytes.toBytes(address));
    table.put(put);
    scan(true,address.toString());
    getRegionInfo(table);
    region.flush(true);
    scan(true,address.toString());
    getRegionInfo(table);
    ((HRegion)this.region).close();
    this.region=HRegion.openHRegion(region,null);
    table=new RegionAsTable(this.region);
    scan(true,address.toString());
    getRegionInfo(table);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScannerHeartbeatMessages </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test a variety of scan configurations to ensure that they return the expected Results when
 * heartbeat messages are necessary. These tests are accumulated under one test case to ensure
 * that they don't run in parallel. If the tests ran in parallel, they may conflict with each
 * other due to changing static variables
 */
@Test public void testScannerHeartbeatMessages() throws Exception {
  testImportanceOfHeartbeats(testHeartbeatBetweenRows());
  testImportanceOfHeartbeats(testHeartbeatBetweenColumnFamilies());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScannerRetriableFailure </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testFaultyScanner() throws Exception {
  TableName tableName=TEST_TABLE.getTableName();
  Table table=UTIL.createTable(tableName,FAMILY_NAME);
  try {
    final int NUM_ROWS=100;
    loadTable(table,NUM_ROWS);
    checkTableRows(table,NUM_ROWS);
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestScannerWithBulkload </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBulkLoadWithParallelScan() throws Exception {
  final TableName tableName=TableName.valueOf("testBulkLoadWithParallelScan");
  final long l=System.currentTimeMillis();
  final Admin admin=TEST_UTIL.getHBaseAdmin();
  createTable(admin,tableName);
  Scan scan=createScan();
  final Table table=init(admin,l,scan,tableName);
  final Path hfilePath=writeToHFile(l,"/temp/testBulkLoadWithParallelScan/","/temp/testBulkLoadWithParallelScan/col/file",false);
  Configuration conf=TEST_UTIL.getConfiguration();
  conf.setBoolean("hbase.mapreduce.bulkload.assign.sequenceNumbers",true);
  final LoadIncrementalHFiles bulkload=new LoadIncrementalHFiles(conf);
  ResultScanner scanner=table.getScanner(scan);
  final CountDownLatch latch=new CountDownLatch(1);
  new Thread(){
    public void run(){
      try {
        Put put1=new Put(Bytes.toBytes("row5"));
        put1.add(new KeyValue(Bytes.toBytes("row5"),Bytes.toBytes("col"),Bytes.toBytes("q"),l,Bytes.toBytes("version0")));
        table.put(put1);
        try (RegionLocator locator=TEST_UTIL.getConnection().getRegionLocator(tableName)){
          bulkload.doBulkLoad(hfilePath,admin,table,locator);
        }
         latch.countDown();
      }
 catch (      TableNotFoundException e) {
      }
catch (      IOException e) {
      }
    }
  }
.start();
  latch.await();
  Result result=scanner.next();
  scanAfterBulkLoad(scanner,result,"version1");
  scanner.close();
  table.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullCall() throws Throwable {
  try (Table table=util.getConnection().getTable(TEST_TABLE);RegionLocator locator=util.getConnection().getRegionLocator(TEST_TABLE)){
    Map<byte[],String> results=hello(table,null,ROW_A,ROW_C);
    verifyRegionResults(locator,results,"Who are you?",ROW_A);
    verifyRegionResults(locator,results,"Who are you?",ROW_B);
    verifyRegionResults(locator,results,"Who are you?",ROW_C);
  }
 }

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullReturn() throws Throwable {
  try (Table table=util.getConnection().getTable(TEST_TABLE);RegionLocator locator=util.getConnection().getRegionLocator(TEST_TABLE)){
    Map<byte[],String> results=hello(table,"nobody",ROW_A,ROW_C);
    verifyRegionResults(locator,results,null,ROW_A);
    verifyRegionResults(locator,results,null,ROW_B);
    verifyRegionResults(locator,results,null,ROW_C);
  }
 }

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompoundCall() throws Throwable {
  try (Table table=util.getConnection().getTable(TEST_TABLE);RegionLocator locator=util.getConnection().getRegionLocator(TEST_TABLE)){
    Map<byte[],String> results=compoundOfHelloAndPing(table,ROW_A,ROW_C);
    verifyRegionResults(locator,results,"Hello, pong",ROW_A);
    verifyRegionResults(locator,results,"Hello, pong",ROW_B);
    verifyRegionResults(locator,results,"Hello, pong",ROW_C);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestServerNonceManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStopWaiting() throws Exception {
  final ServerNonceManager nm=createManager();
  nm.setConflictWaitIterationMs(1);
  Stoppable stoppingStoppable=createStoppable();
  Mockito.when(stoppingStoppable.isStopped()).thenAnswer(new Answer<Boolean>(){
    AtomicInteger answer=new AtomicInteger(3);
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      return 0 < answer.decrementAndGet();
    }
  }
);
  nm.startOperation(NO_NONCE,1,createStoppable());
  TestRunnable tr=new TestRunnable(nm,1,null,stoppingStoppable);
  Thread t=tr.start();
  waitForThreadToBlockOrExit(t);
  t.join();
  tr.propagateError();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcurrentAttempts() throws Exception {
  final ServerNonceManager nm=createManager();
  nm.startOperation(NO_NONCE,1,createStoppable());
  TestRunnable tr=new TestRunnable(nm,1,false,createStoppable());
  Thread t=tr.start();
  waitForThreadToBlockOrExit(t);
  nm.endOperation(NO_NONCE,1,true);
  t.join();
  tr.propagateError();
  nm.startOperation(NO_NONCE,2,createStoppable());
  tr=new TestRunnable(nm,2,true,createStoppable());
  t=tr.start();
  waitForThreadToBlockOrExit(t);
  nm.endOperation(NO_NONCE,2,false);
  t.join();
  tr.propagateError();
  nm.endOperation(NO_NONCE,2,true);
  nm.startOperation(NO_NONCE,3,createStoppable());
  tr=new TestRunnable(nm,4,true,createStoppable());
  tr.start().join();
  tr.propagateError();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitTransaction </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test straight prepare works.  Tries to split on {@link #GOOD_SPLIT_ROW}
 * @throws IOException
 */
@Test public void testPrepare() throws IOException {
  prepareGOOD_SPLIT_ROW();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * While transitioning node from RS_ZK_REGION_SPLITTING to
 * RS_ZK_REGION_SPLITTING during region split,if zookeper went down split always
 * fails for the region. HBASE-6088 fixes this scenario.
 * This test case is to test the znode is deleted(if created) or not in roll back.
 * @throws IOException
 * @throws InterruptedException
 * @throws KeeperException
 */
@Test(timeout=60000) public void testSplitBeforeSettingSplittingInZK() throws Exception, InterruptedException, KeeperException {
  testSplitBeforeSettingSplittingInZKInternals();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test that intentionally has master fail the processing of the split message.
 * Tests that after we process server shutdown, the daughters are up on line.
 * @throws IOException
 * @throws InterruptedException
 * @throws ServiceException
 */
@Test(timeout=300000) public void testRSSplitDaughtersAreOnlinedAfterShutdownHandling() throws IOException, InterruptedException, ServiceException {
  final TableName tableName=TableName.valueOf("testRSSplitDaughtersAreOnlinedAfterShutdownHandling");
  Table t=createTableAndWait(tableName,HConstants.CATALOG_FAMILY);
  List<HRegion> regions=cluster.getRegions(tableName);
  HRegionInfo hri=getAndCheckSingleTableRegion(regions);
  int tableRegionIndex=ensureTableRegionNotOnSameServerAsMeta(admin,hri);
  this.admin.setBalancerRunning(false,true);
  cluster.getMaster().setCatalogJanitorEnabled(false);
  try {
    TESTING_UTIL.loadTable(t,HConstants.CATALOG_FAMILY,false);
    HRegionServer server=cluster.getRegionServer(tableRegionIndex);
    printOutRegions(server,"Initial regions: ");
    int regionCount=ProtobufUtil.getOnlineRegions(server.getRSRpcServices()).size();
    AssignmentManager.TEST_SKIP_SPLIT_HANDLING=true;
    try {
      split(hri,server,regionCount);
    }
 catch (    RegionServerStoppedException rsse) {
    }
    waitUntilRegionServerDead();
    awaitDaughters(tableName,2);
  }
  finally {
    AssignmentManager.TEST_SKIP_SPLIT_HANDLING=false;
    admin.setBalancerRunning(true,false);
    cluster.getMaster().setCatalogJanitorEnabled(true);
    cluster.startRegionServer();
    t.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStore </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Getting data from memstore and files
 * @throws IOException
 */
@Test public void testGet_FromMemStoreAndFiles() throws IOException {
  init(this.name.getMethodName());
  this.store.add(new KeyValue(row,family,qf1,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf2,1,(byte[])null));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf4,1,(byte[])null));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf6,1,(byte[])null));
  result=HBaseTestingUtility.getFromStoreFile(store,get.getRow(),qualifiers);
  Collections.sort(result,CellComparator.COMPARATOR);
  assertCheck();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Getting data from files only
 * @throws IOException
 */
@Test public void testGet_FromFilesOnly() throws IOException {
  init(this.name.getMethodName());
  this.store.add(new KeyValue(row,family,qf1,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf2,1,(byte[])null));
  flush(1);
  this.store.add(new KeyValue(row,family,qf3,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf4,1,(byte[])null));
  flush(2);
  this.store.add(new KeyValue(row,family,qf5,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf6,1,(byte[])null));
  flush(3);
  result=HBaseTestingUtility.getFromStoreFile(store,get.getRow(),qualifiers);
  Collections.sort(result,CellComparator.COMPARATOR);
  assertCheck();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Getting data from memstore only
 * @throws IOException
 */
@Test public void testGet_FromMemStoreOnly() throws IOException {
  init(this.name.getMethodName());
  this.store.add(new KeyValue(row,family,qf1,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf2,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf3,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf4,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf5,1,(byte[])null));
  this.store.add(new KeyValue(row,family,qf6,1,(byte[])null));
  result=HBaseTestingUtility.getFromStoreFile(store,get.getRow(),qualifiers);
  assertCheck();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteExpiredStoreFiles() throws Exception {
  testDeleteExpiredStoreFiles(0);
  testDeleteExpiredStoreFiles(1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStoreFile </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Write a file and then assert that we can read from top and bottom halves
 * using two HalfMapFiles.
 * @throws Exception
 */
@Test public void testBasicHalfMapFile() throws Exception {
  final HRegionInfo hri=new HRegionInfo(TableName.valueOf("testBasicHalfMapFileTb"));
  HRegionFileSystem regionFs=HRegionFileSystem.createRegionOnFileSystem(conf,fs,new Path(testDir,hri.getTable().getNameAsString()),hri);
  HFileContext meta=new HFileContextBuilder().withBlockSize(2 * 1024).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(regionFs.createTempName()).withFileContext(meta).build();
  writeStoreFile(writer);
  Path sfPath=regionFs.commitStoreFile(TEST_FAMILY,writer.getPath());
  StoreFile sf=new StoreFile(this.fs,sfPath,conf,cacheConf,BloomType.NONE);
  checkHalfHFile(regionFs,sf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBloomFilter() throws Exception {
  FileSystem fs=FileSystem.getLocal(conf);
  conf.setFloat(BloomFilterFactory.IO_STOREFILE_BLOOM_ERROR_RATE,(float)0.01);
  conf.setBoolean(BloomFilterFactory.IO_STOREFILE_BLOOM_ENABLED,true);
  Path f=new Path(ROOT_DIR,getName());
  HFileContext meta=new HFileContextBuilder().withBlockSize(BLOCKSIZE_SMALL).withChecksumType(CKTYPE).withBytesPerCheckSum(CKBYTES).build();
  StoreFile.Writer writer=new StoreFile.WriterBuilder(conf,cacheConf,this.fs).withFilePath(f).withBloomType(BloomType.ROW).withMaxKeyCount(2000).withFileContext(meta).build();
  bloomWriteRead(writer,fs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeqIdComparator(){
  assertOrdering(StoreFile.Comparators.SEQ_ID,mockStoreFile(true,100,1000,-1,"/foo/123"),mockStoreFile(true,100,1000,-1,"/foo/124"),mockStoreFile(true,99,1000,-1,"/foo/126"),mockStoreFile(true,98,2000,-1,"/foo/126"),mockStoreFile(false,3453,-1,1,"/foo/1"),mockStoreFile(false,2,-1,3,"/foo/2"),mockStoreFile(false,1000,-1,5,"/foo/2"),mockStoreFile(false,76,-1,5,"/foo/3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStripeCompactor </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSizeCompactions() throws Exception {
  verifySizeCompaction(a(KV_A,KV_A,KV_B,KV_C,KV_D),3,2,OPEN_KEY,OPEN_KEY,a(a(KV_A,KV_A),a(KV_B,KV_C),a(KV_D)));
  verifySizeCompaction(a(KV_A,KV_B,KV_C,KV_D),4,1,OPEN_KEY,OPEN_KEY,a(a(KV_A),a(KV_B),a(KV_C),a(KV_D)));
  verifySizeCompaction(a(KV_B,KV_C),2,1,KEY_B,KEY_D,a(a(KV_B),a(KV_C)));
  verifySizeCompaction(a(KV_A,KV_A,KV_A,KV_C,KV_D),3,2,OPEN_KEY,OPEN_KEY,a(a(KV_A,KV_A,KV_A),a(KV_C,KV_D)));
  verifySizeCompaction(a(KV_A,KV_B,KV_B,KV_C),3,1,OPEN_KEY,OPEN_KEY,a(a(KV_A),a(KV_B,KV_B),a(KV_C)));
  verifySizeCompaction(a(KV_A,KV_B,KV_C,KV_D),2,1,OPEN_KEY,OPEN_KEY,a(a(KV_A),a(KV_B,KV_C,KV_D)));
  verifySizeCompaction(a(KV_A,KV_B,KV_C),1,Long.MAX_VALUE,OPEN_KEY,KEY_D,new KeyValue[][]{a(KV_A,KV_B,KV_C)});
  verifySizeCompaction(a(KV_A,KV_B,KV_C,KV_D),Integer.MAX_VALUE,2,OPEN_KEY,OPEN_KEY,a(a(KV_A,KV_B),a(KV_C,KV_D)));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoundaryCompactions() throws Exception {
  verifyBoundaryCompaction(a(KV_A,KV_A,KV_B,KV_B,KV_C,KV_D),a(OPEN_KEY,KEY_B,KEY_D,OPEN_KEY),a(a(KV_A,KV_A),a(KV_B,KV_B,KV_C),a(KV_D)));
  verifyBoundaryCompaction(a(KV_B,KV_C),a(KEY_B,KEY_C,KEY_D),a(a(KV_B),a(KV_C)));
  verifyBoundaryCompaction(a(KV_B,KV_C),a(KEY_B,KEY_D),new KeyValue[][]{a(KV_B,KV_C)});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoundaryCompactionEmptyFiles() throws Exception {
  verifyBoundaryCompaction(a(KV_B),a(KEY_B,KEY_C,KEY_D,OPEN_KEY),a(a(KV_B),null,null),null,null,false);
  verifyBoundaryCompaction(a(KV_A,KV_C),a(OPEN_KEY,KEY_B,KEY_C,KEY_D),a(a(KV_A),null,a(KV_C)),null,null,false);
  verifyBoundaryCompaction(e(),a(OPEN_KEY,KEY_B,KEY_C,OPEN_KEY),a(null,null,e()),null,null,false);
  verifyBoundaryCompaction(e(),a(OPEN_KEY,KEY_B,KEY_C,OPEN_KEY),a(null,e(),null),KEY_B,KEY_C,false);
  verifyBoundaryCompaction(e(),a(OPEN_KEY,KEY_B,KEY_C,OPEN_KEY),a(e(),e(),null),OPEN_KEY,KEY_C,false);
  verifyBoundaryCompaction(a(KV_A),a(OPEN_KEY,KEY_B,KEY_C,KEY_D,OPEN_KEY),a(a(KV_A),e(),e(),null),KEY_B,KEY_D,false);
  verifyBoundaryCompaction(a(KV_C),a(OPEN_KEY,KEY_B,KEY_C,KEY_D,OPEN_KEY),a(null,null,a(KV_C),e()),KEY_C,OPEN_KEY,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestStripeStoreFileManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetStripeBoundarySplits() throws Exception {
  verifySplitPointScenario(5,false,0f,2,1,1,1,1,1,10);
  verifySplitPointScenario(0,false,0f,6,3,1,1,2);
  verifySplitPointScenario(2,false,0f,1,1,1,1,2);
  verifySplitPointScenario(0,false,0f,5,4);
  verifySplitPointScenario(2,false,0f,5,2,5,5,5);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPriority() throws Exception {
  testPriorityScenario(5,5,0,0,0);
  testPriorityScenario(2,5,0,0,3);
  testPriorityScenario(4,25,5,1,0);
  testPriorityScenario(3,25,5,1,1);
  testPriorityScenario(3,25,5,2,0);
  testPriorityScenario(2,25,5,4,0);
  testPriorityScenario(2,25,5,4,4);
  testPriorityScenario(2,25,5,1,10);
  testPriorityScenario(0,25,5,4,5);
  testPriorityScenario(-5,25,5,6,0);
  testPriorityScenario(-1,25,0,0,26);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyResultsForStripes() throws Exception {
  StripeStoreFileManager manager=createManager();
  StoreFile sf0a=createFile();
  StoreFile sf0b=createFile();
  manager.insertNewFiles(al(sf0a));
  manager.insertNewFiles(al(sf0b));
  ArrayList<StoreFile> compacted=al(createFile(OPEN_KEY,KEY_B),createFile(KEY_B,KEY_C),createFile(KEY_C,OPEN_KEY));
  manager.addCompactionResults(al(sf0a),compacted);
  manager.removeCompactedFiles(al(sf0a));
  ArrayList<StoreFile> compacted2=al(createFile(OPEN_KEY,KEY_B),createFile(KEY_C,OPEN_KEY));
  manager.addCompactionResults(al(sf0b),compacted2);
  manager.removeCompactedFiles(al(sf0b));
  compacted.addAll(compacted2);
  verifyAllFiles(manager,compacted);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetFilesForGetAndScan() throws Exception {
  StripeStoreFileManager manager=createManager();
  verifyGetAndScanScenario(manager,null,null);
  verifyGetAndScanScenario(manager,KEY_B,KEY_C);
  MockStoreFile sf0=createFile();
  manager.insertNewFiles(al(sf0));
  verifyGetAndScanScenario(manager,null,null,sf0);
  verifyGetAndScanScenario(manager,null,KEY_C,sf0);
  verifyGetAndScanScenario(manager,KEY_B,null,sf0);
  verifyGetAndScanScenario(manager,KEY_B,KEY_C,sf0);
  MockStoreFile sfA=createFile(OPEN_KEY,KEY_A);
  MockStoreFile sfB=createFile(KEY_A,KEY_B);
  MockStoreFile sfC=createFile(KEY_B,KEY_C);
  MockStoreFile sfD=createFile(KEY_C,KEY_D);
  MockStoreFile sfE=createFile(KEY_D,OPEN_KEY);
  manager.addCompactionResults(al(),al(sfA,sfB,sfC,sfD,sfE));
  verifyGetAndScanScenario(manager,null,null,sf0,sfA,sfB,sfC,sfD,sfE);
  verifyGetAndScanScenario(manager,keyAfter(KEY_A),null,sf0,sfB,sfC,sfD,sfE);
  verifyGetAndScanScenario(manager,null,keyAfter(KEY_C),sf0,sfA,sfB,sfC,sfD);
  verifyGetAndScanScenario(manager,KEY_B,null,sf0,sfC,sfD,sfE);
  verifyGetAndScanScenario(manager,null,KEY_C,sf0,sfA,sfB,sfC,sfD);
  verifyGetAndScanScenario(manager,KEY_B,keyAfter(KEY_B),sf0,sfC);
  verifyGetAndScanScenario(manager,keyAfter(KEY_A),KEY_B,sf0,sfB,sfC);
  verifyGetAndScanScenario(manager,KEY_D,KEY_D,sf0,sfE);
  verifyGetAndScanScenario(manager,keyAfter(KEY_B),keyAfter(KEY_C),sf0,sfC,sfD);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddingCompactionResults() throws Exception {
  StripeStoreFileManager manager=createManager();
  StoreFile sf_L0_0a=createFile(), sf_L0_0b=createFile();
  manager.insertNewFiles(al(sf_L0_0a,sf_L0_0b));
  verifyInvalidCompactionScenario(manager,al(sf_L0_0a),al(createFile(OPEN_KEY,KEY_B)));
  verifyInvalidCompactionScenario(manager,al(sf_L0_0a),al(createFile(OPEN_KEY,KEY_B),createFile(KEY_C,OPEN_KEY)));
  verifyInvalidCompactionScenario(manager,al(sf_L0_0a),al(createFile(OPEN_KEY,KEY_B),createFile(KEY_B,OPEN_KEY),createFile(KEY_A,KEY_D)));
  verifyInvalidCompactionScenario(manager,al(sf_L0_0a),al(createFile(OPEN_KEY,KEY_B),createFile(KEY_A,KEY_B),createFile(KEY_B,OPEN_KEY)));
  StoreFile sf_i2B_0=createFile(OPEN_KEY,KEY_B);
  StoreFile sf_B2C_0=createFile(KEY_B,KEY_C);
  StoreFile sf_C2i_0=createFile(KEY_C,OPEN_KEY);
  manager.addCompactionResults(al(sf_L0_0a),al(sf_i2B_0,sf_B2C_0,sf_C2i_0));
  manager.removeCompactedFiles(al(sf_L0_0a));
  verifyAllFiles(manager,al(sf_L0_0b,sf_i2B_0,sf_B2C_0,sf_C2i_0));
  StoreFile sf_L0_1=createFile();
  StoreFile sf_i2B_1=createFile(OPEN_KEY,KEY_B);
  StoreFile sf_B2C_1=createFile(KEY_B,KEY_C);
  manager.insertNewFiles(al(sf_L0_1));
  manager.addCompactionResults(al(sf_L0_0b,sf_L0_1),al(sf_i2B_1,sf_B2C_1));
  manager.removeCompactedFiles(al(sf_L0_0b,sf_L0_1));
  verifyAllFiles(manager,al(sf_i2B_0,sf_B2C_0,sf_C2i_0,sf_i2B_1,sf_B2C_1));
  StoreFile sf_L0_2=createFile(null,null);
  manager.addCompactionResults(al(),al(sf_L0_2));
  manager.removeCompactedFiles(al());
  verifyAllFiles(manager,al(sf_i2B_0,sf_B2C_0,sf_C2i_0,sf_i2B_1,sf_B2C_1,sf_L0_2));
  manager.addCompactionResults(al(sf_L0_2),al());
  manager.removeCompactedFiles(al(sf_L0_2));
  StoreFile sf_i2B_3=createFile(OPEN_KEY,KEY_B);
  manager.addCompactionResults(al(sf_i2B_0,sf_i2B_1),al(sf_i2B_3));
  manager.removeCompactedFiles(al(sf_i2B_0,sf_i2B_1));
  verifyAllFiles(manager,al(sf_B2C_0,sf_C2i_0,sf_B2C_1,sf_i2B_3));
  StoreFile sf_B2D_4=createFile(KEY_B,KEY_D);
  StoreFile sf_D2i_4=createFile(KEY_D,OPEN_KEY);
  manager.addCompactionResults(al(sf_B2C_0,sf_C2i_0,sf_B2C_1),al(sf_B2D_4,sf_D2i_4));
  manager.removeCompactedFiles(al(sf_B2C_0,sf_C2i_0,sf_B2C_1));
  verifyAllFiles(manager,al(sf_i2B_3,sf_B2D_4,sf_D2i_4));
  StoreFile sf_i2A_5=createFile(OPEN_KEY,KEY_A);
  StoreFile sf_A2B_5=createFile(KEY_A,KEY_B);
  manager.addCompactionResults(al(sf_i2B_3),al(sf_i2A_5,sf_A2B_5));
  manager.removeCompactedFiles(al(sf_i2B_3));
  verifyAllFiles(manager,al(sf_B2D_4,sf_D2i_4,sf_i2A_5,sf_A2B_5));
  StoreFile sf_B2C_6=createFile(KEY_B,KEY_C);
  StoreFile sf_C2D_6=createFile(KEY_C,KEY_D);
  manager.addCompactionResults(al(sf_B2D_4),al(sf_B2C_6,sf_C2D_6));
  manager.removeCompactedFiles(al(sf_B2D_4));
  verifyAllFiles(manager,al(sf_D2i_4,sf_i2A_5,sf_A2B_5,sf_B2C_6,sf_C2D_6));
  StoreFile sf_A2C_7=createFile(KEY_A,KEY_C);
  manager.addCompactionResults(al(sf_A2B_5,sf_B2C_6),al(sf_A2C_7));
  manager.removeCompactedFiles(al(sf_A2B_5,sf_B2C_6));
  verifyAllFiles(manager,al(sf_D2i_4,sf_i2A_5,sf_C2D_6,sf_A2C_7));
  StoreFile sf_i2C_8=createFile(OPEN_KEY,KEY_C);
  manager.addCompactionResults(al(sf_i2A_5,sf_A2C_7),al(sf_i2C_8));
  manager.removeCompactedFiles(al(sf_i2A_5,sf_A2C_7));
  verifyAllFiles(manager,al(sf_D2i_4,sf_C2D_6,sf_i2C_8));
  StoreFile sf_i2i_9=createFile(OPEN_KEY,OPEN_KEY);
  manager.addCompactionResults(al(sf_D2i_4,sf_C2D_6,sf_i2C_8),al(sf_i2i_9));
  manager.removeCompactedFiles(al(sf_D2i_4,sf_C2D_6,sf_i2C_8));
  verifyAllFiles(manager,al(sf_i2i_9));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetUnbalancedSplits() throws Exception {
  verifySplitPointScenario(0,false,2.1f,4,4,4);
  verifySplitPointScenario(1,true,1.5f,4,4,4);
  verifySplitPointScenario(1,false,1.1f,3,4,1,1,2,2);
  verifySplitPointScenario(1,false,1.1f,3,6,1,1,2,2);
  verifySplitPointScenario(1,true,1.1f,3,8,1,1,2,2);
  verifySplitPointScenario(3,false,1.1f,2,2,1,1,4,3);
  verifySplitPointScenario(4,true,1.1f,2,2,1,1,8,3);
  verifySplitPointScenario(0,true,1.5f,10,4);
  verifySplitPointScenario(0,false,1.4f,6,4);
  verifySplitPointScenario(1,true,1.5f,4,10);
  verifySplitPointScenario(0,false,1.4f,4,6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.TestTags </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTags() throws Exception {
  Table table=null;
  try {
    TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
    byte[] fam=Bytes.toBytes("info");
    byte[] row=Bytes.toBytes("rowa");
    byte[] qual=Bytes.toBytes("qual");
    byte[] row1=Bytes.toBytes("rowb");
    byte[] row2=Bytes.toBytes("rowc");
    HTableDescriptor desc=new HTableDescriptor(tableName);
    HColumnDescriptor colDesc=new HColumnDescriptor(fam);
    colDesc.setBlockCacheEnabled(true);
    colDesc.setDataBlockEncoding(DataBlockEncoding.PREFIX_TREE);
    desc.addFamily(colDesc);
    Admin admin=TEST_UTIL.getHBaseAdmin();
    admin.createTable(desc);
    byte[] value=Bytes.toBytes("value");
    table=TEST_UTIL.getConnection().getTable(tableName);
    Put put=new Put(row);
    put.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value);
    put.setAttribute("visibility",Bytes.toBytes("myTag"));
    table.put(put);
    admin.flush(tableName);
    Thread.sleep(1000);
    Put put1=new Put(row1);
    byte[] value1=Bytes.toBytes("1000dfsdf");
    put1.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value1);
    table.put(put1);
    admin.flush(tableName);
    Thread.sleep(1000);
    Put put2=new Put(row2);
    byte[] value2=Bytes.toBytes("1000dfsdf");
    put2.addColumn(fam,qual,HConstants.LATEST_TIMESTAMP,value2);
    put2.setAttribute("visibility",Bytes.toBytes("myTag3"));
    table.put(put2);
    admin.flush(tableName);
    Thread.sleep(1000);
    result(fam,row,qual,row2,table,value,value2,row1,value1);
    admin.compact(tableName);
    while (admin.getCompactionState(tableName) != CompactionState.NONE) {
      Thread.sleep(10);
    }
    result(fam,row,qual,row2,table,value,value2,row1,value1);
  }
  finally {
    if (table != null) {
      table.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.compactions.PerfTestCompactionPolicies </h4><pre class="type-15 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelection() throws Exception {
  long fileDiff=0;
  for (  List<StoreFile> storeFileList : generator) {
    List<StoreFile> currentFiles=new ArrayList<StoreFile>(18);
    for (    StoreFile file : storeFileList) {
      currentFiles.add(file);
      currentFiles=runIteration(currentFiles);
    }
    fileDiff+=(storeFileList.size() - currentFiles.size());
  }
  System.out.println(cp.getClass().getSimpleName() + "\t" + fileGenClass.getSimpleName()+ "\t"+ max+ "\t"+ min+ "\t"+ ratio+ "\t"+ written+ "\t"+ fileDiff);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.compactions.TestStripeCompactionPolicy </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOldStripesFromFlush() throws Exception {
  StripeCompactionPolicy policy=createPolicy(HBaseConfiguration.create());
  StripeInformationProvider si=createStripes(0,KEY_C,KEY_D);
  KeyValue[] input=new KeyValue[]{KV_B,KV_C,KV_C,KV_D,KV_E};
  KeyValue[][] expected=new KeyValue[][]{new KeyValue[]{KV_B},new KeyValue[]{KV_C,KV_C},new KeyValue[]{KV_D,KV_E}};
  verifyFlush(policy,si,input,expected,new byte[][]{OPEN_KEY,KEY_C,KEY_D,OPEN_KEY});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleStripeDropDeletes() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.unset("hbase.hstore.compaction.min.size");
  StripeCompactionPolicy policy=createPolicy(conf);
  Long[][] stripes=new Long[][]{new Long[]{3L,2L,2L,2L},new Long[]{6L}};
  StripeInformationProvider si=createStripesWithSizes(0,0,stripes);
  verifySingleStripeCompaction(policy,si,0,true);
  si=createStripesWithSizes(2,2,stripes);
  verifySingleStripeCompaction(policy,si,0,false);
  si=createStripesWithSizes(6,2,stripes);
  ConcatenatedLists<StoreFile> sfs=new ConcatenatedLists<StoreFile>();
  sfs.addSublist(si.getLevel0Files());
  sfs.addSublist(si.getStripes().get(0));
  verifyCompaction(policy,si,sfs,si.getStartRow(0),si.getEndRow(0),si.getStripeBoundaries());
  si=createStripesWithSizes(6,2,new Long[][]{new Long[]{10L,1L,1L,1L,1L},new Long[]{12L}});
  verifyCompaction(policy,si,si.getLevel0Files(),null,null,si.getStripeBoundaries());
  stripes=new Long[][]{new Long[]{100L,3L,2L,2L,2L},new Long[]{6L}};
  si=createStripesWithSizes(0,0,stripes);
  List<StoreFile> compact_file=new ArrayList<StoreFile>();
  Iterator<StoreFile> iter=si.getStripes().get(0).listIterator(1);
  while (iter.hasNext()) {
    compact_file.add(iter.next());
  }
  verifyCompaction(policy,si,compact_file,false,1,null,si.getStartRow(0),si.getEndRow(0),true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInitialCountFromL0() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.setInt(StripeStoreConfig.MIN_FILES_L0_KEY,2);
  StripeCompactionPolicy policy=createPolicy(conf,defaultSplitSize,defaultSplitCount,2,false);
  StripeCompactionPolicy.StripeInformationProvider si=createStripesL0Only(3,8);
  verifyCompaction(policy,si,si.getStorefiles(),true,2,12L,OPEN_KEY,OPEN_KEY,true);
  si=createStripesL0Only(3,10);
  verifyCompaction(policy,si,si.getStorefiles(),true,3,10L,OPEN_KEY,OPEN_KEY,true);
  policy=createPolicy(conf,defaultSplitSize,defaultSplitCount,6,false);
  verifyCompaction(policy,si,si.getStorefiles(),true,6,5L,OPEN_KEY,OPEN_KEY,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoStripesFromFlush() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.setBoolean(StripeStoreConfig.FLUSH_TO_L0_KEY,true);
  StripeCompactionPolicy policy=createPolicy(conf);
  StripeInformationProvider si=createStripesL0Only(0,0);
  KeyValue[] input=new KeyValue[]{KV_A,KV_B,KV_C,KV_D,KV_E};
  KeyValue[][] expected=new KeyValue[][]{input};
  verifyFlush(policy,si,input,expected,null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMergeExpiredStripes() throws Exception {
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  long now=defaultTtl + 2;
  edge.setValue(now);
  EnvironmentEdgeManager.injectEdge(edge);
  try {
    StoreFile expiredFile=createFile(), notExpiredFile=createFile();
    when(expiredFile.getReader().getMaxTimestamp()).thenReturn(now - defaultTtl - 1);
    when(notExpiredFile.getReader().getMaxTimestamp()).thenReturn(now - defaultTtl + 1);
    List<StoreFile> expired=Lists.newArrayList(expiredFile,expiredFile);
    List<StoreFile> notExpired=Lists.newArrayList(notExpiredFile,notExpiredFile);
    StripeCompactionPolicy policy=createPolicy(HBaseConfiguration.create(),defaultSplitSize,defaultSplitCount,defaultInitialCount,true);
    StripeCompactionPolicy.StripeInformationProvider si=createStripesWithFiles(expired,expired,expired);
    verifyMergeCompatcion(policy,si,0,2);
    si=createStripesWithFiles(notExpired,expired,notExpired,expired,expired,notExpired);
    verifyMergeCompatcion(policy,si,3,4);
  }
  finally {
    EnvironmentEdgeManager.reset();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNewStripesFromFlush() throws Exception {
  StripeCompactionPolicy policy=createPolicy(HBaseConfiguration.create());
  StripeInformationProvider si=createStripesL0Only(0,0);
  KeyValue[] input=new KeyValue[]{KV_B,KV_C,KV_C,KV_D,KV_E};
  KeyValue[][] expected=new KeyValue[][]{input};
  verifyFlush(policy,si,input,expected,new byte[][]{OPEN_KEY,OPEN_KEY});
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNothingToCompactFromL0() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.setInt(StripeStoreConfig.MIN_FILES_L0_KEY,4);
  StripeCompactionPolicy.StripeInformationProvider si=createStripesL0Only(3,10);
  StripeCompactionPolicy policy=createPolicy(conf);
  verifyNoCompaction(policy,si);
  si=createStripes(3,KEY_A);
  verifyNoCompaction(policy,si);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitOffStripeDropDeletes() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.setInt(StripeStoreConfig.MIN_FILES_KEY,2);
  StripeCompactionPolicy policy=createPolicy(conf);
  Long[] toSplit=new Long[]{defaultSplitSize / 2,defaultSplitSize / 2};
  Long[] noSplit=new Long[]{1L};
  long splitTargetSize=(long)(defaultSplitSize / defaultSplitCount);
  StripeCompactionPolicy.StripeInformationProvider si=createStripesWithSizes(0,0,noSplit,toSplit);
  verifyWholeStripesCompaction(policy,si,1,1,true,null,splitTargetSize);
  si=createStripesWithSizes(2,2,noSplit,toSplit);
  verifyWholeStripesCompaction(policy,si,1,1,false,null,splitTargetSize);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExistingStripesFromL0() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  conf.setInt(StripeStoreConfig.MIN_FILES_L0_KEY,3);
  StripeCompactionPolicy.StripeInformationProvider si=createStripes(3,KEY_A);
  verifyCompaction(createPolicy(conf),si,si.getLevel0Files(),null,null,si.getStripeBoundaries());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.throttle.TestFlushWithThroughputController </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the logic for striped store.
 */
@Test public void testFlushControlForStripedStore() throws Exception {
  TEST_UTIL.getConfiguration().set(StoreEngine.STORE_ENGINE_CLASS_KEY,StripeStoreEngine.class.getName());
  testFlushControl();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestCompressor </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNegativeToShort(){
  Compressor.toShort((byte)0xff,(byte)0xff);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestDurability </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDurability() throws Exception {
  final WALFactory wals=new WALFactory(CONF,null,"TestDurability");
  byte[] tableName=Bytes.toBytes("TestDurability");
  final WAL wal=wals.getWAL(tableName,null);
  HRegion region=createHRegion(tableName,"region",wal,Durability.USE_DEFAULT);
  HRegion deferredRegion=createHRegion(tableName,"deferredRegion",wal,Durability.ASYNC_WAL);
  region.put(newPut(null));
  verifyWALCount(wals,wal,1);
  deferredRegion.put(newPut(null));
  wal.sync();
  verifyWALCount(wals,wal,2);
  deferredRegion.put(newPut(null));
  wal.sync();
  verifyWALCount(wals,wal,3);
  region.put(newPut(null));
  verifyWALCount(wals,wal,4);
  deferredRegion.put(newPut(Durability.USE_DEFAULT));
  wal.sync();
  verifyWALCount(wals,wal,5);
  region.put(newPut(Durability.USE_DEFAULT));
  verifyWALCount(wals,wal,6);
  region.put(newPut(Durability.SKIP_WAL));
  deferredRegion.put(newPut(Durability.SKIP_WAL));
  verifyWALCount(wals,wal,6);
  wal.sync();
  verifyWALCount(wals,wal,6);
  region.put(newPut(Durability.ASYNC_WAL));
  deferredRegion.put(newPut(Durability.ASYNC_WAL));
  wal.sync();
  verifyWALCount(wals,wal,8);
  region.put(newPut(Durability.SYNC_WAL));
  deferredRegion.put(newPut(Durability.SYNC_WAL));
  verifyWALCount(wals,wal,10);
  region.put(newPut(Durability.FSYNC_WAL));
  deferredRegion.put(newPut(Durability.FSYNC_WAL));
  verifyWALCount(wals,wal,12);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestFSHLog </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSyncRunnerIndexOverflow() throws IOException, NoSuchFieldException, SecurityException, IllegalArgumentException, IllegalAccessException {
  final String name="testSyncRunnerIndexOverflow";
  FSHLog log=new FSHLog(fs,FSUtils.getRootDir(conf),name,HConstants.HREGION_OLDLOGDIR_NAME,conf,null,true,null,null);
  try {
    Field ringBufferEventHandlerField=FSHLog.class.getDeclaredField("ringBufferEventHandler");
    ringBufferEventHandlerField.setAccessible(true);
    FSHLog.RingBufferEventHandler ringBufferEventHandler=(FSHLog.RingBufferEventHandler)ringBufferEventHandlerField.get(log);
    Field syncRunnerIndexField=FSHLog.RingBufferEventHandler.class.getDeclaredField("syncRunnerIndex");
    syncRunnerIndexField.setAccessible(true);
    syncRunnerIndexField.set(ringBufferEventHandler,Integer.MAX_VALUE - 1);
    HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("t1")).addFamily(new HColumnDescriptor("row"));
    HRegionInfo hri=new HRegionInfo(htd.getTableName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
    MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
    for (int i=0; i < 10; i++) {
      addEdits(log,hri,htd,1,mvcc);
    }
  }
  finally {
    log.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestKeyValueCompression </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCountingKVs() throws Exception {
  List<KeyValue> kvs=Lists.newArrayList();
  for (int i=0; i < 400; i++) {
    byte[] row=Bytes.toBytes("row" + i);
    byte[] fam=Bytes.toBytes("fam" + i);
    byte[] qual=Bytes.toBytes("qual" + i);
    kvs.add(new KeyValue(row,fam,qual,12345L,VALUE));
  }
  runTestCycle(kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatingKVs() throws Exception {
  List<KeyValue> kvs=Lists.newArrayList();
  for (int i=0; i < 400; i++) {
    byte[] row=Bytes.toBytes("row" + (i % 10));
    byte[] fam=Bytes.toBytes("fam" + (i % 127));
    byte[] qual=Bytes.toBytes("qual" + (i % 128));
    kvs.add(new KeyValue(row,fam,qual,12345L,VALUE));
  }
  runTestCycle(kvs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestLogRollPeriod </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the LogRoller perform the roll with some data in the log
 */
@Test(timeout=60000) public void testWithEdits() throws Exception {
  final TableName tableName=TableName.valueOf("TestLogRollPeriodWithEdits");
  final String family="cf";
  TEST_UTIL.createTable(tableName,family);
  try {
    HRegionServer server=TEST_UTIL.getRSForFirstRegionInTable(tableName);
    WAL log=server.getWAL(null);
    final Table table=TEST_UTIL.getConnection().getTable(tableName);
    Thread writerThread=new Thread("writer"){
      @Override public void run(){
        try {
          long row=0;
          while (!interrupted()) {
            Put p=new Put(Bytes.toBytes(String.format("row%d",row)));
            p.addColumn(Bytes.toBytes(family),Bytes.toBytes("col"),Bytes.toBytes(row));
            table.put(p);
            row++;
            Thread.sleep(LOG_ROLL_PERIOD / 16);
          }
        }
 catch (        Exception e) {
          LOG.warn(e);
        }
      }
    }
;
    try {
      writerThread.start();
      checkMinLogRolls(log,5);
    }
  finally {
      writerThread.interrupt();
      writerThread.join();
      table.close();
    }
  }
  finally {
    TEST_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the LogRoller perform the roll even if there are no edits
 */
@Test public void testNoEdits() throws Exception {
  TableName tableName=TableName.valueOf("TestLogRollPeriodNoEdits");
  TEST_UTIL.createTable(tableName,"cf");
  try {
    Table table=TEST_UTIL.getConnection().getTable(tableName);
    try {
      HRegionServer server=TEST_UTIL.getRSForFirstRegionInTable(tableName);
      WAL log=server.getWAL(null);
      checkMinLogRolls(log,5);
    }
  finally {
      table.close();
    }
  }
  finally {
    TEST_UTIL.deleteTable(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestLogRolling </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that log rolling doesn't hang when no data is written.
 */
@Test(timeout=120000) public void testLogRollOnNothingWritten() throws Exception {
  final Configuration conf=TEST_UTIL.getConfiguration();
  final WALFactory wals=new WALFactory(conf,null,ServerName.valueOf("test.com",8080,1).toString());
  final WAL newLog=wals.getWAL(new byte[]{},null);
  try {
    newLog.rollWriter(true);
  }
  finally {
    wals.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestMetricsWAL </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLogRollRequested() throws Exception {
  MetricsWALSource source=mock(MetricsWALSourceImpl.class);
  MetricsWAL metricsWAL=new MetricsWAL(source);
  metricsWAL.logRollRequested(false);
  metricsWAL.logRollRequested(true);
  verify(source,times(2)).incrementLogRollRequested();
  verify(source,times(1)).incrementLowReplicationLogRoll();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPostSync() throws Exception {
  long nanos=TimeUnit.MILLISECONDS.toNanos(145);
  MetricsWALSource source=mock(MetricsWALSourceImpl.class);
  MetricsWAL metricsWAL=new MetricsWAL(source);
  metricsWAL.postSync(nanos,1);
  verify(source,times(1)).incrementSyncTime(145);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestMetricsWALSource </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestProtobufLog </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Reads the WAL with and without WALTrailer.
 * @throws IOException
 */
@Test public void testWALTrailer() throws IOException {
  doRead(true);
  doRead(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.regionserver.wal.TestWALCellCodecWithCompression </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncodeDecodeKVsWithTagsWithTagsCompression() throws Exception {
  doTest(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncodeDecodeKVsWithTags() throws Exception {
  doTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestMasterReplication </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000,expected=ServiceException.class) public void testReplicateWALEntryWhenReplicationIsDisabled() throws Exception {
  LOG.info("testSimplePutDelete");
  baseConfiguration.setBoolean(HConstants.REPLICATION_ENABLE_KEY,false);
  Table[] htables=null;
  try {
    startMiniClusters(1);
    createTableOnClusters(table);
    htables=getHTablesOnClusters(tableName);
    HRegionServer rs=utilities[0].getRSForFirstRegionInTable(tableName);
    RSRpcServices rsrpc=new RSRpcServices(rs);
    rsrpc.replicateWALEntry(null,null);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * It tests the replication scenario involving 0 -> 1 -> 0. It does it by bulk loading a set of
 * HFiles to a table in each cluster, checking if it's replicated.
 */
@Test(timeout=300000) public void testHFileCyclicReplication() throws Exception {
  LOG.info("testHFileCyclicReplication");
  int numClusters=2;
  Table[] htables=null;
  try {
    htables=setUpClusterTablesAndPeers(numClusters);
    byte[][][] hfileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("cccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("fff")}};
    int numOfRows=100;
    int[] expectedCounts=new int[]{hfileRanges.length * numOfRows,hfileRanges.length * numOfRows};
    loadAndValidateHFileReplication("testHFileCyclicReplication_01",0,new int[]{1},row,famName,htables,hfileRanges,numOfRows,expectedCounts,true);
    hfileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("gggg"),Bytes.toBytes("iiii")},new byte[][]{Bytes.toBytes("jjj"),Bytes.toBytes("lll")}};
    numOfRows=200;
    int[] newExpectedCounts=new int[]{hfileRanges.length * numOfRows + expectedCounts[0],hfileRanges.length * numOfRows + expectedCounts[1]};
    loadAndValidateHFileReplication("testHFileCyclicReplication_10",1,new int[]{0},row,famName,htables,hfileRanges,numOfRows,newExpectedCounts,true);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * It tests the replication scenario involving 0 -> 1 -> 0. It does it by
 * adding and deleting a row to a table in each cluster, checking if it's
 * replicated. It also tests that the puts and deletes are not replicated back
 * to the originating cluster.
 */
@Test(timeout=300000) public void testCyclicReplication1() throws Exception {
  LOG.info("testSimplePutDelete");
  int numClusters=2;
  Table[] htables=null;
  try {
    htables=setUpClusterTablesAndPeers(numClusters);
    int[] expectedCounts=new int[]{2,2};
    putAndWait(row,famName,htables[0],htables[1]);
    putAndWait(row1,famName,htables[1],htables[0]);
    validateCounts(htables,put,expectedCounts);
    deleteAndWait(row,htables[0],htables[1]);
    deleteAndWait(row1,htables[1],htables[0]);
    validateCounts(htables,delete,expectedCounts);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the cyclic replication scenario of 0 -> 1 -> 2 -> 0 by adding and deleting rows to a
 * table in each clusters and ensuring that the each of these clusters get the appropriate
 * mutations. It also tests the grouping scenario where a cluster needs to replicate the edits
 * originating from itself and also the edits that it received using replication from a different
 * cluster. The scenario is explained in HBASE-9158
 */
@Test(timeout=300000) public void testCyclicReplication2() throws Exception {
  LOG.info("testCyclicReplication1");
  int numClusters=3;
  Table[] htables=null;
  try {
    startMiniClusters(numClusters);
    createTableOnClusters(table);
    addPeer("1",0,1);
    addPeer("1",1,2);
    addPeer("1",2,0);
    htables=getHTablesOnClusters(tableName);
    putAndWait(row,famName,htables[0],htables[2]);
    putAndWait(row1,famName,htables[1],htables[0]);
    putAndWait(row2,famName,htables[2],htables[1]);
    deleteAndWait(row,htables[0],htables[2]);
    deleteAndWait(row1,htables[1],htables[0]);
    deleteAndWait(row2,htables[2],htables[1]);
    int[] expectedCounts=new int[]{3,3,3};
    validateCounts(htables,put,expectedCounts);
    validateCounts(htables,delete,expectedCounts);
    disablePeer("1",2);
    putAndWait(row3,famName,htables[0],htables[1]);
    htables[1].put(new Put(row4).addColumn(famName,row4,row4));
    enablePeer("1",2);
    wait(row4,htables[0],true);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests cyclic replication scenario of 0 -> 1 -> 2 -> 1.
 */
@Test(timeout=300000) public void testCyclicReplication3() throws Exception {
  LOG.info("testCyclicReplication2");
  int numClusters=3;
  Table[] htables=null;
  try {
    startMiniClusters(numClusters);
    createTableOnClusters(table);
    addPeer("1",0,1);
    addPeer("1",1,2);
    addPeer("1",2,1);
    htables=getHTablesOnClusters(tableName);
    putAndWait(row,famName,htables[0],htables[2]);
    putAndWait(row1,famName,htables[1],htables[2]);
    putAndWait(row2,famName,htables[2],htables[1]);
    deleteAndWait(row,htables[0],htables[2]);
    deleteAndWait(row1,htables[1],htables[2]);
    deleteAndWait(row2,htables[2],htables[1]);
    int[] expectedCounts=new int[]{1,3,3};
    validateCounts(htables,put,expectedCounts);
    validateCounts(htables,delete,expectedCounts);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * It tests the bulk loaded hfile replication scenario to only explicitly specified table column
 * families. It does it by bulk loading a set of HFiles belonging to both the CFs of table and set
 * only one CF data to replicate.
 */
@Test(timeout=300000) public void testHFileReplicationForConfiguredTableCfs() throws Exception {
  LOG.info("testHFileReplicationForConfiguredTableCfs");
  int numClusters=2;
  Table[] htables=null;
  try {
    startMiniClusters(numClusters);
    createTableOnClusters(table);
    htables=getHTablesOnClusters(tableName);
    addPeer("1",0,1,tableName.getNameAsString() + ":" + Bytes.toString(famName));
    byte[][][] hfileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("aaaa"),Bytes.toBytes("cccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("fff")}};
    int numOfRows=100;
    int[] expectedCounts=new int[]{hfileRanges.length * numOfRows,hfileRanges.length * numOfRows};
    loadAndValidateHFileReplication("load_f",0,new int[]{1},row,famName,htables,hfileRanges,numOfRows,expectedCounts,true);
    hfileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("gggg"),Bytes.toBytes("iiii")},new byte[][]{Bytes.toBytes("jjj"),Bytes.toBytes("lll")}};
    numOfRows=100;
    int[] newExpectedCounts=new int[]{hfileRanges.length * numOfRows + expectedCounts[0],expectedCounts[1]};
    loadAndValidateHFileReplication("load_f1",0,new int[]{1},row,famName1,htables,hfileRanges,numOfRows,newExpectedCounts,false);
    wait(0,htables[0],hfileRanges.length * numOfRows + expectedCounts[0]);
    Thread.sleep((NB_RETRIES / 2) * SLEEP_TIME);
    wait(1,htables[1],expectedCounts[1]);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestMultiSlaveReplication </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testMultiSlaveReplication() throws Exception {
  LOG.info("testCyclicReplication");
  MiniHBaseCluster master=utility1.startMiniCluster();
  utility2.startMiniCluster();
  utility3.startMiniCluster();
  ReplicationAdmin admin1=new ReplicationAdmin(conf1);
  utility1.getHBaseAdmin().createTable(table);
  utility2.getHBaseAdmin().createTable(table);
  utility3.getHBaseAdmin().createTable(table);
  Table htable1=utility1.getConnection().getTable(tableName);
  htable1.setWriteBufferSize(1024);
  Table htable2=utility2.getConnection().getTable(tableName);
  htable2.setWriteBufferSize(1024);
  Table htable3=utility3.getConnection().getTable(tableName);
  htable3.setWriteBufferSize(1024);
  admin1.addPeer("1",utility2.getClusterKey());
  putAndWait(row,famName,htable1,htable2);
  deleteAndWait(row,htable1,htable2);
  checkRow(row,0,htable3);
  putAndWait(row2,famName,htable1,htable2);
  rollWALAndWait(utility1,htable1.getName(),row2);
  putAndWait(row3,famName,htable1,htable2);
  admin1.addPeer("2",utility3.getClusterKey());
  putAndWait(row1,famName,htable1,htable2,htable3);
  deleteAndWait(row1,htable1,htable2,htable3);
  checkRow(row2,0,htable3);
  checkRow(row3,1,htable3);
  Put p=new Put(row);
  p.addColumn(famName,row,row);
  htable1.put(p);
  rollWALAndWait(utility1,htable1.getName(),row);
  deleteAndWait(row2,htable1,htable2,htable3);
  checkRow(row,1,htable2);
  checkWithWait(row,1,htable3);
  deleteAndWait(row,htable1,htable2,htable3);
  deleteAndWait(row3,htable1,htable2,htable3);
  utility3.shutdownMiniCluster();
  utility2.shutdownMiniCluster();
  utility1.shutdownMiniCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestPerTableCFReplication </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testPerTableCFReplication() throws Exception {
  LOG.info("testPerTableCFReplication");
  ReplicationAdmin replicationAdmin=new ReplicationAdmin(conf1);
  Connection connection1=ConnectionFactory.createConnection(conf1);
  Connection connection2=ConnectionFactory.createConnection(conf2);
  Connection connection3=ConnectionFactory.createConnection(conf3);
  try {
    Admin admin1=connection1.getAdmin();
    Admin admin2=connection2.getAdmin();
    Admin admin3=connection3.getAdmin();
    admin1.createTable(tabA);
    admin1.createTable(tabB);
    admin1.createTable(tabC);
    admin2.createTable(tabA);
    admin2.createTable(tabB);
    admin2.createTable(tabC);
    admin3.createTable(tabA);
    admin3.createTable(tabB);
    admin3.createTable(tabC);
    Table htab1A=connection1.getTable(tabAName);
    Table htab2A=connection2.getTable(tabAName);
    Table htab3A=connection3.getTable(tabAName);
    Table htab1B=connection1.getTable(tabBName);
    Table htab2B=connection2.getTable(tabBName);
    Table htab3B=connection3.getTable(tabBName);
    Table htab1C=connection1.getTable(tabCName);
    Table htab2C=connection2.getTable(tabCName);
    Table htab3C=connection3.getTable(tabCName);
    replicationAdmin.addPeer("2",utility2.getClusterKey(),"TC;TB:f1,f3");
    replicationAdmin.addPeer("3",utility3.getClusterKey(),"TA;TB:f1,f2");
    putAndWaitWithFamily(row1,f1Name,htab1A,htab3A);
    ensureRowNotReplicated(row1,f1Name,htab2A);
    deleteAndWaitWithFamily(row1,f1Name,htab1A,htab3A);
    putAndWaitWithFamily(row1,f2Name,htab1A,htab3A);
    ensureRowNotReplicated(row1,f2Name,htab2A);
    deleteAndWaitWithFamily(row1,f2Name,htab1A,htab3A);
    putAndWaitWithFamily(row1,f3Name,htab1A,htab3A);
    ensureRowNotReplicated(row1,f3Name,htab2A);
    deleteAndWaitWithFamily(row1,f3Name,htab1A,htab3A);
    putAndWaitWithFamily(row1,f1Name,htab1B,htab2B,htab3B);
    deleteAndWaitWithFamily(row1,f1Name,htab1B,htab2B,htab3B);
    putAndWaitWithFamily(row1,f2Name,htab1B,htab3B);
    ensureRowNotReplicated(row1,f2Name,htab2B);
    deleteAndWaitWithFamily(row1,f2Name,htab1B,htab3B);
    putAndWaitWithFamily(row1,f3Name,htab1B,htab2B);
    ensureRowNotReplicated(row1,f3Name,htab3B);
    deleteAndWaitWithFamily(row1,f3Name,htab1B,htab2B);
    putAndWaitWithFamily(row1,f1Name,htab1C,htab2C);
    ensureRowNotReplicated(row1,f1Name,htab3C);
    deleteAndWaitWithFamily(row1,f1Name,htab1C,htab2C);
    putAndWaitWithFamily(row1,f2Name,htab1C,htab2C);
    ensureRowNotReplicated(row1,f2Name,htab3C);
    deleteAndWaitWithFamily(row1,f2Name,htab1C,htab2C);
    putAndWaitWithFamily(row1,f3Name,htab1C,htab2C);
    ensureRowNotReplicated(row1,f3Name,htab3C);
    deleteAndWaitWithFamily(row1,f3Name,htab1C,htab2C);
    replicationAdmin.setPeerTableCFs("2","TA:f1,f2; TC:f2,f3");
    replicationAdmin.setPeerTableCFs("3","TB; TC:f3");
    putAndWaitWithFamily(row2,f1Name,htab1A,htab2A);
    ensureRowNotReplicated(row2,f1Name,htab3A);
    deleteAndWaitWithFamily(row2,f1Name,htab1A,htab2A);
    putAndWaitWithFamily(row2,f2Name,htab1A,htab2A);
    ensureRowNotReplicated(row2,f2Name,htab3A);
    deleteAndWaitWithFamily(row2,f2Name,htab1A,htab2A);
    putAndWaitWithFamily(row2,f3Name,htab1A);
    ensureRowNotReplicated(row2,f3Name,htab2A,htab3A);
    deleteAndWaitWithFamily(row2,f3Name,htab1A);
    putAndWaitWithFamily(row2,f1Name,htab1B,htab3B);
    ensureRowNotReplicated(row2,f1Name,htab2B);
    deleteAndWaitWithFamily(row2,f1Name,htab1B,htab3B);
    putAndWaitWithFamily(row2,f2Name,htab1B,htab3B);
    ensureRowNotReplicated(row2,f2Name,htab2B);
    deleteAndWaitWithFamily(row2,f2Name,htab1B,htab3B);
    putAndWaitWithFamily(row2,f3Name,htab1B,htab3B);
    ensureRowNotReplicated(row2,f3Name,htab2B);
    deleteAndWaitWithFamily(row2,f3Name,htab1B,htab3B);
    putAndWaitWithFamily(row2,f1Name,htab1C);
    ensureRowNotReplicated(row2,f1Name,htab2C,htab3C);
    deleteAndWaitWithFamily(row2,f1Name,htab1C);
    putAndWaitWithFamily(row2,f2Name,htab1C,htab2C);
    ensureRowNotReplicated(row2,f2Name,htab3C);
    deleteAndWaitWithFamily(row2,f2Name,htab1C,htab2C);
    putAndWaitWithFamily(row2,f3Name,htab1C,htab2C,htab3C);
    deleteAndWaitWithFamily(row2,f3Name,htab1C,htab2C,htab3C);
  }
  finally {
    connection1.close();
    connection2.close();
    connection3.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationEndpoint </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=120000) public void testInterClusterReplication() throws Exception {
  final String id="testInterClusterReplication";
  List<HRegion> regions=utility1.getHBaseCluster().getRegions(tableName);
  int totEdits=0;
  for (  HRegion region : regions) {
    HRegionInfo hri=region.getRegionInfo();
    byte[] row=hri.getStartKey();
    for (int i=0; i < 100; i++) {
      if (row.length > 0) {
        Put put=new Put(row);
        put.addColumn(famName,row,row);
        region.put(put);
        totEdits++;
      }
    }
  }
  admin.addPeer(id,new ReplicationPeerConfig().setClusterKey(ZKConfig.getZooKeeperClusterKey(conf2)).setReplicationEndpointImpl(InterClusterReplicationEndpointForTest.class.getName()),null);
  final int numEdits=totEdits;
  Waiter.waitFor(conf1,30000,new Waiter.ExplainingPredicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return InterClusterReplicationEndpointForTest.replicateCount.get() == numEdits;
    }
    @Override public String explainFailure() throws Exception {
      String failure="Failed to replicate all edits, expected = " + numEdits + " replicated = "+ InterClusterReplicationEndpointForTest.replicateCount.get();
      return failure;
    }
  }
);
  admin.removePeer("testInterClusterReplication");
  utility1.deleteTableData(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationKillMasterRS </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void killOneMasterRS() throws Exception {
  loadTableAndKillRS(utility1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationKillSlaveRS </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void killOneSlaveRS() throws Exception {
  loadTableAndKillRS(utility2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationSmallTests </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for HBASE-9038, Replication.scopeWALEdits would NPE if it wasn't filtering out
 * the compaction WALEdit
 * @throws Exception
 */
@Test(timeout=300000) public void testCompactionWALEdits() throws Exception {
  WALProtos.CompactionDescriptor compactionDescriptor=WALProtos.CompactionDescriptor.getDefaultInstance();
  HRegionInfo hri=new HRegionInfo(htable1.getName(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW);
  WALEdit edit=WALEdit.createCompaction(hri,compactionDescriptor);
  Replication.scopeWALEdits(htable1.getTableDescriptor(),new WALKey(),edit,htable1.getConfiguration(),null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.TestReplicationSyncUpTool </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Add a row to a table in each cluster, check it's replicated, delete it,
 * check's gone Also check the puts and deletes are not replicated back to
 * the originating cluster.
 */
@Test(timeout=300000) public void testSyncUpTool() throws Exception {
  setupReplication();
  putAndReplicateRows();
  mimicSyncUpAfterDelete();
  mimicSyncUpAfterPut();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestMetricsReplicationSourceFactory </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsReplicationSource.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.replication.regionserver.TestRegionReplicaReplicationEndpoint </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationWith10Replicas() throws Exception {
  testRegionReplicaReplication(10);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationIgnoresDroppedTables() throws Exception {
  testRegionReplicaReplicationIgnoresDisabledTables(true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationForFlushAndCompaction() throws Exception {
  int regionReplication=3;
  TableName tableName=TableName.valueOf("testRegionReplicaReplicationForFlushAndCompaction");
  HTableDescriptor htd=HTU.createTableDescriptor(tableName.toString());
  htd.setRegionReplication(regionReplication);
  HTU.getHBaseAdmin().createTable(htd);
  Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());
  Table table=connection.getTable(tableName);
  try {
    for (int i=0; i < 6000; i+=1000) {
      LOG.info("Writing data from " + i + " to "+ (i + 1000));
      HTU.loadNumericRows(table,HBaseTestingUtility.fam1,i,i + 1000);
      LOG.info("flushing table");
      HTU.flush(tableName);
      LOG.info("compacting table");
      HTU.compact(tableName,false);
    }
    verifyReplication(tableName,regionReplication,0,1000);
  }
  finally {
    table.close();
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationWith2Replicas() throws Exception {
  testRegionReplicaReplication(2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationIgnoresDisabledTables() throws Exception {
  testRegionReplicaReplicationIgnoresDisabledTables(false);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaWithoutMemstoreReplication() throws Exception {
  int regionReplication=3;
  TableName tableName=TableName.valueOf("testRegionReplicaWithoutMemstoreReplication");
  HTableDescriptor htd=HTU.createTableDescriptor(tableName.toString());
  htd.setRegionReplication(regionReplication);
  htd.setRegionMemstoreReplication(false);
  HTU.getHBaseAdmin().createTable(htd);
  Connection connection=ConnectionFactory.createConnection(HTU.getConfiguration());
  Table table=connection.getTable(tableName);
  try {
    final int STEP=100;
    for (int i=0; i < 3; ++i) {
      final int startRow=i * STEP;
      final int endRow=(i + 1) * STEP;
      LOG.info("Writing data from " + startRow + " to "+ endRow);
      HTU.loadNumericRows(table,HBaseTestingUtility.fam1,startRow,endRow);
      verifyReplication(tableName,regionReplication,startRow,endRow,false);
      LOG.info("flushing table");
      HTU.flush(tableName);
      verifyReplication(tableName,regionReplication,0,endRow,true);
    }
  }
  finally {
    table.close();
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=240000) public void testRegionReplicaReplicationWith3Replicas() throws Exception {
  testRegionReplicaReplication(3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestGZIPResponseWrapper </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSendError() throws IOException {
  wrapper.sendError(404);
  verify(response).sendError(404);
  wrapper.sendError(404,"error message");
  verify(response).sendError(404,"error message");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * wrapper should set all headers except "content-length"
 */
@Test public void testHeader() throws IOException {
  wrapper.setStatus(200);
  verify(response).setStatus(200);
  wrapper.addHeader("header","header value");
  verify(response).addHeader("header","header value");
  wrapper.addHeader("content-length","header value2");
  verify(response,never()).addHeader("content-length","header value");
  wrapper.setIntHeader("header",5);
  verify(response).setIntHeader("header",5);
  wrapper.setIntHeader("content-length",4);
  verify(response,never()).setIntHeader("content-length",4);
  wrapper.setHeader("set-header","new value");
  verify(response).setHeader("set-header","new value");
  wrapper.setHeader("content-length","content length value");
  verify(response,never()).setHeader("content-length","content length value");
  wrapper.sendRedirect("location");
  verify(response).sendRedirect("location");
  wrapper.flushBuffer();
  verify(response).flushBuffer();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestMetricsRESTSource </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws Exception {
  CompatibilitySingletonFactory.getInstance(MetricsRESTSource.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.TestScannersWithFilters </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQualifierFilter() throws Exception {
  long expectedRows=numRows / 2;
  long expectedKeys=2;
  Filter f=new QualifierFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=2;
  f=new QualifierFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=4;
  f=new QualifierFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=2;
  f=new QualifierFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testQualifierOne-2")));
  s=new Scan(HConstants.EMPTY_START_ROW,Bytes.toBytes("testRowTwo"));
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(QUALIFIERS_ONE[2]));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
  f=new QualifierFilter(CompareOp.NOT_EQUAL,new RegexStringComparator("test.+-2"));
  s=new Scan();
  s.setFilter(f);
  kvs=new KeyValue[]{new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFirstKeyOnlyFilter() throws Exception {
  Scan s=new Scan();
  s.setFilter(new FirstKeyOnlyFilter());
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRowFilter() throws Exception {
  long expectedRows=1;
  long expectedKeys=colsPerRow;
  Filter f=new RowFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=2;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.EQUAL,new RegexStringComparator("testRow.+-2"));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=1;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=2;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows - 1;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows - 1;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows - 2;
  expectedKeys=colsPerRow;
  f=new RowFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new RowFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testRowOne-2")));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
  f=new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2"));
  s=new Scan();
  s.setFilter(f);
  kvs=new KeyValue[]{new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefixFilter() throws Exception {
  long expectedRows=numRows / 2;
  long expectedKeys=colsPerRow;
  Scan s=new Scan();
  s.setFilter(new PrefixFilter(Bytes.toBytes("testRowOne")));
  verifyScan(s,expectedRows,expectedKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkipFilter() throws Exception {
  Filter f=new SkipFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testQualifierOne-2"))));
  Scan s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInclusiveStopFilter() throws Exception {
  long expectedRows=(numRows / 2) - 1;
  long expectedKeys=colsPerRow;
  Scan s=new Scan(Bytes.toBytes("testRowOne-0"),Bytes.toBytes("testRowOne-3"));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  s=new Scan(Bytes.toBytes("testRowOne-0"));
  s.setFilter(new InclusiveStopFilter(Bytes.toBytes("testRowOne-3")));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=(numRows / 2) - 1;
  expectedKeys=colsPerRow;
  s=new Scan(Bytes.toBytes("testRowTwo-0"),Bytes.toBytes("testRowTwo-3"));
  verifyScan(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  s=new Scan(Bytes.toBytes("testRowTwo-0"));
  s.setFilter(new InclusiveStopFilter(Bytes.toBytes("testRowTwo-3")));
  verifyScan(s,expectedRows,expectedKeys);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPageFilter() throws Exception {
  KeyValue[] expectedKVs={new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[0],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[2],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[0],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[0],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[2],VALUES[0]),new KeyValue(ROWS_ONE[3],FAMILIES[1],QUALIFIERS_ONE[3],VALUES[0]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  long expectedRows=6;
  long expectedKeys=colsPerRow;
  Scan s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,expectedKVs);
  expectedRows=4;
  expectedKeys=colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,24));
  expectedRows=2;
  expectedKeys=colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,12));
  expectedRows=1;
  expectedKeys=colsPerRow;
  s=new Scan();
  s.setFilter(new PageFilter(expectedRows));
  verifyScan(s,expectedRows,expectedKeys);
  s.setFilter(new PageFilter(expectedRows));
  verifyScanFull(s,Arrays.copyOf(expectedKVs,6));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterList() throws Exception {
  List<Filter> filters=new ArrayList<Filter>();
  filters.add(new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new ValueFilter(CompareOp.EQUAL,new SubstringComparator("One")));
  Filter f=new FilterList(Operator.MUST_PASS_ALL,filters);
  Scan s=new Scan();
  s.addFamily(FAMILIES[0]);
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_ONE[2],FAMILIES[0],QUALIFIERS_ONE[2],VALUES[0])};
  verifyScanFull(s,kvs);
  filters.clear();
  filters.add(new RowFilter(CompareOp.EQUAL,new RegexStringComparator(".+Two.+")));
  filters.add(new QualifierFilter(CompareOp.EQUAL,new RegexStringComparator(".+-2")));
  filters.add(new ValueFilter(CompareOp.EQUAL,new SubstringComparator("One")));
  f=new FilterList(Operator.MUST_PASS_ONE,filters);
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,numRows,colsPerRow);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoFilter() throws Exception {
  long expectedRows=numRows;
  long expectedKeys=colsPerRow;
  Scan s=new Scan();
  verifyScan(s,expectedRows,expectedKeys);
  s=new Scan();
  s.addFamily(FAMILIES[0]);
  verifyScan(s,expectedRows,expectedKeys / 2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValueFilter() throws Exception {
  long expectedRows=numRows / 2;
  long expectedKeys=colsPerRow;
  Filter f=new ValueFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  Scan s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.EQUAL,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.EQUAL,new RegexStringComparator("testValue((One)|(Two))"));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.LESS,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueTwo")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.LESS_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.GREATER_OR_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  expectedRows=numRows / 2;
  expectedKeys=colsPerRow;
  f=new ValueFilter(CompareOp.GREATER,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  verifyScanNoEarlyOut(s,expectedRows,expectedKeys);
  f=new ValueFilter(CompareOp.NOT_EQUAL,new BinaryComparator(Bytes.toBytes("testValueOne")));
  s=new Scan();
  s.setFilter(f);
  KeyValue[] kvs={new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[0],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[2],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[0],QUALIFIERS_TWO[3],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[0],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[2],VALUES[1]),new KeyValue(ROWS_TWO[3],FAMILIES[1],QUALIFIERS_TWO[3],VALUES[1])};
  verifyScanFull(s,kvs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.client.TestRemoteAdminRetries </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingGetRestVersion() throws Exception {
  testTimedOutGetCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.getRestVersion();
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingGetTableList() throws Exception {
  testTimedOutGetCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.getTableList();
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingGetTableAvailable() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.isTableAvailable(Bytes.toBytes("TestTable"));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings("deprecation") public void testFailingCreateTable() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.createTable(new HTableDescriptor(Bytes.toBytes("TestTable")));
    }
  }
);
  verify(client,times(RETRIES)).put(anyString(),anyString(),any(byte[].class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingDeleteTable() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.deleteTable("TestTable");
    }
  }
);
  verify(client,times(RETRIES)).delete(anyString());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingGetClusterVersion() throws Exception {
  testTimedOutGetCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.getClusterVersion();
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFailingGetClusterStatus() throws Exception {
  testTimedOutGetCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteAdmin.getClusterStatus();
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.client.TestRemoteHTableRetries </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetScanner() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteTable.getScanner(new Scan());
    }
  }
);
  verify(client,times(RETRIES)).post(anyString(),anyString(),any(byte[].class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckAndDelete() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      Put put=new Put(ROW_1);
      put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
      Delete delete=new Delete(ROW_1);
      remoteTable.checkAndDelete(ROW_1,COLUMN_1,QUALIFIER_1,VALUE_1,delete);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGet() throws Exception {
  testTimedOutGetCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteTable.get(new Get(Bytes.toBytes("Get")));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckAndPut() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      Put put=new Put(ROW_1);
      put.addColumn(COLUMN_1,QUALIFIER_1,VALUE_1);
      remoteTable.checkAndPut(ROW_1,COLUMN_1,QUALIFIER_1,VALUE_1,put);
    }
  }
);
  verify(client,times(RETRIES)).put(anyString(),anyString(),any(byte[].class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiRowPut() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      Put[] puts={new Put(Bytes.toBytes("Row1")),new Put(Bytes.toBytes("Row2"))};
      remoteTable.put(Arrays.asList(puts));
    }
  }
);
  verify(client,times(RETRIES)).put(anyString(),anyString(),any(byte[].class));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDelete() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      Delete delete=new Delete(Bytes.toBytes("delete"));
      remoteTable.delete(delete);
    }
  }
);
  verify(client,times(RETRIES)).delete(anyString());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleRowPut() throws Exception {
  testTimedOutCall(new CallExecutor(){
    @Override public void run() throws Exception {
      remoteTable.put(new Put(Bytes.toBytes("Row")));
    }
  }
);
  verify(client,times(RETRIES)).put(anyString(),anyString(),any(byte[].class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.model.TestNamespacesInstanceModel </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromPB() throws Exception {
  checkModel(fromPB(AS_PB));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromXML() throws Exception {
  checkModel(fromXML(AS_XML));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuildModel() throws Exception {
  checkModel(buildTestModel());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.rest.model.TestNamespacesModel </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromXML() throws Exception {
  checkModel(fromXML(AS_XML));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFromPB() throws Exception {
  checkModel(fromPB(AS_PB));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBuildModel() throws Exception {
  checkModel(buildTestModel());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.AbstractTestSecureIPC </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSaslNoCommonQop() throws Exception {
  exception.expect(SaslException.class);
  exception.expectMessage("No common protection layer between client and server");
  setRpcProtection("integrity","privacy");
  callRpcService(User.create(ugi));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test various combinations of Server and Client qops.
 * @throws Exception
 */
@Test public void testSaslWithCommonQop() throws Exception {
  setRpcProtection("privacy,authentication","authentication");
  callRpcService(User.create(ugi));
  setRpcProtection("authentication","privacy,authentication");
  callRpcService(User.create(ugi));
  setRpcProtection("integrity,authentication","privacy,authentication");
  callRpcService(User.create(ugi));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestHBaseSaslRpcClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAuthMethodReadWrite() throws IOException {
  DataInputBuffer in=new DataInputBuffer();
  DataOutputBuffer out=new DataOutputBuffer();
  assertAuthMethodRead(in,AuthMethod.SIMPLE);
  assertAuthMethodRead(in,AuthMethod.KERBEROS);
  assertAuthMethodRead(in,AuthMethod.DIGEST);
  assertAuthMethodWrite(out,AuthMethod.SIMPLE);
  assertAuthMethodWrite(out,AuthMethod.KERBEROS);
  assertAuthMethodWrite(out,AuthMethod.DIGEST);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSaslClientCallbackHandler() throws UnsupportedCallbackException {
  final Token<? extends TokenIdentifier> token=createTokenMock();
  when(token.getIdentifier()).thenReturn(DEFAULT_USER_NAME.getBytes());
  when(token.getPassword()).thenReturn(DEFAULT_USER_PASSWORD.getBytes());
  final NameCallback nameCallback=mock(NameCallback.class);
  final PasswordCallback passwordCallback=mock(PasswordCallback.class);
  final RealmCallback realmCallback=mock(RealmCallback.class);
  final RealmChoiceCallback realmChoiceCallback=mock(RealmChoiceCallback.class);
  Callback[] callbackArray={nameCallback,passwordCallback,realmCallback,realmChoiceCallback};
  final SaslClientCallbackHandler saslClCallbackHandler=new SaslClientCallbackHandler(token);
  saslClCallbackHandler.handle(callbackArray);
  verify(nameCallback).setName(anyString());
  verify(realmCallback).setText(anyString());
  verify(passwordCallback).setPassword(any(char[].class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.TestUser </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserGroupNames() throws Exception {
  final String username="testuser";
  final ImmutableSet<String> singleGroups=ImmutableSet.of("group");
  final Configuration conf=HBaseConfiguration.create();
  User user=User.createUserForTesting(conf,username,singleGroups.toArray(new String[singleGroups.size()]));
  assertUserGroup(user,singleGroups);
  final ImmutableSet<String> multiGroups=ImmutableSet.of("group","group1","group2");
  user=User.createUserForTesting(conf,username,multiGroups.toArray(new String[multiGroups.size()]));
  assertUserGroup(user,multiGroups);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessControlFilter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testQualifierAccess() throws Exception {
  final Table table=createTable(TEST_UTIL,TABLE,new byte[][]{FAMILY});
  try {
    doQualifierAccess(table);
  }
  finally {
    table.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testPostGrantRevokeAtQualifierLevel() throws Exception {
  final TableName tableName=TableName.valueOf("testGrantRevokeAtQualifierLevel");
  final byte[] family1=Bytes.toBytes("f1");
  final byte[] family2=Bytes.toBytes("f2");
  final byte[] qualifier=Bytes.toBytes("q");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  if (admin.tableExists(tableName)) {
    deleteTable(TEST_UTIL,tableName);
  }
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(family1));
  htd.addFamily(new HColumnDescriptor(family2));
  createTable(TEST_UTIL,htd);
  try {
    User user=User.createUserForTesting(TEST_UTIL.getConfiguration(),"user",new String[0]);
    AccessTestAction getQualifierAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Get g=new Get(TEST_ROW);
        g.addColumn(family1,qualifier);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.get(g);
        }
         return null;
      }
    }
;
    AccessTestAction putQualifierAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Put p=new Put(TEST_ROW);
        p.addColumn(family1,qualifier,Bytes.toBytes("v1"));
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.put(p);
        }
         return null;
      }
    }
;
    AccessTestAction deleteQualifierAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Delete d=new Delete(TEST_ROW);
        d.addColumn(family1,qualifier);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.delete(d);
        }
         return null;
      }
    }
;
    revokeFromTable(TEST_UTIL,user.getShortName(),tableName,family1,null);
    verifyDenied(user,getQualifierAction);
    verifyDenied(user,putQualifierAction);
    verifyDenied(user,deleteQualifierAction);
    grantOnTable(TEST_UTIL,user.getShortName(),tableName,family1,qualifier,Permission.Action.READ);
    verifyAllowed(user,getQualifierAction);
    verifyDenied(user,putQualifierAction);
    verifyDenied(user,deleteQualifierAction);
    grantOnTable(TEST_UTIL,user.getShortName(),tableName,family1,qualifier,Permission.Action.WRITE);
    verifyDenied(user,getQualifierAction);
    verifyAllowed(user,putQualifierAction);
    verifyAllowed(user,deleteQualifierAction);
    grantOnTable(TEST_UTIL,user.getShortName(),tableName,family1,qualifier,Permission.Action.READ,Permission.Action.WRITE);
    verifyAllowed(user,getQualifierAction);
    verifyAllowed(user,putQualifierAction);
    verifyAllowed(user,deleteQualifierAction);
    revokeFromTable(TEST_UTIL,user.getShortName(),tableName,family1,qualifier);
    verifyDenied(user,getQualifierAction);
    verifyDenied(user,putQualifierAction);
    verifyDenied(user,deleteQualifierAction);
  }
  finally {
    deleteTable(TEST_UTIL,tableName);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testGrantRevoke() throws Exception {
  AccessTestAction grantAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table acl=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
        BlockingRpcChannel service=acl.coprocessorService(TEST_TABLE.getName());
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.grant(protocol,USER_RO.getShortName(),TEST_TABLE,TEST_FAMILY,null,Action.READ);
      }
       return null;
    }
  }
;
  AccessTestAction revokeAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table acl=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
        BlockingRpcChannel service=acl.coprocessorService(TEST_TABLE.getName());
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.revoke(protocol,USER_RO.getShortName(),TEST_TABLE,TEST_FAMILY,null,Action.READ);
      }
       return null;
    }
  }
;
  AccessTestAction getTablePermissionsAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table acl=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
        BlockingRpcChannel service=acl.coprocessorService(TEST_TABLE.getName());
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.getUserPermissions(protocol,TEST_TABLE);
      }
       return null;
    }
  }
;
  AccessTestAction getGlobalPermissionsAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table acl=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.getUserPermissions(protocol);
      }
       return null;
    }
  }
;
  verifyAllowed(grantAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(grantAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  try {
    verifyAllowed(revokeAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
    verifyDenied(revokeAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
    verifyAllowed(getTablePermissionsAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
    verifyDenied(getTablePermissionsAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
    verifyAllowed(getGlobalPermissionsAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
    verifyDenied(getGlobalPermissionsAction,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  }
  finally {
    grantOnTable(TEST_UTIL,USER_RO.getShortName(),TEST_TABLE,TEST_FAMILY,null,Permission.Action.READ);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableNameEnumeration() throws Exception {
  AccessTestAction listTablesAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Connection unmanagedConnection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
      Admin admin=unmanagedConnection.getAdmin();
      try {
        return Arrays.asList(admin.listTableNames());
      }
  finally {
        admin.close();
        unmanagedConnection.close();
      }
    }
  }
;
  verifyAllowed(listTablesAction,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_GROUP_CREATE,USER_GROUP_ADMIN,USER_GROUP_READ,USER_GROUP_WRITE);
  verifyIfEmptyList(listTablesAction,USER_NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testOpenRegion() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preOpen(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableTruncate() throws Exception {
  AccessTestAction truncateTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preTruncateTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE);
      return null;
    }
  }
;
  verifyAllowed(truncateTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(truncateTable,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testCloseRegion() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preClose(ObserverContext.createAndPrepare(RCP_ENV,null),false);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testReservedCellTags() throws Exception {
  AccessTestAction putWithReservedTag=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        KeyValue kv=new KeyValue(TEST_ROW,TEST_FAMILY,TEST_QUALIFIER,HConstants.LATEST_TIMESTAMP,HConstants.EMPTY_BYTE_ARRAY,new Tag[]{new ArrayBackedTag(AccessControlLists.ACL_TAG_TYPE,ProtobufUtil.toUsersAndPermissions(USER_OWNER.getShortName(),new Permission(Permission.Action.READ)).toByteArray())});
        t.put(new Put(TEST_ROW).add(kv));
      }
       return null;
    }
  }
;
  verifyAllowed(putWithReservedTag,User.getCurrent());
  verifyDenied(putWithReservedTag,USER_OWNER,USER_ADMIN,USER_CREATE,USER_RW,USER_RO);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableCreate() throws Exception {
  AccessTestAction createTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testnewtable"));
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      ACCESS_CONTROLLER.preCreateTable(ObserverContext.createAndPrepare(CP_ENV,null),htd,null);
      return null;
    }
  }
;
  verifyAllowed(createTable,SUPERUSER,USER_ADMIN,USER_GROUP_CREATE);
  verifyDenied(createTable,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_ADMIN,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testSplitWithSplitRow() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSplit(ObserverContext.createAndPrepare(RCP_ENV,null),TEST_ROW);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testUnassign() throws Exception {
  List<HRegionLocation> regions;
  try (RegionLocator locator=systemUserConnection.getRegionLocator(TEST_TABLE)){
    regions=locator.getAllRegionLocations();
  }
   HRegionLocation location=regions.get(0);
  final HRegionInfo hri=location.getRegionInfo();
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preUnassign(ObserverContext.createAndPrepare(CP_ENV,null),hri,false);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAddColumn() throws Exception {
  final HColumnDescriptor hcd=new HColumnDescriptor("fam_new");
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preAddColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE,hcd);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(action,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testPostGrantRevoke() throws Exception {
  final TableName tableName=TableName.valueOf("TempTable");
  final byte[] family1=Bytes.toBytes("f1");
  final byte[] family2=Bytes.toBytes("f2");
  final byte[] qualifier=Bytes.toBytes("q");
  Admin admin=TEST_UTIL.getHBaseAdmin();
  if (admin.tableExists(tableName)) {
    deleteTable(TEST_UTIL,tableName);
  }
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor(family1));
  htd.addFamily(new HColumnDescriptor(family2));
  createTable(TEST_UTIL,htd);
  try {
    User tblUser=User.createUserForTesting(TEST_UTIL.getConfiguration(),"tbluser",new String[0]);
    User gblUser=User.createUserForTesting(TEST_UTIL.getConfiguration(),"gbluser",new String[0]);
    AccessTestAction putActionAll=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Put p=new Put(Bytes.toBytes("a"));
        p.addColumn(family1,qualifier,Bytes.toBytes("v1"));
        p.addColumn(family2,qualifier,Bytes.toBytes("v2"));
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.put(p);
        }
         return null;
      }
    }
;
    AccessTestAction putAction1=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Put p=new Put(Bytes.toBytes("a"));
        p.addColumn(family1,qualifier,Bytes.toBytes("v1"));
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.put(p);
        }
         return null;
      }
    }
;
    AccessTestAction putAction2=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Put p=new Put(Bytes.toBytes("a"));
        p.addColumn(family2,qualifier,Bytes.toBytes("v2"));
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.put(p);
        }
         return null;
      }
    }
;
    AccessTestAction getActionAll=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Get g=new Get(TEST_ROW);
        g.addFamily(family1);
        g.addFamily(family2);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.get(g);
        }
         return null;
      }
    }
;
    AccessTestAction getAction1=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Get g=new Get(TEST_ROW);
        g.addFamily(family1);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.get(g);
        }
         return null;
      }
    }
;
    AccessTestAction getAction2=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Get g=new Get(TEST_ROW);
        g.addFamily(family2);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.get(g);
        }
         return null;
      }
    }
;
    AccessTestAction deleteActionAll=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Delete d=new Delete(TEST_ROW);
        d.addFamily(family1);
        d.addFamily(family2);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.delete(d);
        }
         return null;
      }
    }
;
    AccessTestAction deleteAction1=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Delete d=new Delete(TEST_ROW);
        d.addFamily(family1);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.delete(d);
        }
         return null;
      }
    }
;
    AccessTestAction deleteAction2=new AccessTestAction(){
      @Override public Object run() throws Exception {
        Delete d=new Delete(TEST_ROW);
        d.addFamily(family2);
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(tableName)){
          t.delete(d);
        }
         return null;
      }
    }
;
    verifyDenied(tblUser,getActionAll,getAction1,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1,putAction2);
    verifyDenied(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyDenied(gblUser,getActionAll,getAction1,getAction2);
    verifyDenied(gblUser,putActionAll,putAction1,putAction2);
    verifyDenied(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    grantGlobal(TEST_UTIL,gblUser.getShortName(),Permission.Action.READ);
    grantOnTable(TEST_UTIL,tblUser.getShortName(),tableName,null,null,Permission.Action.READ);
    verifyAllowed(tblUser,getActionAll,getAction1,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1,putAction2);
    verifyDenied(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyAllowed(gblUser,getActionAll,getAction1,getAction2);
    verifyDenied(gblUser,putActionAll,putAction1,putAction2);
    verifyDenied(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    grantGlobal(TEST_UTIL,gblUser.getShortName(),Permission.Action.WRITE);
    grantOnTable(TEST_UTIL,tblUser.getShortName(),tableName,null,null,Permission.Action.WRITE);
    verifyDenied(tblUser,getActionAll,getAction1,getAction2);
    verifyAllowed(tblUser,putActionAll,putAction1,putAction2);
    verifyAllowed(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyDenied(gblUser,getActionAll,getAction1,getAction2);
    verifyAllowed(gblUser,putActionAll,putAction1,putAction2);
    verifyAllowed(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    revokeGlobal(TEST_UTIL,gblUser.getShortName());
    revokeFromTable(TEST_UTIL,tblUser.getShortName(),tableName,null,null);
    verifyDenied(tblUser,getActionAll,getAction1,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1,putAction2);
    verifyDenied(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyDenied(gblUser,getActionAll,getAction1,getAction2);
    verifyDenied(gblUser,putActionAll,putAction1,putAction2);
    verifyDenied(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    grantGlobal(TEST_UTIL,gblUser.getShortName(),Permission.Action.READ);
    grantOnTable(TEST_UTIL,tblUser.getShortName(),tableName,family1,null,Permission.Action.READ);
    verifyAllowed(tblUser,getActionAll,getAction1);
    verifyDenied(tblUser,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1,putAction2);
    verifyDenied(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyAllowed(gblUser,getActionAll,getAction1,getAction2);
    verifyDenied(gblUser,putActionAll,putAction1,putAction2);
    verifyDenied(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    grantGlobal(TEST_UTIL,gblUser.getShortName(),Permission.Action.WRITE);
    grantOnTable(TEST_UTIL,tblUser.getShortName(),tableName,family2,null,Permission.Action.WRITE);
    verifyAllowed(tblUser,getActionAll,getAction1);
    verifyAllowed(tblUser,putAction2,deleteAction2);
    verifyDenied(tblUser,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1);
    verifyDenied(tblUser,deleteActionAll,deleteAction1);
    verifyDenied(gblUser,getActionAll,getAction1,getAction2);
    verifyAllowed(gblUser,putActionAll,putAction1,putAction2);
    verifyAllowed(gblUser,deleteActionAll,deleteAction1,deleteAction2);
    revokeGlobal(TEST_UTIL,gblUser.getShortName());
    revokeFromTable(TEST_UTIL,tblUser.getShortName(),tableName,family2,null);
    verifyAllowed(tblUser,getActionAll,getAction1);
    verifyDenied(tblUser,getAction2);
    verifyDenied(tblUser,putActionAll,putAction1,putAction2);
    verifyDenied(tblUser,deleteActionAll,deleteAction1,deleteAction2);
    verifyDenied(gblUser,getActionAll,getAction1,getAction2);
    verifyDenied(gblUser,putActionAll,putAction1,putAction2);
    verifyDenied(gblUser,deleteActionAll,deleteAction1,deleteAction2);
  }
  finally {
    deleteTable(TEST_UTIL,tableName);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAccessControlClientGlobalGrantRevoke() throws Exception {
  User testGlobalGrantRevoke=User.createUserForTesting(conf,"testGlobalGrantRevoke",new String[0]);
  AccessTestAction getAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        return t.get(new Get(TEST_ROW));
      }
     }
  }
;
  verifyDenied(getAction,testGlobalGrantRevoke);
  String userName=testGlobalGrantRevoke.getShortName();
  try {
    grantGlobalUsingAccessControlClient(TEST_UTIL,systemUserConnection,userName,Permission.Action.READ);
  }
 catch (  Throwable e) {
    LOG.error("error during call of AccessControlClient.grant. ",e);
  }
  try {
    verifyAllowed(getAction,testGlobalGrantRevoke);
    try {
      revokeGlobalUsingAccessControlClient(TEST_UTIL,systemUserConnection,userName,Permission.Action.READ);
    }
 catch (    Throwable e) {
      LOG.error("error during call of AccessControlClient.revoke ",e);
    }
    verifyDenied(getAction,testGlobalGrantRevoke);
  }
  finally {
    revokeGlobal(TEST_UTIL,userName,Permission.Action.READ);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testStopMaster() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preStopMaster(ObserverContext.createAndPrepare(CP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testPrepareAndCleanBulkLoad() throws Exception {
  AccessTestAction prepareBulkLoadAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.prePrepareBulkLoad(ObserverContext.createAndPrepare(RCP_ENV,null),null);
      return null;
    }
  }
;
  AccessTestAction cleanupBulkLoadAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCleanupBulkLoad(ObserverContext.createAndPrepare(RCP_ENV,null),null);
      return null;
    }
  }
;
  verifyAnyCreate(prepareBulkLoadAction);
  verifyAnyCreate(cleanupBulkLoadAction);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableModify() throws Exception {
  AccessTestAction modifyTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE);
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      htd.addFamily(new HColumnDescriptor("fam_" + User.getCurrent().getShortName()));
      ACCESS_CONTROLLER.preModifyTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE,htd);
      return null;
    }
  }
;
  verifyAllowed(modifyTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(modifyTable,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableDescriptorsEnumeration() throws Exception {
  User TABLE_ADMIN=User.createUserForTesting(conf,"UserA",new String[0]);
  grantOnTable(TEST_UTIL,TABLE_ADMIN.getShortName(),TEST_TABLE,null,null,Permission.Action.ADMIN);
  try {
    AccessTestAction listTablesAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());Admin admin=conn.getAdmin()){
          return Arrays.asList(admin.listTables());
        }
       }
    }
;
    AccessTestAction getTableDescAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());Admin admin=conn.getAdmin()){
          return admin.getTableDescriptor(TEST_TABLE);
        }
       }
    }
;
    verifyAllowed(listTablesAction,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,TABLE_ADMIN,USER_GROUP_CREATE,USER_GROUP_ADMIN);
    verifyIfEmptyList(listTablesAction,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
    verifyAllowed(getTableDescAction,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,TABLE_ADMIN,USER_GROUP_CREATE,USER_GROUP_ADMIN);
    verifyDenied(getTableDescAction,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
  }
  finally {
    revokeFromTable(TEST_UTIL,TABLE_ADMIN.getShortName(),TEST_TABLE,null,null,Permission.Action.ADMIN);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testSetQuota() throws Exception {
  AccessTestAction setUserQuotaAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSetUserQuota(ObserverContext.createAndPrepare(CP_ENV,null),null,null);
      return null;
    }
  }
;
  AccessTestAction setUserTableQuotaAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSetUserQuota(ObserverContext.createAndPrepare(CP_ENV,null),null,TEST_TABLE,null);
      return null;
    }
  }
;
  AccessTestAction setUserNamespaceQuotaAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSetUserQuota(ObserverContext.createAndPrepare(CP_ENV,null),null,(String)null,null);
      return null;
    }
  }
;
  AccessTestAction setTableQuotaAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSetTableQuota(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE,null);
      return null;
    }
  }
;
  AccessTestAction setNamespaceQuotaAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSetNamespaceQuota(ObserverContext.createAndPrepare(CP_ENV,null),null,null);
      return null;
    }
  }
;
  verifyAllowed(setUserQuotaAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(setUserQuotaAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(setUserTableQuotaAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(setUserTableQuotaAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(setUserNamespaceQuotaAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(setUserNamespaceQuotaAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(setTableQuotaAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(setTableQuotaAction,USER_CREATE,USER_RW,USER_RO,USER_NONE);
  verifyAllowed(setNamespaceQuotaAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(setNamespaceQuotaAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testSnapshotWithOwner() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor htd=admin.getTableDescriptor(TEST_TABLE);
  SnapshotDescription.Builder builder=SnapshotDescription.newBuilder();
  builder.setName(TEST_TABLE.getNameAsString() + "-snapshot");
  builder.setTable(TEST_TABLE.getNameAsString());
  builder.setOwner(USER_OWNER.getName());
  final SnapshotDescription snapshot=builder.build();
  AccessTestAction snapshotAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
;
  verifyAllowed(snapshotAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(snapshotAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  AccessTestAction deleteAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot);
      return null;
    }
  }
;
  verifyAllowed(deleteAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(deleteAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  AccessTestAction restoreAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preRestoreSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
;
  verifyAllowed(restoreAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(restoreAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  AccessTestAction cloneAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCloneSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),null,null);
      return null;
    }
  }
;
  verifyAllowed(cloneAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(cloneAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testFlush() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preFlush(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(action,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAbortProcedure() throws Exception {
  final TableName tableName=TableName.valueOf("testAbortProcedure");
  final ProcedureExecutor<MasterProcedureEnv> procExec=TEST_UTIL.getHBaseCluster().getMaster().getMasterProcedureExecutor();
  Procedure proc=new TestTableDDLProcedure(procExec.getEnvironment(),tableName);
  proc.setOwner(USER_OWNER.getShortName());
  final long procId=procExec.submitProcedure(proc);
  AccessTestAction abortProcedureAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preAbortProcedure(ObserverContext.createAndPrepare(CP_ENV,null),procExec,procId);
      return null;
    }
  }
;
  verifyAllowed(abortProcedureAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyAllowed(abortProcedureAction,USER_OWNER);
  verifyDenied(abortProcedureAction,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAccessControlClientGrantRevoke() throws Exception {
  User testGrantRevoke=User.createUserForTesting(conf,"testGrantRevoke",new String[0]);
  AccessTestAction getAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        return t.get(new Get(TEST_ROW));
      }
     }
  }
;
  verifyDenied(getAction,testGrantRevoke);
  try {
    grantOnTableUsingAccessControlClient(TEST_UTIL,systemUserConnection,testGrantRevoke.getShortName(),TEST_TABLE,null,null,Permission.Action.READ);
  }
 catch (  Throwable e) {
    LOG.error("error during call of AccessControlClient.grant. ",e);
  }
  verifyAllowed(getAction,testGrantRevoke);
  try {
    revokeFromTableUsingAccessControlClient(TEST_UTIL,systemUserConnection,testGrantRevoke.getShortName(),TEST_TABLE,null,null,Permission.Action.READ);
  }
 catch (  Throwable e) {
    LOG.error("error during call of AccessControlClient.revoke ",e);
  }
  verifyDenied(getAction,testGrantRevoke);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testWrite() throws Exception {
  AccessTestAction putAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Put p=new Put(TEST_ROW);
      p.addColumn(TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes(1));
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.put(p);
      }
       return null;
    }
  }
;
  verifyWrite(putAction);
  AccessTestAction deleteAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Delete d=new Delete(TEST_ROW);
      d.addFamily(TEST_FAMILY);
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.delete(d);
      }
       return null;
    }
  }
;
  verifyWrite(deleteAction);
  AccessTestAction incrementAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Increment inc=new Increment(TEST_ROW);
      inc.addColumn(TEST_FAMILY,TEST_QUALIFIER,1);
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.increment(inc);
      }
       return null;
    }
  }
;
  verifyWrite(incrementAction);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testShutdown() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preShutdown(ObserverContext.createAndPrepare(CP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testBalance() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preBalance(ObserverContext.createAndPrepare(CP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableDeletion() throws Exception {
  User TABLE_ADMIN=User.createUserForTesting(conf,"TestUser",new String[0]);
  final TableName tname=TableName.valueOf("testTableDeletion");
  createTestTable(tname);
  grantOnTable(TEST_UTIL,TABLE_ADMIN.getShortName(),tname,null,null,Permission.Action.ADMIN);
  AccessTestAction deleteTableAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Connection unmanagedConnection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());
      Admin admin=unmanagedConnection.getAdmin();
      try {
        deleteTable(TEST_UTIL,admin,tname);
      }
  finally {
        admin.close();
        unmanagedConnection.close();
      }
      return null;
    }
  }
;
  verifyDenied(deleteTableAction,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
  verifyAllowed(deleteTableAction,TABLE_ADMIN);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testListProcedures() throws Exception {
  final TableName tableName=TableName.valueOf("testAbortProcedure");
  final ProcedureExecutor<MasterProcedureEnv> procExec=TEST_UTIL.getHBaseCluster().getMaster().getMasterProcedureExecutor();
  Procedure proc=new TestTableDDLProcedure(procExec.getEnvironment(),tableName);
  proc.setOwner(USER_OWNER.getShortName());
  final long procId=procExec.submitProcedure(proc);
  final List<ProcedureInfo> procInfoList=procExec.listProcedures();
  AccessTestAction listProceduresAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<ProcedureInfo> procInfoListClone=new ArrayList<ProcedureInfo>(procInfoList.size());
      for (      ProcedureInfo pi : procInfoList) {
        procInfoListClone.add(pi.clone());
      }
      ACCESS_CONTROLLER.postListProcedures(ObserverContext.createAndPrepare(CP_ENV,null),procInfoListClone);
      return null;
    }
  }
;
  verifyAllowed(listProceduresAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyAllowed(listProceduresAction,USER_OWNER);
  verifyIfNull(listProceduresAction,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableEnable() throws Exception {
  AccessTestAction enableTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preEnableTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE);
      return null;
    }
  }
;
  verifyAllowed(enableTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(enableTable,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testDeleteColumn() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE,TEST_FAMILY);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_ADMIN_CF,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(action,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testRead() throws Exception {
  AccessTestAction getAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Get g=new Get(TEST_ROW);
      g.addFamily(TEST_FAMILY);
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.get(g);
      }
       return null;
    }
  }
;
  verifyRead(getAction);
  AccessTestAction scanAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Scan s=new Scan();
      s.addFamily(TEST_FAMILY);
      try (Connection conn=ConnectionFactory.createConnection(conf);Table table=conn.getTable(TEST_TABLE)){
        ResultScanner scanner=table.getScanner(s);
        try {
          for (Result r=scanner.next(); r != null; r=scanner.next()) {
          }
        }
 catch (        IOException e) {
        }
 finally {
          scanner.close();
        }
      }
       return null;
    }
  }
;
  verifyRead(scanAction);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testSplit() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSplit(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAppend() throws Exception {
  AccessTestAction appendAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      byte[] row=TEST_ROW;
      byte[] qualifier=TEST_QUALIFIER;
      Put put=new Put(row);
      put.addColumn(TEST_FAMILY,qualifier,Bytes.toBytes(1));
      Append append=new Append(row);
      append.add(TEST_FAMILY,qualifier,Bytes.toBytes(2));
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.put(put);
        t.append(append);
      }
       return null;
    }
  }
;
  verifyAllowed(appendAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW,USER_GROUP_WRITE);
  verifyDenied(appendAction,USER_RO,USER_NONE,USER_GROUP_CREATE,USER_GROUP_READ,USER_GROUP_ADMIN);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testModifyColumn() throws Exception {
  final HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY);
  hcd.setMaxVersions(10);
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preModifyColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE,hcd);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_ADMIN_CF,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(action,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testBulkLoad() throws Exception {
  try {
    FileSystem fs=TEST_UTIL.getTestFileSystem();
    final Path dir=TEST_UTIL.getDataTestDirOnTestFS("testBulkLoad");
    fs.mkdirs(dir);
    fs.setPermission(dir,FsPermission.valueOf("-rwxrwxrwx"));
    AccessTestAction bulkLoadAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        int numRows=3;
        byte[][][] hfileRanges={{{(byte)0},{(byte)9}}};
        Path bulkLoadBasePath=new Path(dir,new Path(User.getCurrent().getName()));
        new BulkLoadHelper(bulkLoadBasePath).bulkLoadHFile(TEST_TABLE,TEST_FAMILY,TEST_QUALIFIER,hfileRanges,numRows);
        return null;
      }
    }
;
    verifyAllowed(bulkLoadAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_GROUP_CREATE);
    verifyDenied(bulkLoadAction,USER_RW,USER_NONE,USER_RO,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_ADMIN);
  }
  finally {
    TEST_UTIL.getHBaseAdmin().disableTable(TEST_TABLE);
    TEST_UTIL.getHBaseAdmin().enableTable(TEST_TABLE);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableDisable() throws Exception {
  AccessTestAction disableTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDisableTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE);
      return null;
    }
  }
;
  AccessTestAction disableAclTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDisableTable(ObserverContext.createAndPrepare(CP_ENV,null),AccessControlLists.ACL_TABLE_NAME);
      return null;
    }
  }
;
  verifyAllowed(disableTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(disableTable,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
  verifyDenied(disableAclTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_GROUP_CREATE,USER_GROUP_ADMIN,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testCoprocessorExec() throws Exception {
  for (  JVMClusterUtil.RegionServerThread thread : TEST_UTIL.getMiniHBaseCluster().getRegionServerThreads()) {
    HRegionServer rs=thread.getRegionServer();
    for (    Region region : rs.getOnlineRegions(TEST_TABLE)) {
      region.getCoprocessorHost().load(PingCoprocessor.class,Coprocessor.PRIORITY_USER,conf);
    }
  }
  User userA=User.createUserForTesting(conf,"UserA",new String[0]);
  User userB=User.createUserForTesting(conf,"UserB",new String[0]);
  grantOnTable(TEST_UTIL,userA.getShortName(),TEST_TABLE,null,null,Permission.Action.EXEC);
  try {
    AccessTestAction execEndpointAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
          BlockingRpcChannel service=t.coprocessorService(HConstants.EMPTY_BYTE_ARRAY);
          PingCoprocessor.newBlockingStub(service).noop(null,NoopRequest.newBuilder().build());
        }
         return null;
      }
    }
;
    String namespace=TEST_TABLE.getNamespaceAsString();
    grantOnNamespace(TEST_UTIL,userB.getShortName(),namespace,Permission.Action.EXEC);
    verifyAllowed(execEndpointAction,userA,userB);
    revokeFromNamespace(TEST_UTIL,userB.getShortName(),namespace,Permission.Action.EXEC);
    verifyDenied(execEndpointAction,userB);
    verifyAllowed(execEndpointAction,userA);
  }
  finally {
    revokeFromTable(TEST_UTIL,userA.getShortName(),TEST_TABLE,null,null,Permission.Action.EXEC);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testReplicateLogEntries() throws Exception {
  AccessTestAction replicateLogEntriesAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preReplicateLogEntries(ObserverContext.createAndPrepare(RSCP_ENV,null),null,null);
      ACCESS_CONTROLLER.postReplicateLogEntries(ObserverContext.createAndPrepare(RSCP_ENV,null),null,null);
      return null;
    }
  }
;
  verifyAllowed(replicateLogEntriesAction,SUPERUSER,USER_ADMIN,USER_GROUP_WRITE);
  verifyDenied(replicateLogEntriesAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_ADMIN,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testMove() throws Exception {
  List<HRegionLocation> regions;
  try (RegionLocator locator=systemUserConnection.getRegionLocator(TEST_TABLE)){
    regions=locator.getAllRegionLocations();
  }
   HRegionLocation location=regions.get(0);
  final HRegionInfo hri=location.getRegionInfo();
  final ServerName server=location.getServerName();
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preMove(ObserverContext.createAndPrepare(CP_ENV,null),hri,server,server);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testNamespaceUserGrant() throws Exception {
  AccessTestAction getAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        return t.get(new Get(TEST_ROW));
      }
     }
  }
;
  String namespace=TEST_TABLE.getNamespaceAsString();
  grantOnNamespace(TEST_UTIL,USER_NONE.getShortName(),namespace,Permission.Action.READ);
  verifyAllowed(getAction,USER_NONE);
  revokeFromNamespace(TEST_UTIL,USER_NONE.getShortName(),namespace,Permission.Action.READ);
  verifyDenied(getAction,USER_NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testRollWALWriterRequest() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preRollWALWriterRequest(ObserverContext.createAndPrepare(RSCP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testStopRegionServer() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preStopRegionServer(ObserverContext.createAndPrepare(RSCP_ENV,null));
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAssign() throws Exception {
  List<HRegionLocation> regions;
  try (RegionLocator locator=systemUserConnection.getRegionLocator(TEST_TABLE)){
    regions=locator.getAllRegionLocations();
  }
   HRegionLocation location=regions.get(0);
  final HRegionInfo hri=location.getRegionInfo();
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preAssign(ObserverContext.createAndPrepare(CP_ENV,null),hri);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testAccessControlClientGrantRevokeOnNamespace() throws Exception {
  User testNS=User.createUserForTesting(conf,"testNS",new String[0]);
  AccessTestAction getAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        return t.get(new Get(TEST_ROW));
      }
     }
  }
;
  verifyDenied(getAction,testNS);
  String userName=testNS.getShortName();
  String namespace=TEST_TABLE.getNamespaceAsString();
  try {
    grantOnNamespaceUsingAccessControlClient(TEST_UTIL,systemUserConnection,userName,namespace,Permission.Action.READ);
  }
 catch (  Throwable e) {
    LOG.error("error during call of AccessControlClient.grant. ",e);
  }
  try {
    verifyAllowed(getAction,testNS);
    try {
      revokeFromNamespaceUsingAccessControlClient(TEST_UTIL,systemUserConnection,userName,namespace,Permission.Action.READ);
    }
 catch (    Throwable e) {
      LOG.error("error during call of AccessControlClient.revoke ",e);
    }
    verifyDenied(getAction,testNS);
  }
  finally {
    revokeFromNamespace(TEST_UTIL,userName,namespace,Permission.Action.READ);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testBalanceSwitch() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preBalanceSwitch(ObserverContext.createAndPrepare(CP_ENV,null),true);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_OWNER,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testReadWrite() throws Exception {
  AccessTestAction checkAndDeleteAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Delete d=new Delete(TEST_ROW);
      d.addFamily(TEST_FAMILY);
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.checkAndDelete(TEST_ROW,TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("test_value"),d);
      }
       return null;
    }
  }
;
  verifyReadWrite(checkAndDeleteAction);
  AccessTestAction checkAndPut=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Put p=new Put(TEST_ROW);
      p.addColumn(TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes(1));
      try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(TEST_TABLE)){
        t.checkAndPut(TEST_ROW,TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("test_value"),p);
      }
       return null;
    }
  }
;
  verifyReadWrite(checkAndPut);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testSnapshot() throws Exception {
  Admin admin=TEST_UTIL.getHBaseAdmin();
  final HTableDescriptor htd=admin.getTableDescriptor(TEST_TABLE);
  SnapshotDescription.Builder builder=SnapshotDescription.newBuilder();
  builder.setName(TEST_TABLE.getNameAsString() + "-snapshot");
  builder.setTable(TEST_TABLE.getNameAsString());
  final SnapshotDescription snapshot=builder.build();
  AccessTestAction snapshotAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
;
  AccessTestAction deleteAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot);
      return null;
    }
  }
;
  AccessTestAction restoreAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preRestoreSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
;
  AccessTestAction cloneAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCloneSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),null,null);
      return null;
    }
  }
;
  verifyAllowed(snapshotAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(snapshotAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(cloneAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(deleteAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(restoreAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(restoreAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(deleteAction,SUPERUSER,USER_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(cloneAction,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_OWNER,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableDelete() throws Exception {
  AccessTestAction deleteTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE);
      return null;
    }
  }
;
  verifyAllowed(deleteTable,SUPERUSER,USER_ADMIN,USER_CREATE,USER_OWNER,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(deleteTable,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testCompact() throws Exception {
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCompact(ObserverContext.createAndPrepare(RCP_ENV,null),null,null,ScanType.COMPACT_RETAIN_DELETES);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_GROUP_CREATE,USER_GROUP_ADMIN);
  verifyDenied(action,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testRegionOffline() throws Exception {
  List<HRegionLocation> regions;
  try (RegionLocator locator=systemUserConnection.getRegionLocator(TEST_TABLE)){
    regions=locator.getAllRegionLocations();
  }
   HRegionLocation location=regions.get(0);
  final HRegionInfo hri=location.getRegionInfo();
  AccessTestAction action=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preRegionOffline(ObserverContext.createAndPrepare(CP_ENV,null),hri);
      return null;
    }
  }
;
  verifyAllowed(action,SUPERUSER,USER_ADMIN,USER_OWNER,USER_GROUP_ADMIN);
  verifyDenied(action,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController2 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testCreateTableWithGroupPermissions() throws Exception {
  grantGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.CREATE);
  try {
    AccessTestAction createAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        HTableDescriptor desc=new HTableDescriptor(TEST_TABLE.getTableName());
        desc.addFamily(new HColumnDescriptor(TEST_FAMILY));
        try (Connection connection=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration())){
          try (Admin admin=connection.getAdmin()){
            admin.createTable(desc);
          }
         }
         return null;
      }
    }
;
    verifyAllowed(createAction,TESTGROUP1_USER1);
    verifyDenied(createAction,TESTGROUP2_USER1);
  }
  finally {
    revokeGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.CREATE);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testCoprocessorLoading() throws Exception {
  MasterCoprocessorHost cpHost=TEST_UTIL.getMiniHBaseCluster().getMaster().getMasterCoprocessorHost();
  cpHost.load(MyAccessController.class,Coprocessor.PRIORITY_HIGHEST,conf);
  AccessController ACCESS_CONTROLLER=(AccessController)cpHost.findCoprocessor(MyAccessController.class.getName());
  MasterCoprocessorEnvironment CP_ENV=cpHost.createEnvironment(MyAccessController.class,ACCESS_CONTROLLER,Coprocessor.PRIORITY_HIGHEST,1,conf);
  RegionServerCoprocessorHost rsHost=TEST_UTIL.getMiniHBaseCluster().getRegionServer(0).getRegionServerCoprocessorHost();
  RegionServerCoprocessorEnvironment RSCP_ENV=rsHost.createEnvironment(MyAccessController.class,ACCESS_CONTROLLER,Coprocessor.PRIORITY_HIGHEST,1,conf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testACLTableAccess() throws Exception {
  final Configuration conf=TEST_UTIL.getConfiguration();
  User superUser=User.createUserForTesting(conf,"admin",new String[]{"supergroup"});
  User globalRead=User.createUserForTesting(conf,"globalRead",new String[0]);
  User globalWrite=User.createUserForTesting(conf,"globalWrite",new String[0]);
  User globalCreate=User.createUserForTesting(conf,"globalCreate",new String[0]);
  User globalAdmin=User.createUserForTesting(conf,"globalAdmin",new String[0]);
  SecureTestUtil.grantGlobal(TEST_UTIL,globalRead.getShortName(),Action.READ);
  SecureTestUtil.grantGlobal(TEST_UTIL,globalWrite.getShortName(),Action.WRITE);
  SecureTestUtil.grantGlobal(TEST_UTIL,globalCreate.getShortName(),Action.CREATE);
  SecureTestUtil.grantGlobal(TEST_UTIL,globalAdmin.getShortName(),Action.ADMIN);
  User nsRead=User.createUserForTesting(conf,"nsRead",new String[0]);
  User nsWrite=User.createUserForTesting(conf,"nsWrite",new String[0]);
  User nsCreate=User.createUserForTesting(conf,"nsCreate",new String[0]);
  User nsAdmin=User.createUserForTesting(conf,"nsAdmin",new String[0]);
  SecureTestUtil.grantOnNamespace(TEST_UTIL,nsRead.getShortName(),TEST_TABLE.getTableName().getNamespaceAsString(),Action.READ);
  SecureTestUtil.grantOnNamespace(TEST_UTIL,nsWrite.getShortName(),TEST_TABLE.getTableName().getNamespaceAsString(),Action.WRITE);
  SecureTestUtil.grantOnNamespace(TEST_UTIL,nsCreate.getShortName(),TEST_TABLE.getTableName().getNamespaceAsString(),Action.CREATE);
  SecureTestUtil.grantOnNamespace(TEST_UTIL,nsAdmin.getShortName(),TEST_TABLE.getTableName().getNamespaceAsString(),Action.ADMIN);
  User tableRead=User.createUserForTesting(conf,"tableRead",new String[0]);
  User tableWrite=User.createUserForTesting(conf,"tableWrite",new String[0]);
  User tableCreate=User.createUserForTesting(conf,"tableCreate",new String[0]);
  User tableAdmin=User.createUserForTesting(conf,"tableAdmin",new String[0]);
  SecureTestUtil.grantOnTable(TEST_UTIL,tableRead.getShortName(),TEST_TABLE.getTableName(),null,null,Action.READ);
  SecureTestUtil.grantOnTable(TEST_UTIL,tableWrite.getShortName(),TEST_TABLE.getTableName(),null,null,Action.WRITE);
  SecureTestUtil.grantOnTable(TEST_UTIL,tableCreate.getShortName(),TEST_TABLE.getTableName(),null,null,Action.CREATE);
  SecureTestUtil.grantOnTable(TEST_UTIL,tableAdmin.getShortName(),TEST_TABLE.getTableName(),null,null,Action.ADMIN);
  grantGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.WRITE);
  try {
    AccessTestAction writeAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
          t.put(new Put(TEST_ROW).addColumn(AccessControlLists.ACL_LIST_FAMILY,TEST_QUALIFIER,TEST_VALUE));
          return null;
        }
  finally {
        }
      }
    }
;
    verifyDenied(writeAction,globalAdmin,globalCreate,globalRead,TESTGROUP2_USER1);
    verifyDenied(writeAction,nsAdmin,nsCreate,nsRead,nsWrite);
    verifyDenied(writeAction,tableAdmin,tableCreate,tableRead,tableWrite);
    verifyAllowed(writeAction,superUser,globalWrite,TESTGROUP1_USER1);
  }
  finally {
    revokeGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.WRITE);
  }
  grantGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.READ);
  try {
    AccessTestAction scanAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        try (Connection conn=ConnectionFactory.createConnection(conf);Table t=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
          ResultScanner s=t.getScanner(new Scan());
          try {
            for (Result r=s.next(); r != null; r=s.next()) {
            }
          }
  finally {
            s.close();
          }
          return null;
        }
       }
    }
;
    verifyDenied(scanAction,globalAdmin,globalCreate,globalWrite,TESTGROUP2_USER1);
    verifyDenied(scanAction,nsCreate,nsAdmin,nsRead,nsWrite);
    verifyDenied(scanAction,tableCreate,tableAdmin,tableRead,tableWrite);
    verifyAllowed(scanAction,superUser,globalRead,TESTGROUP1_USER1);
  }
  finally {
    revokeGlobal(TEST_UTIL,TESTGROUP_1_NAME,Action.READ);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestAccessController3 </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableCreate() throws Exception {
  AccessTestAction createTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TableName.valueOf("testnewtable"));
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      ACCESS_CONTROLLER.preCreateTable(ObserverContext.createAndPrepare(CP_ENV,null),htd,null);
      return null;
    }
  }
;
  verifyAllowed(createTable,SUPERUSER,USER_ADMIN,USER_GROUP_CREATE);
  verifyDenied(createTable,USER_CREATE,USER_RW,USER_RO,USER_NONE,USER_GROUP_ADMIN,USER_GROUP_READ,USER_GROUP_WRITE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestCellACLWithMultipleVersions </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsWithDeleteWithUserTs() throws Exception {
  USER_OWNER.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW);
          p.addColumn(TEST_FAMILY1,TEST_Q1,123L,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,123L,ZERO);
          p.setACL(prepareCellPermissions(new String[]{USER_OTHER.getShortName(),AuthUtil.toGroupEntry(GROUP),USER_OTHER2.getShortName()},Permission.Action.READ,Permission.Action.WRITE));
          t.put(p);
          p=new Put(TEST_ROW);
          p.addColumn(TEST_FAMILY1,TEST_Q1,125L,ONE);
          p.addColumn(TEST_FAMILY1,TEST_Q2,125L,ONE);
          p.setACL(prepareCellPermissions(new String[]{USER_OTHER.getShortName(),AuthUtil.toGroupEntry(GROUP)},Action.READ,Action.WRITE));
          t.put(p);
          p=new Put(TEST_ROW);
          p.addColumn(TEST_FAMILY1,TEST_Q1,127L,TWO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,127L,TWO);
          p.setACL(prepareCellPermissions(new String[]{USER_OTHER.getShortName(),AuthUtil.toGroupEntry(GROUP)},Action.READ,Action.WRITE));
          t.put(p);
          return null;
        }
       }
     }
  }
);
  USER_OTHER2.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW,124L);
          d.addColumns(TEST_FAMILY1,TEST_Q1);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
  USER_OTHER2.runAs(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW);
          d.addColumns(TEST_FAMILY1,TEST_Q2,124L);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsForIncrementWithMultipleVersions() throws Exception {
  final byte[] TEST_ROW1=Bytes.toBytes("r1");
  final byte[] TEST_Q1=Bytes.toBytes("q1");
  final byte[] TEST_Q2=Bytes.toBytes("q2");
  final byte[] ZERO=Bytes.toBytes(0L);
  final User user1=User.createUserForTesting(conf,"user1",new String[0]);
  final User user2=User.createUserForTesting(conf,"user2",new String[0]);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Map<String,Permission> permsU1andOwner=prepareCellPermissions(new String[]{user1.getShortName(),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Map<String,Permission> permsU2andGUandOwner=prepareCellPermissions(new String[]{user2.getShortName(),AuthUtil.toGroupEntry(GROUP),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)123,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)123,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)127,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)127,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Increment inc=new Increment(TEST_ROW1);
          inc.setTimeRange(0,123);
          inc.addColumn(TEST_FAMILY1,TEST_Q1,2L);
          t.increment(inc);
          t.incrementColumnValue(TEST_ROW1,TEST_FAMILY1,TEST_Q2,1L);
        }
       }
       return null;
    }
  }
);
  verifyUserDeniedForIncrementMultipleVersions(user2,TEST_ROW1,TEST_Q2);
  verifyUserDeniedForIncrementMultipleVersions(GROUP_USER,TEST_ROW1,TEST_Q2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionwithVersions() throws Exception {
  final Map<String,Permission> writePerms=prepareCellPermissions(usersAndGroups,Action.WRITE);
  final Map<String,Permission> readPerms=prepareCellPermissions(usersAndGroups,Action.READ);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(TEST_TABLE.getTableName())){
        Put p;
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(writePerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(readPerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(writePerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(readPerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(writePerms);
        t.put(p);
      }
       return null;
    }
  }
,USER_OWNER);
  AccessTestAction getQ1=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Get get=new Get(TEST_ROW);
      get.setMaxVersions(10);
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(TEST_TABLE.getTableName())){
        return t.get(get).listCells();
      }
     }
  }
;
  AccessTestAction get2=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Get get=new Get(TEST_ROW);
      get.setMaxVersions(10);
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(TEST_TABLE.getTableName())){
        return t.get(get).listCells();
      }
     }
  }
;
  verifyAllowed(GROUP_USER,getQ1,2);
  verifyAllowed(USER_OTHER,getQ1,2);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(TEST_TABLE.getTableName())){
        Put p;
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(writePerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(readPerms);
        t.put(p);
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
        p.setACL(writePerms);
        t.put(p);
      }
       return null;
    }
  }
,USER_OWNER);
  verifyAllowed(USER_OTHER,get2,1);
  verifyAllowed(GROUP_USER,get2,1);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsForPutWithMultipleVersions() throws Exception {
  final byte[] TEST_ROW1=Bytes.toBytes("r1");
  final byte[] TEST_Q1=Bytes.toBytes("q1");
  final byte[] TEST_Q2=Bytes.toBytes("q2");
  final byte[] ZERO=Bytes.toBytes(0L);
  final User user1=User.createUserForTesting(conf,"user1",new String[0]);
  final User user2=User.createUserForTesting(conf,"user2",new String[0]);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Map<String,Permission> permsU1andOwner=prepareCellPermissions(new String[]{user1.getShortName(),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Map<String,Permission> permsU2andGUandOwner=prepareCellPermissions(new String[]{user1.getShortName(),AuthUtil.toGroupEntry(GROUP),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          permsU2andGUandOwner.put(user2.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          permsU2andGUandOwner.put(USER_OWNER.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)123,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)123,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)127,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)127,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)125,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,ZERO);
          p.setACL(user2.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          t.put(p);
        }
       }
       return null;
    }
  }
);
  verifyUserDeniedForPutMultipleVersions(user2,TEST_ROW1,TEST_Q1,TEST_Q2,ZERO);
  verifyUserDeniedForPutMultipleVersions(GROUP_USER,TEST_ROW1,TEST_Q1,TEST_Q2,ZERO);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsForCheckAndDelete() throws Exception {
  final byte[] TEST_ROW1=Bytes.toBytes("r1");
  final byte[] TEST_Q3=Bytes.toBytes("q3");
  final byte[] ZERO=Bytes.toBytes(0L);
  final User user1=User.createUserForTesting(conf,"user1",new String[0]);
  final User user2=User.createUserForTesting(conf,"user2",new String[0]);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Map<String,Permission> permsU1andOwner=prepareCellPermissions(new String[]{user1.getShortName(),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Map<String,Permission> permsU1andU2andGUandOwner=prepareCellPermissions(new String[]{user1.getShortName(),user2.getShortName(),AuthUtil.toGroupEntry(GROUP),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Map<String,Permission> permsU1_U2andGU=prepareCellPermissions(new String[]{user1.getShortName(),user2.getShortName(),AuthUtil.toGroupEntry(GROUP)},Action.READ,Action.WRITE);
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)120,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)120,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q3,(long)120,ZERO);
          p.setACL(permsU1andU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)123,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)123,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q3,(long)123,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)127,ZERO);
          p.setACL(permsU1_U2andGU);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)127,ZERO);
          p.setACL(user2.getShortName(),new Permission(Permission.Action.READ));
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q3,127,ZERO);
          p.setACL(AuthUtil.toGroupEntry(GROUP),new Permission(Permission.Action.READ));
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW1);
          d.addColumns(TEST_FAMILY1,TEST_Q1,120);
          t.checkAndDelete(TEST_ROW1,TEST_FAMILY1,TEST_Q1,ZERO,d);
        }
       }
       return null;
    }
  }
);
  verifyUserDeniedForCheckAndDelete(user2,TEST_ROW1,ZERO);
  verifyUserDeniedForCheckAndDelete(GROUP_USER,TEST_ROW1,ZERO);
  verifyUserAllowedforCheckAndDelete(user2,TEST_ROW1,TEST_Q2,ZERO);
  verifyUserAllowedforCheckAndDelete(GROUP_USER,TEST_ROW1,TEST_Q3,ZERO);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsWithDeleteMutipleVersions() throws Exception {
  final byte[] TEST_ROW1=Bytes.toBytes("r1");
  final byte[] TEST_ROW2=Bytes.toBytes("r2");
  final byte[] TEST_Q1=Bytes.toBytes("q1");
  final byte[] TEST_Q2=Bytes.toBytes("q2");
  final byte[] ZERO=Bytes.toBytes(0L);
  final User user1=User.createUserForTesting(conf,"user1",new String[0]);
  final User user2=User.createUserForTesting(conf,"user2",new String[0]);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,ZERO);
          p.setACL(user1.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          t.put(p);
          p=new Put(TEST_ROW2);
          p.addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,ZERO);
          p.setACL(user1.getShortName(),new Permission(Permission.Action.READ,Permission.Action.WRITE));
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,ZERO);
          Map<String,Permission> perms=prepareCellPermissions(new String[]{user1.getShortName(),user2.getShortName(),AuthUtil.toGroupEntry(GROUP)},Action.READ,Action.WRITE);
          p.setACL(perms);
          t.put(p);
          p=new Put(TEST_ROW2);
          p.addColumn(TEST_FAMILY1,TEST_Q1,ZERO);
          p.addColumn(TEST_FAMILY1,TEST_Q2,ZERO);
          p.setACL(perms);
          t.put(p);
        }
       }
       return null;
    }
  }
,user1);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW1);
          d.addColumns(TEST_FAMILY1,TEST_Q1);
          d.addColumns(TEST_FAMILY1,TEST_Q2);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
  verifyUserDeniedForDeleteMultipleVersions(user2,TEST_ROW2,TEST_Q1,TEST_Q2);
  verifyUserDeniedForDeleteMultipleVersions(GROUP_USER,TEST_ROW2,TEST_Q1,TEST_Q2);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW2);
          d.addFamily(TEST_FAMILY1);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteWithFutureTimestamp() throws Exception {
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Put p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q2,ONE);
          Map<String,Permission> readAndWritePerms=prepareCellPermissions(usersAndGroups,Action.READ,Action.WRITE);
          p.setACL(readAndWritePerms);
          t.put(p);
          p=new Put(TEST_ROW).addColumn(TEST_FAMILY2,TEST_Q2,ONE);
          p.setACL(readAndWritePerms);
          t.put(p);
          LOG.info("Stored at current time");
          p=new Put(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1,EnvironmentEdgeManager.currentTime() + 1000000,ZERO);
          p.setACL(prepareCellPermissions(new String[]{USER_OTHER.getShortName(),AuthUtil.toGroupEntry(GROUP)},Action.READ));
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  AccessTestAction getQ1=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Get get=new Get(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q1);
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          return t.get(get).listCells();
        }
       }
     }
  }
;
  AccessTestAction getQ2=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Get get=new Get(TEST_ROW).addColumn(TEST_FAMILY1,TEST_Q2);
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          return t.get(get).listCells();
        }
       }
     }
  }
;
  verifyAllowed(getQ1,USER_OWNER,USER_OTHER,GROUP_USER);
  verifyAllowed(getQ2,USER_OWNER,USER_OTHER,GROUP_USER);
  AccessTestAction deleteFamily1=getDeleteFamilyAction(TEST_FAMILY1);
  AccessTestAction deleteFamily2=getDeleteFamilyAction(TEST_FAMILY2);
  verifyAllowed(deleteFamily1,USER_OTHER);
  verifyAllowed(deleteFamily2,GROUP_USER);
  verifyAllowed(getQ1,USER_OWNER,USER_OTHER,GROUP_USER);
  verifyIfNull(getQ2,USER_OTHER,GROUP_USER);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCellPermissionsWithDeleteExactVersion() throws Exception {
  final byte[] TEST_ROW1=Bytes.toBytes("r1");
  final byte[] TEST_Q1=Bytes.toBytes("q1");
  final byte[] TEST_Q2=Bytes.toBytes("q2");
  final byte[] ZERO=Bytes.toBytes(0L);
  final User user1=User.createUserForTesting(conf,"user1",new String[0]);
  final User user2=User.createUserForTesting(conf,"user2",new String[0]);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Map<String,Permission> permsU1andOwner=prepareCellPermissions(new String[]{user1.getShortName(),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Map<String,Permission> permsU2andGUandOwner=prepareCellPermissions(new String[]{user2.getShortName(),AuthUtil.toGroupEntry(GROUP),USER_OWNER.getShortName()},Action.READ,Action.WRITE);
          Put p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)123,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)123,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY2,TEST_Q1,(long)123,ZERO);
          p.addColumn(TEST_FAMILY2,TEST_Q2,(long)123,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY2,TEST_Q1,(long)125,ZERO);
          p.addColumn(TEST_FAMILY2,TEST_Q2,(long)125,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q1,(long)127,ZERO);
          p.setACL(permsU2andGUandOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY1,TEST_Q2,(long)127,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
          p=new Put(TEST_ROW1);
          p.addColumn(TEST_FAMILY2,TEST_Q1,(long)129,ZERO);
          p.addColumn(TEST_FAMILY2,TEST_Q2,(long)129,ZERO);
          p.setACL(permsU1andOwner);
          t.put(p);
        }
       }
       return null;
    }
  }
,USER_OWNER);
  user1.runAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf)){
        try (Table t=connection.getTable(TEST_TABLE.getTableName())){
          Delete d=new Delete(TEST_ROW1);
          d.addColumn(TEST_FAMILY1,TEST_Q1,123);
          d.addColumn(TEST_FAMILY1,TEST_Q2);
          d.addFamilyVersion(TEST_FAMILY2,125);
          t.delete(d);
        }
       }
       return null;
    }
  }
);
  verifyUserDeniedForDeleteExactVersion(user2,TEST_ROW1,TEST_Q1,TEST_Q2);
  verifyUserDeniedForDeleteExactVersion(GROUP_USER,TEST_ROW1,TEST_Q1,TEST_Q2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestCellACLs </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Insure we are not granting access in the absence of any cells found
 * when scanning for covered cells.
 */
@Test(timeout=120000) public void testCoveringCheck() throws Exception {
  grantOnTable(TEST_UTIL,USER_OTHER.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Action.READ);
  grantOnTable(TEST_UTIL,AuthUtil.toGroupEntry(GROUP),TEST_TABLE.getTableName(),TEST_FAMILY,null,Action.READ);
  verifyUserDeniedForWrite(USER_OTHER,ZERO);
  verifyUserDeniedForWrite(GROUP_USER,ZERO);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection connection=ConnectionFactory.createConnection(conf);Table t=connection.getTable(TEST_TABLE.getTableName())){
        Put p;
        p=new Put(TEST_ROW).addColumn(TEST_FAMILY,TEST_Q1,ZERO);
        t.put(p);
      }
       return null;
    }
  }
,USER_OWNER);
  verifyUserDeniedForWrite(USER_OTHER,ONE);
  verifyUserDeniedForWrite(GROUP_USER,ONE);
  verifyUserAllowedForRead(USER_OTHER);
  verifyUserAllowedForRead(GROUP_USER);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestNamespaceCommands </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableWithNamespace() throws Exception {
  AccessTestAction createTable=new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(TEST_TABLE));
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      ACCESS_CONTROLLER.preCreateTable(ObserverContext.createAndPrepare(CP_ENV,null),htd,null);
      return null;
    }
  }
;
  verifyAllowed(createTable,SUPERUSER,USER_GLOBAL_CREATE,USER_NS_CREATE,USER_GROUP_CREATE);
  verifyDenied(createTable,USER_GLOBAL_ADMIN,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_ADMIN,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_ADMIN);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGrantRevoke() throws Exception {
  final String testUser="testUser";
  AccessTestAction grantAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Connection connection=ConnectionFactory.createConnection(conf);
      Table acl=connection.getTable(AccessControlLists.ACL_TABLE_NAME);
      try {
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.grant(protocol,testUser,TEST_NAMESPACE,Action.WRITE);
      }
  finally {
        acl.close();
        connection.close();
      }
      return null;
    }
  }
;
  AccessTestAction grantNamespaceAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(conf);Table acl=conn.getTable(AccessControlLists.ACL_TABLE_NAME)){
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.grant(protocol,USER_GROUP_NS_ADMIN.getShortName(),TEST_NAMESPACE,Action.READ);
      }
       return null;
    }
  }
;
  AccessTestAction revokeAction=new AccessTestAction(){
    public Object run() throws Exception {
      Connection connection=ConnectionFactory.createConnection(conf);
      Table acl=connection.getTable(AccessControlLists.ACL_TABLE_NAME);
      try {
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.revoke(protocol,testUser,TEST_NAMESPACE,Action.WRITE);
      }
  finally {
        acl.close();
        connection.close();
      }
      return null;
    }
  }
;
  AccessTestAction revokeNamespaceAction=new AccessTestAction(){
    public Object run() throws Exception {
      Connection connection=ConnectionFactory.createConnection(conf);
      Table acl=connection.getTable(AccessControlLists.ACL_TABLE_NAME);
      try {
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.revoke(protocol,USER_GROUP_NS_ADMIN.getShortName(),TEST_NAMESPACE,Action.READ);
      }
  finally {
        acl.close();
        connection.close();
      }
      return null;
    }
  }
;
  AccessTestAction getPermissionsAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      Connection connection=ConnectionFactory.createConnection(conf);
      Table acl=connection.getTable(AccessControlLists.ACL_TABLE_NAME);
      try {
        BlockingRpcChannel service=acl.coprocessorService(HConstants.EMPTY_START_ROW);
        AccessControlService.BlockingInterface protocol=AccessControlService.newBlockingStub(service);
        ProtobufUtil.getUserPermissions(protocol,Bytes.toBytes(TEST_NAMESPACE));
      }
  finally {
        acl.close();
        connection.close();
      }
      return null;
    }
  }
;
  verifyAllowed(grantAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN,USER_NS_ADMIN);
  verifyDenied(grantAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(grantNamespaceAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN,USER_NS_ADMIN,USER_GROUP_NS_ADMIN);
  verifyDenied(grantNamespaceAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(revokeAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN,USER_NS_ADMIN);
  verifyDenied(revokeAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(revokeNamespaceAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN,USER_NS_ADMIN,USER_GROUP_NS_ADMIN);
  verifyDenied(revokeNamespaceAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(getPermissionsAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_NS_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(getPermissionsAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateAndDeleteNamespace() throws Exception {
  AccessTestAction createNamespace=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCreateNamespace(ObserverContext.createAndPrepare(CP_ENV,null),NamespaceDescriptor.create(TEST_NAMESPACE2).build());
      return null;
    }
  }
;
  AccessTestAction deleteNamespace=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteNamespace(ObserverContext.createAndPrepare(CP_ENV,null),TEST_NAMESPACE2);
      return null;
    }
  }
;
  verifyAllowed(createNamespace,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(createNamespace,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_ADMIN,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
  verifyAllowed(deleteNamespace,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(deleteNamespace,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_ADMIN,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetNamespaceDescriptor() throws Exception {
  AccessTestAction getNamespaceAction=new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preGetNamespaceDescriptor(ObserverContext.createAndPrepare(CP_ENV,null),TEST_NAMESPACE);
      return null;
    }
  }
;
  verifyAllowed(getNamespaceAction,SUPERUSER,USER_GLOBAL_ADMIN,USER_NS_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(getNamespaceAction,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_TABLE_CREATE,USER_TABLE_WRITE,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testModifyNamespace() throws Exception {
  AccessTestAction modifyNamespace=new AccessTestAction(){
    public Object run() throws Exception {
      ACCESS_CONTROLLER.preModifyNamespace(ObserverContext.createAndPrepare(CP_ENV,null),NamespaceDescriptor.create(TEST_NAMESPACE).addConfiguration("abc","156").build());
      return null;
    }
  }
;
  verifyAllowed(modifyNamespace,SUPERUSER,USER_GLOBAL_ADMIN,USER_GROUP_ADMIN);
  verifyDenied(modifyNamespace,USER_GLOBAL_CREATE,USER_GLOBAL_WRITE,USER_GLOBAL_READ,USER_GLOBAL_EXEC,USER_NS_ADMIN,USER_NS_CREATE,USER_NS_WRITE,USER_NS_READ,USER_NS_EXEC,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_CREATE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestTablePermissions </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPersistence() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("albert"),TEST_TABLE,null,(byte[])null,TablePermission.Action.READ));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("betty"),TEST_TABLE,null,(byte[])null,TablePermission.Action.READ,TablePermission.Action.WRITE));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("clark"),TEST_TABLE,TEST_FAMILY,TablePermission.Action.READ));
  AccessControlLists.addUserPermission(conf,new UserPermission(Bytes.toBytes("dwight"),TEST_TABLE,TEST_FAMILY,TEST_QUALIFIER,TablePermission.Action.WRITE));
  ListMultimap<String,TablePermission> preperms=AccessControlLists.getTablePermissions(conf,TEST_TABLE);
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  table.put(new Put(Bytes.toBytes("row1")).addColumn(TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("v1")));
  table.put(new Put(Bytes.toBytes("row2")).addColumn(TEST_FAMILY,TEST_QUALIFIER,Bytes.toBytes("v2")));
  Admin admin=UTIL.getHBaseAdmin();
  admin.split(TEST_TABLE);
  Thread.sleep(10000);
  ListMultimap<String,TablePermission> postperms=AccessControlLists.getTablePermissions(conf,TEST_TABLE);
  checkMultimapEqual(preperms,postperms);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test we can read permissions serialized with Writables.
 * @throws DeserializationException
 */
@Test public void testMigration() throws DeserializationException {
  Configuration conf=UTIL.getConfiguration();
  ListMultimap<String,TablePermission> permissions=createPermissions();
  byte[] bytes=writePermissionsAsBytes(permissions,conf);
  AccessControlLists.readPermissions(bytes,conf);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSerialization() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  ListMultimap<String,TablePermission> permissions=createPermissions();
  byte[] permsData=AccessControlLists.writePermissionsAsBytes(permissions,conf);
  ListMultimap<String,TablePermission> copy=AccessControlLists.readPermissions(permsData,conf);
  checkMultimapEqual(permissions,copy);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test grants and revocations with authorization disabled 
 */
@Test public void testPassiveGrantRevoke() throws Exception {
  User tblUser=User.createUserForTesting(TEST_UTIL.getConfiguration(),"tbluser",new String[0]);
  AccessTestAction checkTableRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
      return null;
    }
  }
;
  verifyDenied(tblUser,checkTableRead);
  AccessTestAction tableRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());Table t=conn.getTable(TEST_TABLE.getTableName())){
        t.get(new Get(TEST_ROW).addFamily(TEST_FAMILY));
      }
       return null;
    }
  }
;
  verifyAllowed(tblUser,tableRead);
  grantOnTable(TEST_UTIL,tblUser.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
  verifyAllowed(tblUser,checkTableRead);
  verifyAllowed(tblUser,tableRead);
  revokeFromTable(TEST_UTIL,tblUser.getShortName(),TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
  verifyDenied(tblUser,checkTableRead);
  verifyAllowed(tblUser,tableRead);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test region observer 
 */
@Test public void testPassiveRegionOperations() throws Exception {
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preOpen(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preFlush(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preSplit(ObserverContext.createAndPrepare(RCP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<Cell> cells=Lists.newArrayList();
      ACCESS_CONTROLLER.preGetOp(ObserverContext.createAndPrepare(RCP_ENV,null),new Get(TEST_ROW),cells);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preExists(ObserverContext.createAndPrepare(RCP_ENV,null),new Get(TEST_ROW),true);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.prePut(ObserverContext.createAndPrepare(RCP_ENV,null),new Put(TEST_ROW),new WALEdit(),Durability.USE_DEFAULT);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDelete(ObserverContext.createAndPrepare(RCP_ENV,null),new Delete(TEST_ROW),new WALEdit(),Durability.USE_DEFAULT);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preBatchMutate(ObserverContext.createAndPrepare(RCP_ENV,null),new MiniBatchOperationInProgress<Mutation>(null,null,null,0,0));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCheckAndPut(ObserverContext.createAndPrepare(RCP_ENV,null),TEST_ROW,TEST_FAMILY,TEST_Q1,CompareFilter.CompareOp.EQUAL,new BinaryComparator("foo".getBytes()),new Put(TEST_ROW),true);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preCheckAndDelete(ObserverContext.createAndPrepare(RCP_ENV,null),TEST_ROW,TEST_FAMILY,TEST_Q1,CompareFilter.CompareOp.EQUAL,new BinaryComparator("foo".getBytes()),new Delete(TEST_ROW),true);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preAppend(ObserverContext.createAndPrepare(RCP_ENV,null),new Append(TEST_ROW));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preIncrement(ObserverContext.createAndPrepare(RCP_ENV,null),new Increment(TEST_ROW));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preScannerOpen(ObserverContext.createAndPrepare(RCP_ENV,null),new Scan(),mock(RegionScanner.class));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<Pair<byte[],String>> paths=Lists.newArrayList();
      ACCESS_CONTROLLER.preBulkLoadHFile(ObserverContext.createAndPrepare(RCP_ENV,null),paths);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test region server observer 
 */
@Test public void testPassiveRegionServerOperations() throws Exception {
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preStopRegionServer(ObserverContext.createAndPrepare(RSCP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      Region region_a=mock(Region.class);
      when(region_a.getTableDesc()).thenReturn(htd);
      Region region_b=mock(Region.class);
      when(region_b.getTableDesc()).thenReturn(htd);
      ACCESS_CONTROLLER.preMerge(ObserverContext.createAndPrepare(RSCP_ENV,null),region_a,region_b);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preRollWALWriterRequest(ObserverContext.createAndPrepare(RSCP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test master observer 
 */
@Test public void testPassiveMasterOperations() throws Exception {
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      ACCESS_CONTROLLER.preCreateTable(ObserverContext.createAndPrepare(CP_ENV,null),htd,null);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
      htd.addFamily(new HColumnDescriptor(TEST_FAMILY2));
      ACCESS_CONTROLLER.preModifyTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName(),htd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName());
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preTruncateTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName());
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY2);
      ACCESS_CONTROLLER.preAddColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName(),hcd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY2);
      ACCESS_CONTROLLER.preModifyColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName(),hcd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteColumnFamily(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName(),TEST_FAMILY2);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preEnableTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName());
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDisableTable(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName());
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HRegionInfo region=new HRegionInfo(TEST_TABLE.getTableName());
      ServerName srcServer=ServerName.valueOf("1.1.1.1",1,0);
      ServerName destServer=ServerName.valueOf("2.2.2.2",2,0);
      ACCESS_CONTROLLER.preMove(ObserverContext.createAndPrepare(CP_ENV,null),region,srcServer,destServer);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HRegionInfo region=new HRegionInfo(TEST_TABLE.getTableName());
      ACCESS_CONTROLLER.preAssign(ObserverContext.createAndPrepare(CP_ENV,null),region);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      HRegionInfo region=new HRegionInfo(TEST_TABLE.getTableName());
      ACCESS_CONTROLLER.preUnassign(ObserverContext.createAndPrepare(CP_ENV,null),region,true);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preBalance(ObserverContext.createAndPrepare(CP_ENV,null));
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preBalanceSwitch(ObserverContext.createAndPrepare(CP_ENV,null),true);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("foo").build();
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      ACCESS_CONTROLLER.preSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("foo").build();
      ACCESS_CONTROLLER.preListSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("foo").build();
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      ACCESS_CONTROLLER.preCloneSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("foo").build();
      HTableDescriptor htd=new HTableDescriptor(TEST_TABLE.getTableName());
      ACCESS_CONTROLLER.preRestoreSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot,htd);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("foo").build();
      ACCESS_CONTROLLER.preDeleteSnapshot(ObserverContext.createAndPrepare(CP_ENV,null),snapshot);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<TableName> tableNamesList=Lists.newArrayList();
      tableNamesList.add(TEST_TABLE.getTableName());
      List<HTableDescriptor> descriptors=Lists.newArrayList();
      ACCESS_CONTROLLER.preGetTableDescriptors(ObserverContext.createAndPrepare(CP_ENV,null),tableNamesList,descriptors,".+");
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<HTableDescriptor> descriptors=Lists.newArrayList();
      ACCESS_CONTROLLER.preGetTableNames(ObserverContext.createAndPrepare(CP_ENV,null),descriptors,".+");
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      NamespaceDescriptor ns=NamespaceDescriptor.create("test").build();
      ACCESS_CONTROLLER.preCreateNamespace(ObserverContext.createAndPrepare(CP_ENV,null),ns);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preDeleteNamespace(ObserverContext.createAndPrepare(CP_ENV,null),"test");
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      NamespaceDescriptor ns=NamespaceDescriptor.create("test").build();
      ACCESS_CONTROLLER.preModifyNamespace(ObserverContext.createAndPrepare(CP_ENV,null),ns);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      ACCESS_CONTROLLER.preGetNamespaceDescriptor(ObserverContext.createAndPrepare(CP_ENV,null),"test");
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      List<NamespaceDescriptor> descriptors=Lists.newArrayList();
      ACCESS_CONTROLLER.preListNamespaceDescriptors(ObserverContext.createAndPrepare(CP_ENV,null),descriptors);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      Quotas quotas=Quotas.newBuilder().build();
      ACCESS_CONTROLLER.preSetUserQuota(ObserverContext.createAndPrepare(CP_ENV,null),"testuser",quotas);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      Quotas quotas=Quotas.newBuilder().build();
      ACCESS_CONTROLLER.preSetTableQuota(ObserverContext.createAndPrepare(CP_ENV,null),TEST_TABLE.getTableName(),quotas);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
  verifyAllowed(new AccessTestAction(){
    @Override public Object run() throws Exception {
      Quotas quotas=Quotas.newBuilder().build();
      ACCESS_CONTROLLER.preSetNamespaceQuota(ObserverContext.createAndPrepare(CP_ENV,null),"test",quotas);
      return null;
    }
  }
,SUPERUSER,USER_ADMIN,USER_RW,USER_RO,USER_OWNER,USER_CREATE,USER_QUAL,USER_NONE);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckPermissions() throws Exception {
  AccessTestAction checkGlobalAdmin=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkGlobalPerms(TEST_UTIL,Permission.Action.ADMIN);
      return null;
    }
  }
;
  verifyAllowed(checkGlobalAdmin,SUPERUSER,USER_ADMIN);
  verifyDenied(checkGlobalAdmin,USER_OWNER,USER_CREATE,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkGlobalRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkGlobalPerms(TEST_UTIL,Permission.Action.READ);
      return null;
    }
  }
;
  verifyAllowed(checkGlobalRead,SUPERUSER,USER_ADMIN);
  verifyDenied(checkGlobalRead,USER_OWNER,USER_CREATE,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkGlobalReadWrite=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkGlobalPerms(TEST_UTIL,Permission.Action.READ,Permission.Action.WRITE);
      return null;
    }
  }
;
  verifyAllowed(checkGlobalReadWrite,SUPERUSER,USER_ADMIN);
  verifyDenied(checkGlobalReadWrite,USER_OWNER,USER_CREATE,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkTableAdmin=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),null,null,Permission.Action.ADMIN);
      return null;
    }
  }
;
  verifyAllowed(checkTableAdmin,SUPERUSER,USER_ADMIN,USER_OWNER);
  verifyDenied(checkTableAdmin,USER_CREATE,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkTableCreate=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),null,null,Permission.Action.CREATE);
      return null;
    }
  }
;
  verifyAllowed(checkTableCreate,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE);
  verifyDenied(checkTableCreate,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkTableRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),null,null,Permission.Action.READ);
      return null;
    }
  }
;
  verifyAllowed(checkTableRead,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE);
  verifyDenied(checkTableRead,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkTableReadWrite=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),null,null,Permission.Action.READ,Permission.Action.WRITE);
      return null;
    }
  }
;
  verifyAllowed(checkTableReadWrite,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE);
  verifyDenied(checkTableReadWrite,USER_RW,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkColumnRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ);
      return null;
    }
  }
;
  verifyAllowed(checkColumnRead,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW,USER_RO);
  verifyDenied(checkColumnRead,USER_QUAL,USER_NONE);
  AccessTestAction checkColumnReadWrite=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),TEST_FAMILY,null,Permission.Action.READ,Permission.Action.WRITE);
      return null;
    }
  }
;
  verifyAllowed(checkColumnReadWrite,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW);
  verifyDenied(checkColumnReadWrite,USER_RO,USER_QUAL,USER_NONE);
  AccessTestAction checkQualifierRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q1,Permission.Action.READ);
      return null;
    }
  }
;
  verifyAllowed(checkQualifierRead,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW,USER_RO,USER_QUAL);
  verifyDenied(checkQualifierRead,USER_NONE);
  AccessTestAction checkQualifierReadWrite=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q1,Permission.Action.READ,Permission.Action.WRITE);
      return null;
    }
  }
;
  verifyAllowed(checkQualifierReadWrite,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW,USER_QUAL);
  verifyDenied(checkQualifierReadWrite,USER_RO,USER_NONE);
  AccessTestAction checkMultiQualifierRead=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),new Permission[]{new TablePermission(TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q1,Permission.Action.READ),new TablePermission(TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q2,Permission.Action.READ)});
      return null;
    }
  }
;
  verifyAllowed(checkMultiQualifierRead,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW,USER_RO);
  verifyDenied(checkMultiQualifierRead,USER_QUAL,USER_NONE);
  AccessTestAction checkMultiQualifierReadWrite=new AccessTestAction(){
    @Override public Void run() throws Exception {
      checkTablePerms(TEST_UTIL,TEST_TABLE.getTableName(),new Permission[]{new TablePermission(TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q1,Permission.Action.READ,Permission.Action.WRITE),new TablePermission(TEST_TABLE.getTableName(),TEST_FAMILY,TEST_Q2,Permission.Action.READ,Permission.Action.WRITE)});
      return null;
    }
  }
;
  verifyAllowed(checkMultiQualifierReadWrite,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_RW);
  verifyDenied(checkMultiQualifierReadWrite,USER_RO,USER_QUAL,USER_NONE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.token.TestGenerateDelegationToken </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test() throws Exception {
  try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration())){
    Token<? extends TokenIdentifier> token=TokenUtil.obtainToken(conn);
    UserGroupInformation.getCurrentUser().addToken(token);
    testTokenAuth(RpcClientImpl.class);
    testTokenAuth(AsyncRpcClient.class);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestExpressionParser </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNegativeCases() throws Exception {
  executeNegativeCase("(");
  executeNegativeCase(")");
  executeNegativeCase("()");
  executeNegativeCase("(a");
  executeNegativeCase("a&");
  executeNegativeCase("a&|b");
  executeNegativeCase("!");
  executeNegativeCase("a!");
  executeNegativeCase("a!&");
  executeNegativeCase("&");
  executeNegativeCase("|");
  executeNegativeCase("!(a|(b&c)&!b");
  executeNegativeCase("!!a");
  executeNegativeCase("( a & b ) | ( c & d e)");
  executeNegativeCase("! a");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithCustomVisLabService </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVisibilityLabelsInPutsThatDoesNotMatchAnyDefinedLabels() throws Exception {
  TableName tableName=TableName.valueOf(TEST_NAME.getMethodName());
  createTableAndWriteDataWithLabels(tableName,"SAMPLE_LABEL","TEST");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestExportSnapshot </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyExportFileSystemState() throws Exception {
  testExportFileSystemState(tableName,emptySnapshotName,emptySnapshotName,0);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExportWithTargetName() throws Exception {
  final byte[] targetName=Bytes.toBytes("testExportWithTargetName");
  testExportFileSystemState(tableName,snapshotName,targetName,tableNumFiles);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExportFileSystemStateWithSkipTmp() throws Exception {
  TEST_UTIL.getConfiguration().setBoolean(ExportSnapshot.CONF_SKIP_TMP,true);
  testExportFileSystemState(tableName,snapshotName,snapshotName,tableNumFiles);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConsecutiveExports() throws Exception {
  Path copyDir=getLocalDestinationDir();
  testExportFileSystemState(tableName,snapshotName,snapshotName,tableNumFiles,copyDir,false);
  testExportFileSystemState(tableName,snapshotName,snapshotName,tableNumFiles,copyDir,true);
  removeExportDir(copyDir);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify if exported snapshot and copied files matches the original one.
 */
@Test public void testExportFileSystemState() throws Exception {
  testExportFileSystemState(tableName,snapshotName,snapshotName,tableNumFiles);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Mock a snapshot with files in the archive dir,
 * two regions, and one reference file.
 */
@Test public void testSnapshotWithRefsExportFileSystemState() throws Exception {
  Configuration conf=TEST_UTIL.getConfiguration();
  Path rootDir=TEST_UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getRootDir();
  FileSystem fs=TEST_UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getFileSystem();
  SnapshotMock snapshotMock=new SnapshotMock(TEST_UTIL.getConfiguration(),fs,rootDir);
  SnapshotMock.SnapshotBuilder builder=snapshotMock.createSnapshotV2("tableWithRefsV1","tableWithRefsV1");
  testSnapshotWithRefsExportFileSystemState(builder);
  snapshotMock=new SnapshotMock(TEST_UTIL.getConfiguration(),fs,rootDir);
  builder=snapshotMock.createSnapshotV2("tableWithRefsV2","tableWithRefsV2");
  testSnapshotWithRefsExportFileSystemState(builder);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestFlushSnapshotFromClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=300000) public void testAsyncFlushSnapshot() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotDescription snapshot=SnapshotDescription.newBuilder().setName("asyncSnapshot").setTable(TABLE_NAME.getNameAsString()).setType(SnapshotDescription.Type.FLUSH).build();
  admin.takeSnapshotAsync(snapshot);
  HMaster master=UTIL.getMiniHBaseCluster().getMaster();
  SnapshotTestingUtils.waitForSnapshotToComplete(master,snapshot,200);
  LOG.info(" === Async Snapshot Completed ===");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test simple flush snapshotting a table that is online
 * @throws Exception
 */
@Test(timeout=300000) public void testFlushTableSnapshotWithProcedure() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  SnapshotTestingUtils.loadData(UTIL,TABLE_NAME,DEFAULT_NUM_ROWS,TEST_FAM);
  LOG.debug("FS state before snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  String snapshotString="offlineTableSnapshot";
  byte[] snapshot=Bytes.toBytes(snapshotString);
  Map<String,String> props=new HashMap<String,String>();
  props.put("table",TABLE_NAME.getNameAsString());
  admin.execProcedure(SnapshotManager.ONLINE_SNAPSHOT_CONTROLLER_DESCRIPTION,snapshotString,props);
  LOG.debug("Snapshot completed.");
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot,TABLE_NAME);
  LOG.debug("FS state after snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  SnapshotTestingUtils.confirmSnapshotValid(UTIL,snapshots.get(0),TABLE_NAME,TEST_FAM);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Basic end-to-end test of simple-flush-based snapshots
 */
@Test(timeout=300000) public void testFlushCreateListDestroy() throws Exception {
  LOG.debug("------- Starting Snapshot test -------------");
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  SnapshotTestingUtils.loadData(UTIL,TABLE_NAME,DEFAULT_NUM_ROWS,TEST_FAM);
  String snapshotName="flushSnapshotCreateListDestroy";
  FileSystem fs=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getFileSystem();
  Path rootDir=UTIL.getHBaseCluster().getMaster().getMasterFileSystem().getRootDir();
  SnapshotTestingUtils.createSnapshotAndValidate(admin,TABLE_NAME,Bytes.toString(TEST_FAM),snapshotName,rootDir,fs,true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test simple flush snapshotting a table that is online
 * @throws Exception
 */
@Test(timeout=300000) public void testFlushTableSnapshot() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  SnapshotTestingUtils.loadData(UTIL,TABLE_NAME,DEFAULT_NUM_ROWS,TEST_FAM);
  LOG.debug("FS state before snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  String snapshotString="offlineTableSnapshot";
  byte[] snapshot=Bytes.toBytes(snapshotString);
  admin.snapshot(snapshotString,TABLE_NAME,SnapshotDescription.Type.FLUSH);
  LOG.debug("Snapshot completed.");
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot,TABLE_NAME);
  LOG.debug("FS state after snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  SnapshotTestingUtils.confirmSnapshotValid(UTIL,snapshots.get(0),TABLE_NAME,TEST_FAM);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test snapshotting a table that is online without flushing
 * @throws Exception
 */
@Test(timeout=30000) public void testSkipFlushTableSnapshot() throws Exception {
  Admin admin=UTIL.getHBaseAdmin();
  SnapshotTestingUtils.assertNoSnapshots(admin);
  Table table=UTIL.getConnection().getTable(TABLE_NAME);
  UTIL.loadTable(table,TEST_FAM);
  UTIL.flush(TABLE_NAME);
  LOG.debug("FS state before snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  String snapshotString="skipFlushTableSnapshot";
  byte[] snapshot=Bytes.toBytes(snapshotString);
  admin.snapshot(snapshotString,TABLE_NAME,SnapshotDescription.Type.SKIPFLUSH);
  LOG.debug("Snapshot completed.");
  List<SnapshotDescription> snapshots=SnapshotTestingUtils.assertOneSnapshotThatMatches(admin,snapshot,TABLE_NAME);
  LOG.debug("FS state after snapshot:");
  UTIL.getHBaseCluster().getMaster().getMasterFileSystem().logFileSystemState(LOG);
  SnapshotTestingUtils.confirmSnapshotValid(UTIL,snapshots.get(0),TABLE_NAME,TEST_FAM);
  admin.deleteSnapshot(snapshot);
  snapshots=admin.listSnapshots();
  SnapshotTestingUtils.assertNoSnapshots(admin);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestRestoreFlushSnapshotFromClient </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestoreSnapshotOfCloned() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("clonedtb-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName0,clonedTableName);
  verifyRowCount(UTIL,clonedTableName,snapshot0Rows);
  admin.snapshot(Bytes.toString(snapshotName2),clonedTableName,SnapshotDescription.Type.FLUSH);
  UTIL.deleteTable(clonedTableName);
  admin.cloneSnapshot(snapshotName2,clonedTableName);
  verifyRowCount(UTIL,clonedTableName,snapshot0Rows);
  UTIL.deleteTable(clonedTableName);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=SnapshotDoesNotExistException.class) public void testCloneNonExistentSnapshot() throws IOException, InterruptedException {
  String snapshotName="random-snapshot-" + System.currentTimeMillis();
  TableName tableName=TableName.valueOf("random-table-" + System.currentTimeMillis());
  admin.cloneSnapshot(snapshotName,tableName);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestoreSnapshot() throws IOException {
  verifyRowCount(UTIL,tableName,snapshot1Rows);
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName0);
  logFSTree();
  admin.enableTable(tableName);
  LOG.info("=== after restore with 500 row snapshot");
  logFSTree();
  verifyRowCount(UTIL,tableName,snapshot0Rows);
  admin.disableTable(tableName);
  admin.restoreSnapshot(snapshotName1);
  admin.enableTable(tableName);
  verifyRowCount(UTIL,tableName,snapshot1Rows);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCloneSnapshot() throws IOException, InterruptedException {
  TableName clonedTableName=TableName.valueOf("clonedtb-" + System.currentTimeMillis());
  testCloneSnapshot(clonedTableName,snapshotName0,snapshot0Rows);
  testCloneSnapshot(clonedTableName,snapshotName1,snapshot1Rows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestRestoreSnapshotHelper </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestore() throws IOException {
  restoreAndVerify("snapshot","testRestore");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRestoreWithNamespace() throws IOException {
  restoreAndVerify("snapshot","namespace1:testRestoreWithNamespace");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.snapshot.TestSnapshotClientRetries </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000,expected=SnapshotDoesNotExistException.class) public void testCloneNonExistentSnapshot() throws Exception {
  final String snapshotName="testCloneNonExistentSnapshot";
  cloneAndAssertOneRetry(snapshotName,TEST_TABLE.getTableName());
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000,expected=SnapshotExistsException.class) public void testSnapshotAlreadyExist() throws Exception {
  final String snapshotName="testSnapshotAlreadyExist";
  TEST_UTIL.createTable(TEST_TABLE.getTableName(),"f");
  TEST_UTIL.getHBaseAdmin().snapshot(snapshotName,TEST_TABLE.getTableName());
  snapshotAndAssertOneRetry(snapshotName,TEST_TABLE.getTableName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.test.IntegrationTestLoadAndVerify </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadAndVerify() throws Exception {
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(TEST_NAME));
  htd.addFamily(new HColumnDescriptor(TEST_FAMILY));
  Admin admin=getTestingUtil(getConf()).getHBaseAdmin();
  admin.createTable(htd,Bytes.toBytes(0L),Bytes.toBytes(-1L),40);
  doLoad(getConf(),htd);
  doVerify(getConf(),htd);
  getTestingUtil(getConf()).deleteTable(htd.getTableName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestCallQueue </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testPutTake() throws Exception {
  ThriftMetrics metrics=createMetrics();
  CallQueue callQueue=new CallQueue(new LinkedBlockingQueue<Call>(),metrics);
  for (int i=0; i < elementsAdded; ++i) {
    callQueue.put(createDummyRunnable());
  }
  for (int i=0; i < elementsRemoved; ++i) {
    callQueue.take();
  }
  verifyMetrics(metrics,"timeInQueue_num_ops",elementsRemoved);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=60000) public void testOfferPoll() throws Exception {
  ThriftMetrics metrics=createMetrics();
  CallQueue callQueue=new CallQueue(new LinkedBlockingQueue<Call>(),metrics);
  for (int i=0; i < elementsAdded; ++i) {
    callQueue.offer(createDummyRunnable());
  }
  for (int i=0; i < elementsRemoved; ++i) {
    callQueue.poll();
  }
  verifyMetrics(metrics,"timeInQueue_num_ops",elementsRemoved);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestMetricsThriftServerSourceFactory </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetInstanceNoHadoopCompat() throws RuntimeException {
  CompatibilitySingletonFactory.getInstance(MetricsThriftServerSourceFactory.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestThriftHttpServer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=600000) public void testRunThriftServer() throws Exception {
  runThriftServer(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.thrift.TestThriftServer </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Runs all of the tests under a single JUnit test method.  We
 * consolidate all testing to one method because HBaseClusterTestCase
 * is prone to OutOfMemoryExceptions when there are three or more
 * JUnit test methods.
 * @throws Exception
 */
@Test public void testAll() throws Exception {
  doTestTableCreateDrop();
  doTestThriftMetrics();
  doTestTableMutations();
  doTestTableTimestampsAndColumns();
  doTestTableScanners();
  doTestGetTableRegions();
  doTestFilterRegistration();
  doTestGetRegionInfo();
  doTestIncrements();
  doTestAppend();
  doTestCheckAndPut();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.trace.IntegrationTestSendTraceRequests </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void internalDoWork() throws Exception {
  util=createUtil();
  admin=util.getHBaseAdmin();
  setupReceiver();
  deleteTable();
  createTable();
  LinkedBlockingQueue<Long> rks=insertData();
  ExecutorService service=Executors.newFixedThreadPool(20);
  doScans(service,rks);
  doGets(service,rks);
  service.shutdown();
  service.awaitTermination(100,TimeUnit.SECONDS);
  Thread.sleep(90000);
  receiverHost.closeReceivers();
  util.restoreCluster();
  util=null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestFixedLengthWrapper </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInsufficientRemainingRead(){
  PositionedByteRange buff=new SimplePositionedMutableByteRange(0);
  DataType<byte[]> type=new FixedLengthWrapper<byte[]>(new RawBytes(),3);
  type.decode(buff);
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInsufficientRemainingWrite(){
  PositionedByteRange buff=new SimplePositionedMutableByteRange(0);
  DataType<byte[]> type=new FixedLengthWrapper<byte[]>(new RawBytes(),3);
  type.encode(buff,Bytes.toBytes(""));
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testOverflowPassthrough(){
  PositionedByteRange buff=new SimplePositionedMutableByteRange(3);
  DataType<byte[]> type=new FixedLengthWrapper<byte[]>(new RawBytes(),0);
  type.encode(buff,Bytes.toBytes("foo"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestStructNullExtension </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify null extension respects the type's isNullable field.
 */
@Test(expected=NullPointerException.class) public void testNonNullableNullExtension(){
  Struct s=new StructBuilder().add(new RawStringTerminated("|")).toStruct();
  PositionedByteRange buf=new SimplePositionedMutableByteRange(4);
  s.encode(buf,new Object[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.types.TestTerminatedWrapper </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testEncodedValueContainsTerm(){
  DataType<byte[]> type=new TerminatedWrapper<byte[]>(new RawBytes(),"foo");
  PositionedByteRange buff=new SimplePositionedMutableByteRange(16);
  type.encode(buff,Bytes.toBytes("hello foobar!"));
}

</code></pre>

<br>
<pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidSkip(){
  PositionedByteRange buff=new SimplePositionedMutableByteRange(Bytes.toBytes("foo"));
  DataType<byte[]> type=new TerminatedWrapper<byte[]>(new RawBytes(),new byte[]{0x00});
  type.skip(buff);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestByteBufferUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test 7-bit encoding of integers.
 * @throws IOException On test failure.
 */
@Test public void testCompressedInt() throws IOException {
  testCompressedInt(0);
  testCompressedInt(Integer.MAX_VALUE);
  testCompressedInt(Integer.MIN_VALUE);
  for (int i=0; i < 3; i++) {
    testCompressedInt((128 << i) - 1);
  }
  for (int i=0; i < 3; i++) {
    testCompressedInt((128 << i));
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test serializing int to bytes
 */
@Test public void testPutInt(){
  testPutInt(0);
  testPutInt(Integer.MAX_VALUE);
  for (int i=0; i < 3; i++) {
    testPutInt((128 << i) - 1);
  }
  for (int i=0; i < 3; i++) {
    testPutInt((128 << i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestConcatenatedLists </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOneOne(){
  ConcatenatedLists<Long> c=new ConcatenatedLists<Long>();
  c.addSublist(Arrays.asList(0L));
  verify(c,0);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings("unchecked") public void testManyOne(){
  ConcatenatedLists<Long> c=new ConcatenatedLists<Long>();
  c.addSublist(Arrays.asList(0L));
  c.addAllSublists(Arrays.asList(Arrays.asList(1L),Arrays.asList(2L)));
  verify(c,2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings("unchecked") public void testManyMany(){
  ConcatenatedLists<Long> c=new ConcatenatedLists<Long>();
  c.addAllSublists(Arrays.asList(Arrays.asList(0L,1L)));
  c.addSublist(Arrays.asList(2L,3L,4L));
  c.addAllSublists(Arrays.asList(Arrays.asList(5L),Arrays.asList(6L,7L)));
  verify(c,7);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOneMany(){
  ConcatenatedLists<Long> c=new ConcatenatedLists<Long>();
  c.addSublist(Arrays.asList(0L,1L,2L));
  verify(c,2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmpty(){
  verify(new ConcatenatedLists<Long>(),-1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestCoprocessorClassLoader </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLibJarName() throws Exception {
  checkingLibJarName("TestLibJarName.jar","/lib/");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRelativeLibJarName() throws Exception {
  checkingLibJarName("TestRelativeLibJarName.jar","lib/");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestDrainBarrier </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleSloppyStopsHaveNoEffect() throws Exception {
  DrainBarrier barrier=new DrainBarrier();
  barrier.stopAndDrainOps();
  barrier.stopAndDrainOps();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStopWithoutOpsDoesntBlock() throws Exception {
  DrainBarrier barrier=new DrainBarrier();
  barrier.stopAndDrainOpsOnce();
  barrier=new DrainBarrier();
  barrier.beginOp();
  barrier.endOp();
  barrier.stopAndDrainOpsOnce();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFSTableDescriptors </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdates() throws IOException {
  final String name="testUpdates";
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  Path rootdir=new Path(UTIL.getDataTestDir(),name);
  TableDescriptors htds=new FSTableDescriptors(UTIL.getConfiguration(),fs,rootdir);
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(name));
  htds.add(htd);
  htds.add(htd);
  htds.add(htd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFSUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetStoragePolicyDefault() throws Exception {
  verifyFileInDirWithStoragePolicy(HConstants.DEFAULT_WAL_STORAGE_POLICY);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetStoragePolicyValidButMaybeNotPresent() throws Exception {
  verifyFileInDirWithStoragePolicy("ALL_SSD");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetStoragePolicyInvalid() throws Exception {
  verifyFileInDirWithStoragePolicy("1772");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestFastLongHistogram </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUniform(){
  FastLongHistogram hist=new FastLongHistogram(100,0,50);
  doTestUniform(hist);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSameValues(){
  FastLongHistogram hist=new FastLongHistogram(100);
  hist.add(50,100);
  hist.reset();
  doTestUniform(hist);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckOneRS </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This creates and fixes a bad table with a missing region which is the 1st region -- hole in
 * meta and data missing in the fs.
 */
@Test(timeout=120000) public void testRegionDeployedNotInHdfs() throws Exception {
  TableName table=TableName.valueOf("testSingleRegionDeployedNotInHdfs");
  try {
    setupTable(table);
    admin.flush(table);
    deleteRegion(conf,tbl.getTableDescriptor(),HConstants.EMPTY_START_ROW,Bytes.toBytes("A"),false,false,true);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS});
    doFsck(conf,true);
    assertNoErrors(doFsck(conf,false));
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * when the hbase.version file missing, It is fix the fault.
 */
@Test(timeout=180000) public void testNoVersionFile() throws Exception {
  Path rootDir=FSUtils.getRootDir(conf);
  FileSystem fs=rootDir.getFileSystem(conf);
  Path versionFile=new Path(rootDir,HConstants.VERSION_FILE_NAME);
  fs.delete(versionFile,true);
  HBaseFsck hbck=doFsck(conf,false);
  assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NO_VERSION_FILE});
  doFsck(conf,true);
  assertNoErrors(doFsck(conf,false));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testTableWithNoRegions() throws Exception {
  TableName table=TableName.valueOf(name.getMethodName());
  try {
    HTableDescriptor desc=new HTableDescriptor(table);
    HColumnDescriptor hcd=new HColumnDescriptor(Bytes.toString(FAM));
    desc.addFamily(hcd);
    createTable(TEST_UTIL,desc,null);
    tbl=connection.getTable(table,tableExecutorService);
    deleteRegion(conf,tbl.getTableDescriptor(),HConstants.EMPTY_START_ROW,HConstants.EMPTY_END_ROW,false,false,true);
    HBaseFsck hbck=doFsck(conf,false);
    assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS});
    doFsck(conf,true);
    doFsck(conf,true);
    assertNoErrors(doFsck(conf,false));
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test thread pooling in the case where there are more regions than threads
 */
@Test(timeout=180000) public void testHbckThreadpooling() throws Exception {
  TableName table=TableName.valueOf("tableDupeStartKey");
  try {
    setupTable(table);
    Configuration newconf=new Configuration(conf);
    newconf.setInt("hbasefsck.numthreads",1);
    assertNoErrors(doFsck(newconf,false));
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckReplicas </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testHbckWithRegionReplica() throws Exception {
  TableName table=TableName.valueOf("testHbckWithRegionReplica");
  try {
    setupTableWithRegionReplica(table,2);
    admin.flush(table);
    assertNoErrors(doFsck(conf,false));
  }
  finally {
    cleanupTable(table);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestHBaseFsckTwoRS </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testMetaOffline() throws Exception {
  HBaseFsck hbck=doFsck(conf,false);
  assertNoErrors(hbck);
  deleteMetaRegion(conf,true,false,false);
  hbck=doFsck(conf,false);
  assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NO_META_REGION,HBaseFsck.ErrorReporter.ERROR_CODE.UNKNOWN});
  hbck=doFsck(conf,true);
  assertErrors(hbck,new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.NO_META_REGION,HBaseFsck.ErrorReporter.ERROR_CODE.UNKNOWN});
  hbck=doFsck(conf,false);
  assertNoErrors(hbck);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=180000) public void testHBaseFsck() throws Exception {
  assertNoErrors(doFsck(conf,false));
  TableName table=TableName.valueOf("tableBadMetaAssign");
  HTableDescriptor desc=new HTableDescriptor(table);
  HColumnDescriptor hcd=new HColumnDescriptor(Bytes.toString(FAM));
  desc.addFamily(hcd);
  createTable(TEST_UTIL,desc,null);
  assertNoErrors(doFsck(conf,false));
  Table meta=connection.getTable(TableName.META_TABLE_NAME,tableExecutorService);
  Scan scan=new Scan();
  scan.setStartRow(Bytes.toBytes(table + ",,"));
  ResultScanner scanner=meta.getScanner(scan);
  HRegionInfo hri=null;
  Result res=scanner.next();
  ServerName currServer=ServerName.parseFrom(res.getValue(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER));
  long startCode=Bytes.toLong(res.getValue(HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER));
  for (  JVMClusterUtil.RegionServerThread rs : TEST_UTIL.getHBaseCluster().getRegionServerThreads()) {
    ServerName sn=rs.getRegionServer().getServerName();
    if (!currServer.getHostAndPort().equals(sn.getHostAndPort()) || startCode != sn.getStartcode()) {
      Put put=new Put(res.getRow());
      put.setDurability(Durability.SKIP_WAL);
      put.addColumn(HConstants.CATALOG_FAMILY,HConstants.SERVER_QUALIFIER,Bytes.toBytes(sn.getHostAndPort()));
      put.addColumn(HConstants.CATALOG_FAMILY,HConstants.STARTCODE_QUALIFIER,Bytes.toBytes(sn.getStartcode()));
      meta.put(put);
      hri=MetaTableAccessor.getHRegionInfo(res);
      break;
    }
  }
  assertErrors(doFsck(conf,true),new HBaseFsck.ErrorReporter.ERROR_CODE[]{HBaseFsck.ErrorReporter.ERROR_CODE.SERVER_DOES_NOT_MATCH_META});
  TEST_UTIL.getHBaseCluster().getMaster().getAssignmentManager().waitForAssignment(hri);
  assertNoErrors(doFsck(conf,false));
  Table t=connection.getTable(table,tableExecutorService);
  ResultScanner s=t.getScanner(new Scan());
  s.close();
  t.close();
  scanner.close();
  meta.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestMiniClusterLoadSequential </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TIMEOUT_MS) public void loadTest() throws Exception {
  prepareForLoadTest();
  runLoadTestOnExistingTable();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestOrderedBytes </h4><pre class="type-17 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testStringNoNullChars(){
  PositionedByteRange buff=new SimplePositionedMutableByteRange(3);
  OrderedBytes.encodeString(buff,"\u0000",Order.ASCENDING);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestRegionMover </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnloadWithoutAck() throws Exception {
  MiniHBaseCluster cluster=TEST_UTIL.getHBaseCluster();
  final HRegionServer regionServer=cluster.getRegionServer(0);
  final int noRegions=regionServer.getNumberOfOnlineRegions();
  String rsName=regionServer.getServerName().getHostname();
  int port=regionServer.getServerName().getPort();
  String rs=rsName + ":" + Integer.toString(port);
  RegionMoverBuilder rmBuilder=new RegionMoverBuilder(rs).ack(false);
  RegionMover rm=rmBuilder.build();
  rm.setConf(TEST_UTIL.getConfiguration());
  LOG.info("Unloading " + rs);
  rm.unload();
  TEST_UTIL.waitFor(5000,500,new Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return regionServer.getNumberOfOnlineRegions() < noRegions;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestRegionSplitter </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test creating a pre-split table using the UniformSplit algorithm.
 */
@Test public void testCreatePresplitTableUniform() throws Exception {
  List<byte[]> expectedBounds=new ArrayList<byte[]>();
  expectedBounds.add(ArrayUtils.EMPTY_BYTE_ARRAY);
  expectedBounds.add(new byte[]{0x10,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x20,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x30,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x40,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x50,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x60,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{0x70,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0x80,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0x90,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xa0,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xb0,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xc0,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xd0,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xe0,0,0,0,0,0,0,0});
  expectedBounds.add(new byte[]{(byte)0xf0,0,0,0,0,0,0,0});
  expectedBounds.add(ArrayUtils.EMPTY_BYTE_ARRAY);
  preSplitTableAndVerify(expectedBounds,UniformSplit.class.getSimpleName(),TableName.valueOf("NewUniformPresplitTable"));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void noopRollingSplit() throws Exception {
  final List<byte[]> expectedBounds=new ArrayList<byte[]>();
  expectedBounds.add(ArrayUtils.EMPTY_BYTE_ARRAY);
  rollingSplitAndVerify(TableName.valueOf(TestRegionSplitter.class.getSimpleName()),"UniformSplit",expectedBounds);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test creating a pre-split table using the HexStringSplit algorithm.
 */
@Test public void testCreatePresplitTableHex() throws Exception {
  final List<byte[]> expectedBounds=new ArrayList<byte[]>();
  expectedBounds.add(ArrayUtils.EMPTY_BYTE_ARRAY);
  expectedBounds.add("10000000".getBytes());
  expectedBounds.add("20000000".getBytes());
  expectedBounds.add("30000000".getBytes());
  expectedBounds.add("40000000".getBytes());
  expectedBounds.add("50000000".getBytes());
  expectedBounds.add("60000000".getBytes());
  expectedBounds.add("70000000".getBytes());
  expectedBounds.add("80000000".getBytes());
  expectedBounds.add("90000000".getBytes());
  expectedBounds.add("a0000000".getBytes());
  expectedBounds.add("b0000000".getBytes());
  expectedBounds.add("c0000000".getBytes());
  expectedBounds.add("d0000000".getBytes());
  expectedBounds.add("e0000000".getBytes());
  expectedBounds.add("f0000000".getBytes());
  expectedBounds.add(ArrayUtils.EMPTY_BYTE_ARRAY);
  preSplitTableAndVerify(expectedBounds,HexStringSplit.class.getSimpleName(),TableName.valueOf("NewHexPresplitTable"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestShowProperties </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShowProperty(){
  Properties properties=System.getProperties();
  for (  java.util.Map.Entry<Object,Object> prop : properties.entrySet()) {
    LOG.info("Property " + prop.getKey() + "="+ prop.getValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.util.TestTableName </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegalHTableNames(){
  for (  String tn : legalTableNames) {
    TableName.isLegalFullyQualifiedTableName(Bytes.toBytes(tn));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.wal.TestWALFactory </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Just write multiple logs then split.  Before fix for HADOOP-2283, this
 * would fail.
 * @throws IOException
 */
@Test public void testSplit() throws IOException {
  final TableName tableName=TableName.valueOf(currentTest.getMethodName());
  final byte[] rowName=tableName.getName();
  final MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl(1);
  final Path logdir=new Path(hbaseDir,DefaultWALProvider.getWALDirectoryName(currentTest.getMethodName()));
  Path oldLogDir=new Path(hbaseDir,HConstants.HREGION_OLDLOGDIR_NAME);
  final int howmany=3;
  HRegionInfo[] infos=new HRegionInfo[3];
  Path tabledir=FSUtils.getTableDir(hbaseDir,tableName);
  fs.mkdirs(tabledir);
  for (int i=0; i < howmany; i++) {
    infos[i]=new HRegionInfo(tableName,Bytes.toBytes("" + i),Bytes.toBytes("" + (i + 1)),false);
    fs.mkdirs(new Path(tabledir,infos[i].getEncodedName()));
    LOG.info("allo " + new Path(tabledir,infos[i].getEncodedName()).toString());
  }
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addFamily(new HColumnDescriptor("column"));
  for (int ii=0; ii < howmany; ii++) {
    for (int i=0; i < howmany; i++) {
      final WAL log=wals.getWAL(infos[i].getEncodedNameAsBytes(),infos[i].getTable().getNamespace());
      for (int j=0; j < howmany; j++) {
        WALEdit edit=new WALEdit();
        byte[] family=Bytes.toBytes("column");
        byte[] qualifier=Bytes.toBytes(Integer.toString(j));
        byte[] column=Bytes.toBytes("column:" + Integer.toString(j));
        edit.add(new KeyValue(rowName,family,qualifier,System.currentTimeMillis(),column));
        LOG.info("Region " + i + ": "+ edit);
        WALKey walKey=new WALKey(infos[i].getEncodedNameAsBytes(),tableName,System.currentTimeMillis(),mvcc);
        log.append(htd,infos[i],walKey,edit,true);
        walKey.getWriteEntry();
      }
      log.sync();
      log.rollWriter(true);
    }
  }
  wals.shutdown();
  List<Path> splits=WALSplitter.split(hbaseDir,logdir,oldLogDir,fs,conf,wals);
  verifySplits(splits,howmany);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void canCloseSingleton() throws IOException {
  WALFactory.getInstance(conf).close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZKConfig </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusterKeyWithMultiplePorts() throws Exception {
  testKey("server1:2182",2181,"hbase",true);
  testKey("server1:2182,server2:2183,server3:2184",2181,"hbase",true);
  testKey("server1:2182,server2,server3:2184",2181,"hbase",true);
  testKey("server1:2182,server2:2183,server3",2181,"hbase",true);
  testKey("server1:2182,server2,server3:2184,server4",2181,"hbase",true);
  testKey("server1:2182,server1:2183,server1",2181,"hbase",true);
  testKey("server1:2182,server2:2183,server1",2181,"hbase",true);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClusterKey() throws Exception {
  testKey("server",2181,"hbase");
  testKey("server1,server2,server3",2181,"hbase");
  try {
    ZKConfig.validateClusterKey("2181:hbase");
  }
 catch (  IOException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hbase.zookeeper.TestZooKeeperNodeTracker </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can interrupt a node that is blocked on a wait.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testInterruptible() throws IOException, InterruptedException {
  Abortable abortable=new StubAbortable();
  ZooKeeperWatcher zk=new ZooKeeperWatcher(TEST_UTIL.getConfiguration(),"testInterruptible",abortable);
  final TestTracker tracker=new TestTracker(zk,"/xyz",abortable);
  tracker.start();
  Thread t=new Thread(){
    @Override public void run(){
      try {
        tracker.blockUntilAvailable();
      }
 catch (      InterruptedException e) {
        throw new RuntimeException("Interrupted",e);
      }
    }
  }
;
  t.start();
  while (!t.isAlive())   Threads.sleep(1);
  tracker.stop();
  t.join();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
