<h3 style="margin:0px">Class: org.apache.tuscany.sca.vtest.javaapi.annotations.scope.ScopeAnnotationTestCase (8 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="16"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('16')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-16"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-6 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Same as atScope6 but the timer triggers KService multiple times.<br>
 */
@Test @Ignore("TUSCANY-2256") public void atScope7() throws Exception {
  System.out.println("atScope7");
  MService mService=ServiceFinder.getService(MService.class,"MComponent");
  mService.getName();
  Thread.sleep(6000);
  String failedReason=mService.getFailedReason();
  System.out.println("");
  Assert.assertEquals("",failedReason);
}

</code></pre>

<pre class="type-16 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Line 260:<br>
 * <li>REQUEST</li>
 * <p>
 * Lines 286 to 289:<br>
 * The lifecycle of request scope extends from the point a request on a
 * remotable interface enters the SCA runtime and a thread processes that
 * request until the thread completes synchronously processing the request.
 * During that time, all service requests will be delegated to the same
 * implementation instance of a request-scoped component.<br>
 * <p>
 */
@Test public void atScope2() throws Exception {
  System.out.println("atScope2");
  ArrayList<DThread> d=new ArrayList<DThread>();
  for (int i=0; i < numDThread; i++)   d.add(new DThread("ThreadD" + i));
  for (int i=0; i < numDThread; i++)   d.get(i).start();
  for (int i=0; i < numDThread; i++)   d.get(i).join();
  System.out.println("");
  for (int i=0; i < numDThread; i++)   Assert.assertEquals("None",d.get(i).failedReason);
}

</code></pre>

<pre class="type-16 type-1 type-15 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Line 262:<br>
 * <li>COMPOSITE</li>
 * <p>
 * Lines 296 to 298:<br>
 * All service requests are dispatched to the same implementation instance
 * for the lifetime of the containing composite. The lifetime of the
 * containing composite is defined as the time it becomes active in the
 * runtime to the time it is deactivated, either normally or abnormally.<br>
 * <p>
 * Following lines should be found at System out<br>
 * atScope3 - Cleaning up<br>
 * FService1->destroyFService
 */
@Test public void atScope3() throws Exception {
  System.out.println("atScope3");
  FService fService=ServiceFinder.getService(FService.class,"FComponent");
  String serviceName=fService.getName();
  boolean isInitReady=fService.isInitReady();
  ArrayList<FThread> f=new ArrayList<FThread>();
  for (int i=0; i < numFThread; i++)   f.add(new FThread("ThreadF" + i));
  for (int i=0; i < numFThread; i++)   f.get(i).start();
  for (int i=0; i < numFThread; i++)   f.get(i).join();
  for (int i=0; i < numFThread; i++) {
    Assert.assertEquals(serviceName,f.get(i).serviceName);
  }
  int instanceCounter=fService.getInstanceCounter();
  int initCalledCounter=fService.getInitCalledCounter();
  int destroyCalledCounter=fService.getDestroyCalledCounter();
  System.out.println("");
  Assert.assertTrue(isInitReady);
  Assert.assertEquals(1,instanceCounter);
  Assert.assertEquals(1,initCalledCounter);
  Assert.assertEquals(0,destroyCalledCounter);
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Lines 299 to 302:<br>
 * A composite scoped implementation may also specify eager initialization
 * using the "@EagerInit" annotation. When marked for eager initialization,
 * the composite scoped instance will be created when its containing
 * component is started. If a method is marked with the "@Init" annotation,
 * it will be called when the instance is created.<p>
 * Section 1.8.9 "@EagerInit"<br>
 * <p>
 * GService is defined as eager initialization. It will be initialized
 * when calls SCADomain.newInstance(compositeName), so the 
 * initCalledCounter is 1.
 */
@Test public void atScope4() throws Exception {
  System.out.println("atScope4");
  GService gService=ServiceFinder.getService(GService.class,"GComponent");
  int initCalledCounter=gService.getInitCalledCounter();
  int destroyCalledCounter=gService.getDestroyCalledCounter();
  System.out.println("initCalledCounter=" + initCalledCounter);
  System.out.println("destroyCalledCounter=" + destroyCalledCounter);
  System.out.println("");
  Assert.assertEquals(1,initCalledCounter);
  Assert.assertEquals(0,destroyCalledCounter);
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Lines 290 to 293:<br>
 * There are times when a local request scoped service is called without
 * there being a remotable service earlier in the call stack, such as when
 * a local service is called from a non-SCA entity. In these cases, a
 * remote request is always considered to be present, but the lifetime of
 * the request is implementation dependent. For example, a timer event
 * could be treated as a remote request..<br>
 * <p>
 * When the composite runs, composite scope service JService kicks off a
 * timer by the @Init method.  When the timer expires, JService invokes a
 * method that calls an operation on the reference to a stateless scope
 * sevice KService. KService calls a request scope service LService
 * multiple times. The results of the calls to LService should be set up to
 * differ depending on whether the same instance is called each time -
 * without the interface being declared Conversational.<br>
 * <p>
 */
@Test public void atScope6() throws Exception {
  System.out.println("atScope6");
  JService jService=ServiceFinder.getService(JService.class,"JComponent");
  jService.getName();
  Thread.sleep(2000);
  String failedReason=jService.getFailedReason();
  System.out.println("");
  Assert.assertEquals("",failedReason);
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Line 259:<br>
 * <li>STATELESS</li>
 * <p>
 * Line 284:<br>
 * For stateless components, there is no implied correlation between
 * service requests.<br>
 * <p>
 * Line 1589 to 1591:<br>
 * The default value is 'STATELESS'. For 'STATELESS' implementations,
 * a different implementation instance may be used to service each request.
 * Implementation instances may be newly created or be drawn from a pool
 * of instances.<br>
 * <p>
 * BComponent is not defined '@Scope'<br>
 * CComponent is defined '@Scope("STATELESS")'<br>
 * <p>
 */
@Test public void atScope1() throws Exception {
  System.out.println("atScope1");
  BThread b1=new BThread("ThreadB1");
  BThread b2=new BThread("ThreadB2");
  CThread c1=new CThread("ThreadC1");
  CThread c2=new CThread("ThreadC2");
  b1.start();
  b2.start();
  c1.start();
  c2.start();
  b1.join();
  b2.join();
  c1.join();
  c2.join();
  System.out.println("");
  Assert.assertEquals("None",b1.failedReason);
  Assert.assertEquals("None",b2.failedReason);
  Assert.assertEquals("None",c1.failedReason);
  Assert.assertEquals("None",c2.failedReason);
}

</code></pre>

<pre class="type-16 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Line 261:<br>
 * <li>CONVERSATION</li>
 * <p>
 * Lines 305 to 310:<br>
 * A conversation is defined as a series of correlated interactions between
 * a client and a target service. A conversational scope starts when the
 * first service request is dispatched to an implementation instance
 * offering a conversational service. A conversational scope completes
 * after an end operation defined by the service contract is called and
 * completes processing or the conversation expires. A conversation may be
 * long-running and the SCA runtime may choose to passivate implementation
 * instances. If this occurs, the runtime must guarantee implementation
 * instance state is preserved.
 */
@Test public void atScope5() throws Exception {
  System.out.println("atScope5");
  ArrayList<HThread> g=new ArrayList<HThread>();
  for (int i=0; i < numHThread; i++)   g.add(new HThread("ThreadH" + i));
  for (int i=0; i < numHThread; i++)   g.get(i).start();
  for (int i=0; i < numHThread; i++)   g.get(i).join();
  HService hService=ServiceFinder.getService(HService.class,"HComponent");
  String failedReason=hService.testCounters(numHThread);
  System.out.println("");
  for (int i=0; i < numHThread; i++)   Assert.assertEquals("None",g.get(i).failedReason);
  Assert.assertEquals("None",failedReason);
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void destroy() throws Exception {
  System.out.println("Cleaning up");
  ServiceFinder.cleanup();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
