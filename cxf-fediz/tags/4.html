<h3><span class=" glyphicon glyphicon-tag"/>&nbspHybridVerifier</h3><kbd>Contains more than 2 JUnit-based stereotypes</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cxf.fediz.integrationtests.AbstractTests </h4><pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAliceWrongPasswordNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="alice";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),401);
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTedAdminNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/admin/fedservlet";
  String user="ted";
  String password="det";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),403);
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAliceManagerNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/manager/fedservlet";
  String user="alice";
  String password="ecila";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),403);
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAliceAdminNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/admin/fedservlet";
  String user="alice";
  String password="ecila";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),403);
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRPMetadata() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/FederationMetadata/2007-06/FederationMetadata.xml";
  final WebClient webClient=new WebClient();
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setSSLClientCertificate(this.getClass().getClassLoader().getResource("client.jks"),"storepass","jks");
  final XmlPage rpPage=webClient.getPage(url);
  final String xmlContent=rpPage.asXml();
  Assert.assertTrue(xmlContent.startsWith("<md:EntityDescriptor"));
  Document doc=rpPage.getXmlDocument();
  doc.getDocumentElement().setIdAttributeNS(null,"ID",true);
  Node signatureNode=DOMUtils.getChild(doc.getDocumentElement(),"Signature");
  Assert.assertNotNull(signatureNode);
  XMLSignature signature=new XMLSignature((Element)signatureNode,"");
  KeyInfo ki=signature.getKeyInfo();
  Assert.assertNotNull(ki);
  Assert.assertNotNull(ki.getX509Certificate());
  Assert.assertTrue(signature.checkSignatureValue(ki.getX509Certificate()));
  webClient.close();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTedManagerNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/manager/fedservlet";
  String user="ted";
  String password="det";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),403);
  }
}

</code></pre>

<br>
<pre class="type-5 type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAliceModifiedSignature() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  final WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getCredentialsProvider().setCredentials(new AuthScope("localhost",Integer.parseInt(getIdpHttpsPort())),new UsernamePasswordCredentials(user,password));
  webClient.getOptions().setJavaScriptEnabled(false);
  final HtmlPage idpPage=webClient.getPage(url);
  webClient.getOptions().setJavaScriptEnabled(true);
  Assert.assertEquals("IDP SignIn Response Form",idpPage.getTitleText());
  DomNodeList<DomElement> results=idpPage.getElementsByTagName("input");
  for (  DomElement result : results) {
    if ("wresult".equals(result.getAttributeNS(null,"name"))) {
      String value=result.getAttributeNS(null,"value");
      value=value.replace("alice","bob");
      result.setAttributeNS(null,"value",value);
    }
  }
  final HtmlForm form=idpPage.getFormByName("signinresponseform");
  final HtmlSubmitInput button=form.getInputByName("_eventId_submit");
  try {
    button.click();
    Assert.fail("Failure expected on a modified signature");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertTrue(ex.getMessage().contains("401 Unauthorized") || ex.getMessage().contains("401 Authentication Failed") || ex.getMessage().contains("403 Forbidden"));
  }
  webClient.close();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRPLogout() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  HTTPTestUtils.loginWithCookieManager(url,user,password,getIdpHttpsPort(),cookieManager);
  WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  final HtmlPage rpPage=webClient.getPage(url);
  Assert.assertTrue("WS Federation Systests Examples".equals(rpPage.getTitleText()) || "WS Federation Systests Spring Examples".equals(rpPage.getTitleText()));
  String rpLogoutUrl="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/logout";
  HTTPTestUtils.logout(rpLogoutUrl,cookieManager);
  String rpUrl="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  webClient.close();
  webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setThrowExceptionOnFailingStatusCode(false);
  final HtmlPage idpPage=webClient.getPage(rpUrl);
  Assert.assertEquals(401,idpPage.getWebResponse().getStatusCode());
  webClient.close();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentRequests() throws Exception {
  String url1="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String url2="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/test.html";
  String user="bob";
  String password="bob";
  CookieManager cookieManager=new CookieManager();
  final WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getCredentialsProvider().setCredentials(new AuthScope("localhost",Integer.parseInt(getIdpHttpsPort())),new UsernamePasswordCredentials(user,password));
  webClient.getOptions().setJavaScriptEnabled(false);
  final HtmlPage idpPage1=webClient.getPage(url1);
  final HtmlPage idpPage2=webClient.getPage(url2);
  webClient.getOptions().setJavaScriptEnabled(true);
  Assert.assertEquals("IDP SignIn Response Form",idpPage1.getTitleText());
  Assert.assertEquals("IDP SignIn Response Form",idpPage2.getTitleText());
  final HtmlForm form=idpPage1.getFormByName("signinresponseform");
  final HtmlSubmitInput button=form.getInputByName("_eventId_submit");
  final HtmlPage rpPage1=button.click();
  Assert.assertTrue("WS Federation Systests Examples".equals(rpPage1.getTitleText()) || "WS Federation Systests Spring Examples".equals(rpPage1.getTitleText()));
  String bodyTextContent1=rpPage1.getBody().getTextContent();
  Assert.assertTrue("Principal not " + user,bodyTextContent1.contains("userPrincipal=" + user));
  final HtmlForm form2=idpPage2.getFormByName("signinresponseform");
  final HtmlSubmitInput button2=form2.getInputByName("_eventId_submit");
  final HtmlPage rpPage2=button2.click();
  String bodyTextContent2=rpPage2.getBody().getTextContent();
  Assert.assertTrue("Unexpected content of RP page",bodyTextContent2.contains("Secure Test"));
  webClient.close();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdPLogout() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  HTTPTestUtils.loginWithCookieManager(url,user,password,getIdpHttpsPort(),cookieManager);
  WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  final HtmlPage rpPage=webClient.getPage(url);
  Assert.assertTrue("WS Federation Systests Examples".equals(rpPage.getTitleText()) || "WS Federation Systests Spring Examples".equals(rpPage.getTitleText()));
  String idpLogoutUrl="https://localhost:" + getIdpHttpsPort() + "/fediz-idp/federation?wa="+ FederationConstants.ACTION_SIGNOUT;
  HTTPTestUtils.logout(idpLogoutUrl,cookieManager);
  String rpUrl="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  webClient.close();
  webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setThrowExceptionOnFailingStatusCode(false);
  final HtmlPage idpPage=webClient.getPage(rpUrl);
  Assert.assertEquals(401,idpPage.getWebResponse().getStatusCode());
  webClient.close();
}

</code></pre>

<br>
<pre class="type-5 type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEntityExpansionAttack() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  final WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getCredentialsProvider().setCredentials(new AuthScope("localhost",Integer.parseInt(getIdpHttpsPort())),new UsernamePasswordCredentials(user,password));
  webClient.getOptions().setJavaScriptEnabled(false);
  final HtmlPage idpPage=webClient.getPage(url);
  webClient.getOptions().setJavaScriptEnabled(true);
  Assert.assertEquals("IDP SignIn Response Form",idpPage.getTitleText());
  DomNodeList<DomElement> results=idpPage.getElementsByTagName("input");
  String entity=IOUtils.toString(this.getClass().getClassLoader().getResource("entity.xml").openStream());
  String reference="&m;";
  for (  DomElement result : results) {
    if ("wresult".equals(result.getAttributeNS(null,"name"))) {
      String value=result.getAttributeNS(null,"value");
      value=entity + value;
      value=value.replace("alice",reference);
      result.setAttributeNS(null,"value",value);
    }
  }
  final HtmlForm form=idpPage.getFormByName("signinresponseform");
  final HtmlSubmitInput button=form.getInputByName("_eventId_submit");
  try {
    button.click();
    Assert.fail("Failure expected on an entity expansion attack");
  }
 catch (  FailingHttpStatusCodeException ex) {
    ex.printStackTrace();
    Assert.assertTrue(ex.getMessage().contains("401 Unauthorized") || ex.getMessage().contains("401 Authentication Failed") || ex.getMessage().contains("403 Forbidden"));
  }
  webClient.close();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTedUserNoAccess() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/user/fedservlet";
  String user="ted";
  String password="det";
  try {
    HTTPTestUtils.login(url,user,password,getIdpHttpsPort());
    Assert.fail("Exception expected");
  }
 catch (  FailingHttpStatusCodeException ex) {
    Assert.assertEquals(ex.getStatusCode(),403);
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdPLogoutCleanup() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  HTTPTestUtils.loginWithCookieManager(url,user,password,getIdpHttpsPort(),cookieManager);
  WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  final HtmlPage rpPage=webClient.getPage(url);
  Assert.assertTrue("WS Federation Systests Examples".equals(rpPage.getTitleText()) || "WS Federation Systests Spring Examples".equals(rpPage.getTitleText()));
  String idpLogoutUrl="https://localhost:" + getIdpHttpsPort() + "/fediz-idp/federation?wa="+ FederationConstants.ACTION_SIGNOUT_CLEANUP;
  HTTPTestUtils.logoutCleanup(idpLogoutUrl,cookieManager);
  String rpUrl="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  webClient.close();
  webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setThrowExceptionOnFailingStatusCode(false);
  final HtmlPage idpPage=webClient.getPage(rpUrl);
  Assert.assertEquals(401,idpPage.getWebResponse().getStatusCode());
  webClient.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.integrationtests.SAMLSSOTest </h4><pre class="type-2 type-7 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdPServiceMetadata() throws Exception {
  String url="https://localhost:" + getIdpHttpsPort() + "/fediz-idp/metadata/urn:org:apache:cxf:fediz:idp:realm-B";
  final WebClient webClient=new WebClient();
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setSSLClientCertificate(this.getClass().getClassLoader().getResource("client.jks"),"storepass","jks");
  final XmlPage rpPage=webClient.getPage(url);
  final String xmlContent=rpPage.asXml();
  Assert.assertTrue(xmlContent.startsWith("<md:EntityDescriptor"));
  Document doc=rpPage.getXmlDocument();
  doc.getDocumentElement().setIdAttributeNS(null,"ID",true);
  Node signatureNode=DOMUtils.getChild(doc.getDocumentElement(),"Signature");
  Assert.assertNotNull(signatureNode);
  XMLSignature signature=new XMLSignature((Element)signatureNode,"");
  KeyInfo ki=signature.getKeyInfo();
  Assert.assertNotNull(ki);
  Assert.assertNotNull(ki.getX509Certificate());
  Assert.assertTrue(signature.checkSignatureValue(ki.getX509Certificate()));
  webClient.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.integrationtests.Spring2Test </h4><pre class="type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testAliceModifiedSignature() throws Exception {
  String url="https://localhost:" + getRpHttpsPort() + "/"+ getServletContextName()+ "/secure/fedservlet";
  String user="alice";
  String password="ecila";
  CookieManager cookieManager=new CookieManager();
  final WebClient webClient=new WebClient();
  webClient.setCookieManager(cookieManager);
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getCredentialsProvider().setCredentials(new AuthScope("localhost",Integer.parseInt(getIdpHttpsPort())),new UsernamePasswordCredentials(user,password));
  webClient.getOptions().setJavaScriptEnabled(false);
  final HtmlPage idpPage=webClient.getPage(url);
  webClient.getOptions().setJavaScriptEnabled(true);
  Assert.assertEquals("IDP SignIn Response Form",idpPage.getTitleText());
  DomNodeList<DomElement> results=idpPage.getElementsByTagName("input");
  for (  DomElement result : results) {
    if ("wresult".equals(result.getAttributeNS(null,"name"))) {
      String value=result.getAttributeNS(null,"value");
      value=value.replace("alice","bob");
      result.setAttributeNS(null,"value",value);
    }
  }
  final HtmlForm form=idpPage.getFormByName("signinresponseform");
  final HtmlSubmitInput button=form.getInputByName("_eventId_submit");
  try {
    button.click();
    Assert.fail("Failure expected on a modified signature");
  }
 catch (  FailingHttpStatusCodeException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.service.idp.integrationtests.RestITTest </h4><pre class="type-12 type-2 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllIdps() throws UnsupportedEncodingException, MalformedURLException {
  String address="https://localhost:" + idpHttpsPort + "/"+ getContextName()+ "/services/rs";
  Client client=ClientBuilder.newClient();
  Idps idps=client.target(address).path("idps").request("application/xml").header("Authorization",getBasicAuthentication("admin","password")).get(Idps.class);
  Assert.assertEquals(1L,idps.getIdps().size());
  Idp idp=idps.getIdps().iterator().next();
  if ("realm-a".equals(realm)) {
    Assert.assertEquals("Certificate doesn't match","stsKeystoreA.properties",idp.getCertificate());
    Assert.assertEquals("Certificate password doesn't match","realma",idp.getCertificatePassword());
    Assert.assertEquals("Realm doesn't match","urn:org:apache:cxf:fediz:idp:realm-A",idp.getRealm());
    Assert.assertEquals("ServiceDescription doesn't match","IDP of Realm A",idp.getServiceDescription());
    Assert.assertEquals("ServiceDisplayName doesn't match","REALM A",idp.getServiceDisplayName());
    Assert.assertEquals("IdpUrl doesn't match",new URL("https://localhost:9443/fediz-idp/federation"),idp.getIdpUrl());
    Assert.assertEquals("StsUrl doesn't match",new URL("https://localhost:9443/fediz-idp-sts/REALMA"),idp.getStsUrl());
    Assert.assertEquals("Uri doesn't match","realma",idp.getUri());
    Assert.assertTrue("ProvideIDPList doesn't match",idp.isProvideIdpList());
    Assert.assertTrue("UseCurrentIDP doesn't match",idp.isUseCurrentIdp());
    Assert.assertEquals("Number of AuthenticationURIs doesn't match",4,idp.getAuthenticationURIs().size());
    Assert.assertEquals("Number of SupportedProtocols doesn't match",2,idp.getSupportedProtocols().size());
    Assert.assertEquals("Number of TokenTypesOffered doesn't match",2,idp.getTokenTypesOffered().size());
    Assert.assertEquals("Number of applications doesn't match",2,idp.getApplications().size());
    Assert.assertEquals("Number of trusted IDPs doesn't match",1,idp.getTrustedIdps().size());
    Assert.assertEquals("Number of claims doesn't match",4,idp.getClaimTypesOffered().size());
  }
 else {
    Assert.assertEquals("Certificate doesn't match","stsKeystoreB.properties",idp.getCertificate());
    Assert.assertEquals("Certificate password doesn't match","realmb",idp.getCertificatePassword());
    Assert.assertEquals("Realm doesn't match","urn:org:apache:cxf:fediz:idp:realm-B",idp.getRealm());
    Assert.assertEquals("ServiceDescription doesn't match","IDP of Realm B",idp.getServiceDescription());
    Assert.assertEquals("ServiceDisplayName doesn't match","REALM B",idp.getServiceDisplayName());
    Assert.assertEquals("IdpUrl doesn't match",new URL("https://localhost:12443/fediz-idp-remote/federation"),idp.getIdpUrl());
    Assert.assertEquals("StsUrl doesn't match",new URL("https://localhost:12443/fediz-idp-sts/REALMB"),idp.getStsUrl());
    Assert.assertEquals("Uri doesn't match","realmb",idp.getUri());
    Assert.assertTrue("ProvideIDPList doesn't match",idp.isProvideIdpList());
    Assert.assertTrue("UseCurrentIDP doesn't match",idp.isUseCurrentIdp());
    Assert.assertEquals("Number of AuthenticationURIs doesn't match",4,idp.getAuthenticationURIs().size());
    Assert.assertEquals("Number of SupportedProtocols doesn't match",2,idp.getSupportedProtocols().size());
    Assert.assertEquals("Number of TokenTypesOffered doesn't match",2,idp.getTokenTypesOffered().size());
    Assert.assertEquals("Number of applications doesn't match",1,idp.getApplications().size());
    Assert.assertEquals("Number of claims doesn't match",4,idp.getClaimTypesOffered().size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.sts.realms.RealmExtensionIdentityMapperTest </h4><pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealmMappingEmptyUserName(){
  RealmExtensionIdentityMapper im=new RealmExtensionIdentityMapper();
  Principal result=im.mapPrincipal("realm-a",new CustomTokenPrincipal("@realm-a"),"realm-b");
  assertNotNull(result);
  assertEquals("@realm-b",result.getName());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealmMappingSimpleUser(){
  RealmExtensionIdentityMapper im=new RealmExtensionIdentityMapper();
  Principal result=im.mapPrincipal("realm-a",new CustomTokenPrincipal("user"),"realm-b");
  assertNotNull(result);
  assertEquals("user@realm-b",result.getName());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealmMappingComplexFakeUser(){
  RealmExtensionIdentityMapper im=new RealmExtensionIdentityMapper();
  Principal result=im.mapPrincipal("realm-a",new CustomTokenPrincipal("user-name@realm-a@test"),"realm-b");
  assertNotNull(result);
  assertEquals("user-name@realm-b",result.getName());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealmMappingCustomDelimiter(){
  RealmExtensionIdentityMapper im=new RealmExtensionIdentityMapper();
  im.setDelimiter(".");
  Principal result=im.mapPrincipal("realm-a",new CustomTokenPrincipal("pre.fix@realm-a"),"realm-b");
  assertNotNull(result);
  assertEquals("pre.realm-b",result.getName());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealmMappingComplexUser(){
  RealmExtensionIdentityMapper im=new RealmExtensionIdentityMapper();
  Principal result=im.mapPrincipal("realm-a",new CustomTokenPrincipal("user.name@realm-a"),"realm-b");
  assertNotNull(result);
  assertEquals("user.name@realm-b",result.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.systests.idp.IdpTest </h4><pre class="type-2 type-7 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdPMetadata() throws Exception {
  String url="https://localhost:" + getIdpHttpsPort() + "/fediz-idp/FederationMetadata/2007-06/FederationMetadata.xml";
  final WebClient webClient=new WebClient();
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setSSLClientCertificate(this.getClass().getClassLoader().getResource("client.jks"),"storepass","jks");
  final XmlPage rpPage=webClient.getPage(url);
  final String xmlContent=rpPage.asXml();
  Assert.assertTrue(xmlContent.startsWith("<md:EntityDescriptor"));
  Document doc=rpPage.getXmlDocument();
  doc.getDocumentElement().setIdAttributeNS(null,"ID",true);
  Node signatureNode=DOMUtils.getChild(doc.getDocumentElement(),"Signature");
  Assert.assertNotNull(signatureNode);
  XMLSignature signature=new XMLSignature((Element)signatureNode,"");
  KeyInfo ki=signature.getKeyInfo();
  Assert.assertNotNull(ki);
  Assert.assertNotNull(ki.getX509Certificate());
  Assert.assertTrue(signature.checkSignatureValue(ki.getX509Certificate()));
  webClient.close();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdPServiceMetadata() throws Exception {
  String url="https://localhost:" + getIdpHttpsPort() + "/fediz-idp/metadata/urn:org:apache:cxf:fediz:idp:realm-B";
  final WebClient webClient=new WebClient();
  webClient.getOptions().setUseInsecureSSL(true);
  webClient.getOptions().setSSLClientCertificate(this.getClass().getClassLoader().getResource("client.jks"),"storepass","jks");
  final XmlPage rpPage=webClient.getPage(url);
  final String xmlContent=rpPage.asXml();
  Assert.assertTrue(xmlContent.startsWith("<md:EntityDescriptor"));
  Document doc=rpPage.getXmlDocument();
  doc.getDocumentElement().setIdAttributeNS(null,"ID",true);
  Node signatureNode=DOMUtils.getChild(doc.getDocumentElement(),"Signature");
  Assert.assertNotNull(signatureNode);
  XMLSignature signature=new XMLSignature((Element)signatureNode,"");
  KeyInfo ki=signature.getKeyInfo();
  Assert.assertNotNull(ki);
  Assert.assertNotNull(ki.getX509Certificate());
  Assert.assertTrue(signature.checkSignatureValue(ki.getX509Certificate()));
  webClient.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.was.mapper.DefaultRoleToGroupMapperTest </h4><pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapping(){
  DefaultRoleToGroupMapper mapper=new DefaultRoleToGroupMapper();
  List<String> result=mapper.groupsFromRoles(Arrays.asList("Role1","Role2","Role3"));
  assertNotNull(result);
  assertEquals(3,result.size());
  assertEquals("Role1",result.get(0));
  assertEquals("Role3",result.get(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTemplateMapping(){
  DefaultRoleToGroupMapper mapper=new DefaultRoleToGroupMapper();
  Properties props=new Properties();
  props.put(DefaultRoleToGroupMapper.PROPERTY_KEY_ROLE_MAPPING_TEMPLATE,DefaultRoleToGroupMapper.DEFAULT_MAPPING_TEMPLATE);
  mapper.initialize(props);
  List<String> result=mapper.groupsFromRoles(Arrays.asList("Role1","Role2","Role3"));
  assertNotNull(result);
  assertEquals(3,result.size());
  assertEquals("group:defaultWIMFileBasedRealm/Role1",result.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyMapping(){
  DefaultRoleToGroupMapper mapper=new DefaultRoleToGroupMapper();
  List<String> result=mapper.groupsFromRoles(new ArrayList<String>());
  assertNotNull(result);
  assertEquals(0,result.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cxf.fediz.was.tai.FedizInterceptorTest </h4><pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectGroupMapping() throws WebTrustAssociationFailedException {
  FedizResponse resp=EasyMock.createMock(FedizResponse.class);
  EasyMock.expect(resp.getRoles()).andReturn(Arrays.asList("Admin","Manager"));
  EasyMock.expect(resp.getUsername()).andReturn("Test-User").anyTimes();
  EasyMock.replay(resp);
  FedizInterceptor fedizInterceptor=new FedizInterceptor();
  Properties properties=new Properties();
  properties.put(Constants.PROPERTY_KEY_CONFIG_LOCATION,"src/test/resources/fediz_config.xml");
  properties.put(Constants.PROPERTY_KEY_DIRECT_GROUP_MAPPING,"true");
  fedizInterceptor.initialize(properties);
  List<String> result=fedizInterceptor.groupIdsFromTokenRoles(resp);
  assertNotNull(result);
  assertEquals(2,result.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupMappingWithNull() throws WebTrustAssociationFailedException {
  FedizResponse resp=EasyMock.createMock(FedizResponse.class);
  EasyMock.expect(resp.getRoles()).andReturn(null);
  EasyMock.expect(resp.getUsername()).andReturn("Test-User").anyTimes();
  EasyMock.replay(resp);
  FedizInterceptor fedizInterceptor=new FedizInterceptor();
  Properties properties=new Properties();
  properties.put(Constants.PROPERTY_KEY_CONFIG_LOCATION,"src/test/resources/fediz_config.xml");
  fedizInterceptor.initialize(properties);
  List<String> result=fedizInterceptor.groupIdsFromTokenRoles(resp);
  assertNotNull(result);
  assertEquals(0,result.size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
