<h3 style="margin:0px">Class: org.apache.kafka.clients.consumer.internals.ConsumerCoordinatorTest (44 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(26)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(25)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(24)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(23)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(13)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CommitFailedException.class) public void testCommitOffsetIllegalGeneration(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.ILLEGAL_GENERATION.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L,"metadata")));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetAsyncDisconnected(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  MockCommitCallback cb=new MockCommitCallback();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())),true);
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),cb);
  consumerClient.poll(0);
  assertTrue(coordinator.coordinatorUnknown());
  assertEquals(1,cb.invoked);
  assertTrue(cb.exception instanceof DisconnectException);
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testLeaveGroupOnClose(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  final AtomicBoolean received=new AtomicBoolean(false);
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      received.set(true);
      LeaveGroupRequest leaveRequest=new LeaveGroupRequest(request.request().body());
      return leaveRequest.memberId().equals(consumerId) && leaveRequest.groupId().equals(groupId);
    }
  }
,new LeaveGroupResponse(Errors.NONE.code()).toStruct());
  coordinator.close();
  assertTrue(received.get());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommitOffsetSyncCoordinatorDisconnected(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())),true);
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)));
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CommitFailedException.class) public void testCommitOffsetRebalanceInProgress(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.REBALANCE_IN_PROGRESS.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L,"metadata")));
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ApiException.class) public void testJoinGroupInvalidGroupId(){
  final String consumerId="leader";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  metadata.setTopics(Arrays.asList(topicName));
  metadata.update(cluster,time.milliseconds());
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupLeaderResponse(0,consumerId,Collections.<String,List<String>>emptyMap(),Errors.INVALID_GROUP_ID.code()));
  coordinator.ensurePartitionAssignment();
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMetadataChangeTriggersRebalance(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  metadata.update(TestUtils.singletonCluster(topicName,2),time.milliseconds());
  assertTrue(subscriptions.partitionAssignmentNeeded());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommitOffsetSyncCoordinatorNotAvailable(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.GROUP_COORDINATOR_NOT_AVAILABLE.code())));
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshOffsetLoadInProgress(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needRefreshCommits();
  client.prepareResponse(offsetFetchResponse(tp,Errors.GROUP_LOAD_IN_PROGRESS.code(),"",100L));
  client.prepareResponse(offsetFetchResponse(tp,Errors.NONE.code(),"",100L));
  coordinator.refreshCommittedOffsetsIfNeeded();
  assertFalse(subscriptions.refreshCommitsNeeded());
  assertEquals(100L,subscriptions.committed(tp).offset());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetAsyncCoordinatorNotAvailable(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  MockCommitCallback cb=new MockCommitCallback();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.GROUP_COORDINATOR_NOT_AVAILABLE.code())));
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),cb);
  consumerClient.poll(0);
  assertTrue(coordinator.coordinatorUnknown());
  assertEquals(1,cb.invoked);
  assertEquals(Errors.GROUP_COORDINATOR_NOT_AVAILABLE.exception(),cb.exception);
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaybeLeaveGroup(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  final AtomicBoolean received=new AtomicBoolean(false);
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      received.set(true);
      LeaveGroupRequest leaveRequest=new LeaveGroupRequest(request.request().body());
      return leaveRequest.memberId().equals(consumerId) && leaveRequest.groupId().equals(groupId);
    }
  }
,new LeaveGroupResponse(Errors.NONE.code()).toStruct());
  coordinator.maybeLeaveGroup();
  assertTrue(received.get());
  assertEquals(JoinGroupRequest.UNKNOWN_MEMBER_ID,coordinator.memberId);
  assertEquals(OffsetCommitRequest.DEFAULT_GENERATION_ID,coordinator.generation);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommitOffsetSyncNotCoordinator(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NOT_COORDINATOR_FOR_GROUP.code())));
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnknownMemberIdOnSyncGroup(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Collections.<TopicPartition>emptyList(),Errors.UNKNOWN_MEMBER_ID.code()));
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      JoinGroupRequest joinRequest=new JoinGroupRequest(request.request().body());
      return joinRequest.memberId().equals(JoinGroupRequest.UNKNOWN_MEMBER_ID);
    }
  }
,joinGroupFollowerResponse(2,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetOnly(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  AtomicBoolean success=new AtomicBoolean(false);
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),callback(success));
  consumerClient.poll(0);
  assertTrue(success.get());
  assertEquals(100L,subscriptions.committed(tp).offset());
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCommitAfterLeaveGroup(){
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,"consumer","leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  client.prepareResponse(new LeaveGroupResponse(Errors.NONE.code()).toStruct());
  subscriptions.unsubscribe();
  coordinator.maybeLeaveGroup();
  subscriptions.assignFromUser(Arrays.asList(tp));
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      OffsetCommitRequest commitRequest=new OffsetCommitRequest(request.request().body());
      return commitRequest.memberId().equals(OffsetCommitRequest.DEFAULT_MEMBER_ID) && commitRequest.generationId() == OffsetCommitRequest.DEFAULT_GENERATION_ID;
    }
  }
,offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  AtomicBoolean success=new AtomicBoolean(false);
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),callback(success));
  consumerClient.poll(0);
  assertTrue(success.get());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIllegalGeneration(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.assignFromSubscribed(Collections.singletonList(tp));
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.ILLEGAL_GENERATION.code()));
  time.sleep(sessionTimeoutMs);
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.failed());
  assertEquals(Errors.ILLEGAL_GENERATION.exception(),future.exception());
  assertTrue(coordinator.needRejoin());
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CommitFailedException.class) public void testCommitOffsetUnknownMemberId(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.UNKNOWN_MEMBER_ID.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L,"metadata")));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisconnectInJoin(){
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,"consumer","leader",Errors.NONE.code()),true);
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  client.prepareResponse(joinGroupFollowerResponse(1,"consumer","leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
  assertEquals(1,rebalanceListener.revokedCount);
  assertEquals(1,rebalanceListener.assignedCount);
  assertEquals(Collections.singleton(tp),rebalanceListener.assigned);
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setup(){
  this.time=new MockTime();
  this.client=new MockClient(time);
  this.subscriptions=new SubscriptionState(OffsetResetStrategy.EARLIEST);
  this.metadata=new Metadata(0,Long.MAX_VALUE);
  this.metadata.update(cluster,time.milliseconds());
  this.consumerClient=new ConsumerNetworkClient(client,metadata,time,100);
  this.metrics=new Metrics(time);
  this.rebalanceListener=new MockRebalanceListener();
  this.defaultOffsetCommitCallback=new MockCommitCallback();
  this.partitionAssignor.clear();
  client.setNode(node);
  this.coordinator=buildCoordinator(metrics,assignors);
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoordinatorDisconnect(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.NONE.code()),true);
  time.sleep(sessionTimeoutMs);
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.failed());
  assertTrue(future.exception() instanceof DisconnectException);
  assertTrue(coordinator.coordinatorUnknown());
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRejoinGroup(){
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,"consumer","leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertEquals(1,rebalanceListener.revokedCount);
  assertEquals(1,rebalanceListener.assignedCount);
  subscriptions.needReassignment();
  client.prepareResponse(joinGroupFollowerResponse(2,"consumer","leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertEquals(2,rebalanceListener.revokedCount);
  assertEquals(Collections.singleton(tp),rebalanceListener.revoked);
  assertEquals(2,rebalanceListener.assignedCount);
  assertEquals(Collections.singleton(tp),rebalanceListener.assigned);
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=GroupAuthorizationException.class) public void testGroupDescribeUnauthorized(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.GROUP_AUTHORIZATION_FAILED.code()));
  coordinator.ensureCoordinatorKnown();
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=GroupAuthorizationException.class) public void testGroupReadUnauthorized(){
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupLeaderResponse(0,"memberId",Collections.<String,List<String>>emptyMap(),Errors.GROUP_AUTHORIZATION_FAILED.code()));
  coordinator.ensurePartitionAssignment();
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=OffsetMetadataTooLarge.class) public void testCommitOffsetMetadataTooLarge(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.OFFSET_METADATA_TOO_LARGE.code())));
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L,"metadata")));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetMetadata(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  AtomicBoolean success=new AtomicBoolean(false);
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L,"hello")),callback(success));
  consumerClient.poll(0);
  assertTrue(success.get());
  assertEquals(100L,subscriptions.committed(tp).offset());
  assertEquals("hello",subscriptions.committed(tp).metadata());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshOffsetNotCoordinatorForConsumer(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needRefreshCommits();
  client.prepareResponse(offsetFetchResponse(tp,Errors.NOT_COORDINATOR_FOR_GROUP.code(),"",100L));
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  client.prepareResponse(offsetFetchResponse(tp,Errors.NONE.code(),"",100L));
  coordinator.refreshCommittedOffsetsIfNeeded();
  assertFalse(subscriptions.refreshCommitsNeeded());
  assertEquals(100L,subscriptions.committed(tp).offset());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoordinatorNotAvailable(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.GROUP_COORDINATOR_NOT_AVAILABLE.code()));
  time.sleep(sessionTimeoutMs);
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.failed());
  assertEquals(Errors.GROUP_COORDINATOR_NOT_AVAILABLE.exception(),future.exception());
  assertTrue(coordinator.coordinatorUnknown());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotCoordinator(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.NOT_COORDINATOR_FOR_GROUP.code()));
  time.sleep(sessionTimeoutMs);
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.failed());
  assertEquals(Errors.NOT_COORDINATOR_FOR_GROUP.exception(),future.exception());
  assertTrue(coordinator.coordinatorUnknown());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRebalanceInProgressOnSyncGroup(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Collections.<TopicPartition>emptyList(),Errors.REBALANCE_IN_PROGRESS.code()));
  client.prepareResponse(joinGroupFollowerResponse(2,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalJoinGroupLeader(){
  final String consumerId="leader";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  metadata.setTopics(Arrays.asList(topicName));
  metadata.update(cluster,time.milliseconds());
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  Map<String,List<String>> memberSubscriptions=Collections.singletonMap(consumerId,Arrays.asList(topicName));
  partitionAssignor.prepare(Collections.singletonMap(consumerId,Arrays.asList(tp)));
  client.prepareResponse(joinGroupLeaderResponse(1,consumerId,memberSubscriptions,Errors.NONE.code()));
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      SyncGroupRequest sync=new SyncGroupRequest(request.request().body());
      return sync.memberId().equals(consumerId) && sync.generationId() == 1 && sync.groupAssignment().containsKey(consumerId);
    }
  }
,syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
  assertEquals(1,rebalanceListener.revokedCount);
  assertEquals(Collections.emptySet(),rebalanceListener.revoked);
  assertEquals(1,rebalanceListener.assignedCount);
  assertEquals(Collections.singleton(tp),rebalanceListener.assigned);
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ApiException.class) public void testInvalidSessionTimeout(){
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(0,"consumer","",Errors.INVALID_SESSION_TIMEOUT.code()));
  coordinator.ensurePartitionAssignment();
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshOffsetWithNoFetchableOffsets(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needRefreshCommits();
  client.prepareResponse(offsetFetchResponse(tp,Errors.NONE.code(),"",-1L));
  coordinator.refreshCommittedOffsetsIfNeeded();
  assertFalse(subscriptions.refreshCommitsNeeded());
  assertEquals(null,subscriptions.committed(tp));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalJoinGroupFollower(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      SyncGroupRequest sync=new SyncGroupRequest(request.request().body());
      return sync.memberId().equals(consumerId) && sync.generationId() == 1 && sync.groupAssignment().isEmpty();
    }
  }
,syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
  assertEquals(1,rebalanceListener.revokedCount);
  assertEquals(1,rebalanceListener.assignedCount);
  assertEquals(Collections.singleton(tp),rebalanceListener.assigned);
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=KafkaException.class) public void testCommitOffsetSyncCallbackWithNonRetriableException(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.UNKNOWN.code())),false);
  coordinator.commitOffsetsSync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)));
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=KafkaException.class) public void testUnexpectedErrorOnSyncGroup(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Collections.<TopicPartition>emptyList(),Errors.UNKNOWN.code()));
  coordinator.ensurePartitionAssignment();
}

</code></pre>

<pre class="type-3 type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetAsyncWithDefaultCallback(){
  int invokedBeforeTest=defaultOffsetCommitCallback.invoked;
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NONE.code())));
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),null);
  consumerClient.poll(0);
  assertEquals(invokedBeforeTest + 1,defaultOffsetCommitCallback.invoked);
  assertNull(defaultOffsetCommitCallback.exception);
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIllegalGenerationOnSyncGroup(){
  final String consumerId="consumer";
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.needReassignment();
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(joinGroupFollowerResponse(1,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Collections.<TopicPartition>emptyList(),Errors.ILLEGAL_GENERATION.code()));
  client.prepareResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    ClientRequest request){
      JoinGroupRequest joinRequest=new JoinGroupRequest(request.request().body());
      return joinRequest.memberId().equals(JoinGroupRequest.UNKNOWN_MEMBER_ID);
    }
  }
,joinGroupFollowerResponse(2,consumerId,"leader",Errors.NONE.code()));
  client.prepareResponse(syncGroupResponse(Arrays.asList(tp),Errors.NONE.code()));
  coordinator.ensurePartitionAssignment();
  assertFalse(subscriptions.partitionAssignmentNeeded());
  assertEquals(Collections.singleton(tp),subscriptions.assignedPartitions());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshOffset(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needRefreshCommits();
  client.prepareResponse(offsetFetchResponse(tp,Errors.NONE.code(),"",100L));
  coordinator.refreshCommittedOffsetsIfNeeded();
  assertFalse(subscriptions.refreshCommitsNeeded());
  assertEquals(100L,subscriptions.committed(tp).offset());
}

</code></pre>

<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProtocolMetadataOrder(){
  RoundRobinAssignor roundRobin=new RoundRobinAssignor();
  RangeAssignor range=new RangeAssignor();
  try (Metrics metrics=new Metrics(time)){
    ConsumerCoordinator coordinator=buildCoordinator(metrics,Arrays.<PartitionAssignor>asList(roundRobin,range));
    List<ProtocolMetadata> metadata=coordinator.metadata();
    assertEquals(2,metadata.size());
    assertEquals(roundRobin.name(),metadata.get(0).name());
    assertEquals(range.name(),metadata.get(1).name());
  }
   try (Metrics metrics=new Metrics(time)){
    ConsumerCoordinator coordinator=buildCoordinator(metrics,Arrays.<PartitionAssignor>asList(range,roundRobin));
    List<ProtocolMetadata> metadata=coordinator.metadata();
    assertEquals(2,metadata.size());
    assertEquals(range.name(),metadata.get(0).name());
    assertEquals(roundRobin.name(),metadata.get(1).name());
  }
 }

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void teardown(){
  this.metrics.close();
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalHeartbeat(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.NONE.code()));
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.succeeded());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnknownConsumerId(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  subscriptions.subscribe(Arrays.asList(topicName),rebalanceListener);
  subscriptions.assignFromSubscribed(Collections.singletonList(tp));
  time.sleep(sessionTimeoutMs);
  RequestFuture<Void> future=coordinator.sendHeartbeatRequest();
  assertEquals(1,consumerClient.pendingRequestCount());
  assertFalse(future.isDone());
  client.prepareResponse(heartbeatResponse(Errors.UNKNOWN_MEMBER_ID.code()));
  time.sleep(sessionTimeoutMs);
  consumerClient.poll(0);
  assertTrue(future.isDone());
  assertTrue(future.failed());
  assertEquals(Errors.UNKNOWN_MEMBER_ID.exception(),future.exception());
  assertTrue(coordinator.needRejoin());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitOffsetAsyncNotCoordinator(){
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  MockCommitCallback cb=new MockCommitCallback();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.NOT_COORDINATOR_FOR_GROUP.code())));
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),cb);
  consumerClient.poll(0);
  assertTrue(coordinator.coordinatorUnknown());
  assertEquals(1,cb.invoked);
  assertEquals(Errors.NOT_COORDINATOR_FOR_GROUP.exception(),cb.exception);
}

</code></pre>

<pre class="type-3 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCommitOffsetAsyncFailedWithDefaultCallback(){
  int invokedBeforeTest=defaultOffsetCommitCallback.invoked;
  client.prepareResponse(consumerMetadataResponse(node,Errors.NONE.code()));
  coordinator.ensureCoordinatorKnown();
  client.prepareResponse(offsetCommitResponse(Collections.singletonMap(tp,Errors.GROUP_COORDINATOR_NOT_AVAILABLE.code())));
  coordinator.commitOffsetsAsync(Collections.singletonMap(tp,new OffsetAndMetadata(100L)),null);
  consumerClient.poll(0);
  assertEquals(invokedBeforeTest + 1,defaultOffsetCommitCallback.invoked);
  assertEquals(Errors.GROUP_COORDINATOR_NOT_AVAILABLE.exception(),defaultOffsetCommitCallback.exception);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
