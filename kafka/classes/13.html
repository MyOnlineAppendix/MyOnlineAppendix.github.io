<h3 style="margin:0px">Class: org.apache.kafka.clients.consumer.internals.FetcherTest (28 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(20)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(3)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFetchPositionResetToEarliestOffset(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needOffsetReset(tp,OffsetResetStrategy.EARLIEST);
  client.prepareResponse(listOffsetRequestMatcher(ListOffsetRequest.EARLIEST_TIMESTAMP),listOffsetResponse(Errors.NONE,Arrays.asList(5L)));
  fetcher.updateFetchPositions(Collections.singleton(tp));
  assertFalse(subscriptions.isOffsetResetNeeded(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(5,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecordTooLargeException.class) public void testFetchRecordTooLarge(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  MemoryRecords records=MemoryRecords.emptyRecords(ByteBuffer.allocate(1024),CompressionType.NONE);
  byte[] bytes=new byte[this.fetchSize];
  new Random().nextBytes(bytes);
  records.append(1L,null,bytes);
  records.close();
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse((ByteBuffer)records.buffer().limit(this.fetchSize),Errors.NONE.code(),100L,0));
  consumerClient.poll(0);
  fetcher.fetchedRecords();
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFetchPositionDisconnect(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needOffsetReset(tp,OffsetResetStrategy.LATEST);
  client.prepareResponse(listOffsetRequestMatcher(ListOffsetRequest.LATEST_TIMESTAMP),listOffsetResponse(Errors.NONE,Arrays.asList(5L)),true);
  client.prepareResponse(listOffsetRequestMatcher(ListOffsetRequest.LATEST_TIMESTAMP),listOffsetResponse(Errors.NONE,Arrays.asList(5L)));
  fetcher.updateFetchPositions(Collections.singleton(tp));
  assertFalse(subscriptions.isOffsetResetNeeded(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(5,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchNotLeaderForPartition(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NOT_LEADER_FOR_PARTITION.code(),100L,0));
  consumerClient.poll(0);
  assertEquals(0,fetcher.fetchedRecords().size());
  assertEquals(0L,metadata.timeToNextUpdate(time.milliseconds()));
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFetchOnPausedPartition(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  subscriptions.pause(tp);
  fetcher.initFetches(cluster);
  assertTrue(client.requests().isEmpty());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchDisconnected(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NONE.code(),100L,0),true);
  consumerClient.poll(0);
  assertEquals(0,fetcher.fetchedRecords().size());
  assertFalse(subscriptions.isOffsetResetNeeded(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(0,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAllTopicsDisconnect(){
  client.prepareResponse(null,true);
  client.prepareResponse(new MetadataResponse(cluster,Collections.<String,Errors>emptyMap()).toStruct());
  Map<String,List<PartitionInfo>> allTopics=fetcher.getAllTopicMetadata(5000L);
  assertEquals(cluster.topics().size(),allTopics.size());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchedRecordsAfterSeek(){
  subscriptionsNoAutoReset.assignFromUser(Arrays.asList(tp));
  subscriptionsNoAutoReset.seek(tp,0);
  fetcherNoAutoReset.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.OFFSET_OUT_OF_RANGE.code(),100L,0));
  consumerClient.poll(0);
  assertFalse(subscriptionsNoAutoReset.isOffsetResetNeeded(tp));
  subscriptionsNoAutoReset.seek(tp,2);
  assertEquals(0,fetcherNoAutoReset.fetchedRecords().size());
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFetchPositionToCommitted(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.committed(tp,new OffsetAndMetadata(5));
  fetcher.updateFetchPositions(Collections.singleton(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(5,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-8 type-13 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQuotaMetrics() throws Exception {
  List<ConsumerRecord<byte[],byte[]>> records;
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  for (int i=1; i < 4; i++) {
    fetcher.initFetches(cluster);
    client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NONE.code(),100L,100 * i));
    consumerClient.poll(0);
    records=fetcher.fetchedRecords().get(tp);
    assertEquals(3,records.size());
  }
  Map<MetricName,KafkaMetric> allMetrics=metrics.metrics();
  KafkaMetric avgMetric=allMetrics.get(metrics.metricName("fetch-throttle-time-avg",metricGroup,""));
  KafkaMetric maxMetric=allMetrics.get(metrics.metricName("fetch-throttle-time-max",metricGroup,""));
  assertEquals(200,avgMetric.value(),EPSILON);
  assertEquals(300,maxMetric.value(),EPSILON);
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void teardown(){
  this.metrics.close();
  this.fetcherMetrics.close();
}

</code></pre>

<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAllTopics(){
  client.prepareResponse(new MetadataResponse(cluster,Collections.<String,Errors>emptyMap()).toStruct());
  Map<String,List<PartitionInfo>> allTopics=fetcher.getAllTopicMetadata(5000L);
  assertEquals(cluster.topics().size(),allTopics.size());
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setup() throws Exception {
  metadata.update(cluster,time.milliseconds());
  client.setNode(node);
  records.append(1L,"key".getBytes(),"value-1".getBytes());
  records.append(2L,"key".getBytes(),"value-2".getBytes());
  records.append(3L,"key".getBytes(),"value-3".getBytes());
  records.close();
}

</code></pre>

<pre class="type-8 type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetTopicMetadataLeaderNotAvailable(){
  Cluster emptyCluster=new Cluster(this.cluster.nodes(),Collections.<PartitionInfo>emptyList(),Collections.<String>emptySet());
  client.prepareResponse(new MetadataResponse(emptyCluster,Collections.singletonMap(topicName,Errors.LEADER_NOT_AVAILABLE)).toStruct());
  client.prepareResponse(new MetadataResponse(this.cluster,Collections.<String,Errors>emptyMap()).toStruct());
  Map<String,List<PartitionInfo>> topicMetadata=fetcher.getTopicMetadata(Collections.singletonList(topicName),5000L);
  assertTrue(topicMetadata.containsKey(topicName));
}

</code></pre>

<pre class="type-10 type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchOffsetOutOfRangeException(){
  subscriptionsNoAutoReset.assignFromUser(Arrays.asList(tp));
  subscriptionsNoAutoReset.seek(tp,0);
  fetcherNoAutoReset.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.OFFSET_OUT_OF_RANGE.code(),100L,0));
  consumerClient.poll(0);
  assertFalse(subscriptionsNoAutoReset.isOffsetResetNeeded(tp));
  try {
    fetcherNoAutoReset.fetchedRecords();
    fail("Should have thrown OffsetOutOfRangeException");
  }
 catch (  OffsetOutOfRangeException e) {
    assertTrue(e.offsetOutOfRangePartitions().containsKey(tp));
    assertEquals(e.offsetOutOfRangePartitions().size(),1);
  }
  assertEquals(0,fetcherNoAutoReset.fetchedRecords().size());
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TimeoutException.class) public void testGetAllTopicsTimeout(){
  fetcher.getAllTopicMetadata(50L);
}

</code></pre>

<pre class="type-10 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnauthorizedTopic(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.TOPIC_AUTHORIZATION_FAILED.code(),100L,0));
  consumerClient.poll(0);
  try {
    fetcher.fetchedRecords();
    fail("fetchedRecords should have thrown");
  }
 catch (  TopicAuthorizationException e) {
    assertEquals(Collections.singleton(topicName),e.unauthorizedTopics());
  }
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFetchDuringRebalance(){
  subscriptions.subscribe(Arrays.asList(topicName),listener);
  subscriptions.assignFromSubscribed(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  subscriptions.assignFromSubscribed(Arrays.asList(tp));
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NONE.code(),100L,0));
  consumerClient.poll(0);
  assertTrue(fetcher.fetchedRecords().isEmpty());
}

</code></pre>

<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchNonContinuousRecords(){
  MemoryRecords records=MemoryRecords.emptyRecords(ByteBuffer.allocate(1024),CompressionType.NONE);
  records.append(15L,"key".getBytes(),"value-1".getBytes());
  records.append(20L,"key".getBytes(),"value-2".getBytes());
  records.append(30L,"key".getBytes(),"value-3".getBytes());
  records.close();
  List<ConsumerRecord<byte[],byte[]>> consumerRecords;
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(records.buffer(),Errors.NONE.code(),100L,0));
  consumerClient.poll(0);
  consumerRecords=fetcher.fetchedRecords().get(tp);
  assertEquals(3,consumerRecords.size());
  assertEquals(31L,(long)subscriptions.position(tp));
  assertEquals(15L,consumerRecords.get(0).offset());
  assertEquals(20L,consumerRecords.get(1).offset());
  assertEquals(30L,consumerRecords.get(2).offset());
}

</code></pre>

<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchUnknownTopicOrPartition(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.UNKNOWN_TOPIC_OR_PARTITION.code(),100L,0));
  consumerClient.poll(0);
  assertEquals(0,fetcher.fetchedRecords().size());
  assertEquals(0L,metadata.timeToNextUpdate(time.milliseconds()));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchOffsetOutOfRange(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.OFFSET_OUT_OF_RANGE.code(),100L,0));
  consumerClient.poll(0);
  assertTrue(subscriptions.isOffsetResetNeeded(tp));
  assertEquals(0,fetcher.fetchedRecords().size());
  assertEquals(null,subscriptions.position(tp));
}

</code></pre>

<pre class="type-8 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetTopicMetadataUnknownTopic(){
  Cluster emptyCluster=new Cluster(this.cluster.nodes(),Collections.<PartitionInfo>emptyList(),Collections.<String>emptySet());
  client.prepareResponse(new MetadataResponse(emptyCluster,Collections.singletonMap(topicName,Errors.UNKNOWN_TOPIC_OR_PARTITION)).toStruct());
  Map<String,List<PartitionInfo>> topicMetadata=fetcher.getTopicMetadata(Collections.singletonList(topicName),5000L);
  assertNull(topicMetadata.get(topicName));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFetchPositionResetToDefaultOffset(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  client.prepareResponse(listOffsetRequestMatcher(ListOffsetRequest.EARLIEST_TIMESTAMP),listOffsetResponse(Errors.NONE,Arrays.asList(5L)));
  fetcher.updateFetchPositions(Collections.singleton(tp));
  assertFalse(subscriptions.isOffsetResetNeeded(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(5,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-9 type-7 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateFetchPositionResetToLatestOffset(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.needOffsetReset(tp,OffsetResetStrategy.LATEST);
  client.prepareResponse(listOffsetRequestMatcher(ListOffsetRequest.LATEST_TIMESTAMP),listOffsetResponse(Errors.NONE,Arrays.asList(5L)));
  fetcher.updateFetchPositions(Collections.singleton(tp));
  assertFalse(subscriptions.isOffsetResetNeeded(tp));
  assertTrue(subscriptions.isFetchable(tp));
  assertEquals(5,(long)subscriptions.position(tp));
}

</code></pre>

<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchNormal(){
  List<ConsumerRecord<byte[],byte[]>> records;
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NONE.code(),100L,0));
  consumerClient.poll(0);
  records=fetcher.fetchedRecords().get(tp);
  assertEquals(3,records.size());
  assertEquals(4L,(long)subscriptions.position(tp));
  long offset=1;
  for (  ConsumerRecord<byte[],byte[]> record : records) {
    assertEquals(offset,record.offset());
    offset+=1;
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInFlightFetchOnPausedPartition(){
  subscriptions.assignFromUser(Arrays.asList(tp));
  subscriptions.seek(tp,0);
  fetcher.initFetches(cluster);
  subscriptions.pause(tp);
  client.prepareResponse(fetchResponse(this.records.buffer(),Errors.NONE.code(),100L,0));
  consumerClient.poll(0);
  assertNull(fetcher.fetchedRecords().get(tp));
}

</code></pre>

<pre class="type-10 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllTopicsUnauthorized(){
  client.prepareResponse(new MetadataResponse(cluster,Collections.singletonMap(topicName,Errors.TOPIC_AUTHORIZATION_FAILED)).toStruct());
  try {
    fetcher.getAllTopicMetadata(10L);
    fail();
  }
 catch (  TopicAuthorizationException e) {
    assertEquals(Collections.singleton(topicName),e.unauthorizedTopics());
  }
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=InvalidTopicException.class) public void testGetTopicMetadataInvalidTopic(){
  client.prepareResponse(new MetadataResponse(cluster,Collections.singletonMap(topicName,Errors.INVALID_TOPIC_EXCEPTION)).toStruct());
  fetcher.getTopicMetadata(Collections.singletonList(topicName),5000L);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
