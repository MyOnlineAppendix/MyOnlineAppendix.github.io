<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.aries.ant.taskdefs.EsaTaskTest </h4><pre class="type-4 type-5 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void generateArchiveNoManifest(){
  File srcDir=new File("../src/test/resources");
  File destfile=new File("target/esa-test1.esa");
  if (destfile.exists()) {
    destfile.delete();
  }
  assertFalse(destfile.exists());
  EsaTask esaTask=new EsaTask();
  Project testProject=new Project();
  esaTask.setProject(testProject);
  FileSet fileSet=new FileSet();
  fileSet.setDir(srcDir);
  fileSet.setIncludes("*.jar");
  esaTask.addFileset(fileSet);
  esaTask.setDestFile(destfile);
  esaTask.setSymbolicName("esatask-test");
  esaTask.setVersion("1.0.0");
  esaTask.execute();
  assertTrue(destfile.exists());
  try {
    ZipFile esaArchive=new ZipFile(destfile);
    assertNotNull(esaArchive);
    ZipEntry subsystemManifest=esaArchive.getEntry("OSGI-INF/SUBSYSTEM.MF");
    assertNull(subsystemManifest);
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void generateArchiveWithFileManifest(){
  File srcDir=new File("../src/test/resources");
  File destfile=new File("target/esa-test2.esa");
  if (destfile.exists()) {
    destfile.delete();
  }
  assertFalse(destfile.exists());
  EsaTask esaTask=new EsaTask();
  Project testProject=new Project();
  esaTask.setProject(testProject);
  FileSet fileSet=new FileSet();
  fileSet.setDir(srcDir);
  fileSet.setIncludes("*.jar");
  esaTask.addFileset(fileSet);
  esaTask.setDestFile(destfile);
  esaTask.setSymbolicName("esatask-test");
  esaTask.setVersion("1.0.0");
  esaTask.setManifest(new File(srcDir,"SUBSYSTEM.MF"));
  esaTask.execute();
  assertTrue(destfile.exists());
  try {
    ZipFile esaArchive=new ZipFile(destfile);
    assertNotNull(esaArchive);
    ZipEntry subsystemManifest=esaArchive.getEntry("OSGI-INF/SUBSYSTEM.MF");
    assertNotNull(subsystemManifest);
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void generateArchiveWithNewManifest(){
  File srcDir=new File("../src/test/resources");
  assertTrue(srcDir.exists());
  File destfile=new File("target/esa-test.esa");
  if (destfile.exists()) {
    destfile.delete();
  }
  assertFalse(destfile.exists());
  EsaTask esaTask=new EsaTask();
  Project testProject=new Project();
  esaTask.setProject(testProject);
  FileSet fileSet=new FileSet();
  fileSet.setDir(srcDir);
  fileSet.setIncludes("*.jar");
  esaTask.addFileset(fileSet);
  esaTask.setDestFile(destfile);
  esaTask.setSymbolicName("esatask-test");
  esaTask.setName("ESA Test Task");
  esaTask.setVersion("1.0.0");
  esaTask.setGenerateManifest(true);
  esaTask.execute();
  assertTrue(destfile.exists());
  try {
    ZipFile esaArchive=new ZipFile(destfile);
    assertNotNull(esaArchive);
    ZipEntry subsystemManifest=esaArchive.getEntry("OSGI-INF/SUBSYSTEM.MF");
    assertNotNull(subsystemManifest);
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.deployment.management.DeploymentGeneratorTest </h4><pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void checkBundleInAppContentAndUseContent() throws Exception {
  List<ModelledResource> cmr=new ArrayList<ModelledResource>();
  cmr.add(createModelledResource("test.api","1.1.0",Collections.<String>emptyList(),Arrays.asList("test.api.pack;version=1.1.0")));
  cmr.add(createModelledResource("test.api","1.0.0",Collections.<String>emptyList(),Arrays.asList("test.api.pack;version=1.0.0")));
  cmr.add(createModelledResource("test.consumer","1.0.0",Arrays.asList("test.api.pack;version=\"[1.0.0,2.0.0)\""),Collections.<String>emptyList()));
  cmr.add(createModelledResource("test.provider","1.0.0",Arrays.asList("test.api.pack;version=\"[1.0.0,1.1.0)\""),Collections.<String>emptyList()));
  _resolver.addResult(cmr);
  Skeleton.getSkeleton(appMetadata).setReturnValue(new MethodCall(ApplicationMetadata.class,"getApplicationContents"),Arrays.asList(mockContent("test.api","1.1.0"),mockContent("test.consumer","1.0.0"),mockContent("test.provider","1.0.0")));
  Skeleton.getSkeleton(appMetadata).setReturnValue(new MethodCall(ApplicationMetadata.class,"getUseBundles"),Arrays.asList(mockContent("test.api","1.0.0")));
  app=Skeleton.newMock(AriesApplication.class);
  Skeleton.getSkeleton(app).setReturnValue(new MethodCall(AriesApplication.class,"getApplicationMetadata"),appMetadata);
  DeployedBundles deployedBundles=deplMFMgr.generateDeployedBundles(appMetadata,Arrays.asList(new ModelledResource[]{cmr.get(0),cmr.get(2),cmr.get(3)}),new ArrayList<Content>());
  Manifest mf=deplMFMgr.generateDeploymentManifest(appMetadata.getApplicationSymbolicName(),appMetadata.getApplicationVersion().toString(),deployedBundles);
  mf.write(System.out);
  assertTrue(mf.getMainAttributes().getValue("Deployed-Content").contains("test.api;deployed-version=1.1.0"));
  assertTrue(mf.getMainAttributes().getValue("Deployed-Use-Bundle").contains("test.api;deployed-version=1.0.0"));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Similar to the checkBundleInAppContentAndProvisionContent scenario. However, this time the provisioned bundle does not provide
 * a package or service to the isolated content, so there is no problem.
 * @throws Exception
 */
@Test public void checkBundleInAppContentAndProvisionContentButNothingSharedToIsolatedContent() throws Exception {
  List<ModelledResource> cmr=new ArrayList<ModelledResource>();
  cmr.add(createModelledResource("test.util","1.1.0",Collections.<String>emptyList(),Arrays.asList("test.api.pack;version=1.1.0")));
  cmr.add(createModelledResource("test.bundle","1.0.0",Arrays.asList("test.api.pack;version=\"[1.1.0,2.0.0)\""),Collections.<String>emptyList()));
  cmr.add(createModelledResource("test.provisioned","1.0.0",Arrays.asList("test.api.pack;version=\"[1.0.0,1.1.0)\""),Collections.<String>emptyList()));
  cmr.add(createModelledResource("test.util","1.0.0",Collections.<String>emptyList(),Arrays.asList("test.api.pack;version=1.0.0")));
  _resolver.addResult(cmr);
  Skeleton.getSkeleton(appMetadata).setReturnValue(new MethodCall(ApplicationMetadata.class,"getApplicationContents"),Arrays.asList(mockContent("test.util","1.1.0"),mockContent("test.bundle","1.0.0")));
  app=Skeleton.newMock(AriesApplication.class);
  Skeleton.getSkeleton(app).setReturnValue(new MethodCall(AriesApplication.class,"getApplicationMetadata"),appMetadata);
  DeployedBundles deployedBundles=deplMFMgr.generateDeployedBundles(appMetadata,Arrays.asList(new ModelledResource[]{cmr.get(0),cmr.get(1)}),new ArrayList<Content>());
  Manifest mf=deplMFMgr.generateDeploymentManifest(appMetadata.getApplicationSymbolicName(),appMetadata.getApplicationVersion().toString(),deployedBundles);
  assertTrue(mf.getMainAttributes().getValue("Deployed-Content").contains("test.util;deployed-version=1.1.0"));
  assertTrue(mf.getMainAttributes().getValue("Provision-Bundle").contains("test.util;deployed-version=1.0.0"));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve() throws Exception {
  Skeleton.getSkeleton(appMetadata).setReturnValue(new MethodCall(ApplicationMetadata.class,"getApplicationContents"),Arrays.asList(mockContent("aries.test.a","1.0.0"),mockContent("aries.test.b","[1.0.0, 2.0.0)")));
  Skeleton.getSkeleton(appMetadata).setReturnValue(new MethodCall(ApplicationMetadata.class,"getUseBundles"),Arrays.asList(BUNDLE_C,BUNDLE_D));
  DeployedBundles deployedBundles=deplMFMgr.generateDeployedBundles(appMetadata,new ArrayList<ModelledResource>(),Collections.<Content>emptyList());
  Manifest man=deplMFMgr.generateDeploymentManifest(appMetadata.getApplicationSymbolicName(),appMetadata.getApplicationVersion().toString(),deployedBundles);
  Attributes attrs=man.getMainAttributes();
  assertEquals("aries.test",attrs.getValue(AppConstants.APPLICATION_SYMBOLIC_NAME));
  assertEquals("1.0.0",attrs.getValue(AppConstants.APPLICATION_VERSION));
  String content=attrs.getValue(AppConstants.DEPLOYMENT_CONTENT);
  String useBundle=attrs.getValue(AppConstants.DEPLOYMENT_USE_BUNDLE);
  String provisioned=attrs.getValue(AppConstants.DEPLOYMENT_PROVISION_BUNDLE);
  assertTrue(content.contains("aries.test.a;deployed-version=1.0.0"));
  assertTrue(content.contains("aries.test.b;deployed-version=1.1.0"));
  assertTrue(useBundle.contains("aries.test.c;deployed-version=1.0.5"));
  assertFalse(useBundle.contains("aries.test.d"));
  assertTrue(provisioned.contains("aries.test.e;deployed-version=1.0.0"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.management.impl.AriesApplicationManagerImplTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  AriesApplication app=createApplication(TEST_EBA);
  ApplicationMetadata appMeta=app.getApplicationMetadata();
  assertEquals(appMeta.getApplicationName(),"Test application");
  assertEquals(appMeta.getApplicationSymbolicName(),"org.apache.aries.application.management.test");
  assertEquals(appMeta.getApplicationVersion(),new Version("1.0"));
  List<Content> appContent=appMeta.getApplicationContents();
  assertEquals(appContent.size(),2);
  Content fbw=new ContentImpl("foo.bar.widgets;version=1.0.0");
  Content mbl=new ContentImpl("my.business.logic;version=1.0.0");
  assertTrue(appContent.contains(fbw));
  assertTrue(appContent.contains(mbl));
  DeploymentMetadata dm=app.getDeploymentMetadata();
  List<DeploymentContent> dcList=dm.getApplicationDeploymentContents();
  assertEquals(2,dcList.size());
  DeploymentContent dc1=new DeploymentContentImpl("foo.bar.widgets;deployed-version=1.1.0");
  DeploymentContent dc2=new DeploymentContentImpl("my.business.logic;deployed-version=1.1.0");
  DeploymentContent dc3=new DeploymentContentImpl("a.handy.persistence.library;deployed-version=1.1.0");
  assertTrue(dcList.contains(dc1));
  assertTrue(dcList.contains(dc2));
  dcList=dm.getApplicationProvisionBundles();
  assertEquals(1,dcList.size());
  assertTrue(dcList.contains(dc3));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAndConversion() throws Exception {
  AriesApplication app=createApplication(CONVERSION_EBA);
  ApplicationMetadata appMeta=app.getApplicationMetadata();
  assertEquals(appMeta.getApplicationName(),"conversion.eba");
  assertEquals(appMeta.getApplicationSymbolicName(),"conversion.eba");
  assertEquals(appMeta.getApplicationVersion(),new Version("0.0"));
  List<Content> appContent=appMeta.getApplicationContents();
  assertEquals(2,appContent.size());
  Content fbw=new ContentImpl("hello.world.jar;version=\"[1.1.0, 1.1.0]\"");
  Content mbl=new ContentImpl("helloWorld.war;version=\"[0.0.0, 0.0.0]\"");
  assertTrue(appContent.contains(fbw));
  assertTrue(appContent.contains(mbl));
  DeploymentMetadata dm=app.getDeploymentMetadata();
  List<DeploymentContent> dcList=dm.getApplicationDeploymentContents();
  assertEquals(2,dcList.size());
  DeploymentContent dc1=new DeploymentContentImpl("hello.world.jar;deployed-version=1.1.0");
  DeploymentContent dc2=new DeploymentContentImpl("helloWorld.war;deployed-version=0.0.0");
  DeploymentContent dc3=new DeploymentContentImpl("a.handy.persistence.library;deployed-version=1.1.0");
  assertTrue(dcList.contains(dc1));
  assertTrue(dcList.contains(dc2));
  dcList=dm.getApplicationProvisionBundles();
  assertEquals(1,dcList.size());
  assertTrue(dcList.contains(dc3));
  assertEquals(2,app.getBundleInfo().size());
  BundleInfo info;
  info=findBundleInfo(app.getBundleInfo(),"hello.world.jar");
  assertNotNull(info);
  assertEquals("HelloWorldJar",info.getHeaders().get(Constants.BUNDLE_NAME));
  info=findBundleInfo(app.getBundleInfo(),"helloWorld.war");
  assertNotNull(info);
  assertEquals("helloWorld.war",info.getHeaders().get(Constants.BUNDLE_NAME));
  assertEquals("/test",info.getHeaders().get("Bundle-ContextPath"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedUpdate() throws Exception {
  AriesApplication app=createApplication(TEST_EBA);
  DeploymentMetadata depMf=createUpdateDepMf();
  AriesApplicationContext ctx=Skeleton.newMock(AriesApplicationContext.class);
  Skeleton.getSkeleton(ctx).setReturnValue(new MethodCall(AriesApplicationContext.class,"getApplication"),app);
  AriesApplicationContextManager ctxMgr=Skeleton.newMock(AriesApplicationContextManager.class);
  Skeleton.getSkeleton(ctxMgr).setReturnValue(new MethodCall(AriesApplicationContextManager.class,"getApplicationContexts"),Collections.singleton(ctx));
  Skeleton.getSkeleton(ctxMgr).setThrows(new MethodCall(AriesApplicationContextManager.class,"update",AriesApplication.class,DeploymentMetadata.class),new UpdateException("",null,false,null));
  _appMgr.setApplicationContextManager(ctxMgr);
  try {
    _appMgr.update(app,depMf);
    fail("Update should have failed.");
  }
 catch (  UpdateException e) {
    assertTrue("Deployment.mf should have been updated",app.getDeploymentMetadata() == depMf);
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testUpdate() throws Exception {
  AriesApplication app=createApplication(TEST_EBA);
  DeploymentMetadata depMf=createUpdateDepMf();
  AriesApplicationContextManager ctxMgr=Skeleton.newMock(AriesApplicationContextManager.class);
  _appMgr.setApplicationContextManager(ctxMgr);
  _appMgr.update(app,depMf);
  assertTrue("Deployment.mf should have been updated",app.getDeploymentMetadata() == depMf);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRolledbackUpdate() throws Exception {
  AriesApplication app=createApplication(TEST_EBA);
  DeploymentMetadata depMf=createUpdateDepMf();
  DeploymentMetadata oldMf=app.getDeploymentMetadata();
  AriesApplicationContext ctx=Skeleton.newMock(AriesApplicationContext.class);
  Skeleton.getSkeleton(ctx).setReturnValue(new MethodCall(AriesApplicationContext.class,"getApplication"),app);
  AriesApplicationContextManager ctxMgr=Skeleton.newMock(AriesApplicationContextManager.class);
  Skeleton.getSkeleton(ctxMgr).setReturnValue(new MethodCall(AriesApplicationContextManager.class,"getApplicationContexts"),Collections.singleton(ctx));
  Skeleton.getSkeleton(ctxMgr).setThrows(new MethodCall(AriesApplicationContextManager.class,"update",AriesApplication.class,DeploymentMetadata.class),new UpdateException("",null,true,null));
  _appMgr.setApplicationContextManager(ctxMgr);
  try {
    _appMgr.update(app,depMf);
    fail("Update should have failed.");
  }
 catch (  UpdateException e) {
    assertTrue("Deployment.mf should have been rolled back to the old",app.getDeploymentMetadata() == oldMf);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreAndReload() throws Exception {
  AriesApplication app=createApplication(TEST_EBA);
  File dest=new File("ariesApplicationManagerImplTest/stored.eba");
  app.store(dest);
  IDirectory storedEba=FileSystem.getFSRoot(dest);
  assertNotNull(storedEba);
  assertEquals(storedEba.listFiles().size(),3);
  IFile ifile=storedEba.getFile("META-INF/APPLICATION.MF");
  assertNotNull(ifile);
  ifile=storedEba.getFile("META-INF/DEPLOYMENT.MF");
  assertNotNull(ifile);
  ifile=storedEba.getFile("foo.bar.widgets.jar");
  assertNotNull(ifile);
  ifile=storedEba.getFile("my.business.logic.jar");
  assertNotNull(ifile);
  AriesApplication newApp=_appMgr.createApplication(storedEba);
  DeploymentMetadata dm=newApp.getDeploymentMetadata();
  assertEquals(2,dm.getApplicationDeploymentContents().size());
  assertEquals(1,dm.getApplicationProvisionBundles().size());
  assertEquals(dm.getApplicationSymbolicName(),app.getApplicationMetadata().getApplicationSymbolicName());
  assertEquals(dm.getApplicationVersion(),app.getApplicationMetadata().getApplicationVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.modelling.impl.ParserProxyTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void checkMultiValues() throws Exception {
  File bpXml=new File(resourceDir,"appModeller/test1.eba/bundle1.jar/OSGI-INF/blueprint/bpMultiValues.xml");
  List<WrappedServiceMetadata> services=new ArrayList<WrappedServiceMetadata>();
  FileInputStream fis=new FileInputStream(bpXml);
  ParsedServiceElements bpelem=_parserProxy.parseAllServiceElements(fis);
  services.addAll(bpelem.getServices());
  assertEquals("Multi valued service not parsed correctly",services.size(),1);
  WrappedServiceMetadata wsm=services.get(0);
  Map<String,Object> props=wsm.getServiceProperties();
  String[] intents=(String[])props.get("service.intents");
  assertEquals("Service.intents[0] wrong",intents[0],"propagatesTransaction");
  assertEquals("Service.intents[1] wrong",intents[1],"confidentiality");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.modelling.utils.AbstractBundleResourceTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleResource() throws Exception {
  assertEquals("The bundle symbolic name is wrong.","test.bundle1",bundleResource.getSymbolicName());
  assertEquals("The bundle version is wrong.","2.0.0.build-121",bundleResource.getVersion().toString());
  assertEquals("The bundle presentation name is wrong.","Test Bundle",bundleResource.getExportedBundle().getAttributes().get(ModellingConstants.OBR_PRESENTATION_NAME));
  int count=0;
  for (  ImportedPackage ip : bundleResource.getImportedPackages()) {
    String filter=ip.getAttributeFilter();
    Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
    if (ip.getPackageName().equals("org.osgi.framework")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"org.osgi.framework");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"1.3.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.kernel.file")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.kernel.file");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.wsspi.application.aries")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.wsspi.application.aries");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
      assertEquals("Company wrong",parsedFilterElements.get("company"),"yang");
      assertTrue("mandatory filter missing",filter.contains("(mandatory:<*company)"));
    }
 else     if (ip.getPackageName().equals("aries.ws.ffdc")) {
      count++;
      assertEquals("The filter is wrong.","(&(package=aries.ws.ffdc)(version>=0.0.0))",ip.getAttributeFilter());
      assertTrue("Optional import not correctly represented",ip.isOptional());
    }
 else     if (ip.getPackageName().equals("aries.ws.app.framework.plugin")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.app.framework.plugin");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"[1.0.0,2.0.0)");
    }
 else     if (ip.getPackageName().equals("aries.ejs.ras")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ejs.ras");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.event")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.event");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"1.0.0");
    }
 else     if (ip.getPackageName().equals("aries.wsspi.app.container.aries")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.wsspi.app.container.aries");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("bundle-symbolic-name"),"B");
      assertEquals("Wrong bundle version",parsedFilterElements.get("bundle-version"),"[1.2.0,2.2.0)");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bla")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bla");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.launcher")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.launcher");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"[1.0.0,2.0.0]");
      assertTrue("Dynamic-ImportPackage should be optional",ip.isOptional());
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle4")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle4");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle5")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle5");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle6")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle6");
      assertEquals("The filter is wrong.","(&(package=aries.ws.eba.bundle6)(version>=0.0.0))",ip.getAttributeFilter());
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle7")) {
      count++;
      assertEquals("The filter is wrong.","(&(package=aries.ws.eba.bundle7)(version>=0.0.0))",ip.getAttributeFilter());
    }
  }
  for (  ImportedBundle ib : bundleResource.getRequiredBundles()) {
    String filter=ib.getAttributeFilter();
    Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
    if (ib.getSymbolicName().equals("com.acme.facade")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.acme.facade");
      assertEquals("Wrong bundle version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ib.getSymbolicName().equals("com.acme.bar")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.acme.bar");
    }
 else     if (ib.getSymbolicName().equals("aries.ws.eba.framework")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"aries.ws.eba.framework");
      assertEquals("Wrong bundle version",parsedFilterElements.get("version"),"(3.0.0,4.0.0)");
    }
 else     if (ib.getSymbolicName().equals("com.de.ba")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.de.ba");
    }
 else     if (ib.getSymbolicName().equals("com.ab.de")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.ab.de");
    }
  }
  for (  ImportedService svc : bundleResource.getImportedServices()) {
    if (svc.getInterface().equals("aries.ws.eba.import")) {
      count++;
      String filter=svc.getAttributeFilter();
      Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
      assertEquals("Wrong object class",parsedFilterElements.get("objectClass"),"aries.ws.eba.import");
      assertTrue("(service=service) should be present",svc.getAttributeFilter().contains("(service=service)"));
      assertTrue("(mandatory:<*service) should be present",svc.getAttributeFilter().contains("(mandatory:<*service)"));
    }
  }
  assertEquals("Not all requirements are listed.",bundleResource.getImportedPackages().size() + bundleResource.getImportedServices().size() + bundleResource.getRequiredBundles().size(),count);
  int verifiedExport=0;
  for (  ExportedPackage cap : bundleResource.getExportedPackages()) {
    if (cap.getPackageName().equals("aries.ws.eba.bundle1")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","2.2.0",cap.getVersion());
      assertEquals("The export package is not expected.","test.bundle1",cap.getAttributes().get("bundle-symbolic-name"));
      assertEquals("The export package is not expected.","2.0.0.build-121",cap.getAttributes().get("bundle-version").toString());
    }
 else     if (cap.getPackageName().equals("aries.ws.eba.bundle2")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","3",cap.getVersion());
    }
 else     if (cap.getPackageName().equals("aries.ws.eba.bundle3")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","3",cap.getVersion());
    }
  }
  assertEquals("The number of exports are not expected.",bundleResource.getExportedPackages().size(),verifiedExport);
  assertEquals("The bundle resource is wrong.","Test Bundle",bundleResource.getExportedBundle().getAttributes().get(ModellingConstants.OBR_PRESENTATION_NAME));
  assertEquals("The bundle resource is wrong.","2.0.0.build-121",bundleResource.getExportedBundle().getVersion());
  assertEquals("The bundle resource is wrong.","test.bundle1",bundleResource.getExportedBundle().getSymbolicName());
  for (  ExportedService svc : bundleResource.getExportedServices()) {
    assertEquals("The export service is wrong","aries.ws.eba.export",svc.getInterfaces().iterator().next());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.modelling.utils.ExportedPackageTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsForIdenticalPackages(){
  String packageName="package.name";
  String version="1.0.0";
  ExportedPackage package1=instantiatePackage(packageName,version);
  assertEquals(package1,package1);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForTrivialPackagesWithDifferentVersion(){
  String packageName="package.name";
  ExportedPackage package1=instantiatePackage(packageName,"1.0.0");
  ExportedPackage package2=instantiatePackage(packageName,"1.0.1");
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsForEqualTrivialPackages(){
  String packageName="package.name";
  String version="1.0.0";
  ExportedPackage package1=instantiatePackage(packageName,version);
  ExportedPackage package2=instantiatePackage(packageName,version);
  assertEquals(package1,package2);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForTrivialPackagesWithDifferentName(){
  String version="1.0.0";
  ExportedPackage package1=instantiatePackage("package.name",version);
  ExportedPackage package2=instantiatePackage("other.package.name",version);
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForEqualPackagesWithDifferentAttributes(){
  String packageName="package.name";
  String version="1.0.0";
  ExportedPackage package1=instantiatePackage(packageName,version,"att=something");
  ExportedPackage package2=instantiatePackage(packageName,version,"att=something.else");
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.modelling.utils.ImportedPackageTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsForIdenticalPackages() throws InvalidAttributeException {
  String packageName="package.name";
  String version="1.0.0";
  ImportedPackage package1=instantiatePackage(packageName,version);
  assertEquals(package1,package1);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForTrivialPackagesWithDifferentVersion() throws InvalidAttributeException {
  String packageName="package.name";
  ImportedPackage package1=instantiatePackage(packageName,"1.0.0");
  ImportedPackage package2=instantiatePackage(packageName,"1.0.1");
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForTrivialPackagesWithDifferentName() throws InvalidAttributeException {
  String version="1.0.0";
  ImportedPackage package1=instantiatePackage("package.name",version);
  ImportedPackage package2=instantiatePackage("other.package.name",version);
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForEqualPackagesWithDifferentAttributes() throws InvalidAttributeException {
  String packageName="package.name";
  String version="1.0.0";
  ImportedPackage package1=instantiatePackage(packageName,version,"att=something");
  ImportedPackage package2=instantiatePackage(packageName,version,"att=something.else");
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsForEqualTrivialPackages() throws InvalidAttributeException {
  String packageName="package.name";
  String version="1.0.0";
  ImportedPackage package1=instantiatePackage(packageName,version);
  ImportedPackage package2=instantiatePackage(packageName,version);
  assertEquals(package1,package2);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEqualsForTrivialPackagesWithDifferentVersionRanges() throws InvalidAttributeException {
  String packageName="package.name";
  ImportedPackage package1=instantiatePackage(packageName,"[1.0.0, 4.4.4)");
  ImportedPackage package2=instantiatePackage(packageName,"[1.0.0, 4.4.2)");
  assertFalse("Unexpectedly reported as equal" + package1 + "=="+ package2,package1.equals(package2));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsForEqualPackagesWithVersionRange() throws InvalidAttributeException {
  String packageName="package.name";
  String version="[1.0.0, 1.6.3)";
  ImportedPackage package1=instantiatePackage(packageName,version);
  ImportedPackage package2=instantiatePackage(packageName,version);
  assertEquals(package1,package2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.resolver.obr.impl.AriesResolverTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeftRedundant(){
  resolverMock.res("com.ibm.test","0.0.0").req("a").req("b").res("com.ibm.test","1.0.0").req("a").req("b").req("c");
  List<Resource> res=retrieveRequiredResources(resolver);
  assertEquals(1,res.size());
  assertResource(res.get(0),"com.ibm.test","1.0.0");
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIncompatible(){
  resolverMock.res("com.ibm.test","0.0.0").req("a").req("b").res("com.ibm.test","1.0.0").req("a").req("c");
  List<Resource> res=retrieveRequiredResources(resolver);
  assertEquals(2,res.size());
  assertResource(res.get(0),"com.ibm.test","0.0.0");
  assertResource(res.get(1),"com.ibm.test","1.0.0");
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEquivalent(){
  resolverMock.res("com.ibm.test","0.0.0").req("a").req("b").res("com.ibm.test","2.0.0").req("a").req("b").res("com.ibm.test","1.0.0").req("a").req("b");
  List<Resource> res=retrieveRequiredResources(resolver);
  assertEquals(1,res.size());
  assertResource(res.get(0),"com.ibm.test","2.0.0");
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRightRedundant(){
  resolverMock.res("com.ibm.test","0.0.0").req("a").req("b").req("c").res("com.ibm.test","1.0.0").req("a").req("c");
  List<Resource> res=retrieveRequiredResources(resolver);
  assertEquals(1,res.size());
  assertResource(res.get(0),"com.ibm.test","0.0.0");
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEquivalentWithOptionals(){
  resolverMock.res("com.ibm.test","1.0.0").req("a").req("b").req("bundle").res("com.ibm.test","1.1.0").req("a").req("b").req("c").optional();
  List<Resource> res=retrieveRequiredResources(resolver);
  assertEquals(1,res.size());
  assertResource(res.get(0),"com.ibm.test","1.0.0");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.runtime.itests.OBRResolverAdvancedTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDemoApp() throws Exception {
  System.setProperty(AppConstants.PROVISON_EXCLUDE_LOCAL_REPO_SYSPROP,"true");
  generateOBRRepoXML(false,TRANSITIVE_BUNDLE_BY_REFERENCE + ".jar",CORE_BUNDLE_BY_REFERENCE + ".jar",USE_BUNDLE_BY_REFERENCE + ".jar");
  RepositoryAdmin repositoryAdmin=context().getService(RepositoryAdmin.class);
  Repository[] repos=repositoryAdmin.listRepositories();
  for (  Repository repo : repos) {
    repositoryAdmin.removeRepository(repo.getURI());
  }
  repositoryAdmin.addRepository(new File("repository.xml").toURI().toURL());
  AriesApplicationManager manager=context().getService(AriesApplicationManager.class);
  AriesApplication app=manager.createApplication(FileSystem.getFSRoot(new File("demo.eba")));
  app=manager.resolve(app);
  DeploymentMetadata depMeta=app.getDeploymentMetadata();
  List<DeploymentContent> provision=depMeta.getApplicationProvisionBundles();
  Collection<DeploymentContent> useBundles=depMeta.getDeployedUseBundle();
  Collection<Content> importPackages=depMeta.getImportPackage();
  assertEquals(provision.toString(),2,provision.size());
  assertEquals(useBundles.toString(),1,useBundles.size());
  assertEquals(importPackages.toString(),4,importPackages.size());
  List<String> bundleSymbolicNames=new ArrayList<String>();
  for (  DeploymentContent dep : provision) {
    bundleSymbolicNames.add(dep.getContentName());
  }
  assertTrue("Bundle " + TRANSITIVE_BUNDLE_BY_REFERENCE + " not found.",bundleSymbolicNames.contains(TRANSITIVE_BUNDLE_BY_REFERENCE));
  assertTrue("Bundle " + TRANSITIVE_BUNDLE_BY_VALUE + " not found.",bundleSymbolicNames.contains(TRANSITIVE_BUNDLE_BY_VALUE));
  bundleSymbolicNames.clear();
  for (  DeploymentContent dep : useBundles) {
    bundleSymbolicNames.add(dep.getContentName());
  }
  assertTrue("Bundle " + USE_BUNDLE_BY_REFERENCE + " not found.",bundleSymbolicNames.contains(USE_BUNDLE_BY_REFERENCE));
  Collection<String> packages=new ArrayList<String>();
  Map<String,String> maps=new HashMap<String,String>();
  maps.put("version","0.0.0");
  maps.put("bundle-symbolic-name","use.bundle.by.reference");
  maps.put("bundle-version","[1.0.0,1.0.0]");
  Content useContent=ContentFactory.parseContent("a.b.c",maps);
  assertTrue("Use Bundle not found in import packags",importPackages.contains(useContent));
  for (  Content c : importPackages) {
    packages.add(c.getContentName());
  }
  assertTrue("package javax.naming not found",packages.contains("javax.naming"));
  assertTrue("package p.q.r not found",packages.contains("p.q.r"));
  assertTrue("package x.y.z not found",packages.contains("x.y.z"));
  assertTrue("package a.b.c not found",packages.contains("a.b.c"));
  AriesApplicationContext ctx=manager.install(app);
  ctx.start();
  Set<Bundle> bundles=ctx.getApplicationContent();
  assertEquals("Number of bundles provisioned in the app",5,bundles.size());
  ctx.stop();
  manager.uninstall(ctx);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.runtime.itests.UpdateAppTest </h4><pre class="type-4 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testFineUpdate() throws Exception {
  AriesApplicationManager manager=context().getService(AriesApplicationManager.class);
  AriesApplication app=setupApp();
  BundleContext oldCtx=IsolationTestUtils.findIsolatedAppBundleContext(bundleContext,SAMPLE_APP_NAME);
  installMockUpdateStrategy();
  updateApp(manager,app);
  BundleContext newCtx=IsolationTestUtils.findIsolatedAppBundleContext(bundleContext,SAMPLE_APP_NAME);
  assertAppMessage("hello brave new world");
  assertTrue("We bounced the app where the update was supposed to do an update in place",oldCtx == newCtx);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-1 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testUpdateThenStart() throws Exception {
  AriesApplicationManager manager=context().getService(AriesApplicationManager.class);
  AriesApplication app=manager.createApplication(FileSystem.getFSRoot(new File("test.eba")));
  AriesApplicationContext ctx=manager.install(app);
  app=ctx.getApplication();
  BundleContext oldCtx=IsolationTestUtils.findIsolatedAppBundleContext(bundleContext,SAMPLE_APP_NAME);
  installMockUpdateStrategy();
  ctx=updateApp(manager,app);
  BundleContext newCtx=IsolationTestUtils.findIsolatedAppBundleContext(bundleContext,SAMPLE_APP_NAME);
  assertNull("App is not started yet but HelloWorld service is already there",IsolationTestUtils.findHelloWorldService(bundleContext,SAMPLE_APP_NAME));
  ctx.start();
  assertAppMessage("hello brave new world");
  assertTrue("We bounced the app where the update was supposed to do an update in place",oldCtx == newCtx);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.utils.manifest.ManifestProcessorTest </h4><pre class="type-4 type-3 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check a simple manifest can be read.
 * @throws Exception
 */
@Test public void testSimpleManifest() throws Exception {
  Map<String,String> pairs=new HashMap<String,String>();
  pairs.put("Manifest-Version","1.0");
  pairs.put("Application-ManifestVersion","1.0");
  pairs.put("Application-Name",appName);
  pairs.put("Application-SymbolicName","com.travel.reservation");
  pairs.put("Application-Version","1.2");
  pairs.put("Application-Content","com.travel.reservation.web;version=\"[1.1.0,1.2.0)\",com.travel.reservation.business");
  pairs.put("Export-Package","com.travel.reservation.api;version=1.2");
  pairs.put("Import-Package","com.travel.flight.api;version=\"[2.1.1,3.0.0)\",com.travel.rail.api;version=\"[1.0.0,2.0.0)\"");
  pairs.put("Application-Services","services.xml");
  InputStream in=getClass().getClassLoader().getResourceAsStream("META-INF/APPLICATION.MF");
  Manifest mf=new Manifest(in);
  Map<String,String> map=ManifestProcessor.readManifestIntoMap(mf);
  assertNotNull(map);
  for (  String key : pairs.keySet()) {
    assertTrue("Key: " + key + " was not found",map.containsKey(key));
    String value=map.get(key);
    assertNotNull("Value was not present for key: " + key,value);
    assertEquals("Value was not correct for key: " + key,pairs.get(key),value);
  }
  assertEquals("The maps did not match",pairs,map);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.async.promise.test.ChainTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThenSuccessFailed() throws Exception {
  Deferred<String> def=new Deferred<String>();
  final Promise<String> promise=def.getPromise();
  final Throwable thenFail=new Throwable("failed!");
  Promise<String> chain=promise.then(new Success<String,String>(){
    @Override public Promise<String> call(    Promise<String> resolved) throws Exception {
      return Promises.failed(thenFail);
    }
  }
);
  assertFalse("chain not resolved",chain.isDone());
  def.resolve("ok");
  assertTrue("chain resolved",chain.isDone());
  assertEquals("chain failure matches",thenFail,chain.getFailure());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExampleChain() throws Exception {
  Success<String,String> doubler=new Success<String,String>(){
    public Promise<String> call(    Promise<String> p) throws Exception {
      return Promises.resolved(p.getValue() + p.getValue());
    }
  }
;
  Deferred<String> def=new Deferred<String>();
  final Promise<String> foo=def.getPromise().then(doubler).then(doubler);
  def.resolve("hello!");
  assertEquals("doubler matches","hello!hello!hello!hello!",foo.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.async.promise.test.FunctionTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws Exception {
  String bigValue=new String("value");
  Promise<String> p1=Promises.resolved(bigValue);
  Promise<String> p2=p1.filter(new Predicate<String>(){
    public boolean test(    String t){
      return t.length() > 0;
    }
  }
);
  assertTrue("Filter2 resolved",p2.isDone());
  assertEquals("Value2 matches",bigValue,p2.getValue());
  Promise<String> p3=p1.filter(new Predicate<String>(){
    public boolean test(    String t){
      return t.length() == 0;
    }
  }
);
  assertTrue("Filter3 resolved",p3.isDone());
  assertTrue("Value3 fail matches",p3.getFailure() instanceof NoSuchElementException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.async.promise.test.PromisesTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailed() throws Exception {
  Exception failed=new Exception("Failed");
  final Promise<String> promise=Promises.failed(failed);
  assertTrue("Promise resolved",promise.isDone());
  assertEquals("Value matches",failed,promise.getFailure());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.BlueprintContainerTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimple() throws Exception {
  URL url=getClass().getClassLoader().getResource("test.xml");
  BlueprintContainerImpl container=new BlueprintContainerImpl(getClass().getClassLoader(),Arrays.asList(url));
  Foo foo=(Foo)container.getComponentInstance("foo");
  System.out.println(foo);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals(1,foo.getB());
  container.destroy();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlaceholders() throws Exception {
  URL url1=getClass().getClassLoader().getResource("test.xml");
  URL url2=getClass().getClassLoader().getResource("test2.xml");
  BlueprintContainerImpl container=new BlueprintContainerImpl(getClass().getClassLoader(),Arrays.asList(url1,url2));
  Foo foo=(Foo)container.getComponentInstance("foo");
  System.out.println(foo);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals(1,foo.getB());
  container.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.container.BeanRecipeTest </h4><pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parameterLessHiding() throws Exception {
  Set<Method> methods=new HashSet<Method>(Arrays.asList(Base.class.getMethod("getObject"),Middle.class.getMethod("getObject"),Top.class.getMethod("getObject"),Unrelated.class.getMethod("getObject")));
  methods=applyStaticHidingRules(methods);
  assertEquals(2,methods.size());
  assertTrue(methods.contains(Top.class.getMethod("getObject")));
  assertTrue(methods.contains(Unrelated.class.getMethod("getObject")));
  assertFalse(methods.contains(Middle.class.getMethod("getObject")));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parameterDistinction() throws Exception {
  Set<Method> methods=new HashSet<Method>(Arrays.asList(Base.class.getMethod("getOne",Object.class),Middle.class.getMethod("getOne",Number.class),Middle.class.getMethod("getOne",Object.class),Top.class.getMethod("getOne",Integer.class)));
  methods=applyStaticHidingRules(methods);
  assertEquals(3,methods.size());
  assertFalse(methods.contains(Base.class.getMethod("getOne",Object.class)));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void baseTypeHiding() throws Exception {
  Set<Method> methods=new HashSet<Method>(Arrays.asList(Middle.class.getMethod("getBasic",int.class),Top.class.getMethod("getBasic",int.class),Unrelated.class.getMethod("getBasic",int.class)));
  methods=applyStaticHidingRules(methods);
  assertEquals(2,methods.size());
  assertFalse(methods.contains(Middle.class.getMethod("getBasic",int.class)));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiParameterTest() throws Exception {
  Set<Method> methods=new HashSet<Method>(Arrays.asList(Base.class.getMethod("getMany",Object.class,String.class,String.class),Middle.class.getMethod("getMany",Object.class,String.class,Number.class),Top.class.getMethod("getMany",Object.class,String.class,Number.class)));
  methods=applyStaticHidingRules(methods);
  assertEquals(2,methods.size());
  assertFalse(methods.contains(Middle.class.getMethod("getMany",Object.class,String.class,Number.class)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.itests.SpringTest </h4><pre class="type-4 type-5 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSpringBundle() throws Exception {
  Bundle bundles=context().getBundleByName("org.apache.aries.blueprint.testbundles");
  assertNotNull(bundles);
  bundles.start();
  BlueprintContainer container=startBundleBlueprint("org.apache.aries.blueprint.testbundles");
  List list=(List)container.getComponentInstance("springList");
  System.out.println(list);
  BeanCItf beanC=(BeanCItf)list.get(4);
  assertEquals(1,beanC.getInitialized());
  try {
    beanC.doSomething();
    fail("Should have thrown an exception because the transaction manager is not defined");
  }
 catch (  NoSuchBeanDefinitionException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.itests.TestReferences </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListReferences() throws Exception {
  BlueprintContainer blueprintContainer=Helper.getBlueprintContainerForBundle(context(),"org.apache.aries.blueprint.sample");
  assertNotNull(blueprintContainer);
  BindingListener listener=(BindingListener)blueprintContainer.getComponentInstance("listBindingListener");
  assertNull(listener.getA());
  assertNull(listener.getReference());
  List<?> refs=(List<?>)blueprintContainer.getComponentInstance("ref-list");
  assertNotNull(refs);
  assertTrue(refs.isEmpty());
  InterfaceA testService=new InterfaceA(){
    public String hello(    String msg){
      return "Hello " + msg + "!";
    }
  }
;
  bundleContext.registerService(InterfaceA.class.getName(),testService,null);
  waitForAsynchronousHandling();
  assertNotNull(listener.getA());
  assertNotNull(listener.getReference());
  assertEquals(1,refs.size());
  InterfaceA a=(InterfaceA)refs.get(0);
  assertNotNull(a);
  assertEquals("Hello world!",a.hello("world"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.itests.cm.ManagedServiceFactoryTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory2",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  @SuppressWarnings("rawtypes") ServiceReference sr=getServiceRef(Foo.class,"(key=foo2)");
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertNull(sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("foo",foo.getB());
  assertNull(sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFactoryCreation() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory5",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  @SuppressWarnings("rawtypes") ServiceReference sr=getServiceRef(Foo.class,"(key=foo5)");
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory3",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  @SuppressWarnings("rawtypes") ServiceReference sr=getServiceRef(Foo.class,"(&(key=foo3)(a=5))");
  assertNotNull(sr);
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("foo",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertEquals("foo",sr.getProperty("b"));
  cf.delete();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  @SuppressWarnings("rawtypes") ServiceReference sr=getServiceRef(Foo.class,"(key=foo1)");
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testCreateAndUpdateUsingUpdateMethod() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory4",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  Configuration cf2=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory4",null);
  Hashtable<String,String> props2=new Hashtable<String,String>();
  props2.put("a","7");
  cf2.update(props2);
  ServiceReference sr=getServiceRef(Foo.class,"(&(key=foo4)(a=5))");
  ServiceReference sr2=getServiceRef(Foo.class,"(&(key=foo4)(a=7))");
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  Foo foo2=(Foo)context().getService(sr2);
  assertNotNull(foo2);
  assertEquals(7,foo2.getA());
  assertEquals("default",foo2.getB());
  assertEquals("7",sr2.getProperty("a"));
  assertNull(sr2.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  props2=new Hashtable<String,String>();
  props2.put("a","7");
  props2.put("b","foo2");
  cf2.update(props2);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("foo",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertEquals("foo",sr.getProperty("b"));
  assertEquals(7,foo2.getA());
  assertEquals("foo2",foo2.getB());
  assertEquals("7",sr2.getProperty("a"));
  assertEquals("foo2",sr2.getProperty("b"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testCreateAndUpdate() throws Exception {
  Configuration cf=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory3",null);
  Hashtable<String,String> props=new Hashtable<String,String>();
  props.put("a","5");
  cf.update(props);
  Configuration cf2=ca.createFactoryConfiguration("blueprint-sample-managed-service-factory3",null);
  Hashtable<String,String> props2=new Hashtable<String,String>();
  props2.put("a","7");
  cf2.update(props2);
  ServiceReference sr=getServiceRef(Foo.class,"(&(key=foo3)(a=5))");
  ServiceReference sr2=getServiceRef(Foo.class,"(&(key=foo3)(a=7))");
  Foo foo=(Foo)context().getService(sr);
  assertNotNull(foo);
  assertEquals(5,foo.getA());
  assertEquals("default",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertNull(sr.getProperty("b"));
  Foo foo2=(Foo)context().getService(sr2);
  assertNotNull(foo2);
  assertEquals(7,foo2.getA());
  assertEquals("default",foo2.getB());
  assertEquals("7",sr2.getProperty("a"));
  assertNull(sr2.getProperty("b"));
  props=new Hashtable<String,String>();
  props.put("a","5");
  props.put("b","foo");
  cf.update(props);
  props2=new Hashtable<String,String>();
  props2.put("a","7");
  props2.put("b","foo2");
  cf2.update(props2);
  Thread.sleep(500);
  assertEquals(5,foo.getA());
  assertEquals("foo",foo.getB());
  assertEquals("5",sr.getProperty("a"));
  assertEquals("foo",sr.getProperty("b"));
  assertEquals(7,foo2.getA());
  assertEquals("foo2",foo2.getB());
  assertEquals("7",sr2.getProperty("a"));
  assertEquals("foo2",sr2.getProperty("b"));
  cf.delete();
  cf2.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.plugin.GeneratorTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGenerate() throws Exception {
  ClassFinder classFinder=new ClassFinder(this.getClass().getClassLoader());
  String packageName=MyBean1.class.getPackage().getName();
  Set<Class<?>> beanClasses=findClasses(classFinder,asList(packageName));
  Context context=new Context(beanClasses);
  context.resolve();
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  Set<String> namespaces=new HashSet<String>(Arrays.asList(Generator.NS_JPA,Generator.NS_TX));
  new Generator(context,os,namespaces).generate();
  System.out.println(os.toString("UTF-8"));
  document=readToDocument(os);
  xpath=XPathFactory.newInstance().newXPath();
  Node bean1=(Node)xpath.evaluate("/blueprint/bean[@id='myBean1']",document,XPathConstants.NODE);
  Assert.assertEquals(MyBean1.class.getName(),xpath.evaluate("@class",bean1));
  Assert.assertEquals("init",xpath.evaluate("@init-method",bean1));
  Assert.assertEquals("destroy",xpath.evaluate("@destroy-method",bean1));
  Assert.assertEquals("true",xpath.evaluate("@field-injection",bean1));
  Assert.assertEquals("",xpath.evaluate("@scope",bean1));
  NodeList txs=(NodeList)xpath.evaluate("transaction",bean1,XPathConstants.NODESET);
  Set<TransactionalDef> defs=new HashSet<TransactionalDef>();
  for (int i=0; i < txs.getLength(); ++i) {
    Node tx=txs.item(i);
    defs.add(new TransactionalDef(xpath.evaluate("@method",tx),xpath.evaluate("@value",tx)));
  }
  Set<TransactionalDef> expectedDefs=Sets.newHashSet(new TransactionalDef("*","RequiresNew"),new TransactionalDef("txNotSupported","NotSupported"),new TransactionalDef("txMandatory","Mandatory"),new TransactionalDef("txNever","Never"),new TransactionalDef("txRequired","Required"),new TransactionalDef("txOverridenWithRequiresNew","RequiresNew"),new TransactionalDef("txSupports","Supports"));
  Assert.assertEquals(expectedDefs,defs);
  Assert.assertEquals("person",xpath.evaluate("context/@unitname",bean1));
  Assert.assertEquals("em",xpath.evaluate("context/@property",bean1));
  Assert.assertEquals("person",xpath.evaluate("unit/@unitname",bean1));
  Assert.assertEquals("emf",xpath.evaluate("unit/@property",bean1));
  Assert.assertEquals("my1",xpath.evaluate("property[@name='bean2']/@ref",bean1));
  Node serviceAImpl2=(Node)xpath.evaluate("/blueprint/service[@ref='my2']",document,XPathConstants.NODE);
  Assert.assertEquals(ServiceA.class.getName(),xpath.evaluate("@interface",serviceAImpl2));
  Assert.assertEquals("",xpath.evaluate("@auto-export",serviceAImpl2));
  Assert.assertEquals("",xpath.evaluate("interfaces",serviceAImpl2));
  Node serviceAImpl3=(Node)xpath.evaluate("/blueprint/service[@ref='serviceAImpl3']",document,XPathConstants.NODE);
  Assert.assertEquals("",xpath.evaluate("@interface",serviceAImpl3));
  Assert.assertEquals("interfaces",xpath.evaluate("@auto-export",serviceAImpl3));
  Assert.assertEquals("",xpath.evaluate("interfaces",serviceAImpl3));
  Node serviceABImpl=(Node)xpath.evaluate("/blueprint/service[@ref='serviceABImpl']",document,XPathConstants.NODE);
  Assert.assertEquals("",xpath.evaluate("@interface",serviceABImpl));
  Assert.assertEquals("",xpath.evaluate("@auto-export",serviceABImpl));
  NodeList interfaceValues=(NodeList)xpath.evaluate("interfaces/value",serviceABImpl,XPathConstants.NODESET);
  Set<String> interfaceNames=new HashSet<String>();
  for (int i=0; i < interfaceValues.getLength(); ++i) {
    Node interfaceValue=interfaceValues.item(i);
    interfaceNames.add(interfaceValue.getTextContent());
  }
  Assert.assertEquals(Sets.newHashSet(ServiceA.class.getName(),ServiceB.class.getName()),interfaceNames);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.plugin.model.PropertyTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testNoProperty() throws XMLStreamException {
  Field field=TestBeanForRef.class.getDeclaredFields()[3];
  Property property=Property.create(null,field);
  Assert.assertNull("Should not be a property",property);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefInject() throws XMLStreamException {
  Field field=TestBeanForRef.class.getDeclaredFields()[0];
  Matcher matcher=new Matcher(){
    public Bean getMatching(    BeanRef template){
      return new Bean(ServiceAImpl1.class);
    }
  }
;
  Property property=Property.create(matcher,field);
  Assert.assertEquals("serviceA",property.name);
  Assert.assertNull("Value should be null",property.value);
  Assert.assertEquals("my1",property.ref);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefAutowired() throws XMLStreamException {
  Field field=TestBeanForRef.class.getDeclaredFields()[1];
  Matcher matcher=new Matcher(){
    public Bean getMatching(    BeanRef template){
      return null;
    }
  }
;
  Property property=Property.create(matcher,field);
  Assert.assertEquals("serviceB",property.name);
  Assert.assertNull("Value should be null",property.value);
  Assert.assertEquals("Should be default name as no match is found","serviceB",property.ref);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValue() throws XMLStreamException {
  Field field=TestBeanForRef.class.getDeclaredFields()[2];
  Property property=Property.create(null,field);
  Assert.assertEquals("name",property.name);
  Assert.assertEquals("${name}",property.value);
  Assert.assertNull("Ref should be null",property.ref);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.AbstractProxyTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test a basic method invocation on the proxy subclass
 */
@Test public void testMethodInvocation() throws Exception {
  Method m=getDeclaredMethod(getTestClass(),"testMethod",String.class,int.class,Object.class);
  String x="x";
  String returned=(String)m.invoke(getProxyInstance(getProxyClass(getTestClass())),x,1,new Object());
  assertEquals("Object returned from invocation was not correct.",x,returned);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEquals() throws Exception {
  Object p1=getProxyInstance(getProxyClass(getTestClass()));
  Object p2=getProxyInstance(getProxyClass(getTestClass()));
  assertFalse("Should not be equal",p1.equals(p2));
  Object p3=getP3();
  p1=setDelegate(p1,new SingleInstanceDispatcher(p3));
  p2=setDelegate(p2,new SingleInstanceDispatcher(p3));
  assertTrue("Should be equal",p1.equals(p2));
  Object p4=getProxyInstance(getProxyClass(getTestClass()));
  Object p5=getProxyInstance(getProxyClass(getTestClass()));
  p4=setDelegate(p4,new SingleInstanceDispatcher(p1));
  p5=setDelegate(p5,new SingleInstanceDispatcher(p2));
  assertTrue("Should be equal",p4.equals(p5));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test a method that returns an Integer
 */
@Test public void testReturnInteger() throws Exception {
  Method m=getDeclaredMethod(getTestClass(),"testReturnInteger");
  Integer returned=(Integer)m.invoke(getProxyInstance(getProxyClass(getTestClass())));
  assertEquals("Expected object was not returned from invocation",Integer.valueOf(1),returned);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test a method that returns an int
 */
@Test public void testReturnInt() throws Exception {
  Method m=getDeclaredMethod(getTestClass(),"testReturnInt");
  m.setAccessible(true);
  Integer returned=(Integer)m.invoke(getProxyInstance(getProxyClass(getTestClass())));
  assertEquals("Expected object was not returned from invocation",Integer.valueOf(17),returned);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test an abstract class
 */
@Test public void testAbstractClass() throws Exception {
  Object ptca=getProxyInstance(getProxyClass(ProxyTestClassAbstract.class));
  ptca=setDelegate(ptca,new Callable(){
    public Object call() throws Exception {
      return getProxyInstance(ProxyTestClassChildOfAbstract.class);
    }
  }
);
  Method m=ptca.getClass().getDeclaredMethod("getMessage");
  assertEquals("Working",m.invoke(ptca));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a method with generics
 */
@Test public void testGenerics() throws Exception {
  Class<?> proxy=getProxyClass(ProxyTestClassGeneric.class);
  Object o=getProxyInstance(proxy);
  Method m=getDeclaredMethod(ProxyTestClassGeneric.class,"setSomething",String.class);
  m.invoke(o,"aString");
  if (getClass() == WovenProxyGeneratorTest.class)   m=getDeclaredMethod(ProxyTestClassGeneric.class.getSuperclass(),"getSomething");
 else   m=getDeclaredMethod(ProxyTestClassGeneric.class,"getSomething");
  Object returned=m.invoke(o);
  assertTrue("Object was of wrong type",String.class.isInstance(returned));
  assertEquals("String had wrong value","aString",returned);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test different argument types on a method invocation
 */
@Test public void testMethodArgs() throws Exception {
  Method m=getDeclaredMethod(getTestClass(),"testArgs",double.class,short.class,long.class,char.class,byte.class,boolean.class);
  Character xc=Character.valueOf('x');
  String x=xc.toString();
  String returned=(String)m.invoke(getProxyInstance(getProxyClass(getTestClass())),Double.MAX_VALUE,Short.MIN_VALUE,Long.MAX_VALUE,xc.charValue(),Byte.MIN_VALUE,false);
  assertEquals("Object returned from invocation was not correct.",x,returned);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a covariant override method
 */
@Test public void testCovariant() throws Exception {
  Class<?> proxy=getProxyClass(ProxyTestClassCovariantOverride.class);
  Method m=getDeclaredMethod(ProxyTestClassCovariantOverride.class,"getCovariant");
  Object returned=m.invoke(getProxyInstance(proxy));
  assertTrue("Object was of wrong type: " + returned.getClass().getSimpleName(),proxy.isInstance(returned));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.InterfaceProxyingTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNoStaleProxiesForRefreshedBundle() throws Exception {
  Bundle bundle=(Bundle)Skeleton.newMock(new Class<?>[]{Bundle.class,ClassLoaderProxy.class});
  Skeleton skel=Skeleton.getSkeleton(bundle);
  TestClassLoader loader=new TestClassLoader();
  skel.setReturnValue(new MethodCall(ClassLoaderProxy.class,"getClassLoader"),loader);
  skel.setReturnValue(new MethodCall(Bundle.class,"getLastModified"),10l);
  skel.setReturnValue(new MethodCall(Bundle.class,"adapt",BundleWiring.class),Skeleton.newMock(BundleWiring.class));
  Class<?> clazz=loader.loadClass("org.apache.aries.blueprint.proxy.TestInterface");
  Object proxy=InterfaceProxyGenerator.getProxyInstance(bundle,null,Arrays.<Class<?>>asList(clazz),constantly(null),null);
  assertTrue(clazz.isInstance(proxy));
  ClassLoader parent1=proxy.getClass().getClassLoader().getParent();
  TestClassLoader loaderToo=new TestClassLoader();
  skel.setReturnValue(new MethodCall(ClassLoaderProxy.class,"getClassLoader"),loaderToo);
  skel.setReturnValue(new MethodCall(Bundle.class,"getLastModified"),20l);
  skel.setReturnValue(new MethodCall(Bundle.class,"adapt",BundleWiring.class),Skeleton.newMock(BundleWiring.class));
  Class<?> clazzToo=loaderToo.loadClass("org.apache.aries.blueprint.proxy.TestInterface");
  Object proxyToo=InterfaceProxyGenerator.getProxyInstance(bundle,null,Arrays.<Class<?>>asList(clazzToo),constantly(null),null);
  assertTrue(clazzToo.isInstance(proxyToo));
  ClassLoader parent2=proxyToo.getClass().getClassLoader().getParent();
  assertTrue(parent1 != parent2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-13 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a class whose super couldn't be woven
 */
@Test public void testDelegationAndInterception() throws Exception {
  Collection<Class<?>> classes=new ArrayList<Class<?>>(Arrays.asList(Callable.class));
  TestListener tl=new TestListener();
  TestCallable tc=new TestCallable();
  Callable o=(Callable)InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,tc,tl);
  assertCalled(tl,false,false,false);
  assertNull(null,o.call());
  assertCalled(tl,true,true,false);
  assertEquals(Callable.class.getMethod("call"),tl.getLastMethod());
  tl.clear();
  assertCalled(tl,false,false,false);
  tc.setReturn(new Callable(){
    public Object call() throws Exception {
      throw new RuntimeException();
    }
  }
);
  try {
    o.call();
    fail("Should throw an exception");
  }
 catch (  RuntimeException re) {
    assertCalled(tl,true,false,true);
    assertSame(re,tl.getLastThrowable());
  }
  tl.clear();
  assertCalled(tl,false,false,false);
  tc.setReturn(new Callable(){
    public Object call() throws Exception {
      try {
        throw new RuntimeException();
      }
 catch (      RuntimeException re) {
        return new Object();
      }
    }
  }
);
  try {
    assertNotNull(o.call());
  }
  finally {
    assertCalled(tl,true,true,false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexInterface() throws Exception {
  Collection<Class<?>> classes=new ArrayList<Class<?>>(Arrays.asList(ProxyTestInterface.class));
  final TestCallable tc=new TestCallable();
  tc.setReturn(5);
  Object o=InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,constantly(tc),null);
  assertTrue(o instanceof ProxyTestInterface);
  assertTrue(o instanceof Callable);
  assertEquals(5,((Callable)o).call());
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetProxyInstance2() throws Exception {
  Collection<Class<?>> classes=new ArrayList<Class<?>>(Arrays.asList(Closeable.class,Iterable.class,Map.class));
  Object o=InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,constantly(null),null);
  assertTrue(o instanceof Closeable);
  assertTrue(o instanceof Iterable);
  assertTrue(o instanceof Map);
}

</code></pre>

<br>
<pre class="type-4 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCaching() throws Exception {
  Collection<Class<?>> classes=new ArrayList<Class<?>>(Arrays.asList(Closeable.class));
  Object o1=InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,constantly(null),null);
  Object o2=InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,constantly(null),null);
  assertSame(o1.getClass(),o2.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandlesObjectMethods() throws Exception {
  TestListener listener=new TestListener();
  List<String> list=Arrays.asList("one","two","three");
  Object proxied=InterfaceProxyGenerator.getProxyInstance(testBundle,null,Arrays.<Class<?>>asList(List.class),constantly(list),listener);
  assertTrue(proxied.equals(Arrays.asList("one","two","three")));
  assertEquals(Collection.class.getMethod("equals",Object.class),listener.getLastMethod());
  listener.clear();
  assertEquals(Arrays.asList("one","two","three").hashCode(),proxied.hashCode());
  assertEquals(Collection.class.getMethod("hashCode"),listener.getLastMethod());
  listener.clear();
  assertEquals(list.toString(),proxied.toString());
  assertEquals(Object.class.getMethod("toString"),listener.getLastMethod());
  listener.clear();
  Runnable runnable=new Runnable(){
    public void run(){
    }
  }
;
  proxied=InterfaceProxyGenerator.getProxyInstance(testBundle,null,Arrays.<Class<?>>asList(Runnable.class),constantly(runnable),listener);
  assertTrue(proxied.equals(runnable));
  assertEquals(Object.class.getMethod("equals",Object.class),listener.getLastMethod());
  listener.clear();
  assertEquals(runnable.hashCode(),proxied.hashCode());
  assertEquals(Object.class.getMethod("hashCode"),listener.getLastMethod());
  listener.clear();
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetProxyInstance1() throws Exception {
  Collection<Class<?>> classes=new ArrayList<Class<?>>(Arrays.asList(Closeable.class));
  Object o=InterfaceProxyGenerator.getProxyInstance(testBundle,null,classes,constantly(null),null);
  assertTrue(o instanceof Closeable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.ProxySubclassGeneratorTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Test a private constructor
 */
@Test public void testPrivateConstructor() throws Exception {
  Object o=ProxySubclassGenerator.newProxySubclassInstance(ProxyTestClassPrivateConstructor.class,ih);
  assertNotNull("The new instance was null",o);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Test a generating proxy class of class with package access constructor.
 */
@SuppressWarnings("unchecked") @Test public void testPackageAccessCtor() throws Exception {
  Class<ProxyTestClassPackageAccessCtor> proxyClass=(Class<ProxyTestClassPackageAccessCtor>)ProxySubclassGenerator.getProxySubclass(ProxyTestClassPackageAccessCtor.class);
  ProxyTestClassPackageAccessCtor proxy=(ProxyTestClassPackageAccessCtor)getProxyInstance(proxyClass);
  assertNotNull("The new instance was null",proxy);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClassLoaders() throws Exception {
  ClassLoader clA=new LimitedClassLoader("org.apache.aries.proxy.test.a",null,null);
  ClassLoader clB=new LimitedClassLoader("org.apache.aries.proxy.test.b","org.apache.aries.proxy.test.a",clA);
  ClassLoader clC=new LimitedClassLoader("org.apache.aries.proxy.test.c","org.apache.aries.proxy.test.b",clB);
  Class<?> clazzA=clA.loadClass("org.apache.aries.proxy.test.a.ProxyTestClassA");
  Class<?> clazzB=clB.loadClass("org.apache.aries.proxy.test.b.ProxyTestClassB");
  Class<?> clazzC=clC.loadClass("org.apache.aries.proxy.test.c.ProxyTestClassC");
  final Object object=clazzC.getConstructor(String.class).newInstance("hello");
  o=new AsmProxyManager().createNewProxy(null,Arrays.asList(clazzA,clazzB,clazzC),constantly(object),null);
  generatedProxySubclass=o.getClass();
  Method m=generatedProxySubclass.getDeclaredMethod("hello",new Class[]{});
  Object returned=m.invoke(o);
  assertEquals("hello",returned);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-16 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the methods found declared on the generated proxy subclass are
 * the ones that we expect.
 */
@Test public void testExpectedMethods() throws Exception {
  Class<?> superclass=getTestClass();
  do {
    Method[] declaredMethods=superclass.getDeclaredMethods();
    List<Method> listOfDeclaredMethods=new ArrayList<Method>();
    for (    Method m : declaredMethods) {
      int i=m.getModifiers();
      if (Modifier.isPrivate(i) || Modifier.isFinal(i)) {
      }
 else       if (!(Modifier.isPublic(i) || Modifier.isPrivate(i) || Modifier.isProtected(i))) {
        if (m.getDeclaringClass().getPackage().equals(getTestClass().getPackage())) {
          listOfDeclaredMethods.add(m);
        }
      }
 else {
        listOfDeclaredMethods.add(m);
      }
    }
    declaredMethods=listOfDeclaredMethods.toArray(new Method[]{});
    ProxySubclassMethodHashSet<String> foundMethods=new ProxySubclassMethodHashSet<String>(declaredMethods.length);
    foundMethods.addMethodArray(declaredMethods);
    expectedMethods.addAll(foundMethods);
    superclass=superclass.getSuperclass();
  }
 while (superclass != null);
  Method[] ihMethods=new Method[]{generatedProxySubclass.getMethod("setInvocationHandler",new Class[]{InvocationHandler.class}),generatedProxySubclass.getMethod("getInvocationHandler",new Class[]{})};
  expectedMethods.addMethodArray(ihMethods);
  Method[] generatedProxySubclassMethods=generatedProxySubclass.getDeclaredMethods();
  ProxySubclassMethodHashSet<String> generatedMethods=new ProxySubclassMethodHashSet<String>(generatedProxySubclassMethods.length);
  generatedMethods.addMethodArray(generatedProxySubclassMethods);
  for (  String gen : generatedMethods) {
    assertTrue("Unexpected method: " + gen,expectedMethods.contains(gen));
  }
  for (  String exp : expectedMethods) {
    assertTrue("Method was not generated: " + exp,generatedMethods.contains(exp));
  }
  assertEquals("Sets were not the same",expectedMethods,generatedMethods);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a covariant override method
 */
@Test public void testCovariant() throws Exception {
  ((FakeInvocationHandler)ih).setDelegate(COVARIANT_CLASS.newInstance());
  o=ProxySubclassGenerator.newProxySubclassInstance(COVARIANT_CLASS,ih);
  generatedProxySubclass=o.getClass();
  Method m=generatedProxySubclass.getDeclaredMethod("getCovariant",new Class[]{});
  Object returned=m.invoke(o);
  assertTrue("Object was of wrong type: " + returned.getClass().getSimpleName(),COVARIANT_CLASS.isInstance(returned));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.WovenProxyGeneratorTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This test checks that we can add interfaces to classes that don't implement
 * them using dynamic subclassing. This is a little odd, but it came for
 * free with support for proxying abstract classes!
 * @throws Exception 
 */
@Test public void testWovenClassPlusInterfaces() throws Exception {
  Bundle b=(Bundle)Skeleton.newMock(new Class<?>[]{Bundle.class,ClassLoaderProxy.class});
  BundleWiring bw=(BundleWiring)Skeleton.newMock(BundleWiring.class);
  Skeleton.getSkeleton(b).setReturnValue(new MethodCall(ClassLoaderProxy.class,"getClassLoader"),weavingLoader);
  Skeleton.getSkeleton(b).setReturnValue(new MethodCall(ClassLoaderProxy.class,"adapt",BundleWiring.class),bw);
  Object toCall=new AsmProxyManager().createDelegatingProxy(b,Arrays.asList(getProxyClass(ProxyTestClassAbstract.class),Callable.class),new Callable(){
    public Object call() throws Exception {
      return weavingLoader.loadClass(ProxyTestClassChildOfAbstract.class.getName()).newInstance();
    }
  }
,null);
  Method m=getProxyClass(ProxyTestClassAbstract.class).getMethod("getMessage");
  assertEquals("Working",m.invoke(toCall));
  assertEquals("Callable Works too!",((Callable)toCall).call());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a class whose super couldn't be woven
 */
@Test public void testUnweavableSuper() throws Exception {
  Class<?> woven=getProxyClass(ProxyTestClassUnweavableChild.class);
  assertNotNull(woven);
  assertNotNull(getProxyInstance(woven));
  TestListener tl=new TestListener();
  Object ptcuc=getProxyInstance(woven,tl);
  assertCalled(tl,false,false,false);
  Method m=ptcuc.getClass().getMethod("doStuff");
  assertEquals("Hi!",m.invoke(ptcuc));
  assertCalled(tl,true,true,false);
  assertEquals(ProxyTestClassUnweavableGrandParent.class.getMethod("doStuff"),tl.getLastMethod());
  tl.clear();
  m=getDeclaredMethod(ProxyTestClassUnweavableChild.class,"doStuff2");
  m.setAccessible(true);
  assertEquals("Hello!",m.invoke(ptcuc));
  assertCalled(tl,true,true,false);
  assertEquals(weavingLoader.loadClass(ProxyTestClassUnweavableSuper.class.getName()).getDeclaredMethod("doStuff2"),tl.getLastMethod());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the methods found declared on the generated proxy are
 * the ones that we expect.
 */
@Test public void testExpectedMethods() throws Exception {
  ProxySubclassMethodHashSet<String> originalMethods=getMethods(getTestClass());
  ProxySubclassMethodHashSet<String> generatedMethods=getMethods(weavingLoader.loadClass(getTestClass().getName()));
  for (  String gen : generatedMethods) {
    assertTrue("Unexpected method: " + gen,originalMethods.contains(gen));
  }
  for (  String exp : originalMethods) {
    assertTrue("Method was not generated: " + exp,generatedMethods.contains(exp));
  }
  assertEquals("Sets were not the same",originalMethods,generatedMethods);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.WovenProxyPlusSubclassGeneratorTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a method marked final
 */
@Test public void testFinalMethod() throws Exception {
  try {
    InterfaceProxyGenerator.getProxyInstance(null,FINAL_METHOD_CLASS,Collections.EMPTY_SET,new Callable(){
      public Object call() throws Exception {
        return null;
      }
    }
,null).getClass();
  }
 catch (  RuntimeException re) {
    FinalModifierException e=(FinalModifierException)re.getCause();
    assertFalse("Should have found final method not final class",e.isFinalClass());
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingInterfacesToClass() throws Exception {
  Object proxy=InterfaceProxyGenerator.getProxyInstance(testBundle,super.getProxyClass(getTestClass()),Arrays.asList(Map.class,Iterable.class),new Callable(){
    int calls=0;
    private Map<String,String> map=new HashMap<String,String>();
{
      map.put("key","value");
    }
    public Object call() throws Exception {
switch (++calls) {
case 1:
        return WovenProxyPlusSubclassGeneratorTest.super.getProxyInstance(weavingLoader.loadClass(getTestClass().getName()));
case 2:
      return map;
default :
    return map.values();
}
}
}
,null);
Method m=weavingLoader.loadClass(ProxyTestClassGeneral.class.getName()).getDeclaredMethod("testReturnInt");
m.setAccessible(true);
assertEquals(17,m.invoke(proxy));
assertEquals("value",((Map<String,String>)proxy).put("key","value2"));
Iterator<?> it=((Iterable<?>)proxy).iterator();
assertEquals("value2",it.next());
assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a covariant override method
 */
@Test public void testCovariant() throws Exception {
  Class<?> proxy=getProxyClass(ProxyTestClassCovariantOverride.class);
  Method m=getDeclaredMethod(ProxyTestClassCovariantOverride.class,"getCovariant",new Class[]{});
  Object returned=m.invoke(getProxyInstance(proxy));
  assertTrue("Object was of wrong type: " + returned.getClass().getSimpleName(),proxy.getSuperclass().isInstance(returned));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.proxy.WovenSubclassGeneratorTest </h4><pre class="type-4 type-3 type-7 type-8 type-16 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the methods found declared on the generated proxy subclass are
 * the ones that we expect.
 */
@Test public void testExpectedMethods() throws Exception {
  Class<?> superclass=getTestClass();
  do {
    Method[] declaredMethods=superclass.getDeclaredMethods();
    List<Method> listOfDeclaredMethods=new ArrayList<Method>();
    for (    Method m : declaredMethods) {
      if (m.getName().equals("clone") || m.getName().equals("finalize"))       continue;
      int i=m.getModifiers();
      if (Modifier.isPrivate(i) || Modifier.isFinal(i)) {
      }
 else       if (!(Modifier.isPublic(i) || Modifier.isPrivate(i) || Modifier.isProtected(i))) {
        if (m.getDeclaringClass().getPackage().equals(getTestClass().getPackage())) {
          listOfDeclaredMethods.add(m);
        }
      }
 else {
        listOfDeclaredMethods.add(m);
      }
    }
    declaredMethods=listOfDeclaredMethods.toArray(new Method[]{});
    ProxySubclassMethodHashSet<String> foundMethods=new ProxySubclassMethodHashSet<String>(declaredMethods.length);
    foundMethods.addMethodArray(declaredMethods);
    expectedMethods.addAll(foundMethods);
    superclass=superclass.getSuperclass();
  }
 while (superclass != null);
  Method[] subclassMethods=getProxyClass(getTestClass()).getDeclaredMethods();
  List<Method> listOfDeclaredMethods=new ArrayList<Method>();
  for (  Method m : subclassMethods) {
    if (m.getName().startsWith(WovenProxy.class.getName().replace('.','_')))     continue;
    listOfDeclaredMethods.add(m);
  }
  subclassMethods=listOfDeclaredMethods.toArray(new Method[]{});
  ProxySubclassMethodHashSet<String> generatedMethods=new ProxySubclassMethodHashSet<String>(subclassMethods.length);
  generatedMethods.addMethodArray(subclassMethods);
  for (  String gen : generatedMethods) {
    assertTrue("Unexpected method: " + gen,expectedMethods.contains(gen));
  }
  for (  String exp : expectedMethods) {
    assertTrue("Method was not generated: " + exp,generatedMethods.contains(exp));
  }
  assertEquals("Sets were not the same",expectedMethods,generatedMethods);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingInterfacesToClass() throws Exception {
  Object proxy=InterfaceProxyGenerator.getProxyInstance(null,getTestClass(),Arrays.asList(Map.class,Iterable.class),new Callable(){
    int calls=0;
    private Map<String,String> map=new HashMap<String,String>();
{
      map.put("key","value");
    }
    public Object call() throws Exception {
switch (++calls) {
case 1:
        return getTestClass().newInstance();
case 2:
      return map;
default :
    return map.values();
}
}
}
,null);
assertEquals(17,((ProxyTestClassGeneralWithNoDefaultOrProtectedAccess)proxy).testReturnInt());
assertEquals("value",((Map<String,String>)proxy).put("key","value2"));
Iterator<?> it=((Iterable<?>)proxy).iterator();
assertEquals("value2",it.next());
assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a covariant override method
 */
@Test public void testCovariant() throws Exception {
  testCallable=new SingleInstanceDispatcher(COVARIANT_CLASS.newInstance());
  Object o=setDelegate(getProxyInstance(getProxyClass(COVARIANT_CLASS)),testCallable);
  Class<?> generatedProxySubclass=o.getClass();
  Method m=generatedProxySubclass.getDeclaredMethod("getCovariant",new Class[]{});
  Object returned=m.invoke(o);
  assertTrue("Object was of wrong type: " + returned.getClass().getSimpleName(),COVARIANT_CLASS.isInstance(returned));
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test a method marked final
 */
@Test public void testFinalMethod() throws Exception {
  try {
    InterfaceProxyGenerator.getProxyInstance(null,FINAL_METHOD_CLASS,Collections.EMPTY_SET,new Callable(){
      public Object call() throws Exception {
        return null;
      }
    }
,null).getClass();
  }
 catch (  RuntimeException re) {
    FinalModifierException e=(FinalModifierException)re.getCause();
    assertFalse("Should have found final method not final class",e.isFinalClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.ejb.container.itest.AbstractEJBModellerTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedOnClasspathInWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_4.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","WEB-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class","yes/beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class","yes/beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",3,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAnnotatedOnlyInZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_1.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",1,services.size());
  assertTrue(Collections.disjoint(services,getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedOnClasspathInZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_2.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","META-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class","yes/beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class","yes/beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",3,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void modelBasicEJBBundleWithXML() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_1.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","META-INF/ejb-jar.xml");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",2,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(Collections.disjoint(services,getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedInZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_1.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","META-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",3,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedNotOnClasspathInWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_4.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","WEB-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class","no/beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class","no/beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",2,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(Collections.disjoint(services,getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEJBJARInWrongPlaceWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_3.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","META-INF/ejb-jar.xml");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",0,services.size());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedNotOnClasspathInZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_2.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","META-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class","no/beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class","no/beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",2,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(Collections.disjoint(services,getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARInWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_3.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","WEB-INF/ejb-jar.xml");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",2,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(Collections.disjoint(services,getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEJBJARAndAnnotatedInWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_3.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"ejb-jar.xml","WEB-INF/ejb-jar.xml");
  addToZip(zos,"beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",3,services.size());
  assertTrue(services.containsAll(getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAnnotatedOnlyInWebZip() throws Exception {
  ModelledResource mr=null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"MANIFEST_3.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"beans/StatelessSessionBean.class");
  addToZip(zos,"beans/StatefulSessionBean.class");
  zos.close();
  mr=model(baos.toByteArray());
  Collection<? extends ExportedService> services=mr.getExportedServices();
  assertEquals("Wrong number of services",1,services.size());
  assertTrue(Collections.disjoint(services,getXMLservices()));
  assertTrue(services.containsAll(getAnnotatedservices()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.ejb.modelling.impl.EJBLocatorFactoryTest </h4><pre class="type-4 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEJBLocatorNoOpenEJB() throws Exception {
  Class<?> elf=new ClassLoader(getClass().getClassLoader()){
    @Override public Class<?> loadClass(    String className) throws ClassNotFoundException {
      if (className.startsWith("org.apache.openejb"))       throw new ClassNotFoundException(className);
      if (className.equals(EJBLocatorFactory.class.getName())) {
        ByteArrayOutputStream baos=new ByteArrayOutputStream();
        try {
          IOUtils.copy(getResourceAsStream(className.replace('.','/') + ".class"),baos);
        }
 catch (        IOException e) {
          throw new ClassNotFoundException(className,e);
        }
        return defineClass(className,baos.toByteArray(),0,baos.size());
      }
      return super.loadClass(className);
    }
  }
.loadClass(EJBLocatorFactory.class.getName());
  EJBLocator locator=(EJBLocator)elf.getMethod("getEJBLocator").invoke(null);
  assertNotNull(locator);
  assertTrue(locator.getClass().getName(),locator instanceof EJBLocationUnavailable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.ejb.openejb.extender.itest.AdvancedEJBBundleTest </h4><pre class="type-4 type-7 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testJPAContextSharing() throws Exception {
  System.setProperty("openejb.validation.output.level","VERBOSE");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"JPA_MANIFEST.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"persistence.xml","META-INF/persistence.xml");
  addToZip(zos,"beans/integration/impl/JPASingleton.class");
  addToZip(zos,"beans/jpa/Laptop.class");
  zos.close();
  Bundle test=context().installBundle("",new ByteArrayInputStream(baos.toByteArray()));
  try {
    test.start();
    PersistenceContextProvider provider=context().getService(PersistenceContextProvider.class);
    HashMap<String,Object> props=new HashMap<String,Object>();
    props.put(PersistenceContextProvider.PERSISTENCE_CONTEXT_TYPE,PersistenceContextType.TRANSACTION);
    provider.registerContext("ejb-test",context().getBundle(),props);
    Object bean=context().getService(context().getServiceReference(JPASingleton.class.getName()));
    UserTransaction ut=context().getService(UserTransaction.class);
    Method m=bean.getClass().getMethod("editEntity",String.class);
    EntityManager em=context().getService(EntityManagerFactory.class,"(&(osgi.unit.name=ejb-test)(" + PersistenceUnitConstants.CONTAINER_MANAGED_PERSISTENCE_UNIT + "=true)"+ "("+ PersistenceContextProvider.PROXY_FACTORY_EMF_ATTRIBUTE+ "=*))").createEntityManager();
    ut.begin();
    try {
      Object e=test.loadClass(Laptop.class.getName()).newInstance();
      e.getClass().getMethod("setSerialNumber",String.class).invoke(e,"ABC123");
      e.getClass().getMethod("setNumberOfCores",int.class).invoke(e,1);
      em.persist(e);
      m.invoke(bean,"ABC123");
      assertEquals(4,e.getClass().getMethod("getNumberOfCores").invoke(e));
      assertEquals(Integer.MAX_VALUE,e.getClass().getMethod("getHardDiskSize").invoke(e));
    }
  finally {
      ut.commit();
    }
    test.stop();
  }
  finally {
    test.uninstall();
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-1 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testTransactionalEJB() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream zos=new ZipOutputStream(baos);
  addToZip(zos,"TX_MANIFEST.MF","META-INF/MANIFEST.MF");
  addToZip(zos,"beans/integration/impl/TxSingleton.class");
  addToZip(zos,"beans/integration/Tx.class");
  zos.close();
  Bundle test=context().installBundle("",new ByteArrayInputStream(baos.toByteArray()));
  try {
    test.start();
    Object bean=context().getService(context().getServiceReference(Tx.class.getName()));
    UserTransaction ut=context().getService(UserTransaction.class);
    Method no=bean.getClass().getMethod("getNoTransactionId");
    Method maybe=bean.getClass().getMethod("getMaybeTransactionId");
    Method tx=bean.getClass().getMethod("getTransactionId");
    Method newTx=bean.getClass().getMethod("getNewTransactionId");
    assertNull(no.invoke(bean));
    assertNull(maybe.invoke(bean));
    assertNotNull(tx.invoke(bean));
    assertNotNull(newTx.invoke(bean));
    ut.begin();
    try {
      Object key=context().getService(TransactionSynchronizationRegistry.class).getTransactionKey();
      assertNotNull(key);
      assertNull(no.invoke(bean));
      assertSame(key,maybe.invoke(bean));
      assertSame(key,tx.invoke(bean));
      Object o=newTx.invoke(bean);
      assertNotNull(o);
      assertNotSame(key,o);
    }
  finally {
      ut.commit();
    }
    test.stop();
  }
  finally {
    test.uninstall();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.cm.ConfigurationAdminTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties() throws Exception {
  org.osgi.service.cm.ConfigurationAdmin admin=mock(org.osgi.service.cm.ConfigurationAdmin.class);
  String pid="org.apache.aries.jmx.mock";
  Configuration config=mock(Configuration.class);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put("one","value");
  props.put("two",2);
  when(admin.getConfiguration(eq(pid),anyString())).thenReturn(config);
  when(config.getProperties()).thenReturn(props);
  ConfigurationAdmin mbean=new ConfigurationAdmin(admin);
  TabularData properties=mbean.getPropertiesForLocation(pid,null);
  assertNotNull(properties);
  assertEquals(PROPERTIES_TYPE,properties.getTabularType());
  assertEquals(2,properties.values().size());
  PropertyData<? extends Object> oneData=PropertyData.from(properties.get(new Object[]{"one"}));
  assertEquals("value",oneData.getValue());
  PropertyData<? extends Object> twoData=PropertyData.from(properties.get(new Object[]{"two"}));
  assertEquals(2,twoData.getValue());
  assertEquals("2",twoData.getEncodedValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.BundleDataTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToCompositeData() throws Exception {
  Bundle bundle=mock(Bundle.class);
  BundleContext context=mock(BundleContext.class);
  PackageAdmin packageAdmin=mock(PackageAdmin.class);
  StartLevel startLevel=mock(StartLevel.class);
  Bundle b1=mock(Bundle.class);
  when(b1.getSymbolicName()).thenReturn("b1");
  when(b1.getBundleId()).thenReturn(new Long(44));
  Bundle b2=mock(Bundle.class);
  when(b2.getSymbolicName()).thenReturn("b2");
  when(b2.getBundleId()).thenReturn(new Long(55));
  Bundle b3=mock(Bundle.class);
  when(b3.getSymbolicName()).thenReturn("b3");
  when(b3.getBundleId()).thenReturn(new Long(66));
  when(context.getBundles()).thenReturn(new Bundle[]{bundle,b1,b2,b3});
  when(bundle.getSymbolicName()).thenReturn("test");
  when(bundle.getVersion()).thenReturn(Version.emptyVersion);
  when(bundle.getBundleId()).thenReturn(new Long(1));
  when(bundle.getLastModified()).thenReturn(new Long(12345));
  when(bundle.getLocation()).thenReturn("location");
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(Constants.BUNDLE_SYMBOLICNAME,"test");
  headers.put(Constants.BUNDLE_VERSION,"0.0.0");
  when(bundle.getHeaders()).thenReturn(headers);
  ExportedPackage exported=mock(ExportedPackage.class);
  when(exported.getName()).thenReturn("org.apache.aries.jmx");
  when(exported.getVersion()).thenReturn(new Version("1.0.0"));
  when(exported.getExportingBundle()).thenReturn(bundle);
  when(packageAdmin.getExportedPackages(bundle)).thenReturn(new ExportedPackage[]{exported});
  ExportedPackage ep1=mock(ExportedPackage.class);
  when(ep1.getImportingBundles()).thenReturn(new Bundle[]{bundle,b2,b3});
  when(ep1.getName()).thenReturn("org.apache.aries.jmx.b1");
  when(ep1.getVersion()).thenReturn(Version.emptyVersion);
  when(ep1.getExportingBundle()).thenReturn(b1);
  ExportedPackage ep2=mock(ExportedPackage.class);
  when(ep2.getImportingBundles()).thenReturn(new Bundle[]{bundle,b3});
  when(ep2.getName()).thenReturn("org.apache.aries.jmx.b2");
  when(ep2.getVersion()).thenReturn(Version.parseVersion("2.0.1"));
  when(ep2.getExportingBundle()).thenReturn(b2);
  headers.put(Constants.DYNAMICIMPORT_PACKAGE,"*");
  when(packageAdmin.getExportedPackages(b1)).thenReturn(new ExportedPackage[]{ep1});
  when(packageAdmin.getExportedPackages(b2)).thenReturn(new ExportedPackage[]{ep2});
  when(packageAdmin.getExportedPackages(b3)).thenReturn(null);
  RequiredBundle rb1=mock(RequiredBundle.class);
  when(rb1.getBundle()).thenReturn(b1);
  when(rb1.getRequiringBundles()).thenReturn(new Bundle[]{bundle,b2});
  RequiredBundle rb2=mock(RequiredBundle.class);
  when(rb2.getBundle()).thenReturn(b2);
  when(rb2.getRequiringBundles()).thenReturn(new Bundle[]{b1});
  RequiredBundle rb3=mock(RequiredBundle.class);
  when(rb3.getBundle()).thenReturn(b3);
  when(rb3.getRequiringBundles()).thenReturn(new Bundle[]{bundle,b1,b2});
  headers.put(Constants.REQUIRE_BUNDLE,"b1;bundle-version=\"1.0.0\",b3;bundle-version=\"2.0.0\"");
  when(packageAdmin.getRequiredBundles("b1")).thenReturn(new RequiredBundle[]{rb1});
  when(packageAdmin.getRequiredBundles("b2")).thenReturn(new RequiredBundle[]{rb2});
  when(packageAdmin.getRequiredBundles("b3")).thenReturn(new RequiredBundle[]{rb3});
  ServiceReference s1=mock(ServiceReference.class);
  when(s1.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(15));
  ServiceReference s2=mock(ServiceReference.class);
  when(s2.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(16));
  ServiceReference s3=mock(ServiceReference.class);
  when(s3.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(17));
  when(bundle.getServicesInUse()).thenReturn(new ServiceReference[]{s1,s2,s3});
  BundleData b=new BundleData(context,bundle,packageAdmin,startLevel);
  CompositeData compositeData=b.toCompositeData();
  assertEquals("test",compositeData.get(SYMBOLIC_NAME));
  assertEquals("0.0.0",compositeData.get(VERSION));
  TabularData headerTable=(TabularData)compositeData.get(HEADERS);
  assertEquals(4,headerTable.values().size());
  CompositeData header=headerTable.get(new Object[]{Constants.BUNDLE_SYMBOLICNAME});
  assertNotNull(header);
  String value=(String)header.get(VALUE);
  assertEquals("test",value);
  String key=(String)header.get(KEY);
  assertEquals(Constants.BUNDLE_SYMBOLICNAME,key);
  TabularData bundleTable=new TabularDataSupport(BUNDLES_TYPE);
  bundleTable.put(b.toCompositeData());
  CompositeData bundleData=bundleTable.get(new Object[]{Long.valueOf(1)});
  assertNotNull(bundleData);
  String location=(String)bundleData.get(LOCATION);
  assertEquals("location",location);
  assertArrayEquals(new String[]{"org.apache.aries.jmx;1.0.0"},(String[])compositeData.get(EXPORTED_PACKAGES));
  assertArrayEquals(new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"},(String[])compositeData.get(IMPORTED_PACKAGES));
  assertEquals(toSet(new long[]{44,55,66}),toSet((Long[])compositeData.get(REQUIRED_BUNDLES)));
  assertArrayEquals(new Long[]{new Long(15),new Long(16),new Long(17)},(Long[])compositeData.get(SERVICES_IN_USE));
  assertEquals("UNKNOWN",compositeData.get(STATE));
  assertEquals(0,((Long[])compositeData.get(HOSTS)).length);
  assertEquals(0,((Long[])compositeData.get(FRAGMENTS)).length);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHeaderFromCompositeData() throws Exception {
  CompositeData compositeData=new CompositeDataSupport(HEADER_TYPE,new String[]{KEY,VALUE},new String[]{"c","d"});
  Header header=Header.from(compositeData);
  assertEquals("c",header.getKey());
  assertEquals("d",header.getValue());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromCompositeData() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(EXPORTED_PACKAGES,new String[]{"org.apache.aries.jmx;1.0.0"});
  items.put(FRAGMENT,false);
  items.put(FRAGMENTS,new Long[0]);
  items.put(HOSTS,new Long[0]);
  items.put(IDENTIFIER,new Long(3));
  items.put(IMPORTED_PACKAGES,new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"});
  items.put(LAST_MODIFIED,new Long(8797));
  items.put(LOCATION,"");
  items.put(ACTIVATION_POLICY_USED,true);
  items.put(PERSISTENTLY_STARTED,false);
  items.put(REGISTERED_SERVICES,new Long[0]);
  items.put(REMOVAL_PENDING,false);
  items.put(REQUIRED,true);
  items.put(REQUIRED_BUNDLES,new Long[]{new Long(44),new Long(66)});
  items.put(REQUIRING_BUNDLES,new Long[0]);
  items.put(SERVICES_IN_USE,new Long[]{new Long(15),new Long(16),new Long(17)});
  items.put(START_LEVEL,1);
  items.put(STATE,"ACTIVE");
  items.put(SYMBOLIC_NAME,"test");
  items.put(VERSION,"0.0.0");
  TabularData headerTable=new TabularDataSupport(HEADERS_TYPE);
  headerTable.put(new Header("a","a").toCompositeData());
  headerTable.put(new Header("b","b").toCompositeData());
  items.put(HEADERS,headerTable);
  CompositeData compositeData=new CompositeDataSupport(BUNDLE_TYPE,items);
  BundleData b=BundleData.from(compositeData);
  assertEquals("test",b.getSymbolicName());
  assertEquals("0.0.0",b.getVersion());
  assertEquals(2,b.getHeaders().size());
  assertArrayEquals(new String[]{"org.apache.aries.jmx;1.0.0"},b.getExportedPackages());
  assertArrayEquals(new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"},b.getImportedPackages());
  assertArrayEquals(new long[]{44,66},b.getRequiredBundles());
  assertArrayEquals(new long[]{15,16,17},b.getServicesInUse());
  assertEquals("ACTIVE",b.getState());
  assertEquals(0,b.getHosts().length);
  assertEquals(0,b.getFragments().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.BundleEventDataTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFrom() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(IDENTIFIER,new Long(7));
  items.put(SYMBOLIC_NAME,"t");
  items.put(LOCATION,"l");
  items.put(EVENT,BundleEvent.RESOLVED);
  CompositeData compositeData=new CompositeDataSupport(BUNDLE_EVENT_TYPE,items);
  BundleEventData event=BundleEventData.from(compositeData);
  assertEquals(7,event.getBundleId());
  assertEquals("t",event.getBundleSymbolicName());
  assertEquals("l",event.getLocation());
  assertEquals(BundleEvent.RESOLVED,event.getEventType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.PropertyDataTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromCompositeDataForPrimitiveTypes() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(KEY,"key");
  items.put(VALUE,"1");
  items.put(TYPE,P_INT);
  CompositeData compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Integer> intData=PropertyData.from(compositeData);
  assertEquals("key",intData.getKey());
  assertEquals(new Integer(1),intData.getValue());
  assertEquals(P_INT,intData.getEncodedType());
  assertTrue(intData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"1.0");
  items.put(TYPE,P_DOUBLE);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Double> doubleData=PropertyData.from(compositeData);
  assertEquals("key",doubleData.getKey());
  assertEquals(Double.valueOf(1.0),doubleData.getValue());
  assertEquals(P_DOUBLE,doubleData.getEncodedType());
  assertTrue(doubleData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"a");
  items.put(TYPE,P_CHAR);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Character> charData=PropertyData.from(compositeData);
  assertEquals("key",charData.getKey());
  assertEquals(Character.valueOf('a'),charData.getValue());
  assertEquals(P_CHAR,charData.getEncodedType());
  assertTrue(charData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"true");
  items.put(TYPE,P_BOOLEAN);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Boolean> booleanData=PropertyData.from(compositeData);
  assertEquals("key",booleanData.getKey());
  assertTrue(booleanData.getValue());
  assertEquals(P_BOOLEAN,booleanData.getEncodedType());
  assertTrue(booleanData.isEncodingPrimitive());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToFromCompositeDataForAdditionalTypes(){
  PropertyData<String> stringData=PropertyData.newInstance("test","value");
  CompositeData stringCData=stringData.toCompositeData();
  assertEquals("test",stringCData.get(KEY));
  assertEquals("value",stringCData.get(VALUE));
  assertEquals(STRING,stringCData.get(TYPE));
  stringData=PropertyData.from(stringCData);
  assertEquals("test",stringData.getKey());
  assertEquals("value",stringData.getValue());
  assertEquals(STRING,stringData.getEncodedType());
  PropertyData<BigInteger> bigIntData=PropertyData.newInstance("test",new BigInteger("1"));
  CompositeData bigIntCData=bigIntData.toCompositeData();
  assertEquals("test",bigIntCData.get(KEY));
  assertEquals("1",bigIntCData.get(VALUE));
  assertEquals(BIGINTEGER,bigIntCData.get(TYPE));
  bigIntData=PropertyData.from(bigIntCData);
  assertEquals("test",bigIntData.getKey());
  assertEquals(new BigInteger("1"),bigIntData.getValue());
  assertEquals(BIGINTEGER,bigIntData.getEncodedType());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromCompositeDataForWrapperTypes() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(KEY,"key");
  items.put(VALUE,"1");
  items.put(TYPE,INTEGER);
  CompositeData compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Integer> intData=PropertyData.from(compositeData);
  assertEquals("key",intData.getKey());
  assertEquals(new Integer(1),intData.getValue());
  assertEquals(INTEGER,intData.getEncodedType());
  assertFalse(intData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"1.0");
  items.put(TYPE,DOUBLE);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Double> doubleData=PropertyData.from(compositeData);
  assertEquals("key",doubleData.getKey());
  assertEquals(Double.valueOf(1.0),doubleData.getValue());
  assertEquals(DOUBLE,doubleData.getEncodedType());
  assertFalse(doubleData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"a");
  items.put(TYPE,CHARACTER);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Character> charData=PropertyData.from(compositeData);
  assertEquals("key",charData.getKey());
  assertEquals(Character.valueOf('a'),charData.getValue());
  assertEquals(CHARACTER,charData.getEncodedType());
  assertFalse(charData.isEncodingPrimitive());
  items.clear();
  items.put(KEY,"key");
  items.put(VALUE,"true");
  items.put(TYPE,BOOLEAN);
  compositeData=new CompositeDataSupport(PROPERTY_TYPE,items);
  PropertyData<Boolean> booleanData=PropertyData.from(compositeData);
  assertEquals("key",booleanData.getKey());
  assertTrue(booleanData.getValue());
  assertEquals(BOOLEAN,booleanData.getEncodedType());
  assertFalse(booleanData.isEncodingPrimitive());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToFromCompositeDataForArrayTypes(){
  long[] primitiveLongValues=new long[]{1,2,3};
  PropertyData<long[]> primitiveLongArrayData=PropertyData.newInstance("test",primitiveLongValues);
  CompositeData primitiveLongArrayCData=primitiveLongArrayData.toCompositeData();
  assertEquals("test",primitiveLongArrayCData.get(KEY));
  assertEquals("1,2,3",primitiveLongArrayCData.get(VALUE));
  assertEquals("Array of long",primitiveLongArrayCData.get(TYPE));
  primitiveLongArrayData=PropertyData.from(primitiveLongArrayCData);
  assertEquals("test",primitiveLongArrayData.getKey());
  assertEquals("Array of long",primitiveLongArrayData.getEncodedType());
  assertArrayEquals(primitiveLongValues,primitiveLongArrayData.getValue());
  Long[] longValues=new Long[]{new Long(4),new Long(5),new Long(6)};
  PropertyData<Long[]> longArrayData=PropertyData.newInstance("test",longValues);
  CompositeData longArrayCData=longArrayData.toCompositeData();
  assertEquals("test",longArrayCData.get(KEY));
  assertEquals("4,5,6",longArrayCData.get(VALUE));
  assertEquals("Array of Long",longArrayCData.get(TYPE));
  longArrayData=PropertyData.from(longArrayCData);
  assertEquals("test",longArrayData.getKey());
  assertEquals("Array of Long",longArrayData.getEncodedType());
  assertArrayEquals(longValues,longArrayData.getValue());
  char[] primitiveCharValues=new char[]{'a','b','c'};
  PropertyData<char[]> primitiveCharArrayData=PropertyData.newInstance("test",primitiveCharValues);
  CompositeData primitiveCharArrayCData=primitiveCharArrayData.toCompositeData();
  assertEquals("test",primitiveCharArrayCData.get(KEY));
  assertEquals("a,b,c",primitiveCharArrayCData.get(VALUE));
  assertEquals("Array of char",primitiveCharArrayCData.get(TYPE));
  primitiveCharArrayData=PropertyData.from(primitiveCharArrayCData);
  assertEquals("test",primitiveCharArrayData.getKey());
  assertEquals("Array of char",primitiveCharArrayData.getEncodedType());
  assertArrayEquals(primitiveCharValues,primitiveCharArrayData.getValue());
  Character[] charValues=new Character[]{'a','b','c'};
  PropertyData<Character[]> charArrayData=PropertyData.newInstance("test",charValues);
  CompositeData charArrayCData=charArrayData.toCompositeData();
  assertEquals("test",charArrayCData.get(KEY));
  assertEquals("a,b,c",charArrayCData.get(VALUE));
  assertEquals("Array of Character",charArrayCData.get(TYPE));
  charArrayData=PropertyData.from(charArrayCData);
  assertEquals("test",charArrayData.getKey());
  assertEquals("Array of Character",charArrayData.getEncodedType());
  assertArrayEquals(charValues,charArrayData.getValue());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToFromCompositeDataForList2(){
  List<Long> sl=new ArrayList<Long>();
  sl.add(Long.MAX_VALUE);
  PropertyData<List<Long>> pd=PropertyData.newInstance("test",sl);
  CompositeData cd=pd.toCompositeData();
  assertEquals("test",cd.get(KEY));
  assertEquals(new Long(Long.MAX_VALUE).toString(),cd.get(VALUE));
  assertEquals("Array of Long",cd.get(TYPE));
  PropertyData<Long[]> pd2=PropertyData.from(cd);
  assertEquals("test",pd2.getKey());
  assertEquals("Array of Long",pd2.getEncodedType());
  assertArrayEquals(new Long[]{Long.MAX_VALUE},pd2.getValue());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToFromCompositeDataForVector(){
  Vector<Long> vector=new Vector<Long>();
  vector.add(new Long(40));
  vector.add(new Long(50));
  vector.add(new Long(60));
  PropertyData<Vector<Long>> vectorPropertyData=PropertyData.newInstance("test",vector);
  CompositeData vectorCompositeData=vectorPropertyData.toCompositeData();
  assertEquals("test",vectorCompositeData.get(KEY));
  assertEquals("40,50,60",vectorCompositeData.get(VALUE));
  assertEquals("Vector of Long",vectorCompositeData.get(TYPE));
  vectorPropertyData=PropertyData.from(vectorCompositeData);
  assertEquals("test",vectorPropertyData.getKey());
  assertEquals("Vector of Long",vectorPropertyData.getEncodedType());
  assertArrayEquals(vector.toArray(new Long[vector.size()]),vectorPropertyData.getValue().toArray(new Long[vector.size()]));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToFromCompositeDataForList(){
  List<String> sl=new ArrayList<String>();
  sl.add("A");
  sl.add("B");
  PropertyData<List<String>> pd=PropertyData.newInstance("test",sl);
  CompositeData cd=pd.toCompositeData();
  assertEquals("test",cd.get(KEY));
  assertEquals("A,B",cd.get(VALUE));
  assertEquals("Array of String",cd.get(TYPE));
  PropertyData<String[]> pd2=PropertyData.from(cd);
  assertEquals("test",pd2.getKey());
  assertEquals("Array of String",pd2.getEncodedType());
  assertArrayEquals(new String[]{"A","B"},pd2.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.ServiceDataTest </h4><pre class="type-4 type-12 type-5 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToCompositeData() throws Exception {
  ServiceReference<?> reference=mock(ServiceReference.class);
  Bundle bundle=mock(Bundle.class);
  String[] interfaces=new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"};
  Bundle b1=mock(Bundle.class);
  when(b1.getBundleId()).thenReturn(new Long(6));
  Bundle b2=mock(Bundle.class);
  when(b2.getBundleId()).thenReturn(new Long(9));
  when(reference.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(98));
  when(reference.getBundle()).thenReturn(bundle);
  when(bundle.getBundleId()).thenReturn(new Long(34));
  when(reference.getProperty(Constants.OBJECTCLASS)).thenReturn(interfaces);
  when(reference.getUsingBundles()).thenReturn(new Bundle[]{b1,b2});
  when(reference.getPropertyKeys()).thenReturn(new String[]{"x.vendor","x.domain","x.index","x.optimized"});
  when(reference.getProperty("x.vendor")).thenReturn("aries");
  when(reference.getProperty("x.domain")).thenReturn("test");
  when(reference.getProperty("x.index")).thenReturn(new Long(67));
  when(reference.getProperty("x.optimized")).thenReturn(true);
  ServiceData serviceData=new ServiceData(reference);
  CompositeData compositeData=serviceData.toCompositeData();
  assertEquals(new Long(98),compositeData.get(IDENTIFIER));
  assertEquals(new Long(34),compositeData.get(BUNDLE_IDENTIFIER));
  assertArrayEquals(new Long[]{new Long(6),new Long(9)},(Long[])compositeData.get(USING_BUNDLES));
  assertArrayEquals(interfaces,(String[])compositeData.get(OBJECT_CLASS));
  TabularData propertiesTable=(TabularData)compositeData.get(PROPERTIES);
  @SuppressWarnings("unchecked") Collection<CompositeData> propertyData=(Collection<CompositeData>)propertiesTable.values();
  assertEquals(4,propertyData.size());
  for (  CompositeData propertyRow : propertyData) {
    String key=(String)propertyRow.get(KEY);
    if (key.equals("x.vendor")) {
      assertEquals("aries",propertyRow.get(VALUE));
      assertEquals(STRING,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.domain")) {
      assertEquals("test",propertyRow.get(VALUE));
      assertEquals(STRING,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.index")) {
      assertEquals("67",propertyRow.get(VALUE));
      assertEquals(LONG,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.optimized")) {
      assertEquals("true",propertyRow.get(VALUE));
      assertEquals(BOOLEAN,propertyRow.get(TYPE));
    }
 else {
      fail("unknown key parsed from properties");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-5 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromCompositeData() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(IDENTIFIER,new Long(99));
  items.put(BUNDLE_IDENTIFIER,new Long(5));
  items.put(USING_BUNDLES,new Long[]{new Long(10),new Long(11)});
  items.put(OBJECT_CLASS,new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"});
  TabularData propertyTable=new TabularDataSupport(JmxConstants.PROPERTIES_TYPE);
  propertyTable.put(PropertyData.newInstance("a",true).toCompositeData());
  propertyTable.put(PropertyData.newInstance("b","value").toCompositeData());
  propertyTable.put(PropertyData.newInstance("c",new int[]{1,2}).toCompositeData());
  propertyTable.put(PropertyData.newInstance("d",new Long[]{new Long(3),new Long(4)}).toCompositeData());
  items.put(ServiceStateMBean.PROPERTIES,propertyTable);
  CompositeData compositeData=new CompositeDataSupport(SERVICE_TYPE,items);
  ServiceData data=ServiceData.from(compositeData);
  assertEquals(99,data.getServiceId());
  assertEquals(5,data.getBundleId());
  assertArrayEquals(new long[]{10,11},data.getUsingBundles());
  assertArrayEquals(new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"},data.getServiceInterfaces());
  List<PropertyData<? extends Object>> properties=data.getProperties();
  assertEquals(4,properties.size());
  for (  PropertyData<? extends Object> property : properties) {
    if (property.getKey().equals("a")) {
      assertTrue((Boolean)property.getValue());
      assertEquals(P_BOOLEAN,property.getEncodedType());
    }
 else     if (property.getKey().equals("b")) {
      assertEquals("value",property.getValue());
      assertEquals(STRING,property.getEncodedType());
    }
 else     if (property.getKey().equals("c")) {
      assertArrayEquals(new int[]{1,2},(int[])property.getValue());
      assertEquals("Array of int",property.getEncodedType());
      assertEquals("1,2",property.getEncodedValue());
    }
 else     if (property.getKey().equals("d")) {
      assertArrayEquals(new Long[]{new Long(3),new Long(4)},(Long[])property.getValue());
      assertEquals("Array of Long",property.getEncodedType());
      assertEquals("3,4",property.getEncodedValue());
    }
 else {
      fail("unknown key parsed from properties");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.ServiceEventDataTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFrom() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(IDENTIFIER,new Long(7));
  items.put(BUNDLE_IDENTIFIER,new Long(67));
  items.put(BUNDLE_LOCATION,"string");
  items.put(BUNDLE_SYMBOLIC_NAME,"test");
  items.put(OBJECT_CLASS,new String[]{"org.apache.aries.jmx.Mock"});
  items.put(EVENT,ServiceEvent.MODIFIED);
  CompositeData compositeData=new CompositeDataSupport(SERVICE_EVENT_TYPE,items);
  ServiceEventData event=ServiceEventData.from(compositeData);
  assertEquals(7,event.getServiceId());
  assertEquals(67,event.getBundleId());
  assertArrayEquals(new String[]{"org.apache.aries.jmx.Mock"},event.getServiceInterfaces());
  assertEquals("test",event.getBundleSymbolicName());
  assertEquals("string",event.getBundleLocation());
  assertEquals(ServiceEvent.MODIFIED,event.getEventType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.BundleStateMBeanTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"unchecked"}) public void testHeaderLocalization() throws Exception {
  Bundle bundleE=context().getBundleByName("org.apache.aries.jmx.test.bundlee");
  CompositeData cd=mbean.getBundle(bundleE.getBundleId());
  long id=(Long)cd.get(BundleStateMBean.IDENTIFIER);
  assertEquals("Description",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION));
  assertEquals("Description",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION,"en"));
  assertEquals("Omschrijving",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION,"nl"));
  TabularData td=mbean.getHeaders(id);
  boolean found=false;
  for (  CompositeData d : (Collection<CompositeData>)td.values()) {
    if (Constants.BUNDLE_DESCRIPTION.equals(d.get(BundleStateMBean.KEY))) {
      assertEquals("Description",d.get(BundleStateMBean.VALUE));
      found=true;
      break;
    }
  }
  assertTrue(found);
  TabularData tdNL=mbean.getHeaders(id,"nl");
  boolean foundNL=false;
  for (  CompositeData d : (Collection<CompositeData>)tdNL.values()) {
    if (Constants.BUNDLE_DESCRIPTION.equals(d.get(BundleStateMBean.KEY))) {
      assertEquals("Omschrijving",d.get(BundleStateMBean.VALUE));
      foundNL=true;
      break;
    }
  }
  assertTrue(foundNL);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObjectName() throws Exception {
  Set<ObjectName> names=mbeanServer.queryNames(new ObjectName(BundleStateMBean.OBJECTNAME + ",*"),null);
  assertEquals(1,names.size());
  ObjectName name=names.iterator().next();
  Hashtable<String,String> props=name.getKeyPropertyList();
  assertEquals(context().getProperty(Constants.FRAMEWORK_UUID),props.get("uuid"));
  assertEquals(context().getBundle(0).getSymbolicName(),props.get("framework"));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMBeanInterface() throws Exception {
  String[] exports=mbean.getExportedPackages(a.getBundleId());
  assertEquals(2,exports.length);
  List<String> packages=Arrays.asList(exports);
  assertTrue(packages.contains("org.apache.aries.jmx.test.bundlea.api;2.0.0"));
  assertTrue(packages.contains("org.apache.aries.jmx.test.fragmentc;0.0.0"));
  long[] fragments=mbean.getFragments(a.getBundleId());
  assertEquals(1,fragments.length);
  assertEquals(fragc.getBundleId(),fragments[0]);
  TabularData headers=mbean.getHeaders(b.getBundleId());
  assertNotNull(headers);
  assertEquals(BundleStateMBean.HEADERS_TYPE,headers.getTabularType());
  assertTrue(headers.values().size() >= 4);
  assertEquals("org.apache.aries.jmx.test.bundleb",Header.from(headers.get(new Object[]{Constants.BUNDLE_SYMBOLICNAME})).getValue());
  long[] hosts=mbean.getHosts(fragc.getBundleId());
  assertEquals(1,hosts.length);
  assertEquals(a.getBundleId(),hosts[0]);
  String[] imports=mbean.getImportedPackages(a.getBundleId());
  assertTrue(imports.length >= 3);
  List<String> importedPackages=Arrays.asList(imports);
  Version version=getPackageVersion("org.osgi.framework");
  assertTrue(importedPackages.contains("org.osgi.framework;" + version.toString()));
  assertTrue(importedPackages.contains("org.apache.aries.jmx.test.bundleb.api;1.1.0"));
  assertTrue(mbean.getLastModified(b.getBundleId()) > 0);
  assertEquals(b.getLocation(),mbean.getLocation(b.getBundleId()));
  long[] serviceIds=mbean.getRegisteredServices(a.getBundleId());
  assertEquals(1,serviceIds.length);
  long[] required=mbean.getRequiredBundles(d.getBundleId());
  assertEquals(1,required.length);
  assertEquals(a.getBundleId(),required[0]);
  long[] requiring=mbean.getRequiringBundles(a.getBundleId());
  assertEquals(2,requiring.length);
  assertTrue(fragc.getSymbolicName(),arrayContains(fragc.getBundleId(),requiring));
  assertTrue(d.getSymbolicName(),arrayContains(d.getBundleId(),requiring));
  long[] servicesInUse=mbean.getServicesInUse(a.getBundleId());
  assertEquals(1,servicesInUse.length);
  long startLevel=mbean.getStartLevel(b.getBundleId());
  assertTrue(startLevel >= 0);
  assertEquals("ACTIVE",mbean.getState(b.getBundleId()));
  assertFalse(mbean.isFragment(b.getBundleId()));
  assertTrue(mbean.isFragment(fragc.getBundleId()));
  assertFalse(mbean.isRemovalPending(b.getBundleId()));
  assertTrue(mbean.isRequired(a.getBundleId()));
  assertTrue(mbean.isRequired(b.getBundleId()));
  TabularData bundlesTable=mbean.listBundles();
  assertNotNull(bundlesTable);
  assertEquals(BundleStateMBean.BUNDLES_TYPE,bundlesTable.getTabularType());
  assertEquals(bundleContext.getBundles().length,bundlesTable.values().size());
  final List<Notification> received=new ArrayList<Notification>();
  mbeanServer.addNotificationListener(objectName,new NotificationListener(){
    public void handleNotification(    Notification notification,    Object handback){
      received.add(notification);
    }
  }
,null,null);
  assertEquals(Bundle.ACTIVE,b.getState());
  b.stop();
  assertEquals(Bundle.RESOLVED,b.getState());
  b.start();
  assertEquals(Bundle.ACTIVE,b.getState());
  int i=0;
  while (received.size() < 2 && i < 3) {
    Thread.sleep(1000);
    i++;
  }
  assertEquals(2,received.size());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-16 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAttributeChangeNotifications() throws Exception {
  final List<AttributeChangeNotification> attributeChanges=new ArrayList<AttributeChangeNotification>();
  AttributeChangeNotificationFilter filter=new AttributeChangeNotificationFilter();
  filter.disableAllAttributes();
  filter.enableAttribute("BundleIds");
  mbeanServer.addNotificationListener(objectName,new NotificationListener(){
    public void handleNotification(    Notification notification,    Object handback){
      attributeChanges.add((AttributeChangeNotification)notification);
    }
  }
,filter,null);
  long[] idsWithout=mbean.getBundleIds();
  assertEquals("Precondition",0,attributeChanges.size());
  Manifest mf=new Manifest();
  mf.getMainAttributes().putValue("Bundle-ManifestVersion","2");
  mf.getMainAttributes().putValue("Bundle-SymbolicName","empty-test-bundle");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,mf);
  jos.closeEntry();
  jos.close();
  InputStream bais=new ByteArrayInputStream(baos.toByteArray());
  Bundle bundle=bundleContext.installBundle("http://somelocation",bais);
  long[] idsWith=new long[idsWithout.length + 1];
  System.arraycopy(idsWithout,0,idsWith,0,idsWithout.length);
  idsWith[idsWith.length - 1]=bundle.getBundleId();
  Arrays.sort(idsWith);
  waitForListToReachSize(attributeChanges,1);
  assertEquals(1,attributeChanges.size());
  AttributeChangeNotification ac=attributeChanges.get(0);
  assertEquals("BundleIds",ac.getAttributeName());
  long oldSequence=ac.getSequenceNumber();
  assertTrue(Arrays.equals(idsWithout,(long[])ac.getOldValue()));
  assertTrue(Arrays.equals(idsWith,(long[])ac.getNewValue()));
  bundle.uninstall();
  waitForListToReachSize(attributeChanges,2);
  AttributeChangeNotification ac2=attributeChanges.get(1);
  assertEquals("BundleIds",ac2.getAttributeName());
  assertEquals(oldSequence + 1,ac2.getSequenceNumber());
  assertTrue(Arrays.equals(idsWith,(long[])ac2.getOldValue()));
  assertTrue(Arrays.equals(idsWithout,(long[])ac2.getNewValue()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.BundleStateTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNotificationsForBundleEvents() throws Exception {
  StateConfig stateConfig=new StateConfig();
  List<Notification> received=new LinkedList<Notification>();
  List<AttributeChangeNotification> attributeChanges=new LinkedList<AttributeChangeNotification>();
  createBundle(stateConfig,received,attributeChanges);
  assertEquals(2,received.size());
  Notification installed=received.get(0);
  assertEquals(1,installed.getSequenceNumber());
  CompositeData installedCompositeData=(CompositeData)installed.getUserData();
  BundleEventData installedData=BundleEventData.from(installedCompositeData);
  assertEquals("bundle",installedData.getBundleSymbolicName());
  assertEquals(9,installedData.getBundleId());
  assertEquals("file:/location",installedData.getLocation());
  assertEquals(BundleEvent.INSTALLED,installedData.getEventType());
  Notification resolved=received.get(1);
  assertEquals(2,resolved.getSequenceNumber());
  CompositeData resolvedCompositeData=(CompositeData)resolved.getUserData();
  BundleEventData resolvedData=BundleEventData.from(resolvedCompositeData);
  assertEquals("bundle",resolvedData.getBundleSymbolicName());
  assertEquals(9,resolvedData.getBundleId());
  assertEquals("file:/location",resolvedData.getLocation());
  assertEquals(BundleEvent.RESOLVED,resolvedData.getEventType());
  assertEquals(1,attributeChanges.size());
  AttributeChangeNotification ac=attributeChanges.get(0);
  assertEquals("BundleIds",ac.getAttributeName());
  assertEquals(0,((long[])ac.getOldValue()).length);
  assertEquals(1,((long[])ac.getNewValue()).length);
  assertEquals(9L,((long[])ac.getNewValue())[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.FrameworkMBeanTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundleAndWait() throws Exception {
  FrameworkWiring frameworkWiring=(FrameworkWiring)context().getBundle(0).adapt(FrameworkWiring.class);
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",0,frameworkWiring.getRemovalPendingBundles().size());
  assertEquals(0,framework.getRemovalPendingBundles().length);
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,bundleB.adapt(BundleWiring.class));
  assertEquals("Precondition",1,frameworkWiring.getRemovalPendingBundles().size());
  assertEquals(1,framework.getRemovalPendingBundles().length);
  assertEquals(((Bundle)frameworkWiring.getRemovalPendingBundles().iterator().next()).getBundleId(),framework.getRemovalPendingBundles()[0]);
  assertTrue(framework.refreshBundleAndWait(bundleB.getBundleId()));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObjectName() throws Exception {
  Set<ObjectName> names=mbeanServer.queryNames(new ObjectName(FrameworkMBean.OBJECTNAME + ",*"),null);
  assertEquals(1,names.size());
  ObjectName name=names.iterator().next();
  Hashtable<String,String> props=name.getKeyPropertyList();
  assertEquals(context().getProperty(Constants.FRAMEWORK_UUID),props.get("uuid"));
  assertEquals(context().getBundle(0).getSymbolicName(),props.get("framework"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMBeanInterface() throws IOException {
  long[] bundleIds=new long[]{1,2};
  int[] newlevels=new int[]{1,1};
  CompositeData compData=framework.setBundleStartLevels(bundleIds,newlevels);
  assertNotNull(compData);
  BatchActionResult batch2=BatchActionResult.from(compData);
  assertNotNull(batch2.getCompleted());
  assertTrue(batch2.isSuccess());
  assertNull(batch2.getError());
  assertNull(batch2.getRemainingItems());
  File file=File.createTempFile("bundletest",".jar");
  file.deleteOnExit();
  Manifest man=new Manifest();
  man.getMainAttributes().putValue("Manifest-Version","1.0");
  JarOutputStream jaros=new JarOutputStream(new FileOutputStream(file),man);
  jaros.flush();
  jaros.close();
  long bundleId=0;
  try {
    bundleId=framework.installBundleFromURL(file.getAbsolutePath(),file.toURI().toString());
  }
 catch (  Exception e) {
    fail("Installation of test bundle shouldn't fail");
  }
  try {
    framework.uninstallBundle(bundleId);
  }
 catch (  Exception e) {
    fail("Uninstallation of test bundle shouldn't fail");
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundlesAndWait() throws Exception {
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,bundleB.adapt(BundleWiring.class));
  FrameworkMBean framework=getMBean(FrameworkMBean.OBJECTNAME,FrameworkMBean.class);
  CompositeData result=framework.refreshBundlesAndWait(new long[]{bundleB.getBundleId()});
  assertTrue((Boolean)result.get(FrameworkMBean.SUCCESS));
  assertTrue(Arrays.equals(new Long[]{bundleB.getBundleId()},(Long[])result.get(FrameworkMBean.COMPLETED)));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDependencyClosure() throws Exception {
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Collection<Bundle> expectedDC=((FrameworkWiring)context().getBundle(0).adapt(FrameworkWiring.class)).getDependencyClosure(Collections.singleton(bundleA));
  Set<Long> expectedClosure=new TreeSet<Long>();
  for (  Bundle b : expectedDC) {
    expectedClosure.add(b.getBundleId());
  }
  long[] actualDC=framework.getDependencyClosure(new long[]{bundleA.getBundleId()});
  Set<Long> actualClosure=new TreeSet<Long>();
  for (  long l : actualDC) {
    actualClosure.add(l);
  }
  assertEquals(expectedClosure,actualClosure);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundlesAndWait2() throws Exception {
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,((BundleWiring)bundleB.adapt(BundleWiring.class)));
  FrameworkMBean framework=getMBean(FrameworkMBean.OBJECTNAME,FrameworkMBean.class);
  CompositeData result=framework.refreshBundlesAndWait(null);
  Set<Long> completed=new HashSet<Long>(Arrays.asList((Long[])result.get(FrameworkMBean.COMPLETED)));
  assertTrue(completed.contains(bundleA.getBundleId()));
  assertTrue(completed.contains(bundleB.getBundleId()));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.FrameworkTest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallBundlesFromURL() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.installBundle(Mockito.anyString(),Mockito.any(InputStream.class))).thenReturn(bundle);
  Mockito.when(bundle.getBundleId()).thenReturn(Long.valueOf(2));
  Framework spiedMBean=Mockito.spy(mbean);
  InputStream stream=Mockito.mock(InputStream.class);
  Mockito.doReturn(stream).when(spiedMBean).createStream(Mockito.anyString());
  CompositeData data=spiedMBean.installBundlesFromURL(new String[]{"file:test.jar"},new String[]{"test.jar"});
  Assert.assertNotNull(data);
  BatchInstallResult batch=BatchInstallResult.from(data);
  Assert.assertEquals(2,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingLocationItems());
  Mockito.reset(context);
  Mockito.when(spiedMBean.createStream(Mockito.anyString())).thenReturn(stream);
  Mockito.when(context.installBundle(Mockito.anyString(),Mockito.any(InputStream.class))).thenThrow(new BundleException("location doesn't exist"));
  CompositeData data2=spiedMBean.installBundlesFromURL(new String[]{"file:test.jar"},new String[]{"test.jar"});
  BatchInstallResult batch2=BatchInstallResult.from(data2);
  Assert.assertNotNull(batch2);
  Assert.assertNotNull(batch2.getCompleted());
  Assert.assertEquals(0,batch2.getCompleted().length);
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertEquals("file:test.jar",batch2.getBundleInError());
  Assert.assertNotNull(batch2.getRemainingLocationItems());
  Assert.assertEquals(0,batch2.getRemainingLocationItems().length);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStartBundles() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(5)).thenReturn(bundle);
  CompositeData data=mbean.startBundles(new long[]{5});
  Mockito.verify(bundle).start();
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(5,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=mbean.startBundles(null);
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertNull(batch2.getCompleted());
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateBundlesFromURL() throws Exception {
  Framework spiedMBean=Mockito.spy(mbean);
  InputStream stream=Mockito.mock(InputStream.class);
  Mockito.doReturn(stream).when(spiedMBean).createStream(Mockito.anyString());
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(5)).thenReturn(bundle);
  CompositeData data=spiedMBean.updateBundlesFromURL(new long[]{5},new String[]{"file:test.jar"});
  Mockito.verify(bundle).update(stream);
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(5,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=spiedMBean.updateBundlesFromURL(new long[]{2,4},new String[]{"file:test.jar"});
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallBundles() throws Exception {
  String[] locations=new String[]{"file:test.jar"};
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.installBundle("file:test.jar")).thenReturn(bundle);
  Mockito.when(bundle.getBundleId()).thenReturn(Long.valueOf(2));
  CompositeData data=mbean.installBundles(locations);
  BatchInstallResult batch=BatchInstallResult.from(data);
  Assert.assertNotNull(batch);
  Assert.assertEquals(2,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingLocationItems());
  Mockito.reset(context);
  Mockito.when(context.installBundle("file:test.jar")).thenThrow(new BundleException("location doesn't exist"));
  CompositeData data2=mbean.installBundles(locations);
  BatchInstallResult batch2=BatchInstallResult.from(data2);
  Assert.assertNotNull(batch2);
  Assert.assertNotNull(batch2.getCompleted());
  Assert.assertEquals(0,batch2.getCompleted().length);
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertEquals("file:test.jar",batch2.getBundleInError());
  Assert.assertNotNull(batch2.getRemainingLocationItems());
  Assert.assertEquals(0,batch2.getRemainingLocationItems().length);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetBundleStartLevels() throws IOException {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(2)).thenReturn(bundle);
  CompositeData data=mbean.setBundleStartLevels(new long[]{2},new int[]{2});
  Mockito.verify(startLevel).setBundleStartLevel(bundle,2);
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(2,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=mbean.setBundleStartLevels(new long[]{2},new int[]{2,4});
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertNull(batch2.getCompleted());
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateBundles() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(5)).thenReturn(bundle);
  CompositeData data=mbean.updateBundles(new long[]{5});
  Mockito.verify(bundle).update();
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(5,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=mbean.updateBundles(null);
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertNull(batch2.getCompleted());
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
  Mockito.reset(bundle);
  CompositeData data3=mbean.updateBundles(new long[]{6});
  Mockito.when(context.getBundle(6)).thenReturn(bundle);
  Mockito.doThrow(new BundleException("")).when(bundle).update();
  BatchActionResult batch3=BatchActionResult.from(data3);
  Assert.assertEquals(0,batch3.getCompleted().length);
  Assert.assertFalse(batch3.isSuccess());
  Assert.assertNotNull(batch3.getError());
  Assert.assertEquals(6,batch3.getBundleInError());
  Bundle bundle6=Mockito.mock(Bundle.class);
  Bundle bundle8=Mockito.mock(Bundle.class);
  Bundle bundle7=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(6)).thenReturn(bundle6);
  Mockito.when(context.getBundle(8)).thenReturn(bundle8);
  Mockito.when(context.getBundle(7)).thenReturn(bundle7);
  Mockito.doThrow(new BundleException("")).when(bundle8).update();
  CompositeData data4=mbean.updateBundles(new long[]{6,8,7});
  BatchActionResult batch4=BatchActionResult.from(data4);
  Mockito.verify(bundle6).update();
  Assert.assertEquals(1,batch4.getCompleted().length);
  Assert.assertEquals(6,batch4.getCompleted()[0]);
  Assert.assertFalse(batch4.isSuccess());
  Assert.assertNotNull(batch4.getError());
  Assert.assertEquals(8,batch4.getBundleInError());
  Assert.assertEquals(1,batch4.getRemainingItems().length);
  Assert.assertEquals(7,batch4.getRemainingItems()[0]);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUninstallBundles() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(5)).thenReturn(bundle);
  CompositeData data=mbean.uninstallBundles(new long[]{5});
  Mockito.verify(bundle).uninstall();
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(5,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=mbean.uninstallBundles(null);
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertNull(batch2.getCompleted());
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallBundleFromURL() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.installBundle(Mockito.anyString(),Mockito.any(InputStream.class))).thenReturn(bundle);
  Mockito.when(bundle.getBundleId()).thenReturn(Long.valueOf(2));
  Framework spiedMBean=Mockito.spy(mbean);
  InputStream stream=Mockito.mock(InputStream.class);
  Mockito.doReturn(stream).when(spiedMBean).createStream("test.jar");
  long bundleId=spiedMBean.installBundleFromURL("file:test.jar","test.jar");
  Assert.assertEquals(2,bundleId);
  Mockito.reset(context);
  Mockito.doReturn(stream).when(spiedMBean).createStream(Mockito.anyString());
  Mockito.when(context.installBundle(Mockito.anyString(),Mockito.any(InputStream.class))).thenThrow(new BundleException("location doesn't exist"));
  try {
    spiedMBean.installBundleFromURL("file:test2.jar","test.jar");
    Assert.fail("Shouldn't go to this stage, location doesn't exist");
  }
 catch (  IOException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStopBundles() throws Exception {
  Bundle bundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundle(5)).thenReturn(bundle);
  CompositeData data=mbean.stopBundles(new long[]{5});
  Mockito.verify(bundle).stop();
  BatchActionResult batch=BatchActionResult.from(data);
  Assert.assertEquals(5,batch.getCompleted()[0]);
  Assert.assertTrue(batch.isSuccess());
  Assert.assertNull(batch.getError());
  Assert.assertNull(batch.getRemainingItems());
  CompositeData data2=mbean.stopBundles(null);
  BatchActionResult batch2=BatchActionResult.from(data2);
  Assert.assertNull(batch2.getCompleted());
  Assert.assertFalse(batch2.isSuccess());
  Assert.assertNotNull(batch2.getError());
  Assert.assertNull(batch2.getRemainingItems());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.PackageStateMBeanTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObjectName() throws Exception {
  Set<ObjectName> names=mbeanServer.queryNames(new ObjectName(PackageStateMBean.OBJECTNAME + ",*"),null);
  assertEquals(1,names.size());
  ObjectName name=names.iterator().next();
  Hashtable<String,String> props=name.getKeyPropertyList();
  assertEquals(context().getProperty(Constants.FRAMEWORK_UUID),props.get("uuid"));
  assertEquals(context().getBundle(0).getSymbolicName(),props.get("framework"));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMBeanInterface() throws IOException {
  PackageStateMBean packagaState=getMBean(PackageStateMBean.OBJECTNAME,PackageStateMBean.class);
  assertNotNull(packagaState);
  long[] exportingBundles=packagaState.getExportingBundles("org.osgi.jmx.framework","1.7.0");
  assertNotNull(exportingBundles);
  assertTrue("Should find a bundle exporting org.osgi.jmx.framework",exportingBundles.length > 0);
  long[] exportingBundles2=packagaState.getExportingBundles("test","1.0.0");
  assertNull("Shouldn't find a bundle exporting test package",exportingBundles2);
  long[] importingBundlesId=packagaState.getImportingBundles("org.osgi.jmx.framework","1.7.0",exportingBundles[0]);
  assertTrue("Should find bundles importing org.osgi.jmx.framework",importingBundlesId.length > 0);
  TabularData table=packagaState.listPackages();
  assertNotNull("TabularData containing CompositeData with packages info shouldn't be null",table);
  assertEquals("TabularData should be a type PACKAGES",PackageStateMBean.PACKAGES_TYPE,table.getTabularType());
  Collection<?> colData=table.values();
  assertNotNull("Collection of CompositeData shouldn't be null",colData);
  assertFalse("Collection of CompositeData should contain elements",colData.isEmpty());
  boolean isRemovalPending=packagaState.isRemovalPending("org.osgi.jmx.framework","1.7.0",exportingBundles[0]);
  assertFalse("Should removal pending on org.osgi.jmx.framework be false",isRemovalPending);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.PackageStateTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListPackages() throws IOException {
  Bundle bundle=Mockito.mock(Bundle.class);
  Bundle impBundle=Mockito.mock(Bundle.class);
  Mockito.when(context.getBundles()).thenReturn(new Bundle[]{bundle});
  ExportedPackage exported=Mockito.mock(ExportedPackage.class);
  Mockito.when(exported.getVersion()).thenReturn(Version.parseVersion("1.0.0"));
  Mockito.when(exported.getImportingBundles()).thenReturn(new Bundle[]{impBundle});
  Mockito.when(exported.getName()).thenReturn("test");
  Mockito.when(exported.getExportingBundle()).thenReturn(bundle);
  Mockito.when(bundle.getBundleId()).thenReturn(Long.valueOf(4));
  Mockito.when(impBundle.getBundleId()).thenReturn(Long.valueOf(5));
  Mockito.when(admin.getExportedPackages(bundle)).thenReturn(new ExportedPackage[]{exported});
  TabularData table=mbean.listPackages();
  Assert.assertEquals(PackageStateMBean.PACKAGES_TYPE,table.getTabularType());
  Collection values=table.values();
  Assert.assertEquals(1,values.size());
  CompositeData data=(CompositeData)values.iterator().next();
  Long[] exportingBundles=(Long[])data.get(PackageStateMBean.EXPORTING_BUNDLES);
  Assert.assertArrayEquals(new Long[]{Long.valueOf(4)},exportingBundles);
  String name=(String)data.get(PackageStateMBean.NAME);
  Assert.assertEquals("test",name);
  String version=(String)data.get(PackageStateMBean.VERSION);
  Assert.assertEquals("1.0.0",version);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.ServiceStateMBeanTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObjectName() throws Exception {
  Set<ObjectName> names=mbeanServer.queryNames(new ObjectName(ServiceStateMBean.OBJECTNAME + ",*"),null);
  assertEquals(1,names.size());
  ObjectName name=names.iterator().next();
  Hashtable<String,String> props=name.getKeyPropertyList();
  assertEquals(context().getProperty(Constants.FRAMEWORK_UUID),props.get("uuid"));
  assertEquals(context().getBundle(0).getSymbolicName(),props.get("framework"));
}

</code></pre>

<br>
<pre class="type-4 type-9 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void doSetUp(){
  waitForMBean(ServiceStateMBean.OBJECTNAME);
  objectName=waitForMBean(ServiceStateMBean.OBJECTNAME);
  mbean=getMBean(objectName,ServiceStateMBean.class);
  assertNotNull(mbean);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListServices() throws Exception {
  String filter="(" + Constants.SERVICE_PID + "=*)";
  ServiceReference[] refs=bundleContext.getAllServiceReferences(null,filter);
  TabularData svcData=mbean.listServices(null,filter);
  assertEquals(refs.length,svcData.size());
  ServiceReference sref=bundleContext.getServiceReference(InterfaceA.class);
  TabularData svcTab=mbean.listServices(InterfaceA.class.getName(),null);
  assertEquals(1,svcTab.size());
  CompositeData actualSvc=(CompositeData)svcTab.values().iterator().next();
  CompositeData expectedSvc=mbean.getService((Long)sref.getProperty(Constants.SERVICE_ID));
  assertEquals(expectedSvc,actualSvc);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceAndGetProperty() throws Exception {
  ServiceReference sref=bundleContext.getServiceReference(InterfaceA.class);
  context().getService(sref);
  Long serviceID=(Long)sref.getProperty(Constants.SERVICE_ID);
  CompositeData svcData=mbean.getService(serviceID);
  assertEquals(serviceID,svcData.get(ServiceStateMBean.IDENTIFIER));
  assertEquals(sref.getBundle().getBundleId(),svcData.get(ServiceStateMBean.BUNDLE_IDENTIFIER));
  Set<String> expectedClasses=new HashSet<String>(Arrays.asList(InterfaceA.class.getName(),ManagedService.class.getName()));
  Set<String> actualClasses=new HashSet<String>(Arrays.asList((String[])svcData.get(ServiceStateMBean.OBJECT_CLASS)));
  assertEquals(expectedClasses,actualClasses);
  Bundle[] ub=sref.getUsingBundles();
  assertEquals("Precondition",1,ub.length);
  assertTrue(Arrays.equals(new Long[]{ub[0].getBundleId()},(Long[])svcData.get("UsingBundles")));
  String pid=(String)sref.getProperty(Constants.SERVICE_PID);
  CompositeData pidData=mbean.getProperty(serviceID,Constants.SERVICE_PID);
  assertEquals(pid,pidData.get("Value"));
  assertEquals("String",pidData.get("Type"));
  CompositeData idData=mbean.getProperty(serviceID,Constants.SERVICE_ID);
  assertEquals("" + serviceID,idData.get("Value"));
  assertEquals("Long",idData.get("Type"));
  CompositeData ocData=mbean.getProperty(serviceID,Constants.OBJECTCLASS);
  String form1=InterfaceA.class.getName() + "," + ManagedService.class.getName();
  String form2=ManagedService.class.getName() + "," + InterfaceA.class.getName();
  assertTrue(ocData.get("Value").equals(form1) || ocData.get("Value").equals(form2));
  assertEquals("Array of String",ocData.get("Type"));
  context().ungetService(sref);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMBeanInterface() throws Exception {
  Bundle a=getBundleByName("org.apache.aries.jmx.test.bundlea");
  assertBundleStarted(a);
  Bundle b=getBundleByName("org.apache.aries.jmx.test.bundleb");
  assertBundleStarted(b);
  ServiceReference refA=bundleContext.getServiceReference(InterfaceA.class.getName());
  assertNotNull(refA);
  long serviceAId=(Long)refA.getProperty(Constants.SERVICE_ID);
  assertTrue(serviceAId > -1);
  ServiceReference refB=bundleContext.getServiceReference(InterfaceB.class.getName());
  assertNotNull(refB);
  long serviceBId=(Long)refB.getProperty(Constants.SERVICE_ID);
  assertTrue(serviceBId > -1);
  ServiceReference[] refs=bundleContext.getServiceReferences(ManagedServiceFactory.class.getName(),"(" + Constants.SERVICE_PID + "=jmx.test.B.factory)");
  assertNotNull(refs);
  assertEquals(1,refs.length);
  ServiceReference msf=refs[0];
  assertEquals(a.getBundleId(),mbean.getBundleIdentifier(serviceAId));
  String[] objectClass=mbean.getObjectClass(serviceAId);
  assertEquals(2,objectClass.length);
  List<String> classNames=Arrays.asList(objectClass);
  assertTrue(classNames.contains(InterfaceA.class.getName()));
  assertTrue(classNames.contains(ManagedService.class.getName()));
  TabularData serviceProperties=mbean.getProperties(serviceBId);
  assertNotNull(serviceProperties);
  assertEquals(JmxConstants.PROPERTIES_TYPE,serviceProperties.getTabularType());
  assertTrue(serviceProperties.values().size() > 1);
  assertEquals("org.apache.aries.jmx.test.ServiceB",PropertyData.from(serviceProperties.get(new Object[]{Constants.SERVICE_PID})).getValue());
  long[] usingBundles=mbean.getUsingBundles(serviceBId);
  assertEquals(1,usingBundles.length);
  assertEquals(a.getBundleId(),usingBundles[0]);
  ServiceReference[] allSvsRefs=bundleContext.getAllServiceReferences(null,null);
  TabularData allServices=mbean.listServices();
  assertNotNull(allServices);
  assertEquals(allSvsRefs.length,allServices.values().size());
  final List<Notification> received=new ArrayList<Notification>();
  final List<AttributeChangeNotification> attributeChanges=new ArrayList<AttributeChangeNotification>();
  mbeanServer.addNotificationListener(objectName,new NotificationListener(){
    public void handleNotification(    Notification notification,    Object handback){
      if (notification instanceof AttributeChangeNotification) {
        attributeChanges.add((AttributeChangeNotification)notification);
      }
 else {
        received.add(notification);
      }
    }
  }
,null,null);
  assertNotNull(refB);
  assertNotNull(msf);
  b.stop();
  refB=bundleContext.getServiceReference(InterfaceB.class.getName());
  refs=bundleContext.getServiceReferences(ManagedServiceFactory.class.getName(),"(" + Constants.SERVICE_PID + "=jmx.test.B.factory)");
  assertNull(refs);
  assertNull(refB);
  b.start();
  refB=bundleContext.getServiceReference(InterfaceB.class.getName());
  refs=bundleContext.getServiceReferences(ManagedServiceFactory.class.getName(),"(" + Constants.SERVICE_PID + "=jmx.test.B.factory)");
  assertNotNull(refB);
  assertNotNull(refs);
  assertEquals(1,refs.length);
  waitForListToReachSize(received,4);
  assertEquals(4,received.size());
  assertEquals(4,attributeChanges.size());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-16 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAttributeChangeNotifications() throws Exception {
  final List<AttributeChangeNotification> attributeChanges=new ArrayList<AttributeChangeNotification>();
  mbeanServer.addNotificationListener(objectName,new NotificationListener(){
    public void handleNotification(    Notification notification,    Object handback){
      if (notification instanceof AttributeChangeNotification) {
        attributeChanges.add((AttributeChangeNotification)notification);
      }
    }
  }
,null,null);
  assertEquals("Precondition",0,attributeChanges.size());
  long[] idsWithout=mbean.getServiceIds();
  String svc="A String Service";
  ServiceRegistration reg=bundleContext.registerService(String.class.getName(),svc,null);
  long id=(Long)reg.getReference().getProperty(Constants.SERVICE_ID);
  long[] idsWith=new long[idsWithout.length + 1];
  System.arraycopy(idsWithout,0,idsWith,0,idsWithout.length);
  idsWith[idsWith.length - 1]=id;
  Arrays.sort(idsWith);
  waitForListToReachSize(attributeChanges,1);
  AttributeChangeNotification ac=attributeChanges.get(0);
  assertEquals("ServiceIds",ac.getAttributeName());
  long seq1=ac.getSequenceNumber();
  assertTrue(Arrays.equals(idsWithout,(long[])ac.getOldValue()));
  assertTrue(Arrays.equals(idsWith,(long[])ac.getNewValue()));
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put("somekey","someval");
  reg.setProperties(props);
  Thread.sleep(500);
  assertEquals("Changing the service registration should not cause an attribute notification",1,attributeChanges.size());
  reg.unregister();
  waitForListToReachSize(attributeChanges,2);
  AttributeChangeNotification ac2=attributeChanges.get(1);
  assertEquals("ServiceIds",ac2.getAttributeName());
  assertEquals(seq1 + 1,ac2.getSequenceNumber());
  assertTrue(Arrays.equals(idsWith,(long[])ac2.getOldValue()));
  assertTrue(Arrays.equals(idsWithout,(long[])ac2.getNewValue()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("unchecked") public void testServicePropertiesInListServices() throws Exception {
  ServiceReference[] refs=bundleContext.getAllServiceReferences(InterfaceA.class.getName(),null);
  assertEquals("Precondition",1,refs.length);
  ServiceReference ref=refs[0];
  TabularData svcTab=mbean.listServices();
  CompositeData svcData=svcTab.get(new Object[]{ref.getProperty(Constants.SERVICE_ID)});
  Set<String> expectedOCs=new HashSet<String>(Arrays.asList(InterfaceA.class.getName(),ManagedService.class.getName()));
  Set<String> actualOCs=new HashSet<String>(Arrays.asList((String[])svcData.get(Constants.OBJECTCLASS)));
  assertEquals(expectedOCs,actualOCs);
  Map<String,Object> expectedProperties=new HashMap<String,Object>();
  for (  String key : ref.getPropertyKeys()) {
    Object value=ref.getProperty(key);
    if (value.getClass().isArray())     continue;
    expectedProperties.put(key,value);
  }
  Map<String,Object> actualProperties=new HashMap<String,Object>();
  TabularData actualProps=(TabularData)svcData.get(ServiceStateMBean.PROPERTIES);
  for (  CompositeData cd : (Collection<CompositeData>)actualProps.values()) {
    Object type=cd.get(JmxConstants.TYPE);
    if (JmxConstants.STRING.equals(type)) {
      actualProperties.put((String)cd.get(JmxConstants.KEY),cd.get(JmxConstants.VALUE));
    }
 else     if (JmxConstants.LONG.equals(type)) {
      actualProperties.put((String)cd.get(JmxConstants.KEY),Long.valueOf(cd.get(JmxConstants.VALUE).toString()));
    }
  }
  assertEquals(expectedProperties,actualProperties);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testListServicesSelectiveItems() throws Exception {
  String filter="(|(service.pid=org.apache.aries.jmx.test.ServiceB)(service.pid=jmx.test.B.factory))";
  ServiceReference[] refs=bundleContext.getAllServiceReferences(null,filter);
  TabularData svcData=mbean.listServices(null,filter,ServiceStateMBean.BUNDLE_IDENTIFIER);
  assertEquals(refs.length,svcData.size());
  long id=refs[0].getBundle().getBundleId();
  for (  ServiceReference ref : refs) {
    assertEquals("Precondition",id,ref.getBundle().getBundleId());
  }
  for (  CompositeData cd : new ArrayList<CompositeData>((Collection<CompositeData>)svcData.values())) {
    assertEquals(id,cd.get(ServiceStateMBean.BUNDLE_IDENTIFIER));
    assertNotNull(cd.get(ServiceStateMBean.IDENTIFIER));
    assertNull(cd.get(ServiceStateMBean.OBJECT_CLASS));
    assertNull(cd.get(ServiceStateMBean.USING_BUNDLES));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.ServiceStateTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNotificationsForServiceEvents() throws Exception {
  StateConfig stateConfig=new StateConfig();
  List<Notification> received=new LinkedList<Notification>();
  List<AttributeChangeNotification> attributeChanges=new LinkedList<AttributeChangeNotification>();
  createService(stateConfig,received,attributeChanges);
  assertEquals(2,received.size());
  Notification registered=received.get(0);
  assertEquals(1,registered.getSequenceNumber());
  CompositeData data=(CompositeData)registered.getUserData();
  assertEquals(new Long(44),data.get(IDENTIFIER));
  assertEquals(new Long(9),data.get(BUNDLE_IDENTIFIER));
  assertEquals("file:/location",data.get(BUNDLE_LOCATION));
  assertEquals("bundle",data.get(BUNDLE_SYMBOLIC_NAME));
  assertArrayEquals(new String[]{"org.apache.aries.jmx.Mock"},(String[])data.get(OBJECT_CLASS));
  assertEquals(ServiceEvent.REGISTERED,data.get(EVENT));
  Notification modified=received.get(1);
  assertEquals(2,modified.getSequenceNumber());
  data=(CompositeData)modified.getUserData();
  assertEquals(new Long(44),data.get(IDENTIFIER));
  assertEquals(new Long(9),data.get(BUNDLE_IDENTIFIER));
  assertEquals("file:/location",data.get(BUNDLE_LOCATION));
  assertEquals("bundle",data.get(BUNDLE_SYMBOLIC_NAME));
  assertArrayEquals(new String[]{"org.apache.aries.jmx.Mock"},(String[])data.get(OBJECT_CLASS));
  assertEquals(ServiceEvent.MODIFIED,data.get(EVENT));
  assertEquals(1,attributeChanges.size());
  AttributeChangeNotification ac=attributeChanges.get(0);
  assertEquals("ServiceIds",ac.getAttributeName());
  assertEquals(0,((long[])ac.getOldValue()).length);
  assertEquals(1,((long[])ac.getNewValue()).length);
  assertEquals(44L,((long[])ac.getNewValue())[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.wiring.BundleWiringStateMBeanTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObjectName() throws Exception {
  Set<ObjectName> names=mbeanServer.queryNames(new ObjectName(BundleWiringStateMBean.OBJECTNAME + ",*"),null);
  assertEquals(1,names.size());
  ObjectName name=names.iterator().next();
  Hashtable<String,String> props=name.getKeyPropertyList();
  assertEquals(context().getProperty(Constants.FRAMEWORK_UUID),props.get("uuid"));
  assertEquals(context().getBundle(0).getSymbolicName(),props.get("framework"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetCurrentRevisionDeclaredRequirements() throws Exception {
  Bundle a=getBundleByName("org.apache.aries.jmx.test.bundlea");
  BundleRevision br=(BundleRevision)a.adapt(BundleRevision.class);
  List<BundleRequirement> requirements=br.getDeclaredRequirements(BundleRevision.PACKAGE_NAMESPACE);
  CompositeData[] jmxRequirements=brsMBean.getCurrentRevisionDeclaredRequirements(a.getBundleId(),BundleRevision.PACKAGE_NAMESPACE);
  Assert.assertEquals(requirements.size(),jmxRequirements.length);
  Map<Map<String,Object>,Map<String,String>> expectedRequirements=requirementsToMap(requirements);
  Map<Map<String,Object>,Map<String,String>> actualRequirements=jmxCapReqToMap(jmxRequirements);
  Assert.assertEquals(expectedRequirements,actualRequirements);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRevisionsDeclaredRequirements() throws Exception {
  BundleRevisions revisions=(BundleRevisions)bundleA.adapt(BundleRevisions.class);
  Assert.assertEquals("Precondition",1,revisions.getRevisions().size());
  TabularData jmxRequirementsTable=brsMBean.getRevisionsDeclaredRequirements(bundleA.getBundleId(),BundleRevision.PACKAGE_NAMESPACE);
  Assert.assertEquals(1,jmxRequirementsTable.size());
  List<BundleRequirement> requirements=((BundleRevision)revisions.getRevisions().iterator().next()).getDeclaredRequirements(BundleRevision.PACKAGE_NAMESPACE);
  CompositeData jmxRevRequirements=(CompositeData)jmxRequirementsTable.values().iterator().next();
  CompositeData[] jmxRequirements=(CompositeData[])jmxRevRequirements.get(BundleWiringStateMBean.REQUIREMENTS);
  Map<Map<String,Object>,Map<String,String>> expectedRequirements=requirementsToMap(requirements);
  Map<Map<String,Object>,Map<String,String>> actualRequirements=jmxCapReqToMap(jmxRequirements);
  Assert.assertEquals(expectedRequirements,actualRequirements);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRevisionsDeclaredCapabilities() throws Exception {
  BundleRevisions revisions=(BundleRevisions)bundleA.adapt(BundleRevisions.class);
  Assert.assertEquals("Precondition",1,revisions.getRevisions().size());
  TabularData jmxCapabilitiesTable=brsMBean.getRevisionsDeclaredCapabilities(bundleA.getBundleId(),BundleRevision.PACKAGE_NAMESPACE);
  Assert.assertEquals(1,jmxCapabilitiesTable.size());
  List<BundleCapability> capabilities=((BundleRevision)revisions.getRevisions().iterator().next()).getDeclaredCapabilities(BundleRevision.PACKAGE_NAMESPACE);
  CompositeData jmxRevCapabilities=(CompositeData)jmxCapabilitiesTable.values().iterator().next();
  CompositeData[] jmxCapabilities=(CompositeData[])jmxRevCapabilities.get(BundleWiringStateMBean.CAPABILITIES);
  Map<Map<String,Object>,Map<String,String>> expectedCapabilities=capabilitiesToMap(capabilities);
  Map<Map<String,Object>,Map<String,String>> actualCapabilities=jmxCapReqToMap(jmxCapabilities);
  Assert.assertEquals(expectedCapabilities,actualCapabilities);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetCurrentRevisionDeclaredCapabilities() throws Exception {
  BundleRevision br=(BundleRevision)bundleA.adapt(BundleRevision.class);
  List<BundleCapability> capabilities=br.getDeclaredCapabilities(BundleRevision.PACKAGE_NAMESPACE);
  CompositeData[] jmxCapabilities=brsMBean.getCurrentRevisionDeclaredCapabilities(bundleA.getBundleId(),BundleRevision.PACKAGE_NAMESPACE);
  Assert.assertEquals(capabilities.size(),jmxCapabilities.length);
  Map<Map<String,Object>,Map<String,String>> expectedCapabilities=capabilitiesToMap(capabilities);
  Map<Map<String,Object>,Map<String,String>> actualCapabilities=jmxCapReqToMap(jmxCapabilities);
  Assert.assertEquals(expectedCapabilities,actualCapabilities);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevisionsWiring() throws Exception {
  TabularData jmxWiringTable=brsMBean.getRevisionsWiring(bundleA.getBundleId(),BundleRevision.PACKAGE_NAMESPACE);
  Assert.assertEquals(1,jmxWiringTable.size());
  CompositeData jmxWiring=(CompositeData)jmxWiringTable.values().iterator().next();
  Assert.assertEquals(BundleWiringStateMBean.BUNDLE_WIRING_TYPE,jmxWiring.getCompositeType());
  Assert.assertEquals(bundleA.getBundleId(),jmxWiring.get(BundleWiringStateMBean.BUNDLE_ID));
  BundleWiring bw=(BundleWiring)bundleA.adapt(BundleWiring.class);
  assertBundleWiring(bw,jmxWiring);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.permissionadmin.PermissionAdminMBeanTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMBeanInterface() throws IOException {
  PermissionAdminMBean mBean=getMBean(PermissionAdminMBean.OBJECTNAME,PermissionAdminMBean.class);
  PermissionAdmin permAdminService=context().getService(PermissionAdmin.class);
  assertNotNull(permAdminService);
  String[] serviceLocation=permAdminService.getLocations();
  String[] mBeanLocations=mBean.listLocations();
  assertArrayEquals(serviceLocation,mBeanLocations);
  PermissionInfo defPerm=new PermissionInfo("AllPermission","*","*");
  permAdminService.setDefaultPermissions(new PermissionInfo[]{defPerm});
  PermissionInfo[] permissions=permAdminService.getDefaultPermissions();
  assertNotNull(permissions);
  String[] encoded=toEncodedPerm(permissions);
  String[] mBeanDefPermissions=mBean.listDefaultPermissions();
  assertArrayEquals(encoded,mBeanDefPermissions);
  Bundle a=context().getBundleByName("org.apache.aries.jmx.test.bundlea");
  assertNotNull(a);
  String location=a.getLocation();
  PermissionInfo bundleaPerm=new PermissionInfo("ServicePermission","ServiceA","GET");
  mBean.setPermissions(location,new String[]{bundleaPerm.getEncoded()});
  String[] serviceBundleaPerm=toEncodedPerm(permAdminService.getPermissions(location));
  String[] mBeanBundleaPerm=mBean.getPermissions(location);
  assertNotNull(mBeanBundleaPerm);
  assertArrayEquals(serviceBundleaPerm,mBeanBundleaPerm);
  PermissionInfo defaultPerm=new PermissionInfo("AllPermission","*","GET");
  mBean.setDefaultPermissions(new String[]{defaultPerm.getEncoded()});
  String[] serviceDefaultPerm=toEncodedPerm(permAdminService.getDefaultPermissions());
  String[] mBeanDefaultPerm=mBean.listDefaultPermissions();
  assertNotNull(mBeanDefaultPerm);
  assertArrayEquals(serviceDefaultPerm,mBeanDefaultPerm);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.provisioning.ProvisioningServiceMBeanTest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("For now.. Cannot find public repo for org.eclipse.equinox.ip") @Test @SuppressWarnings({"unchecked"}) public void testMBeanInterface() throws Exception {
  ProvisioningServiceMBean mbean=getMBean(ProvisioningServiceMBean.OBJECTNAME,ProvisioningServiceMBean.class);
  Dictionary<String,Object> info;
  File provZip=createProvAgentConfigZip();
  mbean.addInformationFromZip(provZip.toURI().toURL().toExternalForm());
  info=ps.getInformation();
  assertNotNull(info);
  assertTrue(info.size() >= 1);
  assertProvAgentConfigCorrect(info);
  TabularData data=mbean.listInformation();
  assertNotNull(data);
  assertEquals(JmxConstants.PROPERTIES_TYPE,data.getTabularType());
  assertTrue(data.values().size() >= 1);
  PropertyData<byte[]> configEntry=PropertyData.from(data.get(new Object[]{PROVISIONING_AGENT_CONFIG}));
  assertNotNull(configEntry);
  assertArrayEquals(new byte[]{10,20,30},configEntry.getValue());
  PropertyData<String> reference=PropertyData.newInstance(PROVISIONING_REFERENCE,"rsh://0.0.0.0/provX");
  data.put(reference.toCompositeData());
  mbean.addInformation(data);
  info=ps.getInformation();
  assertNotNull(info);
  assertTrue(info.size() >= 2);
  assertProvAgentConfigCorrect(info);
  String ref=(String)info.get(PROVISIONING_REFERENCE);
  assertNotNull(ref);
  assertEquals("rsh://0.0.0.0/provX",ref);
  data.clear();
  PropertyData<String> newRef=PropertyData.newInstance(PROVISIONING_REFERENCE,"rsh://0.0.0.0/newProvRef");
  data.put(newRef.toCompositeData());
  mbean.setInformation(data);
  info=ps.getInformation();
  assertNotNull(info);
  assertTrue(info.size() >= 1);
  assertNull(info.get(PROVISIONING_AGENT_CONFIG));
  ref=(String)info.get(PROVISIONING_REFERENCE);
  assertNotNull(ref);
  assertEquals("rsh://0.0.0.0/newProvRef",ref);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.provisioning.ProvisioningServiceTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListInformation() throws Exception {
  org.osgi.service.provisioning.ProvisioningService provService=mock(org.osgi.service.provisioning.ProvisioningService.class);
  ProvisioningService mbean=new ProvisioningService(provService);
  Dictionary<String,Object> info=new Hashtable<String,Object>();
  info.put(PROVISIONING_AGENT_CONFIG,new byte[]{20,30,40});
  info.put(PROVISIONING_SPID,"x.test");
  info.put(PROVISIONING_REFERENCE,"rsh://0.0.0.0/provX");
  info.put(PROVISIONING_RSH_SECRET,new byte[]{15,25,35});
  info.put(PROVISIONING_UPDATE_COUNT,1);
  when(provService.getInformation()).thenReturn(info);
  TabularData provData=mbean.listInformation();
  assertNotNull(provData);
  assertEquals(PROPERTIES_TYPE,provData.getTabularType());
  assertEquals(5,provData.values().size());
  PropertyData<byte[]> agentConfig=PropertyData.from(provData.get(new Object[]{PROVISIONING_AGENT_CONFIG}));
  assertArrayEquals(new byte[]{20,30,40},agentConfig.getValue());
  PropertyData<String> spid=PropertyData.from(provData.get(new Object[]{PROVISIONING_SPID}));
  assertEquals("x.test",spid.getValue());
  PropertyData<String> ref=PropertyData.from(provData.get(new Object[]{PROVISIONING_REFERENCE}));
  assertEquals("rsh://0.0.0.0/provX",ref.getValue());
  PropertyData<byte[]> sec=PropertyData.from(provData.get(new Object[]{PROVISIONING_RSH_SECRET}));
  assertArrayEquals(new byte[]{15,25,35},sec.getValue());
  PropertyData<Integer> count=PropertyData.from(provData.get(new Object[]{PROVISIONING_UPDATE_COUNT}));
  assertEquals(new Integer(1),count.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.test.blueprint.BlueprintMBeanTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlueprintMetaDataMBean() throws Exception {
  String filter="(&(osgi.blueprint.container.symbolicname=" + sample.getSymbolicName() + ")(osgi.blueprint.container.version="+ sample.getVersion()+ "))";
  ServiceReference[] serviceReferences=null;
  try {
    serviceReferences=bundleContext.getServiceReferences(BlueprintContainer.class.getName(),filter);
  }
 catch (  InvalidSyntaxException e) {
    throw new RuntimeException(e);
  }
  long sampleBlueprintContainerServiceId=(Long)serviceReferences[0].getProperty(Constants.SERVICE_ID);
  BlueprintMetadataMBean metadataProxy=MBeanServerInvocationHandler.newProxyInstance(mbeanServer,new ObjectName(BlueprintMetadataMBean.OBJECTNAME),BlueprintMetadataMBean.class,false);
  long[] bpContainerServiceIds=metadataProxy.getBlueprintContainerServiceIds();
  assertEquals(3,bpContainerServiceIds.length);
  assertEquals(sampleBlueprintContainerServiceId,metadataProxy.getBlueprintContainerServiceId(sample.getBundleId()));
  BeanValidator bv_foo=new BeanValidator("org.apache.aries.blueprint.sample.Foo","init","destroy");
  BeanPropertyValidator bpv_a=property("a","5");
  BeanPropertyValidator bpv_b=property("b","-1");
  BeanPropertyValidator bpv_bar=new BeanPropertyValidator("bar");
  bpv_bar.setObjectValueValidator(new RefValidator("bar"));
  BeanPropertyValidator bpv_currency=property("currency","PLN");
  BeanPropertyValidator bpv_date=property("date","2009.04.17");
  bv_foo.addPropertyValidators(bpv_a,bpv_b,bpv_bar,bpv_currency,bpv_date);
  bv_foo.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"foo"));
  BeanPropertyValidator bpv_value=property("value","Hello FooBar");
  BeanPropertyValidator bpv_context=new BeanPropertyValidator("context");
  bpv_context.setObjectValueValidator(new RefValidator("blueprintBundleContext"));
  CollectionValidator cv=new CollectionValidator("java.util.List");
  cv.addCollectionValueValidators(new ValueValidator("a list element"),new ValueValidator("5","java.lang.Integer"));
  BeanPropertyValidator bpv_list=new BeanPropertyValidator("list");
  bpv_list.setObjectValueValidator(cv);
  BeanValidator bv_bar=new BeanValidator("org.apache.aries.blueprint.sample.Bar");
  bv_bar.addPropertyValidators(bpv_value,bpv_context,bpv_list);
  bv_bar.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"bar"));
  String[] serviceComponentIds=metadataProxy.getComponentIdsByType(sampleBlueprintContainerServiceId,BlueprintMetadataMBean.SERVICE_METADATA);
  assertEquals("There should be two service components in this sample",2,serviceComponentIds.length);
  MapEntryValidator mev=new MapEntryValidator();
  mev.setKeyValueValidator(new ValueValidator("key"),new ValueValidator("value"));
  RegistrationListenerValidator rglrv=new RegistrationListenerValidator("serviceRegistered","serviceUnregistered");
  rglrv.setListenerComponentValidator(new RefValidator("fooRegistrationListener"));
  ServiceValidator sv=new ServiceValidator(4);
  sv.setServiceComponentValidator(new RefValidator("foo"));
  sv.addMapEntryValidator(mev);
  sv.addRegistrationListenerValidator(rglrv);
  sv.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,serviceComponentIds[0]));
  BeanValidator bv_fooRegistrationListener=new BeanValidator("org.apache.aries.blueprint.sample.FooRegistrationListener");
  bv_fooRegistrationListener.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"fooRegistrationListener"));
  ReferenceListenerValidator rlrv_1=new ReferenceListenerValidator("bind","unbind");
  rlrv_1.setListenerComponentValidator(new RefValidator("bindingListener"));
  ReferenceValidator rv=new ReferenceValidator("org.apache.aries.blueprint.sample.InterfaceA",100);
  rv.addReferenceListenerValidator(rlrv_1);
  rv.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"ref2"));
  BeanValidator bv_bindingListener=new BeanValidator("org.apache.aries.blueprint.sample.BindingListener");
  bv_bindingListener.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"bindingListener"));
  ReferenceListenerValidator rlrv_2=new ReferenceListenerValidator("bind","unbind");
  rlrv_2.setListenerComponentValidator(new RefValidator("listBindingListener"));
  ReferenceListValidator rlv_ref_list=new ReferenceListValidator("org.apache.aries.blueprint.sample.InterfaceA");
  rlv_ref_list.addReferenceListenerValidator(rlrv_2);
  rlv_ref_list.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"ref-list"));
  BeanValidator bv_listBindingListener=new BeanValidator("org.apache.aries.blueprint.sample.BindingListener");
  bv_listBindingListener.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"listBindingListener"));
  ReferenceListenerValidator rlrv_3=new ReferenceListenerValidator("bind","unbind");
  rlrv_3.setListenerComponentValidator(new RefValidator("circularReference"));
  ReferenceListValidator rlv_2=new ReferenceListValidator("org.apache.aries.blueprint.sample.InterfaceA",2);
  rlv_2.addReferenceListenerValidator(rlrv_3);
  BeanPropertyValidator bpv_list_2=new BeanPropertyValidator("list");
  bpv_list_2.setObjectValueValidator(rlv_2);
  BeanValidator bv_circularReference=new BeanValidator("org.apache.aries.blueprint.sample.BindingListener","init");
  bv_circularReference.addPropertyValidators(bpv_list_2);
  bv_circularReference.validate(metadataProxy.getComponentMetadata(sampleBlueprintContainerServiceId,"circularReference"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.useradmin.UserAdminTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getAuthorization(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetAuthorization() throws IOException {
  Authorization auth=Mockito.mock(Authorization.class);
  User user=Mockito.mock(User.class);
  Mockito.when(user.getType()).thenReturn(Role.USER);
  Mockito.when(userAdmin.getAuthorization(user)).thenReturn(auth);
  Mockito.when(userAdmin.getRole("role1")).thenReturn(user);
  Mockito.when(auth.getName()).thenReturn("auth1");
  Mockito.when(auth.getRoles()).thenReturn(new String[]{"role1"});
  CompositeData data=mbean.getAuthorization("role1");
  Assert.assertNotNull(data);
  AuthorizationData authData=AuthorizationData.from(data);
  Assert.assertNotNull(authData);
  Assert.assertEquals("auth1",authData.getName());
  Assert.assertArrayEquals(new String[]{"role1"},authData.getRoles());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getRole(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetRole() throws IOException {
  User user1=Mockito.mock(User.class);
  Mockito.when(user1.getType()).thenReturn(Role.USER);
  Mockito.when(user1.getName()).thenReturn("user1");
  Mockito.when(userAdmin.getRole(Mockito.anyString())).thenReturn(user1);
  CompositeData data=mbean.getRole("user1");
  Assert.assertNotNull(data);
  RoleData role=RoleData.from(data);
  Assert.assertNotNull(role);
  Assert.assertEquals("user1",role.getName());
  Assert.assertEquals(Role.USER,role.getType());
  Mockito.verify(userAdmin).getRole(Mockito.anyString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getGroup(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetGroup() throws IOException {
  Group group1=Mockito.mock(Group.class);
  Mockito.when(group1.getType()).thenReturn(Role.GROUP);
  Mockito.when(group1.getName()).thenReturn("group1");
  Role role1=Mockito.mock(Role.class);
  Mockito.when(role1.getName()).thenReturn("role1");
  Role role2=Mockito.mock(Role.class);
  Mockito.when(role2.getName()).thenReturn("role2");
  Mockito.when(group1.getRequiredMembers()).thenReturn(new Role[]{role1});
  Mockito.when(group1.getMembers()).thenReturn(new Role[]{role2});
  Mockito.when(userAdmin.getRole(Mockito.anyString())).thenReturn(group1);
  CompositeData data=mbean.getGroup("group1");
  Assert.assertNotNull(data);
  GroupData group=GroupData.from(data);
  Assert.assertNotNull(group);
  Assert.assertEquals("group1",group.getName());
  Assert.assertEquals(Role.GROUP,group.getType());
  Assert.assertArrayEquals(new String[]{"role2"},group.getMembers());
  Assert.assertArrayEquals(new String[]{"role1"},group.getRequiredMembers());
  Mockito.verify(userAdmin).getRole(Mockito.anyString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getProperties(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetProperties() throws IOException {
  User user1=Mockito.mock(User.class);
  Dictionary<String,Object> properties=new Hashtable<String,Object>();
  properties.put("key","value");
  Mockito.when(user1.getProperties()).thenReturn(properties);
  Mockito.when(userAdmin.getRole(Mockito.anyString())).thenReturn(user1);
  TabularData data=mbean.getProperties("user1");
  Assert.assertNotNull(data);
  Assert.assertEquals(JmxConstants.PROPERTIES_TYPE,data.getTabularType());
  CompositeData composite=data.get(new Object[]{"key"});
  Assert.assertNotNull(composite);
  Assert.assertEquals("key",(String)composite.get(JmxConstants.KEY));
  Assert.assertEquals("value",(String)composite.get(JmxConstants.VALUE));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getUser(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetUser() throws IOException {
  User user1=Mockito.mock(User.class);
  Mockito.when(user1.getType()).thenReturn(Role.USER);
  Mockito.when(user1.getName()).thenReturn("user1");
  Mockito.when(userAdmin.getRole(Mockito.anyString())).thenReturn(user1);
  CompositeData data=mbean.getUser("user1");
  Assert.assertNotNull(data);
  UserData user=UserData.from(data);
  Assert.assertNotNull(user);
  Assert.assertEquals("user1",user.getName());
  Assert.assertEquals(Role.USER,user.getType());
  Mockito.verify(userAdmin).getRole(Mockito.anyString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.aries.jmx.useradmin.UserAdmin#getCredentials(java.lang.String)}.
 * @throws IOException
 */
@Test public void testGetCredentials() throws IOException {
  User user1=Mockito.mock(User.class);
  Dictionary<String,Object> properties=new Hashtable<String,Object>();
  properties.put("key","value");
  Mockito.when(user1.getCredentials()).thenReturn(properties);
  Mockito.when(user1.getType()).thenReturn(Role.USER);
  Mockito.when(userAdmin.getRole(Mockito.anyString())).thenReturn(user1);
  TabularData data=mbean.getCredentials("user1");
  Assert.assertNotNull(data);
  Assert.assertEquals(JmxConstants.PROPERTIES_TYPE,data.getTabularType());
  CompositeData composite=data.get(new Object[]{"key"});
  Assert.assertNotNull(composite);
  Assert.assertEquals("key",(String)composite.get(JmxConstants.KEY));
  Assert.assertEquals("value",(String)composite.get(JmxConstants.VALUE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.util.FrameworkUtilsTest </h4><pre class="type-4 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testResolveService() throws Exception {
  BundleContext context=mock(BundleContext.class);
  ServiceReference reference=mock(ServiceReference.class);
  when(context.getAllServiceReferences(anyString(),anyString())).thenReturn(new ServiceReference[]{reference});
  ServiceReference result=resolveService(context,998);
  assertNotNull(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.util.TypeUtilsTest </h4><pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromString() throws Exception {
  String value;
  value="1";
  Integer integerValue=fromString(Integer.class,value);
  assertEquals(new Integer(1),integerValue);
  int intValue=fromString(Integer.TYPE,value);
  assertEquals(1,intValue);
  Long wrappedLongValue=fromString(Long.class,value);
  assertEquals(Long.valueOf(1),wrappedLongValue);
  long longValue=fromString(Long.TYPE,value);
  assertEquals(1,longValue);
  Double wrappedDoubleValue=fromString(Double.class,value);
  assertEquals(Double.valueOf(1),wrappedDoubleValue);
  double doubleValue=fromString(Double.TYPE,value);
  assertEquals(1,doubleValue,0);
  Float wrappedFloatValue=fromString(Float.class,value);
  assertEquals(Float.valueOf(1),wrappedFloatValue);
  float floatValue=fromString(Float.TYPE,value);
  assertEquals(1,floatValue,0);
  Short shortValue=fromString(Short.class,value);
  assertEquals(Short.valueOf(value),shortValue);
  Byte byteValue=fromString(Byte.class,value);
  assertEquals(Byte.valueOf(value),byteValue);
  value="true";
  assertTrue(fromString(Boolean.class,value));
  assertTrue(fromString(Boolean.TYPE,value));
  char charValue=fromString(Character.TYPE,"a");
  assertEquals('a',charValue);
  Character characterValue=fromString(Character.class,"a");
  assertEquals(Character.valueOf('a'),characterValue);
  BigDecimal bigDecimal=fromString(BigDecimal.class,"2");
  assertEquals(new BigDecimal("2"),bigDecimal);
  BigInteger bigInteger=fromString(BigInteger.class,"2");
  assertEquals(new BigInteger("2"),bigInteger);
  String stringValue=fromString(String.class,value);
  assertEquals(stringValue,value);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapFromDictionary() throws Exception {
  Dictionary<String,String> dictionary=new Hashtable<String,String>();
  dictionary.put("one","1");
  dictionary.put("two","2");
  Map<String,String> map=fromDictionary(dictionary);
  assertEquals(2,map.size());
  assertEquals("1",map.get("one"));
  assertEquals("2",map.get("two"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.InitialContextTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLookupWithICF() throws NamingException {
  InitialContextFactory icf=Skeleton.newMock(InitialContextFactory.class);
  bc.registerService(new String[]{InitialContextFactory.class.getName(),icf.getClass().getName()},icf,(Dictionary)new Properties());
  Skeleton.getSkeleton(icf).setReturnValue(new MethodCall(Context.class,"lookup","/"),Skeleton.newMock(Context.class));
  Properties props=new Properties();
  props.put(Context.INITIAL_CONTEXT_FACTORY,icf.getClass().getName());
  props.put(JNDIConstants.BUNDLE_CONTEXT,bc);
  InitialContext ctx=new InitialContext(props);
  Context namingCtx=(Context)ctx.lookup("/");
  assertTrue("Context returned isn't the raw naming context: " + namingCtx,Skeleton.isSkeleton(namingCtx));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLookupWithoutICFButWithURLLookup() throws NamingException {
  ObjectFactory factory=Skeleton.newMock(ObjectFactory.class);
  Context ctx=Skeleton.newMock(Context.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),ctx);
  Skeleton.getSkeleton(ctx).setReturnValue(new MethodCall(Context.class,"lookup",String.class),"someText");
  Properties props=new Properties();
  props.put(JNDIConstants.JNDI_URLSCHEME,"testURL");
  bc.registerService(ObjectFactory.class.getName(),factory,(Dictionary)props);
  props=new Properties();
  props.put(JNDIConstants.BUNDLE_CONTEXT,bc);
  InitialContext initialCtx=new InitialContext(props);
  Object someObject=initialCtx.lookup("testURL:somedata");
  assertEquals("Expected to be given a string, but got something else.","someText",someObject);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.ObjectFactoryTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testURLReferenceUsingURLObjectFactoryFinder() throws Exception {
  String testObject="Test object";
  URLObjectFactoryFinder factory=Skeleton.newMock(URLObjectFactoryFinder.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),testObject);
  bc.registerService(URLObjectFactoryFinder.class.getName(),factory,(Dictionary)new Properties());
  Reference ref=new Reference(null);
  ref.add(new StringRefAddr("URL","wibble"));
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertEquals("The naming manager should have returned the test object",testObject,obj);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testURLReferenceWithMatchingHandler() throws Exception {
  String testObject="Test object";
  ObjectFactory factory=Skeleton.newMock(ObjectFactory.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),testObject);
  Properties props=new Properties();
  props.setProperty("osgi.jndi.urlScheme","wibble");
  bc.registerService(ObjectFactory.class.getName(),factory,(Dictionary)props);
  Reference ref=new Reference(null);
  ref.add(new StringRefAddr("URL","wibble"));
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertEquals("The naming manager should have returned the test object",testObject,obj);
}

</code></pre>

<br>
<pre class="type-4 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testSpecifiedFactoryWithRegisteredButNotMatchingFactory() throws Exception {
  String testObject="Test object";
  ObjectFactory factory=Skeleton.newMock(ObjectFactory.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),testObject);
  Reference ref=new Reference("dummy.class.name","dummy.factory.class.name","");
  bc.registerService(new String[]{ObjectFactory.class.getName(),factory.getClass().getName()},factory,null);
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertSame("The naming manager should have returned the reference object",ref,obj);
}

</code></pre>

<br>
<pre class="type-4 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testURLReferenceWithNoMatchingHandler() throws Exception {
  Reference ref=new Reference(null);
  ref.add(new StringRefAddr("URL","wibble"));
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertSame("The naming manager should have returned the reference object",ref,obj);
}

</code></pre>

<br>
<pre class="type-4 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testSpecifiedFactoryWithNoMatchingFactory() throws Exception {
  Reference ref=new Reference("dummy.class.name");
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertSame("The naming manager should have returned the reference object",ref,obj);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSpecifiedFactoryWithMatchingFactory() throws Exception {
  String testObject="Test object";
  ObjectFactory factory=Skeleton.newMock(ObjectFactory.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),testObject);
  Reference ref=new Reference("dummy.class.name",factory.getClass().getName(),"");
  bc.registerService(new String[]{ObjectFactory.class.getName(),factory.getClass().getName()},factory,null);
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertEquals("The naming manager should have returned the test object",testObject,obj);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContextDotObjectFactories() throws Exception {
  env.put(Context.OBJECT_FACTORIES,"org.apache.aries.jndi.ObjectFactoryTest$DummyObjectFactory");
  Reference ref=new Reference("anything");
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertTrue(obj instanceof String);
  assertEquals((String)obj,"pass");
  env.remove(Context.OBJECT_FACTORIES);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReferenceWithNoClassName() throws Exception {
  String testObject="Test object";
  ObjectFactory factory=Skeleton.newMock(ObjectFactory.class);
  Skeleton.getSkeleton(factory).setReturnValue(new MethodCall(ObjectFactory.class,"getObjectInstance",Object.class,Name.class,Context.class,Hashtable.class),testObject);
  bc.registerService(ObjectFactory.class.getName(),factory,null);
  Reference ref=new Reference(null);
  Object obj=NamingManager.getObjectInstance(ref,null,null,env);
  assertEquals("The naming manager should have returned the test object",testObject,obj);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.services.ServiceHelperTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetAllInterfaces() throws Exception {
  Class<?>[] classes={B.class,D.class};
  Collection<Class<?>> cx=ServiceHelper.getAllInterfaces(classes);
  assertTrue(cx.contains(A.class));
  assertTrue(cx.contains(B.class));
  assertTrue(cx.contains(C.class));
  assertTrue(cx.contains(D.class));
  assertTrue(cx.size() == 4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.url.BlueprintURLContextTest </h4><pre class="type-4 type-15 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test BlueprintURLContext.listBindings() 
 * This returns an enumeration of component id -> component pairs
 */
@Test public void testListBindings() throws Exception {
  InitialContext ctx=new InitialContext();
  NamingEnumeration<Binding> bindings=ctx.listBindings("blueprint:comp");
  Set<String> expectedCompIds=new BlueprintContainerStub().getComponentIds();
  while (bindings.hasMore()) {
    Binding b=bindings.next();
    String compId=b.getName();
    Object component=b.getObject();
    if (compId.equals("comp1")) {
      SimpleComponent sc=(SimpleComponent)component;
      assertEquals("comp1 message wrong","comp1_message",sc.getIdMessage());
    }
 else     if (compId.equals("comp2")) {
      AnotherComponent ac=(AnotherComponent)component;
      assertEquals("comp2 message wrong","AnotherComponent with id comp2",ac.getIdMessage());
    }
    expectedCompIds.remove(compId);
  }
  assertEquals("Not all expected components were found",expectedCompIds.size(),0);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGracePeriodFalseHandled() throws Exception {
  Bundle b=bundleMock("bundle.name;x=y;p:=q;blueprint.graceperiod:=false;blueprint.timeout:=10000;a=b;c:=d");
  int timeout=BlueprintURLContext.getGracePeriod(b);
  assertEquals("graceperiod wrong",-1,timeout);
  b=bundleMock("bundle.name;x=y;p:=q;blueprint.graceperiod:=false;a=b;c:=d");
  timeout=BlueprintURLContext.getGracePeriod(b);
  assertEquals("graceperiod wrong",-1,timeout);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlueprintTimeoutExtractionBothSpecified(){
  Bundle b=bundleMock("bundle.name;x=y;p:=q;blueprint.graceperiod:=true;blueprint.timeout:=10000;a=b;c:=d");
  int timeout=BlueprintURLContext.getGracePeriod(b);
  assertEquals("graceperiod wrong",10000,timeout);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that we can create an InitialContext at blueprint:comp scope, and then 
 * look components up within it
 */
@Test public void testTwoLevelComponentLookup() throws Exception {
  InitialContext ctx=new InitialContext();
  Context ctx2=(Context)ctx.lookup("blueprint:comp");
  SimpleComponent sc=(SimpleComponent)ctx2.lookup("comp2");
  assertNotNull(sc);
  String msg=sc.getIdMessage();
  assertEquals("comp2 message wrong","AnotherComponent with id comp2",msg);
}

</code></pre>

<br>
<pre class="type-4 type-15 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Validate that list() function works for BlueprintURLContext. 
 * This returns an enumeration of component id -> component class name pairs
 */
@Test public void testList() throws Exception {
  InitialContext ctx=new InitialContext();
  NamingEnumeration<NameClassPair> compList=ctx.list("blueprint:comp");
  Set<String> expectedCompIds=new BlueprintContainerStub().getComponentIds();
  while (compList.hasMore()) {
    NameClassPair ncp=compList.next();
    String compId=ncp.getName();
    String compClass=ncp.getClassName();
    if (compId.equals("comp1")) {
      assertEquals("comp1 class wrong in list",SimpleComponent.class.getName(),compClass);
    }
 else     if (compId.equals("comp2")) {
      assertEquals("comp2 class wrong in list",AnotherComponent.class.getName(),compClass);
    }
    expectedCompIds.remove(compId);
  }
  assertEquals("Not all expected components were found",expectedCompIds.size(),0);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that we can directly address a blueprint component
 */
@Test public void testSimpleComponentLookup() throws Exception {
  BlueprintURLContext bpURLc=new BlueprintURLContext(bundle,new Hashtable<String,String>());
  SimpleComponent sc=(SimpleComponent)bpURLc.lookup("blueprint:comp/comp1");
  assertNotNull(sc);
  String msg=sc.getIdMessage();
  assertEquals("comp1 message wrong","comp1_message",msg);
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultsReturnedByDefault() throws Exception {
  Bundle b=bundleMock("bundle.name;x=y;p:=q;blueprint.graceperiod:=true;a=b;c:=d");
  int timeout=BlueprintURLContext.getGracePeriod(b);
  assertEquals("graceperiod wrong",300000,timeout);
  b=bundleMock("bundle.name;x=y;p:=q;a=b;c:=d");
  timeout=BlueprintURLContext.getGracePeriod(b);
  assertEquals("graceperiod wrong",300000,timeout);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.url.ServiceRegistryContextTest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkServiceListListBindings() throws NamingException {
  BundleMock mock=new BundleMock("scooby.doo",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  InitialContext ctx=new InitialContext();
  String className=Runnable.class.getName();
  MethodCall run=new MethodCall(Runnable.class,"run");
  Runnable t=Skeleton.newMock(Runnable.class);
  Runnable t2=Skeleton.newMock(Runnable.class);
  reg.unregister();
  ServiceRegistration reg=bc.registerService(className,t,null);
  ServiceRegistration reg2=bc.registerService(className,t2,null);
  NamingEnumeration<Binding> ne=ctx.listBindings("osgi:servicelist/" + className);
  assertTrue(ne.hasMoreElements());
  Binding bnd=ne.nextElement();
  assertEquals(String.valueOf(reg.getReference().getProperty(Constants.SERVICE_ID)),bnd.getName());
  assertTrue("Class name not correct. Was: " + bnd.getClassName(),bnd.getClassName().contains("Proxy") || bnd.getClassName().contains("EnhancerByCGLIB"));
  Runnable r=(Runnable)bnd.getObject();
  assertNotNull(r);
  r.run();
  Skeleton.getSkeleton(t).assertCalledExactNumberOfTimes(run,1);
  Skeleton.getSkeleton(t2).assertNotCalled(run);
  assertTrue(ne.hasMoreElements());
  bnd=ne.nextElement();
  assertEquals(String.valueOf(reg2.getReference().getProperty(Constants.SERVICE_ID)),bnd.getName());
  assertTrue("Class name not correct. Was: " + bnd.getClassName(),bnd.getClassName().contains("Proxy") || bnd.getClassName().contains("EnhancerByCGLIB"));
  r=(Runnable)bnd.getObject();
  assertNotNull(r);
  r.run();
  Skeleton.getSkeleton(t).assertCalledExactNumberOfTimes(run,1);
  Skeleton.getSkeleton(t2).assertCalledExactNumberOfTimes(run,1);
  assertFalse(ne.hasMoreElements());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * This test checks that we can pass a filter in without things blowing up.
 * Right now our mock service registry does not implement filtering, so the
 * effect is the same as simpleJNDILookup, but we at least know it is not
 * blowing up.
 * @throws NamingException
 */
@Test public void jndiLookupWithFilter() throws NamingException {
  BundleMock mock=new BundleMock("scooby.doo",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  InitialContext ctx=new InitialContext();
  Object s=ctx.lookup("osgi:service/java.lang.Runnable/(rubbish=smelly)");
  assertNotNull("We didn't get a service back from our lookup :(",s);
  service.run();
  Skeleton.getSkeleton(service).assertCalledExactNumberOfTimes(new MethodCall(Runnable.class,"run"),1);
  Skeleton.getSkeleton(mock.getBundleContext()).assertCalled(new MethodCall(BundleContext.class,"getServiceReferences","java.lang.Runnable","(rubbish=smelly)"));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBaseLookup() throws NamingException {
  BundleMock mock=new BundleMock("scooby.doo",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  InitialContext ctx=new InitialContext();
  Context ctx2=(Context)ctx.lookup("osgi:service");
  Runnable r1=(Runnable)ctx2.lookup("java.lang.Runnable");
  assertNotNull(r1);
  assertTrue("expected proxied service class",r1 != service);
  Runnable r2=(Runnable)ctx.lookup("aries:services/java.lang.Runnable");
  assertNotNull(r2);
  assertTrue("expected non-proxied service class",r2 == service);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test does a simple JNDI lookup to prove that works.
 * @throws NamingException
 */
@Test public void simpleJNDILookup() throws NamingException {
  System.setProperty(Context.URL_PKG_PREFIXES,"helloMatey");
  InitialContext ctx=new InitialContext(new Hashtable<Object,Object>());
  BundleMock mock=new BundleMock("scooby.doo.1",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  Runnable s=(Runnable)ctx.lookup("osgi:service/java.lang.Runnable");
  assertNotNull("We didn't get a service back from our lookup :(",s);
  s.run();
  Skeleton.getSkeleton(service).assertCalledExactNumberOfTimes(new MethodCall(Runnable.class,"run"),1);
  Skeleton skel=Skeleton.getSkeleton(mock.getBundleContext());
  skel.assertCalled(new MethodCall(BundleContext.class,"getServiceReferences","java.lang.Runnable",null));
  ctx=new InitialContext(new Hashtable<Object,Object>());
  mock=new BundleMock("scooby.doo.2",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  s=(Runnable)ctx.lookup("osgi:service/java.lang.Runnable");
  String packages=System.getProperty(Context.URL_PKG_PREFIXES,null);
  assertTrue(ctx.getEnvironment().containsValue(packages));
  assertNotNull("We didn't get a service back from our lookup :(",s);
  s.run();
  Skeleton.getSkeleton(service).assertCalledExactNumberOfTimes(new MethodCall(Runnable.class,"run"),2);
  skel=Skeleton.getSkeleton(mock.getBundleContext());
  skel.assertCalled(new MethodCall(BundleContext.class,"getServiceReferences","java.lang.Runnable",null));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkServiceListList() throws NamingException {
  BundleMock mock=new BundleMock("scooby.doo",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  InitialContext ctx=new InitialContext();
  String className=Runnable.class.getName();
  Runnable t=Skeleton.newMock(Runnable.class);
  reg.unregister();
  ServiceRegistration reg=bc.registerService(className,t,null);
  ServiceRegistration reg2=bc.registerService(className,new Thread(),null);
  NamingEnumeration<NameClassPair> ne=ctx.list("osgi:servicelist/" + className);
  assertTrue(ne.hasMoreElements());
  NameClassPair ncp=ne.nextElement();
  assertEquals(String.valueOf(reg.getReference().getProperty(Constants.SERVICE_ID)),ncp.getName());
  assertTrue("Class name not correct. Was: " + ncp.getClassName(),ncp.getClassName().contains("Proxy"));
  assertTrue(ne.hasMoreElements());
  ncp=ne.nextElement();
  assertEquals(String.valueOf(reg2.getReference().getProperty(Constants.SERVICE_ID)),ncp.getName());
  assertEquals("Class name not correct.",Thread.class.getName(),ncp.getClassName());
  assertFalse(ne.hasMoreElements());
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void jndiLookupServiceNameTest() throws NamingException, SQLException {
  InitialContext ctx=new InitialContext(new Hashtable<Object,Object>());
  BundleMock mock=new BundleMock("scooby.doo",new Properties());
  Thread.currentThread().setContextClassLoader(mock.getClassLoader());
  DataSource first=Skeleton.newMock(DataSource.class);
  DataSource second=Skeleton.newMock(DataSource.class);
  Hashtable<String,String> properties=new Hashtable<String,String>();
  properties.put("osgi.jndi.service.name","jdbc/myDataSource");
  bc.registerService(DataSource.class.getName(),first,properties);
  properties=new Hashtable<String,String>();
  properties.put("osgi.jndi.service.name","jdbc/myDataSource2");
  bc.registerService(DataSource.class.getName(),second,properties);
  DataSource s=(DataSource)ctx.lookup("osgi:service/jdbc/myDataSource");
  assertNotNull(s);
  s=(DataSource)ctx.lookup("osgi:service/javax.sql.DataSource/(osgi.jndi.service.name=jdbc/myDataSource2)");
  assertNotNull(s);
  s.isWrapperFor(DataSource.class);
  Skeleton.getSkeleton(second).assertCalled(new MethodCall(DataSource.class,"isWrapperFor",Class.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jpa.blueprint.impl.AnnotationScannerTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getPUAnnotatedMembersTest(){
  AnnotationScanner scanner=new AnnotationScanner();
  List<AccessibleObject> members=scanner.getJpaAnnotatedMembers(TestClass.class,PersistenceUnit.class);
  Assert.assertEquals(1,members.size());
  AccessibleObject member=members.get(0);
  Assert.assertEquals(Method.class,member.getClass());
  Method method=(Method)member;
  Assert.assertEquals("setEmf",method.getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getPCAnnotatedMembersTest(){
  AnnotationScanner scanner=new AnnotationScanner();
  List<AccessibleObject> members=scanner.getJpaAnnotatedMembers(TestClass.class,PersistenceContext.class);
  Assert.assertEquals(1,members.size());
  AccessibleObject member=members.get(0);
  Assert.assertEquals(Field.class,member.getClass());
  Field field=(Field)member;
  Assert.assertEquals("em",field.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jpa.itest.karaf.BlueprintTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws BundleException {
  resolveBundles();
  Assert.assertEquals(0,taskService.getTasks().size());
  Task task=new Task();
  task.setId(1);
  task.setDescription("My task");
  taskService.addTask(task);
  Collection<Task> tasks=taskService.getTasks();
  Assert.assertEquals(1,tasks.size());
  Task task1=tasks.iterator().next();
  Assert.assertEquals(1,task1.getId().intValue());
  Assert.assertEquals("My task",task1.getDescription());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jpa.itest.karaf.DSTest </h4><pre class="type-4 type-7 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test currently does not work as data source config is not deployed for unknown reason
 */
@Ignore @Test public void test() throws BundleException {
  resolveBundles();
  Assert.assertEquals(0,taskService.getTasks().size());
  Task task=new Task();
  task.setId(1);
  task.setDescription("My task");
  taskService.addTask(task);
  Collection<Task> tasks=taskService.getTasks();
  Assert.assertEquals(1,tasks.size());
  Task task1=tasks.iterator().next();
  Assert.assertEquals(1,task1.getId().intValue());
  Assert.assertEquals("My task",task1.getDescription());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.proxy.impl.weaving.ProxyWeavingHookTest </h4><pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFilters(){
  BundleContext ctx=(BundleContext)Proxy.newProxyInstance(getClass().getClassLoader(),new Class[]{BundleContext.class},new InvocationHandler(){
    public Object invoke(    Object proxy,    Method method,    Object[] args) throws Throwable {
      if (method.getName().equals("getProperty")) {
        if (ProxyWeavingHook.WEAVING_ENABLED_CLASSES.equals(args[0])) {
          return "";
        }
        if (ProxyWeavingHook.WEAVING_DISABLED_CLASSES.equals(args[0])) {
          return "org.apache.foo.*";
        }
      }
      return null;
    }
  }
);
  ProxyWeavingHook hook=new ProxyWeavingHook(ctx);
  assertFalse(hook.isEnabled("org.apache.foo.Bar"));
  assertTrue(hook.isDisabled("org.apache.foo.Bar"));
  assertTrue(hook.isDisabled("org.apache.foo.bar.Bar"));
  assertFalse(hook.isDisabled("org.apache.fooBar"));
  assertFalse(hook.isDisabled("orgXapache.foo.Bar"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.proxy.itests.AbstractProxyTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDelegation() throws Exception {
  Bundle b=bundleContext.getBundle();
  TestCallable c=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  classes.add(TestDelegate.class);
  TestDelegate proxy=(TestDelegate)mgr.createDelegatingProxy(b,classes,c,new TestDelegate(""));
  c.setReturn(new TestDelegate("Hello"));
  assertEquals("Wrong message","Hello",proxy.call());
  c.setReturn(new TestDelegate("Hello again"));
  assertEquals("Wrong message","Hello again",proxy.call());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationAndInterception() throws Exception {
  Bundle b=bundleContext.getBundle();
  TestCallable c=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  classes.add(TestDelegate.class);
  TestListener tl=new TestListener();
  TestDelegate proxy=(TestDelegate)mgr.createDelegatingInterceptingProxy(b,classes,c,new TestDelegate(""),tl);
  c.setReturn(new TestDelegate("Hello"));
  tl.clear();
  assertCalled(tl,false,false,false);
  assertEquals("Wrong message","Hello",proxy.call());
  assertCalled(tl,true,true,false);
  tl.clear();
  assertCalled(tl,false,false,false);
  c.setReturn(new TestDelegate("Hello again"));
  assertEquals("Wrong message","Hello again",proxy.call());
  assertCalled(tl,true,true,false);
  tl.clear();
  assertCalled(tl,false,false,false);
  try {
    proxy.throwException();
    fail("Should throw an exception");
  }
 catch (  RuntimeException re) {
    assertCalled(tl,true,false,true);
  }
  tl.clear();
  assertCalled(tl,false,false,false);
  try {
    proxy.testInternallyCaughtException();
  }
  finally {
    assertCalled(tl,true,true,false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.proxy.itests.AbstractWeavingProxyTest </h4><pre class="type-4 type-12 type-5 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test does two things. First of all it checks that we can proxy a final 
 * class. It also validates that the class implements WovenProxy, and that the
 * delegation still works
 */
@Test public void checkProxyFinalClass() throws Exception {
  Bundle b=bundleContext.getBundle();
  TestCallable dispatcher=new TestCallable();
  TestCallable template=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  classes.add(TestCallable.class);
  @SuppressWarnings("unchecked") Callable o=(Callable)mgr.createDelegatingProxy(b,classes,dispatcher,template);
  if (!!!(o instanceof WovenProxy))   fail("Proxy should be woven!");
  Object inner=new Integer(3);
  dispatcher.setReturn(new TestCallable());
  ((TestCallable)dispatcher.call()).setReturn(inner);
  assertSame("Should return the same object",inner,o.call());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.HeaderParserTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMethodWithMultipleParameters(){
  String header="javax.ws.rs.client.FactoryFinder#find(java.lang.String," + "java.lang.String),javax.ws.rs.ext.FactoryFinder#find(java.lang.String,java" + ".lang.String) ,javax.ws.rs.other.FactoryFinder#find(java.lang.String,java"+ ".lang.String)";
  List<HeaderParser.PathElement> pathElements=HeaderParser.parseHeader(header);
  assertEquals(3,pathElements.size());
  assertEquals(pathElements.get(0).getName(),"javax.ws.rs.client.FactoryFinder#find(java.lang.String,java.lang.String)");
  assertEquals(pathElements.get(1).getName(),"javax.ws.rs.ext.FactoryFinder#find(java.lang.String,java.lang.String)");
  assertEquals(pathElements.get(2).getName(),"javax.ws.rs.other.FactoryFinder#find(java.lang.String,java.lang.String)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.ProviderBundleTrackerCustomizerGenericCapabilityTest </h4><pre class="type-4 type-12 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProvidedSPIDirective() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  BundleContext implBC=mockSPIBundleContext4();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI; approval=yeah, "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI2");
  Bundle implBundle=mockSPIBundle4(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals("Expected 3 registrations, one for MySPI and 2 for MySPI2",3,registrations.size());
  Set<String> expectedObjectClasses=new HashSet<String>(Arrays.asList("org.apache.aries.mytest.MySPI","org.apache.aries.mytest.MySPI2"));
  Set<String> actualObjectClasses=new HashSet<String>();
  boolean foundMySPI=false;
  boolean foundMySPI2=false;
  for (  ServiceRegistration sr : registrations) {
    List<String> objectClasses=Arrays.asList((String[])sr.getReference().getProperty(Constants.OBJECTCLASS));
    actualObjectClasses.addAll(objectClasses);
    assertNotNull(sr.getReference().getProperty(SpiFlyConstants.SERVICELOADER_MEDIATOR_PROPERTY));
    if (objectClasses.contains("org.apache.aries.mytest.MySPI")) {
      assertEquals("yeah",sr.getReference().getProperty("approval"));
      foundMySPI=true;
    }
 else     if (objectClasses.contains("org.apache.aries.mytest.MySPI2")) {
      assertNull(sr.getReference().getProperty("approval"));
      foundMySPI2=true;
    }
  }
  assertTrue(foundMySPI);
  assertTrue(foundMySPI2);
  assertEquals(expectedObjectClasses,actualObjectClasses);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomAttributesBundle() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration sreg=EasyMock.createMock(ServiceRegistration.class);
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI; approval=yeah; ");
  Bundle implBundle=mockSPIBundle(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(1,registrations.size());
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
  Map<String,Object> attrs=activator.getCustomBundleAttributes("org.apache.aries.mytest.MySPI",implBundle);
  assertEquals(1,attrs.size());
  assertEquals("yeah",attrs.get("approval"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCapReqHeadersInFragment() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration<?> sreg=EasyMock.createNiceMock(ServiceRegistration.class);
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,"osgi.ee;filter:=\"(&(osgi.ee=JavaSE)(version=1.6))\"");
  List<BundleWire> wires=new ArrayList<BundleWire>();
  BundleWire wire=EasyMock.createMock(BundleWire.class);
  Bundle fragment=EasyMock.createMock(Bundle.class);
  BundleRevision frev=EasyMock.createMock(BundleRevision.class);
  EasyMock.expect(frev.getBundle()).andReturn(fragment).anyTimes();
  EasyMock.replay(frev);
  BundleRequirement req=EasyMock.createMock(BundleRequirement.class);
  EasyMock.expect(req.getRevision()).andReturn(frev).anyTimes();
  EasyMock.replay(req);
  EasyMock.expect(wire.getRequirement()).andReturn(req).anyTimes();
  EasyMock.replay(wire);
  wires.add(wire);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getProvidedWires("osgi.wiring.host")).andReturn(wires).anyTimes();
  EasyMock.replay(bw);
  BundleRevision rev=EasyMock.createMock(BundleRevision.class);
  EasyMock.expect(rev.getWiring()).andReturn(bw).anyTimes();
  EasyMock.replay(rev);
  Bundle implBundle=mockSPIBundle(implBC,headers,rev);
  Dictionary<String,String> fheaders=new Hashtable<String,String>();
  fheaders.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  fheaders.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI");
  EasyMock.expect(fragment.getHeaders()).andReturn(fheaders).anyTimes();
  EasyMock.replay(fragment);
  assertEquals("Precondition",0,activator.findProviderBundles("org.apache.aries.mytest.MySPI").size());
  customizer.addingBundle(implBundle,null);
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleServiceInstancesAndTypes() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  BundleContext implBC=mockSPIBundleContext4();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI,"+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI2");
  Bundle implBundle=mockSPIBundle4(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(3,registrations.size());
  boolean foundA=false, foundB=false, foundC=false;
  for (  ServiceRegistration sreg : registrations) {
    ServiceReference sref=sreg.getReference();
    String objectClassName=((String[])sref.getProperty(Constants.OBJECTCLASS))[0];
    String serviceImplClassName=(String)sref.getProperty(SpiFlyConstants.PROVIDER_IMPLCLASS_PROPERTY);
    if (MySPIImpl4a.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI",objectClassName);
      MySPI svc=(MySPI)implBC.getService(sreg.getReference());
      assertEquals("impl4a",svc.someMethod(""));
      foundA=true;
    }
 else     if (MySPIImpl4b.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI2",objectClassName);
      MySPI2 svc=(MySPI2)implBC.getService(sreg.getReference());
      assertEquals("impl4b",svc.someMethod(""));
      foundB=true;
    }
 else     if (MySPIImpl4c.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI2",objectClassName);
      MySPI2 svc=(MySPI2)implBC.getService(sreg.getReference());
      assertEquals("impl4c",svc.someMethod(""));
      foundC=true;
    }
  }
  assertTrue(foundA);
  assertTrue(foundB);
  assertTrue(foundC);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoServiceRegistration() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration sreg=EasyMock.createMock(ServiceRegistration.class);
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Bundle implBundle=mockSPIBundle(implBC,SpiFlyConstants.PROVIDER_REQUIREMENT);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(0,registrations.size());
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceSubsetSelectionAndRegistrationProperties() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  BundleContext implBC=mockSPIBundleContext4();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI2; approval=yeah; "+ SpiFlyConstants.REGISTER_DIRECTIVE+ ":=\"org.apache.aries.spifly.impl4.MySPIImpl4b\"");
  Bundle implBundle=mockSPIBundle4(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(1,registrations.size());
  String[] objectClassProp=(String[])registrations.iterator().next().getReference().getProperty(Constants.OBJECTCLASS);
  assertEquals(1,objectClassProp.length);
  assertEquals("org.apache.aries.mytest.MySPI2",objectClassProp[0]);
  assertNotNull(registrations.iterator().next().getReference().getProperty(SpiFlyConstants.SERVICELOADER_MEDIATOR_PROPERTY));
  assertEquals("yeah",registrations.iterator().next().getReference().getProperty("approval"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingRemovedBundle() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration sreg=EasyMock.createMock(ServiceRegistration.class);
  sreg.unregister();
  EasyMock.expectLastCall();
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI");
  Bundle implBundle=mockSPIBundle(implBC,headers);
  assertEquals("Precondition",0,activator.findProviderBundles("org.apache.aries.mytest.MySPI").size());
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
  EasyMock.verify(implBC);
  customizer.removedBundle(implBundle,null,registrations);
  Collection<Bundle> bundles2=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(0,bundles2.size());
  EasyMock.verify(sreg);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonServiceRegistryBundle() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration sreg=EasyMock.createMock(ServiceRegistration.class);
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI; approval=yeah;"+ SpiFlyConstants.REGISTER_DIRECTIVE+ ":=\"\"");
  Bundle implBundle=mockSPIBundle(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(0,registrations.size());
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
  Map<String,Object> attrs=activator.getCustomBundleAttributes("org.apache.aries.mytest.MySPI",implBundle);
  assertEquals(1,attrs.size());
  assertEquals("yeah",attrs.get("approval"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.ProviderBundleTrackerCustomizerTest </h4><pre class="type-4 type-7 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingRemovedBundle() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  ServiceRegistration sreg=EasyMock.createMock(ServiceRegistration.class);
  sreg.unregister();
  EasyMock.expectLastCall();
  EasyMock.replay(sreg);
  BundleContext implBC=mockSPIBundleContext(sreg);
  Bundle implBundle=mockSPIBundle(implBC);
  assertEquals("Precondition",0,activator.findProviderBundles("org.apache.aries.mytest.MySPI").size());
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  Collection<Bundle> bundles=activator.findProviderBundles("org.apache.aries.mytest.MySPI");
  assertEquals(1,bundles.size());
  assertSame(implBundle,bundles.iterator().next());
  EasyMock.verify(implBC);
  customizer.removedBundle(implBundle,null,registrations);
  EasyMock.verify(sreg);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testAddingBundleSPIBundle() throws Exception {
  BundleContext implBC=mockSPIBundleContext(EasyMock.createNiceMock(ServiceRegistration.class));
  Bundle spiBundle=mockSPIBundle(implBC);
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(EasyMock.createNiceMock(BaseActivator.class),spiBundle);
  assertNull("The SpiFly bundle itself should be ignored",customizer.addingBundle(spiBundle,null));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testAddingNonOptInBundle() throws Exception {
  BundleContext implBC=mockSPIBundleContext(EasyMock.createNiceMock(ServiceRegistration.class));
  Bundle implBundle=mockSPIBundle(implBC,null);
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(EasyMock.createNiceMock(BaseActivator.class),null);
  assertNull("Bundle doesn't opt-in so should be ignored",customizer.addingBundle(implBundle,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.dynamic.ClientWeavingHookGenericCapabilityTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceFilteringNarrow() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT + "," + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; filter:=\"(&(osgi.serviceloader=org.apache.aries.mytest.AltSPI)(bundle-symbolic-name=impl4))\"");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  HashMap<String,Object> attrs2=new HashMap<String,Object>();
  attrs2.put("bundle-symbolic-name","impl2");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,attrs2);
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,attrs2);
  HashMap<String,Object> attrs4=new HashMap<String,Object>();
  attrs4.put("bundle-symbolic-name","impl4");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,attrs4);
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,attrs4);
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals("No providers should be selected here",Collections.emptySet(),result);
  URL cls2Url=getClass().getResource("AltTestClient.class");
  WovenClass wc2=new MyWovenClass(cls2Url,"org.apache.aries.spifly.dynamic.AltTestClient",consumerBundle);
  wh.weave(wc2);
  Class<?> cls2=wc2.getDefinedClass();
  Method method2=cls2.getMethod("test",new Class[]{long.class});
  Object result2=method2.invoke(cls2.newInstance(),4096);
  Assert.assertEquals("Only the services from bundle impl4 should be selected",-4096L,result2);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleProviders() throws Exception {
  Bundle spiFlyBundle=mockSpiFlyBundle();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle consumerBundle=mockConsumerBundle(headers,spiFlyBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","HELLO","5"));
  Assert.assertEquals("All three services should be invoked",expected,result);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeadersFromFragment() throws Exception {
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Dictionary<String,String> fragmentConsumerHeaders=new Hashtable<String,String>();
  fragmentConsumerHeaders.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle fragment=EasyMock.createMock(Bundle.class);
  EasyMock.expect(fragment.getHeaders()).andReturn(fragmentConsumerHeaders).anyTimes();
  EasyMock.replay(fragment);
  BundleRevision frev=EasyMock.createMock(BundleRevision.class);
  EasyMock.expect(frev.getBundle()).andReturn(fragment).anyTimes();
  EasyMock.replay(frev);
  BundleRequirement req=EasyMock.createMock(BundleRequirement.class);
  EasyMock.expect(req.getRevision()).andReturn(frev).anyTimes();
  EasyMock.replay(req);
  BundleWire wire=EasyMock.createMock(BundleWire.class);
  EasyMock.expect(wire.getRequirement()).andReturn(req).anyTimes();
  EasyMock.replay(wire);
  List<BundleWire> wires=Collections.singletonList(wire);
  BundleWiring wiring=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(wiring.getProvidedWires("osgi.wiring.host")).andReturn(wires).anyTimes();
  EasyMock.replay(wiring);
  BundleRevision rev=EasyMock.createMock(BundleRevision.class);
  EasyMock.expect(rev.getWiring()).andReturn(wiring).anyTimes();
  EasyMock.replay(rev);
  Bundle consumerBundle=mockConsumerBundle(new Hashtable<String,String>(),rev,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals(Collections.singleton("olleh"),result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceFilteringAlternative() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT + "," + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; filter:=\"(|(!(osgi.serviceloader=org.apache.aries.mytest.AltSPI))"+ "(&(osgi.serviceloader=org.apache.aries.mytest.AltSPI)(bundle-symbolic-name=impl4)))\"");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  HashMap<String,Object> attrs2=new HashMap<String,Object>();
  attrs2.put("bundle-symbolic-name","impl2");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,attrs2);
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,attrs2);
  HashMap<String,Object> attrs4=new HashMap<String,Object>();
  attrs4.put("bundle-symbolic-name","impl4");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,attrs4);
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,attrs4);
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","HELLO","5","impl4"));
  Assert.assertEquals("All providers should be selected for this one",expected,result);
  URL cls2Url=getClass().getResource("AltTestClient.class");
  WovenClass wc2=new MyWovenClass(cls2Url,"org.apache.aries.spifly.dynamic.AltTestClient",consumerBundle);
  wh.weave(wc2);
  Class<?> cls2=wc2.getDefinedClass();
  Method method2=cls2.getMethod("test",new Class[]{long.class});
  Object result2=method2.invoke(cls2.newInstance(),4096);
  Assert.assertEquals("Only the services from bundle impl4 should be selected",-4096L,result2);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServiceFiltering() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT + "," + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; filter:=\"(osgi.serviceloader=org.apache.aries.mytest.AltSPI)\";");
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals("No providers should be selected for this one",Collections.emptySet(),result);
  URL cls2Url=getClass().getResource("AltTestClient.class");
  WovenClass wc2=new MyWovenClass(cls2Url,"org.apache.aries.spifly.dynamic.AltTestClient",consumerBundle);
  wh.weave(wc2);
  Class<?> cls2=wc2.getDefinedClass();
  Method method2=cls2.getMethod("test",new Class[]{long.class});
  Object result2=method2.invoke(cls2.newInstance(),4096);
  Assert.assertEquals("All Providers should be selected",(4096L * 4096L) - 4096L,result2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-13 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTCCLResettingOnException() throws Exception {
  ClassLoader cl=new URLClassLoader(new URL[]{});
  Thread.currentThread().setContextClassLoader(cl);
  Assert.assertSame("Precondition",cl,Thread.currentThread().getContextClassLoader());
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle providerBundle5=mockProviderBundle("impl5",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle5,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle5);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle5);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  try {
    method.invoke(cls.newInstance(),"hello");
    Assert.fail("Invocation should have thrown an exception");
  }
 catch (  InvocationTargetException ite) {
    RuntimeException re=(RuntimeException)ite.getCause();
    String msg=re.getMessage();
    Assert.assertEquals("Uh-oh: hello",msg);
    Assert.assertSame(cl,Thread.currentThread().getContextClassLoader());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAltServiceLoaderLoadUnprocessed() throws Exception {
  Bundle spiFlyBundle=mockSpiFlyBundle();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle consumerBundle=mockConsumerBundle(headers,spiFlyBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("UnaffectedTestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.UnaffectedTestClient",consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals("The client is not affected so no additional imports should have been added",0,wc.getDynamicImports().size());
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals("impl4",result);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-13 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTCCLResetting() throws Exception {
  ClassLoader cl=new URLClassLoader(new URL[]{});
  Thread.currentThread().setContextClassLoader(cl);
  Assert.assertSame("Precondition",cl,Thread.currentThread().getContextClassLoader());
  Dictionary<String,String> consumerHeaders=new Hashtable<String,String>();
  consumerHeaders.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(consumerHeaders,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  method.invoke(cls.newInstance(),"hi there");
  Assert.assertSame(cl,Thread.currentThread().getContextClassLoader());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicServiceLoaderUsage() throws Exception {
  Dictionary<String,String> consumerHeaders=new Hashtable<String,String>();
  consumerHeaders.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT);
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(consumerHeaders,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals(Collections.singleton("olleh"),result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilteringCustomAttribute() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.CLIENT_REQUIREMENT + ", " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; filter:=\"(approval=global)\"");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Map<String,Object> attrs1=new HashMap<String,Object>();
  attrs1.put("approval","local");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,attrs1);
  Map<String,Object> attrs2=new HashMap<String,Object>();
  attrs2.put("approval","global");
  attrs2.put("other","attribute");
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,attrs2);
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.REQUIRE_CAPABILITY);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("HELLO","5"));
  Assert.assertEquals("Only the services from bundle impl2 should be selected",expected,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.dynamic.ClientWeavingHookOSGi43Test </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicServiceLoaderUsageWithClassLoaderFromBundleRevision() throws Exception {
  Dictionary<String,String> consumerHeaders=new Hashtable<String,String>();
  consumerHeaders.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"*");
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(consumerHeaders,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals(Collections.singleton("olleh"),result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.dynamic.ClientWeavingHookTest </h4><pre class="type-4 type-3 type-7 type-13 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTCCLResetting() throws Exception {
  ClassLoader cl=new URLClassLoader(new URL[]{});
  Thread.currentThread().setContextClassLoader(cl);
  Assert.assertSame("Precondition",cl,Thread.currentThread().getContextClassLoader());
  Dictionary<String,String> consumerHeaders=new Hashtable<String,String>();
  consumerHeaders.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"*");
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(consumerHeaders,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  method.invoke(cls.newInstance(),"hi there");
  Assert.assertSame(cl,Thread.currentThread().getContextClassLoader());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAltServiceLoaderLoadUnprocessed() throws Exception {
  Bundle spiFlyBundle=mockSpiFlyBundle();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"*");
  Bundle consumerBundle=mockConsumerBundle(headers,spiFlyBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("UnaffectedTestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.UnaffectedTestClient",consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals("The client is not affected so no additional imports should have been added",0,wc.getDynamicImports().size());
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals("impl4",result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJAXPClientWantsAltImplementation1() throws Exception {
  Bundle systembundle=mockSystemBundle();
  Bundle providerBundle=mockProviderBundle("impl3",1);
  activator.registerProviderBundle("javax.xml.parsers.DocumentBuilderFactory",providerBundle,new HashMap<String,Object>());
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"javax.xml.parsers.DocumentBuilderFactory#newInstance()");
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle,systembundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  WeavingHook wh=new ClientWeavingHook(mockSpiFlyBundle(consumerBundle,providerBundle,systembundle).getBundleContext(),activator);
  URL clsUrl=getClass().getResource("JaxpClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.JaxpClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{});
  Class<?> result=(Class<?>)method.invoke(cls.newInstance());
  Assert.assertEquals("JAXP implementation from JRE","org.apache.aries.spifly.dynamic.impl3.MyAltDocumentBuilderFactory",result.getName());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicServiceLoaderUsage() throws Exception {
  Dictionary<String,String> consumerHeaders=new Hashtable<String,String>();
  consumerHeaders.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"*");
  Bundle providerBundle=mockProviderBundle("impl1",1);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(consumerHeaders,providerBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle("spifly",Version.parseVersion("1.9.4"),consumerBundle,providerBundle);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  Assert.assertNotNull("Precondition",clsUrl);
  String clientClassName="org.apache.aries.spifly.dynamic.TestClient";
  WovenClass wc=new MyWovenClass(clsUrl,clientClassName,consumerBundle);
  Assert.assertEquals("Precondition",0,wc.getDynamicImports().size());
  wh.weave(wc);
  Assert.assertEquals(1,wc.getDynamicImports().size());
  String di1="org.apache.aries.spifly;bundle-symbolic-name=spifly;bundle-version=1.9.4";
  String di2="org.apache.aries.spifly;bundle-version=1.9.4;bundle-symbolic-name=spifly";
  String di=wc.getDynamicImports().get(0);
  Assert.assertTrue("Weaving should have added a dynamic import",di1.equals(di) || di2.equals(di));
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals(Collections.singleton("olleh"),result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClientMultipleTargetBundles() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"java.util.ServiceLoader#load(java.lang.Class);bundle=impl1|impl4");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","impl4"));
  Assert.assertEquals("All providers should be selected for this one",expected,result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJAXPClientWantsJREImplementation1() throws Exception {
  Bundle systembundle=mockSystemBundle();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"javax.xml.parsers.DocumentBuilderFactory#newInstance()");
  Bundle consumerBundle=mockConsumerBundle(headers,systembundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  WeavingHook wh=new ClientWeavingHook(mockSpiFlyBundle(consumerBundle,systembundle).getBundleContext(),activator);
  URL clsUrl=getClass().getResource("JaxpClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.JaxpClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{});
  Class<?> result=(Class<?>)method.invoke(cls.newInstance());
  Assert.assertEquals("JAXP implementation from JRE",thisJVMsDBF,result.getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClientSpecifyingProviderVersion() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"java.util.ServiceLoader#load(java.lang.Class);bundle=impl2:version=1.2.3");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle3=mockProviderBundle("impl2_123",3,new Version(1,2,3));
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle3,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle3);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle3);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Assert.assertEquals("Only the services from bundle impl2 should be selected",Collections.singleton("Updated!hello!Updated"),result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleProviders() throws Exception {
  Bundle spiFlyBundle=mockSpiFlyBundle();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"*");
  Bundle consumerBundle=mockConsumerBundle(headers,spiFlyBundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","HELLO","5"));
  Assert.assertEquals("All three services should be invoked",expected,result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJAXPClientWantsAltImplementation2() throws Exception {
  Bundle systembundle=mockSystemBundle();
  Bundle providerBundle=mockProviderBundle("impl3",1);
  activator.registerProviderBundle("javax.xml.parsers.DocumentBuilderFactory",providerBundle,new HashMap<String,Object>());
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"javax.xml.parsers.DocumentBuilderFactory#newInstance();bundle=impl3");
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle,systembundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  WeavingHook wh=new ClientWeavingHook(mockSpiFlyBundle(consumerBundle,providerBundle,systembundle).getBundleContext(),activator);
  URL clsUrl=getClass().getResource("JaxpClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.JaxpClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{});
  Class<?> result=(Class<?>)method.invoke(cls.newInstance());
  Assert.assertEquals("JAXP implementation from alternative bundle","org.apache.aries.spifly.dynamic.impl3.MyAltDocumentBuilderFactory",result.getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClientSpecifyingProvider() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"java.util.ServiceLoader#load(java.lang.Class);bundle=impl2");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("HELLO","5"));
  Assert.assertEquals("Only the services from bundle impl2 should be selected",expected,result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClientMultipleTargetBundles2() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"java.util.ServiceLoader#load(java.lang.Class);bundleId=1|4");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","impl4"));
  Assert.assertEquals("All providers should be selected for this one",expected,result);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJAXPClientWantsJREImplementation2() throws Exception {
  Bundle systembundle=mockSystemBundle();
  Bundle providerBundle=mockProviderBundle("impl3",1);
  activator.registerProviderBundle("javax.xml.parsers.DocumentBuilderFactory",providerBundle,new HashMap<String,Object>());
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"javax.xml.parsers.DocumentBuilderFactory#newInstance();bundleId=0");
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle,systembundle);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  WeavingHook wh=new ClientWeavingHook(mockSpiFlyBundle(consumerBundle,providerBundle,systembundle).getBundleContext(),activator);
  URL clsUrl=getClass().getResource("JaxpClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.JaxpClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{});
  Class<?> result=(Class<?>)method.invoke(cls.newInstance());
  Assert.assertEquals("JAXP implementation from JRE",thisJVMsDBF,result.getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testClientSpecificProviderLoadArgument() throws Exception {
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.SPI_CONSUMER_HEADER,"java.util.ServiceLoader#load(java.lang.Class[org.apache.aries.mytest.MySPI])," + "java.util.ServiceLoader#load(java.lang.Class[org.apache.aries.mytest.AltSPI]);bundle=impl4");
  Bundle providerBundle1=mockProviderBundle("impl1",1);
  Bundle providerBundle2=mockProviderBundle("impl2",2);
  Bundle providerBundle4=mockProviderBundle("impl4",4);
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle1,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle2,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.MySPI",providerBundle4,new HashMap<String,Object>());
  activator.registerProviderBundle("org.apache.aries.mytest.AltSPI",providerBundle4,new HashMap<String,Object>());
  Bundle consumerBundle=mockConsumerBundle(headers,providerBundle1,providerBundle2,providerBundle4);
  activator.addConsumerWeavingData(consumerBundle,SpiFlyConstants.SPI_CONSUMER_HEADER);
  Bundle spiFlyBundle=mockSpiFlyBundle(consumerBundle,providerBundle1,providerBundle2,providerBundle4);
  WeavingHook wh=new ClientWeavingHook(spiFlyBundle.getBundleContext(),activator);
  URL clsUrl=getClass().getResource("TestClient.class");
  WovenClass wc=new MyWovenClass(clsUrl,"org.apache.aries.spifly.dynamic.TestClient",consumerBundle);
  wh.weave(wc);
  Class<?> cls=wc.getDefinedClass();
  Method method=cls.getMethod("test",new Class[]{String.class});
  Object result=method.invoke(cls.newInstance(),"hello");
  Set<String> expected=new HashSet<String>(Arrays.asList("olleh","impl4","HELLO","5"));
  Assert.assertEquals("All providers should be selected for this one",expected,result);
  URL cls2Url=getClass().getResource("AltTestClient.class");
  WovenClass wc2=new MyWovenClass(cls2Url,"org.apache.aries.spifly.dynamic.AltTestClient",consumerBundle);
  wh.weave(wc2);
  Class<?> cls2=wc2.getDefinedClass();
  Method method2=cls2.getMethod("test",new Class[]{long.class});
  Object result2=method2.invoke(cls2.newInstance(),4096);
  Assert.assertEquals("Only the services from bundle impl4 should be selected",-4096L,result2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.statictool.ConsumerTest </h4><pre class="type-4 type-3 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsumerBundle() throws Exception {
  String testClassFileName=TestClass.class.getName().replace('.','/') + ".class";
  URL testClassURL=getClass().getResource("/" + testClassFileName);
  String test2ClassFileName=Test2Class.class.getName().replace('.','/') + ".class";
  URL test2ClassURL=getClass().getResource("/" + test2ClassFileName);
  String test3ClassFileName=Test3Class.class.getName().replace('.','/') + ".class";
  URL test3ClassURL=getClass().getResource("/" + test3ClassFileName);
  File jarFile=new File(System.getProperty("java.io.tmpdir") + "/testjar_" + System.currentTimeMillis()+ ".jar");
  File expectedFile=null;
  try {
    Manifest mf=new Manifest();
    Attributes mainAttributes=mf.getMainAttributes();
    mainAttributes.putValue("Manifest-Version","1.0");
    mainAttributes.putValue("Bundle-ManifestVersion","2.0");
    mainAttributes.putValue("Bundle-SymbolicName","testbundle");
    mainAttributes.putValue("Foo","Bar Bar");
    mainAttributes.putValue(SpiFlyConstants.SPI_CONSUMER_HEADER,Test2Class.class.getName() + "#getTCCL()");
    JarOutputStream jos=new JarOutputStream(new FileOutputStream(jarFile),mf);
    jos.putNextEntry(new ZipEntry(testClassFileName));
    Streams.pump(testClassURL.openStream(),jos);
    jos.putNextEntry(new ZipEntry(test2ClassFileName));
    Streams.pump(test2ClassURL.openStream(),jos);
    jos.putNextEntry(new ZipEntry(test3ClassFileName));
    Streams.pump(test3ClassURL.openStream(),jos);
    jos.close();
    Main.main(jarFile.getCanonicalPath());
    expectedFile=new File(jarFile.getParent(),jarFile.getName().replaceAll("[.]jar","_spifly.jar"));
    Assert.assertTrue("A processed separate bundle should have been created",expectedFile.exists());
    JarFile transformedJarFile=new JarFile(expectedFile);
    Manifest expectedMF=transformedJarFile.getManifest();
    Assert.assertEquals("1.0",expectedMF.getMainAttributes().getValue("Manifest-Version"));
    Assert.assertEquals("2.0",expectedMF.getMainAttributes().getValue("Bundle-ManifestVersion"));
    Assert.assertEquals("testbundle",expectedMF.getMainAttributes().getValue("Bundle-SymbolicName"));
    Assert.assertEquals("Bar Bar",expectedMF.getMainAttributes().getValue("Foo"));
    Assert.assertEquals("org.apache.aries.spifly;version=\"[1.0.0,1.1.0)\"",expectedMF.getMainAttributes().getValue("Import-Package"));
    Assert.assertNull(expectedMF.getMainAttributes().get(SpiFlyConstants.SPI_CONSUMER_HEADER));
    JarFile initialJarFile=new JarFile(jarFile);
    byte[] orgBytes=Streams.suck(initialJarFile.getInputStream(new ZipEntry(testClassFileName)));
    byte[] transBytes=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(testClassFileName)));
    Assert.assertFalse("The transformed class should be different",Arrays.equals(orgBytes,transBytes));
    byte[] orgBytes2=Streams.suck(initialJarFile.getInputStream(new ZipEntry(test2ClassFileName)));
    byte[] nonTransBytes2=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(test2ClassFileName)));
    Assert.assertArrayEquals(orgBytes2,nonTransBytes2);
    byte[] orgBytes3=Streams.suck(initialJarFile.getInputStream(new ZipEntry(test3ClassFileName)));
    byte[] nonTransBytes3=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(test3ClassFileName)));
    Assert.assertArrayEquals(orgBytes3,nonTransBytes3);
    initialJarFile.close();
    transformedJarFile.close();
  }
  finally {
    jarFile.delete();
    if (expectedFile != null)     expectedFile.delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.statictool.RequirementTest </h4><pre class="type-4 type-3 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsumerBundle() throws Exception {
  String testClassFileName=TestClass.class.getName().replace('.','/') + ".class";
  URL testClassURL=getClass().getResource("/" + testClassFileName);
  String test2ClassFileName=Test2Class.class.getName().replace('.','/') + ".class";
  URL test2ClassURL=getClass().getResource("/" + test2ClassFileName);
  String test3ClassFileName=Test3Class.class.getName().replace('.','/') + ".class";
  URL test3ClassURL=getClass().getResource("/" + test3ClassFileName);
  File jarFile=new File(System.getProperty("java.io.tmpdir") + "/testjar_" + System.currentTimeMillis()+ ".jar");
  File expectedFile=null;
  try {
    Manifest mf=new Manifest();
    Attributes mainAttributes=mf.getMainAttributes();
    mainAttributes.putValue("Manifest-Version","1.0");
    mainAttributes.putValue("Bundle-ManifestVersion","2.0");
    mainAttributes.putValue("Bundle-SymbolicName","testbundle");
    mainAttributes.putValue("Foo","Bar Bar");
    mainAttributes.putValue("Import-Package","org.foo.bar");
    mainAttributes.putValue(SpiFlyConstants.REQUIRE_CAPABILITY,"osgi.serviceloader; filter:=\"(osgi.serviceloader=org.apache.aries.spifly.mysvc.SPIProvider)\";cardinality:=multiple, " + "osgi.extender; filter:=\"(osgi.extender=osgi.serviceloader.processor)\"");
    JarOutputStream jos=new JarOutputStream(new FileOutputStream(jarFile),mf);
    jos.putNextEntry(new ZipEntry(testClassFileName));
    Streams.pump(testClassURL.openStream(),jos);
    jos.putNextEntry(new ZipEntry(test2ClassFileName));
    Streams.pump(test2ClassURL.openStream(),jos);
    jos.putNextEntry(new ZipEntry(test3ClassFileName));
    Streams.pump(test3ClassURL.openStream(),jos);
    jos.close();
    Main.main(jarFile.getCanonicalPath());
    expectedFile=new File(jarFile.getParent(),jarFile.getName().replaceAll("[.]jar","_spifly.jar"));
    Assert.assertTrue("A processed separate bundle should have been created",expectedFile.exists());
    JarFile transformedJarFile=new JarFile(expectedFile);
    Manifest actualMF=transformedJarFile.getManifest();
    Assert.assertEquals("1.0",actualMF.getMainAttributes().getValue("Manifest-Version"));
    Assert.assertEquals("2.0",actualMF.getMainAttributes().getValue("Bundle-ManifestVersion"));
    Assert.assertEquals("testbundle",actualMF.getMainAttributes().getValue("Bundle-SymbolicName"));
    Assert.assertEquals("Bar Bar",actualMF.getMainAttributes().getValue("Foo"));
    Assert.assertEquals("osgi.serviceloader; filter:=\"(osgi.serviceloader=org.apache.aries.spifly.mysvc.SPIProvider)\";cardinality:=multiple",actualMF.getMainAttributes().getValue(SpiFlyConstants.REQUIRE_CAPABILITY));
    Assert.assertNull("Should not generate this header when processing Require-Capability",actualMF.getMainAttributes().getValue(SpiFlyConstants.PROCESSED_SPI_CONSUMER_HEADER));
    String importPackage=actualMF.getMainAttributes().getValue("Import-Package");
    Assert.assertTrue("org.foo.bar,org.apache.aries.spifly;version=\"[1.0.0,1.1.0)\"".equals(importPackage) || "org.apache.aries.spifly;version=\"[1.0.0,1.1.0)\",org.foo.bar".equals(importPackage));
    JarFile initialJarFile=new JarFile(jarFile);
    byte[] orgBytes=Streams.suck(initialJarFile.getInputStream(new ZipEntry(testClassFileName)));
    byte[] nonTransBytes=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(testClassFileName)));
    Assert.assertArrayEquals(orgBytes,nonTransBytes);
    byte[] orgBytes2=Streams.suck(initialJarFile.getInputStream(new ZipEntry(test2ClassFileName)));
    byte[] nonTransBytes2=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(test2ClassFileName)));
    Assert.assertArrayEquals(orgBytes2,nonTransBytes2);
    byte[] orgBytes3=Streams.suck(initialJarFile.getInputStream(new ZipEntry(test3ClassFileName)));
    byte[] transBytes3=Streams.suck(transformedJarFile.getInputStream(new ZipEntry(test3ClassFileName)));
    Assert.assertFalse("The transformed class should be different",Arrays.equals(orgBytes3,transBytes3));
    initialJarFile.close();
    transformedJarFile.close();
  }
  finally {
    jarFile.delete();
    if (expectedFile != null)     expectedFile.delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.core.archive.Aries1425Test </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetType(){
  SubsystemContentHeader header=new SubsystemContentHeader(HEADER_1);
  Collection<SubsystemContentHeader.Clause> clauses=header.getClauses();
  assertEquals("Wrong size",3,clauses.size());
  Map<String,SubsystemContentHeader.Clause> map=new HashMap<String,SubsystemContentHeader.Clause>(3);
  for (  SubsystemContentHeader.Clause clause : clauses) {
    map.put(clause.toString(),clause);
  }
  SubsystemContentHeader.Clause clause=map.get(BUNDLE_A);
  assertEquals("Wrong type",IdentityNamespace.TYPE_BUNDLE,clause.getType());
  clause=map.get(BUNDLE_B);
  assertEquals("Wrong type",IdentityNamespace.TYPE_BUNDLE,clause.getType());
  clause=map.get(BUNDLE_C);
  assertEquals("Wrong type",IdentityNamespace.TYPE_FRAGMENT,clause.getType());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToRequirement(){
  SubsystemContentHeader header=new SubsystemContentHeader(HEADER_1);
  Collection<SubsystemContentHeader.Clause> clauses=header.getClauses();
  assertEquals("Wrong size",3,clauses.size());
  Map<String,SubsystemContentHeader.Clause> map=new HashMap<String,SubsystemContentHeader.Clause>(3);
  for (  SubsystemContentHeader.Clause clause : clauses) {
    map.put(clause.toString(),clause);
  }
  Resource resource=new Resource(){
    @Override public List<Capability> getCapabilities(    String namespace){
      return Collections.emptyList();
    }
    @Override public List<Requirement> getRequirements(    String namespace){
      return Collections.emptyList();
    }
  }
;
  SubsystemContentHeader.Clause clause=map.get(BUNDLE_A);
  Requirement requirement=clause.toRequirement(resource);
  assertTrue("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,BUNDLE_A,Version.emptyVersion,IdentityNamespace.TYPE_FRAGMENT)));
  assertTrue("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,BUNDLE_A,Version.emptyVersion,IdentityNamespace.TYPE_BUNDLE)));
  clause=map.get(BUNDLE_B);
  requirement=clause.toRequirement(resource);
  assertFalse("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,"bundle.b",Version.emptyVersion,IdentityNamespace.TYPE_FRAGMENT)));
  assertTrue("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,"bundle.b",Version.emptyVersion,IdentityNamespace.TYPE_BUNDLE)));
  clause=map.get(BUNDLE_C);
  requirement=clause.toRequirement(resource);
  assertTrue("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,"bundle.c",Version.emptyVersion,IdentityNamespace.TYPE_FRAGMENT)));
  assertFalse("Wrong requirement",ResourceHelper.matches(requirement,new OsgiIdentityCapability(resource,"bundle.c",Version.emptyVersion,IdentityNamespace.TYPE_BUNDLE)));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClauseToString(){
  Set<String> clauseStrs=new HashSet<String>(Arrays.asList(HEADER_1.split(",")));
  SubsystemContentHeader header=new SubsystemContentHeader(HEADER_1);
  Collection<SubsystemContentHeader.Clause> clauses=header.getClauses();
  assertEquals("Wrong size",3,clauses.size());
  for (  SubsystemContentHeader.Clause clause : clauses) {
    String clauseStr=clause.toString();
    assertTrue("Wrong clause",clauseStrs.remove(clauseStr));
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIsTypeSpecified(){
  SubsystemContentHeader header=new SubsystemContentHeader(HEADER_1);
  Collection<SubsystemContentHeader.Clause> clauses=header.getClauses();
  assertEquals("Wrong size",3,clauses.size());
  Map<String,SubsystemContentHeader.Clause> map=new HashMap<String,SubsystemContentHeader.Clause>(3);
  for (  SubsystemContentHeader.Clause clause : clauses) {
    map.put(clause.toString(),clause);
  }
  SubsystemContentHeader.Clause clause=map.get(BUNDLE_A);
  assertEquals("Should not be specified",Boolean.FALSE,clause.isTypeSpecified());
  clause=map.get(BUNDLE_B);
  assertEquals("Should be specified",Boolean.TRUE,clause.isTypeSpecified());
  clause=map.get(BUNDLE_C);
  assertEquals("Should be specified",Boolean.TRUE,clause.isTypeSpecified());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.core.archive.Aries1427Test </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRequirementConversionWithVersionPresence(){
  VersionRange range=VersionRange.valueOf("(1.0,2.0)");
  String filter=new StringBuilder().append("(&(").append(PackageNamespace.PACKAGE_NAMESPACE).append("=com.acme.tnt").append(')').append(range.toFilterString(PackageNamespace.CAPABILITY_VERSION_ATTRIBUTE)).append(')').toString();
  Requirement requirement=new BasicRequirement.Builder().namespace(PackageNamespace.PACKAGE_NAMESPACE).directive(PackageNamespace.REQUIREMENT_FILTER_DIRECTIVE,filter).resource(new Resource(){
    @Override public List<Capability> getCapabilities(    String namespace){
      return Collections.emptyList();
    }
    @Override public List<Requirement> getRequirements(    String namespace){
      return Collections.emptyList();
    }
  }
).build();
  ImportPackageHeader.Clause expected=new ImportPackageHeader.Clause("com.acme.tnt;version=\"(1.0,2.0)\"");
  ImportPackageHeader.Clause actual=ImportPackageHeader.Clause.valueOf(requirement);
  assertEquals("Wrong clause",expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.core.archive.Aries1453Test </h4><pre class="type-4 type-3 type-7 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldResolveFragmentHostWithVersionRangeAndMatchWithBundlesInThatRange(){
  FragmentHostHeader header=new FragmentHostHeader("host-bundle;bundle-version=\"[9.6.0,10)\"");
  FragmentHostRequirement requirement=new FragmentHostRequirement(header.getClauses().iterator().next(),null);
  FragmentHostCapability capability=new FragmentHostCapability(new BundleSymbolicNameHeader("host-bundle"),new BundleVersionHeader("9.6.1"),new Resource(){
    @Override public List<Capability> getCapabilities(    String namespace){
      return null;
    }
    @Override public List<Requirement> getRequirements(    String namespace){
      return null;
    }
  }
);
  String filterDirective=requirement.getDirectives().get(Namespace.REQUIREMENT_FILTER_DIRECTIVE);
  SimpleFilter simpleFilter=SimpleFilter.parse(filterDirective);
  CapabilitySet capabilitySet=new CapabilitySet(Arrays.asList(HostNamespace.HOST_NAMESPACE),true);
  capabilitySet.addCapability(capability);
  Set<Capability> capabilities=capabilitySet.match(simpleFilter,true);
  Assert.assertTrue(capabilities.size() == 1);
  Assert.assertSame(capabilities.iterator().next(),capability);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.core.internal.RepositoryServiceRepositoryTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFindProviders() throws Exception {
  BundleContext bc=EasyMock.createNiceMock(BundleContext.class);
  RepositoryServiceRepository rsr=new RepositoryServiceRepository(bc);
  @SuppressWarnings("unchecked") ServiceReference sr=EasyMock.createMock(ServiceReference.class);
  @SuppressWarnings("unchecked") ServiceReference sr2=EasyMock.createMock(ServiceReference.class);
  @SuppressWarnings("unchecked") ServiceReference sr3=EasyMock.createMock(ServiceReference.class);
  EasyMock.expect(bc.getAllServiceReferences("org.osgi.service.repository.Repository",null)).andReturn(new ServiceReference[]{sr,sr2,sr3}).anyTimes();
  TestRepository tr=new TestRepository();
  EasyMock.expect(bc.getService(sr)).andReturn(tr).anyTimes();
  ToastRepository tr2=new ToastRepository();
  EasyMock.expect(bc.getService(sr2)).andReturn(tr2).anyTimes();
  Repository tr3=Creator.create();
  EasyMock.expect(bc.getService(sr3)).andReturn(tr3).anyTimes();
  EasyMock.replay(bc);
  Map<String,String> dirs=Collections.singletonMap("filter","(org.foo=bar)");
  Requirement req=new TestRequirement("org.foo",dirs);
  Collection<Capability> res=rsr.findProviders(req);
  assertEquals(1,res.size());
  Capability cap=res.iterator().next();
  assertEquals("org.foo",cap.getNamespace());
  assertEquals(1,cap.getAttributes().size());
  assertEquals("bar",cap.getAttributes().get("org.foo"));
  Map<String,String> dirs2=Collections.singletonMap("filter","(org.foo=b)");
  Requirement req2=new TestRequirement("poing",dirs2);
  Collection<Capability> res2=rsr.findProviders(req2);
  assertEquals(1,res2.size());
  Capability cap2=res2.iterator().next();
  assertEquals("poing",cap2.getNamespace());
  assertEquals(1,cap2.getAttributes().size());
  assertEquals("b",cap2.getAttributes().get("org.foo"));
  Map<String,String> dirs3=Collections.singletonMap("filter","(x=y)");
  Requirement req3=new TestRequirement("ns1",dirs3);
  Collection<Capability> res3=rsr.findProviders(req3);
  assertEquals(1,res3.size());
  Capability cap3=res3.iterator().next();
  assertEquals("ns1",cap3.getNamespace());
  assertEquals(1,cap3.getAttributes().size());
  assertEquals("y",cap3.getAttributes().get("x"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.AriesSubsystemTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddRequirementsKeepsEdgesOtherThanParentChild() throws Exception {
  AriesSubsystem compositeA=(AriesSubsystem)installSubsystemFromFile(COMPOSITE_A);
  try {
    AriesSubsystem applicationB=(AriesSubsystem)getConstituentAsSubsystem(compositeA,APPLICATION_B,null,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION);
    Region bRegion=getRegion(applicationB);
    assertEquals("Wrong number of edges",2,bRegion.getEdges().size());
    Requirement requirement=new BasicRequirement.Builder().namespace(PackageNamespace.PACKAGE_NAMESPACE).directive(PackageNamespace.REQUIREMENT_FILTER_DIRECTIVE,"(osgi.wiring.package=org.osgi.framework)").resource(EasyMock.createMock(Resource.class)).build();
    applicationB.addRequirements(Collections.singleton(requirement));
    bRegion=getRegion(applicationB);
    assertEquals("Wrong number of edges",2,bRegion.getEdges().size());
    Region rootRegion=getRegion(getRootSubsystem());
    assertEquals("Wrong number of edges",0,rootRegion.getEdges().size());
    rootRegion.connectRegion(bRegion,rootRegion.getRegionDigraph().createRegionFilterBuilder().allow("com.foo","(bar=b)").build());
    assertEquals("Wrong number of edges",1,rootRegion.getEdges().size());
    requirement=new BasicRequirement.Builder().namespace(PackageNamespace.PACKAGE_NAMESPACE).directive(PackageNamespace.REQUIREMENT_FILTER_DIRECTIVE,"(osgi.wiring.package=org.osgi.framework.wiring)").resource(EasyMock.createMock(Resource.class)).build();
    applicationB.addRequirements(Collections.singleton(requirement));
    rootRegion=getRegion(getRootSubsystem());
    assertEquals("Wrong number of edges",1,rootRegion.getEdges().size());
    bRegion=getRegion(applicationB);
    assertEquals("Wrong number of edges",2,bRegion.getEdges().size());
  }
  finally {
    uninstallSubsystemSilently(compositeA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.BlueprintTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void checkBlueprint() throws Exception {
  Subsystem subsystem=installSubsystemFromFile(BLUEPRINT_ESA);
  try {
    startSubsystem(subsystem);
    BundleContext bc=subsystem.getBundleContext();
    Hello h=new RichBundleContext(bc).getService(Hello.class);
    String message=h.saySomething();
    assertEquals("Wrong message back","messageFromBlueprint",message);
  }
  finally {
    stopSubsystem(subsystem);
    uninstallSubsystem(subsystem);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.DynamicImportTest </h4><pre class="type-4 type-5 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testDynamicPackageImportsAddedToSharingPolicyWhenNoImportPackageHeader() throws Exception {
  final AtomicBoolean weavingHookCalled=new AtomicBoolean(false);
  ServiceRegistration reg=bundleContext.registerService(WeavingHook.class,new WeavingHook(){
    @Override public void weave(    WovenClass wovenClass){
      if (BUNDLE_A.equals(wovenClass.getBundleWiring().getBundle().getSymbolicName())) {
        wovenClass.getDynamicImports().add("org.osgi.framework");
        weavingHookCalled.set(true);
      }
    }
  }
,null);
  try {
    Subsystem s=installSubsystemFromFile(APPLICATION_A);
    try {
      assertNull("Import-Package header should not exist",s.getSubsystemHeaders(null).get(Constants.IMPORT_PACKAGE));
      Bundle a=getConstituentAsBundle(s,BUNDLE_A,null,null);
      a.loadClass("Empty");
      assertTrue("Weaving hook not called",weavingHookCalled.get());
      try {
        a.loadClass("org.osgi.framework.Bundle");
      }
 catch (      Exception e) {
        fail("Woven dynamic package import not added to the region's sharing policy");
      }
    }
  finally {
      try {
        s.uninstall();
      }
 catch (      Exception e) {
      }
    }
  }
  finally {
    try {
      reg.unregister();
    }
 catch (    Exception e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.ResolutionTest </h4><pre class="type-4 type-5 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContentWithNonConstituentDependencyWithNonConstituentDependency() throws Exception {
  registerRepositoryService(BUNDLE_B);
  Subsystem root=getRootSubsystem();
  Bundle bundleC=installBundleFromFile(BUNDLE_C,root);
  try {
    Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
    assertHeaderExists(applicationA,Constants.REQUIRE_CAPABILITY);
    RequireCapabilityHeader header=new RequireCapabilityHeader(applicationA.getSubsystemHeaders(null).get(Constants.REQUIRE_CAPABILITY));
    assertEquals("Wrong number of clauses",1,header.getClauses().size());
    Clause clause=header.getClauses().iterator().next();
    assertEquals("Wrong path","a",clause.getPath());
    assertEquals("Wrong resolution directive",Constants.RESOLUTION_MANDATORY,clause.getDirective(Constants.RESOLUTION_DIRECTIVE).getValue());
    assertEquals("Wrong effective directive",Constants.EFFECTIVE_RESOLVE,clause.getDirective(Constants.EFFECTIVE_DIRECTIVE).getValue());
    try {
      applicationA.start();
    }
 catch (    SubsystemException e) {
      fail("Application A should have started");
    }
 finally {
      stopAndUninstallSubsystemSilently(applicationA);
    }
  }
 catch (  SubsystemException e) {
    fail("Application A should have installed." + e.getMessage());
  }
 finally {
    uninstallSilently(bundleC);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.RootSubsystemTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDoNotStartExtraneousRootRegionBundles() throws Exception {
  bundleContext.installBundle(new File(BUNDLE_A).toURI().toURL().toString());
  getSubsystemCoreBundle().stop();
  getSubsystemCoreBundle().start();
  Bundle bundleA=context().getBundleByName(BUNDLE_A);
  assertTrue("Extraneous root region bundle should not be started",(bundleA.getState() & (Bundle.INSTALLED | Bundle.RESOLVED)) != 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.ServiceDependencyTest </h4><pre class="type-4 type-5 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportServiceDependencySatisfiedByContent() throws Exception {
  try {
    Subsystem subsystem=installSubsystemFromFile(APPLICATION_C);
    try {
      assertNull("Generated application Subsystem-ImportService header when dependency satisfied by content",subsystem.getSubsystemHeaders(null).get(SubsystemConstants.SUBSYSTEM_IMPORTSERVICE));
    }
  finally {
      uninstallSubsystemSilently(subsystem);
    }
  }
 catch (  SubsystemException e) {
    e.printStackTrace();
    fail("Installation must succeed if service dependency is satisfied");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1368Test </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationWithFragmentInRepositoryWithSubsystemContentHeaderWithType() throws Exception {
  Subsystem applicationB=installSubsystemFromFile(APPLICATION_B);
  try {
    assertConstituents(3,applicationB);
    startSubsystem(applicationB);
    assertBundleState(Bundle.ACTIVE,BUNDLE_A,applicationB);
    assertBundleState(Bundle.RESOLVED,FRAGMENT_A,applicationB);
    Bundle bundle=context(applicationB).getBundleByName(FRAGMENT_A);
    assertNotNull("Bundle not found: " + FRAGMENT_A,bundle);
    Resource resource=bundle.adapt(BundleRevision.class);
    Capability capability=resource.getCapabilities(IdentityNamespace.IDENTITY_NAMESPACE).get(0);
    String type=String.valueOf(capability.getAttributes().get(IdentityNamespace.CAPABILITY_TYPE_ATTRIBUTE));
    assertEquals("Wrong type",IdentityNamespace.TYPE_FRAGMENT,type);
  }
  finally {
    stopAndUninstallSubsystemSilently(applicationB);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationWithFragmentInArchiveWithSubsystemContentHeaderWithType() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    assertConstituents(3,applicationA);
    startSubsystem(applicationA);
    assertBundleState(Bundle.ACTIVE,BUNDLE_A,applicationA);
    assertBundleState(Bundle.RESOLVED,FRAGMENT_A,applicationA);
    Bundle bundle=context(applicationA).getBundleByName(FRAGMENT_A);
    assertNotNull("Bundle not found: " + FRAGMENT_A,bundle);
    Resource resource=bundle.adapt(BundleRevision.class);
    Capability capability=resource.getCapabilities(IdentityNamespace.IDENTITY_NAMESPACE).get(0);
    assertEquals("Wrong type",IdentityNamespace.TYPE_FRAGMENT,capability.getAttributes().get(IdentityNamespace.CAPABILITY_TYPE_ATTRIBUTE));
  }
  finally {
    stopAndUninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1383Test </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test13() throws Exception {
  Subsystem root=getRootSubsystem();
  Map<String,String> headers=root.getSubsystemHeaders(null);
  String headerStr=headers.get(SubsystemConstants.SUBSYSTEM_TYPE);
  SubsystemTypeHeader header=new SubsystemTypeHeader(headerStr);
  AriesProvisionDependenciesDirective directive=header.getAriesProvisionDependenciesDirective();
  assertEquals("Wrong directive",AriesProvisionDependenciesDirective.INSTALL,directive);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-13 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test19() throws Exception {
  Subsystem root=getRootSubsystem();
  subsystemEvents.clear();
  Subsystem feature1=installSubsystem(root,"feature1",new SubsystemArchiveBuilder().symbolicName("feature1").type(SubsystemConstants.SUBSYSTEM_TYPE_FEATURE).build());
  try {
    Subsystem feature2=installSubsystem(root,"feature2",new SubsystemArchiveBuilder().symbolicName("feature2").type(SubsystemConstants.SUBSYSTEM_TYPE_FEATURE + ';' + AriesProvisionDependenciesDirective.INSTALL.toString()).build());
    try {
      SubsystemArchiveBuilder applicationArchive=new SubsystemArchiveBuilder().symbolicName("application").type(SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION + ';' + AriesProvisionDependenciesDirective.RESOLVE.toString()+ ';'+ SubsystemConstants.PROVISION_POLICY_DIRECTIVE+ ":="+ SubsystemConstants.PROVISION_POLICY_ACCEPT_DEPENDENCIES).content("bundle1").bundle("bundle1",new BundleArchiveBuilder().symbolicName("bundle1").importPackage("a").build()).bundle("bundle2",new BundleArchiveBuilder().symbolicName("bundle2").exportPackage("a").build());
      Subsystem application1=feature1.install("application",applicationArchive.build());
      Subsystem application2=feature2.install("application",applicationArchive.build());
      assertSame("Wrong subsystem",application1,application2);
      assertEquals("Wrong subsystem",application1,application2);
      assertChild(feature1,"application");
      assertChild(feature2,"application");
      long id=application1.getSubsystemId();
      assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLING,subsystemEvents.poll(id,5000),ServiceEvent.REGISTERED);
      assertNull("Unexpected event",subsystemEvents.poll(id,1));
      assertConstituent(application1,"bundle1");
      assertNotConstituent(application1,"bundle2");
      application1.start();
      try {
        assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
        assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
        assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
        assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.STARTING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
        assertEvent(id,"application",Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.ACTIVE,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
        assertNull("Unexpected event",subsystemEvents.poll(id,1));
        assertConstituent(application1,"bundle2");
      }
  finally {
        stopSubsystemSilently(application1);
      }
    }
  finally {
      uninstallSubsystemSilently(feature2);
    }
  }
  finally {
    uninstallSubsystemSilently(feature1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test17() throws Exception {
  Subsystem root=getRootSubsystem();
  subsystemEvents.clear();
  Subsystem parent=root.install(APPLICATION_B,applicationB());
  try {
    long id=parent.getSubsystemId();
    assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLING,subsystemEvents.poll(id,5000),ServiceEvent.REGISTERED);
    assertNull("Unexpected event",subsystemEvents.poll(id,1));
    assertNotConstituent(root,BUNDLE_B);
    assertConstituent(parent,BUNDLE_A);
    Subsystem child=getChild(parent,APPLICATION_A);
    assertNotNull("Missing child",child);
    id=child.getSubsystemId();
    assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLING,subsystemEvents.poll(id,5000),ServiceEvent.REGISTERED);
    assertNull("Unexpected event",subsystemEvents.poll(id,1));
    assertNotConstituent(root,BUNDLE_D);
    assertConstituent(child,BUNDLE_A);
    assertConstituent(child,BUNDLE_C);
    parent.start();
    try {
      id=parent.getSubsystemId();
      assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.STARTING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_B,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.ACTIVE,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertNull("Unexpected event",subsystemEvents.poll(id,1));
      assertConstituent(root,BUNDLE_B);
      id=child.getSubsystemId();
      assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.INSTALLED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.RESOLVED,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.STARTING,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertEvent(id,APPLICATION_A,Version.emptyVersion,SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION,State.ACTIVE,subsystemEvents.poll(id,5000),ServiceEvent.MODIFIED);
      assertNull("Unexpected event",subsystemEvents.poll(id,1));
      assertConstituent(root,BUNDLE_D);
    }
  finally {
      stopSubsystemSilently(parent);
    }
  }
  finally {
    uninstallSubsystemSilently(parent);
  }
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testRestart() throws Exception {
  Subsystem root=getRootSubsystem();
  Subsystem a1=installSubsystem(root,"a1",new SubsystemArchiveBuilder().symbolicName("a1").type(SubsystemConstants.SUBSYSTEM_TYPE_APPLICATION + ';' + AriesProvisionDependenciesDirective.RESOLVE.toString()).content("b1,c1;type=osgi.subsystem.composite").bundle("b1",new BundleArchiveBuilder().symbolicName("b1").importPackage("b2").build()).bundle("b2",new BundleArchiveBuilder().symbolicName("b2").exportPackage("b2").build()).subsystem("c1",new SubsystemArchiveBuilder().symbolicName("c1").type(SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE + ';' + AriesProvisionDependenciesDirective.RESOLVE.toString()).content("b1;version=\"[0,0]\"").importPackage("b2").bundle("b1",new BundleArchiveBuilder().symbolicName("b1").importPackage("b2").build()).build()).build(),false);
  uninstallableSubsystems.add(a1);
  assertChild(root,"a1");
  assertState(State.INSTALLING,a1);
  Subsystem c1=getChild(a1,"c1",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  assertNotNull("Missing child",c1);
  assertState(State.INSTALLING,c1);
  restartSubsystemsImplBundle();
  root=getRootSubsystem();
  a1=getChild(root,"a1");
  assertNotNull("Missing child",a1);
  uninstallableSubsystems.add(a1);
  assertState(State.INSTALLING,a1);
  assertConstituent(a1,"b1");
  assertNotConstituent(root,"b2");
  c1=getChild(a1,"c1",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  assertNotNull("Missing child",c1);
  uninstallableSubsystems.add(c1);
  assertConstituent(c1,"b1");
  startSubsystem(c1,false);
  stoppableSubsystems.add(c1);
  assertState(State.INSTALLED,a1);
  stoppableSubsystems.add(a1);
  assertConstituent(root,"b2");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testRestart2() throws Exception {
  Subsystem root=getRootSubsystem();
  Subsystem c1=installSubsystem(root,"c1",new SubsystemArchiveBuilder().symbolicName("c1").type(SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE + ';' + AriesProvisionDependenciesDirective.RESOLVE.toString()).content("c1b1;version=\"[0,0]\"").exportPackage("c1b1").importPackage("c2b1").bundle("c1b1",new BundleArchiveBuilder().symbolicName("c1b1").exportPackage("c1b1").importPackage("c2b1").build()).build(),false);
  uninstallableSubsystems.add(c1);
  Subsystem c2=installSubsystem(root,"c2",new SubsystemArchiveBuilder().symbolicName("c2").type(SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE + ';' + AriesProvisionDependenciesDirective.RESOLVE.toString()).content("c2b1;version=\"[0,0]\"").exportPackage("c2b1").importPackage("c1b1").bundle("c2b1",new BundleArchiveBuilder().symbolicName("c2b1").exportPackage("c2b1").importPackage("c1b1").build()).build(),false);
  uninstallableSubsystems.add(c2);
  assertChild(root,"c1",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  assertChild(root,"c2",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  restartSubsystemsImplBundle();
  root=getRootSubsystem();
  c1=getChild(root,"c1",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  assertNotNull("Missing child",c1);
  uninstallableSubsystems.add(c1);
  c2=getChild(root,"c2",null,SubsystemConstants.SUBSYSTEM_TYPE_COMPOSITE);
  assertNotNull("Missing child",c2);
  uninstallableSubsystems.add(c2);
  startSubsystem(c1,false);
  stoppableSubsystems.add(c1);
  try {
    assertState(EnumSet.of(State.RESOLVED,State.ACTIVE),c2);
  }
 catch (  AssertionError e) {
    System.out.println(c2.getState());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1419Test </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRequireCapability() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Bundle bundleA=getConstituentAsBundle(applicationA,BUNDLE_A,null,null);
    String expectedStr=bundleA.getHeaders().get(Constants.REQUIRE_CAPABILITY);
    RequireCapabilityHeader expected=new RequireCapabilityHeader(expectedStr);
    Map<String,String> headers=((BasicSubsystem)applicationA).getDeploymentHeaders();
    String actualStr=headers.get(Constants.REQUIRE_CAPABILITY);
    RequireCapabilityHeader actual=new RequireCapabilityHeader(actualStr);
    assertEquals("Wrong header",expected,actual);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1421Test </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSubsystemImportService() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    String expectedStr="foo;resolution:=optional,bar;filter:=\"(a=b)\";resolution:=optional";
    SubsystemImportServiceHeader expected=new SubsystemImportServiceHeader(expectedStr);
    Map<String,String> headers=((BasicSubsystem)applicationA).getDeploymentHeaders();
    String actualStr=headers.get(SubsystemConstants.SUBSYSTEM_IMPORTSERVICE);
    SubsystemImportServiceHeader actual=new SubsystemImportServiceHeader(actualStr);
    assertEquals("Wrong header",expected,actual);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRequireCapability() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Bundle bundleA=getConstituentAsBundle(applicationA,BUNDLE_A,null,null);
    String expectedStr=bundleA.getHeaders().get(Constants.REQUIRE_CAPABILITY);
    RequireCapabilityHeader expected=new RequireCapabilityHeader(expectedStr);
    Map<String,String> headers=((BasicSubsystem)applicationA).getDeploymentHeaders();
    String actualStr=headers.get(Constants.REQUIRE_CAPABILITY);
    RequireCapabilityHeader actual=new RequireCapabilityHeader(actualStr);
    assertEquals("Wrong header",expected,actual);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRequireBundleVersionRanges() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Bundle bundleA=getConstituentAsBundle(applicationA,BUNDLE_A,null,null);
    String expectedStr=bundleA.getHeaders().get(Constants.REQUIRE_BUNDLE);
    RequireBundleHeader expected=new RequireBundleHeader(expectedStr);
    Map<String,String> headers=((BasicSubsystem)applicationA).getDeploymentHeaders();
    String actualStr=headers.get(Constants.REQUIRE_BUNDLE);
    RequireBundleHeader actual=new RequireBundleHeader(actualStr);
    assertEquals("Wrong header",expected,actual);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImportPackageVersionRanges() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Bundle bundleA=getConstituentAsBundle(applicationA,BUNDLE_A,null,null);
    String expectedStr=bundleA.getHeaders().get(Constants.IMPORT_PACKAGE);
    ImportPackageHeader expected=new ImportPackageHeader(expectedStr);
    Map<String,String> headers=((BasicSubsystem)applicationA).getDeploymentHeaders();
    String actualStr=headers.get(Constants.IMPORT_PACKAGE);
    ImportPackageHeader actual=new ImportPackageHeader(actualStr);
    assertEquals("Wrong header",expected,actual);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1425Test </h4><pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testProvisionResourceHeader() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Map<String,String> headers=applicationA.getDeploymentHeaders();
    String header=headers.get(SubsystemConstants.PROVISION_RESOURCE);
    assertFalse("Fragment content treated as dependency",header != null && header.contains(BUNDLE_A));
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1426Test </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoEffectOnSharingPolicy() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Map<String,String> headers=applicationA.getDeploymentHeaders();
    assertNull("Wrong Require-Capability",headers.get(Constants.REQUIRE_CAPABILITY));
    assertNull("Wrong Subsystem-ImportService",headers.get(SubsystemConstants.SUBSYSTEM_IMPORTSERVICE));
    org.apache.aries.subsystem.core.archive.Header<?> expected=new SubsystemContentHeader("bundle.a.jar;version=\"[0,0]\"");
    org.apache.aries.subsystem.core.archive.Header<?> actual=new SubsystemContentHeader(headers.get(SubsystemConstants.SUBSYSTEM_CONTENT));
    assertEquals("Wrong Subsystem-Content",expected,actual);
    expected=new GenericHeader("Application-ImportService","org.osgi.service.coordinator.Coordinator");
    actual=new GenericHeader("Application-ImportService",headers.get("Application-ImportService"));
    assertEquals("Wrong Application-ImportService",expected,actual);
    BundleContext context=applicationA.getBundleContext();
    assertNull("Coordinator service should not be visible",context.getServiceReference(Coordinator.class));
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIncludeUnsatisfiedOptionalServiceDependencyInSharingPolicy() throws Exception {
  Subsystem applicationB=installSubsystemFromFile(APPLICATION_B);
  try {
    BundleContext context=getRootSubsystem().getBundleContext();
    Dictionary<String,String> properties=new Hashtable<String,String>();
    properties.put("a","b");
    ServiceRegistration registration=context.registerService(Object.class,new Object(),properties);
    try {
      context=applicationB.getBundleContext();
      Collection<ServiceReference> references=context.getServiceReferences(Object.class,"(a=b)");
      assertFalse("Service not visible",references.isEmpty());
    }
  finally {
      registration.unregister();
    }
  }
  finally {
    uninstallSubsystemSilently(applicationB);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.BasicTest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstallBundleIntoRootScope() throws Exception {
  Scope scope=getScope();
  int previousSize=scope.getBundles().size();
  String location=getBundleLocation("tb-2.jar");
  URL url=new URL(location);
  InstallInfo tb2Info=new InstallInfo(location,url.openStream());
  ScopeUpdate scopeUpdate=scope.newScopeUpdate();
  scopeUpdate.getBundlesToInstall().add(tb2Info);
  assertTrue(scopeUpdate.commit());
  Bundle b=bundleContext.getBundle(location);
  assertNotNull(b);
  Collection<Bundle> bundles=scope.getBundles();
  assertEquals(previousSize + 1,bundles.size());
  assertTrue(bundles.contains(b));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.BundleVisibilityTest </h4><pre class="type-4 type-3 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Install a bundle into the same scope as this one. Both bundles should be
 * able to see each other.
 * @throws Exception
 */
@Test public void test1() throws Exception {
  Scope scope=getScope();
  assertTrue(scope.getBundles().contains(bundleContext.getBundle()));
  ScopeUpdate scopeUpdate=scope.newScopeUpdate();
  String location=getBundleLocation("tb-4.jar");
  assertNull(bundleContext.getBundle(location));
  URL url=new URL(location);
  InstallInfo installInfo=new InstallInfo(location,url.openStream());
  scopeUpdate.getBundlesToInstall().add(installInfo);
  scopeUpdate.commit();
  Bundle bundle=bundleContext.getBundle(location);
  assertTrue(scope.getBundles().contains(bundle));
  bundle.start();
  ServiceReference<BundleProvider> bundleProviderRef=bundleContext.getServiceReference(BundleProvider.class);
  BundleProvider bundleProvider=bundleContext.getService(bundleProviderRef);
  assertTrue(bundleProvider.getBundles().contains(bundleContext.getBundle()));
  assertTrue(Arrays.asList(bundleContext.getBundles()).contains(bundle));
  assertNotNull(bundleContext.getBundle(bundle.getBundleId()));
  assertNotNull(bundleProvider.getBundle(bundle.getBundleId()));
  bundleContext.ungetService(bundleProviderRef);
  bundle.uninstall();
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Install a bundle into a different scope than this one. Neither bundle
 * should be able to see the other.
 * @throws Exception
 */
@Test public void test2() throws Exception {
  Scope scope=getScope();
  assertTrue(scope.getBundles().contains(bundleContext.getBundle()));
  ScopeUpdate scopeUpdate=scope.newScopeUpdate();
  ScopeUpdate child=scopeUpdate.newChild("tb4");
  scopeUpdate.getChildren().add(child);
  String location=getBundleLocation("tb-4.jar");
  assertNull(bundleContext.getBundle(location));
  URL url=new URL(location);
  InstallInfo installInfo=new InstallInfo(location,url.openStream());
  child.getBundlesToInstall().add(installInfo);
  addPackageImportPolicy("org.osgi.framework",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope.itests",child);
  addServiceExportPolicy(BundleProvider.class,child);
  scopeUpdate.commit();
  Bundle bundle=bundleContext.getBundle(location);
  assertNotNull(bundle);
  Collection<Scope> childScopes=scope.getChildren();
  assertEquals(1,childScopes.size());
  assertTrue(childScopes.iterator().next().getBundles().contains(bundle));
  bundle.start();
  ServiceReference<BundleProvider> bundleProviderRef=bundleContext.getServiceReference(BundleProvider.class);
  BundleProvider bundleProvider=bundleContext.getService(bundleProviderRef);
  assertFalse(Arrays.asList(bundleContext.getBundles()).contains(bundle));
  assertNull(bundleContext.getBundle(bundle.getBundleId()));
  assertFalse(bundleProvider.getBundles().contains(bundleContext.getBundle()));
  assertNull(bundleProvider.getBundle(bundleContext.getBundle().getBundleId()));
  bundleContext.ungetService(bundleProviderRef);
  bundle.uninstall();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.GetScopeServiceTest </h4><pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A new scope is created as a child of the root scope and the tb3 bundle
 * is added to it. The tb3 bundle should receive and be in the new scope.
 * The bundle is added directly as opposed to via an InstallInfo.
 * @throws Exception
 */
@Test public void test4() throws Exception {
  Scope scope=getScope();
  Bundle bundle=installBundle("tb-3.jar");
  ScopeUpdate scopeUpdate=scope.newScopeUpdate();
  scopeUpdate.getBundles().remove(bundle);
  ScopeUpdate child=scopeUpdate.newChild("tb3");
  scopeUpdate.getChildren().add(child);
  child.getBundles().add(bundle);
  addPackageImportPolicy("org.osgi.framework",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope.itests",child);
  addServiceImportPolicy(Scope.class,child);
  addServiceExportPolicy(ScopeProvider.class,child);
  scopeUpdate.commit();
  bundle.start();
  ServiceReference<ScopeProvider> scopeProviderRef=bundleContext.getServiceReference(ScopeProvider.class);
  ScopeProvider scopeProvider=bundleContext.getService(scopeProviderRef);
  scope=scopeProvider.getScope();
  assertEquals("tb3",scope.getName());
  assertTrue(scope.getBundles().contains(bundle));
  bundleContext.ungetService(scopeProviderRef);
  bundle.uninstall();
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The tb3 bundle should also be in and receive the root scope by default.
 * @throws Exception
 */
@Test public void test2() throws Exception {
  Bundle bundle=installBundle("tb-3.jar");
  bundle.start();
  ServiceReference<ScopeProvider> scopeProviderRef=bundleContext.getServiceReference(ScopeProvider.class);
  ScopeProvider scopeProvider=bundleContext.getService(scopeProviderRef);
  Scope scope=scopeProvider.getScope();
  assertEquals(getScope(),scope);
  assertTrue(scope.getBundles().contains(bundle));
  bundleContext.ungetService(scopeProviderRef);
  bundle.uninstall();
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A new scope is created as a child of the root scope and the tb3 bundle
 * is added to it. The tb3 bundle should receive and be in the new scope.
 * @throws Exception
 */
@Test public void test3() throws Exception {
  Scope scope=getScope();
  ScopeUpdate scopeUpdate=scope.newScopeUpdate();
  ScopeUpdate child=scopeUpdate.newChild("tb3");
  scopeUpdate.getChildren().add(child);
  String location=getBundleLocation("tb-3.jar");
  URL url=new URL(location);
  InstallInfo installInfo=new InstallInfo(location,url.openStream());
  child.getBundlesToInstall().add(installInfo);
  addPackageImportPolicy("org.osgi.framework",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope.itests",child);
  addServiceImportPolicy(Scope.class,child);
  addServiceExportPolicy(ScopeProvider.class,child);
  scopeUpdate.commit();
  Bundle bundle=bundleContext.getBundle(location);
  bundle.start();
  ServiceReference<ScopeProvider> scopeProviderRef=bundleContext.getServiceReference(ScopeProvider.class);
  ScopeProvider scopeProvider=bundleContext.getService(scopeProviderRef);
  scope=scopeProvider.getScope();
  assertEquals("tb3",scope.getName());
  assertTrue(scope.getBundles().contains(bundle));
  bundleContext.ungetService(scopeProviderRef);
  bundle.uninstall();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.PersistenceTest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create two scopes off of the root scope with the following structure.
 * R
 * / \
 * S1   S2
 * S1 contains bundle tb1, one import policy, and one export policy.
 * S2 contains bundle tb2 and two import policies.
 * This configuration should persist between restarts of the Scope Admin
 * bundle.
 * @throws Exception
 */
@Test public void test4() throws Exception {
  Scope root=getScope();
  ScopeUpdate rootUpdate=root.newScopeUpdate();
  ScopeUpdate s1Update=rootUpdate.newChild("S1");
  rootUpdate.getChildren().add(s1Update);
  ScopeUpdate s2Update=rootUpdate.newChild("S2");
  rootUpdate.getChildren().add(s2Update);
  s1Update.getBundlesToInstall().add(new InstallInfo(null,new URL(getBundleLocation("tb-1.jar"))));
  s2Update.getBundlesToInstall().add(new InstallInfo(null,new URL(getBundleLocation("tb-2.jar"))));
  addPackageImportPolicy("org.osgi.framework",s1Update);
  addPackageExportPolicy("org.apache.aries.subsystem.scope.itests.tb1",s1Update);
  addPackageImportPolicy("org.osgi.framework",s2Update);
  addPackageImportPolicy("org.apache.aries.subsystem.scope.itests.tb1",s2Update);
  assertTrue(rootUpdate.commit());
  root=getScope();
  assertEquals(2,root.getChildren().size());
  Scope s1=findChildScope("S1",root);
  Bundle tb1=findBundle("org.apache.aries.subsystem.scope.itests.tb1",s1);
  assertNotNull(tb1);
  assertTrue(s1.getBundles().contains(tb1));
  assertEquals(1,s1.getSharePolicies(SharePolicy.TYPE_IMPORT).get("osgi.wiring.package").size());
  assertEquals(1,s1.getSharePolicies(SharePolicy.TYPE_EXPORT).get("osgi.wiring.package").size());
  Scope s2=findChildScope("S2",root);
  Bundle tb2=findBundle("org.apache.aries.subsystem.scope.itests.tb2",s2);
  assertNotNull(tb2);
  assertTrue(s2.getBundles().contains(tb2));
  assertEquals(2,s2.getSharePolicies(SharePolicy.TYPE_IMPORT).get("osgi.wiring.package").size());
  Bundle scopeAdmin=findBundle("org.apache.aries.subsystem.scope.impl");
  assertNotNull(scopeAdmin);
  scopeAdmin.stop();
  scopeAdmin.start();
  root=getScope();
  assertEquals(2,root.getChildren().size());
  s1=findChildScope("S1",root);
  assertTrue(s1.getBundles().contains(tb1));
  assertEquals(1,s1.getSharePolicies(SharePolicy.TYPE_IMPORT).get("osgi.wiring.package").size());
  assertEquals(1,s1.getSharePolicies(SharePolicy.TYPE_EXPORT).get("osgi.wiring.package").size());
  s2=findChildScope("S2",root);
  assertTrue(s2.getBundles().contains(tb2));
  assertEquals(2,s2.getSharePolicies(SharePolicy.TYPE_IMPORT).get("osgi.wiring.package").size());
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * A scope's persisted bundle data will become stale if bundles are 
 * installed or uninstalled while Scope Admin is not connected to the 
 * environment. This should be detected and dealt with.
 * @throws Exception
 */
@Test @Ignore public void test3() throws Exception {
  Scope scope=getScope();
  Bundle tb1=findBundle("org.apache.aries.subsystem.scope.itests.tb1",scope);
  assertNull(tb1);
  tb1=installBundle("tb-1.jar");
  assertTrue(scope.getBundles().contains(tb1));
  Bundle scopeAdmin=findBundle("org.apache.aries.subsystem.scope.impl");
  assertNotNull(scopeAdmin);
  scopeAdmin.stop();
  scopeAdmin.start();
  scope=getScope();
  assertTrue(scope.getBundles().contains(tb1));
  scopeAdmin.stop();
  tb1.uninstall();
  Bundle tb2=findBundle("org.apache.aries.subsystem.scope.itests.tb2",scope);
  assertNull(tb2);
  tb2=installBundle("tb-2.jar");
  scopeAdmin.start();
  scope=getScope();
  assertFalse(scope.getBundles().contains(tb1));
  assertTrue(scope.getBundles().contains(tb2));
  tb2.uninstall();
  assertFalse(scope.getBundles().contains(tb2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.ScopeAdminTest </h4><pre class="type-4 type-12 type-5 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleServiceIsolation() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  bt=new BundleTracker(bundleContext,Bundle.INSTALLED | Bundle.UNINSTALLED | Bundle.ACTIVE,new BundleTrackerCustomizer(){
    public synchronized Object addingBundle(    Bundle bundle,    BundleEvent event){
      if (event == null) {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        addEventCount++;
      }
      return bundle;
    }
    public synchronized void modifiedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        modifyEventCount++;
      }
    }
    public synchronized void removedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        removeEventCount++;
      }
    }
  }
);
  bt.open();
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  try {
    ServiceReference sr=bundleContext.getServiceReference(HelloIsolation.class.getName());
    fail("should not be able to get the sr for HelloIsolation service");
  }
 catch (  Exception ex) {
  }
catch (  Error er) {
  }
  Bundle[] bundles=bundleContext.getBundles();
  for (  Bundle b : bundles) {
    System.out.println("Bundle is " + b.getBundleId() + ": "+ b.getSymbolicName());
    if (b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1) {
      fail("bundles with name starts with org.apache.aries.subsystem.example.helloIsolation should be in a different scope");
    }
  }
  Collection<Scope> children=scope.getChildren();
  assertEquals(1,children.size());
  for (  Scope child : children) {
    if (child.getName().equals("scope_test1")) {
      Collection<Bundle> buns=child.getBundles();
      assertEquals(2,buns.size());
      assertEquals(0,child.getChildren().size());
      for (      Bundle b : buns) {
        assertTrue(b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1);
      }
    }
  }
  URL url=new URL("mvn:org.apache.felix/org.apache.felix.fileinstall/2.0.8");
  bundleContext.installBundle("org.apache.felix.fileinstall-rootScope",url.openStream());
  assertEquals("add event count should be 1 since 1 bundles are installed",1,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testPackageSharingFromTestScope() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  Map<String,List<SharePolicy>> sharePolicies=childScopeUpdate.getSharePolicies(SharePolicy.TYPE_EXPORT);
  final Filter filter1=FrameworkUtil.createFilter("(&" + "(osgi.wiring.package=org.apache.aries.subsystem.example.helloIsolation)" + ")");
  final Filter filter2=FrameworkUtil.createFilter("(&" + "(scope.share.service=org.apache.aries.subsystem.example.helloIsolation.HelloIsolation)" + ")");
  List<SharePolicy> packagePolicies=sharePolicies.get(BundleRevision.PACKAGE_NAMESPACE);
  if (packagePolicies == null) {
    packagePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put(BundleRevision.PACKAGE_NAMESPACE,packagePolicies);
  }
  packagePolicies.add(new SharePolicy(SharePolicy.TYPE_EXPORT,BundleRevision.PACKAGE_NAMESPACE,filter1));
  List<SharePolicy> servicePolicies=sharePolicies.get("scope.share.service");
  if (servicePolicies == null) {
    servicePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put("scope.share.service",servicePolicies);
  }
  servicePolicies.add(new SharePolicy(SharePolicy.TYPE_EXPORT,"scope.share.service",filter2));
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT");
  Bundle helloIsolationRef=bundleContext.installBundle("helloIsolationRef1-rootScope",url1.openStream());
  try {
    helloIsolationRef.start();
  }
 catch (  Exception ex) {
    fail("should be able to start helloIsolationRef by import packages from scope_test1");
  }
  helloIsolationRef.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPackageSharingFromRootScope() throws Exception {
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT");
  Bundle helloIsolation=bundleContext.installBundle("helloIsolation1-rootScope",url1.openStream());
  try {
    helloIsolation.start();
  }
 catch (  Exception ex) {
    fail("should be able to start helloIsolation");
  }
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  Map<String,List<SharePolicy>> sharePolicies=childScopeUpdate.getSharePolicies(SharePolicy.TYPE_IMPORT);
  final Filter filter1=FrameworkUtil.createFilter("(&" + "(osgi.wiring.package=org.apache.aries.subsystem.example.helloIsolation)" + ")");
  final Filter filter2=FrameworkUtil.createFilter("(&" + "(scope.share.service=org.apache.aries.subsystem.example.helloIsolation.HelloIsolation)" + ")");
  List<SharePolicy> packagePolicies=sharePolicies.get(BundleRevision.PACKAGE_NAMESPACE);
  if (packagePolicies == null) {
    packagePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put(BundleRevision.PACKAGE_NAMESPACE,packagePolicies);
  }
  packagePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,BundleRevision.PACKAGE_NAMESPACE,filter1));
  List<SharePolicy> servicePolicies=sharePolicies.get("scope.share.service");
  if (servicePolicies == null) {
    servicePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put("scope.share.service",servicePolicies);
  }
  servicePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,"scope.share.service",filter2));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    try {
      b.start();
    }
 catch (    Exception ex) {
      ex.printStackTrace();
      fail("should be able to start helloIsolationRef in scope_test1");
    }
  }
  helloIsolation.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testPackageIsolation() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT");
  Bundle helloIsolationRef=bundleContext.installBundle("helloIsolationRef1-rootScope",url1.openStream());
  try {
    helloIsolationRef.start();
    fail("should not be able to start helloIsolationRef since missing import packages");
  }
 catch (  Exception ex) {
  }
  URL url2=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT");
  Bundle helloIsolation=bundleContext.installBundle("helloIsolation1-rootScope",url2.openStream());
  helloIsolation.start();
  helloIsolationRef.start();
  helloIsolationRef.uninstall();
  helloIsolation.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.ServiceVisibilityTest </h4><pre class="type-4 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Install a bundle registering a service into the same scope as this one. 
 * This bundle should be able to see the service.
 * @throws Exception
 */
@Test public void test1() throws Exception {
  assertTrue(getScope().getBundles().contains(bundleContext.getBundle()));
  ScopeUpdate scopeUpdate=getScope().newScopeUpdate();
  String location=getBundleLocation("tb-7.jar");
  assertNull(bundleContext.getBundle(location));
  URL url=new URL(location);
  InstallInfo installInfo=new InstallInfo(location,url.openStream());
  scopeUpdate.getBundlesToInstall().add(installInfo);
  scopeUpdate.commit();
  Bundle bundle=bundleContext.getBundle(location);
  assertNotNull(bundle);
  assertTrue(getScope().getBundles().contains(bundle));
  bundle.start();
  ServiceReference<Service> serviceRef=bundleContext.getServiceReference(Service.class);
  assertNotNull(serviceRef);
  Service service=bundleContext.getService(serviceRef);
  assertNotNull(service);
  bundleContext.ungetService(serviceRef);
  bundle.uninstall();
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Install a bundle registering a service into a different scope than this 
 * one. This bundle should not be able to see the service.
 * @throws Exception
 */
@Test public void test2() throws Exception {
  assertTrue(getScope().getBundles().contains(bundleContext.getBundle()));
  String location=getBundleLocation("tb-7.jar");
  assertNull(bundleContext.getBundle(location));
  URL url=new URL(location);
  InstallInfo installInfo=new InstallInfo(location,url.openStream());
  ScopeUpdate scopeUpdate=getScope().newScopeUpdate();
  ScopeUpdate child=scopeUpdate.newChild("tb7");
  scopeUpdate.getChildren().add(child);
  child.getBundlesToInstall().add(installInfo);
  addPackageImportPolicy("org.osgi.framework",child);
  addPackageImportPolicy("org.apache.aries.subsystem.scope.itests",child);
  scopeUpdate.commit();
  Bundle bundle=bundleContext.getBundle(location);
  assertNotNull(bundle);
  assertTrue(child.getScope().getBundles().contains(bundle));
  bundle.start();
  ServiceReference<Service> serviceRef=bundleContext.getServiceReference(Service.class);
  assertNull(serviceRef);
  bundle.uninstall();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.UninstallBundleTest </h4><pre class="type-4 type-9 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before0() throws Exception {
  location=getBundleLocation("tb-2.jar");
  bundle=bundleContext.getBundle(location);
  assertNull("The bundle should not exist",bundle);
  installBundles(getScope(),new String[]{"tb-2.jar"});
  bundle=bundleContext.getBundle(location);
  assertNotNull("The bundle should exist",bundle);
  assertTrue("The bundle should part of the scope",getScope().getBundles().contains(bundle));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.transaction.TranStrategyTest </h4><pre class="type-4 type-15 type-5 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMandatoryBegin() throws Exception {
  expect(tm.getStatus()).andReturn(Status.STATUS_NO_TRANSACTION);
  try {
    assertNotNull("TransactionStrategy.MANDATORY.begin(tm) returned null when manager " + "status is STATUS_NO_TRANSACTION",TransactionAttribute.MANDATORY.begin(tm).getActiveTransaction());
  }
 catch (  IllegalStateException ise) {
  }
catch (  Exception e) {
    fail("TransactionStrategy.MANDATORY.begin() threw an unexpected exception when tran manager status is STATUS_NO_TRANSACTION");
  }
  int[] invalids=new int[]{Status.STATUS_COMMITTED,Status.STATUS_COMMITTING,Status.STATUS_MARKED_ROLLBACK,Status.STATUS_ACTIVE,Status.STATUS_PREPARED,Status.STATUS_PREPARING,Status.STATUS_ROLLEDBACK,Status.STATUS_ROLLING_BACK,Status.STATUS_UNKNOWN};
  for (int i=0; i < invalids.length; i++) {
    c.reset();
    expect(tm.getStatus()).andReturn(invalids[i]);
    expect(tm.getTransaction()).andReturn(null);
    c.replay();
    try {
      Transaction tran=TransactionAttribute.MANDATORY.begin(tm).getActiveTransaction();
      assertNull("TransactionStrategy.MANDATORY.begin() did not return null when manager status value is " + invalids[i],tran);
    }
 catch (    Exception ise) {
      fail("TransactionStrategy.MANDATORY.begin() threw Exception when manager status value is " + invalids[i]);
    }
    c.verify();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.transaction.internal.XidFactoryImplTest </h4><pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLong(){
  byte[] buffer=new byte[64];
  long l1=1343120074022l;
  XidFactoryImpl.insertLong(l1,buffer,4);
  long l2=XidFactoryImpl.extractLong(buffer,4);
  assertEquals(l1,l2);
  l1=1343120074022l - TimeUnit.DAYS.toMillis(15);
  XidFactoryImpl.insertLong(l1,buffer,4);
  l2=XidFactoryImpl.extractLong(buffer,4);
  assertEquals(l1,l2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.FragmentUtilsTest </h4><pre class="type-4 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testFragmentCreation() throws Exception {
  Bundle exportBundle=makeBundleWithExports("export.bundle","1.2.3","export.package;version=\"1.0.0\";uses:=\"foo.jar,bar.jar\";singleton:=true");
  Dictionary fragmentHeaders=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertNotNull("No headers in the fragment",fragmentHeaders);
  assertEquals("Wrong symbolicName","scooby.doo.test.fragment",fragmentHeaders.get(Constants.BUNDLE_SYMBOLICNAME));
  assertEquals("Wrong version","0.0.0",fragmentHeaders.get(Constants.BUNDLE_VERSION));
  assertEquals("Wrong Bundle manifest version","2",fragmentHeaders.get(Constants.BUNDLE_MANIFESTVERSION));
  assertEquals("Wrong Fragment host","scooby.doo;bundle-version=\"0.0.0\"",fragmentHeaders.get(Constants.FRAGMENT_HOST));
  assertEquals("Wrong Bundle Name","Test Fragment bundle",fragmentHeaders.get(Constants.BUNDLE_NAME));
  assertEquals("Wrong Imports","export.package;version=\"1.0.0\";bundle-symbolic-name=\"export.bundle\";bundle-version=\"[1.2.3,1.2.3]\"",fragmentHeaders.get(Constants.IMPORT_PACKAGE));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testManifestAttributes() throws Exception {
  String fakeExportsListNoExtras="no.such.export,no.such.export2";
  String fakeExportsListAttrOnly="no.such.export;version=\"1.1.1\",no.such.export2;version=\"2.2.2\"";
  String fakeExportsListDirOnly="no.such.export;uses:=\"some.other.thing\",no.such.export2;include:=\"some.thing\"";
  String fakeExportsListMixed="no.such.export;version=\"1.1.1\";uses:=\"some.other.thing\",no.such.export2;include:=\"some.thing\"";
  String fakeExportsListFunkyAttr="no.such.export;attribute=\"a:=\",no.such.export2;attributeTwo=\"b:=\";include:=\"some.thing\"";
  String expectedImportsListNoExtras="no.such.export;bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\",no.such.export2;bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\"";
  String expectedImportsListAttrOnly="no.such.export;version=\"1.1.1\";bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\",no.such.export2;version=\"2.2.2\";bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\"";
  String expectedImportsListDirOnly="no.such.export;bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\",no.such.export2;bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\"";
  String expectedImportsListMixed="no.such.export;version=\"1.1.1\";bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\",no.such.export2;bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\"";
  String expectedImportsListFunkyAttr="no.such.export;attribute=\"a:=\";bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\",no.such.export2;attributeTwo=\"b:=\";bundle-symbolic-name=\"no.such.provider\";bundle-version=\"[1.1.1,1.1.1]\"";
  Bundle exportBundle=makeBundleWithExports("no.such.provider","1.1.1",fakeExportsListNoExtras);
  Dictionary headers=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertEquals("Import list did not match expected value, expectedImportsListNoExtras",expectedImportsListNoExtras,headers.get(Constants.IMPORT_PACKAGE));
  exportBundle=makeBundleWithExports("no.such.provider","1.1.1",fakeExportsListAttrOnly);
  headers=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertEquals("Import list did not match expected value, expectedImportsListAttrOnly",expectedImportsListAttrOnly,headers.get(Constants.IMPORT_PACKAGE));
  exportBundle=makeBundleWithExports("no.such.provider","1.1.1",fakeExportsListDirOnly);
  headers=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertEquals("Import list did not match expected value, expectedImportsListDirOnly",expectedImportsListDirOnly,headers.get(Constants.IMPORT_PACKAGE));
  exportBundle=makeBundleWithExports("no.such.provider","1.1.1",fakeExportsListMixed);
  headers=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertEquals("Import list did not match expected value, expectedImportsListMixed",expectedImportsListMixed,headers.get(Constants.IMPORT_PACKAGE));
  exportBundle=makeBundleWithExports("no.such.provider","1.1.1",fakeExportsListFunkyAttr);
  headers=makeFragmentFromExportBundle(exportBundle).getHeaders();
  assertEquals("Import list did not match expected value, expectedImportsListFunkyAttr",expectedImportsListFunkyAttr,headers.get(Constants.IMPORT_PACKAGE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.filesystem.FileSystemTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Make sure we correctly understand the directory structure for zips.
 * @throws IOException
 */
@Test public void basicDirTestsWithZip() throws IOException {
  File baseDir=new File("fileSystemTest/app2.zip");
  IDirectory dir=FileSystem.getFSRoot(baseDir);
  assertTrue(dir.toString(),dir.toString().endsWith("app2.zip"));
  File desiredFile=new File(new File(getTestResourceDir(),"/app1"),"META-INF/APPLICATION.MF");
  runBasicDirTest(dir,desiredFile.length(),desiredFile.lastModified());
  runBasicDirTest(dir.toCloseable(),desiredFile.length(),desiredFile.lastModified());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.filesystem.FileUtilsTest </h4><pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure we get the bundles files recursively regardless of the file extension.
 * @throws IOException
 */
@SuppressWarnings("deprecation") @Test public void testGetBundlesRecursive() throws IOException {
  File tmpDir=new File("../src/test/resources/tmpJars");
  tmpDir.mkdirs();
  for (int n=0; n < 2; n++) {
    ZipFixture bundle=ArchiveFixture.newJar().manifest().attribute(Constants.BUNDLE_SYMBOLICNAME,"aa" + n).attribute(Constants.BUNDLE_MANIFESTVERSION,"2").attribute(Constants.IMPORT_PACKAGE,"a.b.c, p.q.r, x.y.z, javax.naming").attribute(Constants.BUNDLE_VERSION,"1.0.0").end();
    FileOutputStream fout=new FileOutputStream(new File(tmpDir.getAbsoluteFile(),"aa" + n + ((n == 0) ? ".jar" : ".war")));
    bundle.writeOut(fout);
    fout.close();
  }
  File subDir=new File(tmpDir,"subDir");
  subDir.mkdirs();
  for (int n=0; n < 2; n++) {
    ZipFixture bundle=ArchiveFixture.newJar().manifest().attribute(Constants.BUNDLE_SYMBOLICNAME,"aa" + n).attribute(Constants.BUNDLE_MANIFESTVERSION,"2").attribute(Constants.IMPORT_PACKAGE,"a.b.c, p.q.r, x.y.z, javax.naming").attribute(Constants.BUNDLE_VERSION,"1.0.0").end();
    FileOutputStream fout=new FileOutputStream(new File(subDir.getAbsoluteFile(),"aa" + n + ((n == 0) ? ".jar" : ".war")));
    bundle.writeOut(fout);
    fout.close();
  }
  for (int n=0; n < 2; n++) {
    ZipFixture bundle=ArchiveFixture.newJar().manifest().attribute(Constants.BUNDLE_MANIFESTVERSION,"2").attribute(Constants.IMPORT_PACKAGE,"a.b.c, p.q.r, x.y.z, javax.naming").attribute(Constants.BUNDLE_VERSION,"1.0.0").end();
    FileOutputStream fout=new FileOutputStream(new File(tmpDir,"bb" + n + ".jar"));
    bundle.writeOut(fout);
    fout.close();
  }
  IOUtils.writeOut(tmpDir,"simple.jar",new ByteArrayInputStream("abc".getBytes()));
  IOUtils.writeOut(tmpDir,"simple.war",new ByteArrayInputStream("sss".getBytes()));
  IOUtils.writeOut(tmpDir,"simple.txt",new ByteArrayInputStream("abc".getBytes()));
  IOUtils.writeOut(tmpDir,"some/relative/directory/complex.jar",new ByteArrayInputStream("def".getBytes()));
  IOUtils.writeOut(tmpDir,"some/relative/directory/aa/complex2.war",new ByteArrayInputStream("ghi".getBytes()));
  IOUtils.writeOut(tmpDir,"simple",new ByteArrayInputStream("abc".getBytes()));
  List<URI> jarFiles=FileUtils.getBundlesRecursive(tmpDir.toURI());
  assertEquals("There should be 4 entries.",4,jarFiles.size());
  assertTrue("The entry should contain this aa0.jar",jarFiles.contains(new File(tmpDir,"aa0.jar").toURI()));
  assertTrue("The entry should contain this aa1.war",jarFiles.contains(new File(tmpDir,"aa1.war").toURI()));
  assertTrue("The entry should contain this aa0.jar",jarFiles.contains(new File(subDir,"aa0.jar").toURI()));
  assertTrue("The entry should contain this aa1.war",jarFiles.contains(new File(subDir,"aa1.war").toURI()));
  IOUtils.deleteRecursive(tmpDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.manifest.BundleManifestTest </h4><pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZipWithName() throws Exception {
  JarInputStream jarIs=new JarInputStream(new FileInputStream(BUNDLE_WITH_NAME_HEADER));
  assertNull(jarIs.getManifest());
  jarIs.close();
  BundleManifest sut=BundleManifest.fromBundle(BUNDLE_WITH_NAME_HEADER);
  assertEquals(EXPECTED_SYMBOLIC_NAME,sut.getSymbolicName());
  assertEquals(EXPECTED_VERSION,sut.getVersion().toString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZipWithNameFromIDirectory() throws Exception {
  JarInputStream jarIs=new JarInputStream(new FileInputStream(BUNDLE_WITH_NAME_HEADER));
  assertNull(jarIs.getManifest());
  jarIs.close();
  BundleManifest sut=BundleManifest.fromBundle(FileSystem.getFSRoot(BUNDLE_WITH_NAME_HEADER));
  assertEquals(EXPECTED_SYMBOLIC_NAME,sut.getSymbolicName());
  assertEquals(EXPECTED_VERSION,sut.getVersion().toString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZipFromIDirectory() throws Exception {
  JarInputStream jarIs=new JarInputStream(new FileInputStream(BUNDLE_WITHOUT_NAME_HEADER));
  assertNull(jarIs.getManifest());
  jarIs.close();
  BundleManifest sut=BundleManifest.fromBundle(FileSystem.getFSRoot(BUNDLE_WITHOUT_NAME_HEADER));
  assertEquals(EXPECTED_SYMBOLIC_NAME,sut.getSymbolicName());
  assertEquals(EXPECTED_VERSION,sut.getVersion().toString());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZip() throws Exception {
  JarInputStream jarIs=new JarInputStream(new FileInputStream(BUNDLE_WITHOUT_NAME_HEADER));
  assertNull(jarIs.getManifest());
  jarIs.close();
  BundleManifest sut=BundleManifest.fromBundle(BUNDLE_WITHOUT_NAME_HEADER);
  assertEquals(EXPECTED_SYMBOLIC_NAME,sut.getSymbolicName());
  assertEquals(EXPECTED_VERSION,sut.getVersion().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.manifest.ManifestHeaderProcessorTest </h4><pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the Bundle manifest header entry of
 * Bundle-SymbolicName: com.acme.foo;singleton:=true
 */
@Test public void testParseBundleSymbolicName(){
  String bundleSymbolicNameEntry="com.acme.foo;singleton:=true;fragment-attachment:=always";
  NameValuePair nvp=ManifestHeaderProcessor.parseBundleSymbolicName(bundleSymbolicNameEntry);
  assertEquals("The symbolic name is wrong.",nvp.getName(),"com.acme.foo");
  assertEquals("The value is wrong.","true",nvp.getAttributes().get("singleton:"));
  assertEquals("The directive is wrong.","always",nvp.getAttributes().get("fragment-attachment:"));
  String bundleSymbolicNameEntry2="com.acme.foo";
  NameValuePair nvp2=ManifestHeaderProcessor.parseBundleSymbolicName(bundleSymbolicNameEntry2);
  assertEquals("The symbolic name is wrong.",nvp2.getName(),"com.acme.foo");
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSplit() throws Exception {
  String export="com.ibm.ws.eba.obr.fep.bundle122;version=\"3\";company=mood;local=yes;security=yes;mandatory:=\"mood,security\"";
  List<String> result=ManifestHeaderProcessor.split(export,",");
  assertEquals("The result is wrong.",export,result.get(0));
  assertEquals("The result is wrong.",1,result.size());
  String aString="com.acme.foo;weirdAttr=\"one;two;three\";weirdDir:=\"1;2;3\"";
  result=ManifestHeaderProcessor.split(aString,";");
  assertEquals("The result is wrong.","com.acme.foo",result.get(0));
  assertEquals("The result is wrong.","weirdAttr=\"one;two;three\"",result.get(1));
  assertEquals("The result is wrong.","weirdDir:=\"1;2;3\"",result.get(2));
  assertEquals("The result is wrong.",3,result.size());
  String pkg1="com.ibm.ws.eba.example.helloIsolation;version=\"1.0.0\" ";
  String pkg2="com.ibm.ws.eba.helloWorldService;version=\"[1.0.0,1.0.0]\"";
  String pkg3=" com.ibm.ws.eba.helloWorldService;version=\"1.0.0\"";
  String pkg4="com.ibm.ws.eba.helloWorldService;version=\"[1.0.0,1.0.0]\";sharing:=shared";
  String pkg5="com.ibm.ws.eba.helloWorldService;sharing:=shared;version=\"[1.0.0,1.0.0]\"";
  String appContent1=pkg1 + ", " + pkg2+ ", "+ pkg3;
  String appContent2=pkg2 + ", " + pkg1+ ", "+ pkg3;
  String appContent3=pkg1 + ", " + pkg3+ ", "+ pkg2;
  String appContent4=pkg1 + ", " + pkg3+ ", "+ pkg4;
  String appContent5=pkg1 + ", " + pkg3+ ", "+ pkg5;
  List<String> splitList=ManifestHeaderProcessor.split(appContent1,",");
  assertEquals(pkg1.trim(),splitList.get(0));
  assertEquals(pkg2.trim(),splitList.get(1));
  assertEquals(pkg3.trim(),splitList.get(2));
  splitList=ManifestHeaderProcessor.split(appContent2,",");
  assertEquals(pkg2.trim(),splitList.get(0));
  assertEquals(pkg1.trim(),splitList.get(1));
  assertEquals(pkg3.trim(),splitList.get(2));
  splitList=ManifestHeaderProcessor.split(appContent3,",");
  assertEquals(pkg1.trim(),splitList.get(0));
  assertEquals(pkg3.trim(),splitList.get(1));
  assertEquals(pkg2.trim(),splitList.get(2));
  splitList=ManifestHeaderProcessor.split(appContent4,",");
  assertEquals(pkg1.trim(),splitList.get(0));
  assertEquals(pkg3.trim(),splitList.get(1));
  assertEquals(pkg4.trim(),splitList.get(2));
  splitList=ManifestHeaderProcessor.split(appContent5,",");
  assertEquals(pkg1.trim(),splitList.get(0));
  assertEquals(pkg3.trim(),splitList.get(1));
  assertEquals(pkg5.trim(),splitList.get(2));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the import package and import service
 * Import-Package: com.acme.foo;come.acm,e.bar;version="[1.23,1.24.5]";resolution:=mandatory
 */
@Test public void testParseImportString(){
  String importPackage="com.acme.foo,come.acm.e.bar;version=\"[1.23,1.24.5]\";resolution:=mandatory;company=\"ACME\",a.b.c;version=1.2.3;company=com";
  Map<String,Map<String,String>> importPackageReturn=ManifestHeaderProcessor.parseImportString(importPackage);
  assertTrue("The package is not set.",importPackageReturn.containsKey("com.acme.foo"));
  assertTrue("The package is not set.",importPackageReturn.containsKey("come.acm.e.bar"));
  assertTrue("The package is not set.",importPackageReturn.containsKey("come.acm.e.bar"));
  assertTrue("The package is not set.",importPackageReturn.containsKey("a.b.c"));
  assertTrue("The package should not contain any attributes.",importPackageReturn.get("com.acme.foo").isEmpty());
  assertEquals("The directive is not set correctly.","[1.23,1.24.5]",importPackageReturn.get("come.acm.e.bar").get("version"));
  assertEquals("The directive is not set correctly.","mandatory",importPackageReturn.get("come.acm.e.bar").get("resolution:"));
  assertEquals("The directive is not set correctly.","ACME",importPackageReturn.get("come.acm.e.bar").get("company"));
  assertEquals("The directive is not set correctly.","1.2.3",importPackageReturn.get("a.b.c").get("version"));
  assertEquals("The directive is not set correctly.","com",importPackageReturn.get("a.b.c").get("company"));
  importPackage="com.acme.foo";
  assertTrue("The package is not set.",importPackageReturn.containsKey("com.acme.foo"));
  assertTrue("The package should not contain any attributes.",importPackageReturn.get("com.acme.foo").isEmpty());
  importPackage="com.acme.foo;com.acme.bar;version=2";
  Map<String,Map<String,String>> importPackageReturn2=ManifestHeaderProcessor.parseImportString(importPackage);
  assertTrue("The package is not set.",importPackageReturn2.containsKey("com.acme.foo"));
  assertTrue("The package is not set.",importPackageReturn2.containsKey("com.acme.bar"));
  assertEquals("The directive is not set correctly.","2",importPackageReturn2.get("com.acme.foo").get("version"));
  assertEquals("The directive is not set correctly.","2",importPackageReturn2.get("com.acme.bar").get("version"));
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseExportString(){
  String exportPackage="com.acme.foo,com.acme.bar;version=1,com.acme.bar;version=2;uses:=\"a.b.c,d.e.f\";security=false;mandatory:=security";
  List<NameValuePair> exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int i=0;
  assertEquals("The number of the packages is wrong.",3,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      i++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("2".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertEquals("The directive is wrong.","a.b.c,d.e.f",nvp.getAttributes().get("uses:"));
      assertEquals("The directive is wrong.","false",nvp.getAttributes().get("security"));
      assertEquals("The directive is wrong.","security",nvp.getAttributes().get("mandatory:"));
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("1".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertNull("The directive is wrong.",nvp.getAttributes().get("uses:"));
      assertNull("The directive is wrong.",nvp.getAttributes().get("security"));
      assertNull("The directive is wrong.",nvp.getAttributes().get("mandatory:"));
    }
  }
  assertEquals("The names of the packages are wrong.",3,i);
  exportPackage="com.acme.foo";
  exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int k=0;
  assertEquals("The number of the packages is wrong.",1,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      k++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
  }
  assertEquals("The names of the packages are wrong.",1,k);
  exportPackage="com.acme.foo;com.acme.bar;version=\"2\";resolution:=optional";
  exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  k=0;
  assertEquals("The number of the packages is wrong.",2,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      k++;
      assertEquals("The attribute is wrong.","2",nvp.getAttributes().get("version"));
      assertEquals("The attribute is wrong.","optional",nvp.getAttributes().get("resolution:"));
    }
 else     if (nvp.getName().equals("com.acme.bar")) {
      k++;
      assertEquals("The attribute is wrong.","2",nvp.getAttributes().get("version"));
      assertEquals("The attribute is wrong.","optional",nvp.getAttributes().get("resolution:"));
    }
  }
  assertEquals("The names of the packages are wrong.",2,k);
  exportPackageReturn=ManifestHeaderProcessor.parseExportString("some.export.with.space.in;directive := spacey");
  assertEquals(exportPackageReturn.toString(),"spacey",exportPackageReturn.get(0).getAttributes().get("directive:"));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the filter generated correctly
 * @throws Exception
 */
@Test public void testGenerateFilter() throws Exception {
  Map<String,String> valueMap=new HashMap<String,String>();
  valueMap.put("version","[1.2, 2.3]");
  valueMap.put("resulution:","mandatory");
  valueMap.put("company","com");
  String filter=ManifestHeaderProcessor.generateFilter("symbolic-name","com.ibm.foo",valueMap);
  String expected=createExpectedFilter(valueMap,"(&(symbolic-name=com.ibm.foo)","(company=com)","(version>=1.2.0)(version<=2.3.0)","(mandatory:<*company))");
  assertEquals("The filter is wrong.",expected,filter);
  valueMap.clear();
  valueMap.put("version","(1.2, 2.3]");
  valueMap.put("resulution:","mandatory");
  valueMap.put("company","com");
  filter=ManifestHeaderProcessor.generateFilter("symbolic-name","com.ibm.foo",valueMap);
  expected=createExpectedFilter(valueMap,"(&(symbolic-name=com.ibm.foo)","(company=com)","(version>=1.2.0)(version<=2.3.0)(!(version=1.2.0))","(mandatory:<*company))");
  assertEquals("The filter is wrong.",expected,filter);
  valueMap.clear();
  valueMap.put("version","(1.2, 2.3)");
  valueMap.put("resulution:","mandatory");
  valueMap.put("company","com");
  filter=ManifestHeaderProcessor.generateFilter("symbolic-name","com.ibm.foo",valueMap);
  expected=createExpectedFilter(valueMap,"(&(symbolic-name=com.ibm.foo)","(company=com)","(version>=1.2.0)(version<=2.3.0)(!(version=1.2.0))(!(version=2.3.0))","(mandatory:<*company))");
  assertEquals("The filter is wrong.",expected,filter);
  valueMap.clear();
  valueMap.put("version","1.2");
  valueMap.put("resulution:","mandatory");
  valueMap.put("company","com");
  filter=ManifestHeaderProcessor.generateFilter("symbolic-name","com.ibm.foo",valueMap);
  expected=createExpectedFilter(valueMap,"(&(symbolic-name=com.ibm.foo)","(company=com)","(version>=1.2.0)","(mandatory:<*company))");
  assertEquals("The filter is wrong.",expected,filter);
  valueMap.clear();
  valueMap.put("resulution:","mandatory");
  valueMap.put("company","com");
  filter=ManifestHeaderProcessor.generateFilter("symbolic-name","com.ibm.foo",valueMap);
  expected=createExpectedFilter(valueMap,"(&(symbolic-name=com.ibm.foo)","(company=com)","","(mandatory:<*company))");
  assertEquals("The filter is wrong.",expected,filter);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExportMandatoryAttributes(){
  String exportPackage="com.acme.foo,com.acme.bar;version=2;company=dodo;security=false;mandatory:=\"security,company\"";
  List<NameValuePair> exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int i=0;
  assertEquals("The number of the packages is wrong.",2,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      i++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("2".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertEquals("The directive is wrong.","dodo",nvp.getAttributes().get("company"));
      assertEquals("The directive is wrong.","false",nvp.getAttributes().get("security"));
      assertEquals("The directive is wrong.","security,company",nvp.getAttributes().get("mandatory:"));
    }
  }
  assertEquals("The names of the packages are wrong.",2,i);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the version range created correctly
 * @throws Exception
 */
@Test public void testVersionRange() throws Exception {
  String version1="[1.2.3, 4.5.6]";
  String version2="(1, 2]";
  String version3="[2,4)";
  String version4="(1,2)";
  String version5="2";
  String version6="2.3";
  String version7="[1.2.3.q, 2.3.4.p)";
  String version8="1.2.2.5";
  String version9="a.b.c";
  String version10=null;
  String version11="";
  String version12="\"[1.2.3, 4.5.6]\"";
  VersionRange vr=ManifestHeaderProcessor.parseVersionRange(version1);
  assertEquals("The value is wrong","1.2.3",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","4.5.6",vr.getMaximumVersion().toString());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version2);
  assertEquals("The value is wrong","1.0.0",vr.getMinimumVersion().toString());
  assertTrue("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","2.0.0",vr.getMaximumVersion().toString());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version3);
  assertEquals("The value is wrong","2.0.0",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","4.0.0",vr.getMaximumVersion().toString());
  assertTrue("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version4);
  assertEquals("The value is wrong","1.0.0",vr.getMinimumVersion().toString());
  assertTrue("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","2.0.0",vr.getMaximumVersion().toString());
  assertTrue("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version5);
  assertEquals("The value is wrong","2.0.0",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertNull("The value is wrong",vr.getMaximumVersion());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version6);
  assertEquals("The value is wrong","2.3.0",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertNull("The value is wrong",vr.getMaximumVersion());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version7);
  assertEquals("The value is wrong","1.2.3.q",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","2.3.4.p",vr.getMaximumVersion().toString());
  assertTrue("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version8);
  assertEquals("The value is wrong","1.2.2.5",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertNull("The value is wrong",vr.getMaximumVersion());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  boolean exception=false;
  try {
    vr=ManifestHeaderProcessor.parseVersionRange(version9);
  }
 catch (  Exception e) {
    exception=true;
  }
  assertTrue("The value is wrong",exception);
  boolean exceptionNull=false;
  try {
    vr=ManifestHeaderProcessor.parseVersionRange(version10);
  }
 catch (  Exception e) {
    exceptionNull=true;
  }
  assertTrue("The value is wrong",exceptionNull);
  vr=ManifestHeaderProcessor.parseVersionRange(version11);
  assertEquals("The value is wrong","0.0.0",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertNull("The value is wrong",vr.getMaximumVersion());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
  vr=ManifestHeaderProcessor.parseVersionRange(version12);
  assertEquals("The value is wrong","1.2.3",vr.getMinimumVersion().toString());
  assertFalse("The value is wrong",vr.isMinimumExclusive());
  assertEquals("The value is wrong","4.5.6",vr.getMaximumVersion().toString());
  assertFalse("The value is wrong",vr.isMaximumExclusive());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.versioning.tests.FilterResultsTest </h4><pre class="type-4 type-5 type-3 type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test an error is excluded when required. This test uses two bundles each containing the same
 * class, where the later versioned class has had a method removed.
 */
@Test public void testApiMethodErrorExcluded(){
  try {
    File oldBundleFile=new File("../src/test/resources/api_1.0.0.jar");
    BundleInfo oldBundle=new BundleInfo(BundleManifest.fromBundle(oldBundleFile),oldBundleFile);
    File newBundleFile=new File("../src/test/resources/api_1.0.1.jar");
    BundleInfo newBundle=new BundleInfo(BundleManifest.fromBundle(newBundleFile),newBundleFile);
    String bundleSymbolicName=newBundle.getBundleManifest().getSymbolicName();
    URLClassLoader oldClassLoader=new URLClassLoader(new URL[]{oldBundle.getBundle().toURI().toURL()});
    URLClassLoader newClassLoader=new URLClassLoader(new URL[]{newBundle.getBundle().toURI().toURL()});
    List<String> excludes=new ArrayList<String>();
    excludes.add("method void methodToBeExcludedFrom() has been deleted");
    BundleCompatibility bundleCompatibility=new BundleCompatibility(bundleSymbolicName,newBundle,oldBundle,oldClassLoader,newClassLoader,excludes);
    bundleCompatibility.invoke();
    String bundleElement=bundleCompatibility.getBundleElement();
    String pkgElement=bundleCompatibility.getPkgElements().toString();
    assertTrue("Unexpected bundle versioning issue",bundleElement == null);
    assertTrue("Unexpected package versioning issue",pkgElement.trim().length() == 0);
  }
 catch (  IOException e) {
    fail("Unexpected IOException " + e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.web.converter.impl.JSPImportParserTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJSPImportParser() throws Exception {
  InputStream helloImport=getClass().getClassLoader().getResourceAsStream("JSPs/helloImport.jsp");
  Collection<String> imports=JSPImportParser.getImports(helloImport);
  assertTrue("Four imports expected",imports.size() == 4);
  assertTrue(imports.contains("javax.jms"));
  assertTrue(imports.contains("javax.mystuff"));
  assertTrue(imports.contains("javax.transaction"));
  assertTrue(imports.contains("a.b"));
  assertFalse(imports.contains("java.util"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.web.converter.impl.WabConverterTest </h4><pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleContextPathOverride() throws Exception {
  Manifest m=new Manifest();
  Attributes attrs=m.getMainAttributes();
  attrs.putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.test");
  attrs.putValue(Constants.BUNDLE_VERSION,"1.0");
  attrs.putValue(Constants.IMPORT_PACKAGE,"org.apache.util,org.apache.test;version=1.0");
  attrs.putValue(Constants.BUNDLE_CLASSPATH,"jsp/classes");
  attrs=convertWithProperties(m,WarToWabConverter.WEB_CONTEXT_PATH,"WebFiles");
  assertEquals("org.apache.test",attrs.getValue(Constants.BUNDLE_SYMBOLICNAME));
  assertEquals("1.0",attrs.getValue(Constants.BUNDLE_VERSION));
  assertTrue(attrs.getValue(Constants.IMPORT_PACKAGE).contains("org.apache.util"));
  assertTrue(attrs.getValue(Constants.IMPORT_PACKAGE).contains("org.apache.test;version=1.0"));
  assertEquals("jsp/classes",attrs.getValue(Constants.BUNDLE_CLASSPATH));
  assertEquals("/WebFiles",attrs.getValue(WarToWabConverter.WEB_CONTEXT_PATH));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAcceptNoManifest() throws Exception {
  final ByteArrayOutputStream bout=new ByteArrayOutputStream();
  JarOutputStream out=new JarOutputStream(bout);
  out.putNextEntry(new ZipEntry("random.html"));
  out.write("hello world".getBytes());
  out.close();
  InputStreamProvider input=makeTestFile(bout.toByteArray());
  Properties props=new Properties();
  props.put(WarToWabConverter.WEB_CONTEXT_PATH,"/test");
  props.put(Constants.BUNDLE_SYMBOLICNAME,"test.bundle");
  WarToWabConverterImpl sut=new WarToWabConverterImpl(input,WAR_FILE_NAME,props);
  @SuppressWarnings("resource") Manifest m=new JarInputStream(sut.getWAB()).getManifest();
  assertEquals("test.bundle",m.getMainAttributes().getValue(Constants.BUNDLE_SYMBOLICNAME));
}

</code></pre>

<br>
<pre class="type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImportPackageWithAttributesMerge() throws Exception {
  Attributes attrs=convertWithProperties(WarToWabConverter.WEB_CONTEXT_PATH,"/test",Constants.IMPORT_PACKAGE,"javax.servlet.jsp; version=\"[2.0,2.1]\",javax.servlet.jsp.tagext; version=\"[2.0,2.1]\"");
  String actual=attrs.getValue(Constants.IMPORT_PACKAGE);
  System.out.println(actual);
  assertEquals("javax.servlet.jsp; version=\"[2.0,2.1]\"," + "javax.servlet.jsp.tagext; version=\"[2.0,2.1]\"," + "javax.servlet;version=2.5,"+ "javax.servlet.http;version=2.5,"+ "javax.servlet.jsp.el;version=2.1,"+ "javax.servlet.jsp.resources;version=2.1",actual);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleContextPathManifestOverride() throws Exception {
  Manifest m=new Manifest();
  Attributes attrs=m.getMainAttributes();
  attrs.putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.test");
  attrs.putValue(WarToWabConverter.WEB_CONTEXT_PATH,"test");
  attrs.putValue(Constants.BUNDLE_VERSION,"1.0");
  attrs.putValue(Constants.IMPORT_PACKAGE,"org.apache.util,org.apache.test;version=1.0");
  attrs.putValue(Constants.BUNDLE_CLASSPATH,"jsp/classes");
  attrs=convertWithProperties(m,WarToWabConverter.WEB_CONTEXT_PATH,"WebFiles");
  assertEquals("org.apache.test",attrs.getValue(Constants.BUNDLE_SYMBOLICNAME));
  assertEquals("1.0",attrs.getValue(Constants.BUNDLE_VERSION));
  assertTrue(attrs.getValue(Constants.IMPORT_PACKAGE).contains("org.apache.util"));
  assertTrue(attrs.getValue(Constants.IMPORT_PACKAGE).contains("org.apache.test;version=1.0"));
  assertEquals("jsp/classes",attrs.getValue(Constants.BUNDLE_CLASSPATH));
  assertEquals("/WebFiles",attrs.getValue(WarToWabConverter.WEB_CONTEXT_PATH));
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test that we can handle a null manifest (in case a jar archive was created without manifest)
 */
@Test public void testNullManifest() throws Exception {
  Properties properties=new Properties();
  properties.put(WarToWabConverter.WEB_CONTEXT_PATH,"/test");
  WarToWabConverterImpl sut=new WarToWabConverterImpl(makeTestFile(new byte[0]),WAR_FILE_NAME,properties);
  Manifest res=sut.updateManifest(null);
  Attributes attrs=res.getMainAttributes();
  assertTrue(attrs.getValue("Import-Package").contains("javax.servlet"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImportPackageMerge() throws Exception {
  Properties properties=new Properties();
  properties.put(WarToWabConverter.WEB_CONTEXT_PATH,"/test");
  WarToWabConverterImpl sut=new WarToWabConverterImpl(makeTestFile(new byte[0]),WAR_FILE_NAME,properties);
  Manifest input=new Manifest();
  input.getMainAttributes().putValue(Constants.IMPORT_PACKAGE,"com.ibm.test,javax.servlet.http");
  Manifest res=sut.updateManifest(input);
  Attributes attrs=res.getMainAttributes();
  assertEquals("com.ibm.test," + "javax.servlet.http," + "javax.servlet;version=2.5,"+ JSP_IMPORTS,attrs.getValue(Constants.IMPORT_PACKAGE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.web.converter.itest.WabConverterITest </h4><pre class="type-4 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getStarted() throws Exception {
  File testWar=File.createTempFile("test",".war");
  createTestWar(testWar);
  String baseUrl="webbundle:" + testWar.toURI().toURL().toExternalForm();
  assertTrue("Time out waiting for webbundle URL handler",waitForURLHandler(baseUrl));
  Bundle converted=bundleContext.installBundle(baseUrl + "?Bundle-SymbolicName=test.war.bundle&Web-ContextPath=foo");
  assertNotNull(converted);
  Dictionary<String,String> man=converted.getHeaders();
  assertEquals("test.war.bundle",man.get(Constants.BUNDLE_SYMBOLICNAME));
  assertEquals("/foo",man.get("Web-ContextPath"));
  assertTrue(man.get(Constants.IMPORT_PACKAGE).contains("javax.naming"));
  new File("test.war").delete();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
