<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.aries.application.modelling.utils.AbstractBundleResourceTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleResource() throws Exception {
  assertEquals("The bundle symbolic name is wrong.","test.bundle1",bundleResource.getSymbolicName());
  assertEquals("The bundle version is wrong.","2.0.0.build-121",bundleResource.getVersion().toString());
  assertEquals("The bundle presentation name is wrong.","Test Bundle",bundleResource.getExportedBundle().getAttributes().get(ModellingConstants.OBR_PRESENTATION_NAME));
  int count=0;
  for (  ImportedPackage ip : bundleResource.getImportedPackages()) {
    String filter=ip.getAttributeFilter();
    Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
    if (ip.getPackageName().equals("org.osgi.framework")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"org.osgi.framework");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"1.3.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.kernel.file")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.kernel.file");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.wsspi.application.aries")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.wsspi.application.aries");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
      assertEquals("Company wrong",parsedFilterElements.get("company"),"yang");
      assertTrue("mandatory filter missing",filter.contains("(mandatory:<*company)"));
    }
 else     if (ip.getPackageName().equals("aries.ws.ffdc")) {
      count++;
      assertEquals("The filter is wrong.","(&(package=aries.ws.ffdc)(version>=0.0.0))",ip.getAttributeFilter());
      assertTrue("Optional import not correctly represented",ip.isOptional());
    }
 else     if (ip.getPackageName().equals("aries.ws.app.framework.plugin")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.app.framework.plugin");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"[1.0.0,2.0.0)");
    }
 else     if (ip.getPackageName().equals("aries.ejs.ras")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ejs.ras");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.event")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.event");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"1.0.0");
    }
 else     if (ip.getPackageName().equals("aries.wsspi.app.container.aries")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.wsspi.app.container.aries");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("bundle-symbolic-name"),"B");
      assertEquals("Wrong bundle version",parsedFilterElements.get("bundle-version"),"[1.2.0,2.2.0)");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bla")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bla");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"0.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.launcher")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.launcher");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"[1.0.0,2.0.0]");
      assertTrue("Dynamic-ImportPackage should be optional",ip.isOptional());
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle4")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle4");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle5")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle5");
      assertEquals("Wrong package version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle6")) {
      count++;
      assertEquals("Wrong package",parsedFilterElements.get("package"),"aries.ws.eba.bundle6");
      assertEquals("The filter is wrong.","(&(package=aries.ws.eba.bundle6)(version>=0.0.0))",ip.getAttributeFilter());
    }
 else     if (ip.getPackageName().equals("aries.ws.eba.bundle7")) {
      count++;
      assertEquals("The filter is wrong.","(&(package=aries.ws.eba.bundle7)(version>=0.0.0))",ip.getAttributeFilter());
    }
  }
  for (  ImportedBundle ib : bundleResource.getRequiredBundles()) {
    String filter=ib.getAttributeFilter();
    Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
    if (ib.getSymbolicName().equals("com.acme.facade")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.acme.facade");
      assertEquals("Wrong bundle version",parsedFilterElements.get("version"),"3.0.0");
    }
 else     if (ib.getSymbolicName().equals("com.acme.bar")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.acme.bar");
    }
 else     if (ib.getSymbolicName().equals("aries.ws.eba.framework")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"aries.ws.eba.framework");
      assertEquals("Wrong bundle version",parsedFilterElements.get("version"),"(3.0.0,4.0.0)");
    }
 else     if (ib.getSymbolicName().equals("com.de.ba")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.de.ba");
    }
 else     if (ib.getSymbolicName().equals("com.ab.de")) {
      count++;
      assertEquals("Wrong bundle symbolic name",parsedFilterElements.get("symbolicname"),"com.ab.de");
    }
  }
  for (  ImportedService svc : bundleResource.getImportedServices()) {
    if (svc.getInterface().equals("aries.ws.eba.import")) {
      count++;
      String filter=svc.getAttributeFilter();
      Map<String,String> parsedFilterElements=ManifestHeaderProcessor.parseFilter(filter);
      assertEquals("Wrong object class",parsedFilterElements.get("objectClass"),"aries.ws.eba.import");
      assertTrue("(service=service) should be present",svc.getAttributeFilter().contains("(service=service)"));
      assertTrue("(mandatory:<*service) should be present",svc.getAttributeFilter().contains("(mandatory:<*service)"));
    }
  }
  assertEquals("Not all requirements are listed.",bundleResource.getImportedPackages().size() + bundleResource.getImportedServices().size() + bundleResource.getRequiredBundles().size(),count);
  int verifiedExport=0;
  for (  ExportedPackage cap : bundleResource.getExportedPackages()) {
    if (cap.getPackageName().equals("aries.ws.eba.bundle1")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","2.2.0",cap.getVersion());
      assertEquals("The export package is not expected.","test.bundle1",cap.getAttributes().get("bundle-symbolic-name"));
      assertEquals("The export package is not expected.","2.0.0.build-121",cap.getAttributes().get("bundle-version").toString());
    }
 else     if (cap.getPackageName().equals("aries.ws.eba.bundle2")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","3",cap.getVersion());
    }
 else     if (cap.getPackageName().equals("aries.ws.eba.bundle3")) {
      verifiedExport++;
      assertEquals("The export package is not expected.","3",cap.getVersion());
    }
  }
  assertEquals("The number of exports are not expected.",bundleResource.getExportedPackages().size(),verifiedExport);
  assertEquals("The bundle resource is wrong.","Test Bundle",bundleResource.getExportedBundle().getAttributes().get(ModellingConstants.OBR_PRESENTATION_NAME));
  assertEquals("The bundle resource is wrong.","2.0.0.build-121",bundleResource.getExportedBundle().getVersion());
  assertEquals("The bundle resource is wrong.","test.bundle1",bundleResource.getExportedBundle().getSymbolicName());
  for (  ExportedService svc : bundleResource.getExportedServices()) {
    assertEquals("The export service is wrong","aries.ws.eba.export",svc.getInterfaces().iterator().next());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.application.utils.manifest.ManifestProcessorTest </h4><pre class="type-12 type-5 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check metadata can be extracted from a simple manifest.
 */
@Test public void testManifestMetadata() throws Exception {
  ApplicationMetadataFactoryImpl manager=new ApplicationMetadataFactoryImpl();
  InputStream in=getClass().getClassLoader().getResourceAsStream("META-INF/APPLICATION.MF");
  ApplicationMetadata am=manager.parseApplicationMetadata(in);
  assertNotNull(am);
  assertEquals(am.getApplicationName(),appName);
  List<Content> contents=am.getApplicationContents();
  for (  Content content : contents) {
    if ("com.travel.reservation.web".equals(content.getContentName())) {
      VersionRange vr=content.getVersion();
      assertEquals(vr.getMinimumVersion(),new Version("1.1.0"));
      assertEquals(vr.getMaximumVersion(),new Version("1.2.0"));
    }
 else     if ("com.travel.reservation.business".equals(content.getContentName())) {
      VersionRange vr=content.getVersion();
      assertEquals(new Version(0,0,0),vr.getMinimumVersion());
    }
 else     fail("Unexepcted content name " + content.getContentName());
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check metadata can be extracted from a manifest that uses multiple lines
 * for a single manifest attribute.
 */
@Test public void testManifestMetadataWithMultiLineEntries() throws Exception {
  ApplicationMetadataFactoryImpl manager=new ApplicationMetadataFactoryImpl();
  InputStream in=getClass().getClassLoader().getResourceAsStream("META-INF/APPLICATION2.MF");
  ApplicationMetadata am=manager.parseApplicationMetadata(in);
  assertNotNull(am);
  assertEquals(am.getApplicationName(),appName);
  List<Content> contents=am.getApplicationContents();
  for (  Content content : contents) {
    if ("com.travel.reservation.web".equals(content.getContentName())) {
      VersionRange vr=content.getVersion();
      assertEquals(vr.getMinimumVersion(),new Version("1.1.0"));
      assertEquals(vr.getMaximumVersion(),new Version("1.2.0"));
    }
 else     if ("com.travel.reservation.business".equals(content.getContentName())) {
      VersionRange vr=content.getVersion();
      assertEquals(new Version(0,0,0),vr.getMinimumVersion());
    }
 else     fail("Unexepcted content name " + content.getContentName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.blueprint.itests.QuiesceBlueprintTest </h4><pre class="type-12 type-3 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiBundleQuiesce() throws Exception {
  System.out.println("In testMultiBundleQuiesce");
  Object obj=context().getService(TestBean.class);
  if (obj != null) {
    QuiesceParticipant participant=getParticipant("org.apache.aries.blueprint.core");
    if (participant != null) {
      TestQuiesceCallback callback=new TestQuiesceCallback();
      Bundle bundlea=getBundle("org.apache.aries.blueprint.testbundlea");
      assertNotNull(bundlea);
      bundlea.start();
      Bundle bundleq=getBundle("org.apache.aries.blueprint.testquiescebundle");
      System.out.println("Got the bundle");
      List<Bundle> bundles=new ArrayList<Bundle>();
      bundles.add(bundlea);
      bundles.add(bundleq);
      Thread t=new Thread(new TestBeanClient((TestBean)obj,1500));
      t.start();
      Thread.sleep(200);
      participant.quiesce(callback,bundles);
      System.out.println("Called Quiesce");
      Thread.sleep(500);
      Assert.assertTrue("Quiesce callback should have occurred once for bundle a but not for bundle q; calls should be 1, but it is " + callback.getCalls(),callback.getCalls() == 1);
      Thread.sleep(1500);
      System.out.println("After second sleep");
      Assert.assertTrue("Quiesce callback should have occurred twice, once for bundle a and q respectively; calls should be 2, but it is " + callback.getCalls(),callback.getCalls() == 2);
    }
 else {
      throw new Exception("No Quiesce Participant found for the blueprint service");
    }
  }
 else {
    throw new Exception("No Service returned for " + TestBean.class);
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testMultiRequestQuiesce() throws Exception {
  System.out.println("In testMultiRequestQuiesce");
  Object obj=context().getService(TestBean.class);
  if (obj != null) {
    QuiesceParticipant participant=getParticipant("org.apache.aries.blueprint.core");
    if (participant != null) {
      TestQuiesceCallback callback=new TestQuiesceCallback();
      TestBeanClient client=new TestBeanClient((TestBean)obj,1500);
      Bundle bundle=getBundle("org.apache.aries.blueprint.testquiescebundle");
      System.out.println("Got the bundle");
      List<Bundle> bundles=new ArrayList<Bundle>();
      bundles.add(bundle);
      Thread t=new Thread(client);
      t.start();
      participant.quiesce(callback,bundles);
      System.out.println("Called Quiesce, putting in a new request");
      Thread t2=new Thread(client);
      t2.start();
      Thread.sleep(5000);
      Assert.assertTrue("Quiesce callback should have occurred once; calls should be 1, but it is " + callback.getCalls(),callback.getCalls() == 1);
    }
 else {
      throw new Exception("No Quiesce Participant found for the blueprint service");
    }
  }
 else {
    throw new Exception("No Service returned for " + TestBean.class);
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoServicesQuiesce() throws Exception {
  System.out.println("In testNoServicesQuiesce");
  Object obj=context().getService(TestBean.class);
  if (obj != null) {
    QuiesceParticipant participant=getParticipant("org.apache.aries.blueprint.core");
    if (participant != null) {
      TestQuiesceCallback callbackA=new TestQuiesceCallback();
      TestQuiesceCallback callbackB=new TestQuiesceCallback();
      Bundle bundlea=getBundle("org.apache.aries.blueprint.testbundlea");
      assertNotNull(bundlea);
      bundlea.start();
      Bundle bundleb=getBundle("org.apache.aries.blueprint.testbundleb");
      assertNotNull(bundleb);
      bundleb.start();
      Helper.getBlueprintContainerForBundle(context(),"org.apache.aries.blueprint.testbundleb");
      participant.quiesce(callbackB,Collections.singletonList(getBundle("org.apache.aries.blueprint.testbundleb")));
      System.out.println("Called Quiesce");
      Thread.sleep(200);
      Assert.assertTrue("Quiesce callback B should have occurred; calls should be 1, but it is " + callbackB.getCalls(),callbackB.getCalls() == 1);
      Assert.assertTrue("Quiesce callback A should not have occurred yet; calls should be 0, but it is " + callbackA.getCalls(),callbackA.getCalls() == 0);
      bundleb.stop();
      participant.quiesce(callbackA,Collections.singletonList(getBundle("org.apache.aries.blueprint.testbundlea")));
      Thread.sleep(1000);
      System.out.println("After second sleep");
      Assert.assertTrue("Quiesce callback A should have occurred once; calls should be 1, but it is " + callbackA.getCalls(),callbackA.getCalls() == 1);
      Assert.assertTrue("Quiesce callback B should have occurred once; calls should be 1, but it is " + callbackB.getCalls(),callbackB.getCalls() == 1);
    }
 else {
      throw new Exception("No Quiesce Participant found for the blueprint service");
    }
  }
 else {
    throw new Exception("No Service returned for " + TestBean.class);
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasicQuieseEmptyCounter() throws Exception {
  System.out.println("In testBasicQuieseEmptyCounter");
  Object obj=context().getService(TestBean.class);
  if (obj != null) {
    QuiesceParticipant participant=getParticipant("org.apache.aries.blueprint.core");
    if (participant != null) {
      System.out.println(obj.getClass().getName());
      TestQuiesceCallback callback=new TestQuiesceCallback();
      Bundle bundle=getBundle("org.apache.aries.blueprint.testquiescebundle");
      System.out.println("Got the bundle");
      List<Bundle> bundles=new ArrayList<Bundle>();
      bundles.add(bundle);
      Thread t=new Thread(new TestBeanClient((TestBean)obj,2000));
      t.start();
      System.out.println("Thread Started");
      participant.quiesce(callback,bundles);
      System.out.println("Called Quiesce");
      Thread.sleep(1000);
      Assert.assertTrue("Quiesce callback should not have occurred yet; calls should be 0, but it is " + callback.getCalls(),callback.getCalls() == 0);
      t.join();
      System.out.println("After join");
      Assert.assertTrue("Quiesce callback should have occurred once; calls should be 1, but it is " + callback.getCalls(),callback.getCalls() == 1);
    }
 else {
      throw new Exception("No Quiesce Participant found for the blueprint service");
    }
    System.out.println("done");
  }
 else {
    throw new Exception("No Service returned for " + TestBean.class);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.codec.ServiceDataTest </h4><pre class="type-4 type-12 type-5 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToCompositeData() throws Exception {
  ServiceReference<?> reference=mock(ServiceReference.class);
  Bundle bundle=mock(Bundle.class);
  String[] interfaces=new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"};
  Bundle b1=mock(Bundle.class);
  when(b1.getBundleId()).thenReturn(new Long(6));
  Bundle b2=mock(Bundle.class);
  when(b2.getBundleId()).thenReturn(new Long(9));
  when(reference.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(98));
  when(reference.getBundle()).thenReturn(bundle);
  when(bundle.getBundleId()).thenReturn(new Long(34));
  when(reference.getProperty(Constants.OBJECTCLASS)).thenReturn(interfaces);
  when(reference.getUsingBundles()).thenReturn(new Bundle[]{b1,b2});
  when(reference.getPropertyKeys()).thenReturn(new String[]{"x.vendor","x.domain","x.index","x.optimized"});
  when(reference.getProperty("x.vendor")).thenReturn("aries");
  when(reference.getProperty("x.domain")).thenReturn("test");
  when(reference.getProperty("x.index")).thenReturn(new Long(67));
  when(reference.getProperty("x.optimized")).thenReturn(true);
  ServiceData serviceData=new ServiceData(reference);
  CompositeData compositeData=serviceData.toCompositeData();
  assertEquals(new Long(98),compositeData.get(IDENTIFIER));
  assertEquals(new Long(34),compositeData.get(BUNDLE_IDENTIFIER));
  assertArrayEquals(new Long[]{new Long(6),new Long(9)},(Long[])compositeData.get(USING_BUNDLES));
  assertArrayEquals(interfaces,(String[])compositeData.get(OBJECT_CLASS));
  TabularData propertiesTable=(TabularData)compositeData.get(PROPERTIES);
  @SuppressWarnings("unchecked") Collection<CompositeData> propertyData=(Collection<CompositeData>)propertiesTable.values();
  assertEquals(4,propertyData.size());
  for (  CompositeData propertyRow : propertyData) {
    String key=(String)propertyRow.get(KEY);
    if (key.equals("x.vendor")) {
      assertEquals("aries",propertyRow.get(VALUE));
      assertEquals(STRING,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.domain")) {
      assertEquals("test",propertyRow.get(VALUE));
      assertEquals(STRING,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.index")) {
      assertEquals("67",propertyRow.get(VALUE));
      assertEquals(LONG,propertyRow.get(TYPE));
    }
 else     if (key.equals("x.optimized")) {
      assertEquals("true",propertyRow.get(VALUE));
      assertEquals(BOOLEAN,propertyRow.get(TYPE));
    }
 else {
      fail("unknown key parsed from properties");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-5 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromCompositeData() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(IDENTIFIER,new Long(99));
  items.put(BUNDLE_IDENTIFIER,new Long(5));
  items.put(USING_BUNDLES,new Long[]{new Long(10),new Long(11)});
  items.put(OBJECT_CLASS,new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"});
  TabularData propertyTable=new TabularDataSupport(JmxConstants.PROPERTIES_TYPE);
  propertyTable.put(PropertyData.newInstance("a",true).toCompositeData());
  propertyTable.put(PropertyData.newInstance("b","value").toCompositeData());
  propertyTable.put(PropertyData.newInstance("c",new int[]{1,2}).toCompositeData());
  propertyTable.put(PropertyData.newInstance("d",new Long[]{new Long(3),new Long(4)}).toCompositeData());
  items.put(ServiceStateMBean.PROPERTIES,propertyTable);
  CompositeData compositeData=new CompositeDataSupport(SERVICE_TYPE,items);
  ServiceData data=ServiceData.from(compositeData);
  assertEquals(99,data.getServiceId());
  assertEquals(5,data.getBundleId());
  assertArrayEquals(new long[]{10,11},data.getUsingBundles());
  assertArrayEquals(new String[]{"org.apache.aries.jmx.Test","org.apache.aries.jmx.Mock"},data.getServiceInterfaces());
  List<PropertyData<? extends Object>> properties=data.getProperties();
  assertEquals(4,properties.size());
  for (  PropertyData<? extends Object> property : properties) {
    if (property.getKey().equals("a")) {
      assertTrue((Boolean)property.getValue());
      assertEquals(P_BOOLEAN,property.getEncodedType());
    }
 else     if (property.getKey().equals("b")) {
      assertEquals("value",property.getValue());
      assertEquals(STRING,property.getEncodedType());
    }
 else     if (property.getKey().equals("c")) {
      assertArrayEquals(new int[]{1,2},(int[])property.getValue());
      assertEquals("Array of int",property.getEncodedType());
      assertEquals("1,2",property.getEncodedValue());
    }
 else     if (property.getKey().equals("d")) {
      assertArrayEquals(new Long[]{new Long(3),new Long(4)},(Long[])property.getValue());
      assertEquals("Array of Long",property.getEncodedType());
      assertEquals("3,4",property.getEncodedValue());
    }
 else {
      fail("unknown key parsed from properties");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.BundleStateMBeanTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"unchecked"}) public void testHeaderLocalization() throws Exception {
  Bundle bundleE=context().getBundleByName("org.apache.aries.jmx.test.bundlee");
  CompositeData cd=mbean.getBundle(bundleE.getBundleId());
  long id=(Long)cd.get(BundleStateMBean.IDENTIFIER);
  assertEquals("Description",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION));
  assertEquals("Description",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION,"en"));
  assertEquals("Omschrijving",mbean.getHeader(id,Constants.BUNDLE_DESCRIPTION,"nl"));
  TabularData td=mbean.getHeaders(id);
  boolean found=false;
  for (  CompositeData d : (Collection<CompositeData>)td.values()) {
    if (Constants.BUNDLE_DESCRIPTION.equals(d.get(BundleStateMBean.KEY))) {
      assertEquals("Description",d.get(BundleStateMBean.VALUE));
      found=true;
      break;
    }
  }
  assertTrue(found);
  TabularData tdNL=mbean.getHeaders(id,"nl");
  boolean foundNL=false;
  for (  CompositeData d : (Collection<CompositeData>)tdNL.values()) {
    if (Constants.BUNDLE_DESCRIPTION.equals(d.get(BundleStateMBean.KEY))) {
      assertEquals("Omschrijving",d.get(BundleStateMBean.VALUE));
      foundNL=true;
      break;
    }
  }
  assertTrue(foundNL);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jmx.framework.FrameworkMBeanTest </h4><pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundleAndWait() throws Exception {
  FrameworkWiring frameworkWiring=(FrameworkWiring)context().getBundle(0).adapt(FrameworkWiring.class);
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",0,frameworkWiring.getRemovalPendingBundles().size());
  assertEquals(0,framework.getRemovalPendingBundles().length);
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,bundleB.adapt(BundleWiring.class));
  assertEquals("Precondition",1,frameworkWiring.getRemovalPendingBundles().size());
  assertEquals(1,framework.getRemovalPendingBundles().length);
  assertEquals(((Bundle)frameworkWiring.getRemovalPendingBundles().iterator().next()).getBundleId(),framework.getRemovalPendingBundles()[0]);
  assertTrue(framework.refreshBundleAndWait(bundleB.getBundleId()));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundlesAndWait() throws Exception {
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,bundleB.adapt(BundleWiring.class));
  FrameworkMBean framework=getMBean(FrameworkMBean.OBJECTNAME,FrameworkMBean.class);
  CompositeData result=framework.refreshBundlesAndWait(new long[]{bundleB.getBundleId()});
  assertTrue((Boolean)result.get(FrameworkMBean.SUCCESS));
  assertTrue(Arrays.equals(new Long[]{bundleB.getBundleId()},(Long[])result.get(FrameworkMBean.COMPLETED)));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshBundlesAndWait2() throws Exception {
  Bundle bundleA=getBundleByName("org.apache.aries.jmx.test.bundlea");
  Bundle bundleB=getBundleByName("org.apache.aries.jmx.test.bundleb");
  BundleWiring bw=(BundleWiring)bundleB.adapt(BundleWiring.class);
  List<BundleWire> initialRequiredWires=bw.getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(1,initialRequiredWires.size());
  BundleWire wire=initialRequiredWires.get(0);
  Map<String,Object> capabilityAttributes=wire.getCapability().getAttributes();
  assertEquals("Precondition",bundleA.getSymbolicName(),capabilityAttributes.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
  assertEquals("Precondition",new Version("1.0"),capabilityAttributes.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
  assertEquals("Precondition","org.apache.aries.jmx.test.bundlea.api",capabilityAttributes.get(BundleRevision.PACKAGE_NAMESPACE));
  Manifest manifest=new Manifest();
  manifest.getMainAttributes().putValue("Manifest-Version","1.0");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_SYMBOLICNAME,"org.apache.aries.jmx.test.bundlea");
  manifest.getMainAttributes().putValue(Constants.BUNDLE_VERSION,"1.1");
  manifest.getMainAttributes().putValue(Constants.EXPORT_PACKAGE,"org.apache.aries.jmx.test.bundlea.api,org.apache.aries.jmx.test.bundlea.impl");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos,manifest);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/api/InterfaceA.class",jos,bundleA);
  addResourceToJar("org/apache/aries/jmx/test/bundlea/impl/A2.class",jos,bundleA);
  jos.close();
  assertEquals("Precondition",1,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  bundleA.update(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals("There should be 2 revisions now",2,((BundleRevisions)bundleA.adapt(BundleRevisions.class)).getRevisions().size());
  assertEquals("No refresh called, the bundle wiring for B should still be the old one",bw,((BundleWiring)bundleB.adapt(BundleWiring.class)));
  FrameworkMBean framework=getMBean(FrameworkMBean.OBJECTNAME,FrameworkMBean.class);
  CompositeData result=framework.refreshBundlesAndWait(null);
  Set<Long> completed=new HashSet<Long>(Arrays.asList((Long[])result.get(FrameworkMBean.COMPLETED)));
  assertTrue(completed.contains(bundleA.getBundleId()));
  assertTrue(completed.contains(bundleB.getBundleId()));
  List<BundleWire> requiredWires=((BundleWiring)bundleB.adapt(BundleWiring.class)).getRequiredWires(BundleRevision.PACKAGE_NAMESPACE);
  assertEquals(2,requiredWires.size());
  List<String> imported=new ArrayList<String>();
  for (  BundleWire w : requiredWires) {
    Map<String,Object> ca=w.getCapability().getAttributes();
    assertEquals(bundleA.getSymbolicName(),ca.get(Constants.BUNDLE_SYMBOLICNAME_ATTRIBUTE));
    imported.add(ca.get(BundleRevision.PACKAGE_NAMESPACE).toString());
    if ("org.apache.aries.jmx.test.bundlea.impl".equals(ca.get(BundleRevision.PACKAGE_NAMESPACE))) {
      assertEquals(new Version("1.1"),ca.get(Constants.BUNDLE_VERSION_ATTRIBUTE));
    }
  }
  assertEquals(Arrays.asList("org.apache.aries.jmx.test.bundlea.api","org.apache.aries.jmx.test.bundlea.impl"),imported);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.jndi.url.BlueprintURLContextTest </h4><pre class="type-4 type-15 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test BlueprintURLContext.listBindings() 
 * This returns an enumeration of component id -> component pairs
 */
@Test public void testListBindings() throws Exception {
  InitialContext ctx=new InitialContext();
  NamingEnumeration<Binding> bindings=ctx.listBindings("blueprint:comp");
  Set<String> expectedCompIds=new BlueprintContainerStub().getComponentIds();
  while (bindings.hasMore()) {
    Binding b=bindings.next();
    String compId=b.getName();
    Object component=b.getObject();
    if (compId.equals("comp1")) {
      SimpleComponent sc=(SimpleComponent)component;
      assertEquals("comp1 message wrong","comp1_message",sc.getIdMessage());
    }
 else     if (compId.equals("comp2")) {
      AnotherComponent ac=(AnotherComponent)component;
      assertEquals("comp2 message wrong","AnotherComponent with id comp2",ac.getIdMessage());
    }
    expectedCompIds.remove(compId);
  }
  assertEquals("Not all expected components were found",expectedCompIds.size(),0);
}

</code></pre>

<br>
<pre class="type-4 type-15 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Validate that list() function works for BlueprintURLContext. 
 * This returns an enumeration of component id -> component class name pairs
 */
@Test public void testList() throws Exception {
  InitialContext ctx=new InitialContext();
  NamingEnumeration<NameClassPair> compList=ctx.list("blueprint:comp");
  Set<String> expectedCompIds=new BlueprintContainerStub().getComponentIds();
  while (compList.hasMore()) {
    NameClassPair ncp=compList.next();
    String compId=ncp.getName();
    String compClass=ncp.getClassName();
    if (compId.equals("comp1")) {
      assertEquals("comp1 class wrong in list",SimpleComponent.class.getName(),compClass);
    }
 else     if (compId.equals("comp2")) {
      assertEquals("comp2 class wrong in list",AnotherComponent.class.getName(),compClass);
    }
    expectedCompIds.remove(compId);
  }
  assertEquals("Not all expected components were found",expectedCompIds.size(),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.proxy.itests.AbstractWeavingProxyTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * This method checks that we correctly proxy a class with final methods.
 */
@Test public void checkProxyFinalMethods() throws Exception {
  Bundle b=bundleContext.getBundle();
  Callable c=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  Runnable r=new Runnable(){
    public final void run(){
    }
  }
;
  classes.add(r.getClass());
  Object o=mgr.createDelegatingProxy(b,classes,c,r);
  if (!!!(o instanceof WovenProxy))   fail("Proxy should be woven!");
}

</code></pre>

<br>
<pre class="type-12 type-5 type-10 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FinalModifierException.class) public void checkProxyController() throws Exception {
  context().registerService(ProxyWeavingController.class.getName(),new ProxyWeavingController(){
    public boolean shouldWeave(    WovenClass arg0,    WeavingHelper arg1){
      return false;
    }
  }
,null);
  Bundle b=bundleContext.getBundle();
  Callable c=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  Callable<?> callable=new TestFinalDelegate();
  classes.add(callable.getClass());
  Object o=mgr.createDelegatingProxy(b,classes,c,callable);
  if (o instanceof WovenProxy)   fail("Proxy should not have been woven!");
}

</code></pre>

<br>
<pre class="type-4 type-12 type-5 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test does two things. First of all it checks that we can proxy a final 
 * class. It also validates that the class implements WovenProxy, and that the
 * delegation still works
 */
@Test public void checkProxyFinalClass() throws Exception {
  Bundle b=bundleContext.getBundle();
  TestCallable dispatcher=new TestCallable();
  TestCallable template=new TestCallable();
  Collection<Class<?>> classes=new ArrayList<Class<?>>();
  classes.add(TestCallable.class);
  @SuppressWarnings("unchecked") Callable o=(Callable)mgr.createDelegatingProxy(b,classes,dispatcher,template);
  if (!!!(o instanceof WovenProxy))   fail("Proxy should be woven!");
  Object inner=new Integer(3);
  dispatcher.setReturn(new TestCallable());
  ((TestCallable)dispatcher.call()).setReturn(inner);
  assertSame("Should return the same object",inner,o.call());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.spifly.ProviderBundleTrackerCustomizerGenericCapabilityTest </h4><pre class="type-4 type-12 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProvidedSPIDirective() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  BundleContext implBC=mockSPIBundleContext4();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI; approval=yeah, "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI2");
  Bundle implBundle=mockSPIBundle4(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals("Expected 3 registrations, one for MySPI and 2 for MySPI2",3,registrations.size());
  Set<String> expectedObjectClasses=new HashSet<String>(Arrays.asList("org.apache.aries.mytest.MySPI","org.apache.aries.mytest.MySPI2"));
  Set<String> actualObjectClasses=new HashSet<String>();
  boolean foundMySPI=false;
  boolean foundMySPI2=false;
  for (  ServiceRegistration sr : registrations) {
    List<String> objectClasses=Arrays.asList((String[])sr.getReference().getProperty(Constants.OBJECTCLASS));
    actualObjectClasses.addAll(objectClasses);
    assertNotNull(sr.getReference().getProperty(SpiFlyConstants.SERVICELOADER_MEDIATOR_PROPERTY));
    if (objectClasses.contains("org.apache.aries.mytest.MySPI")) {
      assertEquals("yeah",sr.getReference().getProperty("approval"));
      foundMySPI=true;
    }
 else     if (objectClasses.contains("org.apache.aries.mytest.MySPI2")) {
      assertNull(sr.getReference().getProperty("approval"));
      foundMySPI2=true;
    }
  }
  assertTrue(foundMySPI);
  assertTrue(foundMySPI2);
  assertEquals(expectedObjectClasses,actualObjectClasses);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleServiceInstancesAndTypes() throws Exception {
  Bundle mediatorBundle=EasyMock.createMock(Bundle.class);
  EasyMock.expect(mediatorBundle.getBundleId()).andReturn(42l).anyTimes();
  EasyMock.replay(mediatorBundle);
  BaseActivator activator=new BaseActivator(){
    @Override public void start(    BundleContext context) throws Exception {
    }
  }
;
  ProviderBundleTrackerCustomizer customizer=new ProviderBundleTrackerCustomizer(activator,mediatorBundle);
  BundleContext implBC=mockSPIBundleContext4();
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(SpiFlyConstants.REQUIRE_CAPABILITY,SpiFlyConstants.PROVIDER_REQUIREMENT);
  headers.put(SpiFlyConstants.PROVIDE_CAPABILITY,SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE + "; " + SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI,"+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "; "+ SpiFlyConstants.SERVICELOADER_CAPABILITY_NAMESPACE+ "=org.apache.aries.mytest.MySPI2");
  Bundle implBundle=mockSPIBundle4(implBC,headers);
  List<ServiceRegistration> registrations=customizer.addingBundle(implBundle,null);
  assertEquals(3,registrations.size());
  boolean foundA=false, foundB=false, foundC=false;
  for (  ServiceRegistration sreg : registrations) {
    ServiceReference sref=sreg.getReference();
    String objectClassName=((String[])sref.getProperty(Constants.OBJECTCLASS))[0];
    String serviceImplClassName=(String)sref.getProperty(SpiFlyConstants.PROVIDER_IMPLCLASS_PROPERTY);
    if (MySPIImpl4a.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI",objectClassName);
      MySPI svc=(MySPI)implBC.getService(sreg.getReference());
      assertEquals("impl4a",svc.someMethod(""));
      foundA=true;
    }
 else     if (MySPIImpl4b.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI2",objectClassName);
      MySPI2 svc=(MySPI2)implBC.getService(sreg.getReference());
      assertEquals("impl4b",svc.someMethod(""));
      foundB=true;
    }
 else     if (MySPIImpl4c.class.getName().equals(serviceImplClassName)) {
      assertEquals("org.apache.aries.mytest.MySPI2",objectClassName);
      MySPI2 svc=(MySPI2)implBC.getService(sreg.getReference());
      assertEquals("impl4c",svc.someMethod(""));
      foundC=true;
    }
  }
  assertTrue(foundA);
  assertTrue(foundB);
  assertTrue(foundC);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.CustomContentHandlerTest </h4><pre class="type-12 type-5 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomContentInstallationException() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleB".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler(true,"install");
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  assertEquals("Precondition",0,handler.calls.size());
  try {
    installSubsystemFromFile("customContent1.esa");
  }
 catch (  Exception ex) {
  }
  try {
    for (    Bundle b : bundleContext.getBundles()) {
      if ("org.apache.aries.subsystem.itests.customcontent.bundleB".equals(b.getSymbolicName())) {
        fail("Should not have installed the bundle");
      }
    }
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("This test exposes a problem that needs to be fixed, namely that the previous test leaves stuff behind and that " + "customContent1.esa cannot be installed again. Currently ignored until someone finds the time to fix it.") public void testCustomContentInstallationSecondTime() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleB".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler();
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  try {
    Subsystem subsystem=installSubsystemFromFile("customContent1.esa");
    subsystem.uninstall();
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("This test currently doesn't pass, the bundle moves to the active state, while it shouldn't") public void testCustomContentStartException() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleC".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler(true,"start");
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  assertEquals("Precondition",0,handler.calls.size());
  Subsystem subsystem=installSubsystemFromFile("customContent2.esa");
  try {
    assertEquals(Arrays.asList("install:customContent3 sausages = 3"),handler.calls);
    try {
      Bundle theBundle=null;
      for (      Bundle b : bundleContext.getBundles()) {
        if ("org.apache.aries.subsystem.itests.customcontent.bundleC".equals(b.getSymbolicName())) {
          assertEquals(Bundle.INSTALLED,b.getState());
          theBundle=b;
        }
      }
      assertNotNull(theBundle);
      try {
        subsystem.start();
      }
 catch (      Exception ex) {
      }
      assertEquals("There was an exception during start, so the bundle should not be started",Bundle.INSTALLED,theBundle.getState());
    }
  finally {
      subsystem.uninstall();
    }
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomContentInstallationCoordinationFails() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleC".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler(false,"install");
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  assertEquals("Precondition",0,handler.calls.size());
  try {
    installSubsystemFromFile("customContent2.esa");
  }
 catch (  Exception ex) {
  }
  try {
    for (    Bundle b : bundleContext.getBundles()) {
      if ("org.apache.aries.subsystem.itests.customcontent.bundleC".equals(b.getSymbolicName())) {
        fail("Should not have installed the bundle");
      }
    }
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("This test currently doesn't pass, the bundle moves to the active state, while it shouldn't") public void testCustomContentStartFailCoordination() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleD".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler(false,"start");
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  assertEquals("Precondition",0,handler.calls.size());
  Subsystem subsystem=installSubsystemFromFile("customContent3.esa");
  try {
    assertEquals(Arrays.asList("install:customContent4 sausages = 4"),handler.calls);
    try {
      Bundle theBundle=null;
      for (      Bundle b : bundleContext.getBundles()) {
        if ("org.apache.aries.subsystem.itests.customcontent.bundleD".equals(b.getSymbolicName())) {
          assertEquals(Bundle.INSTALLED,b.getState());
          theBundle=b;
        }
      }
      assertNotNull(theBundle);
      try {
        subsystem.start();
      }
 catch (      Exception ex) {
      }
      assertEquals("The coordination failued during start, so the bundle should not be started",Bundle.INSTALLED,theBundle.getState());
    }
  finally {
      subsystem.uninstall();
    }
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomContentHandler() throws Exception {
  for (  Bundle b : bundleContext.getBundles()) {
    if ("org.apache.aries.subsystem.itests.customcontent.bundleA".equals(b.getSymbolicName())) {
      fail("Precondition");
    }
  }
  SausagesContentHandler handler=new SausagesContentHandler();
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(ContentHandler.CONTENT_TYPE_PROPERTY,"foo.sausages");
  ServiceRegistration<ContentHandler> reg=bundleContext.registerService(ContentHandler.class,handler,props);
  try {
    assertEquals("Precondition",0,handler.calls.size());
    Subsystem subsystem=installSubsystemFromFile("customContent.esa");
    try {
      assertEquals(Arrays.asList("install:customContent1 sausages = 1"),handler.calls);
      Collection<Resource> constituents=subsystem.getConstituents();
      assertEquals("The custom content should not show up as a subsystem constituent",1,constituents.size());
      boolean foundBundle=false;
      for (      Bundle b : bundleContext.getBundles()) {
        if ("org.apache.aries.subsystem.itests.customcontent.bundleA".equals(b.getSymbolicName())) {
          foundBundle=true;
        }
      }
      assertTrue(foundBundle);
      boolean foundBundleInConstituents=false;
      for (      Resource c : constituents) {
        for (        Capability idCap : c.getCapabilities(IdentityNamespace.IDENTITY_NAMESPACE)) {
          Object name=idCap.getAttributes().get(IdentityNamespace.IDENTITY_NAMESPACE);
          if ("org.apache.aries.subsystem.itests.customcontent.bundleA".equals(name))           foundBundleInConstituents=true;
        }
      }
      assertTrue(foundBundleInConstituents);
      handler.calls.clear();
      assertEquals(Subsystem.State.INSTALLED,subsystem.getState());
      subsystem.start();
      assertEquals(Arrays.asList("start:customContent1"),handler.calls);
      handler.calls.clear();
      assertEquals(Subsystem.State.ACTIVE,subsystem.getState());
      subsystem.stop();
      assertEquals(Arrays.asList("stop:customContent1"),handler.calls);
      assertEquals(Subsystem.State.RESOLVED,subsystem.getState());
    }
  finally {
      handler.calls.clear();
      subsystem.uninstall();
      assertEquals(Arrays.asList("uninstall:customContent1"),handler.calls);
      assertEquals(Subsystem.State.UNINSTALLED,subsystem.getState());
    }
  }
  finally {
    reg.unregister();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.itests.defect.Aries1425Test </h4><pre class="type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeployedContentHeader() throws Exception {
  Subsystem applicationA=installSubsystemFromFile(APPLICATION_A);
  try {
    Map<String,String> headers=applicationA.getDeploymentHeaders();
    String header=headers.get(SubsystemConstants.DEPLOYED_CONTENT);
    DeployedContentHeader dch=new DeployedContentHeader(header);
    boolean foundClause=false;
    for (    DeployedContentHeader.Clause clause : dch.getClauses()) {
      if (BUNDLE_A.equals(clause.getSymbolicName())) {
        assertEquals("Wrong type",IdentityNamespace.TYPE_FRAGMENT,clause.getType());
        foundClause=true;
        break;
      }
    }
    assertTrue("Missing clause",foundClause);
  }
  finally {
    uninstallSubsystemSilently(applicationA);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.ScopeAdminTest </h4><pre class="type-4 type-12 type-5 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleServiceIsolation() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  bt=new BundleTracker(bundleContext,Bundle.INSTALLED | Bundle.UNINSTALLED | Bundle.ACTIVE,new BundleTrackerCustomizer(){
    public synchronized Object addingBundle(    Bundle bundle,    BundleEvent event){
      if (event == null) {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        addEventCount++;
      }
      return bundle;
    }
    public synchronized void modifiedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        modifyEventCount++;
      }
    }
    public synchronized void removedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        removeEventCount++;
      }
    }
  }
);
  bt.open();
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  try {
    ServiceReference sr=bundleContext.getServiceReference(HelloIsolation.class.getName());
    fail("should not be able to get the sr for HelloIsolation service");
  }
 catch (  Exception ex) {
  }
catch (  Error er) {
  }
  Bundle[] bundles=bundleContext.getBundles();
  for (  Bundle b : bundles) {
    System.out.println("Bundle is " + b.getBundleId() + ": "+ b.getSymbolicName());
    if (b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1) {
      fail("bundles with name starts with org.apache.aries.subsystem.example.helloIsolation should be in a different scope");
    }
  }
  Collection<Scope> children=scope.getChildren();
  assertEquals(1,children.size());
  for (  Scope child : children) {
    if (child.getName().equals("scope_test1")) {
      Collection<Bundle> buns=child.getBundles();
      assertEquals(2,buns.size());
      assertEquals(0,child.getChildren().size());
      for (      Bundle b : buns) {
        assertTrue(b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1);
      }
    }
  }
  URL url=new URL("mvn:org.apache.felix/org.apache.felix.fileinstall/2.0.8");
  bundleContext.installBundle("org.apache.felix.fileinstall-rootScope",url.openStream());
  assertEquals("add event count should be 1 since 1 bundles are installed",1,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.filesystem.IOUtilsTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCopyAndDoNotClose() throws IOException {
  InputStream is=new InputStream(){
    int idx=0;
    int data[]=new int[]{1,2,3,4,5,-1};
    @Override public int read() throws IOException {
      if (idx < data.length)       return data[idx++];
 else       return -1;
    }
    @Override public void close() throws IOException {
      fail("Close invoked");
    }
  }
;
  OutputStream os=new OutputStream(){
    int idx=0;
    int data[]=new int[]{1,2,3,4,5,-1};
    @Override public void write(    int b) throws IOException {
      if (b != data[idx++]) {
        fail("Data written to outputstream was not as expected");
      }
    }
  }
;
  IOUtils.copyAndDoNotCloseInputStream(is,os);
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCopy() throws IOException {
  InputStream is=new InputStream(){
    boolean closed=false;
    int idx=0;
    int data[]=new int[]{1,2,3,4,5,-1};
    @Override public int read() throws IOException {
      if (idx < data.length)       return data[idx++];
 else       return -1;
    }
    @Override public void close() throws IOException {
      closed=true;
    }
    @Override public int available() throws IOException {
      if (!closed)       return super.available();
 else       return 123456789;
    }
  }
;
  OutputStream os=new OutputStream(){
    int idx=0;
    int data[]=new int[]{1,2,3,4,5,-1};
    @Override public void write(    int b) throws IOException {
      if (b != data[idx++]) {
        fail("Data written to outputstream was not as expected");
      }
    }
  }
;
  IOUtils.copy(is,os);
  if (is.available() != 123456789) {
    fail("close was not invoked");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.aries.util.manifest.ManifestHeaderProcessorTest </h4><pre class="type-4 type-12 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseExportString(){
  String exportPackage="com.acme.foo,com.acme.bar;version=1,com.acme.bar;version=2;uses:=\"a.b.c,d.e.f\";security=false;mandatory:=security";
  List<NameValuePair> exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int i=0;
  assertEquals("The number of the packages is wrong.",3,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      i++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("2".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertEquals("The directive is wrong.","a.b.c,d.e.f",nvp.getAttributes().get("uses:"));
      assertEquals("The directive is wrong.","false",nvp.getAttributes().get("security"));
      assertEquals("The directive is wrong.","security",nvp.getAttributes().get("mandatory:"));
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("1".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertNull("The directive is wrong.",nvp.getAttributes().get("uses:"));
      assertNull("The directive is wrong.",nvp.getAttributes().get("security"));
      assertNull("The directive is wrong.",nvp.getAttributes().get("mandatory:"));
    }
  }
  assertEquals("The names of the packages are wrong.",3,i);
  exportPackage="com.acme.foo";
  exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int k=0;
  assertEquals("The number of the packages is wrong.",1,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      k++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
  }
  assertEquals("The names of the packages are wrong.",1,k);
  exportPackage="com.acme.foo;com.acme.bar;version=\"2\";resolution:=optional";
  exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  k=0;
  assertEquals("The number of the packages is wrong.",2,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      k++;
      assertEquals("The attribute is wrong.","2",nvp.getAttributes().get("version"));
      assertEquals("The attribute is wrong.","optional",nvp.getAttributes().get("resolution:"));
    }
 else     if (nvp.getName().equals("com.acme.bar")) {
      k++;
      assertEquals("The attribute is wrong.","2",nvp.getAttributes().get("version"));
      assertEquals("The attribute is wrong.","optional",nvp.getAttributes().get("resolution:"));
    }
  }
  assertEquals("The names of the packages are wrong.",2,k);
  exportPackageReturn=ManifestHeaderProcessor.parseExportString("some.export.with.space.in;directive := spacey");
  assertEquals(exportPackageReturn.toString(),"spacey",exportPackageReturn.get(0).getAttributes().get("directive:"));
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExportMandatoryAttributes(){
  String exportPackage="com.acme.foo,com.acme.bar;version=2;company=dodo;security=false;mandatory:=\"security,company\"";
  List<NameValuePair> exportPackageReturn=ManifestHeaderProcessor.parseExportString(exportPackage);
  int i=0;
  assertEquals("The number of the packages is wrong.",2,exportPackageReturn.size());
  for (  NameValuePair nvp : exportPackageReturn) {
    if (nvp.getName().equals("com.acme.foo")) {
      i++;
      assertTrue("The directive or attribute should not be set.",nvp.getAttributes().isEmpty());
    }
 else     if ((nvp.getName().equals("com.acme.bar")) && ("2".equals(nvp.getAttributes().get("version")))) {
      i++;
      assertEquals("The directive is wrong.","dodo",nvp.getAttributes().get("company"));
      assertEquals("The directive is wrong.","false",nvp.getAttributes().get("security"));
      assertEquals("The directive is wrong.","security,company",nvp.getAttributes().get("mandatory:"));
    }
  }
  assertEquals("The names of the packages are wrong.",2,i);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
