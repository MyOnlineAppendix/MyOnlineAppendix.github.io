<h3 style="margin:0px">Class: org.apache.aries.subsystem.scope.itests.ScopeAdminTest (6 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(3)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void tearDown() throws Exception {
  if (bt != null) {
    bt.close();
  }
}

</code></pre>

<pre class="type-4 type-12 type-5 type-3 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBundleServiceIsolation() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  bt=new BundleTracker(bundleContext,Bundle.INSTALLED | Bundle.UNINSTALLED | Bundle.ACTIVE,new BundleTrackerCustomizer(){
    public synchronized Object addingBundle(    Bundle bundle,    BundleEvent event){
      if (event == null) {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - adding Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        addEventCount++;
      }
      return bundle;
    }
    public synchronized void modifiedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - modifying Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        modifyEventCount++;
      }
    }
    public synchronized void removedBundle(    Bundle bundle,    BundleEvent event,    Object object){
      if (event == null) {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: null");
      }
 else {
        System.out.println("ScopeAdminTest - removing Bundle: " + bundle.getSymbolicName() + " event: "+ event.getType());
        removeEventCount++;
      }
    }
  }
);
  bt.open();
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  assertEquals("add event count should be 0 since 0 bundles are installed in root scope",0,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  try {
    ServiceReference sr=bundleContext.getServiceReference(HelloIsolation.class.getName());
    fail("should not be able to get the sr for HelloIsolation service");
  }
 catch (  Exception ex) {
  }
catch (  Error er) {
  }
  Bundle[] bundles=bundleContext.getBundles();
  for (  Bundle b : bundles) {
    System.out.println("Bundle is " + b.getBundleId() + ": "+ b.getSymbolicName());
    if (b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1) {
      fail("bundles with name starts with org.apache.aries.subsystem.example.helloIsolation should be in a different scope");
    }
  }
  Collection<Scope> children=scope.getChildren();
  assertEquals(1,children.size());
  for (  Scope child : children) {
    if (child.getName().equals("scope_test1")) {
      Collection<Bundle> buns=child.getBundles();
      assertEquals(2,buns.size());
      assertEquals(0,child.getChildren().size());
      for (      Bundle b : buns) {
        assertTrue(b.getSymbolicName().indexOf("org.apache.aries.subsystem.example.helloIsolation") > -1);
      }
    }
  }
  URL url=new URL("mvn:org.apache.felix/org.apache.felix.fileinstall/2.0.8");
  bundleContext.installBundle("org.apache.felix.fileinstall-rootScope",url.openStream());
  assertEquals("add event count should be 1 since 1 bundles are installed",1,addEventCount);
  assertEquals("modify event count should be 0",0,modifyEventCount);
  assertEquals("remove event count should be 0",0,removeEventCount);
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<pre class="type-4 type-5 type-3 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testPackageSharingFromTestScope() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  Map<String,List<SharePolicy>> sharePolicies=childScopeUpdate.getSharePolicies(SharePolicy.TYPE_EXPORT);
  final Filter filter1=FrameworkUtil.createFilter("(&" + "(osgi.wiring.package=org.apache.aries.subsystem.example.helloIsolation)" + ")");
  final Filter filter2=FrameworkUtil.createFilter("(&" + "(scope.share.service=org.apache.aries.subsystem.example.helloIsolation.HelloIsolation)" + ")");
  List<SharePolicy> packagePolicies=sharePolicies.get(BundleRevision.PACKAGE_NAMESPACE);
  if (packagePolicies == null) {
    packagePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put(BundleRevision.PACKAGE_NAMESPACE,packagePolicies);
  }
  packagePolicies.add(new SharePolicy(SharePolicy.TYPE_EXPORT,BundleRevision.PACKAGE_NAMESPACE,filter1));
  List<SharePolicy> servicePolicies=sharePolicies.get("scope.share.service");
  if (servicePolicies == null) {
    servicePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put("scope.share.service",servicePolicies);
  }
  servicePolicies.add(new SharePolicy(SharePolicy.TYPE_EXPORT,"scope.share.service",filter2));
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT");
  Bundle helloIsolationRef=bundleContext.installBundle("helloIsolationRef1-rootScope",url1.openStream());
  try {
    helloIsolationRef.start();
  }
 catch (  Exception ex) {
    fail("should be able to start helloIsolationRef by import packages from scope_test1");
  }
  helloIsolationRef.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<pre class="type-4 type-5 type-3 type-7 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPackageSharingFromRootScope() throws Exception {
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT");
  Bundle helloIsolation=bundleContext.installBundle("helloIsolation1-rootScope",url1.openStream());
  try {
    helloIsolation.start();
  }
 catch (  Exception ex) {
    fail("should be able to start helloIsolation");
  }
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  Map<String,List<SharePolicy>> sharePolicies=childScopeUpdate.getSharePolicies(SharePolicy.TYPE_IMPORT);
  final Filter filter1=FrameworkUtil.createFilter("(&" + "(osgi.wiring.package=org.apache.aries.subsystem.example.helloIsolation)" + ")");
  final Filter filter2=FrameworkUtil.createFilter("(&" + "(scope.share.service=org.apache.aries.subsystem.example.helloIsolation.HelloIsolation)" + ")");
  List<SharePolicy> packagePolicies=sharePolicies.get(BundleRevision.PACKAGE_NAMESPACE);
  if (packagePolicies == null) {
    packagePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put(BundleRevision.PACKAGE_NAMESPACE,packagePolicies);
  }
  packagePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,BundleRevision.PACKAGE_NAMESPACE,filter1));
  List<SharePolicy> servicePolicies=sharePolicies.get("scope.share.service");
  if (servicePolicies == null) {
    servicePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put("scope.share.service",servicePolicies);
  }
  servicePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,"scope.share.service",filter2));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    try {
      b.start();
    }
 catch (    Exception ex) {
      ex.printStackTrace();
      fail("should be able to start helloIsolationRef in scope_test1");
    }
  }
  helloIsolation.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<pre class="type-5 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testScopeAffinity() throws Exception {
  Scope scope1=createScope(scope,"scope_test1","mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT","0.3");
  Scope scope2=createScope(scope,"scope_test2","mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT","2.0");
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test3");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  Scope scope3=childScopeUpdate.getScope();
  Map<String,List<SharePolicy>> sharePolicies=childScopeUpdate.getSharePolicies(SharePolicy.TYPE_IMPORT);
  final Filter filter1=FrameworkUtil.createFilter("(&" + "(osgi.wiring.package=org.apache.aries.subsystem.example.helloIsolation)" + ")");
  final Filter filter2=FrameworkUtil.createFilter("(&" + "(scope.share.service=org.apache.aries.subsystem.example.helloIsolation.HelloIsolation)" + ")");
  List<SharePolicy> packagePolicies=sharePolicies.get(BundleRevision.PACKAGE_NAMESPACE);
  if (packagePolicies == null) {
    packagePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put(BundleRevision.PACKAGE_NAMESPACE,packagePolicies);
  }
  packagePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,BundleRevision.PACKAGE_NAMESPACE,filter1));
  List<SharePolicy> servicePolicies=sharePolicies.get("scope.share.service");
  if (servicePolicies == null) {
    servicePolicies=new ArrayList<SharePolicy>();
    sharePolicies.put("scope.share.service",servicePolicies);
  }
  servicePolicies.add(new SharePolicy(SharePolicy.TYPE_IMPORT,"scope.share.service",filter2));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    try {
      b.start();
    }
 catch (    Exception ex) {
      ex.printStackTrace();
      fail("should be able to start helloIsolationRef in scope_test1");
    }
  }
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  scopes.clear();
  su.commit();
  assertTrue(scope.getChildren().isEmpty());
  assertTrue(scope.newScopeUpdate().getChildren().isEmpty());
}

</code></pre>

<pre class="type-4 type-5 type-3 type-7 type-1 type-8 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void testPackageIsolation() throws Exception {
  assertNotNull("scope admin should not be null",scope);
  System.out.println("able to get scope admin service");
  ScopeUpdate su=scope.newScopeUpdate();
  ScopeUpdate childScopeUpdate=su.newChild("scope_test1");
  su.getChildren().add(childScopeUpdate);
  addPackageImportPolicy("org.osgi.framework",childScopeUpdate);
  addPackageImportPolicy("org.osgi.util.tracker",childScopeUpdate);
  InstallInfo info1=new InstallInfo("helloIsolation",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT"));
  InstallInfo info2=new InstallInfo("helloIsolationRef",new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT"));
  List<InstallInfo> bundlesToInstall=childScopeUpdate.getBundlesToInstall();
  bundlesToInstall.add(info1);
  bundlesToInstall.add(info2);
  su.commit();
  Collection<Bundle> bundlesToStart=childScopeUpdate.getScope().getBundles();
  for (  Bundle b : bundlesToStart) {
    b.start();
  }
  URL url1=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolationRef/0.1-SNAPSHOT");
  Bundle helloIsolationRef=bundleContext.installBundle("helloIsolationRef1-rootScope",url1.openStream());
  try {
    helloIsolationRef.start();
    fail("should not be able to start helloIsolationRef since missing import packages");
  }
 catch (  Exception ex) {
  }
  URL url2=new URL("mvn:org.apache.aries.subsystem/org.apache.aries.subsystem.example.helloIsolation/0.1-SNAPSHOT");
  Bundle helloIsolation=bundleContext.installBundle("helloIsolation1-rootScope",url2.openStream());
  helloIsolation.start();
  helloIsolationRef.start();
  helloIsolationRef.uninstall();
  helloIsolation.uninstall();
  su=scope.newScopeUpdate();
  Collection<ScopeUpdate> scopes=su.getChildren();
  childScopeUpdate=scopes.iterator().next();
  Scope childScopeAdmin=childScopeUpdate.getScope();
  assertEquals(scope,childScopeAdmin.getParent());
  scopes.remove(childScopeUpdate);
  su.commit();
  assertFalse(scope.getChildren().contains(childScopeAdmin));
  su=scope.newScopeUpdate();
  assertFalse(su.getChildren().contains(childScopeUpdate));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
