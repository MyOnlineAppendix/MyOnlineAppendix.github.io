<h3 style="margin:0px">Class: org.apache.aries.jmx.codec.BundleDataTest (4 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHeaderToCompositeData() throws Exception {
  Header h1=new Header("a","b");
  CompositeData compositeData=h1.toCompositeData();
  assertEquals("a",compositeData.get(KEY));
  assertEquals("b",compositeData.get(VALUE));
}

</code></pre>

<pre class="type-4 type-7 type-1 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToCompositeData() throws Exception {
  Bundle bundle=mock(Bundle.class);
  BundleContext context=mock(BundleContext.class);
  PackageAdmin packageAdmin=mock(PackageAdmin.class);
  StartLevel startLevel=mock(StartLevel.class);
  Bundle b1=mock(Bundle.class);
  when(b1.getSymbolicName()).thenReturn("b1");
  when(b1.getBundleId()).thenReturn(new Long(44));
  Bundle b2=mock(Bundle.class);
  when(b2.getSymbolicName()).thenReturn("b2");
  when(b2.getBundleId()).thenReturn(new Long(55));
  Bundle b3=mock(Bundle.class);
  when(b3.getSymbolicName()).thenReturn("b3");
  when(b3.getBundleId()).thenReturn(new Long(66));
  when(context.getBundles()).thenReturn(new Bundle[]{bundle,b1,b2,b3});
  when(bundle.getSymbolicName()).thenReturn("test");
  when(bundle.getVersion()).thenReturn(Version.emptyVersion);
  when(bundle.getBundleId()).thenReturn(new Long(1));
  when(bundle.getLastModified()).thenReturn(new Long(12345));
  when(bundle.getLocation()).thenReturn("location");
  Dictionary<String,String> headers=new Hashtable<String,String>();
  headers.put(Constants.BUNDLE_SYMBOLICNAME,"test");
  headers.put(Constants.BUNDLE_VERSION,"0.0.0");
  when(bundle.getHeaders()).thenReturn(headers);
  ExportedPackage exported=mock(ExportedPackage.class);
  when(exported.getName()).thenReturn("org.apache.aries.jmx");
  when(exported.getVersion()).thenReturn(new Version("1.0.0"));
  when(exported.getExportingBundle()).thenReturn(bundle);
  when(packageAdmin.getExportedPackages(bundle)).thenReturn(new ExportedPackage[]{exported});
  ExportedPackage ep1=mock(ExportedPackage.class);
  when(ep1.getImportingBundles()).thenReturn(new Bundle[]{bundle,b2,b3});
  when(ep1.getName()).thenReturn("org.apache.aries.jmx.b1");
  when(ep1.getVersion()).thenReturn(Version.emptyVersion);
  when(ep1.getExportingBundle()).thenReturn(b1);
  ExportedPackage ep2=mock(ExportedPackage.class);
  when(ep2.getImportingBundles()).thenReturn(new Bundle[]{bundle,b3});
  when(ep2.getName()).thenReturn("org.apache.aries.jmx.b2");
  when(ep2.getVersion()).thenReturn(Version.parseVersion("2.0.1"));
  when(ep2.getExportingBundle()).thenReturn(b2);
  headers.put(Constants.DYNAMICIMPORT_PACKAGE,"*");
  when(packageAdmin.getExportedPackages(b1)).thenReturn(new ExportedPackage[]{ep1});
  when(packageAdmin.getExportedPackages(b2)).thenReturn(new ExportedPackage[]{ep2});
  when(packageAdmin.getExportedPackages(b3)).thenReturn(null);
  RequiredBundle rb1=mock(RequiredBundle.class);
  when(rb1.getBundle()).thenReturn(b1);
  when(rb1.getRequiringBundles()).thenReturn(new Bundle[]{bundle,b2});
  RequiredBundle rb2=mock(RequiredBundle.class);
  when(rb2.getBundle()).thenReturn(b2);
  when(rb2.getRequiringBundles()).thenReturn(new Bundle[]{b1});
  RequiredBundle rb3=mock(RequiredBundle.class);
  when(rb3.getBundle()).thenReturn(b3);
  when(rb3.getRequiringBundles()).thenReturn(new Bundle[]{bundle,b1,b2});
  headers.put(Constants.REQUIRE_BUNDLE,"b1;bundle-version=\"1.0.0\",b3;bundle-version=\"2.0.0\"");
  when(packageAdmin.getRequiredBundles("b1")).thenReturn(new RequiredBundle[]{rb1});
  when(packageAdmin.getRequiredBundles("b2")).thenReturn(new RequiredBundle[]{rb2});
  when(packageAdmin.getRequiredBundles("b3")).thenReturn(new RequiredBundle[]{rb3});
  ServiceReference s1=mock(ServiceReference.class);
  when(s1.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(15));
  ServiceReference s2=mock(ServiceReference.class);
  when(s2.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(16));
  ServiceReference s3=mock(ServiceReference.class);
  when(s3.getProperty(Constants.SERVICE_ID)).thenReturn(new Long(17));
  when(bundle.getServicesInUse()).thenReturn(new ServiceReference[]{s1,s2,s3});
  BundleData b=new BundleData(context,bundle,packageAdmin,startLevel);
  CompositeData compositeData=b.toCompositeData();
  assertEquals("test",compositeData.get(SYMBOLIC_NAME));
  assertEquals("0.0.0",compositeData.get(VERSION));
  TabularData headerTable=(TabularData)compositeData.get(HEADERS);
  assertEquals(4,headerTable.values().size());
  CompositeData header=headerTable.get(new Object[]{Constants.BUNDLE_SYMBOLICNAME});
  assertNotNull(header);
  String value=(String)header.get(VALUE);
  assertEquals("test",value);
  String key=(String)header.get(KEY);
  assertEquals(Constants.BUNDLE_SYMBOLICNAME,key);
  TabularData bundleTable=new TabularDataSupport(BUNDLES_TYPE);
  bundleTable.put(b.toCompositeData());
  CompositeData bundleData=bundleTable.get(new Object[]{Long.valueOf(1)});
  assertNotNull(bundleData);
  String location=(String)bundleData.get(LOCATION);
  assertEquals("location",location);
  assertArrayEquals(new String[]{"org.apache.aries.jmx;1.0.0"},(String[])compositeData.get(EXPORTED_PACKAGES));
  assertArrayEquals(new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"},(String[])compositeData.get(IMPORTED_PACKAGES));
  assertEquals(toSet(new long[]{44,55,66}),toSet((Long[])compositeData.get(REQUIRED_BUNDLES)));
  assertArrayEquals(new Long[]{new Long(15),new Long(16),new Long(17)},(Long[])compositeData.get(SERVICES_IN_USE));
  assertEquals("UNKNOWN",compositeData.get(STATE));
  assertEquals(0,((Long[])compositeData.get(HOSTS)).length);
  assertEquals(0,((Long[])compositeData.get(FRAGMENTS)).length);
}

</code></pre>

<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHeaderFromCompositeData() throws Exception {
  CompositeData compositeData=new CompositeDataSupport(HEADER_TYPE,new String[]{KEY,VALUE},new String[]{"c","d"});
  Header header=Header.from(compositeData);
  assertEquals("c",header.getKey());
  assertEquals("d",header.getValue());
}

</code></pre>

<pre class="type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromCompositeData() throws Exception {
  Map<String,Object> items=new HashMap<String,Object>();
  items.put(EXPORTED_PACKAGES,new String[]{"org.apache.aries.jmx;1.0.0"});
  items.put(FRAGMENT,false);
  items.put(FRAGMENTS,new Long[0]);
  items.put(HOSTS,new Long[0]);
  items.put(IDENTIFIER,new Long(3));
  items.put(IMPORTED_PACKAGES,new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"});
  items.put(LAST_MODIFIED,new Long(8797));
  items.put(LOCATION,"");
  items.put(ACTIVATION_POLICY_USED,true);
  items.put(PERSISTENTLY_STARTED,false);
  items.put(REGISTERED_SERVICES,new Long[0]);
  items.put(REMOVAL_PENDING,false);
  items.put(REQUIRED,true);
  items.put(REQUIRED_BUNDLES,new Long[]{new Long(44),new Long(66)});
  items.put(REQUIRING_BUNDLES,new Long[0]);
  items.put(SERVICES_IN_USE,new Long[]{new Long(15),new Long(16),new Long(17)});
  items.put(START_LEVEL,1);
  items.put(STATE,"ACTIVE");
  items.put(SYMBOLIC_NAME,"test");
  items.put(VERSION,"0.0.0");
  TabularData headerTable=new TabularDataSupport(HEADERS_TYPE);
  headerTable.put(new Header("a","a").toCompositeData());
  headerTable.put(new Header("b","b").toCompositeData());
  items.put(HEADERS,headerTable);
  CompositeData compositeData=new CompositeDataSupport(BUNDLE_TYPE,items);
  BundleData b=BundleData.from(compositeData);
  assertEquals("test",b.getSymbolicName());
  assertEquals("0.0.0",b.getVersion());
  assertEquals(2,b.getHeaders().size());
  assertArrayEquals(new String[]{"org.apache.aries.jmx;1.0.0"},b.getExportedPackages());
  assertArrayEquals(new String[]{"org.apache.aries.jmx.b1;0.0.0","org.apache.aries.jmx.b2;2.0.1"},b.getImportedPackages());
  assertArrayEquals(new long[]{44,66},b.getRequiredBundles());
  assertArrayEquals(new long[]{15,16,17},b.getServicesInUse());
  assertEquals("ACTIVE",b.getState());
  assertEquals(0,b.getHosts().length);
  assertEquals(0,b.getFragments().length);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
