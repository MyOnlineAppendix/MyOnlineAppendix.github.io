<h3 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BasicDocumentStoreTest (27 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(3)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialFailure(){
  String bid=this.getClass().getName() + ".testCreatePartialFailure-";
  int cnt=10;
  assertTrue(cnt > 8);
  for (int i=0; i < cnt; i++) {
    super.ds.remove(Collection.NODES,bid + i);
    removeMe.add(bid + i);
  }
  int pre=cnt / 2;
  UpdateOp up=new UpdateOp(bid + pre,true);
  up.set("_id",bid + pre);
  up.set("foo","bar");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  Set<String> toCreate=new HashSet<String>();
  Set<String> toCreateFailEarly=new HashSet<String>();
  List<UpdateOp> ups=new ArrayList<UpdateOp>();
  for (int i=0; i < cnt; i++) {
    UpdateOp op=new UpdateOp(bid + i,true);
    op.set("_id",bid + i);
    op.set("foo","qux");
    ups.add(op);
    if (i != pre) {
      toCreate.add(bid + i);
    }
    if (i < pre) {
      toCreateFailEarly.add(bid + i);
    }
  }
  assertFalse(super.ds.create(Collection.NODES,ups));
  Set<String> created=new HashSet<String>();
  for (int i=0; i < cnt; i++) {
    boolean present=null != super.ds.find(Collection.NODES,bid + i,0);
    if (i == pre && !present) {
      fail(super.dsname + ": batch update removed previously existing node " + (bid + i));
    }
 else     if (present && i != pre) {
      created.add(bid + i);
    }
  }
  toCreate.removeAll(created);
  if (created.isEmpty()) {
    LOG.info(super.dsname + ": create() apparently is atomic");
  }
 else   if (created.size() == toCreate.size()) {
    LOG.info(super.dsname + ": create() apparently is best-effort");
  }
 else   if (created.equals(toCreateFailEarly)) {
    LOG.info(super.dsname + ": create() stops at first failure");
  }
 else {
    LOG.info(super.dsname + ": create() created: " + created+ ", missing: "+ toCreate);
  }
}

</code></pre>

<pre class="type-13 type-9 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void testMaxProperty(){
  int min=0;
  int max=1024 * 1024 * 8;
  int test=0;
  int last=0;
  while (max - min >= 256) {
    if (test == 0) {
      test=max;
    }
 else {
      test=(max + min) / 2;
    }
    String id=this.getClass().getName() + ".testMaxProperty-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    if (success) {
      NodeDocument findme=super.ds.find(Collection.NODES,id,0);
      assertNotNull("failed to retrieve previously stored document",findme);
      super.ds.remove(Collection.NODES,id);
      min=test;
      last=test;
    }
 else {
      max=test;
    }
  }
  LOG.info("max prop length for " + super.dsname + " was "+ last);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMaxIdNonAscii(){
  testMaxId(false);
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeleteNonExistingMultiple(){
  String id=this.getClass().getName() + ".testDeleteNonExistingMultiple-" + UUID.randomUUID();
  UpdateOp up=new UpdateOp(id + "-2",true);
  up.set("_id",id + "-2");
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  List<String> todelete=new ArrayList<String>();
  todelete.add(id + "-2");
  todelete.add(id);
  ds.remove(Collection.NODES,todelete);
  Document d=ds.find(Collection.NODES,id + "-2");
  assertTrue(d == null);
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testAddAndRemove(){
  String id=this.getClass().getName() + ".testAddAndRemove";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  removeMe.add(id);
}

</code></pre>

<pre class="type-9 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalUpdate(){
  String id=this.getClass().getName() + ".testConditionalUpdate";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  String existingProp="_recoverylock";
  String existingRevisionProp="recoverylock";
  String nonExistingProp="_qux";
  String nonExistingRevisionProp="qux";
  Revision r=new Revision(1,1,1);
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set(existingProp,"lock");
  up.setMapEntry(existingRevisionProp,r,"lock");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.notEquals(nonExistingProp,"none");
  NodeDocument result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(nonExistingProp,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.notEquals(nonExistingRevisionProp,r,"none");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(nonExistingRevisionProp,r,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingProp,"none");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingProp,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingRevisionProp,r,"none");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingRevisionProp,r,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.notEquals(existingProp,"lock");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingProp,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.notEquals(existingRevisionProp,r,"lock");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingRevisionProp,r,null);
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingProp,"lock");
  up.set(existingProp,"none");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.equals(existingRevisionProp,r,"lock");
  up.setMapEntry(existingRevisionProp,r,"none");
  result=super.ds.findAndUpdate(Collection.NODES,up);
  assertNotNull(result);
  removeMe.add(id);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testServerTimeDiff() throws Exception {
  UpdateOp up=new UpdateOp("0:/",true);
  up.set("_id","0:/");
  super.ds.create(Collection.NODES,Collections.singletonList(up));
  removeMe.add("0:/");
  long td=super.ds.determineServerTimeDifferenceMillis();
  LOG.info("Server time difference on " + super.dsname + ": "+ td+ "ms");
}

</code></pre>

<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuery(){
  String base=this.getClass().getName() + ".testQuery-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "A",5));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "4"));
  assertFalse(result.contains(base + "5"));
  result=getKeys(ds.query(Collection.NODES,base,base + "A",20));
  assertEquals(10,result.size());
  assertTrue(result.contains(base + "0"));
  assertTrue(result.contains(base + "9"));
}

</code></pre>

<pre class="type-9 type-12 type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeWithCondition() throws Exception {
  Set<String> existingDocs=new HashSet<String>();
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    existingDocs.add(doc.getPath());
  }
  List<UpdateOp> docs=Lists.newArrayList();
  docs.add(newDocument("/foo",100));
  removeMe.add(Utils.getIdFromPath("/foo"));
  docs.add(newDocument("/bar",200));
  removeMe.add(Utils.getIdFromPath("/bar"));
  docs.add(newDocument("/baz",300));
  removeMe.add(Utils.getIdFromPath("/baz"));
  ds.create(Collection.NODES,docs);
  for (  UpdateOp op : docs) {
    assertNotNull(ds.find(Collection.NODES,op.getId()));
  }
  Map<String,Map<Key,Condition>> toRemove=Maps.newHashMap();
  removeDocument(toRemove,"/foo",100);
  removeDocument(toRemove,"/bar",300);
  removeDocument(toRemove,"/qux",100);
  removeDocument(toRemove,"/baz",300);
  int removed=ds.remove(Collection.NODES,toRemove);
  assertEquals(2,removed);
  assertNotNull(ds.find(Collection.NODES,Utils.getIdFromPath("/bar")));
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    if (!doc.getPath().equals("/bar") && !existingDocs.contains(doc.getPath())) {
      fail("document must not exist: " + doc.getId());
    }
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateMultiple(){
  String id=this.getClass().getName() + ".testUpdateMultiple";
  super.ds.remove(Collection.NODES,id);
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  List<String> toupdate=new ArrayList<String>();
  toupdate.add(id + "-" + UUID.randomUUID());
  toupdate.add(id);
  UpdateOp up2=new UpdateOp(id,false);
  up2.set("foo","bar");
  ds.update(Collection.NODES,toupdate,up2);
  ds.invalidateCache();
  Document d=ds.find(Collection.NODES,id);
  assertNotNull(d);
  assertEquals(id,d.getId());
  assertEquals("bar",d.get("foo").toString());
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterestingStrings(){
  String[] tests=new String[]{"simple:foo","cr:a\n\b","dquote:a\"b","bs:a\\b","euro:a\u201c","gclef:\uD834\uDD1E","tab:a\tb","nul:a\u0000b","brokensurrogate:\ud800"};
  for (  String t : tests) {
    int pos=t.indexOf(":");
    String testname=t.substring(0,pos);
    String test=t.substring(pos + 1);
    String id=this.getClass().getName() + ".testInterestingStrings-" + testname;
    super.ds.remove(Collection.NODES,id);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",test);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property value of " + test + " ("+ testname+ ") in "+ super.dsname,success);
    super.ds.invalidateCache();
    NodeDocument nd=super.ds.find(Collection.NODES,id);
    assertEquals("failure to round-trip " + testname + " through "+ super.dsname,test,nd.get("foo"));
    super.ds.remove(Collection.NODES,id);
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifiedMaxUpdateQuery(){
  String id=this.getClass().getName() + ".testModifiedMaxUpdate";
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set("_modified",1000L);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  UpdateOp up2=new UpdateOp(id,true);
  up2.set("_id",id);
  up2.max("_modified",100L);
  super.ds.findAndUpdate(Collection.NODES,up2);
  super.ds.invalidateCache();
  String startId=this.getClass().getName() + ".testModifiedMaxUpdatd";
  String endId=this.getClass().getName() + ".testModifiedMaxUpdatf";
  List<NodeDocument> results=super.ds.query(Collection.NODES,startId,endId,"_modified",1000,1);
  assertEquals("document not found, maybe indexed _modified property not properly updated",1,results.size());
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void description() throws Exception {
  Map<String,String> desc=ds.getMetadata();
  assertNotNull(desc.get("type"));
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyDeletedOnce(){
  String id=this.getClass().getName() + ".testModifyDeletedOnce";
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set(NodeDocument.DELETED_ONCE,Boolean.FALSE);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  NodeDocument nd=super.ds.find(Collection.NODES,id,0);
  assertNotNull(nd);
  Boolean dovalue=(Boolean)nd.get(NodeDocument.DELETED_ONCE);
  if (dovalue != null) {
    assertEquals(dovalue.booleanValue(),Boolean.FALSE);
  }
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.set(NodeDocument.DELETED_ONCE,Boolean.TRUE);
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  nd=super.ds.find(Collection.NODES,id,0);
  assertNotNull(nd);
  assertNotNull(nd.get(NodeDocument.DELETED_ONCE));
  assertEquals(((Boolean)nd.get(NodeDocument.DELETED_ONCE)).booleanValue(),Boolean.TRUE);
}

</code></pre>

<pre class="type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterestingPropLengths() throws UnsupportedEncodingException {
  int lengths[]={1,10,100,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,20000};
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + "(ASCII) in "+ super.dsname,success);
    super.ds.remove(Collection.NODES,id);
  }
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,false);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname,success);
    if (success) {
      try {
        super.ds.findAndUpdate(Collection.NODES,up);
      }
 catch (      Exception ex) {
        ex.printStackTrace(System.err);
        fail("failed to update a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname);
      }
    }
    super.ds.remove(Collection.NODES,id);
  }
}

</code></pre>

<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalUpdateForbidden(){
  String id=this.getClass().getName() + ".testConditionalupdateForbidden";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  try {
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.create(Collection.NODES,Collections.singletonList(up));
    fail("conditional create should fail");
  }
 catch (  IllegalStateException expected) {
  }
  UpdateOp cup=new UpdateOp(id,true);
  cup.set("_id",id);
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(cup)));
  removeMe.add(id);
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.createOrUpdate(Collection.NODES,up);
    fail("conditional createOrUpdate should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.createOrUpdate(Collection.NODES,Collections.singletonList(up));
    fail("conditional createOrUpdate should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.update(Collection.NODES,Collections.singletonList(id),up);
    fail("conditional update should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryBinary(){
  String base=this.getClass().getName() + ".testQueryBinary-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set(NodeDocument.HAS_BINARY_FLAG,i % 2L);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "Z",NodeDocument.HAS_BINARY_FLAG,NodeDocument.HAS_BINARY_VAL,1000));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "1"));
  assertFalse(result.contains(base + "0"));
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void removeInvalidatesCache() throws Exception {
  String id=Utils.getIdFromPath("/foo");
  removeMe.add(id);
  ds.create(Collection.NODES,Collections.singletonList(newDocument("/foo",1)));
  Map<Key,Condition> conditions=Collections.emptyMap();
  ds.remove(Collection.NODES,Collections.singletonMap(id,conditions));
  assertNull(ds.getIfCached(Collection.NODES,id));
}

</code></pre>

<pre class="type-9 type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryCollation(){
  String base="2:/" + this.getClass().getName() + ".testQueryCollation";
  List<UpdateOp> creates=new ArrayList<UpdateOp>();
  List<String> expected=new ArrayList<String>();
  for (  char c : "!\"#$%&'()*+,-./0123456789:;<=>?@AZ[\\]^_`az{|}~".toCharArray()) {
    String id=base + c;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    removeMe.add(id);
    id=base + "/" + c;
    up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    expected.add(id);
    removeMe.add(id);
  }
  boolean success=super.ds.create(Collection.NODES,creates);
  assertTrue("documents not created",success);
  List<String> result=getKeys(ds.query(Collection.NODES,base + "/",base + "0",1000));
  List<String> diff=new ArrayList<String>();
  diff.addAll(result);
  diff.removeAll(expected);
  if (!diff.isEmpty()) {
    fail("unexpected query results (broken collation handling in persistence?): " + diff);
  }
  diff=new ArrayList<String>();
  diff.addAll(expected);
  diff.removeAll(result);
  if (!diff.isEmpty()) {
    fail("missing query results (broken collation handling in persistence?): " + diff);
  }
  assertEquals("incorrect result ordering in query result (broken collation handling in persistence?)",expected,result);
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCollisionsModCount(){
  String id=this.getClass().getName() + ".testCollisionsModCount";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  Revision revision=Revision.fromString("r0-0-1");
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.setMapEntry("_collisions",revision,"foo");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  removeMe.add(id);
  nd=super.ds.find(Collection.NODES,id);
  assertNotNull(nd);
  Number cmc=(Number)nd.get("_collisionsModCount");
  if (cmc == null) {
  }
 else {
    Revision revision2=Revision.fromString("r0-0-2");
    UpdateOp up2=new UpdateOp(id,false);
    up2.set("_id",id);
    up2.setMapEntry("_collisions",revision2,"foobar");
    NodeDocument old=super.ds.findAndUpdate(Collection.NODES,up2);
    assertNotNull(old);
    nd=super.ds.find(Collection.NODES,id,0);
    assertNotNull(nd);
    Number cmc2=(Number)nd.get("_collisionsModCount");
    assertNotNull(cmc2);
    assertTrue(cmc2.longValue() > cmc.longValue());
    UpdateOp up3=new UpdateOp(id,false);
    up3.set("_id",id);
    up3.set("foo","bar");
    old=super.ds.findAndUpdate(Collection.NODES,up3);
    assertNotNull(old);
    nd=super.ds.find(Collection.NODES,id,0);
    assertNotNull(nd);
    Number cmc3=(Number)nd.get("_collisionsModCount");
    assertNotNull(cmc3);
    assertTrue(cmc2.longValue() == cmc3.longValue());
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyModified(){
  String id=this.getClass().getName() + ".testModifyModified";
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set("_modified",1000L);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.max("_modified",2000L);
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  NodeDocument nd=super.ds.find(Collection.NODES,id,0);
  assertEquals(((Number)nd.get("_modified")).longValue(),2000L);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.set("_modified",1500L);
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  nd=super.ds.find(Collection.NODES,id,0);
  assertEquals(((Number)nd.get("_modified")).longValue(),1500L);
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateModified(){
  String id=this.getClass().getName() + ".testUpdateModified";
  super.ds.remove(Collection.NODES,id);
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  ds.invalidateCache();
  Document d=super.ds.find(Collection.NODES,id);
  Object m=d.get("_modified");
  assertNull("_modified should be null until set",m);
  up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set("_modified",123L);
  super.ds.findAndUpdate(Collection.NODES,up);
  ds.invalidateCache();
  d=super.ds.find(Collection.NODES,id);
  m=d.get("_modified");
  assertNotNull("_modified should now be != null",m);
  assertEquals("123",m.toString());
  up=new UpdateOp(id,true);
  up.set("_id",id);
  up.max("_modified",122L);
  super.ds.findAndUpdate(Collection.NODES,up);
  ds.invalidateCache();
  d=super.ds.find(Collection.NODES,id);
  m=d.get("_modified");
  assertNotNull("_modified should now be != null",m);
  assertEquals("123",m.toString());
  up=new UpdateOp(id,true);
  up.set("_id",id);
  up.max("_modified",124L);
  super.ds.findAndUpdate(Collection.NODES,up);
  ds.invalidateCache();
  d=super.ds.find(Collection.NODES,id);
  m=d.get("_modified");
  assertNotNull("_modified should now be != null",m);
  assertEquals("124",m.toString());
}

</code></pre>

<pre class="type-9 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepeatingUpdatesOnSQLServer(){
  String id=this.getClass().getName() + ".testRepeatingUpdatesOnSQLServer";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  removeMe.add(id);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.set("f0",generateConstantString(3000));
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.set("f1",generateConstantString(967));
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  NodeDocument doc=super.ds.find(Collection.NODES,id,0);
  assertNotNull(doc);
}

</code></pre>

<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryDeletedOnce(){
  String base=this.getClass().getName() + ".testQueryDeletedOnce-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set(NodeDocument.DELETED_ONCE,Boolean.valueOf(i % 2 == 0));
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "Z",NodeDocument.DELETED_ONCE,1L,1000));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "0"));
  assertFalse(result.contains(base + "1"));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeleteNonExisting(){
  String id=this.getClass().getName() + ".testDeleteNonExisting-" + UUID.randomUUID();
  ds.remove(Collection.NODES,id);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testMaxIdAscii(){
  int result=testMaxId(true);
  assertTrue("needs to support keys of 512 bytes length, but only supports " + result,result >= 512);
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void getIfCachedNonExistingDocument() throws Exception {
  String id=Utils.getIdFromPath("/foo");
  assertNull(ds.find(Collection.NODES,id));
  assertNull(ds.getIfCached(Collection.NODES,id));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
