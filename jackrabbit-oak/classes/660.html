<h3 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugEvaluationTest (25 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(24)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetPrivilegesEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(EveryonePrincipal.getInstance());
  assertTrue(pp.getPrivileges(content).isEmpty());
  assertTrue(pp.getPrivileges(content2).isEmpty());
  assertTrue(pp.getPrivileges(a).isEmpty());
  assertTrue(pp.getPrivileges(c).isEmpty());
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedTestGroup() throws Exception {
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal);
  assertTrue(pp.isGranted(content,null,Permissions.READ));
  assertTrue(pp.isGranted(a,null,Permissions.READ));
  assertFalse(pp.isGranted(c,null,Permissions.READ));
  assertTrue(pp.isGranted(content,null,Permissions.READ_ACCESS_CONTROL));
  assertTrue(pp.isGranted(a,null,Permissions.READ_ACCESS_CONTROL));
  assertTrue(pp.isGranted(c,null,Permissions.READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteAcl() throws Exception {
  ContentSession cs=createTestSession2();
  Root r=cs.getLatestRoot();
  try {
    Tree tree=r.getTree("/content/a/b/c");
    tree.setProperty(JCR_MIXINTYPES,ImmutableList.of(MIX_REP_CUG_MIXIN,AccessControlConstants.MIX_REP_ACCESS_CONTROLLABLE),Type.NAMES);
    tree.addChild(AccessControlConstants.REP_POLICY).setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_ACL,Type.NAME);
    r.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    r.refresh();
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedTestUserEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(getTestUser().getPrincipal(),EveryonePrincipal.getInstance());
  assertTrue(pp.isGranted(content,null,Permissions.READ));
  assertFalse(pp.isGranted(a,null,Permissions.READ));
  assertTrue(pp.isGranted(c,null,Permissions.READ));
  assertFalse(pp.isGranted(content,null,Permissions.READ_ACCESS_CONTROL));
  assertFalse(pp.isGranted(a,null,Permissions.READ_ACCESS_CONTROL));
  assertFalse(pp.isGranted(c,null,Permissions.READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRead() throws Exception {
  List<String> noAccess=ImmutableList.of("/",UNSUPPORTED_PATH,"/content/a","/content/a/b","/content/aa/bb","/content2");
  for (  String p : noAccess) {
    assertFalse(p,testRoot.getTree(p).exists());
  }
  List<String> readAccess=ImmutableList.of("/content","/content/subtree","/content/a/b/c","/content/aa");
  for (  String p : readAccess) {
    assertTrue(p,testRoot.getTree(p).exists());
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(EveryonePrincipal.getInstance());
  assertFalse(pp.isGranted(content,null,Permissions.READ));
  assertFalse(pp.isGranted(content2,null,Permissions.READ));
  assertFalse(pp.isGranted(a,null,Permissions.READ));
  assertFalse(pp.isGranted(c,null,Permissions.READ));
  assertFalse(pp.isGranted(content,null,Permissions.READ_ACCESS_CONTROL));
  assertFalse(pp.isGranted(content2,null,Permissions.READ_ACCESS_CONTROL));
  assertFalse(pp.isGranted(a,null,Permissions.READ_ACCESS_CONTROL));
  assertFalse(pp.isGranted(c,null,Permissions.READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testReadCug2() throws Exception {
  ContentSession cs=createTestSession2();
  try {
    Root r=cs.getLatestRoot();
    assertTrue(r.getTree("/content/a/rep:cugPolicy").exists());
    assertFalse(r.getTree("/content2/rep:cugPolicy").exists());
  }
  finally {
    cs.close();
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testWrite2() throws Exception {
  ContentSession cs=createTestSession2();
  Root r=cs.getLatestRoot();
  try {
    PermissionProvider pp=createPermissionProvider(cs);
    assertTrue(pp.isGranted(root.getTree("/content/writeTest"),null,Permissions.ADD_NODE));
    assertTrue(pp.isGranted(root.getTree("/content/a/b/c/writeTest"),null,Permissions.ADD_NODE));
    List<String> paths=ImmutableList.of("/content","/content/a/b/c");
    for (    String p : paths) {
      NodeUtil content=new NodeUtil(r.getTree(p));
      content.addChild("writeTest",NT_OAK_UNSTRUCTURED);
      r.commit();
    }
  }
  finally {
    r.refresh();
    cs.close();
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedTestGroupEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal,EveryonePrincipal.getInstance());
  assertTrue(pp.isGranted(content,null,Permissions.READ));
  assertTrue(pp.isGranted(a,null,Permissions.READ));
  assertTrue(pp.isGranted(c,null,Permissions.READ));
  assertTrue(pp.isGranted(content,null,Permissions.READ_ACCESS_CONTROL));
  assertTrue(pp.isGranted(a,null,Permissions.READ_ACCESS_CONTROL));
  assertTrue(pp.isGranted(c,null,Permissions.READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteCug() throws Exception {
  ContentSession cs=createTestSession2();
  Root r=cs.getLatestRoot();
  try {
    Tree tree=r.getTree("/content/a/rep:cugPolicy");
    tree.setProperty(REP_PRINCIPAL_NAMES,ImmutableList.of(EveryonePrincipal.NAME,testGroupPrincipal.getName()),Type.STRINGS);
    r.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    r.refresh();
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasAllPrivileges() throws Exception {
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal);
  assertFalse(pp.hasPrivileges(content,PrivilegeConstants.JCR_ALL));
  assertFalse(pp.hasPrivileges(a,PrivilegeConstants.JCR_ALL));
  assertFalse(pp.hasPrivileges(c,PrivilegeConstants.JCR_ALL));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before @Override public void before() throws Exception {
  super.before();
  setupCugsAndAcls();
  testGroupPrincipal=getTestGroupPrincipal();
  content=root.getTree("/content");
  content2=root.getTree("/content2");
  a=root.getTree("/content/a");
  c=root.getTree("/content/a/b/c");
  testSession=createTestSession();
  testRoot=testSession.getLatestRoot();
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testReadAcl2() throws Exception {
  ContentSession cs=createTestSession2();
  try {
    Root r=cs.getLatestRoot();
    assertTrue(r.getTree("/content/rep:policy").exists());
  }
  finally {
    cs.close();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testReadCug() throws Exception {
  List<String> noAccess=ImmutableList.of("/content/a/rep:cugPolicy","/content/aa/bb/rep:cugPolicy","/content2/rep:cugPolicy");
  for (  String p : noAccess) {
    assertFalse(p,testRoot.getTree(p).exists());
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrivilegesTestGroupEveryone() throws Exception {
  Set<String> r_w_rac=ImmutableSet.of(PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL);
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal,EveryonePrincipal.getInstance());
  assertEquals(r_w_rac,pp.getPrivileges(content));
  assertEquals(r_w_rac,pp.getPrivileges(a));
  assertEquals(r_w_rac,pp.getPrivileges(c));
  assertTrue(pp.getPrivileges(content2).isEmpty());
}

</code></pre>

<pre class="type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrivilegesTestUserEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(getTestUser().getPrincipal(),EveryonePrincipal.getInstance());
  Set<String> r=ImmutableSet.of(PrivilegeConstants.JCR_READ);
  assertEquals(r,pp.getPrivileges(content));
  assertEquals(r,pp.getPrivileges(c));
  assertTrue(pp.getPrivileges(a).isEmpty());
  assertTrue(pp.getPrivileges(content2).isEmpty());
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrivilegesTestGroup() throws Exception {
  Set<String> w_rac=ImmutableSet.of(PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL);
  Set<String> r_w_rac=ImmutableSet.of(PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL);
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal);
  assertEquals(r_w_rac,pp.getPrivileges(content));
  assertEquals(r_w_rac,pp.getPrivileges(a));
  assertEquals(w_rac,pp.getPrivileges(c));
  assertTrue(pp.getPrivileges(content2).isEmpty());
}

</code></pre>

<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite() throws Exception {
  List<String> readOnly=ImmutableList.of("/content","/content/a/b/c");
  for (  String p : readOnly) {
    try {
      NodeUtil content=new NodeUtil(testRoot.getTree(p));
      content.addChild("writeTest",NT_OAK_UNSTRUCTURED);
      testRoot.commit();
      fail();
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessViolation());
    }
 finally {
      testRoot.refresh();
    }
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(EveryonePrincipal.getInstance());
  assertFalse(pp.hasPrivileges(content,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(content2,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(a,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(c,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(content,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertFalse(pp.hasPrivileges(content2,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertFalse(pp.hasPrivileges(a,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertFalse(pp.hasPrivileges(c,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesTestUserEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(getTestUser().getPrincipal(),EveryonePrincipal.getInstance());
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(a,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(c,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(content,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertFalse(pp.hasPrivileges(a,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertFalse(pp.hasPrivileges(c,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasAllPrivileges2() throws Exception {
  AccessControlManager acMgr=getAccessControlManager(root);
  AccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,"/content/a");
  acl.addAccessControlEntry(testGroupPrincipal,privilegesFromNames(PrivilegeConstants.JCR_ALL));
  acMgr.setPolicy("/content/a",acl);
  root.commit();
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal);
  assertFalse(pp.hasPrivileges(root.getTree("/content"),PrivilegeConstants.JCR_ALL));
  assertTrue(pp.hasPrivileges(root.getTree("/content/a"),PrivilegeConstants.JCR_ALL));
  assertTrue(pp.hasPrivileges(root.getTree("/content/a/b"),PrivilegeConstants.JCR_ALL));
  assertFalse(pp.hasPrivileges(root.getTree("/content/a/b/c"),PrivilegeConstants.JCR_ALL));
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesTestGroup() throws Exception {
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal);
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(a,PrivilegeConstants.JCR_READ));
  assertFalse(pp.hasPrivileges(c,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertTrue(pp.hasPrivileges(a,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertTrue(pp.hasPrivileges(c,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasAllPrivilegesAdmin() throws Exception {
  PermissionProvider pp=createPermissionProvider(adminSession);
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.JCR_ALL));
  assertTrue(pp.hasPrivileges(a,PrivilegeConstants.JCR_ALL));
  assertTrue(pp.hasPrivileges(c,PrivilegeConstants.JCR_ALL));
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesTestGroupEveryone() throws Exception {
  PermissionProvider pp=createPermissionProvider(testGroupPrincipal,EveryonePrincipal.getInstance());
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(a,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(c,PrivilegeConstants.JCR_READ));
  assertTrue(pp.hasPrivileges(content,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertTrue(pp.hasPrivileges(a,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
  assertTrue(pp.hasPrivileges(c,PrivilegeConstants.REP_WRITE,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testReadAcl() throws Exception {
  assertFalse(testRoot.getTree("/content/rep:policy").exists());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
