<h3 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentStoreStatsTest (9 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void shutDown(){
  statsProvider.close();
  new ExecutorCloser(executor).close();
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneCreate_Journal() throws Exception {
  stats.doneCreate(100,Collection.JOURNAL,of("a","b"),true);
  assertEquals(2,getMeter(DocumentStoreStats.JOURNAL_CREATE).getCount());
  assertEquals(100,getTimer(DocumentStoreStats.JOURNAL_CREATE_TIMER).getSnapshot().getMax());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneQuery_Nodes() throws Exception {
  stats.doneQuery(100,Collection.NODES,"foo","bar",false,5,-1,false);
  assertEquals(5,getMeter(DocumentStoreStats.NODES_QUERY_FIND_READ_COUNT).getCount());
  assertEquals(1,getMeter(DocumentStoreStats.NODES_QUERY_PRIMARY).getCount());
  stats.doneQuery(100,Collection.NODES,"foo","bar",false,7,-1,true);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_QUERY_SLAVE).getCount());
  assertEquals(12,getMeter(DocumentStoreStats.NODES_QUERY_FIND_READ_COUNT).getCount());
  stats.doneQuery(100,Collection.NODES,"foo","bar",false,7,1000,false);
  assertEquals(2,getMeter(DocumentStoreStats.NODES_QUERY_PRIMARY).getCount());
  assertEquals(1,getMeter(DocumentStoreStats.NODES_QUERY_LOCK).getCount());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneFindCached() throws Exception {
  stats.doneFindCached(Collection.NODES,"foo");
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_CACHED).getCount());
  stats.doneFindCached(Collection.SETTINGS,"foo");
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_CACHED).getCount());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneFindAndModify() throws Exception {
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,true,0);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_CREATE_UPSERT).getCount());
  assertEquals(100,getTimer(DocumentStoreStats.NODES_CREATE_UPSERT_TIMER).getSnapshot().getMax());
  stats.doneFindAndModify(100,Collection.NODES,"foo",false,true,0);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_UPDATE).getCount());
  assertEquals(100,getTimer(DocumentStoreStats.NODES_UPDATE_TIMER).getSnapshot().getMax());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneQuery_Journal() throws Exception {
  stats.doneQuery(100,Collection.JOURNAL,"foo","bar",false,5,-1,false);
  assertEquals(5,getMeter(DocumentStoreStats.JOURNAL_QUERY).getCount());
  assertEquals(1,getTimer(DocumentStoreStats.JOURNAL_QUERY_TIMER).getCount());
}

</code></pre>

<pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void perfLog() throws Exception {
  String logName=DocumentStoreStats.class.getName() + ".perf";
  LogCustomizer customLogs=LogCustomizer.forLogger(logName).filter(Level.TRACE).create();
  enableLevel(logName,Level.INFO);
  customLogs.starting();
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,true,0);
  assertEquals(0,customLogs.getLogs().size());
  stats.doneFindAndModify(TimeUnit.SECONDS.toNanos(10),Collection.NODES,"foo",true,true,0);
  assertEquals(0,customLogs.getLogs().size());
  enableLevel(logName,Level.DEBUG);
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,true,0);
  assertEquals(0,customLogs.getLogs().size());
  stats.doneFindAndModify(TimeUnit.SECONDS.toNanos(10),Collection.NODES,"foo",true,true,0);
  assertEquals(1,customLogs.getLogs().size());
  enableLevel(logName,Level.TRACE);
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,true,0);
  assertEquals(2,customLogs.getLogs().size());
  customLogs.finished();
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneFindUncached() throws Exception {
  stats.doneFindUncached(100,Collection.NODES,"0:/",true,false);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_PRIMARY).getCount());
  assertEquals(100,getTimer(DocumentStoreStats.NODES_FIND_TIMER).getSnapshot().getMax());
  assertEquals(0,getMeter(DocumentStoreStats.NODES_FIND_SLAVE).getCount());
  stats.doneFindUncached(100,Collection.NODES,"0:/",true,true);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_PRIMARY).getCount());
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_SLAVE).getCount());
  stats.doneFindUncached(100,Collection.NODES,"2:p/foo",true,false);
  assertEquals(2,getMeter(DocumentStoreStats.NODES_FIND_PRIMARY).getCount());
  assertEquals(1,getMeter(DocumentStoreStats.NODES_FIND_SPLIT).getCount());
  stats.doneFindUncached(100,Collection.SETTINGS,"0:/",true,false);
  assertEquals(2,getMeter(DocumentStoreStats.NODES_FIND_PRIMARY).getCount());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void doneFindAndModifyRetryAndFailure() throws Exception {
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,false,3);
  assertEquals(1,getMeter(DocumentStoreStats.NODES_UPDATE_FAILURE).getCount());
  assertEquals(3,getMeter(DocumentStoreStats.NODES_UPDATE_RETRY_COUNT).getCount());
  stats.doneFindAndModify(100,Collection.NODES,"foo",true,true,2);
  assertEquals(5,getMeter(DocumentStoreStats.NODES_UPDATE_RETRY_COUNT).getCount());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
