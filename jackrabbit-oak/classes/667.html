<h3 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugPermissionProviderTest (23 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="19"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('19')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-19"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(String,String)
 */
@Test public void testIsGrantedJcrActionsNonExistingPath(){
  String p="/path/to/non/existing/tree";
  assertFalse(cugPermProvider.isGranted(p,Session.ACTION_READ));
  assertFalse(cugPermProvider.isGranted(p,Permissions.getString(Permissions.READ_NODE)));
  assertFalse(cugPermProvider.isGranted(p,Permissions.getString(Permissions.READ_PROPERTY)));
  assertFalse(cugPermProvider.isGranted(p,Session.ACTION_ADD_NODE));
  assertFalse(cugPermProvider.isGranted(p,Session.ACTION_READ + ',' + Session.ACTION_ADD_NODE));
}

</code></pre>

<pre class="type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void testGetPrivilegesAtCug2(){
  PermissionProvider pp=createCugPermissionProvider(ImmutableSet.of(SUPPORTED_PATH),testGroupPrincipal);
  Set<String> expected=ImmutableSet.of(PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES);
  assertEquals(expected,pp.getPrivileges(root.getTree("/content/a")));
  assertEquals(expected,pp.getPrivileges(root.getTree("/content/aa/bb")));
  assertTrue(pp.getPrivileges(root.getTree("/content/a/b/c")).isEmpty());
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testIsGrantedRead(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.READ));
      assertFalse(cugPermProvider.isGranted(tree,tree.getProperty(JCR_PRIMARYTYPE),Permissions.READ_PROPERTY));
    }
  }
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.isGranted(tree,null,Permissions.READ));
      assertTrue(cugPermProvider.isGranted(tree,null,Permissions.READ_NODE));
      assertTrue(cugPermProvider.isGranted(tree,tree.getProperty(JCR_PRIMARYTYPE),Permissions.READ_PROPERTY));
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasReadPrivilegesAtCug(){
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_PROPERTIES));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES));
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void testGetPrivilegesAtCug(){
  Set<String> expected=ImmutableSet.of(PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES);
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertEquals(expected,cugPermProvider.getPrivileges(tree));
    }
  }
}

</code></pre>

<pre class="type-5 type-7 type-6 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see PermissionProvider#getTreePermission(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.spi.security.authorization.permission.TreePermission)
 */
@Test public void testGetTreePermissions() throws AccessDeniedException {
  TreePermission rootTp=cugPermProvider.getTreePermission(root.getTree("/"),TreePermission.EMPTY);
  assertTrue(rootTp instanceof EmptyCugTreePermission);
  TreePermission contentTp=cugPermProvider.getTreePermission(root.getTree(SUPPORTED_PATH),rootTp);
  assertTrue(contentTp instanceof CugTreePermission);
  TreePermission aTp=cugPermProvider.getTreePermission(root.getTree("/content/a"),contentTp);
  assertTrue(aTp instanceof CugTreePermission);
  TreePermission bTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b"),aTp);
  assertTrue(bTp instanceof CugTreePermission);
  TreePermission cTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b/c"),bTp);
  assertTrue(cTp instanceof CugTreePermission);
  TreePermission aaTp=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  assertTrue(aaTp instanceof CugTreePermission);
  TreePermission bbTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb"),aaTp);
  assertTrue(bbTp instanceof CugTreePermission);
  TreePermission ccTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb/cc"),bbTp);
  assertTrue(ccTp instanceof CugTreePermission);
  Tree aaTree=root.getTree("/content/aa");
  new NodeUtil(aaTree).addChild(CugConstants.REP_CUG_POLICY,NT_OAK_UNSTRUCTURED);
  TreePermission aaTp2=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  assertTrue(aaTp2 instanceof CugTreePermission);
  TreePermission falseCugTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/rep:cugPolicy"),aaTp2);
  assertNotSame(TreePermission.EMPTY,falseCugTp);
  TreePermission cugTp=cugPermProvider.getTreePermission(root.getTree("/content/a/rep:cugPolicy"),aTp);
  assertSame(TreePermission.NO_RECOURSE,cugTp);
  TreePermission jcrSystemTp=cugPermProvider.getTreePermission(root.getTree("/jcr:system"),rootTp);
  assertTrue(jcrSystemTp instanceof EmptyCugTreePermission);
  assertSame(TreePermission.NO_RECOURSE,cugPermProvider.getTreePermission(root.getTree(NodeTypeConstants.NODE_TYPES_PATH),jcrSystemTp));
  TreePermission unsupportedPathTp=cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH),rootTp);
  assertSame(TreePermission.NO_RECOURSE,unsupportedPathTp);
  try {
    cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH + "/child"),unsupportedPathTp);
    fail();
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testSupportedPermissionsByNullTree(){
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.READ));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.READ_NODE));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.READ_PROPERTY));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.ALL));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.WRITE));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.ADD_NODE | Permissions.REMOVE));
  assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions((Tree)null,null,Permissions.READ_ACCESS_CONTROL));
}

</code></pre>

<pre class="type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.spi.security.authorization.permission.TreePermission,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testSupportedPermissionsByTreePermission(){
  TreePermission rootTp=cugPermProvider.getTreePermission(root.getTree("/"),TreePermission.EMPTY);
  Map<TreePermission,Boolean> tpMap=new HashMap<TreePermission,Boolean>();
  TreePermission contentTp=cugPermProvider.getTreePermission(root.getTree(SUPPORTED_PATH),rootTp);
  tpMap.put(contentTp,false);
  TreePermission aTp=cugPermProvider.getTreePermission(root.getTree("/content/a"),contentTp);
  tpMap.put(aTp,true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/a/rep:cugPolicy"),aTp),true);
  TreePermission bTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b"),aTp);
  tpMap.put(bTp,true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/a/b/c"),bTp),true);
  TreePermission aaTp=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  tpMap.put(aaTp,false);
  TreePermission bbTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb"),aaTp);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/aa/bb/cc"),bbTp),true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/jcr:system"),rootTp),false);
  tpMap.put(rootTp,false);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH),rootTp),false);
  for (  TreePermission tp : tpMap.keySet()) {
    boolean isInCug=tpMap.get(tp);
    if (isInCug) {
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tp,null,Permissions.READ));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE));
      assertEquals(Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tp,null,Permissions.ALL));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.ALL));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.ADD_NODE | Permissions.REMOVE));
  }
}

</code></pre>

<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.PermissionProvider#getRepositoryPermission()
 */
@Test public void testGetRepositoryPermissions(){
  assertSame(RepositoryPermission.EMPTY,cugPermProvider.getRepositoryPermission());
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#isGranted(org.apache.jackrabbit.oak.plugins.tree.TreeLocation,long)
 */
@Test public void testIsGrantedByLocation() throws Exception {
  for (  String p : NOT_READABLE_PATHS) {
    TreeLocation location=TreeLocation.create(root,p);
    assertFalse(cugPermProvider.isGranted(location,Permissions.READ));
    assertFalse(cugPermProvider.isGranted(location,Permissions.READ_NODE));
    assertFalse(cugPermProvider.isGranted(location,Permissions.READ_PROPERTY));
    assertFalse(cugPermProvider.isGranted(location,Permissions.ALL));
    assertFalse(cugPermProvider.isGranted(location,Permissions.ADD_NODE));
    assertFalse(cugPermProvider.isGranted(location,Permissions.READ_ACCESS_CONTROL));
  }
  for (  String p : READABLE_PATHS) {
    TreeLocation location=TreeLocation.create(root,p);
    assertTrue(cugPermProvider.isGranted(location,Permissions.READ));
    assertTrue(cugPermProvider.isGranted(location,Permissions.READ_NODE));
    assertTrue(cugPermProvider.isGranted(location,Permissions.READ_PROPERTY));
    assertFalse(cugPermProvider.isGranted(location,Permissions.ALL));
    assertFalse(cugPermProvider.isGranted(location,Permissions.ADD_NODE));
    assertFalse(cugPermProvider.isGranted(location,Permissions.READ_ACCESS_CONTROL));
  }
}

</code></pre>

<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void getPrivileges(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.getPrivileges(root.getTree(p)).isEmpty());
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.plugins.tree.TreeLocation,long)
 */
@Test public void testSupportedPermissionsByLocation(){
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    TreeLocation location=TreeLocation.create(root,path);
    if (isInCug) {
      assertEquals(path,Permissions.READ,cugPermProvider.supportedPermissions(location,Permissions.READ));
      assertEquals(path,Permissions.READ_NODE,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE));
      assertEquals(path,Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(location,Permissions.READ_PROPERTY));
      assertEquals(path,Permissions.READ,cugPermProvider.supportedPermissions(location,Permissions.ALL));
      assertEquals(path,Permissions.READ_NODE,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_PROPERTY));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.ALL));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_ACCESS_CONTROL));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.MODIFY_ACCESS_CONTROL));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.ADD_NODE));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.WRITE));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(TreeLocation.create(root,"/path/to/no-existing/tree"),Permissions.READ));
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#isGranted(org.apache.jackrabbit.oak.plugins.tree.TreeLocation,long)
 */
@Test public void testIsGrantedNonExistingLocation() throws Exception {
  ContentSession anonymous=login(new GuestCredentials());
  try {
    Root anonymousRoot=anonymous.getLatestRoot();
    for (    Root r : new Root[]{anonymousRoot,root}) {
      TreeLocation location=TreeLocation.create(r,"/path/to/non/existing/tree");
      assertFalse(cugPermProvider.isGranted(location,Permissions.READ));
      assertFalse(cugPermProvider.isGranted(location,Permissions.READ_NODE));
      assertFalse(cugPermProvider.isGranted(location,Permissions.READ_PROPERTY));
      assertFalse(cugPermProvider.isGranted(location,Permissions.ALL));
      assertFalse(cugPermProvider.isGranted(location,Permissions.ADD_NODE));
      assertFalse(cugPermProvider.isGranted(location,Permissions.READ_ACCESS_CONTROL));
    }
  }
  finally {
    anonymous.close();
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPrivileges(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits)
 */
@Test public void testSupportedPrivileges(){
  PrivilegeBits readBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.JCR_READ);
  PrivilegeBits readNodeBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES);
  PrivilegeBits readPropBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_PROPERTIES);
  PrivilegeBitsProvider provider=new PrivilegeBitsProvider(root);
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    Tree tree=root.getTree(path);
    if (isInCug) {
      assertPrivilegeBits(readBits,cugPermProvider.supportedPrivileges(tree,readBits));
      assertPrivilegeBits(readNodeBits,cugPermProvider.supportedPrivileges(tree,readNodeBits));
      assertPrivilegeBits(readPropBits,cugPermProvider.supportedPrivileges(tree,readPropBits));
      assertPrivilegeBits(readBits,cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ALL)));
      assertPrivilegeBits(readNodeBits,cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.JCR_READ_ACCESS_CONTROL)));
    }
 else {
      assertTrue(cugPermProvider.supportedPrivileges(tree,readBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,readNodeBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,readPropBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ALL)).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
    }
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_WRITE)).isEmpty());
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_NODE)).isEmpty());
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPrivileges(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits)
 */
@Test public void testSupportedPrivilegesForNullTree(){
  PrivilegeBits readBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.JCR_READ);
  PrivilegeBits readNodeBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES);
  PrivilegeBits readPropBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_PROPERTIES);
  PrivilegeBitsProvider provider=new PrivilegeBitsProvider(root);
  assertTrue(cugPermProvider.supportedPrivileges(null,readBits).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,readNodeBits).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,readPropBits).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,provider.getBits(PrivilegeConstants.JCR_ALL)).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,provider.getBits(PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,provider.getBits(PrivilegeConstants.REP_WRITE)).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,provider.getBits(PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_NODE)).isEmpty());
  assertTrue(cugPermProvider.supportedPrivileges(null,provider.getBits(PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
}

</code></pre>

<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testSupportedPermissionsByTree(){
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    Tree tree=root.getTree(path);
    if (isInCug) {
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tree,null,Permissions.READ));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE));
      assertEquals(Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tree,null,Permissions.ALL));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.ALL));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.WRITE));
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.ADD_NODE | Permissions.REMOVE));
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_ACCESS_CONTROL));
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasNonReadPrivileges(){
  for (  String p : Iterables.concat(READABLE_PATHS,NOT_READABLE_PATHS)) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_WRITE));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_ALL));
    }
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before @Override public void before() throws Exception {
  super.before();
  testGroupPrincipal=getTestGroupPrincipal();
  NodeUtil n=new NodeUtil(root.getTree(SUPPORTED_PATH));
  n.addChild("a",NT_OAK_UNSTRUCTURED).addChild("b",NT_OAK_UNSTRUCTURED).addChild("c",NT_OAK_UNSTRUCTURED);
  n.addChild("aa",NT_OAK_UNSTRUCTURED).addChild("bb",NT_OAK_UNSTRUCTURED).addChild("cc",NT_OAK_UNSTRUCTURED);
  n.addChild("no",NT_OAK_UNSTRUCTURED).addChild("cug",NT_OAK_UNSTRUCTURED).addChild("in",NT_OAK_UNSTRUCTURED).addChild("subtree",NT_OAK_UNSTRUCTURED);
  createCug("/content/a",testGroupPrincipal);
  createCug("/content/a/b/c",EveryonePrincipal.getInstance());
  createCug("/content/aa/bb",testGroupPrincipal);
  root.commit();
  cugPermProvider=createCugPermissionProvider(ImmutableSet.of(SUPPORTED_PATH),getTestUser().getPrincipal(),EveryonePrincipal.getInstance());
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasReadPrivileges(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_PROPERTIES));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES));
    }
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(String,String)
 */
@Test public void testIsGrantedJcrActions(){
  for (  String p : NOT_READABLE_PATHS) {
    assertFalse(cugPermProvider.isGranted(p,Session.ACTION_READ));
    assertFalse(cugPermProvider.isGranted(p,Session.ACTION_ADD_NODE));
    assertFalse(cugPermProvider.isGranted(p,Session.ACTION_READ + ',' + Session.ACTION_ADD_NODE));
  }
  for (  String p : READABLE_PATHS) {
    assertTrue(cugPermProvider.isGranted(p,Session.ACTION_READ));
    assertFalse(cugPermProvider.isGranted(p,Session.ACTION_ADD_NODE));
    assertFalse(cugPermProvider.isGranted(p,Session.ACTION_READ + ',' + Session.ACTION_ADD_NODE));
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testIsGrantedNonRead(){
  for (  String p : Iterables.concat(READABLE_PATHS,NOT_READABLE_PATHS)) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.ALL));
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.READ | Permissions.READ_ACCESS_CONTROL));
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.REMOVE_NODE));
    }
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasPrivilegesNullPath(){
  assertFalse(cugPermProvider.hasPrivileges(null,PrivilegeConstants.JCR_READ));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void testGetPrivilegesNullPath(){
  assertTrue(cugPermProvider.getPrivileges(null).isEmpty());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
