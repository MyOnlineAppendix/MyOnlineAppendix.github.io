<h3 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeProviderScopeTest (23 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(22)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedProperty() throws Exception {
  for (  String p : defPermissions.keySet()) {
    long defaultPerms=defPermissions.get(p);
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      long expected=Permissions.diff(defaultPerms,Permissions.ADD_NODE | Permissions.ADD_PROPERTY);
      assertTrue(cppTestUser.isGranted(tree,PROPERTY_STATE,expected));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.SET_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.WRITE));
    }
 else {
      assertTrue(cppTestUser.isGranted(tree,PROPERTY_STATE,defaultPerms));
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedAdmin() throws Exception {
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.isGranted(tree,null,Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_NODE));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_NODE | Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.WRITE));
    }
 else {
      assertTrue(cppAdminUser.isGranted(tree,null,Permissions.ALL));
    }
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegeOnRepoAdmin() throws Exception {
  assertFalse(cppAdminUser.hasPrivileges(null,JCR_NAMESPACE_MANAGEMENT));
  assertFalse(cppAdminUser.hasPrivileges(null,JCR_NAMESPACE_MANAGEMENT,JCR_NODE_TYPE_DEFINITION_MANAGEMENT));
  assertFalse(cppAdminUser.hasPrivileges(null,JCR_ALL));
  assertTrue(cppAdminUser.hasPrivileges(null,JCR_NODE_TYPE_DEFINITION_MANAGEMENT));
  Set<String> expected=pbp.getPrivilegeNames(pbp.getBits(JCR_ALL).modifiable().diff(pbp.getBits(JCR_NAMESPACE_MANAGEMENT)));
  assertTrue(cppAdminUser.hasPrivileges(null,expected.toArray(new String[expected.size()])));
  assertTrue(cppAdminUser.hasPrivileges(null));
}

</code></pre>

<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivileges() throws Exception {
  PrivilegeBitsProvider pbp=new PrivilegeBitsProvider(readOnlyRoot);
  for (  String path : defPrivileges.keySet()) {
    Tree tree=readOnlyRoot.getTree(path);
    Set<String> defaultPrivs=defPrivileges.get(path);
    Set<String> privNames=cppTestUser.getPrivileges(tree);
    if (testProvider.isSupported(path)) {
      PrivilegeBits expected=pbp.getBits(defaultPrivs).modifiable().diff(denied).unmodifiable();
      assertEquals(expected,pbp.getBits(privNames));
    }
 else {
      assertEquals(path,defaultPrivs,privNames);
    }
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionCanReadAdmin(){
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String nodePath : TP_PATHS) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppAdminUser.getTreePermission(tree,parentPermission);
    assertTrue(nodePath,tp.canRead());
    assertTrue(nodePath,tp.canRead(PROPERTY_STATE));
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesOnRepo() throws Exception {
  Set<String> expected=ImmutableSet.of(JCR_NODE_TYPE_DEFINITION_MANAGEMENT);
  assertEquals(expected,cppTestUser.getPrivileges(null));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesOnRepo() throws Exception {
  assertFalse(cppTestUser.hasPrivileges(null,JCR_NAMESPACE_MANAGEMENT));
  assertFalse(cppTestUser.hasPrivileges(null,JCR_NAMESPACE_MANAGEMENT,JCR_NODE_TYPE_DEFINITION_MANAGEMENT));
  assertFalse(cppTestUser.hasPrivileges(null,JCR_ALL));
  assertTrue(cppTestUser.hasPrivileges(null,JCR_NODE_TYPE_DEFINITION_MANAGEMENT));
  assertTrue(cppTestUser.hasPrivileges(null));
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedProperty() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      if (testProvider.isSupported(path)) {
        assertTrue(tp.isGranted(Permissions.diff(toTest,Permissions.ADD_NODE | Permissions.ADD_PROPERTY),PROPERTY_STATE));
        assertFalse(tp.isGranted(Permissions.ADD_PROPERTY,PROPERTY_STATE));
      }
 else {
        assertTrue(tp.isGranted(toTest,PROPERTY_STATE));
      }
    }
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGranted() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      if (testProvider.isSupported(path)) {
        assertTrue(tp.isGranted(Permissions.diff(toTest,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
        assertFalse(tp.isGranted(Permissions.ADD_PROPERTY | Permissions.ADD_NODE));
      }
 else {
        assertTrue(tp.isGranted(toTest));
      }
    }
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesAdmin() throws Exception {
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    Set<String> privNames=cppAdminUser.getPrivileges(tree);
    if (testProvider.isSupported(path)) {
      PrivilegeBits expected=pbp.getBits(JCR_ALL).modifiable().diff(denied).unmodifiable();
      assertEquals(expected,pbp.getBits(privNames));
    }
 else {
      assertEquals(path,ImmutableSet.of(JCR_ALL),privNames);
    }
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionCanReadAllAdmin(){
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String nodePath : TP_PATHS) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppAdminUser.getTreePermission(tree,parentPermission);
    assertFalse(nodePath,tp.canReadAll());
    assertTrue(nodePath,tp.canReadProperties());
    parentPermission=tp;
  }
  parentPermission=TreePermission.EMPTY;
  for (  String nodePath : PATH_OUTSIDE_SCOPE) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppAdminUser.getTreePermission(tree,parentPermission);
    assertFalse(nodePath,tp.canReadAll());
    assertTrue(nodePath,tp.canReadProperties());
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivileges() throws Exception {
  for (  String path : defPrivileges.keySet()) {
    Set<String> defaultPrivs=defPrivileges.get(path);
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      Set<String> expected=pbp.getPrivilegeNames(pbp.getBits(defaultPrivs).modifiable().diff(denied));
      assertTrue(path,cppTestUser.hasPrivileges(tree,expected.toArray(new String[expected.size()])));
      assertFalse(path,cppTestUser.hasPrivileges(tree,JCR_ADD_CHILD_NODES));
      assertFalse(path,cppTestUser.hasPrivileges(tree,REP_ADD_PROPERTIES));
      assertFalse(path,cppTestUser.hasPrivileges(tree,JCR_MODIFY_PROPERTIES));
    }
 else {
      assertTrue(path,cppTestUser.hasPrivileges(tree,defaultPrivs.toArray(new String[defaultPrivs.size()])));
    }
  }
}

</code></pre>

<pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTreePermissionCanReadProperty() throws Exception {
  Map<String,Boolean> readMap=ImmutableMap.<String,Boolean>builder().put(ROOT_PATH,false).put(TEST_PATH,true).put(TEST_A_PATH,true).put(TEST_A_B_PATH,true).put(TEST_A_B_C_PATH,true).put(TEST_A_B_C_PATH + "/nonexisting",true).build();
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String nodePath : readMap.keySet()) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppTestUser.getTreePermission(tree,parentPermission);
    assertEquals(nodePath,readMap.get(nodePath),tp.canRead(PROPERTY_STATE));
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedPropertyAdmin() throws Exception {
  for (  String p : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      assertTrue(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_NODE));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_NODE | Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.WRITE));
    }
 else {
      assertTrue(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ALL));
    }
  }
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRepositoryPermissionIsGranted() throws Exception {
  RepositoryPermission rp=cppTestUser.getRepositoryPermission();
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT | Permissions.NODE_TYPE_DEFINITION_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT | Permissions.PRIVILEGE_MANAGEMENT));
  assertTrue(rp.isGranted(Permissions.NODE_TYPE_DEFINITION_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.PRIVILEGE_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.NODE_TYPE_DEFINITION_MANAGEMENT | Permissions.PRIVILEGE_MANAGEMENT | Permissions.WORKSPACE_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.ALL));
}

</code></pre>

<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRepositoryPermissionIsGrantedAdmin() throws Exception {
  RepositoryPermission rp=cppAdminUser.getRepositoryPermission();
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT | Permissions.NODE_TYPE_DEFINITION_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.NAMESPACE_MANAGEMENT | Permissions.PRIVILEGE_MANAGEMENT));
  assertTrue(rp.isGranted(Permissions.NODE_TYPE_DEFINITION_MANAGEMENT));
  assertTrue(rp.isGranted(Permissions.PRIVILEGE_MANAGEMENT));
  assertTrue(rp.isGranted(Permissions.NODE_TYPE_DEFINITION_MANAGEMENT | Permissions.PRIVILEGE_MANAGEMENT | Permissions.WORKSPACE_MANAGEMENT));
  assertFalse(rp.isGranted(Permissions.ALL));
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsGrantedAction() throws Exception {
  Set<String> denied=ImmutableSet.of(Session.ACTION_ADD_NODE,JackrabbitSession.ACTION_ADD_PROPERTY);
  for (  String p : defActionsGranted.keySet()) {
    String[] actions=defActionsGranted.get(p);
    if (testProvider.isSupported(p)) {
      Set<String> expected=Sets.newHashSet(actions);
      expected.removeAll(denied);
      boolean canSetProperty=TreeLocation.create(readOnlyRoot,p).getProperty() != null;
      if (!canSetProperty) {
        expected.remove(Session.ACTION_SET_PROPERTY);
      }
      assertTrue(p,cppTestUser.isGranted(p,getActionString(expected.toArray(new String[expected.size()]))));
      assertEquals(p,canSetProperty,cppTestUser.isGranted(p,Session.ACTION_SET_PROPERTY));
      assertFalse(p,cppTestUser.isGranted(p,Session.ACTION_ADD_NODE));
      assertFalse(p,cppTestUser.isGranted(p,JackrabbitSession.ACTION_ADD_PROPERTY));
    }
 else {
      assertTrue(p,cppTestUser.isGranted(p,getActionString(actions)));
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedAdmin(){
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppAdminUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    if (testProvider.isSupported(path)) {
      assertTrue(path,tp.isGranted(Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(path,tp.isGranted(Permissions.ADD_PROPERTY | Permissions.ADD_NODE));
      assertFalse(path,tp.isGranted(Permissions.ALL));
    }
 else {
      assertTrue(path,tp.isGranted(Permissions.ALL));
    }
    parentPermission=tp;
  }
  parentPermission=TreePermission.EMPTY;
  for (  String nodePath : PATH_OUTSIDE_SCOPE) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppAdminUser.getTreePermission(tree,parentPermission);
    assertTrue(nodePath,tp.isGranted(Permissions.ALL));
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesOnRepoAdmin() throws Exception {
  PrivilegeBits expected=pbp.getBits(JCR_ALL).modifiable().diff(pbp.getBits(JCR_NAMESPACE_MANAGEMENT)).unmodifiable();
  assertEquals(expected,pbp.getBits(cppAdminUser.getPrivileges(null)));
}

</code></pre>

<pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTreePermissionCanRead() throws Exception {
  Map<String,Boolean> readMap=ImmutableMap.<String,Boolean>builder().put(ROOT_PATH,false).put(TEST_PATH,true).put(TEST_A_PATH,true).put(TEST_A_B_PATH,true).put(TEST_A_B_C_PATH,false).put(TEST_A_B_C_PATH + "/nonexisting",false).build();
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String nodePath : readMap.keySet()) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppTestUser.getTreePermission(tree,parentPermission);
    boolean expectedResult=readMap.get(nodePath);
    assertEquals(nodePath,expectedResult,tp.canRead());
    parentPermission=tp;
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGranted() throws Exception {
  for (  String p : defPermissions.keySet()) {
    long defaultPerms=defPermissions.get(p);
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      long expected=Permissions.diff(defaultPerms,Permissions.ADD_NODE | Permissions.ADD_PROPERTY);
      assertTrue(cppTestUser.isGranted(tree,null,expected));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.ADD_NODE));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.ADD_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.SET_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.WRITE));
    }
 else {
      assertTrue(cppTestUser.isGranted(tree,null,defaultPerms));
    }
  }
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedActionAdmin() throws Exception {
  String[] grantedActions=new String[]{Session.ACTION_READ,JackrabbitSession.ACTION_REMOVE_NODE,JackrabbitSession.ACTION_MODIFY_PROPERTY,JackrabbitSession.ACTION_REMOVE_PROPERTY,Session.ACTION_REMOVE,JackrabbitSession.ACTION_READ_ACCESS_CONTROL,JackrabbitSession.ACTION_MODIFY_ACCESS_CONTROL,JackrabbitSession.ACTION_LOCKING,JackrabbitSession.ACTION_NODE_TYPE_MANAGEMENT,JackrabbitSession.ACTION_VERSIONING,JackrabbitSession.ACTION_USER_MANAGEMENT};
  for (  String path : NODE_PATHS) {
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.isGranted(path,getActionString(grantedActions)));
      assertFalse(cppAdminUser.isGranted(path,Session.ACTION_ADD_NODE));
      assertFalse(cppAdminUser.isGranted(path,Session.ACTION_SET_PROPERTY));
      assertFalse(cppAdminUser.isGranted(path,JackrabbitSession.ACTION_ADD_PROPERTY));
    }
 else {
      assertTrue(cppAdminUser.isGranted(path,Permissions.getString(Permissions.ALL)));
      assertTrue(cppAdminUser.isGranted(path,getActionString(ALL_ACTIONS)));
    }
  }
}

</code></pre>

<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesAdmin() throws Exception {
  Set<String> expectedAllowed=pbp.getPrivilegeNames(pbp.getBits(JCR_ALL).modifiable().diff(pbp.getBits(JCR_ADD_CHILD_NODES,REP_ADD_PROPERTIES)));
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.hasPrivileges(tree,expectedAllowed.toArray(new String[expectedAllowed.size()])));
      assertFalse(cppAdminUser.hasPrivileges(tree,JCR_ADD_CHILD_NODES));
      assertFalse(cppAdminUser.hasPrivileges(tree,REP_ADD_PROPERTIES));
      assertFalse(cppAdminUser.hasPrivileges(tree,JCR_WRITE));
    }
 else {
      assertTrue(cppAdminUser.hasPrivileges(tree,JCR_ALL));
    }
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
